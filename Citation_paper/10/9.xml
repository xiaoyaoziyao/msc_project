<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-15-54591</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0172761</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Muscle physiology</subject><subj-group><subject>Muscle contraction</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Muscle physiology</subject><subj-group><subject>Muscle contraction</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Muscles</subject><subj-group><subject>Skeletal muscles</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Muscles</subject><subj-group><subject>Skeletal muscles</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Surgical and invasive medical procedures</subject><subj-group><subject>Functional electrical stimulation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Bioassays and physiological analysis</subject><subj-group><subject>Muscle analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Control engineering</subject><subj-group><subject>Control systems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Systems science</subject><subj-group><subject>Control systems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Systems science</subject><subj-group><subject>Control systems</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Muscle fibers</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Muscles</subject><subj-group><subject>Muscle fibers</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Muscles</subject><subj-group><subject>Muscle fibers</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Classical and adaptive control of <italic>ex vivo</italic> skeletal muscle contractions using Functional Electrical Stimulation (FES)</article-title>
<alt-title alt-title-type="running-head">Classical and adaptive control of muscle contraction using FES</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4815-3826</contrib-id>
<name name-style="western">
<surname>Jaramillo Cienfuegos</surname> <given-names>Paola</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Shoemaker</surname> <given-names>Adam</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Grange</surname> <given-names>Robert W.</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Abaid</surname> <given-names>Nicole</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Leonessa</surname> <given-names>Alexander</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Weapons and Systems Engineering, United States Naval Academy, Annapolis, Maryland, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Mechanical Engineering, Virginia Polytechnic Institute and State University, Blacksburg, Virginia, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Human Nutrition, Foods, and Exercise, Virginia Polytechnic Institute and State University, Blacksburg, Virginia, United States of America</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Biomedical Engineering and Mechanics, Foods, Virginia Polytechnic Institute and State University, Blacksburg, Virginia, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Kellermayer</surname> <given-names>Miklos S.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Semmelweis Egyetem, HUNGARY</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> AL RG PJC.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> PJC AS.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> PJC NA RG AL.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> AL.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> PJC AS.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> AL RG PJC.</p>
</list-item>
<list-item>
<p><bold>Project administration:</bold> AL RG.</p>
</list-item>
<list-item>
<p><bold>Resources:</bold> RG AL.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> AS PJC.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> RG AL NA.</p>
</list-item>
<list-item>
<p><bold>Validation:</bold> PJC NA AL RG.</p>
</list-item>
<list-item>
<p><bold>Visualization:</bold> PJC NA.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> PJC.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> PJC RG NA AL.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">paola.jaramillo.co@usna.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>8</day>
<month>3</month>
<year>2017</year>
</pub-date>
<volume>12</volume>
<issue>3</issue>
<elocation-id>e0172761</elocation-id>
<history>
<date date-type="received">
<day>16</day>
<month>12</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>9</day>
<month>2</month>
<year>2017</year>
</date>
</history>
<permissions>
<license xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">
<license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">Creative Commons CC0</ext-link> public domain dedication.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0172761"/>
<abstract>
<p>Functional Electrical Stimulation is a promising approach to treat patients by stimulating the peripheral nerves and their corresponding motor neurons using electrical current. This technique helps maintain muscle mass and promote blood flow in the absence of a functioning nervous system. The goal of this work is to control muscle contractions from FES via three different algorithms and assess the most appropriate controller providing effective stimulation of the muscle. An open-loop system and a closed-loop system with three types of model-free feedback controllers were assessed for tracking control of skeletal muscle contractions: a Proportional-Integral (PI) controller, a Model Reference Adaptive Control algorithm, and an Adaptive Augmented PI system. Furthermore, a mathematical model of a muscle-mass-spring system was implemented in simulation to test the open-loop case and closed-loop controllers. These simulations were carried out and then validated through experiments <italic>ex vivo</italic>. The experiments included muscle contractions following four distinct trajectories: a step, sine, ramp, and square wave. Overall, the closed-loop controllers followed the stimulation trajectories set for all the simulated and tested muscles. When comparing the experimental outcomes of each controller, we concluded that the Adaptive Augmented PI algorithm provided the best closed-loop performance for speed of convergence and disturbance rejection.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Division of Chemical, Bioengineering, Environmental, and Transport Systems (US), National Science Foundation</institution>
</funding-source>
<award-id>0828114</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Leonessa</surname> <given-names>Alexander</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This research work was funded by the National Science Foundation Division of Chemical, Bioengineering, Environmental and Transport Systems (CBET). Funds were awarded for the proposal No. 0828114 titled “Collaborative Research: Adaptive Control and Functional Electrical Stimulation for the Control and Understanding of Muscle Dynamics” and the proposal No. 1055315 titled “CAREER: Functional Electrical Stimulation to Aid Phonation in the Presence of Unilateral Vocal Fold Paralysis”. The funders had no role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="13"/>
<table-count count="3"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All the data are within the paper and Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Functional Electrical Stimulation (FES) is a rehabilitation technique used to treat patients with absence of a functioning nervous system by maintaining blood flow and directly stimulating peripheral nerves [<xref ref-type="bibr" rid="pone.0172761.ref001">1</xref>, <xref ref-type="bibr" rid="pone.0172761.ref002">2</xref>]. Motor unit recruitment varies with FES since fast motor units are recruited prior to slow motor units [<xref ref-type="bibr" rid="pone.0172761.ref002">2</xref>–<xref ref-type="bibr" rid="pone.0172761.ref004">4</xref>]. Although non-physiological recruitment attenuates muscle atrophy, it can induce fatigue which hinders muscle performance. Patterns of FES can be delivered via transcutaneous or percutaneous electrodes from an electrical stimulator which is regulated by a controller. The controller specifies stimulation parameters including amplitude, pulse width, and frequency. Theoretically, appropriate muscle contractions can be generated by FES to improve and maintain muscle function. To successfully activate the muscle, a balance must exist between the controlled level of contraction and the energy transfer from electrodes into the muscle. As demonstrated in [<xref ref-type="bibr" rid="pone.0172761.ref005">5</xref>–<xref ref-type="bibr" rid="pone.0172761.ref010">10</xref>], correlations exist between the number of tetanic contractions and muscle physical properties such as muscle mass, fiber size and force production. Assessment of muscle force and length changes during activation by electrical stimulation, which constitute reliable indicators of muscle function.</p>
<p>FES systems in clinical settings have relied primarily on open-loop control schemes. That is, there is no feedback captured from the stimulated muscle to compare to the desired muscle stimulus. Open-loop systems provide a command input but do not use output feedback to adjust the control action [<xref ref-type="bibr" rid="pone.0172761.ref011">11</xref>]. The major challenges when implementing closed-loop systems as rehabilitation tools include non-physiological recruitment due to synchronous recruitment, spasticity, complexity of muscle systems, appropriate sensing mechanisms, and disturbances to mention a few [<xref ref-type="bibr" rid="pone.0172761.ref012">12</xref>–<xref ref-type="bibr" rid="pone.0172761.ref014">14</xref>]. The designed control algorithm should be able to compensate and regulate muscles’ complexity as well as disturbances for optimal tracking.</p>
<p>Coordination of muscle activation is essential to movement. Cyclical activation by agonist-antagonistic muscle pairs provide motion at a joint (e.g., at the hip during walking), while synchronized contractions of the muscle pair stabilizes the joint [<xref ref-type="bibr" rid="pone.0172761.ref015">15</xref>]. A major motivation for this study was to develop a feedback control system to activate muscle. Popovic et al. [<xref ref-type="bibr" rid="pone.0172761.ref016">16</xref>] presents a review on various control methods used in simulation or experimentation, including open-loop controllers applying an inverse model, linear PID controllers, feedforward controllers with PID, and adaptive controllers. The increased need for effective and easy to operate FES equipment has motivated the exploration of these autonomous closed-loop systems, in which produced movement is measured in real-time using sensors and the stimulation pattern is modulated according to the difference between achieved and desired motion. For example, designed control systems for joint tracking by electrical stimulation includes a robust feedback system, H infinity controller, for ankle-moment tracking of the human calf muscles during upright position [<xref ref-type="bibr" rid="pone.0172761.ref017">17</xref>]; a neuro-PID controller for regulating knee angle employing an artificial neural network to regulate the desired knee angle to the appropriate stimulation parameters and a PID controller for compensation of unmodeled disturbances and tracking error [<xref ref-type="bibr" rid="pone.0172761.ref018">18</xref>]; and a sliding mode controller for regulating knee angle using Riener’s knee model [<xref ref-type="bibr" rid="pone.0172761.ref019">19</xref>]. The latter controller can display undesirable oscillatory behavior known as chattering [<xref ref-type="bibr" rid="pone.0172761.ref020">20</xref>, <xref ref-type="bibr" rid="pone.0172761.ref021">21</xref>]. In addition, an example of adaptive control systems for muscle stimulation include a multiple-model adaptive control for upper-limb rehabilitation assuming nonlinear-time-invariant systems using time-varying Hammerstein structures to represent activation dynamics. This particular controller requires a set of subject models from experimental data and a set of tracking controllers from a healthy population [<xref ref-type="bibr" rid="pone.0172761.ref022">22</xref>].</p>
<p>Efficient controllers are needed to understand the relationships between the stimulation parameters and the resulting force and motion outputs. As a result, numerous issues arise regarding stability and robustness of controllers; for example, inefficient adjustments to fit the patient’s desired movement parameters, and sensitivities attributable to disturbances in the system make smooth coordinated movements difficult. Closed-loop systems enable repeatability through feedback by minimizing the error between the input and output of the system. In the present study, a closed-loop FES system was tested that compared different types of controllers to stimulate skeletal muscle <italic>ex vivo</italic>.</p>
<p>The key to implement an effective and efficient closed-loop FES system relies on four important criteria: (1) the system’s stability, which describes the boundedness of the input reference trajectory achieved by the muscle contraction, (2) the transient response, which provides a measure of how fast the muscle contractions converge to the reference trajectory, (3) the tracking performance, which scores the system’s ability to follow the desired motion, and (4) control constraints, which safeguard the muscles from unsuitable stimulation and joints from unwanted movements. Therefore, the controller design for a system comprised of a dynamic musculoskeletal model as well as sensors and actuators requires recurrent computation of the desired stimulation to accomplish the desired task [<xref ref-type="bibr" rid="pone.0172761.ref023">23</xref>–<xref ref-type="bibr" rid="pone.0172761.ref028">28</xref>]. In this study, we seek to test our controller detached from voluntary muscle contractions as suggested by Lynch and Popovic in [<xref ref-type="bibr" rid="pone.0172761.ref016">16</xref>]. Therefore, we dissected the muscle to asses the efficacy of the proposed control algorithms. This process guarantees the generated muscle contractions are solely due to the stimulation pulses set by the control effort.</p>
<p>The objective of this study was to test control of muscle contractions in simulation and experiments, specifically those of mouse muscle extensor digitorum longus (EDL) properties, via an open-loop system and a closed-loop system with three different closed-loop controllers to determine the most appropriate controller for position tracking. These controllers were based on minimizing the error of the system without relying on complex skeletal muscle models, such as proposed by the classic Hill muscle model [<xref ref-type="bibr" rid="pone.0172761.ref029">29</xref>], Huxley’s sliding filament muscle model [<xref ref-type="bibr" rid="pone.0172761.ref030">30</xref>], or rheological models [<xref ref-type="bibr" rid="pone.0172761.ref031">31</xref>]. We tested an open loop system and three model-free closed-loop controllers: Proportional-Integral (PI), Model Reference Adaptive Control (MRAC), and Adaptive Augmented PI (ADP-PI). Computational simulations were performed followed by validation through experiments <italic>ex vivo</italic>. Our goal was to determine which of these controllers provided the best performance of a skeletal muscle subjected to contraction when tracking each of four predetermined functions, including a step, sine, ramp, and square wave trajectories. Through adequate tuning of the parameters specified in each controller, we were able to minimize the error between the set desired trajectory and the actual muscle response.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<p>The Materials and Methods section is divided into three main components: (1) the Skeletal Muscle Simulation, detailing the computational muscle system, (2) Controller Design, outlining the three controllers implemented in experiment and simulation, as well as (3) Experimental Design, which focuses on the explanation of the mouse muscle trials performed and the statistical analyses of these results. The nomenclature used throughout the paper is listed in the Supporting Information section, <xref ref-type="supplementary-material" rid="pone.0172761.s001">S1 Table</xref>.</p>
<sec id="sec003">
<title>Skeletal muscle simulation</title>
<p>To assess the performance of open-loop and closed-loop controllers, a virtual setup comprised of a muscle-mass-spring system is modeled in MATLAB/Simulink. The muscle model algorithm and parameters used in simulation are adapted from the Thelen muscle model [<xref ref-type="bibr" rid="pone.0172761.ref032">32</xref>, <xref ref-type="bibr" rid="pone.0172761.ref033">33</xref>], which is based on the Hill-type model [<xref ref-type="bibr" rid="pone.0172761.ref029">29</xref>] detailed in the Supporting Information sections, <xref ref-type="supplementary-material" rid="pone.0172761.s002">S1 Appendix</xref> and <xref ref-type="supplementary-material" rid="pone.0172761.s003">S2 Table</xref>. Four different trajectories (step, sine, ramp and square wave functions) were specified to carry out these simulations for the open-loop and closed-loop controllers.</p>
<p>The muscle-mass-spring system setup is shown in <xref ref-type="fig" rid="pone.0172761.g001">Fig 1</xref>. The muscle contraction <italic>x</italic> is recorded and serves as the feedback information for the closed-loop controllers. Dissipative forces such as Coulomb frictional force, <italic>F</italic><sub>f</sub>, and damping force, <inline-formula id="pone.0172761.e001"><alternatives><graphic id="pone.0172761.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, are considered in the model since the experimental setup has the mass block moving along a steel rail. The static and kinetic coefficients of friction and the damping coefficient were chosen as <italic>μ</italic><sub>s</sub> = 0.120, <italic>μ</italic><sub>k</sub> = 0.080 and <italic>c</italic> = 3.500N-s/m, respectively. The spring constant <italic>k</italic><sub>s</sub> = 35.025N/m and mass <italic>m</italic> = 0.900g are based on the built experimental setup used to validate the simulations.</p>
<fig id="pone.0172761.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Muscle-mass-spring system schematic based on the system’s equation of motion.</title>
<p>The EDL muscle contraction causes the mass positioned along the bar rail to move in the same direction as the contraction. The trajectory of the muscle is tracked using the linear magnetic encoder. The movement is then fed back to the controller.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g001" xlink:type="simple"/>
</fig>
<p>A block diagram for the algorithm is shown in <xref ref-type="fig" rid="pone.0172761.g002">Fig 2</xref>. At the start of simulation, the muscle-tendon length, <italic>l</italic><sub>MT</sub>, at <italic>t</italic> = 0, is set at maximum optimal fiber length <inline-formula id="pone.0172761.e002"><alternatives><graphic id="pone.0172761.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msubsup><mml:mi>l</mml:mi> <mml:mn>0</mml:mn> <mml:mi mathvariant="normal">M</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and the tendon is set at the tendon slack length, <inline-formula id="pone.0172761.e003"><alternatives><graphic id="pone.0172761.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msubsup><mml:mi>l</mml:mi> <mml:mi mathvariant="normal">s</mml:mi> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. The ratio between the EDL muscle fiber to whole muscle length, <inline-formula id="pone.0172761.e004"><alternatives><graphic id="pone.0172761.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msubsup><mml:mi>l</mml:mi> <mml:mn>0</mml:mn> <mml:mi mathvariant="normal">M</mml:mi></mml:msubsup> <mml:mo>/</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi mathvariant="normal">M</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, is 0.44 [<xref ref-type="bibr" rid="pone.0172761.ref034">34</xref>]. In a given time step, the muscle fiber length is calculated from the integration of the contraction dynamics block and updated into the tendon block. The force generated from the system, <italic>F</italic><sup>MT</sup>, is the muscle force. A subsystem describes the motion dynamics of the system as follows,
<disp-formula id="pone.0172761.e005"><alternatives><graphic id="pone.0172761.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¨</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mtext>MT</mml:mtext></mml:msup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mi mathvariant="normal">f</mml:mi></mml:msub> <mml:mtext>sign</mml:mtext> <mml:mspace width="0.166667em"/><mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
with initial conditions:
<disp-formula id="pone.0172761.e006"><alternatives><graphic id="pone.0172761.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<fig id="pone.0172761.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Flowchart showing the muscle-mass-spring system modeled in MATLAB/Simulink to test controllers.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g002" xlink:type="simple"/>
</fig>
<p>To implement <italic>F</italic><sub>f</sub>, a switch is applied such that the system can vary between static and dynamic coefficients of friction, <italic>μ</italic><sub>s</sub> and <italic>μ</italic><sub>k</sub>, respectively. The frictional force is determined by the following conditions:
<disp-formula id="pone.0172761.e007"><alternatives><graphic id="pone.0172761.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mi mathvariant="normal">f</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mi mathvariant="normal">k</mml:mi></mml:msub> <mml:mi>m</mml:mi> <mml:mi>g</mml:mi> <mml:mspace width="0.166667em"/><mml:mtext>sign</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="0.222222em"/><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi>F</mml:mi> <mml:mtext>MT</mml:mtext></mml:msup> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:mo>≥</mml:mo></mml:mrow> <mml:msub><mml:mi>μ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mi>m</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mi>m</mml:mi> <mml:mi>g</mml:mi> <mml:mspace width="0.166667em"/><mml:mtext>sign</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="0.222222em"/><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi>F</mml:mi> <mml:mtext>MT</mml:mtext></mml:msup> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:mo>&lt;</mml:mo></mml:mrow> <mml:msub><mml:mi>μ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mi>m</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>The muscle contraction, <italic>x</italic>, was fedback to the system via the three closed-loop controllers. The controllers determined the appropriate activation time for the contraction pulse. For the open-loop case, tuning was done by inspection since there is no feedback in the system. A gain value was found to generate the pulse required for the muscle contraction to follow the specified trajectory.</p>
</sec>
<sec id="sec004">
<title>Controller design</title>
<p>For the muscle model simulation, an open-loop system and three closed-loop controllers were used to control muscle contraction. These were a linear PI control law and two nonlinear controllers which introduce adaptation to the system, MRAC and ADP-PI controllers. The following sections provide a tutorial explaining the structure of the three control techniques in detail. Furthermore, a brief sample outlining tuning of the controllers are detailed in the Supporting Information sections, <xref ref-type="supplementary-material" rid="pone.0172761.s004">S2 Appendix</xref> and <xref ref-type="supplementary-material" rid="pone.0172761.s005">S1 Fig</xref>.</p>
<sec id="sec005">
<title>Proportional integral controller</title>
<p>For the purpose of muscle stimulation, a PI controller was used as described in [<xref ref-type="bibr" rid="pone.0172761.ref035">35</xref>, <xref ref-type="bibr" rid="pone.0172761.ref036">36</xref>]. The structure of this controller is demonstrated in <xref ref-type="fig" rid="pone.0172761.g003">Fig 3</xref>. In this model, the user specifies the desired trajectory, <italic>x</italic><sub>d</sub>(<italic>t</italic>), as the system input, which is then compared to the current measured state, <italic>x</italic>(<italic>t</italic>). Since a positive control force will result in negative contraction, the system error, <italic>e</italic><sub>PI</sub>(<italic>t</italic>), is defined as follows,
<disp-formula id="pone.0172761.e008"><alternatives><graphic id="pone.0172761.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>e</mml:mi> <mml:mtext>PI</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<fig id="pone.0172761.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Block diagram of the closed-loop system using a Proportional Integral controller.</title>
<p>For the PI control, the error <italic>e</italic><sub>PI</sub>(<italic>t</italic>) is determined from the state <italic>x</italic>(<italic>t</italic>) and desired state <italic>x</italic><sub>d</sub>(<italic>t</italic>). A control effort, <italic>u</italic><sub>PI</sub>(<italic>t</italic>), based on <italic>e</italic><sub>PI</sub>(<italic>t</italic>) is then input into the system.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g003" xlink:type="simple"/>
</fig>
<p>Based on this definition of the error, the PI controller then determines the control input, <italic>u</italic><sub>PI</sub>(<italic>t</italic>), by implementing the following law,
<disp-formula id="pone.0172761.e009"><alternatives><graphic id="pone.0172761.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mtext>PI</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi mathvariant="normal">P</mml:mi></mml:msub> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>e</mml:mi> <mml:mtext>PI</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mfrac> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>e</mml:mi> <mml:mtext>PI</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>k</italic><sub>P</sub> is the proportional gain and <italic>T</italic><sub>i</sub> is the integral time. In standard form, the quantity <inline-formula id="pone.0172761.e010"><alternatives><graphic id="pone.0172761.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mfrac><mml:msub><mml:mi>k</mml:mi> <mml:mi mathvariant="normal">P</mml:mi></mml:msub> <mml:msub><mml:mi>T</mml:mi> <mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mfrac></mml:math></alternatives></inline-formula> is referred to as <italic>k</italic><sub>I</sub>, commonly called the integral gain.</p>
<p>To tune the controller, a procedure was used similar to the Ziegler—Nichols Critical Gain method presented in [<xref ref-type="bibr" rid="pone.0172761.ref035">35</xref>]. With the integral gain set to <italic>k</italic><sub>I</sub> = 0, the proportional gain, <italic>k</italic><sub>P</sub>, was steadily increased until oscillation was detected in a step input response. The optimal proportional gain was then taken to be the value used before oscillation was detected. Using this value, the reciprocal of the integral time, <inline-formula id="pone.0172761.e011"><alternatives><graphic id="pone.0172761.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mfrac></mml:math></alternatives></inline-formula>, was increased until the step response error was determined to converge to a near zero value to ensure a proper transient response. Through appropriate tuning, the system may exhibit relatively small or no overshoot during the muscle contraction response.</p>
</sec>
<sec id="sec006">
<title>Model Reference Adaptive Controller (MRAC)</title>
<p>In addition to the PI controller, a MRAC algorithm based on the theory presented in [<xref ref-type="bibr" rid="pone.0172761.ref037">37</xref>] and [<xref ref-type="bibr" rid="pone.0172761.ref038">38</xref>] was used. In this design, seen in <xref ref-type="fig" rid="pone.0172761.g004">Fig 4</xref>, the control effort is a function of the adaptive gains, reference input, and current state. The adaptive gains, likewise, depend on the reference input, current state, and error between the unknown plant and reference system.</p>
<fig id="pone.0172761.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Block diagram of the closed loop system using a Model Reference Adaptive Controller.</title>
<p>The error, <italic>e</italic><sub>ad</sub>(<italic>t</italic>), state, <italic>x</italic>(<italic>t</italic>), and reference input, <italic>r</italic>(<italic>t</italic>), are used to define the dynamics for adaptive gains, <italic>θ</italic><sub>r</sub>(<italic>t</italic>) and <italic>θ</italic><sub><italic>x</italic></sub>(<italic>t</italic>). The control effort is computed using these gains, which then drives the mass-spring-muscle system to the reference system.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g004" xlink:type="simple"/>
</fig>
<p>The following linear structure was implemented to describe the muscle behavior,
<disp-formula id="pone.0172761.e012"><alternatives><graphic id="pone.0172761.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <inline-formula id="pone.0172761.e013"><alternatives><graphic id="pone.0172761.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the system state, <inline-formula id="pone.0172761.e014"><alternatives><graphic id="pone.0172761.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mi>a</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is an unknown system state constant, <italic>b</italic> &gt; 0 is the system input constant with known sign and unknown magnitude, and <inline-formula id="pone.0172761.e015"><alternatives><graphic id="pone.0172761.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the control effort. The MRAC algorithm will ultimately force the system given in <xref ref-type="disp-formula" rid="pone.0172761.e012">Eq (6)</xref> to converge to the following reference model,
<disp-formula id="pone.0172761.e016"><alternatives><graphic id="pone.0172761.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
where <inline-formula id="pone.0172761.e017"><alternatives><graphic id="pone.0172761.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the reference model state, <italic>a</italic><sub>r</sub> &lt; 0 is a negative (stable) system state constant, <inline-formula id="pone.0172761.e018"><alternatives><graphic id="pone.0172761.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is a known input constant, and <inline-formula id="pone.0172761.e019"><alternatives><graphic id="pone.0172761.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the reference input. In the experiments, <italic>a</italic><sub>r</sub> is chosen such that <italic>a</italic><sub>r</sub> = −<italic>b</italic><sub>r</sub>. The reference input, <italic>r</italic>(<italic>t</italic>), is then chosen so that the reference system <italic>x</italic><sub>r</sub>(<italic>t</italic>) tracks the desired trajectory, <inline-formula id="pone.0172761.e020"><alternatives><graphic id="pone.0172761.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>It is assumed that ideal gains, <inline-formula id="pone.0172761.e021"><alternatives><graphic id="pone.0172761.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0172761.e022"><alternatives><graphic id="pone.0172761.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, exist to drive the system to the reference model through an ideal control law, <inline-formula id="pone.0172761.e023"><alternatives><graphic id="pone.0172761.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mtext>id</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. By substituting <italic>u</italic><sub>id</sub>(<italic>t</italic>) into <xref ref-type="disp-formula" rid="pone.0172761.e012">Eq (6)</xref>, the following relationship is obtained,
<disp-formula id="pone.0172761.e024"><alternatives><graphic id="pone.0172761.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula></p>
<p>The error is given by <inline-formula id="pone.0172761.e025"><alternatives><graphic id="pone.0172761.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mi>e</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Choosing <inline-formula id="pone.0172761.e026"><alternatives><graphic id="pone.0172761.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>≜</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi></mml:mrow> <mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0172761.e027"><alternatives><graphic id="pone.0172761.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>≜</mml:mo> <mml:mfrac><mml:msub><mml:mi>b</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, the closed-loop system expression simplifies to the reference model and the error dynamics are given by
<disp-formula id="pone.0172761.e028"><alternatives><graphic id="pone.0172761.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula></p>
<p>Given that the reference model is chosen to be stable (<italic>a</italic><sub>r</sub> &lt; 0), the error dynamics are also stable and the system state converges to the reference state. However, since <italic>a</italic> and <italic>b</italic> are unknown, the ideal gains <inline-formula id="pone.0172761.e029"><alternatives><graphic id="pone.0172761.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0172761.e030"><alternatives><graphic id="pone.0172761.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> cannot be computed and the ideal control law <italic>u</italic><sub>id</sub>(<italic>t</italic>) cannot be implemented. Hence, the ideal control law needs to be modified into an adaptive one which, instead of the ideal gains, implements adaptive gains, <italic>θ</italic><sub><italic>x</italic></sub>(<italic>t</italic>) and <italic>θ</italic><sub>r</sub>(<italic>t</italic>).</p>
<p><bold>Theorem 1</bold>. Consider the system <xref ref-type="disp-formula" rid="pone.0172761.e012">Eq (6)</xref>, the reference system <xref ref-type="disp-formula" rid="pone.0172761.e016">Eq (7)</xref> and adaptation laws given by
<disp-formula id="pone.0172761.e031"><alternatives><graphic id="pone.0172761.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>≜</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mrow><mml:mtext>ad</mml:mtext></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>sign</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
<disp-formula id="pone.0172761.e032"><alternatives><graphic id="pone.0172761.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mtext>r</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>≜</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mtext>r</mml:mtext></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mrow><mml:mtext>ad</mml:mtext></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>sign</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
where <italic>γ</italic><sub><italic>x</italic></sub> &gt; 0 and <italic>γ</italic><sub>r</sub> &gt; 0 are the tuning parameters. Then, the closed loop system given by Eqs (<xref ref-type="disp-formula" rid="pone.0172761.e012">6</xref>), (<xref ref-type="disp-formula" rid="pone.0172761.e016">7</xref>), (<xref ref-type="disp-formula" rid="pone.0172761.e031">10</xref>) and (<xref ref-type="disp-formula" rid="pone.0172761.e032">11</xref>) with the adaptive control law
<disp-formula id="pone.0172761.e033"><alternatives><graphic id="pone.0172761.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
is Lyapunov stable and the tracking error <italic>e</italic><sub>ad</sub>(<italic>t</italic>) converges to zero.</p>
<p><bold>Proof</bold>. Define the difference between the adaptive and ideal gains as <inline-formula id="pone.0172761.e034"><alternatives><graphic id="pone.0172761.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0172761.e035"><alternatives><graphic id="pone.0172761.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. By substituting the adaptive control input <xref ref-type="disp-formula" rid="pone.0172761.e033">Eq (12)</xref> into <xref ref-type="disp-formula" rid="pone.0172761.e012">Eq (6)</xref> and introducing the definitions of <inline-formula id="pone.0172761.e036"><alternatives><graphic id="pone.0172761.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0172761.e037"><alternatives><graphic id="pone.0172761.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0172761.e038"><alternatives><graphic id="pone.0172761.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0172761.e039"><alternatives><graphic id="pone.0172761.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, we obtain,
<disp-formula id="pone.0172761.e040"><alternatives><graphic id="pone.0172761.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mi>b</mml:mi> <mml:msub><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mfenced> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p>
<p>Accordingly, the error dynamics are given by computing the difference between Eqs (<xref ref-type="disp-formula" rid="pone.0172761.e040">13</xref>) and (<xref ref-type="disp-formula" rid="pone.0172761.e016">7</xref>) as follows,
<disp-formula id="pone.0172761.e041"><alternatives><graphic id="pone.0172761.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula></p>
<p>Next, introduce the following Lyapunov function candidate [<xref ref-type="bibr" rid="pone.0172761.ref039">39</xref>],
<disp-formula id="pone.0172761.e042"><alternatives><graphic id="pone.0172761.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msub><mml:mi>e</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>γ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula></p>
<p>Using Eqs (<xref ref-type="disp-formula" rid="pone.0172761.e041">14</xref>), (<xref ref-type="disp-formula" rid="pone.0172761.e031">10</xref>) and (<xref ref-type="disp-formula" rid="pone.0172761.e032">11</xref>), the Lyapunov derivative is determined by computing the time derivative of <xref ref-type="disp-formula" rid="pone.0172761.e042">Eq (15)</xref> along the trajectories of <xref ref-type="disp-formula" rid="pone.0172761.e041">Eq (14)</xref>,
<disp-formula id="pone.0172761.e043"><alternatives><graphic id="pone.0172761.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>≜</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mfrac> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>γ</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mfrac> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>≤</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula></p>
<p>Since <italic>a</italic><sub>r</sub> &lt; 0, the LaSalle-Yoshizawa Theorem guarantees the error will converge to zero as time goes to infinity and all signals remain bounded [<xref ref-type="bibr" rid="pone.0172761.ref040">40</xref>].</p>
<p>Tuning the adaptive controller is a matter of adjusting the tuning constants <italic>γ</italic><sub><italic>x</italic></sub> and <italic>γ</italic><sub>r</sub> as well as the reference system parameters <italic>a</italic><sub>r</sub> and <italic>b</italic><sub>r</sub>. While larger tuning constants will speed the rate of adaptation, high adaptive rates will lead to aggressive oscillatory behavior in the response, which is undesirable in muscle stimulation. On the other hand, limiting the rates of adaptation will also limit the rate of system convergence. Since the muscle stimulation occurred over a short period of time, added benefit was gained from adjusting the initial conditions of the adaptive gains, <italic>θ</italic><sub><italic>x</italic></sub>(0) and <italic>θ</italic><sub>r</sub>(0). This alteration allowed for the use of less aggressive adaptive rates by starting each experimental run with conditions closer to a converged state, but also required an additional tuning effort.</p>
</sec>
<sec id="sec007">
<title>Adaptive augmented PI control</title>
<p>In order to maintain many of the overall benefits observed with the implementation of the PI controller but facilitate the advantages of adaptation, the ADP-PI controller presented in [<xref ref-type="bibr" rid="pone.0172761.ref041">41</xref>] was chosen. Alterations, however, were made to this strategy to support a more heuristic tuning methodology which was used with the classical PI controller. The design of this controller is given in <xref ref-type="fig" rid="pone.0172761.g005">Fig 5</xref>.</p>
<fig id="pone.0172761.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Block diagram of the closed-loop system using Adaptive augmented PI controller.</title>
<p>The system assumes a single input-single output (SISO) form where <italic>x</italic>(<italic>t</italic>) is the state vector. To tune the controller, first we compute the linear gains, then calculate the adaptive parameters Γ<sub><italic>K</italic></sub> and Γ<sub><italic>W</italic></sub>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g005" xlink:type="simple"/>
</fig>
<p>At the core of the algorithm, a classical PI controller provides a linear contribution to the overall control strategy, augmented with an adaptive control effort which depends on adaptive gains, current system state, desired trajectory, and a set of structured nonlinear functions of the state. The adaptive gains are continuously updated based on system state, trajectory, error between the reference system, and the same set of nonlinear functions. Using a first order model to describe the muscle behavior similar to that of the MRAC algorithm, the system model is given as follows,
<disp-formula id="pone.0172761.e044"><alternatives><graphic id="pone.0172761.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:mi>u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
where <inline-formula id="pone.0172761.e045"><alternatives><graphic id="pone.0172761.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:mi>a</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is a known state constant, <inline-formula id="pone.0172761.e046"><alternatives><graphic id="pone.0172761.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:mi>b</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is a known input constant, <italic>λ</italic>* &gt; 0 is a constant of known sign and unknown magnitude, <inline-formula id="pone.0172761.e047"><alternatives><graphic id="pone.0172761.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:mi>u</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the control effort, <inline-formula id="pone.0172761.e048"><alternatives><graphic id="pone.0172761.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msup><mml:mi>W</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is an unknown constant vector where <italic>p</italic> &gt; 0 is the number of linear and nonlinear functions contained in <inline-formula id="pone.0172761.e049"><alternatives><graphic id="pone.0172761.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:mi>ϕ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Note that there is no loss of generality in assuming the state constant <italic>a</italic> is known as the vector of basis functions <italic>ϕ</italic>(<italic>x</italic>(<italic>t</italic>)) will also contain the simple linear function <italic>x</italic>(<italic>t</italic>) hence providing an overall uncertainty over the linear coefficient of the system dynamics.</p>
<p>Since the PI control relies on the integration of the error between current and desired states, an additional integral state is introduced, <inline-formula id="pone.0172761.e050"><alternatives><graphic id="pone.0172761.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">I</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mi>d</mml:mi> <mml:mi>τ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. This state is then augmented to the current model to provide an overall representation,
<disp-formula id="pone.0172761.e051"><alternatives><graphic id="pone.0172761.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>≜</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:mi>u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced></mml:mfenced> <mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
where <inline-formula id="pone.0172761.e052"><alternatives><graphic id="pone.0172761.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="5.05942pt"/><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">I</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>To implement the adaptive control algorithm, a reference system needs to be introduced. In particular, we chose the known dynamics of <xref ref-type="disp-formula" rid="pone.0172761.e051">Eq (18)</xref> which can be written as
<disp-formula id="pone.0172761.e053"><alternatives><graphic id="pone.0172761.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mtext>lin</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msub><mml:mi>x</mml:mi> <mml:mtext>lin</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>lin</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
where <inline-formula id="pone.0172761.e054"><alternatives><graphic id="pone.0172761.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mtext>lin</mml:mtext></mml:mrow></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. A standard PI controller is chosen to guarantee that <xref ref-type="disp-formula" rid="pone.0172761.e053">Eq (19)</xref> tracks the desired trajectory, that is
<disp-formula id="pone.0172761.e055"><alternatives><graphic id="pone.0172761.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mtext>lin</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mi>K</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>x</mml:mi> <mml:mtext>lin</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
where <inline-formula id="pone.0172761.e056"><alternatives><graphic id="pone.0172761.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mrow><mml:msup><mml:mi>K</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>≜</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi mathvariant="normal">P</mml:mi></mml:msub> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>k</mml:mi> <mml:mi mathvariant="normal">I</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Substituting <xref ref-type="disp-formula" rid="pone.0172761.e055">Eq (20)</xref> into <xref ref-type="disp-formula" rid="pone.0172761.e053">Eq (19)</xref> provides the following closed-loop system, which will be used as the reference system for the design of the adaptive controller
<disp-formula id="pone.0172761.e057"><alternatives><graphic id="pone.0172761.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mtext>lin</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mtext>lin</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>b</mml:mi> <mml:msub><mml:mi>k</mml:mi> <mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where <italic>A</italic><sub>r</sub> is defined as,
<disp-formula id="pone.0172761.e058"><alternatives><graphic id="pone.0172761.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mo>≜</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>-</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msup><mml:mi>K</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula></p>
<p>By designing <italic>k</italic><sub>P</sub> and <italic>k</italic><sub>I</sub> through classical techniques, <italic>A</italic><sub>r</sub> is guaranteed to be Hurwitz. This, however, is under the assumption that both <italic>a</italic> and <italic>b</italic> are known. In reality, however, <italic>k</italic><sub>P</sub> and <italic>k</italic><sub>I</sub> are tuned in the same manner discussed with the PI controller. Once satisfactory values are determined, approximate values for <italic>a</italic> and <italic>b</italic> are found by examining the step response to achieve a similar trend in simulation.</p>
<p>To design a controller which guarantees that the augmented system <xref ref-type="disp-formula" rid="pone.0172761.e051">Eq (18)</xref> converges to the reference system <xref ref-type="disp-formula" rid="pone.0172761.e057">Eq (21)</xref>, we introduce the following tracking error,
<disp-formula id="pone.0172761.e059"><alternatives><graphic id="pone.0172761.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mtext>lin</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
and analyze its dynamics, obtained as follows,
<disp-formula id="pone.0172761.e060"><alternatives><graphic id="pone.0172761.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e060" xlink:type="simple"/><mml:math display="block" id="M60"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mtext>lin</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:mi>u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced></mml:mfenced> <mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msup><mml:mi>K</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mi>k</mml:mi> <mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:mi>u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup></mml:mfrac> <mml:msup><mml:mi>K</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mfenced> <mml:mo>+</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula></p>
<p>Next, we define the control effort <italic>u</italic>(<italic>t</italic>) as the sum of a linear part and an adaptive one, that is <inline-formula id="pone.0172761.e061"><alternatives><graphic id="pone.0172761.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:mi>u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>lin</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>u</italic><sub>lin</sub>(<italic>t</italic>) is given by <xref ref-type="disp-formula" rid="pone.0172761.e055">Eq (20)</xref> and <italic>u</italic><sub>ad</sub>(<italic>t</italic>) needs to be designed. Accordingly, <xref ref-type="disp-formula" rid="pone.0172761.e060">Eq (24)</xref> can be simplified to the following expression,
<disp-formula id="pone.0172761.e062"><alternatives><graphic id="pone.0172761.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e062" xlink:type="simple"/><mml:math display="block" id="M62"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>u</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup></mml:mfrac> <mml:msup><mml:mi>K</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mfenced></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula></p>
<p>Since <italic>A</italic><sub>r</sub> is designed to be Hurwitz, by choosing <italic>u</italic><sub>ad</sub>(<italic>t</italic>) as follows
<disp-formula id="pone.0172761.e063"><alternatives><graphic id="pone.0172761.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e063" xlink:type="simple"/><mml:math display="block" id="M63"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mtext>ad</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup></mml:mfrac> <mml:msup><mml:mi>K</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
the error dynamics <xref ref-type="disp-formula" rid="pone.0172761.e062">Eq (25)</xref> simplifies to <inline-formula id="pone.0172761.e064"><alternatives><graphic id="pone.0172761.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> which guarantees asymptotic stability and hence convergence of <italic>e</italic><sub>a</sub>(<italic>t</italic>) to 0.</p>
<p>However, since the values of <italic>W</italic>* and <italic>λ</italic>* are unknown, the ideal controller <xref ref-type="disp-formula" rid="pone.0172761.e063">Eq (26)</xref> cannot be implemented. Hence, the ideal control law needs to be modified into an adaptive one which, instead of those ideal values, implements adaptive variables <inline-formula id="pone.0172761.e065"><alternatives><graphic id="pone.0172761.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0172761.e066"><alternatives><graphic id="pone.0172761.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p><bold>Theorem 2</bold>. Consider the system <xref ref-type="disp-formula" rid="pone.0172761.e051">Eq (18)</xref>, the reference system <xref ref-type="disp-formula" rid="pone.0172761.e057">Eq (21)</xref>, and the adaptation laws given by
<disp-formula id="pone.0172761.e067"><alternatives><graphic id="pone.0172761.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mtext>sign</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mo>Γ</mml:mo> <mml:mi>K</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mtext>a</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mtext>d</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>e</mml:mi> <mml:mtext>a</mml:mtext> <mml:mtext>T</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula>
<disp-formula id="pone.0172761.e068"><alternatives><graphic id="pone.0172761.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e068" xlink:type="simple"/><mml:math display="block" id="M68"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mtext>sign</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mo>Γ</mml:mo> <mml:mi>W</mml:mi></mml:msub> <mml:mi>ϕ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>e</mml:mi> <mml:mtext>a</mml:mtext> <mml:mtext>T</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
where Γ<sub><italic>K</italic></sub> &gt; 0 and Γ<sub><italic>W</italic></sub> &gt; 0 are the adaptation gains. The closed loop system given by Eqs (<xref ref-type="disp-formula" rid="pone.0172761.e051">18</xref>), (<xref ref-type="disp-formula" rid="pone.0172761.e057">21</xref>), (<xref ref-type="disp-formula" rid="pone.0172761.e067">27</xref>) and (<xref ref-type="disp-formula" rid="pone.0172761.e068">28</xref>) with the adaptive control law
<disp-formula id="pone.0172761.e069"><alternatives><graphic id="pone.0172761.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e069" xlink:type="simple"/><mml:math display="block" id="M69"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mtext>ad</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced> <mml:mo>-</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(29)</label></disp-formula>
is Lyapunov stable and the tracking error <italic>e</italic><sub>ad</sub>(<italic>t</italic>) converges to zero.</p>
<p><bold>Proof</bold>. By defining the difference between the ideal gains and the adaptive gains as <inline-formula id="pone.0172761.e070"><alternatives><graphic id="pone.0172761.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup></mml:mfrac> <mml:msup><mml:mi>K</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0172761.e071"><alternatives><graphic id="pone.0172761.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mrow><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≜</mml:mo> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, the error dynamics can be rewritten as follows,
<disp-formula id="pone.0172761.e072"><alternatives><graphic id="pone.0172761.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e072" xlink:type="simple"/><mml:math display="block" id="M72"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced> <mml:mo>+</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mfenced></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(30)</label></disp-formula></p>
<p>Next, the following Lyapunov function candidate is introduced,
<disp-formula id="pone.0172761.e073"><alternatives><graphic id="pone.0172761.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e073" xlink:type="simple"/><mml:math display="block" id="M73"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:msub><mml:mi>e</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mi>K</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mi>W</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula>
where <inline-formula id="pone.0172761.e074"><alternatives><graphic id="pone.0172761.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>×</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is a positive definite matrix. Using Eqs (<xref ref-type="disp-formula" rid="pone.0172761.e072">30</xref>), (<xref ref-type="disp-formula" rid="pone.0172761.e067">27</xref>) and (<xref ref-type="disp-formula" rid="pone.0172761.e068">28</xref>), the Lyapunov derivative is determined by computing the time derivative of <xref ref-type="disp-formula" rid="pone.0172761.e073">Eq (31)</xref> along the trajectories of <xref ref-type="disp-formula" rid="pone.0172761.e072">Eq (30)</xref> <disp-formula id="pone.0172761.e075"><alternatives><graphic id="pone.0172761.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e075" xlink:type="simple"/><mml:math display="block" id="M75"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mi>K</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mover accent="true"><mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>|</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mi>W</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mover accent="true"><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mi>P</mml:mi> <mml:mo>+</mml:mo> <mml:mi>P</mml:mi> <mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:mtext>sign</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mfenced> <mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mi>K</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msup><mml:mover accent="true"><mml:mover accent="true"><mml:mi>K</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:mtext>sign</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced> <mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mi>W</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msup><mml:mover accent="true"><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>˙</mml:mo></mml:mover> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mi>P</mml:mi> <mml:mo>+</mml:mo> <mml:mi>P</mml:mi> <mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>Q</mml:mi> <mml:msub><mml:mi>e</mml:mi> <mml:mi mathvariant="normal">a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula>
where the last inequality follows from the fact that <inline-formula id="pone.0172761.e076"><alternatives><graphic id="pone.0172761.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mrow><mml:mi>Q</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>×</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is positive definite since it satisfies the Lyapunov algebraic equation <inline-formula id="pone.0172761.e077"><alternatives><graphic id="pone.0172761.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mi>P</mml:mi> <mml:mo>+</mml:mo> <mml:mi>P</mml:mi> <mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>Q</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> with <italic>P</italic> positive definite and <italic>A</italic><sub>r</sub> Hurwitz. Hence, LaSalle-Yoshizawa Theorem guarantees that <italic>e</italic><sub>a</sub>(<italic>t</italic>) will converge to zero as time goes to infinity and all signals stay bounded [<xref ref-type="bibr" rid="pone.0172761.ref040">40</xref>].</p>
</sec>
</sec>
<sec id="sec008">
<title>Experimental design</title>
<p>To validate the results obtained from simulation, experiments were carried out for the closed-loop controllers: PI, MRAC and ADP-PI systems. Since open-loop systems performances are not guaranteed to remain within acceptable limits, while closed-loop systems are known to be more accurate due to feedback, no open-loop systems were considered in experimentation. Thus, the main focus of the paper is the application of an optimal approach, i.e. closed-loop control, for muscle stimulation. In our experiments, the fast contracting EDL mouse muscle was activated at 100Hz to evoke tetanic contractions.</p>
<p>Twenty-four male C57/BL10 ScN mice with ages ranging from 12 to 32 weeks (Jackson Laboratories) were fed standard, irradiated Envigo Teklad Global 18% Protein Rodent Diet (2918) (Cambridgeshire, UK) and provided water <italic>ad libitum</italic>. They were maintained in a temperature controlled vivarium between 68°F–79°F on a 12 hour light/ dark cycle. Cages were maintained by vivarium staff as needed. Mean body mass was 28.04 ± 4.41 g. Mice were euthanized with CO<sub>2</sub> to carry out the experiments. Eight mice were used (N = 8) for each type of controller. One muscle was used per animal. All procedures were approved by the Institutional Animal Care and Use Committee (IACUC No. 08-119-HNFE) at Virginia Tech. The approval was obtained prior to the start of the study. All efforts were made to minimize animal suffering. After euthanasia with CO<sub>2</sub>, one EDL muscle was surgically removed. Once removed, the muscle was incubated in a physiological salt solution gassed with 95%O<sub>2</sub>, 5%CO<sub>2</sub> at room temperature (20°C). Since isolated muscle viability <italic>ex vivo</italic> decreases with increased temperature, we selected room temperature to maximize muscle viability [<xref ref-type="bibr" rid="pone.0172761.ref042">42</xref>]. The muscle aligned equidistant between two platinum electrodes. Temperature was maintained between 16°C–17°C. The EDL muscle was set at 1g of resting tension which corresponds to <inline-formula id="pone.0172761.e078"><alternatives><graphic id="pone.0172761.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msubsup><mml:mi>l</mml:mi> <mml:mn>0</mml:mn> <mml:mi mathvariant="normal">M</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, prior to the initial stimulation.</p>
<p>During muscle activation, mass trajectory was measured using a linear encoder (Renishaw LM15, IL). Feedback was captured from the instantaneous position to minimize the error, <italic>e</italic>(<italic>t</italic>), between the desired predefined trajectory and the actual muscle contraction. Each contraction trial was executed at a stimulation frequency of 100Hz with a duration ranging from 7s to 10s. The constant voltage applied from the stimulator (Aurora Scientific Inc., 701B stimulator) to the EDL muscle bath was set at 25V and a variable current limited to 1A. The resting tension at <inline-formula id="pone.0172761.e079"><alternatives><graphic id="pone.0172761.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:msubsup><mml:mi>l</mml:mi> <mml:mn>0</mml:mn> <mml:mi mathvariant="normal">M</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> was sustained between each contraction; the muscle shortened 20% to 40% of <inline-formula id="pone.0172761.e080"><alternatives><graphic id="pone.0172761.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msubsup><mml:mi>l</mml:mi> <mml:mn>0</mml:mn> <mml:mi mathvariant="normal">M</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> during contractions [<xref ref-type="bibr" rid="pone.0172761.ref042">42</xref>]. Each EDL muscle was stimulated using either the PI, MRAC, or ADP-PI controller. Measurements were recorded, which primarily included muscle force, muscle contraction, and twitch responses. The latter were recorded at the beginning and between trials to monitor muscle fatigue and assess muscle decay. Furthermore, resting periods of one minute were provided between trials to ensure the quality of the muscle. The muscles’ predefined trajectories included step, sinusoidal, ramp, and square inputs. After the conclusion of each trial, physical measurements of the muscle including muscle mass and muscle length at resting tension were recorded. The average muscle mass and muscle length were 0.0142±0.0024g and 10.44±0.69mm, respectively. A timeline of events describing the step by step process for an experiment is detailed on Supporting Information <xref ref-type="supplementary-material" rid="pone.0172761.s006">S3 Table</xref>.</p>
<sec id="sec009">
<title>Controller setup</title>
<p>A host computer supported the exchange communication between the muscle’s experimental and controller setup, as displayed in <xref ref-type="fig" rid="pone.0172761.g006">Fig 6</xref>. The host program configured the data acquisition board NI sbRIO-9612 (National Instruments, TX) to update the parameters on the real-time controllers. The board recorded and sampled at 250Hz. The NI sbRIO-9612 operated a 400MHz microprocessor and a 2M field programmable gate array (FPGA). The FPGA outputted a digital pulse width modulation (PWM) signal at a frequency of 100 Hz, which consists of a succession of pulses in which the pulse duration is determined by the feedback controllers to output the adequate stimulation. The PWM signal set by the control effort, <italic>u</italic>(<italic>t</italic>), has a pulse duration saturation limit between 0<italic>μ</italic>s and a configurable upper limit of 200<italic>μ</italic>s. The FPGA sends the PWM stimulation signal via the digital output ports to the external trigger on the current stimulator, which are connected to the platinum electrodes.</p>
<fig id="pone.0172761.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Controller setup displaying the interface between the controller and experimental setup.</title>
<p>The control effort, <italic>u</italic>(<italic>t</italic>), determines the parameters of the duty cycle transmitted to the FPGA, which onsets the muscle contraction.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g006" xlink:type="simple"/>
</fig>
<p>Muscle contraction was measured through a magnetic linear encoder (Renishaw, IL) with a resolution of 5<italic>μ</italic>m. The signal from the encoder, comprised of two square waves in quadrature, was detected by the FPGA through the digital input pins at a rate of 1MHz. The high sample rate ensures all encoder pulses are considered. The position information from the FPGA was sampled at a rate of 250Hz. Simultaneously, the controller, running on the microprocessor, updated the output and pulse width parameters from the FPGA using the measured position. Moreover, position measurements, adaptive gains for the MRAC and the ADP-PI controller as well as desired trajectories were updated and saved on the host computer.</p>
</sec>
<sec id="sec010">
<title>Statistical analyses</title>
<p>Four controllers (one open-loop and three closed-loop) were evaluated in simulation and the closed-loop controllers were validated experimentally. Four trajectories were implemented per controller. In the case of the simulations, tuned trajectories were attained (deterministic results). For the experimental results, trials were carried out for all trajectories. Mean and standard deviation (<italic>x</italic><sub><italic>μ</italic></sub> ± <italic>σ</italic><sub><italic>x</italic></sub>) were determined for the squared tracking error (STE) between the desired and/or reference trajectory and the actual trajectory. STE is determined as,
<disp-formula id="pone.0172761.e081"><alternatives><graphic id="pone.0172761.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e081" xlink:type="simple"/><mml:math display="block" id="M81"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>STE</mml:mtext> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac></mml:mstyle> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo> <mml:mtext>for PI controller</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac></mml:mstyle> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo> <mml:mtext>for MRAC and ADP—PI controllers</mml:mtext> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>In addition, mean settling time <inline-formula id="pone.0172761.e082"><alternatives><graphic id="pone.0172761.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for the step trajectory was calculated across all experiments per controller. To test significance, we evaluated normality visually through the quantile-quantile plot (Q-Q plot) of residuals and equality of variances via Levene’s test. To ensure normality, a square root transformation for the ramp and square trajectories was required. Furthermore, a Welch’s unequal variances t-test was performed. Since the data did not meet the homogeneity of variances assumption, we implemented the Games Howell post hoc test. Statistical analyses were performed using JMP (SAS Institute, Cary, North Carolina, USA). Significance was set at <italic>α</italic> &lt; 0.05. The statistical analyses focused on identifying differences between all controllers. The number of samples for each trajectory are detailed on <xref ref-type="table" rid="pone.0172761.t001">Table 1</xref>. We hypothesize the ADP-PI controller has the best performance overall.</p>
<table-wrap id="pone.0172761.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.t001</object-id>
<label>Table 1</label>
<caption>
<title>Number of trials from experiments used for statistical analysis.</title>
</caption>
<alternatives>
<graphic id="pone.0172761.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Trajectory</th>
<th align="right">PI</th>
<th align="right">MRAC</th>
<th align="right">ADP-PI</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Step</td>
<td align="right">33</td>
<td align="right">52</td>
<td align="right">20</td>
</tr>
<tr>
<td align="left">Sine</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">21</td>
</tr>
<tr>
<td align="left">Ramp</td>
<td align="right">6</td>
<td align="right">13</td>
<td align="right">11</td>
</tr>
<tr>
<td align="left">Square</td>
<td align="right">11</td>
<td align="right">9</td>
<td align="right">14</td>
</tr>
<tr>
<td align="left">N<sub>total</sub></td>
<td align="right">64</td>
<td align="right">89</td>
<td align="right">66</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
</sec>
<sec id="sec011" sec-type="results">
<title>Results</title>
<sec id="sec012">
<title>Overall observations regarding tuning of the controller gains for the PI, MRAC, and ADP-PI</title>
<p>Tuning of parameter gains were largely dependent on each muscle. To determine the appropriate gains for the control effort, we applied first a step input for tuning the muscle gains. All the trajectory responses exhibited friction, which was mainly attributed to the mass motion along the rail. Results are displayed in Figs <xref ref-type="fig" rid="pone.0172761.g007">7</xref>–<xref ref-type="fig" rid="pone.0172761.g011">11</xref>.</p>
<fig id="pone.0172761.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Step trajectories due to EDL muscle contraction using the PI, MRAC, and ADP-PI controllers from simulations and experiments.</title>
<p><italic>x</italic><sub><italic>μ</italic></sub> ± <italic>σ</italic> from experimental results as well as simulations, including the controllers and open-loop simulations, are shown to assess the controller performance in simulation and validate the outcome through experiments for the (A) PI controller, (B) MRAC controller, and (C) ADP-PI controller.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g007" xlink:type="simple"/>
</fig>
<fig id="pone.0172761.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Mean experimental step trajectories due to EDL muscle contraction using the PI, MRAC, and ADP-PI controllers.</title>
<p>The dashed lines represent the 2% upper and lower bounds to reach the desired trajectory set at 1mm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g008" xlink:type="simple"/>
</fig>
<fig id="pone.0172761.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Sine trajectories due to EDL muscle contraction using the PI, MRAC, and ADP-PI controllers from simulations and experiments.</title>
<p><italic>x</italic><sub><italic>μ</italic></sub> ± <italic>σ</italic> from experimental results as well as simulations, including the controllers and open-loop simulations, are shown to assess the controller performance in simulation and validate the outcome through experiments for the (A) PI controller, (B) MRAC controller, and (C) ADP-PI controller.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g009" xlink:type="simple"/>
</fig>
<fig id="pone.0172761.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Ramp trajectories due to EDL muscle contraction using the PI, MRAC, and ADP-PI controllers from simulations and experiments.</title>
<p><italic>x</italic><sub><italic>μ</italic></sub> ± <italic>σ</italic> from experimental results as well as simulations, including the controllers and open-loop simulations, are shown to assess the controller performance in simulation and validate the outcome through experiments for the (A) PI controller, (B) MRAC controller, and (C) ADP-PI controller.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g010" xlink:type="simple"/>
</fig>
<fig id="pone.0172761.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Square trajectories due to EDL muscle contraction using the PI, MRAC, and ADP-PI controllers from simulations and experiments.</title>
<p><italic>x</italic><sub><italic>μ</italic></sub> ± <italic>σ</italic> from experimental results as well as simulations, including the controllers and open-loop simulations, are shown to assess the controller performance in simulation and validate the outcome through experiments for the (A) PI controller, (B) MRAC controller, and (C) ADP-PI controller.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g011" xlink:type="simple"/>
</fig>
<p>The PI controller gains, <italic>k</italic><sub>P</sub> and <italic>k</italic><sub>I</sub>, are user-defined parameters which drive the response of the system. The input control effort obtained through the PI controller generated the appropriate PWM signal for muscle contraction. Examples of the pulse duration input signal and its corresponding output are shown in <xref ref-type="supplementary-material" rid="pone.0172761.s007">S2</xref>–<xref ref-type="supplementary-material" rid="pone.0172761.s008">S3</xref> Figs in the Supporting Information.</p>
<p>The MRAC controller required six tuning parameters. The MRAC controlled trajectories presented fluctuations during adaptation of the controller’s parameters. A sample of these parameters are listed for simulation and experiments on <xref ref-type="table" rid="pone.0172761.t002">Table 2</xref>. The adaptive gains, <italic>θ</italic><sub><italic>x</italic></sub>(<italic>t</italic>) and <italic>θ</italic><sub>r</sub>(<italic>t</italic>), are specified for <italic>t</italic> = 0, the tuning parameters, <italic>γ</italic><sub><italic>x</italic></sub> and <italic>γ</italic><sub>r</sub> ensures that <italic>e</italic><sub>ad</sub>(<italic>t</italic>) converges to zero, the constants, <italic>a</italic><sub>r</sub> and <italic>b</italic><sub>r</sub> describe the muscle model behavior. Specifying these tuning parameters allowed the MRAC controller to determine the required control input signal generating the pulse duration for muscle contraction. The pulse duration and its corresponding trajectory response are shown in Supporting Information <xref ref-type="supplementary-material" rid="pone.0172761.s009">S4</xref> and <xref ref-type="supplementary-material" rid="pone.0172761.s010">S5</xref> Figs.</p>
<table-wrap id="pone.0172761.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.t002</object-id>
<label>Table 2</label>
<caption>
<title>MRAC adaptive parameters implemented for all trajectories for a trial experiment and simulation.</title>
</caption>
<alternatives>
<graphic id="pone.0172761.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center"><italic>γ</italic><sub><italic>x</italic></sub> × 10<sup>5</sup> [<italic>m</italic><sup>−3</sup>]</th>
<th align="center"><italic>γ</italic><sub>r</sub> × 10<sup>5</sup> [<italic>m</italic><sup>−3</sup>]</th>
<th align="center"><italic>θ</italic><sub><italic>x</italic></sub>(0) [<italic>s</italic>/<italic>m</italic>]</th>
<th align="center"><italic>θ</italic><sub>r</sub>(0) [<italic>s</italic>/<italic>m</italic>]</th>
<th align="center"><italic>a</italic><sub>r</sub> [1/<italic>s</italic>], -<italic>b</italic><sub>r</sub> [<italic>m</italic>/<italic>s</italic><sup>2</sup>]</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Step exp</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">0.025</td>
<td align="char" char=".">0.040</td>
<td align="char" char=".">−2.0</td>
</tr>
<tr>
<td align="left">Step sim</td>
<td align="char" char=".">1.45</td>
<td align="char" char=".">1.45</td>
<td align="char" char=".">0.035</td>
<td align="char" char=".">0.140</td>
<td align="char" char=".">−2.0</td>
</tr>
<tr>
<td align="left">Sine exp</td>
<td align="char" char=".">8.00</td>
<td align="char" char=".">5.00</td>
<td align="char" char=".">0.020</td>
<td align="char" char=".">0.060</td>
<td align="char" char=".">−2.0</td>
</tr>
<tr>
<td align="left">Sine sim</td>
<td align="char" char=".">9.50</td>
<td align="char" char=".">2.50</td>
<td align="char" char=".">0.010</td>
<td align="char" char=".">0.060</td>
<td align="char" char=".">−2.0</td>
</tr>
<tr>
<td align="left">Ramp exp</td>
<td align="char" char=".">8.00</td>
<td align="char" char=".">5.00</td>
<td align="char" char=".">0.020</td>
<td align="char" char=".">0.060</td>
<td align="char" char=".">−2.0</td>
</tr>
<tr>
<td align="left">Ramp sim</td>
<td align="char" char=".">10.50</td>
<td align="char" char=".">8.50</td>
<td align="char" char=".">0.080</td>
<td align="char" char=".">0.060</td>
<td align="char" char=".">−2.0</td>
</tr>
<tr>
<td align="left">Square exp</td>
<td align="char" char=".">8.00</td>
<td align="char" char=".">5.00</td>
<td align="char" char=".">0.020</td>
<td align="char" char=".">0.060</td>
<td align="char" char=".">−2.0</td>
</tr>
<tr>
<td align="left">Square sim</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">0.025</td>
<td align="char" char=".">0.040</td>
<td align="char" char=".">−2.0</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The ADP-PI controller was implemented assuming linear dynamics for muscle behavior. This nonlinear controller, which defines the control input, <italic>u</italic>(<italic>t</italic>), is composed of a linear and adaptive component. For the ADP-PI controller, the function <italic>ϕ</italic>(<italic>x</italic>(<italic>t</italic>)) was chosen as,
<disp-formula id="pone.0172761.e083"><alternatives><graphic id="pone.0172761.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e083" xlink:type="simple"/><mml:math display="block" id="M83"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϕ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mfenced> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:mo form="prefix">sin</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(33)</label></disp-formula>
which was arbitrarily selected based on the muscle controlled trajectories. The known state constant <italic>a</italic> and the known input constant <italic>b</italic> were determined through computational simulations using previously calculated PI gains, <italic>k</italic><sub>P</sub> and <italic>k</italic><sub>I</sub>. These were then used to determine the <italic>P</italic> matrix by solving <inline-formula id="pone.0172761.e084"><alternatives><graphic id="pone.0172761.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msubsup> <mml:mi>P</mml:mi> <mml:mo>+</mml:mo> <mml:mi>P</mml:mi> <mml:msub><mml:mi>A</mml:mi> <mml:mi mathvariant="normal">r</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>Q</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, prior to the start of each trial.</p>
<p>The ADP-PI controller converged at a rate proportional to muscle fiber contraction, thus minimizing the error between the reference trajectory and the actual trajectory. This was observed throughout all trajectories using the ADP-PI controller. The controller required tuning of ten parameters, which are listed in <xref ref-type="table" rid="pone.0172761.t003">Table 3</xref>, for the simulation and experimental validation. First, the linear gains, <italic>k</italic><sub>P</sub> and <italic>k</italic><sub>I</sub> were computed using a method similar to the Ziegler—Nichols Critical Gain method presented in [<xref ref-type="bibr" rid="pone.0172761.ref035">35</xref>]. The constants, <italic>a</italic> and <italic>b</italic> are parameters determined for the linear muscle model behavior as described by <xref ref-type="disp-formula" rid="pone.0172761.e044">Eq (17)</xref>. The adaptive gains, Γ<sub><italic>K</italic></sub> and Γ<sub><italic>W</italic></sub>, in <xref ref-type="table" rid="pone.0172761.t003">Table 3</xref> are initial values set at <italic>t</italic> = 0. In this way, the system can converge quickly through adaptation. Moreover, <xref ref-type="supplementary-material" rid="pone.0172761.s011">S6</xref> and <xref ref-type="supplementary-material" rid="pone.0172761.s012">S7</xref> Figs Design in the Supporting Information displayed the pulse duration input signal and its corresponding output for all trajectories in experiment. Trajectory dispersion was smaller compared to the PI and MRAC results as determined by the <italic>σ</italic> bounds.</p>
<table-wrap id="pone.0172761.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.t003</object-id>
<label>Table 3</label>
<caption>
<title>Parameters of the ADP-PI controller including the linear gains, <italic>k</italic><sub>P</sub> and <italic>k</italic><sub>I</sub>, and state constants: <italic>a</italic>, <italic>b</italic> to describe the first order model for muscle behavior.</title>
</caption>
<alternatives>
<graphic id="pone.0172761.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center"><italic>k</italic><sub>P</sub> [<italic>s</italic>/<italic>m</italic>]</th>
<th align="center"><italic>k</italic><sub>I</sub> [1/<italic>m</italic>]</th>
<th align="center"><italic>a</italic> [1/<italic>s</italic>]</th>
<th align="center"><italic>b</italic> [<italic>m</italic>/<italic>s</italic><sup>2</sup>]</th>
<th align="center">Γ<sub><italic>K</italic><sub>1</sub></sub>, Γ<sub><italic>K</italic><sub>2</sub></sub> × 10<sup>−1</sup> [<italic>s</italic><sup>2</sup>/<italic>m</italic><sup>3</sup>]</th>
<th align="center">Γ<sub><italic>W</italic><sub>1</sub></sub>, Γ<sub><italic>W</italic><sub>2</sub></sub>, Γ<sub><italic>W</italic><sub>3</sub></sub>, Γ<sub><italic>W</italic><sub>4</sub></sub> × 10<sup>−4</sup> [<italic>s</italic><sup>2</sup>/<italic>m</italic><sup>2</sup>]</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Step exp</td>
<td align="char" char=".">0.050</td>
<td align="char" char=".">0.75</td>
<td align="char" char=".">-11.55</td>
<td align="char" char=".">2.89</td>
<td align="char" char=".">0.10</td>
<td align="char" char=".">0.10</td>
</tr>
<tr>
<td align="left">Step sim</td>
<td align="char" char=".">0.090</td>
<td align="char" char=".">0.40</td>
<td align="char" char=".">-3.50</td>
<td align="char" char=".">8.50</td>
<td align="char" char=".">0.10</td>
<td align="char" char=".">0.10</td>
</tr>
<tr>
<td align="left">Sine exp</td>
<td align="char" char=".">0.055</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">-11.55</td>
<td align="char" char=".">2.89</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">1.00</td>
</tr>
<tr>
<td align="left">Sine sim</td>
<td align="char" char=".">0.400</td>
<td align="char" char=".">0.25</td>
<td align="char" char=".">-1.50</td>
<td align="char" char=".">12.50</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">1.00</td>
</tr>
<tr>
<td align="left">Ramp exp</td>
<td align="char" char=".">0.035</td>
<td align="char" char=".">0.90</td>
<td align="char" char=".">-57.75</td>
<td align="char" char=".">2.89</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">1.00</td>
</tr>
<tr>
<td align="left">Ram sim</td>
<td align="char" char=".">0.080</td>
<td align="char" char=".">0.90</td>
<td align="char" char=".">-3.50</td>
<td align="char" char=".">8.50</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">1.00</td>
</tr>
<tr>
<td align="left">Square exp</td>
<td align="char" char=".">0.055</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">-50.0</td>
<td align="char" char=".">2.89</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">1.00</td>
</tr>
<tr>
<td align="left">Square sim</td>
<td align="char" char=".">0.075</td>
<td align="char" char=".">0.37</td>
<td align="char" char=".">-3.50</td>
<td align="char" char=".">10.50</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">1.00</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec013">
<title>Muscle contractions following step input trajectories show faster convergence using the ADP-PI controller</title>
<p>The results obtained implementing the step input trajectory for the three controllers are displayed in <xref ref-type="fig" rid="pone.0172761.g007">Fig 7A–7C</xref>. The plots include mean experimental step trajectories (<italic>x</italic><sub><italic>μ</italic></sub> ± <italic>σ</italic>), controller simulations, and open-loop simulations as well as the desired and reference step input trajectories. Overall, no overshoot was observed for all the controllers. The mean and standard deviation (<italic>x</italic><sub><italic>μ</italic></sub> ± <italic>σ</italic> bounds) displayed faster convergence to the reference trajectory using ADP-PI controller when compared to the PI and MRAC controllers. Moreover, trajectory dispersion was smaller using the ADP-PI controller when compared to the PI and MRAC results as determined by the <italic>σ</italic> bounds.</p>
<p>We evaluated the mean settling times for convergence using the PI, MRAC and ADP-PI controllers as shown in <xref ref-type="fig" rid="pone.0172761.g008">Fig 8</xref>, that is, the time response to reach and maintain 2% of the final value, set at 1mm. The mean settling time using the PI controller was <inline-formula id="pone.0172761.e085"><alternatives><graphic id="pone.0172761.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>s</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mn>6.5</mml:mn> <mml:mtext>s</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula>, while the mean settling time using the MRAC controller exhibited fluctuations and did not settle during the 8s of muscle stimulation. The mean settling time using the ADP-PI controller is reached at <inline-formula id="pone.0172761.e086"><alternatives><graphic id="pone.0172761.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2.3</mml:mn> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula>, which is almost three times faster than using the PI controller.</p>
<p>Comparing the mean settling times to simulations for each controller, we observed the PI controller simulation settling at <italic>t</italic><sub>s</sub> = 3.4s while remaining within the variance bounds of the experimental results (refer to <xref ref-type="fig" rid="pone.0172761.g007">Fig 7A</xref>) and in turn capturing the muscle activation behavior similar to the experiments, while the open-loop simulation converged much faster at <italic>t</italic><sub>s</sub> = 1.1s. The MRAC controller simulation (as shown in <xref ref-type="fig" rid="pone.0172761.g007">Fig 7B</xref>) converged after 3.8s to the reference trajectory. The open-loop trajectory responded rapidly to the reference trajectory and settled after <italic>t</italic><sub>s</sub> = 1.1s. Lastly, the ADP-PI controller simulation, as displayed in <xref ref-type="fig" rid="pone.0172761.g007">Fig 7C</xref> settled at <italic>t</italic><sub>s</sub> = 1.0s to the reference trajectory compared to the mean settling time at <inline-formula id="pone.0172761.e087"><alternatives><graphic id="pone.0172761.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2.3</mml:mn> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula>, while the open-loop simulation settled at <inline-formula id="pone.0172761.e088"><alternatives><graphic id="pone.0172761.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0172761.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1.1</mml:mn> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec014">
<title>Muscle contractions following sine input trajectories exhibit a lag response for all controllers and highly oscillatory behavior using the MRAC controller</title>
<p>The sine trajectories are shown in <xref ref-type="fig" rid="pone.0172761.g009">Fig 9A–9C</xref>. The experimental and simulation responses using the PI controller, shown in <xref ref-type="fig" rid="pone.0172761.g009">Fig 9A</xref>, exhibited some oscillatory behavior during relaxation at interval sets [3s, 5s] and [8s, 10s] as opposed to the open-loop simulation. The PI simulation was within bounds of the experimental trajectories while the open-loop case did not remain within the bounds during the initial contraction. The oscillations during muscle relaxation were attributed to the extension spring in the setup. This effect likely indicated that the spring force after muscle contraction was pulling the muscle faster than the time required for the muscle to return to its original length after stimulation. The MRAC sine trajectories from simulation and experiment were also characterized by oscillatory behavior during adaptation, as shown in <xref ref-type="fig" rid="pone.0172761.g009">Fig 9B</xref>. Both responses followed the set reference trajectory as opposed to the open-loop case, which was characterized by a higher amplitude and did not capture these fluctuations. Lastly, the sine trajectories using the ADP-PI controller displayed in <xref ref-type="fig" rid="pone.0172761.g009">Fig 9C</xref>, did not exhibit fluctuations as compared to the MRAC results. These trajectories followed the reference system in both experiment and simulation, but lagged after 3s of stimulation.</p>
</sec>
<sec id="sec015">
<title>Muscle contractions following ramp input trajectories are characterized by a response delay for all controllers</title>
<p>Oscillations prevailed for the ramp trajectories in experiment and simulation as shown in <xref ref-type="fig" rid="pone.0172761.g010">Fig 10A–10C</xref> as well as a delayed response of approximately 1s for all controllers. For the PI controller (<xref ref-type="fig" rid="pone.0172761.g010">Fig 10A</xref>), the mean ramp response and distribution attenuated after 6.5s as evidenced by the <italic>σ</italic> bounds converging closer to the desired trajectory. The MRAC controller in experiment and simulation showed highly oscillatory behavior throughout the 10s of stimulation as observed in <xref ref-type="fig" rid="pone.0172761.g010">Fig 10B</xref>. On the contrary, the ramp trajectories using the ADP-PI controller in experiment and simulation (refer to <xref ref-type="fig" rid="pone.0172761.g010">Fig 10C</xref>) attenuated its oscillatory behavior after 5.5s of stimulation, which could be attributed to the adaption component of the system.</p>
</sec>
<sec id="sec016">
<title>Muscle contractions following square input trajectories present a delay sustaining full contraction for all controllers</title>
<p>The square trajectories are illustrated in <xref ref-type="fig" rid="pone.0172761.g011">Fig 11A–11C</xref>. Stiction was observed for the square trajectories in simulation and experiment using the PI and ADP-PI controllers as shown in <xref ref-type="fig" rid="pone.0172761.g011">Fig 11A and 11C</xref>. The experimental and simulations using the MRAC controller sustained oscillatory behavior throughout the 9s of stimulation as observed in <xref ref-type="fig" rid="pone.0172761.g011">Fig 11B</xref>. This behavior was evident through the dispersion of the mean as shown by the <italic>σ</italic> bounds during contraction. Moreover, we observed that no experimental samples restored to its original position after the initial contraction. This behavior could be an indication of muscle fatigue and friction between the mass and rail of the setup. In addition, the closed-loop simulations presented similar behavior as the experiments as opposed to the open-loop simulation which did not capture the nonlinearities affecting the system.</p>
</sec>
<sec id="sec017">
<title>EDL muscle response to sine and ramp trajectories is significantly different across the closed-loop controllers</title>
<p>To evaluate the treatment of the controllers for muscle stimulation in experiment, the mean STE was used to test the following hypotheses: (1) the condition of the controller is significant and has an effect on muscle stimulation, and (2) the ADP-PI controller is the optimal controller to implement for muscle stimulation compared to PI and MRAC.</p>
<p>To assess controller tracking performance, we analyzed the mean STE values between the three controllers for all trajectories. Box plots of the step and sine trajectories are shown in <xref ref-type="fig" rid="pone.0172761.g012">Fig 12</xref>. For the step trajectories, normality condition was satisfied from observations of the Q-Q plot of the residuals and we tested the means with Welch’s unequal variances t-test. There was moderate evidence suggesting the PI (<italic>x</italic><sub><italic>μ</italic></sub> ± <italic>σ</italic>, 0.031 ± 0.02), MRAC (0.066 ± 0.11), and ADP-PI (0.028 ± 0.01) controllers means were equal (<italic>F</italic>(2, 65.8) = 2.81, <italic>p</italic> = 0.06). A pair-wise comparison using Games-Howell post-hoc test revealed moderate evidence of differences between the PI and MRAC controllers (Mean Difference (MD) = 0.034, <italic>p</italic> = 0.09) and MRAC and ADP-PI controllers (MD = 0.037, <italic>p</italic> = 0.06). No significant difference was observed between PI and ADP-PI controllers (MD = 0.003, <italic>p</italic> = 0.77).</p>
<fig id="pone.0172761.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Box plots of the mean Squared Tracking Error (STE) due to EDL muscle contraction for the step and sine input trajectories.</title>
<p>Statistical significance is denoted by *, # (<italic>p</italic> &lt; 0.05).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g012" xlink:type="simple"/>
</fig>
<p>The sine trajectories satisfied the normality condition. Welch’s unequal variances t-test showed a strong evidence of a difference among the means of the PI (0.020 ± 0.02), MRAC (0.049 ± 0.04), and ADP-PI (0.015 ± 0.01) controllers ((<italic>F</italic>(2, 23.8) = 5.14, <italic>p</italic> = 0.01). A pair-wise comparison via Games-Howell post-hoc test reported significant differences between the PI and MRAC controllers (MD = 0.030, <italic>p</italic> = 0.04) and between the MRAC and ADP-PI controllers (MD = 0.034, <italic>p</italic> = 0.02). No significance was observed between PI and ADP-PI controllers (MD = 0.005, <italic>p</italic> = 0.62).</p>
<p>For the ramp and square trajectories, box plots are displayed in <xref ref-type="fig" rid="pone.0172761.g013">Fig 13</xref>. For these trajectories, we performed a square root transformation to ensure normality, which was validated through Q-Q plots of the residuals. For the ramp trajectories, the Welch’s unequal variances t-test showed strong evidence of the difference in means (<italic>F</italic>(2, 15.7), <italic>p</italic> &gt; 0.0001) for the PI (0.076 ± 0.01), MRAC (0.129 ± 0.07), and ADP-PI (0.114 ± 0.01) controllers. Through a pair-wise comparison using Games-Howell post-hoc test, significance was observed between the PI and MRAC controllers (MD = 0.053, <italic>p</italic> = 0.04) and the PI and ADP-PI controllers (MD = 0.038, <italic>p</italic> = 0.003). There was no significance between MRAC and ADP-PI controllers (MD = 0.014, <italic>p</italic> = 0.73). Lastly, the square trajectories satisfied the normality condition. The Welch’s unequal variances t-test presented moderate evidence of difference in means (<italic>F</italic>(2, 15.3) = 3.09, <italic>p</italic> = 0.07) for the PI (0.222 ± 0.03), MRAC (0.246 ± 0.06), and ADP-PI (0.204 ± 0.02) controllers. Through the Games-Howell post-hoc test no significant differences were observed between the PI and MRAC (MD = 0.023, <italic>p</italic> = 0.55), MRAC and ADP-PI (MD = 0.042, <italic>p</italic> = 0.17), and between PI and ADP-PI controllers (MD = 0.018, <italic>p</italic> = 0.19).</p>
<fig id="pone.0172761.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0172761.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Box plots of the mean tracking error (STE) due to EDL muscle contraction for the ramp and square input trajectories.</title>
<p>Statistical significance is denoted by *, # (<italic>p</italic> &lt; 0.05).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.g013" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec018" sec-type="conclusions">
<title>Conclusions</title>
<p>Here, we have presented numerical simulations of muscle stimulation via adaptive and linear closed-loop controllers as well as experimental validation of these systems <italic>ex vivo</italic>. By testing the efficacy of the controllers using the EDL muscle in isolation, we can measure contractions solely due to the stimulation delivered by the control effort. The three feedback controllers are effective in tracking a variety of reference trajectories. In addition, the model simulated with the closed-loop controllers generally matched well with the experimental results, both in terms of quantitative metrics and qualitative behavior. Overall, experiments validated controller simulations since it captured nonlinearities such as delays and friction behaviors, which were not present in the open-loop responses.</p>
<p>All closed-loop controllers worked in simulation to track signals. To build the simulations, linear dynamics were assumed for muscle behavior while nonlinear controllers, with the exception of the PI controller and open-loop case, were applied. The successful outcomes of this comparative study highlights the advantage of feedback controllers in electrical stimulation without the requirements of higher order muscle models that carry great computational demands. Nevertheless, challenges still persist when implementing control systems for FES treatments, such as the nonlinearities of the muscle system, appropriate coordination of muscle group activation, non-physiological recruitment eliciting fatigue associated with muscle contractions, time delays of the biochemical processes between stimulation and the start of muscle contraction, spasticity, just to mention a few [<xref ref-type="bibr" rid="pone.0172761.ref012">12</xref>, <xref ref-type="bibr" rid="pone.0172761.ref016">16</xref>, <xref ref-type="bibr" rid="pone.0172761.ref043">43</xref>–<xref ref-type="bibr" rid="pone.0172761.ref046">46</xref>]. As pointed out by Narendra and Annaswammy [<xref ref-type="bibr" rid="pone.0172761.ref046">46</xref>], handling of biological systems, such as skeletal muscles, requires adaptation and understanding of the input/output relationship for the design of the controllers.</p>
<p>All closed-loop controllers are consistent with experiments. The closed-loop muscle system simulations qualitatively captured the behavior of the EDL mouse muscle as evidenced by the trajectory outputs in the Results section. Several assumptions were made when building, testing and coding the experimental system, which included Coulomb friction and no moment effects, among others. Moreover, spring reaction forces and friction contributed to the <italic>stick-slip</italic> behavior observed in all trajectories during muscle relaxation. These effects observed in experiments were captured by the closed-loop controllers in both simulation and experiments, as opposed to the open-loop cases.</p>
<p>The ADP-PI controller system has the best tracking performance compared to that of the PI and MRAC controller. The rate of muscle fiber contraction and adaptation worked in synergy to output adequate tracking of the reference system with minimal system error. Although ten parameters characterized the system, the linear and nonlinear components could be tuned separately for optimal output. Thus, the ADP-PI controller stimulated the muscle efficiently by providing real-time changes to the gains and by reducing the influence of perturbations in the system (e.g. small losses in muscle force over the course of the experiment). Overall, adaptation enabled fastest tracking error convergence and remained stable while the parameters varied in time. The ADP-PI controller best tracked the set trajectories by first using the PI component to approach the area of convergence, thus minimizing the system error while the adaptive component fine-tuned the controller. In this way, trajectory responses were characterized by minimal oscillatory behavior, as compared to the MRAC controller which lacks this synergy.</p>
<p>Closed-loop systems are capable of using the feedback information to minimize the system error and tracking of muscle contraction. However, comparing the closed-loop controllers in experiments through statistical analyses revealed a significant effect of controller type on muscle stimulation for the sine and ramp trajectory inputs. As shown in Figs <xref ref-type="fig" rid="pone.0172761.g012">12</xref>–<xref ref-type="fig" rid="pone.0172761.g013">13</xref>, mean squared tracking error was significantly different between the PI and MRAC as well as the MRAC and ADP-PI for the sine trajectories and the PI and MRAC as well as the PI and ADP-PI for the ramp trajectories. Overall, the ADP-PI had the smallest variance overall. The PI controller had a smaller variance compared to MRAC. On the other hand, MRAC showed faster adaptation compared to the rate of muscle fiber activation as characterized by overshoot and oscillations captured for both simulation and experiment. By incorporating the linear and adaptive components via the ADP-PI controller, we were able to apply a robust feedback system capable of handling system uncertainties and unmodeled dynamics. We conclude that ADP-PI controller offers the best performance due to its incorporation of the linear and adaptive components of the PI and MRAC systems.</p>
<p>From a theoretical perspective, closed-loop controllers mimic the feedback inherent in the nervous system, since our nerves carry out both commands to muscles and feedback to the central nervous system; thus closed-loop control may be better integrated with, biological systems. The open-loop approach is not a natural process and simulations for this case failed to capture the key characteristics observed in our FES experiments. Although the same muscle-mass-spring system was applied for all simulations, the open-loop case was unable to assess the muscle response through tracking and capture key behaviors, such as friction and response delays. Conversely, tuning capabilities through closed-loop systems have the ability to capture these behaviors and compensate for muscle fatigue by changing the control input and outputting the appropriate PWM signal.</p>
<p>Nevertheless, these controllers warrant further investigation, for example, to study the mismatch between the experimentally-observed control effort and that predicted by the model. Changes in the control effort are displayed in the Supporting Information section in <xref ref-type="supplementary-material" rid="pone.0172761.s007">S2</xref>–<xref ref-type="supplementary-material" rid="pone.0172761.s012">S7</xref> Figs. We observed that the experimental control effort was generally smaller for experiments than predicted by simulations. During experiments, the muscle was suspended in a bath submerged in ionized solution which was not represented in simulation. The differences between these control input signals and muscle response will be explored in future studies.</p>
<p>In conclusion, the application of feedback controllers, very rarely used in FES applications, has the potential to become an effective tool for treatments regarding skeletal muscle stimulation. Adaptive controllers, especially the ADP-PI controller, provide a beneficial strategy for muscle treatment by providing appropriate stimulation to the affected muscle and considering the muscle response to set stimulation. This <italic>proof of principle</italic> can be extrapolated to a clinical setting as a rehabilitation tool since it can provide patients with an efficient method of muscle activation. From a translational research perspective, next steps involve two major components: (1) medical device design to incorporate these controllers in a user-friendly rehabilitation tool comprising of electrodes, stimulator, and embedded systems tracking joint movement, and (2) standard input trajectories for tracking joint movement to ensure best practices for patient rehabilitation. Both aspects introduce new challenges to guarantee reliable medical device design, ensure safety procedures, and integrate human factors for future clinical trials.</p>
</sec>
<sec id="sec019">
<title>Supporting information</title>
<supplementary-material id="pone.0172761.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Nomenclature.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s002" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Skeletal muscle model.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s003" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Thelen muscle parameters for the skeletal muscle model.</title>
<p>These parameters were used for simulations of the EDL mouse muscle model.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s004" xlink:type="simple">
<label>S2 Appendix</label>
<caption>
<title>Tuning of controller procedure.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s005" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Various step trajectory responses due to EDL muscle contraction using the PI controller.</title>
<p>Different values for <italic>k</italic><sub>P</sub> and <italic>k</italic><sub>I</sub> are determined to identify the appropriate tuning parameters.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s006" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Timeline of muscle experiment.</title>
<p>A typical cascade of events when carrying out an experiment.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s007" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Samples of the step and sine pulse duration inputs and trajectory outputs using the PI controller.</title>
<p>Experimental sample applying the PI controller for muscle contraction compared to the muscle system simulation for the PI and open-loop case. Trajectories include (A) the step and (B) sine functions.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s008" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Samples of the ramp and square pulse duration inputs and trajectory outputs using the PI controller.</title>
<p>Experimental sample applying the PI controller for muscle contraction compared to the muscle system simulation for the PI and open-loop case. Trajectories include (C) ramp and (D) square functions.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s009" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Samples of the step and sine pulse duration inputs and trajectory outputs using the MRAC controller.</title>
<p>Experimental sample applying the MRAC controller for muscle contraction compared to the muscle system simulation for the MRAC and open-loop case. Trajectories include (A) the step and (B) sine functions.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s010" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Samples of the ramp and square pulse duration inputs and trajectory outputs using the MRAC controller.</title>
<p>Experimental sample applying the MRAC controller for muscle contraction compared to the muscle system simulation for the MRAC and open-loop case. Trajectories include (C) ramp and (D) square functions.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s011" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Samples of the step and sine pulse duration inputs and trajectory outputs using the ADP-PI controller.</title>
<p>Experimental sample applying the ADP-PI controller for muscle contraction compared to the muscle system simulation for the ADP-PI and open-loop case. Trajectories include (A) the step and (B) sine functions.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0172761.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0172761.s012" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Samples of the ramp and square pulse duration inputs and trajectory outputs using the ADP-PI controller.</title>
<p>Experimental sample applying the ADP-PI controller for muscle contraction compared to the muscle system simulation for the ADP-PI and open-loop case. Trajectories include (C) ramp and (D) square functions.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Many thanks to the National Science Foundation for funding this study (Grant Funding No. 0828114 and No. 1055315). The funders had no role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
<p>Special thanks to Dr. Elizabeth Jennings McGuffey, Assistant Professor in the Mathematics Department at the United States Naval Academy, who provided guidance on the experiments’ statistics.</p>
<p>Dr. Alexander Leonessa is the senior author and PI of the Center for Dynamic Systems Modeling and Control. This material is based upon work supported by (while serving at) the National Science Foundation.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0172761.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kralj</surname> <given-names>A. R.</given-names></name>, &amp; <name name-style="western"><surname>Bajd</surname> <given-names>T.</given-names></name> (<year>1989</year>) <source>Functional Electrical Stimulation: Standing and Walking after Spinal Cord Injury</source>. <publisher-name>CRC press</publisher-name>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sheffler</surname> <given-names>L. R.</given-names></name>, &amp; <name name-style="western"><surname>Chae</surname> <given-names>J.</given-names></name> (<year>2007</year>). <article-title>Neuromuscular Electrical Stimulation in Neurorehabilitation</article-title>. <source>Muscle &amp; Nerve</source>, <volume>35</volume>: <fpage>562</fpage>–<lpage>590</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/mus.20758" xlink:type="simple">10.1002/mus.20758</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0172761.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gregory</surname> <given-names>C.M.</given-names></name>, <name name-style="western"><surname>Chris</surname> <given-names>M.</given-names></name>, &amp; <name name-style="western"><surname>Scott</surname> <given-names>C.</given-names></name> (<year>2005</year>) <article-title>Recruitment Patterns in Human Skeletal Muscle During Electrical Stimulation</article-title>. <source>Physical Therapy</source>. <volume>85</volume>: <fpage>358</fpage>–<lpage>364</lpage>. <object-id pub-id-type="pmid">15794706</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maffiuletti</surname> <given-names>N. A.</given-names></name> (<year>2010</year>) <article-title>Physiological and Methodological Considerations for the Use of Neuromuscular Electrical Stimulation</article-title>. <source>European Journal of Applied Physiology</source>, <volume>110</volume>: <fpage>223</fpage>–<lpage>234</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00421-010-1502-y" xlink:type="simple">10.1007/s00421-010-1502-y</ext-link></comment> <object-id pub-id-type="pmid">20473619</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Al-Amood</surname> <given-names>W.</given-names></name>, &amp; <name name-style="western"><surname>Lewis</surname> <given-names>D.</given-names></name> (<year>1987</year>) <article-title>Fast-to-Slow Transition in Myosin Heavy Chain Expression of Rabbit Muscle Fibres Induced by chronic low-frequency stimulation</article-title>. <source>J. Physiol. (London)</source>. <volume>392</volume>: <fpage>377</fpage>–<lpage>395</lpage>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dennis</surname> <given-names>R. G.</given-names></name>, <name name-style="western"><surname>Dow</surname> <given-names>D. E.</given-names></name>, &amp; <name name-style="western"><surname>Faulkner</surname> <given-names>J. A.</given-names></name> (<year>2003</year>) <article-title>An implantable Device for Stimulation of Denervated Muscles in Rats</article-title>. <source>Medical Engineering &amp; Physics</source>. <volume>25</volume>: <fpage>239</fpage>–<lpage>253</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1350-4533(02)00193-5" xlink:type="simple">10.1016/S1350-4533(02)00193-5</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0172761.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eken</surname> <given-names>T.</given-names></name>, &amp; <name name-style="western"><surname>Gundersen</surname> <given-names>K.</given-names></name> (<year>1988</year>) <article-title>Electrical Stimulation Resembling Normal Motor-Unit Activity: Effects on Denervated Fast and Slow Rat Muscles</article-title>. <source>The Journal of Physiology</source>. <volume>402</volume>: <fpage>651</fpage>–<lpage>669</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.1988.sp017227" xlink:type="simple">10.1113/jphysiol.1988.sp017227</ext-link></comment> <object-id pub-id-type="pmid">3236252</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gundersen</surname> <given-names>K.</given-names></name>, &amp; <name name-style="western"><surname>Eken</surname> <given-names>T.</given-names></name> (<year>1992</year>) <article-title>The Importance of Frequency and Amount of Electrical Stimulation for Contractile Properties of Denervated Rat Muscles</article-title>. <source>Acta Physiologica Scandinavica</source>. <volume>145</volume>: <fpage>49</fpage>–<lpage>57</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1748-1716.1992.tb09335.x" xlink:type="simple">10.1111/j.1748-1716.1992.tb09335.x</ext-link></comment> <object-id pub-id-type="pmid">1502912</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Westgaard</surname> <given-names>R. H.</given-names></name>, &amp; <name name-style="western"><surname>Lomo</surname> <given-names>T.</given-names></name> (<year>1988</year>) <article-title>Control of Contractile Properties within Adaptive Ranges by Patterns of Impulse Activity in the Rat</article-title>. <source>The Journal of Neuroscience</source>. <volume>8</volume>: <fpage>4415</fpage>–<lpage>4426</lpage>. <object-id pub-id-type="pmid">3199182</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Williams</surname> <given-names>H.</given-names></name> (<year>1996</year>) <article-title>The Value of Continuous Electrical Muscle Stimulation Using a Completely Implantable System in the Preservation of Muscle Function following Motor Nerve Injury and Repair: An Experimental Study</article-title>. <source>Microsurgery</source>. <volume>17</volume>: <fpage>589</fpage>–<lpage>596</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/(SICI)1098-2752(1996)17:11%3C589::AID-MICR5%3E3.0.CO;2-K" xlink:type="simple">10.1002/(SICI)1098-2752(1996)17:11%3C589::AID-MICR5%3E3.0.CO;2-K</ext-link></comment> <object-id pub-id-type="pmid">9514517</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref011">
<label>11</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>D’Souza</surname> <given-names>A.</given-names></name> (<year>1988</year>) <source>Design of Control Systems</source>. <publisher-name>Prentice Hall PTR</publisher-name>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Popovic</surname> <given-names>D. B.</given-names></name> (<year>2014</year>) <article-title>Advances in Functional Electrical Stimulation</article-title>. <source>Journal of Electromyography and Kinesiology</source>. <volume>24</volume>(<issue>6</issue>): <fpage>795</fpage>–<lpage>802</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jelekin.2014.09.008" xlink:type="simple">10.1016/j.jelekin.2014.09.008</ext-link></comment> <object-id pub-id-type="pmid">25287528</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref013">
<label>13</label>
<mixed-citation publication-type="other" xlink:type="simple">Lynch, C.L. &amp; Popovic, M.R. (2005) Closed-Loop Control for FES: Past Work and Future Directions. 10<sup>th</sup> Annual Conference of the International FES Society. p. 2–4</mixed-citation>
</ref>
<ref id="pone.0172761.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lynch</surname> <given-names>C.L.</given-names></name> &amp; <name name-style="western"><surname>Popovic</surname> <given-names>M.R.</given-names></name> (<year>2012</year>) <article-title>A Comparison of Closed-Loop Control Algorithms for Regulating Electrically Stimulated Knee Movements in Individuals with Spinal Cord Injury</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source>. <volume>20</volume>(<issue>4</issue>): <fpage>539</fpage>–<lpage>548</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNSRE.2012.2185065" xlink:type="simple">10.1109/TNSRE.2012.2185065</ext-link></comment> <object-id pub-id-type="pmid">22772375</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Winter</surname> <given-names>D.</given-names></name> (<year>2009</year>) <source>Biomechanics and Motor Control of Human Movement</source>. <publisher-name>Wiley</publisher-name>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lynch</surname> <given-names>C.L.</given-names></name> &amp; <name name-style="western"><surname>Popovic</surname> <given-names>M.R.</given-names></name> (<year>2008</year>) <article-title>Functional Electrical Stimulation</article-title>. <source>IEEE Control Systems</source>. <volume>28</volume>: <fpage>40</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/MCS.2007.914689" xlink:type="simple">10.1109/MCS.2007.914689</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0172761.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hunt</surname> <given-names>K.J.</given-names></name>, <name name-style="western"><surname>Jaime</surname> <given-names>R-P</given-names></name>, &amp; <name name-style="western"><surname>Gollee</surname> <given-names>H.</given-names></name> (<year>2001</year>) <article-title>Robust Control of Electrically-Stimulated Muscle using Polynomial H infinity Design</article-title>. <source>Control Engineering Practice</source>. <volume>9</volume>(<issue>3</issue>): <fpage>313</fpage>–<lpage>328</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0967-0661(00)00126-X" xlink:type="simple">10.1016/S0967-0661(00)00126-X</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0172761.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chang</surname> <given-names>G. C.</given-names></name>, <name name-style="western"><surname>Lub</surname> <given-names>J. J.</given-names></name>, <name name-style="western"><surname>Liao</surname> <given-names>G. D.</given-names></name>, <name name-style="western"><surname>Lai</surname> <given-names>J. S.</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>C. K.</given-names></name>, <name name-style="western"><surname>Kuo</surname> <given-names>B. L.</given-names></name>, &amp; <name name-style="western"><surname>Kuo</surname> <given-names>T. S.</given-names></name> (<year>1997</year>). <article-title>A Neuro-Control System for the Knee Joint Position Control with Quadriceps Stimulation</article-title>. <source>IEEE Transactions on Rehabilitation Engineering</source>, <volume>5</volume>(<issue>1</issue>):<fpage>2</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/86.559344" xlink:type="simple">10.1109/86.559344</ext-link></comment> <object-id pub-id-type="pmid">9086380</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Riener</surname> <given-names>R.</given-names></name>, <name name-style="western"><surname>Quintern</surname> <given-names>J.</given-names></name>, &amp; <name name-style="western"><surname>Schmidt</surname> <given-names>G.</given-names></name> (<year>1996</year>). <article-title>Biomechanical Model of the Human Knee Evaluated by Neuromuscular Stimulation</article-title>. <source>Journal of Biomechanics</source>, <volume>29</volume>(<issue>9</issue>): <fpage>1157</fpage>–<lpage>1167</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0021-9290(96)00012-7" xlink:type="simple">10.1016/0021-9290(96)00012-7</ext-link></comment> <object-id pub-id-type="pmid">8872272</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref020">
<label>20</label>
<mixed-citation publication-type="other" xlink:type="simple">Rouhani, E. &amp; Erfanian, A. (2014) Adaptive Fuzzy Terminal-Based Neuro-Sliding Mode Control of Ankle-Joint Movement using Intraspinal Micro-Stimulation. 2014 IEEE 19th International Functional Electrical Stimulation Society Annual Conference (IFESS). IEEE 1–4.</mixed-citation>
</ref>
<ref id="pone.0172761.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Asadi</surname> <given-names>A-R.</given-names></name>, &amp; <name name-style="western"><surname>Erfanian</surname> <given-names>A.</given-names></name> (<year>2012</year>) <article-title>Adaptive Neuro-Fuzzy Sliding Mode Control of Multi-Joint Movement using Intraspinal Microstimulation</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source>. <volume>20</volume>(<issue>4</issue>):<fpage>499</fpage>–<lpage>509</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNSRE.2012.2197828" xlink:type="simple">10.1109/TNSRE.2012.2197828</ext-link></comment> <object-id pub-id-type="pmid">22711783</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brend</surname> <given-names>O.</given-names></name>, <name name-style="western"><surname>Freeman</surname> <given-names>C.</given-names></name> &amp; <name name-style="western"><surname>French</surname> <given-names>M.</given-names></name> <article-title>Multiple-Model Adaptive Control of Functional Electrical Stimulation</article-title>. <source>IEEE Transactions on Control Systems Technology</source>. <volume>23</volume>(<issue>5</issue>): <fpage>1901</fpage>–<lpage>1913</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCST.2015.2394508" xlink:type="simple">10.1109/TCST.2015.2394508</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0172761.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chizeck</surname> <given-names>H. J.</given-names></name>, <name name-style="western"><surname>Lan</surname> <given-names>N.</given-names></name>, <name name-style="western"><surname>Palmieri</surname> <given-names>L. S.</given-names></name>, &amp; <name name-style="western"><surname>Crago</surname> <given-names>P. E.</given-names></name> (<year>1991</year>) <article-title>Feedback Control of Electrically Stimulated Muscle using Simultaneous Pulse Width and Stimulus Period Modulation</article-title>. <source>Biomedical Engineering, IEEE Transactions on</source>. <volume>38</volume>: <fpage>1224</fpage>–<lpage>1234</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/10.137288" xlink:type="simple">10.1109/10.137288</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0172761.ref024">
<label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Zhang, D. G., &amp; Zhu, K. Y. (2004, September). Simulation Study of FES-Assisted Standing Up with Neural network control. In Engineering in Medicine and Biology Society. IEMBS’04. 26th Annual International Conference of the IEEE. 2: 4877–4880.</mixed-citation>
</ref>
<ref id="pone.0172761.ref025">
<label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Watanabe, T., Matsudaira, T., Kurosawa, K., Fujii, T., Futami, R., Hoshimiya, N., &amp; Ichie, M. (2002). Wrist joint control by multichannel closed-loop FES system: System Improvement and First Clinical Test. In Proc. 7th IFESS. pp. 265–267.</mixed-citation>
</ref>
<ref id="pone.0172761.ref026">
<label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Dingguo, Z., &amp; KuanYi, Z. (2004, July). Neural Network Control for Leg Rhythmic Movements via Functional Electrical Stimulation. In Neural Networks, 2004. Proceedings. 2004 IEEE International Joint Conference on IEEE. 2: 1245–1248.</mixed-citation>
</ref>
<ref id="pone.0172761.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Riess</surname> <given-names>J.</given-names></name>, <name name-style="western"><surname>Abbas</surname> <given-names>J. J.</given-names></name> (<year>2000</year>) <article-title>Adaptive Neural Network Control of Cyclic Movements Using Functional Neuromuscular Stimulation</article-title>. <source>IEEE Transactions on Rehabilitation Engineering</source>. <volume>8</volume>: <fpage>42</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/86.830948" xlink:type="simple">10.1109/86.830948</ext-link></comment> <object-id pub-id-type="pmid">10779107</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref028">
<label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Iannò, M., Ferrarin, M., Pedrocchi, A., &amp; Ferrigno, G. (2002) A Neuro-Adaptive Control System for Knee Joint Movements During Quadriceps Electrical Stimulation. In Annual Conference of the International Functional Electrical Stimulation Society.</mixed-citation>
</ref>
<ref id="pone.0172761.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hill</surname> <given-names>A.</given-names></name> (<year>1938</year>) <article-title>The Heat of Shortening and the Dynamic Constants of Muscle</article-title>. <source>Proceedings of the Royal Society of London Series B</source>. <volume>126</volume>: <fpage>136</fpage>–<lpage>195</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.1938.0050" xlink:type="simple">10.1098/rspb.1938.0050</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0172761.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huxley</surname> <given-names>A. F.</given-names></name> (<year>1957</year>) <article-title>Muscle Structure and Theories of Contraction</article-title>. <source>Prog. Biophys. Biophys. Chem,</source> <volume>7</volume>: <fpage>255</fpage>–<lpage>318</lpage>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tamura</surname> <given-names>Y.</given-names></name>, &amp; <name name-style="western"><surname>Saito</surname> <given-names>M.</given-names></name> (<year>2002</year>) <article-title>A Rheological Motor Model for Vertebrate Skeletal Muscle in Due Consideration of Non-Linearity</article-title>. <source>Journal of Biomechanics</source>. <volume>35</volume>: <fpage>1273</fpage>–<lpage>1277</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0021-9290(02)00082-9" xlink:type="simple">10.1016/S0021-9290(02)00082-9</ext-link></comment> <object-id pub-id-type="pmid">12163316</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thelen</surname> <given-names>D. G.</given-names></name> (<year>2003</year>). <article-title>Adjustment of Muscle Mechanics Model Parameters to Simulate Dynamic Contractions in Older Adults</article-title>. <source>Journal of Biomechanical Engineering</source>, <volume>125</volume>: <fpage>70</fpage>–<lpage>77</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1115/1.1531112" xlink:type="simple">10.1115/1.1531112</ext-link></comment> <object-id pub-id-type="pmid">12661198</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>John</surname> <given-names>C. T.</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>F. C.</given-names></name>, <name name-style="western"><surname>Higginson</surname> <given-names>J. S.</given-names></name>, &amp; <name name-style="western"><surname>Delp</surname> <given-names>S. L.</given-names></name> (<year>2013</year>) <article-title>Stabilisation of Walking by Intrinsic Muscle Properties Revealed in a Three-Dimensional Muscle-Driven Simulation</article-title>. <source>Computer Methods in Biomechanics and Biomedical Engineering</source>. <volume>16</volume>: <fpage>451</fpage>–<lpage>462</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/10255842.2011.627560" xlink:type="simple">10.1080/10255842.2011.627560</ext-link></comment> <object-id pub-id-type="pmid">22224406</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dow</surname> <given-names>D.E.</given-names></name>, <name name-style="western"><surname>Cederna</surname> <given-names>P.S.</given-names></name>, <name name-style="western"><surname>Hassett</surname> <given-names>C.A.</given-names></name>, <name name-style="western"><surname>Kostrominova</surname> <given-names>T.Y.</given-names></name>, <name name-style="western"><surname>Faulkner</surname> <given-names>J.A.</given-names></name> &amp; <name name-style="western"><surname>Dennis</surname> <given-names>R.G.</given-names></name> (<year>2004</year>) <article-title>Number of Contractions to Maintain Mass and Force of a Denervated Rat Muscle</article-title>. <source>Muscle &amp; Nerve</source>. <volume>30</volume>(<issue>1</issue>):<fpage>77</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/mus.20054" xlink:type="simple">10.1002/mus.20054</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0172761.ref035">
<label>35</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ogata</surname> <given-names>K.</given-names></name> (<year>2009</year>) <source>Modern Control Engineering</source>. <publisher-name>Prentice-Hall</publisher-name>, <publisher-loc>Upper Saddle River, NJ</publisher-loc>, <edition>5th edition</edition>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref036">
<label>36</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Dorf</surname> <given-names>R.C.</given-names></name> &amp; <name name-style="western"><surname>Bishop</surname> <given-names>R.H.</given-names></name> (<year>2010</year>) <source>Modern Control Systems</source>. <publisher-name>Prentice-Hall</publisher-name>, <publisher-loc>Upper Saddle River, NJ</publisher-loc>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref037">
<label>37</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ioannou</surname> <given-names>P.A.</given-names></name> &amp; <name name-style="western"><surname>Sun</surname> <given-names>J.</given-names></name> (<year>1996</year>) <source>Robust Adaptive Control</source>. <publisher-name>Prentice-Hall</publisher-name>, <publisher-loc>NJ</publisher-loc>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref038">
<label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Narendra</surname> <given-names>K.S.</given-names></name> &amp; <name name-style="western"><surname>Annaswamy</surname> <given-names>A.N.</given-names></name> (<year>1989</year>) <source>Stable Adaptive Systems</source>. <publisher-name>Prentice-Hall</publisher-name>, <publisher-loc>Englewood Cliffs, NJ</publisher-loc>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref039">
<label>39</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Khalil</surname> <given-names>H.K.</given-names></name> (<year>2002</year>) <source>Nonlinear System</source>. <publisher-name>Prentice Hall PTR</publisher-name>, <publisher-loc>Upper Saddle River, NJ</publisher-loc>, <edition>3rd edition</edition>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref040">
<label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Krstic</surname> <given-names>M.</given-names></name>, <name name-style="western"><surname>Kanellakopoullos</surname> <given-names>I.</given-names></name>, &amp; <name name-style="western"><surname>Kokotovic</surname> <given-names>P.</given-names></name> (<year>1995</year>) <source>Nonlinear and Adaptive Control Design</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>, <publisher-loc>New York, NY</publisher-loc>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref041">
<label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Jaramillo, P., Shoemaker, A., &amp; Leonessa, A. (2012) International Conference on NeuroRehabilitation Converging Clinical and Engineering Research: Biosystems and Biorobotics. Springer.</mixed-citation>
</ref>
<ref id="pone.0172761.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grange</surname> <given-names>R. W.</given-names></name>, <name name-style="western"><surname>Gainer</surname> <given-names>T. G.</given-names></name>, <name name-style="western"><surname>Marschner</surname> <given-names>K. M.</given-names></name>, <name name-style="western"><surname>Talmadge</surname> <given-names>R. J.</given-names></name>, &amp; <name name-style="western"><surname>Stull</surname> <given-names>J. T.</given-names></name> (<year>2002</year>) <article-title>Fast-Twitch Skeletal Muscles of Dystrophic Mouse Pups are Resistant to Injury from Acute Mechanical Stress</article-title>. <source>American Journal of Physiology-Cell Physiology</source>, <volume>283</volume>: <fpage>C1090</fpage>–<lpage>C1101</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/ajpcell.00450.2001" xlink:type="simple">10.1152/ajpcell.00450.2001</ext-link></comment> <object-id pub-id-type="pmid">12225973</object-id></mixed-citation>
</ref>
<ref id="pone.0172761.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Coste</surname> <given-names>C. A.</given-names></name>, <name name-style="western"><surname>Sijobert</surname> <given-names>B.</given-names></name>, <name name-style="western"><surname>Froger</surname> <given-names>J.</given-names></name> &amp; <name name-style="western"><surname>Fattal</surname> <given-names>C.</given-names></name> (<year>2015</year>) <article-title>Preliminary Developments towards Closed-Loop FES-Assistance of Posture and Gait</article-title>. <source>IFAC-Online, Elsevier</source>. <volume>48</volume>:<fpage>333</fpage>–<lpage>337</lpage>.</mixed-citation>
</ref>
<ref id="pone.0172761.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sayenko</surname> <given-names>D. G.</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>R.</given-names></name>, <name name-style="western"><surname>Popovic</surname> <given-names>M. R.</given-names></name> &amp; <name name-style="western"><surname>Masani</surname> <given-names>K.</given-names></name> (<year>2014</year>) <article-title>Reducing Muscle Fatigue during Transcutaneous Neuromuscular Electrical Stimulation by Spatially and Sequentially Distributing Electrical Stimulation Sources</article-title>. <source>European Journal of Applied Physiology, Springer</source>. <volume>114</volume>: <fpage>793</fpage>–<lpage>804</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00421-013-2807-4" xlink:type="simple">10.1007/s00421-013-2807-4</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0172761.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>Z.</given-names></name>, <name name-style="western"><surname>Hayashibe</surname> <given-names>M.</given-names></name>, <name name-style="western"><surname>Fattal</surname> <given-names>C.</given-names></name> &amp; <name name-style="western"><surname>Guiraud</surname> <given-names>D.</given-names></name> (<year>2014</year>) <article-title>Muscle Fatigue Tracking with Evoked EMG via Recurrent Neural Network: toward Personalized Neuroprosthetics</article-title>. <source>IEEE Computational Intelligence Magazine</source>. <volume>9</volume>:<fpage>38</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/MCI.2014.2307224" xlink:type="simple">10.1109/MCI.2014.2307224</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0172761.ref046">
<label>46</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Narendra</surname> <given-names>K. S.</given-names></name> &amp; <name name-style="western"><surname>Annaswamy</surname> <given-names>A. M.</given-names></name> (<year>2012</year>) <source>Stable Adaptive Systems</source>. <publisher-name>Courier Corporation</publisher-name>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>