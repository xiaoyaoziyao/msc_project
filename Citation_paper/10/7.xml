<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0179698</article-id>
<article-id pub-id-type="publisher-id">PONE-D-15-33738</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Walking</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Walking</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Joints (anatomy)</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Joints (anatomy)</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Bioassays and physiological analysis</subject><subj-group><subject>Electrophysiological techniques</subject><subj-group><subject>Muscle electrophysiology</subject><subj-group><subject>Electromyography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Limbs (anatomy)</subject><subj-group><subject>Legs</subject><subj-group><subject>Ankles</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Limbs (anatomy)</subject><subj-group><subject>Legs</subject><subj-group><subject>Ankles</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Limbs (anatomy)</subject><subj-group><subject>Arms</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Limbs (anatomy)</subject><subj-group><subject>Arms</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Pelvis</subject><subj-group><subject>Hip</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Pelvis</subject><subj-group><subject>Hip</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Gait analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Gait analysis</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Lower extremity EMG-driven modeling of walking with automated adjustment of musculoskeletal geometry</article-title>
<alt-title alt-title-type="running-head">Lower extremity EMG-driven modeling with automated adjustment of geometry</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Meyer</surname>
<given-names>Andrew J.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Patten</surname>
<given-names>Carolynn</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1166-4358</contrib-id>
<name name-style="western">
<surname>Fregly</surname>
<given-names>Benjamin J.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Mechanical &amp; Aerospace Engineering, University of Florida, Gainesville, FL, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Physical Therapy, University of Florida, Gainesville, FL, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Neural Control of Movement Lab, Malcom Randall VA Medical Center, Gainesville, FL, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ren</surname>
<given-names>Lei</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Manchester, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"> <list-item>
<p><bold>Conceptualization:</bold> AJM CP BJF.</p></list-item> <list-item>
<p><bold>Data curation:</bold> AJM CP BJF.</p></list-item> <list-item>
<p><bold>Formal analysis:</bold> AJM BJF.</p></list-item> <list-item>
<p><bold>Funding acquisition:</bold> CP BJF.</p></list-item> <list-item>
<p><bold>Investigation:</bold> AJM CP BJF.</p></list-item> <list-item>
<p><bold>Methodology:</bold> AJM CP BJF.</p></list-item> <list-item>
<p><bold>Project administration:</bold> AJM CP BJF.</p></list-item> <list-item>
<p><bold>Resources:</bold> AJM CP BJF.</p></list-item> <list-item>
<p><bold>Software:</bold> AJM BJF.</p></list-item> <list-item>
<p><bold>Supervision:</bold> CP BJF.</p></list-item> <list-item>
<p><bold>Validation:</bold> AJM CP BJF.</p></list-item> <list-item>
<p><bold>Visualization:</bold> AJM CP BJF.</p></list-item> <list-item>
<p><bold>Writing – original draft:</bold> AJM CP BJF.</p></list-item> <list-item>
<p><bold>Writing – review &amp; editing:</bold> AJM CP BJF.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">fregly@ufl.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>11</day>
<month>7</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<year>2017</year>
</pub-date>
<volume>12</volume>
<issue>7</issue>
<elocation-id>e0179698</elocation-id>
<history>
<date date-type="received">
<day>31</day>
<month>7</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>2</day>
<month>6</month>
<year>2017</year>
</date>
</history>
<permissions>
<license xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">
<license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">Creative Commons CC0</ext-link> public domain dedication.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0179698"/>
<abstract>
<p>Neuromusculoskeletal disorders affecting walking ability are often difficult to manage, in part due to limited understanding of how a patient’s lower extremity muscle excitations contribute to the patient’s lower extremity joint moments. To assist in the study of these disorders, researchers have developed electromyography (EMG) driven neuromusculoskeletal models utilizing scaled generic musculoskeletal geometry. While these models can predict individual muscle contributions to lower extremity joint moments during walking, the accuracy of the predictions can be hindered by errors in the scaled geometry. This study presents a novel EMG-driven modeling method that automatically adjusts surrogate representations of the patient’s musculoskeletal geometry to improve prediction of lower extremity joint moments during walking. In addition to commonly adjusted neuromusculoskeletal model parameters, the proposed method adjusts model parameters defining muscle-tendon lengths, velocities, and moment arms. We evaluated our EMG-driven modeling method using data collected from a high-functioning hemiparetic subject walking on an instrumented treadmill at speeds ranging from 0.4 to 0.8 m/s. EMG-driven model parameter values were calibrated to match inverse dynamic moments for five degrees of freedom in each leg while keeping musculoskeletal geometry close to that of an initial scaled musculoskeletal model. We found that our EMG-driven modeling method incorporating automated adjustment of musculoskeletal geometry predicted net joint moments during walking more accurately than did the same method without geometric adjustments. Geometric adjustments improved moment prediction errors by 25% on average and up to 52%, with the largest improvements occurring at the hip. Predicted adjustments to musculoskeletal geometry were comparable to errors reported in the literature between scaled generic geometric models and measurements made from imaging data. Our results demonstrate that with appropriate experimental data, joint moment predictions for walking generated by an EMG-driven model can be improved significantly when automated adjustment of musculoskeletal geometry is included in the model calibration process.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000146</institution-id>
<institution>Division of Chemical, Bioengineering, Environmental, and Transport Systems</institution>
</institution-wrap>
</funding-source>
<award-id>CBET1159735</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1166-4358</contrib-id>
<name name-style="western">
<surname>Fregly</surname>
<given-names>Benjamin J.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This study was supported by NSF grant CBET1159735; NSF grant CBET1404767; University of Florida, Gainesville, FL; and Malcom Randall VA Medical Center, Gainesville, FL.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="4"/>
<page-count count="24"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All experimental data, Matlab code, and OpenSim models used in this study are available from <ext-link ext-link-type="uri" xlink:href="https://simtk.org/projects/emgdrivenmodel" xlink:type="simple">https://simtk.org/projects/emgdrivenmodel</ext-link> (filename: EMG-driven Modeling Files.zip; DOI Identifier: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18735/S53Q01" xlink:type="simple">https://doi.org/10.18735/S53Q01</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Neuromusculoskeletal disorders such as cerebral palsy [<xref ref-type="bibr" rid="pone.0179698.ref001">1</xref>], stroke [<xref ref-type="bibr" rid="pone.0179698.ref002">2</xref>], Parkinson’s disease [<xref ref-type="bibr" rid="pone.0179698.ref003">3</xref>], and osteoarthritis [<xref ref-type="bibr" rid="pone.0179698.ref004">4</xref>] hinder walking ability and decrease quality of life for millions of people. Rehabilitation treatments have been developed to attempt to improve the walking ability of individuals with these disorders. However, the effectiveness of these treatments can vary between patients, in part due to the use of treatment design methods based more on subjective than objective methods [<xref ref-type="bibr" rid="pone.0179698.ref005">5</xref>]. For instance, for medial knee osteoarthritis, recent studies using instrumented knee implants found that gait modifications expected to reduced medial knee contact force [<xref ref-type="bibr" rid="pone.0179698.ref006">6</xref>–<xref ref-type="bibr" rid="pone.0179698.ref008">8</xref>] did not always do so [<xref ref-type="bibr" rid="pone.0179698.ref009">9</xref>,<xref ref-type="bibr" rid="pone.0179698.ref010">10</xref>]. Similarly, stroke rehabilitation methods that are effective for some patients may be ineffective for others [<xref ref-type="bibr" rid="pone.0179698.ref011">11</xref>]. Thus, treatment outcomes for neuromusculoskeletal disorders could potentially be improved through the use of more objective treatment design methods.</p>
<p>To assist with the design of more effective interventions, researchers have developed neuromusculoskeletal models of individual patients. A major challenge in neuromusculoskeletal modeling is determining how muscles contribute to net joint moments. Some studies have used electromyography (EMG) data with [<xref ref-type="bibr" rid="pone.0179698.ref012">12</xref>–<xref ref-type="bibr" rid="pone.0179698.ref019">19</xref>] and without [<xref ref-type="bibr" rid="pone.0179698.ref020">20</xref>–<xref ref-type="bibr" rid="pone.0179698.ref024">24</xref>] geometric musculoskeletal models to estimate the joint moments generated by muscles during movement. When geometric models are used, EMG-driven models predict net joint moments in three steps. First, muscle activation is determined from EMG data using a first or second order activation dynamics model [<xref ref-type="bibr" rid="pone.0179698.ref012">12</xref>,<xref ref-type="bibr" rid="pone.0179698.ref025">25</xref>]. Next, muscle force is determined from muscle activation and muscle-tendon kinematics using Hill-type muscle models [<xref ref-type="bibr" rid="pone.0179698.ref026">26</xref>,<xref ref-type="bibr" rid="pone.0179698.ref027">27</xref>]. Finally, joint moments are determined by combining estimated muscle forces with calculated muscle moment arms, which requires geometric modeling of muscle-tendon origins, insertions, and lines of action around bones and other muscles. To reproduce experimental joint moments as closely as possible, researchers calibrate parameter values in the activation dynamics (e.g., activation and deactivation time constants, electromechanical delays) and Hill-type muscle (e.g., optimal muscle fiber lengths, tendon slack lengths, peak isometric strengths) models using optimization methods, where experimental joint moments are calculated via inverse dynamics assuming no uncertainty in experimental inputs (i.e., ground reactions, marker motions) or skeletal model parameter values (i.e., joint positions and orientations, segment mass properties) [<xref ref-type="bibr" rid="pone.0179698.ref012">12</xref>,<xref ref-type="bibr" rid="pone.0179698.ref014">14</xref>–<xref ref-type="bibr" rid="pone.0179698.ref016">16</xref>,<xref ref-type="bibr" rid="pone.0179698.ref028">28</xref>,<xref ref-type="bibr" rid="pone.0179698.ref029">29</xref>]. In contrast to the use of optimization, muscle-tendon kinematic and muscle moment arm information needed for the last two steps is typically provided by a scaled generic musculoskeletal model. However, several studies have demonstrated that scaled models may not represent the musculoskeletal geometry of individual subjects well [<xref ref-type="bibr" rid="pone.0179698.ref030">30</xref>–<xref ref-type="bibr" rid="pone.0179698.ref032">32</xref>]. Despite the presence of errors in muscle-tendon kinematics and moment arms in scaled geometric models, no study to date has attempted to adjust these quantities automatically to improve the prediction of net joint moments from EMG data.</p>
<p>This paper presents a novel EMG-driven modeling method that calibrates not only standard activation dynamics and muscle-tendon model parameter values but also non-standard geometric musculoskeletal model parameter values related to muscle-tendon lengths and moment arms to patient walking data. The method was developed and evaluated using instrumented treadmill walking data collected from a high-functioning hemiparetic subject walking at five different speeds. Surrogate models of muscle-tendon length, velocity, and moment arms for each muscle were fitted as functions of joint angles [<xref ref-type="bibr" rid="pone.0179698.ref033">33</xref>,<xref ref-type="bibr" rid="pone.0179698.ref034">34</xref>] to data sampled from a scaled generic OpenSim [<xref ref-type="bibr" rid="pone.0179698.ref035">35</xref>] musculoskeletal model [<xref ref-type="bibr" rid="pone.0179698.ref036">36</xref>]. Surrogate model parameter values, along with activation dynamics and Hill-type muscle-tendon model parameter values, were adjusted via optimization such that lower extremity joint moments calculated from the subject’s EMG data matched the subject’s inverse dynamic joint moments from walking as closely as possible. Parameter values were adjusted for 35 muscles in each leg of the subject’s model to match the hip flexion-extension (FE), hip adduction-abduction (AA), knee flexion-extension (FE), ankle plantar-dorsiflexion (PDF), and ankle inversion-eversion (IE) moments during treadmill walking. Calibrated EMG-driven models were evaluated by predicting joint moments for walking trials withheld from calibration, including trials performed at faster non-calibration walking speeds.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Experimental data</title>
<p>To support development and evaluation of our proposed EMG-driven modeling method, we collected experimental walking data from a single high-functioning hemiparetic male subject (age 79 years, LE Fugl-Meyer Motor Assessment 32/34 pts, right-sided hemiparesis, height 1.7 m, mass 80.5 kg). All experimental procedures were approved by the University of Florida Health Science Center Institutional Review Board (IRB-01), and the subject provided written informed consent prior to participation. Motion capture (Vicon Corp., Oxford, UK), ground reaction (Bertec Corp., Columbus, OH), and EMG (Motion Lab Systems, Baton Rouge, LA) data were collected simultaneously while the subject walked on a split-belt instrumented treadmill (Bertec Corp., Columbus, OH) at five different speeds: 0.4, 0.5, 0.6, 0.7, and 0.8 m/s which included his preferred speed of 0.5 m/s. Motion capture data were recorded at a frequency of 100 Hz, and analog data were recorded at a frequency of 1000 Hz. More than 50 gait cycles were recorded for each walking speed. A static standing trial was also collected. The motion capture data were obtained using a modified Cleveland clinic marker set with additional markers added to the feet [<xref ref-type="bibr" rid="pone.0179698.ref037">37</xref>]. Ground reaction and marker motion data were filtered at a variable cut-off frequency of 7/tf Hz, where tf is the period of the gait cycle being processed, using a fourth-order zero phase lag Butterworth filter [<xref ref-type="bibr" rid="pone.0179698.ref038">38</xref>]. This variable cut-off frequency would cause data collected at a normal walking speed to be filtered at approximately 6 Hz.</p>
<p>EMG data were collected and processed for 16 muscles in each leg. These data used a combination of surface and fine-wire electrodes. Electrodes were placed following the SENIAM convention for surface electrodes [<xref ref-type="bibr" rid="pone.0179698.ref039">39</xref>] and the Delagi et al. Anatomical Guide for the Electromyographer for fine wire electrodes [<xref ref-type="bibr" rid="pone.0179698.ref040">40</xref>]. Surface EMG data were collected for gluteus maximus and medius, semimembranosus, biceps femoris long head, rectus femoris, vastus medialis and lateralis, medial gastrocnemius, tibialis anterior, peroneus longus, and soleus. Fine-wire EMG data were collected for adductor longus, iliopsoas, tibialis posterior, flexor digitorum longus, and extensor digitorum longus. EMG data were high-pass filtered at 40 Hz [<xref ref-type="bibr" rid="pone.0179698.ref012">12</xref>], demeaned, rectified, and then low-pass filtered at a variable cut-off frequency 3.5/tf Hz. Filtering was performed using a fourth-order zero phase lag Butterworth filter. EMG data from each muscle were normalized to the maximum value over all trials and resampled to 101 time points per gait cycle while keeping an additional 20 time points before the start of the cycle to permit modeling of electromechanical delay. In addition, each processed EMG signal was offset on a cycle-by-cycle basis so that the minimum value was zero.</p>
</sec>
<sec id="sec004">
<title>Model description</title>
<p>Our EMG-driven model uses a Hill-type muscle model with a rigid tendon [<xref ref-type="bibr" rid="pone.0179698.ref041">41</xref>] along with automatically adjusted musculoskeletal geometry. However, the necessary muscle-tendon lengths, velocities, and moment arms commonly obtained from a geometric musculoskeletal model are instead approximated by polynomial functions of model generalized coordinates and their first derivatives [<xref ref-type="bibr" rid="pone.0179698.ref033">33</xref>,<xref ref-type="bibr" rid="pone.0179698.ref034">34</xref>]. Each muscle’s moment about a spanned joint is represented by the following equation:
<disp-formula id="pone.0179698.e001">
<alternatives>
<graphic id="pone.0179698.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mtable><mml:mtr><mml:mtd><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>o</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="script">l</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="script">l</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="script">l</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="normal">cos</mml:mi><mml:mi>α</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0.3</mml:mn><mml:mo>&lt;</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="script">l</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1.3</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
where <italic>M</italic> is the moment about a given joint produced by the muscle, <italic>r</italic> is the moment arm of the muscle about the spanned joint, <inline-formula id="pone.0179698.e002"><alternatives><graphic id="pone.0179698.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mi>o</mml:mi><mml:mi>M</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the peak isometric force of the muscle, <italic>a</italic> is the muscle’s activation which is a function of processed experimental EMG data <italic>e</italic>, <italic>t</italic> is time, <italic>d</italic> is an electromechanical time delay, <inline-formula id="pone.0179698.e003"><alternatives><graphic id="pone.0179698.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="script">l</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0179698.e004"><alternatives><graphic id="pone.0179698.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the normalized muscle fiber length and velocity, respectively, and <italic>α</italic> is the muscle pennation angle, which is assumed to remain constant to facilitate subsequent calibration of musculoskeletal geometry. Neglecting tendon compliance, <inline-formula id="pone.0179698.e005"><alternatives><graphic id="pone.0179698.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="script">l</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0179698.e006"><alternatives><graphic id="pone.0179698.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are calculated using the following equations:
<disp-formula id="pone.0179698.e007">
<alternatives>
<graphic id="pone.0179698.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="script">l</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mi>o</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mi mathvariant="normal">cos</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<disp-formula id="pone.0179698.e008">
<alternatives>
<graphic id="pone.0179698.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>10</mml:mn><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mi>o</mml:mi><mml:mi>M</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where <inline-formula id="pone.0179698.e009"><alternatives><graphic id="pone.0179698.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is muscle-tendon length, <inline-formula id="pone.0179698.e010"><alternatives><graphic id="pone.0179698.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mi>o</mml:mi><mml:mi>M</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the optimal fiber length, <inline-formula id="pone.0179698.e011"><alternatives><graphic id="pone.0179698.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the tendon slack length, and <italic>v</italic><sup><italic>MT</italic></sup> is muscle-tendon velocity. <inline-formula id="pone.0179698.e012"><alternatives><graphic id="pone.0179698.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="script">l</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="script">l</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0179698.e013"><alternatives><graphic id="pone.0179698.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="script">l</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0179698.e014"><alternatives><graphic id="pone.0179698.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> represent the normalized muscle active force-length, passive force-length, and force-velocity curves (<xref ref-type="fig" rid="pone.0179698.g001">Fig 1</xref>). In all, our Hill-type muscle model requires specification of five parameter values <italic>d</italic>, <inline-formula id="pone.0179698.e015"><alternatives><graphic id="pone.0179698.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mi>o</mml:mi><mml:mi>M</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0179698.e016"><alternatives><graphic id="pone.0179698.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0179698.e017"><alternatives><graphic id="pone.0179698.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mi>o</mml:mi><mml:mi>M</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>α</italic> and four time varying quantities <italic>a</italic>, <inline-formula id="pone.0179698.e018"><alternatives><graphic id="pone.0179698.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>v</italic><sup><italic>MT</italic></sup>, and <italic>r</italic>. Methods for calculating these four time varying quantities are described below.</p>
<fig id="pone.0179698.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Relevant curves for our Hill-type muscle and activation nonlinearization model.</title>
<p>Left: Normalized active, passive, and total force-length curves. Middle: Normalized force-velocity curve. Right: Neural-to-muscle activation nonlinearization curves for minimum nonlinearization (curve parameter = 0) and maximum nonlinearization (curve parameter = 0.35).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.g001" xlink:type="simple"/>
</fig>
<p>Muscle activation is calculated using a first order differential equation that describes excitation <italic>e</italic> to neural activation <italic>u</italic> dynamics and a nonlinear function that describes neural activation <italic>u</italic> to muscle activation <italic>a</italic> [<xref ref-type="bibr" rid="pone.0179698.ref042">42</xref>]. Neural activation is calculated by solving the first order differential equation proposed by He <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0179698.ref025">25</xref>]:
<disp-formula id="pone.0179698.e019">
<alternatives>
<graphic id="pone.0179698.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e019" xlink:type="simple"/>
<mml:math display="block" id="M19">
<mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
where <italic>e</italic>(<italic>t</italic>−<italic>d</italic>) is excitation (i.e., processed EMG data) and <italic>u</italic>(<italic>t</italic>) is neural activation. The constants <italic>c</italic><sub>1</sub> and <italic>c</italic><sub>2</sub> are defined as:
<disp-formula id="pone.0179698.e020">
<alternatives>
<graphic id="pone.0179698.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
<disp-formula id="pone.0179698.e021">
<alternatives>
<graphic id="pone.0179698.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e021" xlink:type="simple"/>
<mml:math display="block" id="M21">
<mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
where <italic>τ</italic><sub><italic>act</italic></sub> and <italic>τ</italic><sub><italic>deact</italic></sub> are muscle activation and deactivation time constants, respectively. These time constants are constrained to be proportional to each other such that <italic>τ</italic><sub><italic>deact</italic></sub> = 4<italic>τ</italic><sub><italic>act</italic></sub> based on the ratio commonly reported in the literature [<xref ref-type="bibr" rid="pone.0179698.ref027">27</xref>,<xref ref-type="bibr" rid="pone.0179698.ref043">43</xref>–<xref ref-type="bibr" rid="pone.0179698.ref045">45</xref>]. This linear differential equation is solved recursively over all time frames by discretizing Eq (<xref ref-type="disp-formula" rid="pone.0179698.e019">4</xref>) at each time point using a high accuracy backward finite difference approximation, assuming neural activation at the first two time points equals time-delayed muscle excitation at these time points, and solving for the unknown neural activation at the current time point:
<disp-formula id="pone.0179698.e022">
<alternatives>
<graphic id="pone.0179698.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e022" xlink:type="simple"/>
<mml:math display="block" id="M22">
<mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
where Δ<italic>t</italic> is the selected time interval and <italic>i</italic> represents the time frame for which neural activation is to be found. The nonlinear relationship between neural activation <italic>u</italic> and muscle activation <italic>a</italic> at time frame <italic>i</italic> is modeled using the equation:
<disp-formula id="pone.0179698.e023">
<alternatives>
<graphic id="pone.0179698.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e023" xlink:type="simple"/>
<mml:math display="block" id="M23">
<mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
where <italic>c</italic><sub>3</sub> is a constant that can vary from 0 (linear) to 0.35 (highly nonlinear), and <italic>g</italic><sub>1</sub>-<italic>g</italic><sub>5</sub> are values determined by fitting published experimental data from isometric contractions [<xref ref-type="bibr" rid="pone.0179698.ref042">42</xref>]. Constant coefficients <italic>g</italic><sub>1</sub>-<italic>g</italic><sub>5</sub> have values of -7.623, 29.280, 0.884, 17.227, and 4.108. This activation nonlinearity equation is a simplified version of functions proposed previously [<xref ref-type="bibr" rid="pone.0179698.ref042">42</xref>].</p>
<p>The time varying quantities <inline-formula id="pone.0179698.e024"><alternatives><graphic id="pone.0179698.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>v</italic><sup><italic>MT</italic></sup>, and <italic>r</italic> are calculated using polynomial functions of the joint angles and velocities that share common coefficients [<xref ref-type="bibr" rid="pone.0179698.ref033">33</xref>,<xref ref-type="bibr" rid="pone.0179698.ref034">34</xref>]. For muscles that span a single degree of freedom (DOF), the muscle-tendon length is approximated using the cubic polynomial equation:
<disp-formula id="pone.0179698.e025">
<alternatives>
<graphic id="pone.0179698.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e025" xlink:type="simple"/>
<mml:math display="block" id="M25">
<mml:mrow><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>θ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
where <inline-formula id="pone.0179698.e026"><alternatives><graphic id="pone.0179698.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is muscle-tendon length, <italic>θ</italic> is joint angle, and <italic>b</italic><sub>0</sub> through <italic>b</italic><sub>3</sub> are constant coefficients. Muscle-tendon velocity <italic>v</italic><sup><italic>MT</italic></sup> can then be calculated using the first derivative with respect to time of Eq (<xref ref-type="disp-formula" rid="pone.0179698.e025">9</xref>):
<disp-formula id="pone.0179698.e027">
<alternatives>
<graphic id="pone.0179698.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e027" xlink:type="simple"/>
<mml:math display="block" id="M27">
<mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>θ</mml:mi><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
where <inline-formula id="pone.0179698.e028"><alternatives><graphic id="pone.0179698.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the joint angular velocity. Similarly, the muscle-tendon moment arm can be calculated from Eq (<xref ref-type="disp-formula" rid="pone.0179698.e025">9</xref>) using a relationship from An et al. [<xref ref-type="bibr" rid="pone.0179698.ref046">46</xref>]:
<disp-formula id="pone.0179698.e029">
<alternatives>
<graphic id="pone.0179698.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e029" xlink:type="simple"/>
<mml:math display="block" id="M29">
<mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
The negative sign in this expression is needed for consistency with the OpenSim musculoskeletal modeling environment, where a positive joint moment causes a positive change in joint angle. For muscles that span two DOFs, these equations are extended as follows:
<disp-formula id="pone.0179698.e030">
<alternatives>
<graphic id="pone.0179698.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e030" xlink:type="simple"/>
<mml:math display="block" id="M30">
<mml:mrow><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
<disp-formula id="pone.0179698.e031">
<alternatives>
<graphic id="pone.0179698.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e031" xlink:type="simple"/>
<mml:math display="block" id="M31">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:msub><mml:mi>b</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
<disp-formula id="pone.0179698.e032">
<alternatives>
<graphic id="pone.0179698.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e032" xlink:type="simple"/>
<mml:math display="block" id="M32">
<mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
<disp-formula id="pone.0179698.e033">
<alternatives>
<graphic id="pone.0179698.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e033" xlink:type="simple"/>
<mml:math display="block" id="M33">
<mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula>
For muscles that span three or four DOFs, Eqs (<xref ref-type="disp-formula" rid="pone.0179698.e025">9</xref>), (<xref ref-type="disp-formula" rid="pone.0179698.e027">10</xref>) and (<xref ref-type="disp-formula" rid="pone.0179698.e029">11</xref>) are extended in a similar manner by adding terms corresponding to the additional joint angles and velocities. These polynomial functions can be viewed as surrogate models of muscle-tendon lengths, velocities, and moment arms.</p>
</sec>
<sec id="sec005">
<title>Model calibration</title>
<p>In our EMG-driven model calibration process, we start with a generic full-body OpenSim musculoskeletal model [<xref ref-type="bibr" rid="pone.0179698.ref035">35</xref>]. The authors of that study created this initial model using measurements made on 21 cadaveric specimens. Since the present study focuses on lower limb motion during walking, the generic model was reduced to 29 DOFs by removing toes, forearm, and wrist DOFs. The lower extremity joints were modeled as follows: the hips as ball-and-socket joints, the knees as hinge joints (flexion/extension) with prescribed translations defined as a function of knee rotation [<xref ref-type="bibr" rid="pone.0179698.ref047">47</xref>], and the ankles as two non-intersecting hinge joints. After removal of muscles without related EMG signals, 35 muscles remained whose names, functions, and excitation groups are listed in <xref ref-type="table" rid="pone.0179698.t001">Table 1</xref>. Many of these muscles represented compartments of larger muscles that were split to model their function more accurately. For instance, gluteus maximus was split into three compartments modeled as individual muscles with a common excitation signal.</p>
<table-wrap id="pone.0179698.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.t001</object-id>
<label>Table 1</label> <caption><title>List of muscles in the model, which DOF each muscle actuates, and source of each muscle’s excitation signal.</title></caption>
<alternatives>
<graphic id="pone.0179698.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Muscle</th>
<th align="center">Actuates</th>
<th align="center">EMG Signal Source</th>
<th align="center">EMG Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>Adductor brevis</bold></td>
<td align="center">Hip FE, Hip AA</td>
<td align="center" rowspan="6">Adductor longus</td>
<td align="center" rowspan="6">Fine wire</td>
</tr>
<tr>
<td align="center"><bold>Adductor longus</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Adductor magnus distal</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Adductor magnus ischial</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Adductor magnus middle</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Adductor magnus proximal</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Gluteus maximus superior</bold></td>
<td align="center">Hip FE, Hip AA</td>
<td align="center" rowspan="3">Gluteus maximus</td>
<td align="center" rowspan="3">Surface</td>
</tr>
<tr>
<td align="center"><bold>Gluteus maximus middle</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Gluteus maximus inferior</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Gluteus medius anterior</bold></td>
<td align="center">Hip FE, Hip AA</td>
<td align="center" rowspan="6">Gluteus medius</td>
<td align="center" rowspan="6">Surface</td>
</tr>
<tr>
<td align="center"><bold>Gluteus medius middle</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Gluteus medius posterior</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Gluteus minimus anterior</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Gluteus minimus middle</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Gluteus minimus posterior</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Iliacus</bold></td>
<td align="center">Hip FE, Hip AA</td>
<td align="center" rowspan="2">Iliacus or Psoas</td>
<td align="center" rowspan="2">Fine wire</td>
</tr>
<tr>
<td align="center"><bold>Psoas</bold></td>
<td align="center">Hip FE, Hip AA</td>
</tr>
<tr>
<td align="center"><bold>Semimembranosus</bold></td>
<td align="center">Hip FE, Hip AA, Knee FE</td>
<td align="center" rowspan="2">Semimembranosus</td>
<td align="center" rowspan="2">Surface</td>
</tr>
<tr>
<td align="center"><bold>Semitendinosus</bold></td>
<td align="center">Hip FE, Hip AA, Knee FE</td>
</tr>
<tr>
<td align="center"><bold>Biceps femoris long head</bold></td>
<td align="center">Hip FE, Hip AA, Knee FE</td>
<td align="center" rowspan="2">Biceps femoris long head</td>
<td align="center" rowspan="2">Surface</td>
</tr>
<tr>
<td align="center"><bold>Biceps femoris short head</bold></td>
<td align="center">Knee FE</td>
</tr>
<tr>
<td align="center"><bold>Rectus femoris</bold></td>
<td align="center">Hip FE, Hip AA, Knee FE</td>
<td align="center">Rectus femoris</td>
<td align="center">Surface</td>
</tr>
<tr>
<td align="center"><bold>Vastus medialis</bold></td>
<td align="center">Knee FE</td>
<td align="center" rowspan="2">Vastus medialis</td>
<td align="center" rowspan="2">Surface</td>
</tr>
<tr>
<td align="center"><bold>Vastus intermedius</bold></td>
<td align="center">Knee FE</td>
</tr>
<tr>
<td align="center"><bold>Vastus lateralis</bold></td>
<td align="center">Knee FE</td>
<td align="center">Vastus lateralis</td>
<td align="center">Surface</td>
</tr>
<tr>
<td align="center"><bold>Lateral gastrocnemius</bold></td>
<td align="center">Knee FE, Ankle PDF, Ankle IE</td>
<td align="center" rowspan="2">Medial gastrocnemius</td>
<td align="center" rowspan="2">Surface</td>
</tr>
<tr>
<td align="center"><bold>Medial gastrocnemius</bold></td>
<td align="center">Knee FE, Ankle PDF, Ankle IE</td>
</tr>
<tr>
<td align="center"><bold>Tibialis anterior</bold></td>
<td align="center">Ankle PDF, Ankle IE</td>
<td align="center">Tibialis anterior</td>
<td align="center">Surface</td>
</tr>
<tr>
<td align="center"><bold>Tibialis posterior</bold></td>
<td align="center">Ankle PDF, Ankle IE</td>
<td align="center">Tibialis posterior</td>
<td align="center">Fine wire</td>
</tr>
<tr>
<td align="center"><bold>Peroneus brevis</bold></td>
<td align="center">Ankle PDF, Ankle IE</td>
<td align="center" rowspan="3">Peroneus longus</td>
<td align="center" rowspan="3">Surface</td>
</tr>
<tr>
<td align="center"><bold>Peroneus longus</bold></td>
<td align="center">Ankle PDF, Ankle IE</td>
</tr>
<tr>
<td align="center"><bold>Peroneus tertius</bold></td>
<td align="center">Ankle PDF, Ankle IE</td>
</tr>
<tr>
<td align="center"><bold>Soleus</bold></td>
<td align="center">Ankle PDF, Ankle IE</td>
<td align="center">Soleus</td>
<td align="center">Surface</td>
</tr>
<tr>
<td align="center"><bold>Extensor digitorum longus</bold></td>
<td align="center">Ankle PDF, Ankle IE</td>
<td align="center">Extensor digitorum longus</td>
<td align="center">Fine wire</td>
</tr>
<tr>
<td align="center"><bold>Flexor digitorum Longus</bold></td>
<td align="center">Ankle PDF, Ankle IE</td>
<td align="center">Flexor digitorum longus</td>
<td align="center">Fine wire</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The first step in our EMG-driven model calibration process was scaling of the generic musculoskeletal model in OpenSim to match static trial marker data. Each segment’s scale factors were based on the ratio of distances between markers placed over bony landmarks and distances between corresponding markers in the generic model. Symmetry was maintained between the right and left sides of the body. The following segments were scaled: pelvis, torso, upper arms, forearms, thighs, shanks, and feet.</p>
<p>Following scaling, the next step was calibration of lower extremity joint positions and orientations and of marker positions within the body segments such that an OpenSim inverse kinematics analysis matched measured marker locations during walking as closely as possible [<xref ref-type="bibr" rid="pone.0179698.ref037">37</xref>,<xref ref-type="bibr" rid="pone.0179698.ref048">48</xref>]. This calibration step was performed in MATLAB (MathWorks, Natick, MA) via nonlinear least squares optimization and the OpenSim MATLAB application programming interface [<xref ref-type="bibr" rid="pone.0179698.ref035">35</xref>] for performing repeated inverse kinematic analyses. A single representative walking trial at 0.5 m/s, the subject’s preferred walking speed, was used for this purpose. Distances between pairs of markers within the same body segment were fixed during calibration. Joint positions and orientations within the body segments were adjusted only for the lower extremities while marker positions within the body segments were adjusted for all segments except the arms. Since relocating joint centers causes segment lengths to change, the model geometry was rescaled based on the new joint-to-joint distances. Model symmetry was maintained between the right and left sides during this calibration step.</p>
<p>Given the scaled musculoskeletal model with calibrated joint parameters, the third step of the calibration process was creation of surrogate models of muscle-tendon geometry using Eqs (<xref ref-type="disp-formula" rid="pone.0179698.e025">9</xref>–<xref ref-type="disp-formula" rid="pone.0179698.e033">15</xref>) [<xref ref-type="bibr" rid="pone.0179698.ref033">33</xref>,<xref ref-type="bibr" rid="pone.0179698.ref034">34</xref>]. Each muscle’s muscle-tendon length and moment arms were calculated by OpenSim [<xref ref-type="bibr" rid="pone.0179698.ref049">49</xref>] for 1000 different model poses specified using Latin hypercube sampling over a wide range of joint angles that went well beyond those that occur during walking. Surrogate models of muscle-tendon lengths and moment arms were then fitted simultaneously by calculating model coefficients using linear least squares regression. Muscle-tendon velocities were not matched because the sampling process was time independent. The resulting surrogate geometric models closely reproduced the subject’s muscle-tendon lengths, velocities, and moment arms for walking as calculated by the scaled OpenSim musculoskeletal model with calibrated joint parameters. Median fitting errors for all muscles were less than 1.6 mm for moment arms and 0.69 mm for muscle-tendon lengths.</p>
<p>The final step of the calibration process was creation of an EMG-driven model by optimizing activation, Hill-type muscle-tendon, and surrogate geometric model parameter values for all muscles such that lower extremity joint moments predicted by the model matched those calculated by inverse dynamics as closely as possible (<xref ref-type="fig" rid="pone.0179698.g002">Fig 2</xref>). Because of the large number of design variables and quantities being tracked in the cost function, the optimization was highly over-constrained. The design variables altered by the optimization were: electromechanical delays <italic>d</italic>, activation time constants <italic>τ</italic><sub><italic>act</italic></sub>, activation nonlinearity constants <italic>c</italic><sub>3</sub>, scale factors defining the maximum processed EMG value achievable by each muscle, common scale factors for the optimal muscle fiber length and tendon slack length of each muscle, and coefficients <italic>b</italic><sub>0</sub> through <italic>b</italic><sub><italic>n</italic></sub> defining muscle-tendon lengths, velocities, and moment arms. These model parameter values were calibrated using a sequence of seven optimizations to reduce the likelihood of entrapment in a local minimum. In the first and fourth optimizations, electromechanical delays, muscle activation time constants, activation nonlinearity constants, and EMG scale factors were adjusted while all other design variables were fixed at their initial or previous values. In the second and fifth optimizations, common scale factors for optimal muscle fiber lengths and tendon slack lengths were adjusted. In the third and sixth optimizations, coefficients defining muscle-tendon geometry were adjusted. Finally, in the seventh optimization, all design variables were adjusted simultaneously. All optimizations were performed using MATLAB’s fmincon sequential quadratic programming algorithm [<xref ref-type="bibr" rid="pone.0179698.ref050">50</xref>].</p>
<fig id="pone.0179698.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Flowchart of EMG-driven model calibration process for walking.</title>
<p>The goal is to find model parameter values (i.e., activation parameters, surrogate geometry parameters, and muscle-tendon parameters) such that experimental processed EMG data and joint kinematics can be input to the model and lower extremity joint moments that closely match experimental joint moments are output from the model. Blue lines indicate model parameter values changed by the optimization process.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.g002" xlink:type="simple"/>
</fig>
<p>To maintain anatomic realism, the cost function for these optimizations not only minimized errors in model-predicted lower extremity joint moments but also penalized changes in model parameter values, muscle kinematics, and muscle moment arms away from their initial values and trajectories [<xref ref-type="bibr" rid="pone.0179698.ref048">48</xref>]. Joint moment errors were calculated for both active and passive moments. Active moments were calculated from the subject’s walking data via an OpenSim inverse dynamic analysis performed for ten gait cycles from each walking speed. Passive moments were taken from measurements reported in the literature for a wide range of joint angle combinations [<xref ref-type="bibr" rid="pone.0179698.ref051">51</xref>]. These passive moment data were included to provide additional information for estimating passive muscle-tendon properties. Initial model parameter values were either taken directly from the literature or customized to the subject based on information in the literature (for example, peak isometric force values were calculated using information reported in [<xref ref-type="bibr" rid="pone.0179698.ref052">52</xref>]), while initial muscle kinematic and moment arm trajectories were taken from the subject’s scaled OpenSim model. Details regarding specification of initial guesses, variable bounds, and cost function terms can be found in the <xref ref-type="supplementary-material" rid="pone.0179698.s001">S1 Appendix</xref>.</p>
</sec>
<sec id="sec006">
<title>Model evaluation</title>
<p>Using the optimization process described above, we evaluated our EMG-driven modeling process by performing two “calibrate, then test” scenarios. Gait cycles from all walking speeds were selected for this process. To develop the necessary inputs for calibration and testing, we performed OpenSim inverse kinematic and inverse dynamic analyses for each walking cycle. Using the inverse kinematic results, we generated reference muscle-tendon length, velocity, and moment arm curves from the surrogate geometric models, which avoided potential discontinuities caused by problems associated with muscle wrapping surfaces. All EMG, inverse kinematic, inverse dynamic, and muscle-tendon geometric curves were resampled to 101 time points per walking cycle. In addition, to prevent numerical issues at heel strike and toe off, and to accommodate identification of electromechanical delays, we included 20 additional time frames of all data before the start of each gait cycle. Given the curves output by OpenSim analyses, we identified and removed outlier trials using criteria described in the <xref ref-type="supplementary-material" rid="pone.0179698.s001">S1 Appendix</xref>.</p>
<p>The two “calibrate, then test” evaluation scenarios differed based on whether or not the testing phase included walking data from faster speeds not included in the calibration phase. For the first scenario, model calibration was performed using 50 trials of data from all five walking speeds (10 trials per speed) and model testing was performed using an additional 50 trials of data from the same five speeds. For the second scenario, model calibration was performed using 30 trials of data from the three slowest walking speeds (10 trials per speed) and model testing was performing using an additional 50 trials of data from all five walking speeds, including 0.7 and 0.8 m/s. For both scenarios, two EMG-driven models, one with and one without geometric adjustments, were calibrated via optimization to match inverse dynamic joint moment data from the calibration walking trials. All models were adjusted to match joint moments for five DOFs in each leg: hip flexion extension, hip adduction-abduction, knee flexion-extension, ankle plantar-dorsiflexion, and ankle inversion-eversion. Since EMG data were collected from only 16 muscles in each leg, excitations for muscles without EMG data were specified using EMG data from related muscles [<xref ref-type="bibr" rid="pone.0179698.ref014">14</xref>]. A list of the muscles used in the model, the associated joints they actuate, and the EMG signals that control them can be found in <xref ref-type="table" rid="pone.0179698.t001">Table 1</xref>. Using only joint kinematics and processed EMG signals as inputs, the calibrated EMG-driven models were used to predict joint moments at each speed for 10 walking trials withheld from calibration. Mean absolute errors (MAE) between predicted and inverse dynamic joint moments were calculated across each gait cycle to evaluate the accuracy of all EMG-driven models:
<disp-formula id="pone.0179698.e034">
<alternatives>
<graphic id="pone.0179698.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e034" xlink:type="simple"/>
<mml:math display="block" id="M34">
<mml:mrow><mml:mi mathvariant="normal">MAE</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>t</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula>
where <inline-formula id="pone.0179698.e035"><alternatives><graphic id="pone.0179698.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is a moment from inverse dynamics, <inline-formula id="pone.0179698.e036"><alternatives><graphic id="pone.0179698.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179698.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>t</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the corresponding moment predicted by an EMG-driven model, and <italic>n</italic> is the number of time frames being evaluated. For each speed-joint-side combination, we performed a non-parametric Wilcoxon signed-rank test to evaluate whether the 10 MAE values for the two methods were statistically different. For average MAE differences across all speeds for each joint-side combination, we performed a non-parametric Friedman’s test with blocking based on gait speed. For all statistical tests, the level of statistical significance was set at <italic>p</italic> &lt; 0.05.</p>
</sec>
</sec>
<sec id="sec007" sec-type="results">
<title>Results</title>
<p>When calibrated using walking data from all five speeds, the EMG-driven model with geometric adjustments (henceforth the “WGA model”) produced more accurate moment predictions for all joints than did the model without geometric adjustments (henceforth the “NGA model”) (Figs <xref ref-type="fig" rid="pone.0179698.g003">3</xref> and <xref ref-type="fig" rid="pone.0179698.g004">4</xref>, <xref ref-type="table" rid="pone.0179698.t002">Table 2</xref>). For additional walking trials not used in the calibration process, geometric adjustments improved joint moment predictions by an average of 25%, with the largest improvements occurring at the hip (33%), following by the ankle (21%), and finally the knee (16%). The largest average improvement for any joint moment occurred for left hip adduction-abduction (43%). Improvements produced by adding geometric adjustments were generally comparable between legs and across walking speeds. From a statistical standpoint, 85% of the calculated percent changes in MAE were statically significant, with only the right ankle inverse-eversion moment demonstrating few statistically significant changes.</p>
<fig id="pone.0179698.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Average joint moment predictions for walking at 0.5 m/s when calibrating using all five walking speeds.</title>
<p>NGA stands for no geometric adjustments and WGA stands for with geometric adjustments. Average experimental values with gray bands specifying +/- 1 standard deviation are shown for visualization purposes and were calculated at each time point after each gait cycle was resampled to 101 points.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.g003" xlink:type="simple"/>
</fig>
<fig id="pone.0179698.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Average joint moment predictions for walking at 0.8 m/s when calibrating using all five walking speeds.</title>
<p>NGA stands for no geometric adjustments and WGA stands for with geometric adjustments. Average experimental values with gray bands specifying +/- 1 standard deviation are shown for visualization purposes and were calculated at each time point after each gait cycle was resampled to 101 points.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.g004" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0179698.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.t002</object-id>
<label>Table 2</label> <caption><title>Mean MAE values for testing trials using EMG-driven models calibrated at all available walking speeds without (NGA) and with (WGA) geometric adjustments.</title> <p>The percent change in MAE when geometric adjustments were added is also reported, with the standard deviation of MAE between trials shown in parenthesis.</p></caption>
<alternatives>
<graphic id="pone.0179698.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="2">Gait Speed</th>
<th align="center" rowspan="2">Model Type</th>
<th align="center" colspan="2">Hip FE (N-m)</th>
<th align="center" colspan="2">Hip AA (N-m)</th>
<th align="center" colspan="2">Knee FE (N-m)</th>
<th align="center" colspan="2">Ankle PDF (N-m)</th>
<th align="center" colspan="2">Ankle IE (N-m)</th>
</tr>
<tr>
<th align="center">Right</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">Left</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0.4 m/s</td>
<td align="center">NGA</td>
<td align="left">5.28 (1.34)</td>
<td align="left">5.31 (1.39)</td>
<td align="left">7.23 (0.83)</td>
<td align="left">7.91 (1.57)</td>
<td align="left">6.6 (0.49)</td>
<td align="left">5.43 (1.26)</td>
<td align="left">7.44 (2.29)</td>
<td align="left">5.96 (1.08)</td>
<td align="left">2.48 (1.46)</td>
<td align="left">6.18 (1.14)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="left">3.83 (0.81)</td>
<td align="left">4.61 (1.29)</td>
<td align="left">3.58 (0.46)</td>
<td align="left">4.99 (1.03)</td>
<td align="left">5.22 (0.66)</td>
<td align="left">4.69 (0.94)</td>
<td align="left">5.44 (2.66)</td>
<td align="left">5.28 (0.98)</td>
<td align="left">2.27 (1.85)</td>
<td align="left">4.88 (0.34)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-27.43<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-13.19</td>
<td align="center">-50.46<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-36.92<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-20.93<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-13.71<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-26.96<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-11.43</td>
<td align="center">-8.54</td>
<td align="center">-21.09<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
</tr>
<tr>
<td align="center">0.5 m/s</td>
<td align="center">NGA</td>
<td align="left">4.23 (1.03)</td>
<td align="left">5.94 (1.28)</td>
<td align="left">5.87 (0.72)</td>
<td align="left">7.64 (2.11)</td>
<td align="left">7.07 (0.78)</td>
<td align="left">4.67 (1.18)</td>
<td align="left">7.50 (2.15)</td>
<td align="left">7.14 (0.89)</td>
<td align="left">3.52 (2.47)</td>
<td align="left">5.74 (0.73)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="left">3.47 (0.64)</td>
<td align="left">4.47 (1.23)</td>
<td align="left">4.02 (1.36)</td>
<td align="left">4.26 (1.69)</td>
<td align="left">5.33 (0.64)</td>
<td align="left">4.28 (0.83)</td>
<td align="left">4.85 (0.94)</td>
<td align="left">6.09 (1.16)</td>
<td align="left">3.46 (2.74)</td>
<td align="left">4.40 (0.91)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-18.06<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-24.69<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-31.49<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-44.30<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-24.62<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-8.26</td>
<td align="center">-35.31<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-14.70<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-1.90</td>
<td align="center">-23.43<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
</tr>
<tr>
<td align="center">0.6 m/s</td>
<td align="center">NGA</td>
<td align="left">5.46 (1.43)</td>
<td align="left">6.76 (0.89)</td>
<td align="left">8.01 (1.89)</td>
<td align="left">7.81 (0.86)</td>
<td align="left">5.33 (1.14)</td>
<td align="left">5.11 (1.49)</td>
<td align="left">7.27 (1.92)</td>
<td align="left">7.24 (2.39)</td>
<td align="left">3.42 (1.15)</td>
<td align="left">5.98 (1.19)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="left">4.10 (0.75)</td>
<td align="left">4.94 (1.33)</td>
<td align="left">4.55 (0.60)</td>
<td align="left">4.46 (0.73)</td>
<td align="left">4.27 (0.85)</td>
<td align="left">4.81 (1.50)</td>
<td align="left">4.89 (2.03)</td>
<td align="left">5.63 (0.75)</td>
<td align="left">2.84 (1.40)</td>
<td align="left">4.27 (0.93)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-24.91<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-27.00<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-43.23<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-42.92<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-19.91<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-5.78</td>
<td align="center">-32.76<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-22.21<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-17.04<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-28.53<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
</tr>
<tr>
<td align="center">0.7 m/s</td>
<td align="center">NGA</td>
<td align="left">6.33 (1.05)</td>
<td align="left">7.08 (0.94)</td>
<td align="left">6.87 (1.37)</td>
<td align="left">8.26 (1.09)</td>
<td align="left">5.52 (1.07)</td>
<td align="left">6.05 (1.58)</td>
<td align="left">8.01 (2.33)</td>
<td align="left">7.43 (1.52)</td>
<td align="left">3.15 (1.31)</td>
<td align="left">5.78 (1.04)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="left">4.73 (1.10)</td>
<td align="left">5.50 (0.99)</td>
<td align="left">4.41 (1.48)</td>
<td align="left">4.46 (1.30)</td>
<td align="left">4.55 (0.52)</td>
<td align="left">4.92 (1.52)</td>
<td align="left">5.98 (1.33)</td>
<td align="left">5.51 (0.91)</td>
<td align="left">2.95 (1.33)</td>
<td align="left">4.05 (0.64)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-25.34<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-22.22<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-35.88<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-45.98<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-17.50</td>
<td align="center">-18.58<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-25.34<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-25.85<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-6.23</td>
<td align="center">-30.02<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
</tr>
<tr>
<td align="center">0.8 m/s</td>
<td align="center">NGA</td>
<td align="left">6.92 (0.79)</td>
<td align="left">7.45 (1.03)</td>
<td align="left">7.17 (1.06)</td>
<td align="left">8.81 (1.70)</td>
<td align="left">6.43 (0.61)</td>
<td align="left">4.76 (1.12)</td>
<td align="left">8.48 (1.79)</td>
<td align="left">7.24 (1.26)</td>
<td align="left">3.56 (1.73)</td>
<td align="left">5.50 (0.54)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="left">5.11 (1.30)</td>
<td align="left">5.04 (1.10)</td>
<td align="left">4.55 (0.62)</td>
<td align="left">4.79 (0.98)</td>
<td align="left">5.28 (0.56)</td>
<td align="left">4.22 (1.39)</td>
<td align="left">5.93 (1.56)</td>
<td align="left">5.99 (1.18)</td>
<td align="left">2.91 (1.41)</td>
<td align="left">4.22 (0.39)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-26.17<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-32.32<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-36.50<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-45.61<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-17.90<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-11.31<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-30.11<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-17.29<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-18.15<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-23.38<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
</tr>
<tr>
<td align="center">Average</td>
<td align="center">NGA</td>
<td align="center">5.65</td>
<td align="center">6.51</td>
<td align="center">7.03</td>
<td align="center">8.09</td>
<td align="center">6.19</td>
<td align="center">5.20</td>
<td align="center">7.74</td>
<td align="center">7.00</td>
<td align="center">3.23</td>
<td align="center">5.84</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="center">4.25</td>
<td align="center">4.91</td>
<td align="center">4.22</td>
<td align="center">4.59</td>
<td align="center">4.93</td>
<td align="center">4.58</td>
<td align="center">5.42</td>
<td align="center">5.70</td>
<td align="center">2.88</td>
<td align="center">4.36</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-24.76<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-24.50<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-39.95<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-43.22<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-20.36<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-11.87<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-30.02<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-18.60<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="center">-10.56</td>
<td align="center">-25.27<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p>* indicates a statistically significant change (<italic>p</italic> &lt; 0.05) based on Wilcoxon signed-rank tests. For average differences, a Friedman’s test with blocking based on gait speed was used.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>When calibrated using walking data from only the three slowest speeds, the WGA model again produced more accurate moment predictions for all joints than did the NGA model, with the one exception being the right ankle inversion-eversion moment (Figs <xref ref-type="fig" rid="pone.0179698.g005">5</xref> and <xref ref-type="fig" rid="pone.0179698.g006">6</xref>, <xref ref-type="table" rid="pone.0179698.t003">Table 3</xref>). For additional walking trials at speeds used in the calibration process, geometric adjustments improved joint moment predictions by an average of 23%, with the largest improvements occurring at the hip (34%), following by the knee (22%), and finally the ankle (12%). The largest average improvement for any joint moment occurred for right hip adduction-abduction (46%). For additional walking trials at faster speeds not used for calibration, geometric adjustments improved joint moment predictions by an average of 15%, with the largest improvements again occurring at the hip (23%), following by the ankle (10%), and finally the knee (9%). The largest average improvement for any joint moment again occurred for left hip adduction-abduction (37%). As noted above, the one exception was the right ankle inversion-eversion moment, which exhibited worse moment predictions (9% of an extremely small moment) with the addition of geometric adjustments. From a statistical standpoint, 72% of the calculated percent changes in MAE were statically significant, with only the right ankle inversion-eversion and left ankle plantarflexion-dorsiflexion moments demonstrating few statistically significant changes.</p>
<fig id="pone.0179698.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Average joint moment predictions for walking at 0.5 m/s when calibrating using only the three slowest walking speeds.</title>
<p>NGA stands for no geometric adjustments and WGA stands for with geometric adjustments. Average experimental values with gray bands specifying +/- 1 standard deviation are shown for visualization purposes and were calculated at each time point after each gait cycle was resampled to 101 points.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.g005" xlink:type="simple"/>
</fig>
<fig id="pone.0179698.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Average joint moment predictions for walking at 0.8 m/s when calibrating using only the three slowest walking speeds.</title>
<p>NGA stands for no geometric adjustments and WGA stands for with geometric adjustments. Average experimental values with gray bands specifying +/- 1 standard deviation are shown for visualization purposes and were calculated at each time point after each gait cycle was resampled to 101 points.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.g006" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0179698.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.t003</object-id>
<label>Table 3</label> <caption><title>Mean MAE values for testing trials using EMG-driven models calibrated at 0.4, 0.5, and 0.6 m/s walking speeds without (NGA) and with (WGA) geometric adjustments.</title> <p>The percent change in MAE when geometric adjustments were added is also reported, with the standard deviation of MAE between trials shown in parenthesis. The bold row headers indicate the gait speeds being predicted that were not included in model calibration.</p></caption>
<alternatives>
<graphic id="pone.0179698.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="2">Gait Speed</th>
<th align="center" rowspan="2">Model Type</th>
<th align="center" colspan="2">Hip FE (N-m)</th>
<th align="center" colspan="2">Hip AA (N-m)</th>
<th align="center" colspan="2">Knee FE (N-m)</th>
<th align="center" colspan="2">Ankle PDF (N-m)</th>
<th align="center" colspan="2">Ankle IE (N-m)</th>
</tr>
<tr>
<th align="center">Right</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">Left</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0.4 m/s</td>
<td align="center">NGA</td>
<td align="left">5.06 (1.39)</td>
<td align="left">5.13 (1.48)</td>
<td align="left">6.98 (0.70)</td>
<td align="left">7.77 (1.31)</td>
<td align="left">6.69 (0.50)</td>
<td align="left">5.34 (1.34)</td>
<td align="left">7.25 (2.39)</td>
<td align="left">5.06 (1.10)</td>
<td align="left">2.01 (1.21)</td>
<td align="left">5.82 (1.03)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="left">3.78 (0.73)</td>
<td align="left">4.45 (1.00)</td>
<td align="left">3.37 (0.55)</td>
<td align="left">4.99 (1.22)</td>
<td align="left">4.37 (0.57)</td>
<td align="left">4.50 (0.86)</td>
<td align="left">5.79 (2.37)</td>
<td align="left">4.80 (1.34)</td>
<td align="left">2.07 (1.78)</td>
<td align="left">4.60 (0.40)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-25.21<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-13.30</td>
<td align="center">-51.67<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-35.77<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-34.68<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-15.69<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-20.22<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-5.08</td>
<td align="center">2.96</td>
<td align="center">-20.88<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
</tr>
<tr>
<td align="center">0.5 m/s</td>
<td align="center">NGA</td>
<td align="left">4.32 (1.09)</td>
<td align="left">5.77 (1.45)</td>
<td align="left">6.41 (0.94)</td>
<td align="left">7.38 (1.78)</td>
<td align="left">7.24 (0.74)</td>
<td align="left">4.47 (1.22)</td>
<td align="left">6.8 (2.25)</td>
<td align="left">6.02 (1.09)</td>
<td align="left">2.88 (2.04)</td>
<td align="left">5.29 (0.59)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="left">3.15 (0.73)</td>
<td align="left">4.20 (0.97)</td>
<td align="left">3.57 (1.07)</td>
<td align="left">4.21 (1.85)</td>
<td align="left">4.18 (0.77)</td>
<td align="left">3.93 (0.87)</td>
<td align="left">4.89 (1.02)</td>
<td align="left">5.56 (1.20)</td>
<td align="left">3.50 (2.79)</td>
<td align="left">4.00 (0.65)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-26.96<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-27.25<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-44.28<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-42.92<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-42.26<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-12.12<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-28.07<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-7.72</td>
<td align="center">21.55<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-24.41<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
</tr>
<tr>
<td align="center">0.6 m/s</td>
<td align="center">NGA</td>
<td align="left">5.54 (1.52)</td>
<td align="left">6.64 (0.89)</td>
<td align="left">8.26 (2.38)</td>
<td align="left">7.70 (0.92)</td>
<td align="left">6.39 (1.37)</td>
<td align="left">5.68 (1.46)</td>
<td align="left">6.74 (1.82)</td>
<td align="left">5.79 (2.53)</td>
<td align="left">2.70 (0.90)</td>
<td align="left">5.53 (1.04)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="left">4.30 (1.12)</td>
<td align="left">4.76 (1.49)</td>
<td align="left">4.71 (1.06)</td>
<td align="left">4.39 (0.92)</td>
<td align="left">5.88 (0.69)</td>
<td align="left">4.84 (1.30)</td>
<td align="left">5.23 (2.01)</td>
<td align="left">5.30 (1.16)</td>
<td align="left">2.70 (1.02)</td>
<td align="left">3.83 (0.72)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-22.43<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-28.41<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-42.95<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-43.00<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-7.97<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-14.77<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-22.41<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-8.47<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-0.14</td>
<td align="center">-30.70<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
</tr>
<tr>
<td align="center">Average</td>
<td align="center">NGA</td>
<td align="center">4.97</td>
<td align="center">5.85</td>
<td align="center">7.22</td>
<td align="center">7.62</td>
<td align="center">6.77</td>
<td align="center">5.17</td>
<td align="center">6.93</td>
<td align="center">5.62</td>
<td align="center">2.53</td>
<td align="center">5.55</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="center">3.75</td>
<td align="center">4.47</td>
<td align="center">3.89</td>
<td align="center">4.53</td>
<td align="center">4.81</td>
<td align="center">4.43</td>
<td align="center">5.30</td>
<td align="center">5.22</td>
<td align="center">2.76</td>
<td align="center">4.14</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-24.68<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-23.61<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-46.16<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-40.51<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-28.99<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-14.32<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-23.49<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-7.19</td>
<td align="center">8.90</td>
<td align="center">-25.27<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
</tr>
<tr>
<td align="center"><bold>0.7 m/s</bold></td>
<td align="center">NGA</td>
<td align="left">6.50 (1.09)</td>
<td align="left">7.38 (1.11)</td>
<td align="left">7.42 (2.02)</td>
<td align="left">8.13 (1.37)</td>
<td align="left">6.26 (1.1)</td>
<td align="left">7.27 (1.43)</td>
<td align="left">7.66 (1.89)</td>
<td align="left">6.45 (1.34)</td>
<td align="left">2.46 (1.23)</td>
<td align="left">5.29 (0.98)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="left">5.14 (1.04)</td>
<td align="left">6.70 (1.18)</td>
<td align="left">4.67 (2.02)</td>
<td align="left">5.21 (1.5)</td>
<td align="left">6.23 (0.62)</td>
<td align="left">6.12 (1.50)</td>
<td align="left">6.18 (1.30)</td>
<td align="left">5.93 (0.93)</td>
<td align="left">2.95 (1.35)</td>
<td align="left">3.73 (0.47)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-20.93<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-9.30<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-37.02<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-35.97<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-0.46</td>
<td align="center">-15.84<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-19.29<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-8.01<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">20.23<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-29.48<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
</tr>
<tr>
<td align="center"><bold>0.8 m/s</bold></td>
<td align="center">NGA</td>
<td align="left">7.02 (0.87)</td>
<td align="left">7.42 (1.27)</td>
<td align="left">7.50 (1.50)</td>
<td align="left">9.40 (1.88)</td>
<td align="left">7.75 (0.62)</td>
<td align="left">6.75 (1.29)</td>
<td align="left">8.03 (2.10)</td>
<td align="left">6.63 (1.45)</td>
<td align="left">2.95 (1.66)</td>
<td align="left">5.19 (0.52)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="left">6.25 (1.61)</td>
<td align="left">7.34 (1.20)</td>
<td align="left">4.89 (1.01)</td>
<td align="left">5.84 (0.88)</td>
<td align="left">7.52 (0.57)</td>
<td align="left">5.65 (1.53)</td>
<td align="left">6.45 (1.63)</td>
<td align="left">6.54 (1.98)</td>
<td align="left">2.92 (1.21)</td>
<td align="left">4.08 (0.32)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-10.93</td>
<td align="center">-1.06</td>
<td align="center">-34.79<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-37.87<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-2.91</td>
<td align="center">-16.35<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-19.74<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-1.41</td>
<td align="center">-1.17</td>
<td align="center">-21.32<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
</tr>
<tr>
<td align="center"><bold>Average</bold></td>
<td align="center">NGA</td>
<td align="center">6.76</td>
<td align="center">7.40</td>
<td align="center">7.46</td>
<td align="center">8.76</td>
<td align="center">7.01</td>
<td align="center">7.01</td>
<td align="center">7.85</td>
<td align="center">6.54</td>
<td align="center">2.70</td>
<td align="center">5.24</td>
</tr>
<tr>
<td align="center"/>
<td align="center">WGA</td>
<td align="center">5.69</td>
<td align="center">7.02</td>
<td align="center">4.78</td>
<td align="center">5.52</td>
<td align="center">6.88</td>
<td align="center">5.89</td>
<td align="center">6.32</td>
<td align="center">6.23</td>
<td align="center">2.94</td>
<td align="center">3.91</td>
</tr>
<tr>
<td align="center"/>
<td align="center">% Change</td>
<td align="center">-15.74<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-5.17</td>
<td align="center">-35.90<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-36.99<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-1.81</td>
<td align="center">-16.09<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-19.52<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">-4.66</td>
<td align="center">8.55</td>
<td align="center">-25.44<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001"><p>* indicates a statistically significant change (<italic>p</italic> &lt; 0.05) based on Wilcoxon signed-rank tests. For average differences, a Friedman’s test with blocking based on gait speed was used.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Geometric adjustments improved joint moment predictions by making relatively small changes to muscle-tendon lengths and moment arms (Tables A2 and A3 in the <xref ref-type="supplementary-material" rid="pone.0179698.s001">S1 Appendix</xref>). For both “calibrate, then test” scenarios, the average change in muscle-tendon length was less than 0.9 cm (5%), while the average change in muscle moment arm was less than 0.5 cm (17%). On average, the largest muscle-tendon length change was 3.8 cm (8%) for the left semitendinosus muscle, the largest absolute mean moment arm change was 1.8 cm (44%) for the left soleus muscle about the left ankle joint, and the largest percent moment arm change was 121% (0.8 cm) for the left medial gastrocnemius muscle about the left subtalar joint. These changes allowed the WGA and NGA models to match the published passive moment curves well, though the WGA model matched them slightly better (<xref ref-type="fig" rid="pone.0179698.g007">Fig 7</xref>).</p>
<fig id="pone.0179698.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Passive joint moment matching.</title>
<p>Passive moments predicted by our EMG-driven models calibrated using all walking speeds (dashed lines) compared to published passive moments (solid lines) for the WGA and NGA models.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>This study evaluated a novel method for calibrating an EMG-driven model of walking, including automated adjustment of surrogate musculoskeletal geometry, to match experimental joint moment data. In addition to geometric adjustments, the method possesses several other unique features, including scaling of EMG signals and matching of published lower extremity passive joint moment curves. The approach was evaluated using walking data collected from a hemiparetic subject, highlighting that neurological impairment may not limit the potential utility of the approach (i.e., the subject’s neural control strategy does not need to be “optimal”). When scaled generic musculoskeletal geometry was used without adjustment, the EMG-driven model was less accurate at predicting joint moments, especially for the hip. Though we cannot claim that the adjusted geometry is a more accurate representation of the subject’s actual geometry, these adjustments improved lower extremity joint moment predictions both for speeds used in the calibration process and for faster speeds omitted from calibration. When creating EMG-driven models of walking that include the hip, adjustments to musculoskeletal geometry may be especially helpful for improving the accuracy of hip moment predictions.</p>
<p>Our EMG-driven models with geometric adjustments predicted joint moments for walking more accurately and under more complex conditions than did previous EMG-driven studies that predicted joint moments using only walking data (<xref ref-type="table" rid="pone.0179698.t004">Table 4</xref>) [<xref ref-type="bibr" rid="pone.0179698.ref013">13</xref>,<xref ref-type="bibr" rid="pone.0179698.ref015">15</xref>]. In our study, joint moment predictions were generated for five DOFs in both legs using 16 EMG signals per leg with a large number of walking trials collected at multiple walking speeds, including trials from faster walking speeds not included in the calibration process. In two previous EMG-driven studies that calibrated their models using only walking data, joint moments were predicted for only the ankle [<xref ref-type="bibr" rid="pone.0179698.ref013">13</xref>] or only the knee [<xref ref-type="bibr" rid="pone.0179698.ref015">15</xref>] using 7 to 10 EMG signals from a single leg with a small number of walking trials collected at a single walking speed. Despite the use of more complex conditions, our EMG-driven model still produced lower moment errors for walking speeds included in and omitted from calibration. The only EMG-driven modeling study to date to report errors in predicted hip moments during walking is Sartori et al. (2012) [<xref ref-type="bibr" rid="pone.0179698.ref014">14</xref>]. Though our hip moment prediction errors are much lower than those reported in that study (see <xref ref-type="table" rid="pone.0179698.t004">Table 4</xref>), their single- and multi-DOF EMG-driven models were calibrated using data from walking plus three other activities, which likely have made their calibration process more difficult. At the same time, their high hip moment prediction errors are consistent with our findings that geometric adjustments are especially helpful for the hip.</p>
<table-wrap id="pone.0179698.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179698.t004</object-id>
<label>Table 4</label> <caption><title>Comparison of moment error values reported in the literature with moment error values reported in this study.</title> <p>Other EMG-driven studies not indicated [<xref ref-type="bibr" rid="pone.0179698.ref012">12</xref>,<xref ref-type="bibr" rid="pone.0179698.ref016">16</xref>–<xref ref-type="bibr" rid="pone.0179698.ref019">19</xref>] have prediction errors greater than those listed in this table or use a variety of activities for calibration and/or testing and are therefore disqualified from comparison. For the knee and ankle joints, the studies shown calibrate and test their models using only gait data. Sartori et al. 2014 was the only available EMG-driven model of the hip, and was calibrated using a variety of activities.</p></caption>
<alternatives>
<graphic id="pone.0179698.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.t004" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center" colspan="2">Literature</th>
<th align="center" colspan="2">This Study Single-DOF</th>
<th align="center" colspan="2">This Study Multi-DOF</th>
</tr>
<tr>
<th align="center">DOF</th>
<th align="center">Single-DOF</th>
<th align="center">Multi-DOF</th>
<th align="center">NGA</th>
<th align="center">WGA</th>
<th align="center">NGA</th>
<th align="center">WGA</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Hip FE</td>
<td align="center">17<xref ref-type="table-fn" rid="t004fn001"><sup>1</sup></xref></td>
<td align="center">26<xref ref-type="table-fn" rid="t004fn001"><sup>1</sup></xref></td>
<td align="center">4.42</td>
<td align="center">3.87</td>
<td align="center">6.08</td>
<td align="center">4.58</td>
</tr>
<tr>
<td align="center">Hip AA</td>
<td align="center">9.7<xref ref-type="table-fn" rid="t004fn001"><sup>1</sup></xref></td>
<td align="center">16<xref ref-type="table-fn" rid="t004fn001"><sup>1</sup></xref></td>
<td align="center">6.39</td>
<td align="center">4.02</td>
<td align="center">7.56</td>
<td align="center">4.41</td>
</tr>
<tr>
<td align="center">Knee FE</td>
<td align="center">7.80<xref ref-type="table-fn" rid="t004fn002"><sup>2</sup></xref></td>
<td align="center">7.6<xref ref-type="table-fn" rid="t004fn001"><sup>1</sup></xref></td>
<td align="center">4.61</td>
<td align="center">4.27</td>
<td align="center">5.70</td>
<td align="center">4.76</td>
</tr>
<tr>
<td align="center">Ankle PDF</td>
<td align="center">6.03<xref ref-type="table-fn" rid="t004fn003"><sup>3</sup></xref></td>
<td align="center">16<xref ref-type="table-fn" rid="t004fn001"><sup>1</sup></xref></td>
<td align="center">6.51</td>
<td align="center">4.70</td>
<td align="center">7.37</td>
<td align="center">5.56</td>
</tr>
<tr>
<td align="center">Ankle IE</td>
<td align="center">—</td>
<td align="center">—</td>
<td align="center">2.96</td>
<td align="center">2.36</td>
<td align="center">4.53</td>
<td align="center">3.62</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t004fn001"><p><sup>1</sup>Sartori <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0179698.ref014">14</xref>] MAE (values estimated from figures since values for walking only were not explicitly stated)</p></fn>
<fn id="t004fn002"><p><sup>2</sup>Kumar <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0179698.ref015">15</xref>] root mean square error (RMSE)</p></fn>
<fn id="t004fn003"><p><sup>3</sup>Bogey <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0179698.ref013">13</xref>] RMSE</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Most studies calibrate their EMG-driven models to predict moments about a single DOF, which is a simpler problem than predicting moments about five DOFs simultaneously. Sartori <italic>et al</italic>. (2012) [<xref ref-type="bibr" rid="pone.0179698.ref014">14</xref>] found that single-DOF NGA models calibrated with similar accuracy as a four-DOF NGA model. In contrast, when we calibrated single-DOF NGA and WGA models using our optimization framework, moment errors were always lower than with the corresponding multi-DOF model (<xref ref-type="table" rid="pone.0179698.t004">Table 4</xref>). This finding makes sense since multi-DOF models constrain the solution more than do single-DOF models due to inter-joint coupling caused by muscles that actuate multiple DOFs. Interestingly, our multi-DOF WGA model produced comparable moment errors (sometimes slightly better, sometimes slightly worse) to our single-DOF NGA models, again highlighting the value of adding geometric adjustments.</p>
<p>In addition to adjustment of surrogate musculoskeletal geometry, our EMG-driven modeling approach possessed six other unique features that likely improved our moment predictions even without geometric adjustments. First, our study utilized fine-wire EMG data from several deep muscles. Fine-wire EMG data allowed us to include potentially important muscles omitted from most other studies: iliopsoas, tibialis posterior, flexor digitorum longus, and extensor digitorum longus. Omission of these muscles likely contributed to increased moment prediction errors in previous studies, especially omission of iliopsoas for the hip flexion moment. Secondly, our study filtered EMG data with a variable low pass cutoff frequency that depended on the period of the gait cycle. When using a constant low pass cutoff frequency, we found that slow gait speeds would have comparatively noisier EMG signals than did faster speeds, which adversely affected our moment predictions. In contrast, when a variable low pass cutoff frequency was used, moment predictions became more reliable across speeds. Third, our study optimized scale factors defining maximum EMG values. Most studies normalize EMG data to a maximum voluntary contraction trial (MVC) or the maximum EMG value over all collected trials. However, these methods may be unreliable indicators of maximum muscle excitation [<xref ref-type="bibr" rid="pone.0179698.ref053">53</xref>], and true MVC trials are often hard to obtain. Furthermore, maximal M-wave measurements demonstrate that MVC trials produce EMG values that are smaller than maximum EMG [<xref ref-type="bibr" rid="pone.0179698.ref053">53</xref>–<xref ref-type="bibr" rid="pone.0179698.ref055">55</xref>]. Therefore, we decided to optimize a muscle excitation scale factor and penalize it for deviating away from its initial value. Inclusion of optimized excitation scale factors was one of the most valuable unique additions in our approach. Fourth, our study included matching of experimentally measured passive joint moments reported in the literature [<xref ref-type="bibr" rid="pone.0179698.ref051">51</xref>]. These moments corresponded to much larger ranges and combinations of joint angles than occur during walking. Though these data were not subject specific, they likely helped the muscles in our model to traverse reasonable ranges on their normalized force-length curves. Matching of passive joint moment curves was another highly valuable unique addition in our approach. Fifth, our study used a larger number of walking trials for model calibration and testing. Use of a large number of trials allowed us to minimize the impact of outlier trials in both our calibration and testing process. It also allowed us to capture the broadest possible variability in the subject’s walking data, which was important since our method uses only walking data for calibration. Lastly, our study included kinematic calibration of lower extremity joint centers and orientations [<xref ref-type="bibr" rid="pone.0179698.ref037">37</xref>,<xref ref-type="bibr" rid="pone.0179698.ref048">48</xref>]. Previous studies have demonstrated that inverse dynamics moments are sensitive to the position and orientation of joint centers in the body segments [<xref ref-type="bibr" rid="pone.0179698.ref056">56</xref>]. As a result, the moments being matched during calibration may not be the true moments produced by muscles, resulting in EMG-driven calibration and prediction errors. Furthermore, placing a joint center in the wrong location causes offsets in muscle moment arms, further decreasing the quality of the moment predictions. Calibration of lower limb joint positions and orientations may have eliminated some of these modeling errors, thereby improving EMG-driven predictions.</p>
<p>While adjustments to geometric parameter values greatly reduced moment prediction errors, the accuracy with which the adjusted geometry represents the subject is unknown. Scaled generic models can have errors in mean moment arm values on the order of 3 to 4 cm [<xref ref-type="bibr" rid="pone.0179698.ref030">30</xref>]. Similarly, errors in muscle-tendon lengths can be 10 cm or more compared to geometric data obtained from MR images [<xref ref-type="bibr" rid="pone.0179698.ref030">30</xref>]. Such errors have been shown to have a significant impact on predicted joint moments in an EMG-driven knee model [<xref ref-type="bibr" rid="pone.0179698.ref029">29</xref>]. In our study, the largest average moment arm change was 1.8 cm, while the largest average muscle-tendon length change was 3.8 cm (Tables A2 and A3). These changes are well within the error ranges reported in the literature, suggesting that the geometric adjustments were at least reasonable.</p>
<p>While other studies have used varied movements and dynamometer data to calibrate and test their EMG-driven models, we purposefully used only walking data combined with published passive joint moment data for our calibration process. Restoring normal walking function is a common and important clinical goal. Therefore, models that can reproduce experimental walking data have an increased likelihood of being clinically useful. Furthermore, it could be difficult in a time-limited clinical setting with function-limited patients to collect EMG, motion capture, and ground reaction data for a wide range of movement tasks. For these reasons, we decided to calibrate our EMG-driven models using only the subject’s walking data and published passive joint moment data.</p>
<p>We made several decisions to account for the limitations of using primarily walking data for model calibration. To increase the information content in our calibration data, we used a large number of walking trials (10 per speed for either three or five speeds). As indicated by post-hoc statistical analyses, this approach resulted in joint angles, joint moments, and EMG amplitudes that were statistically different between the faster and slower walking speeds. Since walking data provide information over only limited ranges of joint motion and loading, we included published passive joint moment data [<xref ref-type="bibr" rid="pone.0179698.ref051">51</xref>] in our calibration process. This decision provided moment calibration information over broader ranges of motion than occur during walking. While our hemiparetic subject is likely to be less flexible than the healthy subjects used in [<xref ref-type="bibr" rid="pone.0179698.ref051">51</xref>], these unique data still represent the general trends in passive moments one might expect to observe in any ambulatory individual. Without including these extra data, the passive moments predicted at extreme joint angles outside the bounds of walking were unrealistic, with muscles generating passive forces that were well above maximum isometric force. Nonetheless, since our EMG-driven model calibration process was based primarily on walking data, it may not predict joint moments well for motions other than walking.</p>
<p>The ability of our EMG-driven model with geometric adjustments to predict joint moments well for faster non-calibration walking speeds may make this model clinically useful for predictive gait optimization studies. By incorporating our EMG-driven model into a dynamic patient-specific full-body walking model that includes deformable foot-ground contact models, researchers could predict how changes in a patient’s muscle excitations could alter the patient’s gait pattern in a favorable way [<xref ref-type="bibr" rid="pone.0179698.ref057">57</xref>]. Muscle excitations could be controlled individually or coupled together through muscle synergies calculated from the patient’s EMG data [<xref ref-type="bibr" rid="pone.0179698.ref057">57</xref>]. For a subject with hemiparesis, the optimizations could seek to identify minimal changes in the patient’s muscle excitations that would produce a desired improvement in walking speed and bilateral symmetry. The predicted neural control and gait pattern changes could potentially help clinicians determine which muscles should be targeted for excitation timing changes, strength increases, and/or functional electrical stimulation (i.e., treatment prescription), as well as how much of each type of change is required (i.e., treatment dosage).</p>
<p>For such approach to become clinically useful, computational speed will be an important consideration. For all 5 speeds together with 10 gait trials per speed, EMG-driven model calibration performed using 10 of 12 cores on a 2 GHz Intel Xeon workstation required approximately 2 hours of CPU time for the NGA approach and 10 hours for the WGA approach. The NGA approach has roughly a third of the design variables of the WGA approach and skips one round of step-wise optimizations. For both approaches, repeated spline sampling of processed EMG data to accommodate eletromechanical delays is the primary computational bottleneck. While the WGA CPU time in particular may seem high, it needs to be viewed in light of the larger “computational neurorehabilitation” treatment design process. It currently takes about half a day to collect the necessary walking data and one to three days to process it before an EMG-driven model can be calibrated. It also takes about day to calibrate a full-body walking model to match the subject’s EMG, marker motion, and ground reaction data simultaneously with a dynamically consistent model. Once the full-body model is calibrated, however, new walking motions can be predicted via direct collocation optimal control in about 30 minutes of CPU time [<xref ref-type="bibr" rid="pone.0179698.ref057">57</xref>]. Thus, it would currently be impossible to collect data, process it, calibrate the EMG-driven model, calibrate the dynamic full-body walking model, and generate new walking motion predictions within a single clinical visit. Nonetheless, development of personalized neurorehabilitation prescriptions off-line could still be valuable if the prescriptions are more effective and efficient than those currently developed solely through clinical intuition.</p>
<p>One of the primary limitations of the present study was the use of a deterministic rather than stochastic EMG-driven model development and evaluation process. When undertaking this study, our goal was to build upon published EMG-driven modeling studies [<xref ref-type="bibr" rid="pone.0179698.ref012">12</xref>,<xref ref-type="bibr" rid="pone.0179698.ref014">14</xref>–<xref ref-type="bibr" rid="pone.0179698.ref016">16</xref>,<xref ref-type="bibr" rid="pone.0179698.ref028">28</xref>] by adding one primary enhancement (adjustment of parameter values related to surrogate representations of the musculoskeletal geometry) along with several secondary enhancements (matching of published passive joint moment data, adjusting EMG normalization parameters, calibrating joint positions/orientations to improve the accuracy of inverse dynamic joint moments). These previous studies followed a similar deterministic model development and evaluation approach. In contrast, a stochastic model development and evaluation approach would account for how uncertainties in experimental inputs (i.e., ground reactions, marker motions) and skeletal model parameter values (i.e., joint positions and orientations, segment mass properties) affect the inverse dynamic joint moments being matched in the model calibration process. Such an approach, which would need to be designed and implemented differently than the present deterministic approach, would facilitate assessment of EMG-driven model joint moment predictions in light of the amount of uncertainty present in the net joint moments from inverse dynamics.</p>
<p>To explore whether inverse dynamic joint moment uncertainties would have affected our findings significantly, we performed a post-hoc Monte Carlo analysis (see <xref ref-type="supplementary-material" rid="pone.0179698.s001">S1 Appendix</xref> for details) on a representative walking trial from the 0.8 m/s speed, where inverse dynamic joint moment errors would be expected to be the largest. The analysis performed 2000 perturbed inverse dynamic analyses, where each iteration added estimated uncertainties to the input ground reactions, marker motions, and skeletal model joint positions/orientations (Table A4 in <xref ref-type="supplementary-material" rid="pone.0179698.s001">S1 Appendix</xref>). For each iteration, mean absolute error (MAE) across the gait cycle was calculated for each inverse dynamic moment, and the mean and standard deviation of the 2000 MAE values were then calculated (Table A5 in <xref ref-type="supplementary-material" rid="pone.0179698.s001">S1 Appendix</xref>). Compared to these mean MAE values, the mean MAE values calculated for the NGA and WGA methods were between 1.7 and 9.4 times larger (Table A5 in <xref ref-type="supplementary-material" rid="pone.0179698.s001">S1 Appendix</xref>), indicating that both EMG-driven modeling methods were fitting data rather than noise and that improvements from the WGA method over the NGA method reported in Tables <xref ref-type="table" rid="pone.0179698.t002">2</xref> and <xref ref-type="table" rid="pone.0179698.t003">3</xref> were likely true improvements.</p>
<p>This study possesses several other important limitations that have not been mentioned previously and should be considered when interpreting our results. First, due to the complexity of the EMG-driven model development process, we have only modeled a single hemiparetic subject thus far. However, the purpose of the present study was to evaluate the feasibility and potential benefits of our proposed EMG-driven modeling method with geometric adjustments, and analysis of a single subject is sufficient for those purposes. Second, our method requires EMG data, including signals from deep muscles acquired with fine-wire electrodes, for all muscles that contribute significantly to the task being modeled. In our case, this requirement meant that fine-wire data were needed from iliopsoas in particular. Without prior knowledge of muscle excitation patterns, our optimization problem would be highly underdetermined with no well-defined solution. For studies lacking critical EMG data, geometric adjustments using the methods described here would be difficult. Third, our model includes muscles for which EMG data are not available. For these muscles, we apply excitations from anatomically related muscles (review <xref ref-type="table" rid="pone.0179698.t001">Table 1</xref> describing how 16 EMG signals were applied to 35 muscles per leg), which may not accurately represent the true excitations. Fourth, our method used initial model parameter values and bounds taken from the literature. There is no guarantee that literature values will represent well the anatomy of a particular subject, and even using them for bounds may over-constrain the model. Unfortunately, clinical measurement of patient-specific model parameter values is not currently possible, and thus literature values must suffice as a starting point for the time being. Fifth, we assumed bilateral symmetry for most model parameter values, despite the fact that our subject had suffered a stroke. We evaluated this assumption by removing the bilateral symmetry requirement and recalibrating each leg separately across all speeds. While this modification produced small improvements in joint moment predictions, the optimizations were more likely to get stuck in a local minimum. Furthermore, computation time increased significantly due to a near doubling in the number of model parameter values. For these reasons, we maintained bilateral symmetry for all model parameter values except excitation scale factors and time delays. For subjects with greater neurological impairment, a bilateral symmetry assumption may be more limiting.</p>
<p>In conclusion, the novel EMG-driven model calibration method with geometric adjustments presented in this study improved joint moment prediction accuracy for walking compared to results generated using a scaled geometric musculoskeletal model. The proposed EMG-driven model creation process can be almost entirely automated and requires little effort when compared with construction of complex geometric models from MR and/or CT data. Because of its improved moment prediction accuracy, our modeling method with geometric adjustments may prove useful in future clinical applications. Based on the results of this study, we recommend that researchers incorporate geometric adjustments into their EMG-driven modeling process to improve the accuracy of joint moment predictions for walking, especially at the hip.</p>
</sec>
<sec id="sec009">
<title>Supporting information</title>
<supplementary-material id="pone.0179698.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0179698.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Appendix of supporting information.</title>
<p>This information includes details of optimization problem formulation, details of outlier identification methods, tables of muscle-tendon length and moment arm changes, and estimation of inverse dynamic joint moment errors via Monte Carlo analyses.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pone.0179698.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aisen</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Kerkovich</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mast</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mulroy</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wren</surname> <given-names>TAL</given-names></name>, <name name-style="western"><surname>Kay</surname> <given-names>RM</given-names></name>, <etal>et al</etal>. <article-title>Cerebral palsy: clinical care and neurological rehabilitation</article-title>. <source>Lancet Neurol</source>. <year>2011</year>;<volume>10</volume>: <fpage>844</fpage>–<lpage>852</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S1474-4422(11)70176-4" xlink:type="simple">10.1016/S1474-4422(11)70176-4</ext-link></comment> <object-id pub-id-type="pmid">21849165</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Feigin</surname> <given-names>VL</given-names></name>, <name name-style="western"><surname>Lawes</surname> <given-names>CMM</given-names></name>, <name name-style="western"><surname>Bennett</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Barker-Collo</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Parag</surname> <given-names>V</given-names></name>. <article-title>Worldwide stroke incidence and early case fatality reported in 56 population-based studies: a systematic review</article-title>. <source>Lancet Neurol</source>. <year>2009</year>;<volume>8</volume>: <fpage>355</fpage>–<lpage>369</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S1474-4422(09)70025-0" xlink:type="simple">10.1016/S1474-4422(09)70025-0</ext-link></comment> <object-id pub-id-type="pmid">19233729</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Soh</surname> <given-names>S-E</given-names></name>, <name name-style="western"><surname>McGinley</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Watts</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Iansek</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Menz</surname> <given-names>HB</given-names></name>, <etal>et al</etal>. <article-title>Determinants of health-related quality of life in people with Parkinson’s disease: a path analysis</article-title>. <source>Qual Life Res</source>. <year>2013</year>;<volume>22</volume>: <fpage>1543</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11136-012-0289-1" xlink:type="simple">10.1007/s11136-012-0289-1</ext-link></comment> <object-id pub-id-type="pmid">23070750</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prieto-Alhambra</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Judge</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Javaid</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Cooper</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Diez-Perez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Arden</surname> <given-names>NK</given-names></name>. <article-title>Incidence and risk factors for clinically diagnosed knee, hip and hand osteoarthritis: influences of age, gender and osteoarthritis affecting other joints</article-title>. <source>Ann Rheum Dis</source>. <year>2013</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1136/annrheumdis-2013-203355" xlink:type="simple">10.1136/annrheumdis-2013-203355</ext-link></comment> <object-id pub-id-type="pmid">23744977</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fregly</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Boninger</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Reinkensmeyer</surname> <given-names>DJ</given-names></name>. <article-title>Personalized neuromusculoskeletal modeling to improve treatment of mobility impairments: a perspective from European research sites</article-title>. <source>J Neuroeng Rehabil. BioMed Central</source>; <year>2012</year>;<volume>9</volume>: <fpage>18</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1743-0003-9-18" xlink:type="simple">10.1186/1743-0003-9-18</ext-link></comment> <object-id pub-id-type="pmid">22463378</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barrios</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Crossley</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>IS</given-names></name>. <article-title>Gait retraining to reduce the knee adduction moment through real-time visual feedback of dynamic knee alignment</article-title>. <source>J Biomech</source>. <year>2010</year>;<volume>43</volume>: <fpage>2208</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiomech.2010.03.040" xlink:type="simple">10.1016/j.jbiomech.2010.03.040</ext-link></comment> <object-id pub-id-type="pmid">20452595</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mündermann</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Asay</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Mündermann</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Andriacchi</surname> <given-names>TP</given-names></name>. <article-title>Implications of increased medio-lateral trunk sway for ambulatory mechanics</article-title>. <source>J Biomech</source>. <year>2008</year>;<volume>41</volume>: <fpage>165</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiomech.2007.07.001" xlink:type="simple">10.1016/j.jbiomech.2007.07.001</ext-link></comment> <object-id pub-id-type="pmid">17678933</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fregly</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Reinbolt</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Rooney</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Mitchell</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Chmielewski</surname> <given-names>TL</given-names></name>. <article-title>Design of patient-specific gait modifications for knee osteoarthritis rehabilitation</article-title>. <source>IEEE Trans Biomed Eng</source>. <year>2007</year>;<volume>54</volume>: <fpage>1687</fpage>–<lpage>1695</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TBME.2007.891934" xlink:type="simple">10.1109/TBME.2007.891934</ext-link></comment> <object-id pub-id-type="pmid">17867361</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walter</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>D’Lima</surname> <given-names>DD</given-names></name>, <name name-style="western"><surname>Colwell</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Fregly</surname> <given-names>BJ</given-names></name>. <article-title>Decreased knee adduction moment does not guarantee decreased medial contact force during gait</article-title>. <source>J Orthop Res</source>. <year>2010</year>;<volume>28</volume>: <fpage>1348</fpage>–<lpage>1354</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jor.21142" xlink:type="simple">10.1002/jor.21142</ext-link></comment> <object-id pub-id-type="pmid">20839320</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>D’Lima</surname> <given-names>DD</given-names></name>, <name name-style="western"><surname>Besier</surname> <given-names>TF</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Colwell</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Fregly</surname> <given-names>BJ</given-names></name>. <article-title>Are external knee load and EMG measures accurate indicators of internal knee contact forces during gait?</article-title> <source>J Orthop Res</source>. <year>2013</year>;<volume>31</volume>: <fpage>921</fpage>–<lpage>929</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jor.22304" xlink:type="simple">10.1002/jor.22304</ext-link></comment> <object-id pub-id-type="pmid">23280647</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mulroy</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Klassen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gronley</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Eberly</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Sullivan</surname> <given-names>KJ</given-names></name>. <article-title>Gait parameters associated with responsiveness to treadmill training with body-weight support after stroke: an exploratory study</article-title>. <source>Phys Ther</source>. <year>2009</year>;<volume>90</volume>: <fpage>209</fpage>–<lpage>223</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2522/ptj.20090141" xlink:type="simple">10.2522/ptj.20090141</ext-link></comment> <object-id pub-id-type="pmid">20022996</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lloyd</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Besier</surname> <given-names>TF</given-names></name>. <article-title>An EMG-driven musculoskeletal model to estimate muscle forces and knee joint moments in vivo</article-title>. <source>J Biomech</source>. <year>2003</year>;<volume>36</volume>: <fpage>765</fpage>–<lpage>776</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0021-9290(03)00010-1" xlink:type="simple">10.1016/S0021-9290(03)00010-1</ext-link></comment> <object-id pub-id-type="pmid">12742444</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bogey</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Perry</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gitter</surname> <given-names>AJ</given-names></name>. <article-title>An EMG-to-force processing approach for determining ankle muscle forces during normal human gait</article-title>. <source>IEEE Trans neural Syst Rehabil Eng a Publ IEEE Eng Med Biol Soc</source>. <year>2005</year>;<volume>13</volume>: <fpage>302</fpage>–<lpage>310</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TNSRE.2005.851768" xlink:type="simple">10.1109/TNSRE.2005.851768</ext-link></comment> <object-id pub-id-type="pmid">16200754</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sartori</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Reggiani</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Farina</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>DG</given-names></name>. <article-title>EMG-driven forward-dynamic estimation of muscle force and joint moment about multiple degrees of freedom in the human lower extremity</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>: <fpage>e52618</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0052618" xlink:type="simple">10.1371/journal.pone.0052618</ext-link></comment> <object-id pub-id-type="pmid">23300725</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kumar</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rudolph</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Manal</surname> <given-names>KT</given-names></name>. <article-title>EMG-driven modeling approach to muscle force and joint load estimations: Case study in knee osteoarthritis</article-title>. <source>J Orthop Res</source>. <year>2012</year>;<volume>30</volume>: <fpage>377</fpage>–<lpage>383</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jor.21544" xlink:type="simple">10.1002/jor.21544</ext-link></comment> <object-id pub-id-type="pmid">21901754</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buchanan</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Manal</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Besier</surname> <given-names>TF</given-names></name>. <article-title>Estimation of muscle forces and joint moments using a forward-inverse dynamics model</article-title>. <source>Med Sci Sports Exerc</source>. <year>2005</year>;<volume>37</volume>: <fpage>1911</fpage>–<lpage>1916</lpage>. <object-id pub-id-type="pmid">16286861</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Winby</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Besier</surname> <given-names>TF</given-names></name>, <name name-style="western"><surname>Kirk</surname> <given-names>TB</given-names></name>. <article-title>Muscle and external load contribution to knee joint contact loads during normal gait</article-title>. <source>J Biomech</source>. <year>2009</year>;<volume>42</volume>: <fpage>2294</fpage>–<lpage>2300</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiomech.2009.06.019" xlink:type="simple">10.1016/j.jbiomech.2009.06.019</ext-link></comment> <object-id pub-id-type="pmid">19647257</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gardinier</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Manal</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Buchanan</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Snyder-Mackler</surname> <given-names>L</given-names></name>. <article-title>Minimum detectable change for knee joint contact force estimates using an EMG-driven model</article-title>. <source>Gait Posture</source>. <year>2013</year>;<volume>38</volume>: <fpage>1051</fpage>–<lpage>1053</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.gaitpost.2013.03.014" xlink:type="simple">10.1016/j.gaitpost.2013.03.014</ext-link></comment> <object-id pub-id-type="pmid">23601782</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerus</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Rao</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Buchanan</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Berton</surname> <given-names>E</given-names></name>. <article-title>A clinically applicable model to estimate the opposing muscle groups contributions to isometric and dynamic tasks</article-title>. <source>Ann Biomed Eng</source>. <year>2010</year>;<volume>38</volume>: <fpage>2406</fpage>–<lpage>2417</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10439-010-9987-4" xlink:type="simple">10.1007/s10439-010-9987-4</ext-link></comment> <object-id pub-id-type="pmid">20217479</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Doorenbosch</surname> <given-names>CAM</given-names></name>, <name name-style="western"><surname>Harlaar</surname> <given-names>J</given-names></name>. <article-title>A clinically applicable EMG–force model to quantify active stabilization of the knee after a lesion of the anterior cruciate ligament</article-title>. <source>Clin Biomech</source>. <year>2003</year>;<volume>18</volume>: <fpage>142</fpage>–<lpage>149</lpage>.</mixed-citation></ref>
<ref id="pone.0179698.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kellis</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Baltzopoulos</surname> <given-names>V</given-names></name>. <article-title>The effects of antagonist moment on the resultant knee joint moment during isokinetic testing of the knee extensors</article-title>. <source>Eur J Appl Physiol Occup Physiol</source>. <year>1997</year>;<volume>76</volume>: <fpage>253</fpage>–<lpage>259</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s004210050244" xlink:type="simple">10.1007/s004210050244</ext-link></comment> <object-id pub-id-type="pmid">9286605</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Amarantini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>L</given-names></name>. <article-title>A method to combine numerical optimization and EMG data for the estimation of joint moments under dynamic conditions</article-title>. <source>J Biomech</source>. <year>2004</year>;<volume>37</volume>: <fpage>1393</fpage>–<lpage>1404</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiomech.2003.12.020" xlink:type="simple">10.1016/j.jbiomech.2003.12.020</ext-link></comment> <object-id pub-id-type="pmid">15275847</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Herzog</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Savelberg</surname> <given-names>HHCM</given-names></name>. <article-title>Dynamic muscle force predictions from EMG: an artificial neural network approach</article-title>. <source>J Electromyogr Kinesiol</source>. <year>1999</year>;<volume>9</volume>: <fpage>391</fpage>–<lpage>400</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S1050-6411(99)00014-0" xlink:type="simple">10.1016/S1050-6411(99)00014-0</ext-link></comment> <object-id pub-id-type="pmid">10597052</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Olney</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Winter</surname> <given-names>DA</given-names></name>. <article-title>Predictions of knee and ankle moments of force in walking from EMG and kinematic data</article-title>. <source>J Biomech</source>. <year>1985</year>;<volume>18</volume>: <fpage>9</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0021-9290(85)90041-7" xlink:type="simple">10.1016/0021-9290(85)90041-7</ext-link></comment> <object-id pub-id-type="pmid">3980492</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>He</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Loeb</surname> <given-names>GE</given-names></name>. <article-title>Feedback gains for correcting small perturbations to standing posture</article-title>. <source>IEEE Trans Automat Contr</source>. <year>1991</year>;<volume>36</volume>: <fpage>322</fpage>–<lpage>332</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/9.73565" xlink:type="simple">10.1109/9.73565</ext-link></comment></mixed-citation></ref>
<ref id="pone.0179698.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hill</surname> <given-names>AV</given-names></name>. <article-title>The heat of shortening and the dynamic constants of muscle</article-title>. <source>Proc R Soc B Biol Sci</source>. <year>1938</year>;<volume>126</volume>: <fpage>136</fpage>–<lpage>195</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.1938.0050" xlink:type="simple">10.1098/rspb.1938.0050</ext-link></comment></mixed-citation></ref>
<ref id="pone.0179698.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zajac</surname> <given-names>FE</given-names></name>. <article-title>Muscle and tendon: properties, models, scaling, and application to biomechanics and motor control</article-title>. <source>Crit Rev Biomed Eng</source>. <year>1989</year>;<volume>17</volume>: <fpage>359</fpage>–<lpage>411</lpage>. <object-id pub-id-type="pmid">2676342</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buchanan</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Manal</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Besier</surname> <given-names>TF</given-names></name>. <article-title>Neuromusculoskeletal modeling: estimation of muscle forces and joint moments and movements from measurements of neural command</article-title>. <source>J Appl Biomech</source>. <year>2004</year>;<volume>20</volume>: <fpage>367</fpage>–<lpage>395</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1123/jab.20.4.367" xlink:type="simple">10.1123/jab.20.4.367</ext-link></comment> <object-id pub-id-type="pmid">16467928</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tsai</surname> <given-names>L-C</given-names></name>, <name name-style="western"><surname>Colletti</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Powers</surname> <given-names>CM</given-names></name>. <article-title>Magnetic resonance imaging-measured muscle parameters improved knee moment prediction of an EMG-driven model</article-title>. <source>Med Sci Sports Exerc</source>. <year>2012</year>;<volume>44</volume>: <fpage>305</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1249/MSS.0b013e31822dfdb3" xlink:type="simple">10.1249/MSS.0b013e31822dfdb3</ext-link></comment> <object-id pub-id-type="pmid">21775905</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scheys</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Spaepen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Suetens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Jonkers</surname> <given-names>I</given-names></name>. <article-title>Calculated moment-arm and muscle-tendon lengths during gait differ substantially using MR based versus rescaled generic lower-limb musculoskeletal models</article-title>. <source>Gait Posture</source>. <year>2008</year>;<volume>28</volume>: <fpage>640</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.gaitpost.2008.04.010" xlink:type="simple">10.1016/j.gaitpost.2008.04.010</ext-link></comment> <object-id pub-id-type="pmid">18534855</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Correa</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Graham</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Pandy</surname> <given-names>MG</given-names></name>. <article-title>Accuracy of generic musculoskeletal models in predicting the functional roles of muscles in human gait</article-title>. <source>J Biomech</source>. <year>2011</year>;<volume>44</volume>: <fpage>2096</fpage>–<lpage>105</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiomech.2011.05.023" xlink:type="simple">10.1016/j.jbiomech.2011.05.023</ext-link></comment> <object-id pub-id-type="pmid">21703627</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scheys</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Van Campenhout</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Spaepen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Suetens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Jonkers</surname> <given-names>I</given-names></name>. <article-title>Personalized MR-based musculoskeletal models compared to rescaled generic models in the presence of increased femoral anteversion: effect on hip moment arm lengths</article-title>. <source>Gait Posture</source>. <year>2008</year>;<volume>28</volume>: <fpage>358</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.gaitpost.2008.05.002" xlink:type="simple">10.1016/j.gaitpost.2008.05.002</ext-link></comment> <object-id pub-id-type="pmid">18571416</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Menegaldo</surname> <given-names>LL</given-names></name>, <name name-style="western"><surname>De Toledo Fleury</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weber</surname> <given-names>HI</given-names></name>. <article-title>Moment arms and musculotendon lengths estimation for a three-dimensional lower-limb model</article-title>. <source>J Biomech</source>. <year>2004</year>;<volume>37</volume>: <fpage>1447</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiomech.2003.12.017" xlink:type="simple">10.1016/j.jbiomech.2003.12.017</ext-link></comment> <object-id pub-id-type="pmid">15275854</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sartori</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Reggiani</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Van Den Bogert</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>DG</given-names></name>. <article-title>Estimation of musculotendon kinematics in large musculoskeletal models using multidimensional B-splines</article-title>. <source>J Biomech</source>. <year>2012</year>;<volume>45</volume>: <fpage>595</fpage>–<lpage>601</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiomech.2011.10.040" xlink:type="simple">10.1016/j.jbiomech.2011.10.040</ext-link></comment> <object-id pub-id-type="pmid">22176708</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Delp</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>FC</given-names></name>, <name name-style="western"><surname>Arnold</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Loan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Habib</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>John</surname> <given-names>CT</given-names></name>, <etal>et al</etal>. <article-title>OpenSim: open-source software to create and analyze dynamic simulations of movement</article-title>. <source>IEEE Trans Biomed Eng</source>. <year>2007</year>;<volume>54</volume>: <fpage>1940</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TBME.2007.901024" xlink:type="simple">10.1109/TBME.2007.901024</ext-link></comment> <object-id pub-id-type="pmid">18018689</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arnold</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Ward</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Lieber</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Delp</surname> <given-names>SL</given-names></name>. <article-title>A model of the lower limb for analysis of human movement</article-title>. <source>Ann Biomed Eng</source>. <year>2010</year>;<volume>38</volume>: <fpage>269</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10439-009-9852-5" xlink:type="simple">10.1007/s10439-009-9852-5</ext-link></comment> <object-id pub-id-type="pmid">19957039</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reinbolt</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Schutte</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Fregly</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Koh</surname> <given-names>BI</given-names></name>, <name name-style="western"><surname>Haftka</surname> <given-names>RT</given-names></name>, <name name-style="western"><surname>George</surname> <given-names>AD</given-names></name>, <etal>et al</etal>. <article-title>Determination of patient-specific multi-joint kinematic models through two-level optimization</article-title>. <source>J Biomech</source>. <year>2005</year>;<volume>38</volume>: <fpage>621</fpage>–<lpage>626</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiomech.2004.03.031" xlink:type="simple">10.1016/j.jbiomech.2004.03.031</ext-link></comment> <object-id pub-id-type="pmid">15652563</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hug</surname> <given-names>F</given-names></name>. <article-title>Can muscle coordination be precisely studied by surface electromyography?</article-title> <source>J Electromyogr Kinesiol</source>. <year>2011</year>;<volume>21</volume>: <fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jelekin.2010.08.009" xlink:type="simple">10.1016/j.jelekin.2010.08.009</ext-link></comment> <object-id pub-id-type="pmid">20869882</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hermens</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Freriks</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Disselhorst-Klug</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rau</surname> <given-names>G</given-names></name>. <article-title>Development of recommendations for SEMG sensors and sensor placement procedures</article-title>. <source>J Electromyogr Kinesiol</source>. <year>2000</year>;<volume>10</volume>: <fpage>361</fpage>–<lpage>374</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S1050-6411(00)00027-4" xlink:type="simple">10.1016/S1050-6411(00)00027-4</ext-link></comment> <object-id pub-id-type="pmid">11018445</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref040"><label>40</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Perotto</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Delagi</surname> <given-names>EF</given-names></name>. <chapter-title>Anatomical guide for the electromyographer: the limbs and trunk</chapter-title>. <publisher-name>Charles C Thomas Publisher</publisher-name>; <year>2005</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/mus.880181023" xlink:type="simple">10.1002/mus.880181023</ext-link></comment></mixed-citation></ref>
<ref id="pone.0179698.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Delp</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Loan</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Hoy</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Zajac</surname> <given-names>FE</given-names></name>, <name name-style="western"><surname>Topp</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Rosen</surname> <given-names>JM</given-names></name>. <article-title>An interactive graphics-based model of the lower extremity to study orthopaedic surgical procedures</article-title>. <source>IEEE Trans Biomed Eng</source>. <year>1990</year>;<volume>37</volume>: <fpage>757</fpage>–<lpage>67</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/10.102791" xlink:type="simple">10.1109/10.102791</ext-link></comment> <object-id pub-id-type="pmid">2210784</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Manal</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Buchanan</surname> <given-names>TS</given-names></name>. <article-title>A one-parameter neural activation to muscle activation model: estimating isometric joint moments from electromyograms</article-title>. <source>J Biomech</source>. <year>2003</year>;<volume>36</volume>: <fpage>1197</fpage>–<lpage>1202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0021-9290(03)00152-0" xlink:type="simple">10.1016/S0021-9290(03)00152-0</ext-link></comment> <object-id pub-id-type="pmid">12831746</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>De Groote</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Demeulenaere</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Swevers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>De Schutter</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jonkers</surname> <given-names>I</given-names></name>. <article-title>A physiology-based inverse dynamic analysis of human gait using sequential convex programming: a comparative study</article-title>. <source>Comput Methods Biomech Biomed Engin</source>. <year>2012</year>;<volume>15</volume>: <fpage>1093</fpage>–<lpage>102</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/10255842.2011.571679" xlink:type="simple">10.1080/10255842.2011.571679</ext-link></comment> <object-id pub-id-type="pmid">21878002</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Millard</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Uchida</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Seth</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Delp</surname> <given-names>SL</given-names></name>. <article-title>Flexing computational muscle: modeling and simulation of musculotendon dynamics</article-title>. <source>J Biomech Eng</source>. <year>2013</year>;<volume>135</volume>: <fpage>21005</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1115/1.4023390" xlink:type="simple">10.1115/1.4023390</ext-link></comment> <object-id pub-id-type="pmid">23445050</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thelen</surname> <given-names>DG</given-names></name>. <article-title>Adjustment of muscle mechanics model parameters to simulate dynamic contractions in older adults</article-title>. <source>J Biomech Eng</source>. <year>2003</year>;<volume>125</volume>: <fpage>70</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1115/1.1531112" xlink:type="simple">10.1115/1.1531112</ext-link></comment> <object-id pub-id-type="pmid">12661198</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>An</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Harrigan</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Chao</surname> <given-names>EY</given-names></name>. <article-title>Determination of muscle orientations and moment arms</article-title>. <source>J Biomech Eng</source>. <year>1984</year>;<volume>106</volume>: <fpage>280</fpage>–<lpage>282</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1115/1.3138494" xlink:type="simple">10.1115/1.3138494</ext-link></comment> <object-id pub-id-type="pmid">6492774</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walker</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Rovick</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Robertson</surname> <given-names>DD</given-names></name>. <article-title>The effects of knee brace hinge design and placement on joint mechanics</article-title>. <source>J Biomech</source>. <year>1988</year>;<volume>21</volume>: <fpage>965</fpage>–<lpage>974</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0021-9290(88)90135-2" xlink:type="simple">10.1016/0021-9290(88)90135-2</ext-link></comment> <object-id pub-id-type="pmid">3253283</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reinbolt</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Haftka</surname> <given-names>RT</given-names></name>, <name name-style="western"><surname>Chmielewski</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Fregly</surname> <given-names>BJ</given-names></name>. <article-title>A computational framework to predict post-treatment outcome for gait-related disorders</article-title>. <source>Med Eng Phys</source>. <year>2008</year>;<volume>30</volume>: <fpage>434</fpage>–<lpage>443</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.medengphy.2007.05.005" xlink:type="simple">10.1016/j.medengphy.2007.05.005</ext-link></comment> <object-id pub-id-type="pmid">17616425</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref049"><label>49</label><mixed-citation publication-type="other" xlink:type="simple">Sherman MA, Seth A, Delp SL. What is a moment arm? Calculating muscle effectiveness in biomechanical models using generalized coordinates. Volume 7B: 9th International Conference on Multibody Systems, Nonlinear Dynamics, and Control. Portland, Oregon: ASME; 2013. p. V07BT10A052. 10.1115/DETC2013-13633</mixed-citation></ref>
<ref id="pone.0179698.ref050"><label>50</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Gill</surname></name>, <name name-style="western"><surname>Murray</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>M</given-names></name>. <chapter-title>Practical optimization</chapter-title>. <publisher-name>Academic press</publisher-name>; <year>1981</year>.</mixed-citation></ref>
<ref id="pone.0179698.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Silder</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Whittington</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Heiderscheit</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Thelen</surname> <given-names>DG</given-names></name>. <article-title>Identification of passive elastic joint moment-angle relationships in the lower extremity</article-title>. <source>J Biomech</source>. <year>2007</year>;<volume>40</volume>: <fpage>2628</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiomech.2006.12.017" xlink:type="simple">10.1016/j.jbiomech.2006.12.017</ext-link></comment> <object-id pub-id-type="pmid">17359981</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Handsfield</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Meyer</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Hart</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Abel</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Blemker</surname> <given-names>SS</given-names></name>. <article-title>Relationships of 35 lower limb muscles to height and body mass quantified using MRI</article-title>. <source>J Biomech</source>. <year>2014</year>;<volume>47</volume>: <fpage>631</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiomech.2013.12.002" xlink:type="simple">10.1016/j.jbiomech.2013.12.002</ext-link></comment> <object-id pub-id-type="pmid">24368144</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Racinais</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Maf</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Girard</surname> <given-names>O</given-names></name>. <article-title>M-wave, h- and v-reflex recruitment curves during maximal voluntary contraction</article-title>. <source>J Clin Neurophysiol</source>. <year>2013</year>;<volume>30</volume>: <fpage>415</fpage>–<lpage>421</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1097/WNP.0b013e31829ddcf1" xlink:type="simple">10.1097/WNP.0b013e31829ddcf1</ext-link></comment> <object-id pub-id-type="pmid">23912583</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simonsen</surname> <given-names>EB</given-names></name>, <name name-style="western"><surname>Alkjær</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Raffalt</surname> <given-names>PC</given-names></name>. <article-title>Reflex response and control of the human soleus and gastrocnemius muscles during walking and running at increasing velocity</article-title>. <source>Exp brain Res</source>. <year>2012</year>;<volume>219</volume>: <fpage>163</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00221-012-3075-y" xlink:type="simple">10.1007/s00221-012-3075-y</ext-link></comment> <object-id pub-id-type="pmid">22466409</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cronin</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Kumpulainen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Joutjärvi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Finni</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Piitulainen</surname> <given-names>H</given-names></name>. <article-title>Spatial variability of muscle activity during human walking: The effects of different EMG normalization approaches</article-title>. <source>Neuroscience</source>. <year>2015</year>;<volume>300</volume>: <fpage>19</fpage>–<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroscience.2015.05.003" xlink:type="simple">10.1016/j.neuroscience.2015.05.003</ext-link></comment> <object-id pub-id-type="pmid">25967267</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reinbolt</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Haftka</surname> <given-names>RT</given-names></name>, <name name-style="western"><surname>Chmielewski</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Fregly</surname> <given-names>BJ</given-names></name>. <article-title>Are patient-specific joint and inertial parameters necessary for accurate inverse dynamics analyses of gait?</article-title> <source>IEEE Trans Biomed Eng</source>. <year>2007</year>;<volume>54</volume>: <fpage>782</fpage>–<lpage>93</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TBME.2006.889187" xlink:type="simple">10.1109/TBME.2006.889187</ext-link></comment> <object-id pub-id-type="pmid">17518274</object-id></mixed-citation></ref>
<ref id="pone.0179698.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Eskinazi</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Rao</surname> <given-names>A V</given-names></name>, <name name-style="western"><surname>Patten</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Fregly</surname> <given-names>BJ</given-names></name>. <article-title>Muscle synergies facilitate computational prediction of subject-specific walking motions</article-title>. <source>Front Bioeng Biotechnol</source>. <year>2016</year>;<volume>4</volume>: <fpage>77</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fbioe.2016.00077" xlink:type="simple">10.3389/fbioe.2016.00077</ext-link></comment> <object-id pub-id-type="pmid">27790612</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>