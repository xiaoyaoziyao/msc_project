<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-13-29237</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0091677</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Coding mechanisms</subject></subj-group></subj-group><subj-group><subject>Motor systems</subject><subject>Sensory systems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer science</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Engineering</subject><subj-group><subject>Bioengineering</subject><subj-group><subject>Biomedical engineering</subject></subj-group></subj-group><subj-group><subject>Human factors engineering</subject><subj-group><subject>Man computer interface</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>A Bidirectional Brain-Machine Interface Algorithm That Approximates Arbitrary Force-Fields</article-title>
<alt-title alt-title-type="running-head">BMIs That Approximate Force Fields</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Vato</surname><given-names>Alessandro</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Szymanski</surname><given-names>Francois D.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Semprini</surname><given-names>Marianna</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>Ferdinando A.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="fn" rid="fn1"><sup>¶</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Panzeri</surname><given-names>Stefano</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref><xref ref-type="aff" rid="aff6"><sup>6</sup></xref><xref ref-type="fn" rid="fn1"><sup>¶</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Robotics, Brain and Cognitive Sciences, Istituto Italiano di Tecnologia, Genova, Italy</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Physiology, Northwestern University, Chicago, Illinois, United States of America</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Biomedical Engineering, Northwestern University, Evanston, Illinois, United States of America</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Sensory Motor Performance Program, Rehabilitation Institute of Chicago, Chicago, Illinois, United States of America</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>Center for Neuroscience and Cognitive Systems @UniTn, Istituto Italiano di Tecnologia, Rovereto, Italy</addr-line></aff>
<aff id="aff6"><label>6</label><addr-line>Institute of Neuroscience and Psychology, University of Glasgow, Glasgow, United Kingdom</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Bensmaia</surname><given-names>Sliman J.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Chicago, United States of America</addr-line></aff>
<author-notes>
<fn id="fn1" fn-type="other"><p>¶ These authors also contributed equally to this work.</p></fn>
    <corresp id="cor1">* E-mail: <email xlink:type="simple">alessandro.vato@iit.it</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: AV FDS MS SP FMI. Performed the experiments: AV FDS MS SP FMI. Analyzed the data: AV FDS MS SP FMI. Wrote the paper: AV FDS MS SP FMI.</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>13</day><month>3</month><year>2014</year></pub-date>
<volume>9</volume>
<issue>3</issue>
<elocation-id>e91677</elocation-id>
<history>
<date date-type="received"><day>16</day><month>7</month><year>2013</year></date>
<date date-type="accepted"><day>14</day><month>2</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Vato et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>We examine bidirectional brain-machine interfaces that control external devices in a closed loop by decoding motor cortical activity to command the device and by encoding the state of the device by delivering electrical stimuli to sensory areas. Although it is possible to design this artificial sensory-motor interaction while maintaining two independent channels of communication, here we propose a rule that closes the loop between flows of sensory and motor information in a way that approximates a desired dynamical policy expressed as a field of forces acting upon the controlled external device. We previously developed a first implementation of this approach based on linear decoding of neural activity recorded from the motor cortex into a set of forces (a force field) applied to a point mass, and on encoding of position of the point mass into patterns of electrical stimuli delivered to somatosensory areas. However, this previous algorithm had the limitation that it only worked in situations when the position-to-force map to be implemented is invertible. Here we overcome this limitation by developing a new non-linear form of the bidirectional interface that can approximate a virtually unlimited family of continuous fields. The new algorithm bases both the encoding of position information and the decoding of motor cortical activity on an explicit map between spike trains and the state space of the device computed with Multi-Dimensional-Scaling. We present a detailed computational analysis of the performance of the interface and a validation of its robustness by using synthetic neural responses in a simulated sensory-motor loop.</p>
</abstract>
<funding-group><funding-statement>This work was supported by the BMI project of the Robotics, Brain and Cognitive Sciences Department, Italian Institute of Technology Italy and NICHHD grant 1R01HD072080-01 to FAM-I. The authors acknowledge the financial support of the SI-CODE project of the Future and Emerging Technologies (FET) programme within the Seventh Framework Programme for Research of the European Commission, under FET-Open grant number: FP7-284553. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="20"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>While the idea of connecting brains to machines has surfaced time and again <xref ref-type="bibr" rid="pone.0091677-vonNeumann1">[1]</xref>, <xref ref-type="bibr" rid="pone.0091677-Vidal1">[2]</xref>, the concept of a brain-machine interface (BMI) has developed as a mainstream research topic only more recently, building on progress in understanding how movement plans are encoded in motor cortical signals. Two main approaches have emerged. One approach is based on decoding motor cortical signals as a proxy for the intended state of motion <xref ref-type="bibr" rid="pone.0091677-Chapin1">[3]</xref>, <xref ref-type="bibr" rid="pone.0091677-Wessberg1">[4]</xref> or for muscle activations <xref ref-type="bibr" rid="pone.0091677-Kim1">[5]</xref>. The other view <xref ref-type="bibr" rid="pone.0091677-Hauschild1">[6]</xref> is based on decoding high-level motor goals from neural activity in areas such as the posterior parietal cortex, and to communicate this goal to an external artificial controller in charge of its execution. In both approaches the focus of the BMI is on decoding neural signals. It is only more recently that attention has been devoted to the dual problem of encoding in the brain information about the state of motion of external devices by using electrical stimulation <xref ref-type="bibr" rid="pone.0091677-Chao1">[7]</xref>–<xref ref-type="bibr" rid="pone.0091677-ODoherty2">[9]</xref>.</p>
<p>This progress naturally calls for closing the loop between encoding and decoding, by combining in the same system a decoding interface that maps neural activities into commands to the external device and an encoding interface that maps the state of the device into neural signals using electrical stimulation <xref ref-type="bibr" rid="pone.0091677-MussaIvaldi1">[10]</xref>. Such closed-loop systems are potentially important both for clinical applications and as neuroscientific research tools for investigating neural plasticity by coupling a pattern of stimuli with the evoked responses through an external system with known dynamical properties.</p>
<p>Here, we present the findings of a computational investigation of a novel brain-machine interface architecture that proposes an explicit set of rules to coordinate the decoding and the encoding components of the interface. This set of rules implements control policies based on the closed-loop interaction between the motor commands expressed by neural activity and their sensory consequences, which are fed to the brain as encoded information about changes of state of the controlled device. These control policies are inspired by the physiological interaction between descending cortical signals and the activity of central pattern generators, where the descending commands modulate the timing and shape of the trajectories that emerge from the interaction between the limbs, the neural control system (including its voluntary components) and the environment <xref ref-type="bibr" rid="pone.0091677-Hill1">[11]</xref>–<xref ref-type="bibr" rid="pone.0091677-Tresch1">[17]</xref>.</p>
<p>A feedback control policy is a function that seeks to attain a goal while reacting to unexpected circumstances. Sutton and Barto <xref ref-type="bibr" rid="pone.0091677-Sutton1">[18]</xref> define such a policy in more formal terms as “a mapping from perceived states of the environment to actions to be taken when in those states” given a predefined goal. Translated into mechanical terms and in the framework of movement control, a motor-control policy can be represented as a force field: a force (the action) that, for a given goal, the control system generates as a function of the observed state of motion of the controlled object. Force fields have the inherent property that any field shape can be produced or approximated by summation of other force fields. This is an important prerequisite for modularity, as it provides a simple mechanism to build a repertoire by combining a set of primitive elements <xref ref-type="bibr" rid="pone.0091677-Bienenstock1">[19]</xref>, <xref ref-type="bibr" rid="pone.0091677-MussaIvaldi2">[20]</xref> <xref ref-type="bibr" rid="pone.0091677-Bienenstock1">[19]</xref>, <xref ref-type="bibr" rid="pone.0091677-MussaIvaldi2">[20]</xref>. A key requirement to that effect is, for the primitive policies, to be mathematically equivalent to basis functions with structure rich enough to approximate other policies of arbitrary form. Another important aspect of force fields is that the concept of “behavior” is not reduced to a particular trajectory of the controlled element, but includes a whole family of trajectories. The interaction between the field and the controlled object generates a family of trajectories, one for each point of the state space. The control system may select a particular trajectory by setting an initial state and letting the dynamical interactions between controlled system and environment shape the temporal evolution of movement.</p>
<p>In recent work, we took inspiration from this view of biological motor control to first conceptually propose <xref ref-type="bibr" rid="pone.0091677-MussaIvaldi1">[10]</xref> and then implement in anesthetized rats <xref ref-type="bibr" rid="pone.0091677-Vato1">[21]</xref> a bidirectional BMI capable of generating a force field with a given desired structure acting upon the controlled mechanical system. In the first implementation of this approach, we developed a method based on linear decoding of recorded motor cortical activities into force vectors applied to a point mass and encoding the position of the point mass into patterns of electrical stimuli delivered to the somatosensory cortex. A major limitation of this previous algorithm was that it could only approximate invertible force fields - that is invertible position-to-force maps.</p>
<p>Here we overcome this limitation by introducing a new form of bidirectional interface, which we call the <italic>non-linear dynamic brain-machine interface (ndBMI</italic>) that approximates a virtually unlimited family of fields. The interface coordinates the information encoded by the electrical stimulation and the output decoded from the recorded signals so as to establish an initial force field structure as a map between the position of the device and the force applied to it. We should stress that this approach does not need to be limited to represent a static field. Instead, the force may be expressed as a function of velocity, acceleration or any combination of state variables that are encoded for example by motor cortical activity <xref ref-type="bibr" rid="pone.0091677-Kim2">[22]</xref>. Here we focus on static fields for computational simplicity. The force field structure, being encoded in the stimulus-response relation of a neuronal population, can then be modulated by brain activities, including volitional commands impinging upon the recorded neurons from other brain regions. Indeed the desired behavior of this bidirectional interface is similar to the one exhibited by spinal and supraspinal reflex mechanisms that, at the same time, permit to the brain to modulate the force field by generating new families of trajectories.</p>
<p>In the following, we first describe in detail the algorithms that we developed for calibrating the encoding and decoding components of the interface to approximate non-linear desired force fields and for letting the ndBMI evolve to control a simple simulated mechanical system. We then test and validate the ndBMI using neural activity of populations of neurons in a simulated sensory-motor cortical system. We analyze how this interface approximates a desired dynamical behavior associated with non-linear field acting upon a simple mechanical system. We consider two force fields: a radially convergent force field used to represent reaching tasks and a dipole force field used for representing obstacle avoidance in manipulation and navigation tasks. We evaluate the performance of the ndBMI in generating trajectories by simulating different kinds of configurations of the stimulating and recording electrodes. Finally, we explore the computational issue of controlling the operation of this interface by volitional commands.</p>
</sec><sec id="s2" sec-type="materials|methods">
<title>Materials and Methods</title>
<p>We begin by summarizing the structure of our ndBMI, which is illustrated in <xref ref-type="fig" rid="pone-0091677-g001">Figure 1</xref>. The ndBMI controls an external device (in our case a simple simulated mechanical system) and is constructed by closing the loop between two components: the <italic>sensory interface</italic> and the <italic>motor interface</italic>. The sensory interface maps some or all of the state parameters of the external device (in our case only the position of the device) into one of a set of possible patterns of electrical stimulation delivered to a cortical sensory area. The result of this operation is that the activity evoked in this sensory area is made to encode the state parameters of the device. The motor interface takes neural recordings from a motor cortical region and translates them into a force applied to the object. This force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e001" xlink:type="simple"/></inline-formula> is applied to the device which then evolves to the next state. The brain is informed about the value of the next state by the sensory interface and generates a new appropriate motor cortical response, and so on in a closed loop.</p>
<fig id="pone-0091677-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g001</object-id><label>Figure 1</label><caption>
<title>Schematic of the closed-loop non-linear dynamic (ndBMI) Brain-machine Interface.</title>
<p>The neural signal recorded from a motor region of the brain is decoded by the motor interface into a point in the position-space of the controlled device. The force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e002" xlink:type="simple"/></inline-formula> to be applied to the external device is computed by first mapping the recorded motor cortical activity into a virtual point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e003" xlink:type="simple"/></inline-formula> in the position space of the device. This virtual point corresponds to the most likely position of the device given the observation of the activity of the motor cortical region. Then, the force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e004" xlink:type="simple"/></inline-formula> is derived by calculating the desired force field in this virtual point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e005" xlink:type="simple"/></inline-formula>. Once this force is applied, the device evolves to the next position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e006" xlink:type="simple"/></inline-formula>. The sensory interface provides information to the brain about the new position of the device by delivering stimulation to a sensory area. Once it receives this information, the brain generates a consequent motor cortical response which is again translated into a force, in a closed loop.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g001" position="float" xlink:type="simple"/></fig>
<p>The algorithms calibrate the interface so that, in absence of any voluntary intention to change the behavior, the interface approximates a given desired force field (i.e. a function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e007" xlink:type="simple"/></inline-formula> expressing the force that we would apply to the device when it is in state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e008" xlink:type="simple"/></inline-formula>). In the force fields implemented here, this force was designed to drive the device toward an equilibrium state. The fact that the force to be applied is decoded from the actual neural activity (and not only directly from the desired force field) leaves open the possibility to modulate at will the actions implemented by the ndBMI (for example to deliberately shift the position of the equilibrium point of the device) when the brain expresses additional voluntary components of motor cortical activity.</p>
<p>The algorithms base both the conversion of information about the state of the device into brain activity elicited by stimulation and the decoding of motor cortical activity into a set of forces needed to accomplish the task on an explicit map between spike trains and the state space of the device computed with Multi-Dimensional-Scaling (MDS).</p>
<p>The neural data that are used to construct and run the ndBMI consist of stimulus-response pairs of a given electrical stimulation pattern applied in sensory cortex and the associated neural population response recorded in motor cortex. They are divided into two groups: calibration data, which serve to set the parameters of the sensory and motor interfaces so that they approximate the desired force field, and test data, which serve to operate the interface and test its ability to control the considered external device.</p>
<p>In the following we report a detailed description of the algorithms for calibrating and running the interface, and of the external mechanical system controlled by the interface. We developed and tested this interface by using synthetic neural responses generated by simple descriptive model of cortical responses of a cortical motor region (here supposed to be the part of the primary motor cortex (<italic>M1</italic>) that controls whisking in rats) following a simulated electrical stimulation applied to the whisker region of primary somatosensory cortex (<italic>S1</italic>). These simulations, which we also describe in the following sections, were chosen to mimic this particular sensory-motor cortical system because this is the one we used in previous experimental work on linear bidirectional interfaces <xref ref-type="bibr" rid="pone.0091677-Vato1">[21]</xref>.</p>
<sec id="s2a">
<title>Summary of the Algorithmic Function of the Interface</title>
<p>The mechanical system that the interface controls is simply a point mass moving on a plane towards a target equilibrium region (see section <italic>Simulation of the mechanical system used as external device</italic>). This target region is defined as a zone around the equilibrium point of the approximated force fields, whose dimension is a parameter of the simulation. We thus start each run of the operation of the interface by setting the system at an initial position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e009" xlink:type="simple"/></inline-formula> with zero velocity. From this initial position, the interface simulation algorithm proceeds as follows.</p>
<p>First, the sensory interface computes the electrical stimulus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e010" xlink:type="simple"/></inline-formula> corresponding to the sensory region that contains the current position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e011" xlink:type="simple"/></inline-formula> of the external device using the following equation:<disp-formula id="pone.0091677.e012"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e012" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e013" xlink:type="simple"/></inline-formula> is the center of the sensory region <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e014" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e015" xlink:type="simple"/></inline-formula> is the number of the stimulation patterns (therefore is also the number of sensory regions), and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e016" xlink:type="simple"/></inline-formula> is the Euclidean distance norm on the device’s position plane.</p>
<p>The interface applies the electrical stimulus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e017" xlink:type="simple"/></inline-formula> to the sensory cortical area and records a response <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e018" xlink:type="simple"/></inline-formula> from the motor cortical area. The motor interface derives, from the motor cortical responses <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e019" xlink:type="simple"/></inline-formula>, the force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e020" xlink:type="simple"/></inline-formula> using the algorithm described in section <italic>Calibration of the motor interface</italic>.</p>
<p>The interface applies the force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e021" xlink:type="simple"/></inline-formula> to the mechanical system and lets it evolve for a fixed amount of time until it reaches the next position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e022" xlink:type="simple"/></inline-formula> as described in section <italic>Simulation of the mechanical system used as external device</italic>. Between successive stimuli, the force (i.e. the output of the interface) is assumed to remain constant.</p>
<p>The procedure is repeated until the point mass reaches the target region.</p>
<p>The task is considered to be completed when the point mass reaches the target region (this situation is termed a “convergent” trajectory) or when the number of iterations of the process reaches a maximum value of 50 iterations (we termed this situation a “non-convergent” trajectory). After the task is completed, we start the process again by starting the evolution of the system at rest (0 velocity) from another random initial position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e023" xlink:type="simple"/></inline-formula>.</p>
<p>Operating the ndBMI as described above requires the calibration of the parameters of the sensory and motor interfaces. This is described next.</p>
</sec><sec id="s2b">
<title>Calibration of the Sensory Interface</title>
<p>To calibrate the sensory interface we constructed a map from the position of the external device to a corresponding electrical stimulation. The final product is a partition of the position space of the external device into a set of “sensory regions”, each being associated to a particular electrical stimulus. The calibration of the sensory interface was implemented as follows.</p>
<p>Assume that we applied a set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e024" xlink:type="simple"/></inline-formula> electrical stimuli <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e025" xlink:type="simple"/></inline-formula>. We recorded <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e026" xlink:type="simple"/></inline-formula> “calibration responses” of each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e027" xlink:type="simple"/></inline-formula> electrical stimuli (total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e028" xlink:type="simple"/></inline-formula> responses):<disp-formula id="pone.0091677.e029"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e029" xlink:type="simple"/><label>(2)</label></disp-formula></p>
<p>Each response <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e030" xlink:type="simple"/></inline-formula> consists of a sequence of spike times for each of the recorded neurons in a simulated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e031" xlink:type="simple"/></inline-formula> post-stimulation window (we chose this window length because it matched that used in our previous real neurophysiological implementations of a linear bidirectional BMI <xref ref-type="bibr" rid="pone.0091677-Vato1">[21]</xref>. However, using such a long response integration window is by no means necessary. We verified on the current algorithm with simulated data (results not shown) and on the previously published linear algorithm by running the interface offline from real cortical spike trains that we recorded <xref ref-type="bibr" rid="pone.0091677-Vato1">[21]</xref>, it was possible to reach near-maximal performance with response windows as short as 50 ms). We then calculated the matrix of spike train distances between all pairs of neural responses across all stimuli,<disp-formula id="pone.0091677.e032"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e032" xlink:type="simple"/><label>(3)</label></disp-formula></p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e033" xlink:type="simple"/></inline-formula> is a symmetric matrix with zero diagonal and indexes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e034" xlink:type="simple"/></inline-formula> that run over all possible stimulus-response pairs. To compute distances between multiple-neuron spike trains, we used the metric described by Houghton and Sen <xref ref-type="bibr" rid="pone.0091677-Houghton1">[23]</xref>, to which we refer for full details. In brief, this metric first convolves the spike trains in the time domain using exponential kernels (whose decay time constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e035" xlink:type="simple"/></inline-formula> represents the temporal sensitivity of the metric and is a free parameter of the analysis) to obtain the response time vector of each individual neuron. It then computes the multi-neuron spike train distance using a vector norm computed after rotating these single neuron vectors by an angular free parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e036" xlink:type="simple"/></inline-formula> that determines the sensitivity of the metric to neuron-to-neuron differences <xref ref-type="bibr" rid="pone.0091677-Houghton1">[23]</xref>. The free parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e037" xlink:type="simple"/></inline-formula> can vary between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e038" xlink:type="simple"/></inline-formula> (corresponding to pooling all spike train without taking into account the identity of which neuron fired which spike) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e039" xlink:type="simple"/></inline-formula> (corresponding to considering a labeled-line code <xref ref-type="bibr" rid="pone.0091677-Reich1">[24]</xref>, <xref ref-type="bibr" rid="pone.0091677-Panzeri1">[25]</xref> in which the identity of which neuron fired each spike is fully taken into account). In the analysis presented here, we set the two free parameters of the metric to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e040" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e041" xlink:type="simple"/></inline-formula> because we found that these parameters empirically maximized the performance of the interfaces.</p>
<p>We used MDS to construct a system of points in the position domain of the mechanical system (in this case it was a 2-dimensional domain) that preserves the spike train distances:<disp-formula id="pone.0091677.e042"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e042" xlink:type="simple"/><label>(4)</label></disp-formula></p>
<p>Where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e043" xlink:type="simple"/></inline-formula> runs over the indexes of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e044" xlink:type="simple"/></inline-formula> calibration responses. To perform the non-metric multidimensional scaling operation, we used the “<italic>mdscale</italic>” function in MATLAB by choosing the metric scaling “<italic>strain</italic>” as the goodness-of-fit criterion to minimize, which is a criterion equivalent to that used in classical MDS.</p>
<p>We multiplied these vectors of positions by a factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e045" xlink:type="simple"/></inline-formula> to make them fit within a box of the size of the position space:<disp-formula id="pone.0091677.e046"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e046" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p>Finally we computed the averaged positions across calibration trials to each given stimulus pattern to obtain the so called “calibration site”:<disp-formula id="pone.0091677.e047"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e047" xlink:type="simple"/><label>(6)</label></disp-formula></p>
<p>These <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e048" xlink:type="simple"/></inline-formula> calibration sites were then used to partition the position space into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e049" xlink:type="simple"/></inline-formula> sensory regions, by associating each point of the position space to the nearest calibration site <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e050" xlink:type="simple"/></inline-formula> according to <xref ref-type="disp-formula" rid="pone.0091677.e012">Equation 1</xref>.</p>
</sec><sec id="s2c">
<title>Calibration of the Motor Interface</title>
<p>The purpose of the motor interface is to decode each neural response of the test data set into a force vector. We did this in two steps: first, the motor neural response <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e051" xlink:type="simple"/></inline-formula> recorded in the considered test trial (the one to be converted into a force) was mapped (by a function that we called <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e052" xlink:type="simple"/></inline-formula> and whose computation is explained below) to a virtual point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e053" xlink:type="simple"/></inline-formula> in the position space of the device. This virtual point corresponds to the most likely position of the device given the observation of the activity of the motor cortical region. Then, the force to be applied to the device was derived by calculating the desired force field in this virtual point.</p>
<p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e054" xlink:type="simple"/></inline-formula> is the desired force field to be approximated by the interface, then the motor interface derives the output force to be applied to the external device as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e055" xlink:type="simple"/></inline-formula>. We call the point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e056" xlink:type="simple"/></inline-formula> “virtual” because it is not necessarily reached by the point mass (it is, in principle, different from the actual position of the controlled device). This virtual point is only used as an intermediate step to evaluate the force intended by motor cortical activity. Any voluntary perturbation or addition of neural activity, intended for example to shift the equilibrium target point of the controlled external device, will act by shifting the position of this virtual point so as to create the perturbation in force necessary to modulate the behavior according to the volitional command (see section <italic>Addition of volitional control to shift at will the position of the target region</italic>).</p>
<p>We implemented two slightly different algorithms that translate the current test response <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e057" xlink:type="simple"/></inline-formula> into a force. Both algorithms begin with measuring (using the spike train metric described above) the distances between the currently recorded spike train <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e058" xlink:type="simple"/></inline-formula> and all the responses in the calibration trials. These distances are stored in a matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e059" xlink:type="simple"/></inline-formula>:<disp-formula id="pone.0091677.e060"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e060" xlink:type="simple"/><label>(7)</label></disp-formula></p>
<p>The algorithms are detailed as follows:</p>
<sec id="s2c1">
<title><italic>Single-point decoding algorithm</italic></title>
<p>For each stimulus we computed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e061" xlink:type="simple"/></inline-formula>, that is the average (across calibration trials to a given stimulus) of the distances between the current spike train <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e062" xlink:type="simple"/></inline-formula> and the spike trains obtained during calibration (the complete separation between the set of calibration and test trials has the purpose of preventing over-fitting). Following <xref ref-type="bibr" rid="pone.0091677-Houghton1">[23]</xref>, <xref ref-type="bibr" rid="pone.0091677-Victor1">[26]</xref> the averaging over calibration trials to a given stimulus was performed with a bias exponent of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e063" xlink:type="simple"/></inline-formula> that under-weights outliers:<disp-formula id="pone.0091677.e064"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e064" xlink:type="simple"/><label>(8)</label></disp-formula></p>
<p>We decoded the stimulus that evoked the recorded spike train <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e065" xlink:type="simple"/></inline-formula> as the stimulus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e066" xlink:type="simple"/></inline-formula> whose calibration responses gave the smallest average distance with the current spike train <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e067" xlink:type="simple"/></inline-formula>:<disp-formula id="pone.0091677.e068"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e068" xlink:type="simple"/><label>(9)</label></disp-formula></p>
<p>The force vector applied to the external device (i.e. the dynamical system) was computed as the force value given by the considered force field at the location of the calibration site corresponding to the decoded stimulus:<disp-formula id="pone.0091677.e069"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e069" xlink:type="simple"/><label>(10)</label></disp-formula></p>
</sec><sec id="s2c2">
<title><italic>Multiple-points decoding algorithm</italic></title>
<p>We first identified the smallest spike-train distance from the current spike train <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e070" xlink:type="simple"/></inline-formula>.<disp-formula id="pone.0091677.e071"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e071" xlink:type="simple"/><label>(11)</label></disp-formula></p>
<p>We then computed the force vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e072" xlink:type="simple"/></inline-formula> using the force field equation at the location <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e073" xlink:type="simple"/></inline-formula> where the closest calibration trial is projected on the domain of the external device by the MDS projection:<disp-formula id="pone.0091677.e074"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e074" xlink:type="simple"/><label>(12)</label></disp-formula></p>
<p>The advantage of the Single-point algorithm is its robustness to outliers. The appeal of the Multiple-points decoding algorithm is that its repertoire of forces is not limited only to the values of the desired field at the center of each sensory region, but instead it takes full advantage of the variability associated with individual calibration activities to offer a larger spread of output forces and a potentially richer interface dynamics. However, as we shall see in <italic>Results</italic>, both algorithms gave nearly identical performance on the simulated data used here.</p>
</sec></sec><sec id="s2d">
<title>Simulation of the Mechanical System used as External Device</title>
<p>The external device controlled by the ndBMI is a simple simulated mechanical device, i.e. a simulated point-mass moving within a viscous fluid. The point mass is subject to two forces: the force derived from the neural activity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e075" xlink:type="simple"/></inline-formula> and a drag force due to the viscosity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e076" xlink:type="simple"/></inline-formula>:<disp-formula id="pone.0091677.e077"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e077" xlink:type="simple"/><label>(13)</label></disp-formula></p>
<p>In the above equations, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e078" xlink:type="simple"/></inline-formula> indicates the position of the point mass on a plane and the values of mass <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e079" xlink:type="simple"/></inline-formula> and viscosity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e080" xlink:type="simple"/></inline-formula> were set to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e081" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e082" xlink:type="simple"/></inline-formula> , respectively. We simulated this dynamics equation for a period of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e083" xlink:type="simple"/></inline-formula> using standard numerical integration algorithms, see <xref ref-type="bibr" rid="pone.0091677-Vato1">[21]</xref> for details.</p>
</sec><sec id="s2e">
<title>The Force Field</title>
<p>The calibration procedure establishes a force field as a relation between the position of the device and the force applied to it in the absence of external volitional commands. Because of the stochastic character of the neural responses to the electrical stimuli, the field is an approximation of a desired position-to-force mapping.</p>
<p>The force field established by the calibration procedure is effectively a biomechanical “platform” upon which influences of the environment and of the volitional commands operate to shape the actual motion of the controlled device. In addition to the volitional and environmental influences, the motion of the device is also affected by neural noise. Therefore the state of motion of the device is effectively a random variable affected by a combination of deterministic and stochastic processes. The challenge for the volitional commands is to guide the device to the desired goals despite the influences of uncontrolled perturbing forces.</p>
<p>Here, we consider two different types of force field that are significant for the generation of motor behaviors: a Gaussian force field <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e084" xlink:type="simple"/></inline-formula> and a Dipole force field <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e085" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pone-0091677-g002">Figure 2</xref>).</p>
<fig id="pone-0091677-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g002</object-id><label>Figure 2</label><caption>
<title>The two ideal force fields to be approximated by the ndBMI.</title>
<p>The force fields map each point belonging to the position space into a force. In this study we used two different force fields representing the desired control policies: a Gaussian force field (A) and a Dipole force field (B). Both the force fields converge towards an equilibrium point that represents the goal in a reaching task. The figure shows the force fields represented by arrows of different lengths superimposed by the corresponding colored-code potential fields.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g002" position="float" xlink:type="simple"/></fig>
<p>In a Gaussian force field the forces converge toward a central equilibrium point implementing the concept of a single attractor and of the goal of reaching a fixed position.</p>
<p>This convergent field <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e086" xlink:type="simple"/></inline-formula> is the gradient of a Gaussian bivariate function <xref ref-type="bibr" rid="pone.0091677-MussaIvaldi3">[27]</xref>:<disp-formula id="pone.0091677.e087"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e087" xlink:type="simple"/><label>(14)</label></disp-formula>with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e088" xlink:type="simple"/></inline-formula></p>
<p>A Dipole force field <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e089" xlink:type="simple"/></inline-formula> is obtained as a linear summation of a Gaussian force field <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e090" xlink:type="simple"/></inline-formula> with a Divergent force field <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e091" xlink:type="simple"/></inline-formula>:<disp-formula id="pone.0091677.e092"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e092" xlink:type="simple"/><label>(15)</label></disp-formula></p>
<p>The divergent field <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e093" xlink:type="simple"/></inline-formula> is obtained by summing a repulsive and an attractive field, and has the expression:<disp-formula id="pone.0091677.e094"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e094" xlink:type="simple"/><label>(16)</label></disp-formula>with<disp-formula id="pone.0091677.e095"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e095" xlink:type="simple"/></disp-formula></p>
<p>Note that both fields are non-linear and non-invertible (i.e. each value of force is generated at multiple points in the domain). A Dipole force field was introduced in robotics to represent movement planning in the presence of obstacles <xref ref-type="bibr" rid="pone.0091677-Khatib1">[28]</xref>. The repulsive forces of the divergent field are centered on an object that must be avoided by the moving point mass while the attractive forces are centered on the target to reach.</p>
</sec><sec id="s2f">
<title>Simulated Neural Data</title>
<p>Our ndBMI is designed to encode information about the state of the device by electrical stimulation of a sensory area and to use, in a closed loop, recordings of neural activity in motor cortex to drive the external device. Testing our ndBMI algorithm on synthetic data thus required simulating neural responses in a motor area immediately following electrical stimulation in a sensory area. We therefore simulated spiking responses of neural populations from the primary whiskers motor cortex <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e096" xlink:type="simple"/></inline-formula> of rats in response to electrical microstimulation of the whisker “barrel” field of primary somatosensory cortex. This model is based on the empirical observation that a focal activation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e097" xlink:type="simple"/></inline-formula> causes a relatively localized activation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e098" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pone.0091677-Vato1">[21]</xref>, <xref ref-type="bibr" rid="pone.0091677-Ferezou1">[29]</xref>, <xref ref-type="bibr" rid="pone.0091677-Chakrabarti1">[30]</xref>. While our model simulates in a simplified way the net effect of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e099" xlink:type="simple"/></inline-formula> activation on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e100" xlink:type="simple"/></inline-formula> responses, it is a descriptive model which does not make any specific assumption about the mechanisms generating these responses.</p>
<p>In the model, we assumed that the stimulation and recording electrodes are organized into two different arrays placed in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e101" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e102" xlink:type="simple"/></inline-formula> and arranged in a square matrix with the same shape and number in each of the two regions. We assumed that the electrical activation of each stimulation sites in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e103" xlink:type="simple"/></inline-formula>, at a given electrical intensity, evoked a certain average number of spikes per trial on each electrode in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e104" xlink:type="simple"/></inline-formula>. The average number of spikes of each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e105" xlink:type="simple"/></inline-formula> electrode in response to each electrical stimulus was modeled by a bivariate Gaussian with parameters height <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e106" xlink:type="simple"/></inline-formula> (expressed in units of average spikes per trial, and representing in an abstract way the “intensity” of the stimulation) that peaks in the corresponding <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e107" xlink:type="simple"/></inline-formula> recording site (<xref ref-type="fig" rid="pone-0091677-g003">Figure 3</xref>) and spatial spread <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e108" xlink:type="simple"/></inline-formula> (in units of inter-electrode distance among recording electrodes). The topography of the position of the centers of activation in simulated responses from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e109" xlink:type="simple"/></inline-formula> to different stimuli in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e110" xlink:type="simple"/></inline-formula> matched that of the simulated stimulating electrodes in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e111" xlink:type="simple"/></inline-formula>. By indexing with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e112" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e113" xlink:type="simple"/></inline-formula> the electrode positions in the horizontal and vertical directions respectively (both for stimulating and recording array, that in our model have the same geometry), the spike rate at each electrode <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e114" xlink:type="simple"/></inline-formula> following activation of a given stimulation site <italic>s</italic> indexed by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e115" xlink:type="simple"/></inline-formula> can be thus be expressed as follows:<disp-formula id="pone.0091677.e116"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e116" xlink:type="simple"/><label>(17)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e117" xlink:type="simple"/></inline-formula> is a matrix with the same dimensions as the electrode array expressing the trial-averaged spike count output (in units of spikes/trial in the response time window used to run the interface). The term <italic>spont</italic> denotes the amount of spontaneous (not stimulus-induced) firing and was set to zero unless otherwise stated.</p>
<fig id="pone-0091677-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g003</object-id><label>Figure 3</label><caption>
<title>Examples of stimulus-response S1-M1 model used to run the interface.</title>
<p>We report some examples of trial-averaged neural responses by our model M1 in response to selected patterns of stimulations of S1. Here we plot responses for the case in which recording electrodes are arranged in a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e118" xlink:type="simple"/></inline-formula> grid (as in the stimulus set number 6 that has 32 elements (see <xref ref-type="table" rid="pone-0091677-t001">Table 1</xref>) and was used in most of the simulations). As explained in the main text, the spikes evoked by stimulating each S1 electrode are modeled by bivariate Gaussian distributions that peak in the corresponding M1 recording sites. (A) The average number of simulated spikes recorded from the electrodes in M1 and evoked by stimulating a single electrode in S1 (stimulated electrode is represented by a superimposed black “x”). (B) Average number of simulated M1 spikes evoked by stimulating couples of electrodes in S1 (again the pair of stimulated electrodes is indicated by the superimposed black “x”). In both panels, the color scale indicates the mean spike count expressed in units of mean spike count per trial, and the responses were shown for only one of the possible four levels of intensity in which each electrode could be stimulated in stimulus set number 6 (see <xref ref-type="table" rid="pone-0091677-t001">Table 1</xref>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g003" position="float" xlink:type="simple"/></fig>
<p>The topographic stimulus-response arrangement implemented in our simulations is observed to some extent in real data <xref ref-type="bibr" rid="pone.0091677-Ferezou1">[29]</xref> and is useful for visualizing the results of our algorithms. It is important to note that the assumption that the topography of stimulation in the sensory area is preserved by the activity of the motor area is not crucial to the function of the algorithm. The algorithm does not require this assumption because it computes the spatial configurations in the force field space on the basis of the distances between neural activities elicited in different conditions rather than from distances on the cortical surface.</p>
<p>Unless otherwise stated, the spike trains were generated, for each pair of stimulus and recording sites, by drawing randomly interspike intervals from an exponential Poisson distribution of interspike intervals with a mean equal to the average number of spikes recorded in that electrode in response to that stimulus. As a consequence, the spike times are distributed with a Poisson distribution with time-independent firing rates.</p>
<p>In our simulations, we considered seven different sets of electrical stimuli used to encode information in the sensory area. The different stimulus sets are obtained by varying, from one stimulus to the next, the number and location of the stimulated electrodes, as well as the intensity of stimulation. Stimulations of multiple electrodes are simulated as sum of responses that would have been evoked by stimulating each electrode individually. The different stimulus set used to generate each data set are summarized in <xref ref-type="table" rid="pone-0091677-t001">Table 1</xref> and also sketched in <xref ref-type="fig" rid="pone-0091677-g004">Figures 4</xref>. Investigating the behavior of the ndBMI when using stimulus sets with such different information characteristics, is useful to better understand how the sensory interface works.</p>
<fig id="pone-0091677-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g004</object-id><label>Figure 4</label><caption>
<title>Results of the calibration procedure to set-up the Sensory Interface using different data sets.</title>
<p>The goal of the calibration procedure is to define the “sensory regions” by partitioning the position space of the controlled device. (A) from left to right: i) a representation of the evoked spike activity, ii) a color-coded scheme of the recorded spike activity, iii) a graphical representation in the 2D domain of the results of the multidimensional scaling of the distance metric for each spike train, iv) the sensory regions obtained using a nearest neighbor algorithm. We tested this procedure also by using three different stimulation intensities (B), a combination of the stimulation electrodes obtained by co-stimulating neighboring electrodes (C) and by combining the co-stimulation with three stimulus intensities (D).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g004" position="float" xlink:type="simple"/></fig><table-wrap id="pone-0091677-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.t001</object-id><label>Table 1</label><caption>
<title>Schematic description of the stimulus set used to generate each response data set.</title>
</caption><alternatives><graphic id="pone-0091677-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Dataset</td>
<td align="left" rowspan="1" colspan="1">Number ofpatterns</td>
<td align="left" rowspan="1" colspan="1">Description</td>
<td align="left" rowspan="1" colspan="1">σ</td>
<td align="left" rowspan="1" colspan="1">Peak responseamplitude (h)</td>
<td align="left" rowspan="1" colspan="1">f factor</td>
<td align="left" rowspan="1" colspan="1">Electrodesgrid</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">In each stimulus, each of four different stimulussites is activated with one intensity level.</td>
<td align="left" rowspan="1" colspan="1">0.5</td>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1">[35.24–37.85]</td>
<td align="left" rowspan="1" colspan="1">2×2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">12</td>
<td align="left" rowspan="1" colspan="1">Each stimulus site is activated at one of three intensity levels.</td>
<td align="left" rowspan="1" colspan="1">0.5</td>
<td align="left" rowspan="1" colspan="1">2–5–8</td>
<td align="left" rowspan="1" colspan="1">[21.61–27.54]</td>
<td align="left" rowspan="1" colspan="1">2×2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">8</td>
<td align="left" rowspan="1" colspan="1">Stimulus sites are activated either individually orin contiguous pairs at one intensity level.</td>
<td align="left" rowspan="1" colspan="1">0.5</td>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1">[23.08–21.66]</td>
<td align="left" rowspan="1" colspan="1">2×2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">24</td>
<td align="left" rowspan="1" colspan="1">Stimulus sites are activated individually orin contiguous pairs at three intensity levels.</td>
<td align="left" rowspan="1" colspan="1">0.5</td>
<td align="left" rowspan="1" colspan="1">2–5–8</td>
<td align="left" rowspan="1" colspan="1">[15.79–19.70]</td>
<td align="left" rowspan="1" colspan="1">2×2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1">2<sup>3</sup> = 8</td>
<td align="left" rowspan="1" colspan="1">4 stimulation electrodes × 2 electrical intensities</td>
<td align="left" rowspan="1" colspan="1">0.5</td>
<td align="left" rowspan="1" colspan="1">5–10</td>
<td align="left" rowspan="1" colspan="1">[8.27–6.85]</td>
<td align="left" rowspan="1" colspan="1">2×2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1">2<sup>5</sup> = 32</td>
<td align="left" rowspan="1" colspan="1">8 stimulation electrodes × 4 electrical intensities</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">10–20–30–40</td>
<td align="left" rowspan="1" colspan="1">[2.94–2.85]</td>
<td align="left" rowspan="1" colspan="1">3×3</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">7</td>
<td align="left" rowspan="1" colspan="1">2<sup>7</sup> = 128</td>
<td align="left" rowspan="1" colspan="1">16 stimulation electrodes × 8 electrical intensities</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">10–20–30–40–50–60–70–80</td>
<td align="left" rowspan="1" colspan="1">[1.25–1.31]</td>
<td align="left" rowspan="1" colspan="1">5×5</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>For each data set (1 to 7) we describe the stimulus set, we report the parameters spatial spread (σ), peak response amplitude <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e119" xlink:type="simple"/></inline-formula> (reported in units of mean spike count per trial and varied to model the different amplitudes of stimulation), the value of the scaling factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e120" xlink:type="simple"/></inline-formula> and the geometry of the grid of both stimulated and recording electrodes. We use square grids of electrodes, but for stimulation we only use the “external” sites, located on the perimeter of the array. The recording electrodes are all used. So for data set 5, the matrix of electrodes is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e121" xlink:type="simple"/></inline-formula> and we use all of them. For data set 6, the grid is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e122" xlink:type="simple"/></inline-formula>, and since we do not stimulate with the central one, we use 8 stimulation electrodes, while all 9 recording electrodes are used. The grid used in data set 7 is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e123" xlink:type="simple"/></inline-formula> and we do not stimulate with the 9 internal electrodes.</p></fn></table-wrap-foot></table-wrap>
<p>We note that the above model of neural firing, as well as the above algorithm that we developed for the interface, assumes a stable relationship between stimulation of S1 and activity evoked in M1. However, in later Sections we investigate by numerical simulations both how the interface behaves when the S1-M1 map is changed by voluntary perturbations (Section “Addition of volitional control to shift at will the position of the target region”) and when the map between S1 stimulation and M1 recorded responses is altered after calibration by a deterioration of the selectivity and quality of the recorded neural responses (Sections “Deteriorating the simulated quality of neural responses to investigate the robustness of the algorithm” and “Robustness analysis of the ndBMI system”).</p>
</sec><sec id="s2g">
<title>Deteriorating the Simulated Quality of Neural Responses to Investigate the Robustness of the Algorithm</title>
<p>To evaluate the robustness of the ndBMI to degradation of the quality of responses, we generated neural activities with different amount of information about the electrical stimuli. We used several different ways to deteriorate such responses.</p>
<p>The first alteration of the quality of neural responses decreases the information about stimuli available at one or more electrodes. This was achieved by “flattening” the stimulus-to-stimulus variations in trial-averaged spike count (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e124" xlink:type="simple"/></inline-formula>) to each stimulus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e125" xlink:type="simple"/></inline-formula> without changing the overall averaged spike count in response to all stimuli <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e126" xlink:type="simple"/></inline-formula>, as follows <xref ref-type="bibr" rid="pone.0091677-Szymanski1">[31]</xref>:<disp-formula id="pone.0091677.e127"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e127" xlink:type="simple"/><label>(18)</label></disp-formula></p>
<p>For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e128" xlink:type="simple"/></inline-formula> the spike counts are equal to the original ones and all original stimulus information is available, while for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e129" xlink:type="simple"/></inline-formula>, each stimulus triggers the same spike count and information is zero.</p>
<p>The second simulated alteration of the neural responses tested the effect of the statistics of neural firing and consisted in generating spike trains with a Gamma distribution of interspike intervals (rather than with an exponential distribution like for the Poisson process), as follows:<disp-formula id="pone.0091677.e130"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e130" xlink:type="simple"/><label>(19)</label></disp-formula></p>
<p>This distribution fits cortical interspike interval distributions well <xref ref-type="bibr" rid="pone.0091677-Maimon1">[32]</xref>. For any value of the so called shape parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e131" xlink:type="simple"/></inline-formula>, it produces a mean inter spike interval equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e132" xlink:type="simple"/></inline-formula> with an amount of trial-to-trial spike count variance that depends on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e133" xlink:type="simple"/></inline-formula>. The case <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e134" xlink:type="simple"/></inline-formula> corresponds to the Poisson process (variance equal to mean), whereas values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e135" xlink:type="simple"/></inline-formula> lower than (respectively higher than) one generate trains with a higher (respectively lower) variance than the one of the Poisson process. Studying the performance of the algorithm as a function of the shape parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e136" xlink:type="simple"/></inline-formula> therefore allows us to investigate the specific role of neural variability in the interface.</p>
<p>The third simulated alteration of neural responses tested the effect of spontaneous activity upon the performance of the interface. This was achieve by setting to a non-zero value the term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e137" xlink:type="simple"/></inline-formula> of spontaneous firing in Eq. 17.</p>
<p>The fourth simulated deterioration consisted in simulating a “misplaced” recording electrode (of coordinates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e138" xlink:type="simple"/></inline-formula>) unable to record a response modulated by the simulation (this can happen for example, because the recording electrode is placed outside the region modulated by the stimulus, or because the electrode is highly corrupted by noise). The average spike count recorded in the misplaced recording electrode topographically matched to the considered stimulation electrode was set to be constant across all stimuli (and equal to the grand average number of spikes recorded across all electrodes and stimuli) and was expressed by the following equation:<disp-formula id="pone.0091677.e139"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e139" xlink:type="simple"/><label>(20)</label></disp-formula>for each possible stimulus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e140" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e141" xlink:type="simple"/></inline-formula> is the grand average number of spikes recorded across all electrodes and stimuli.</p>
<p>The fifth simulated deterioration mimicked a situation in which a stimulation site <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e142" xlink:type="simple"/></inline-formula> was made ineffective by triggering uniform responses across all recording sites (again equal to the grand average number of spikes recorded across all sites and stimuli), as follows:<disp-formula id="pone.0091677.e143"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e143" xlink:type="simple"/><label>(21)</label></disp-formula>for each possible electrode position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e144" xlink:type="simple"/></inline-formula>.</p>
<p>Since the responses generated by stimulating this electrode do not have any spatial specificity and do not change with stimulus intensity, this electrode encodes no information.</p>
</sec><sec id="s2h">
<title>Quantification of the Trajectories and Performance Evaluation</title>
<p>For each simulation, we started by placing the point mass at an initial position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e145" xlink:type="simple"/></inline-formula>. Then we let the interface run for up to 50 time steps. We randomly chose 24 different initial positions along a square centered in the origin with side equal to 0.8 times the dimension of the position space and for each of these 24 positions, we performed 10 repetitions, obtaining a total of 240 trials.</p>
<p>To measure how well our data sets and algorithms approximate the ideal force field, we introduce a metric called <italic>within-trajectory position error</italic> (abbreviated to <italic>wtpe</italic>) that measures the average distance, across all time steps, between each convergent trajectory (as defined in section <italic>Summary of the algorithmic function of the interface</italic>) and the ideal trajectory obtained by simulating the mechanical system under the influence of the desired force field and in the absence of noise. If a trajectory goes from time step 1 to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e146" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e147" xlink:type="simple"/></inline-formula> indicating the number of steps needed to converge for a given trial <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e148" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e149" xlink:type="simple"/></inline-formula> is the position of the point mass at time step <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e150" xlink:type="simple"/></inline-formula> for a given trial <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e151" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e152" xlink:type="simple"/></inline-formula> is the position of the point mass at that time step in the ideal force field, then <italic>wtpe</italic> is the averaged error:<disp-formula id="pone.0091677.e153"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e153" xlink:type="simple"/><label>(22)</label></disp-formula></p>
<p>High (respectively low) values of <italic>wtpe</italic> denote bad (respectively good) convergence performance of the system.</p>
<p>Significance of variations in <italic>wtpe</italic> were assessed using one-way ANOVA (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e154" xlink:type="simple"/></inline-formula>) followed by the comparison between a reference condition and all the others using a multiple comparison test with Tukey’s honestly significant difference criterion based on the Studentized range distribution.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<p>We used the simulated cortical responses to illustrate the behavior of the ndBMI and investigate its performance in a number of different conditions.</p>
<sec id="s3a">
<title>Calibration of the Sensory Interface on Simulated Data: The Sensory Interface Captures the Geometry of the Simulated Motor Cortical Activity Evoked by Stimulation of Sensory Cortex</title>
<p>The first step to set up the ndBMI is the calibration of the sensory interface using the training set (i.e. calibration data) of simulated neural data. In this work we generated the training set using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e155" xlink:type="simple"/></inline-formula> trials for each stimulation pattern. This process defines the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e156" xlink:type="simple"/></inline-formula> regions of space corresponding to each stimulation pattern <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e157" xlink:type="simple"/></inline-formula> by projecting (using <italic>MDS</italic>) motor cortical responses into the position plane in a way that preserves the original spike train distances of neural responses to different stimuli.</p>
<p>To illustrate the relationship between the spatial distribution of the information encoded by electrical stimulation and the geometry of the sensory regions, we first ran the calibration procedure using 4 different sets of simulated spike trains (<xref ref-type="table" rid="pone-0091677-t001">Table 1</xref> and <xref ref-type="fig" rid="pone-0091677-g004">Figure 4</xref>), each with a different stimulation geometry. The corresponding sensory interfaces and the partitions of the position space of the external device are reported in <xref ref-type="fig" rid="pone-0091677-g004">Figure 4</xref>.</p>
<p>Note that these first 4 data sets used to illustrate the properties of the sensory interface are slightly different from those used in the next sections to test the behavior of the ndBMI, but we chose to start from these 4 data sets because they illustrate very clearly the relationships between information encoded by stimulation and the partition into sensory regions made by the interface.</p>
<p>Data set 1 was generated by using a simple configuration, in which each stimulation pattern was constituted by the activation of only one of the stimulating electrodes. In this case, the sensory interface produced 4 well-separated regions that represent very well the geometry of the clusters of the 2D-projected spike trains (<xref ref-type="fig" rid="pone-0091677-g004">Figure 4A</xref> middle). The positions of the calibration sites are well-spread over the work space along two orthogonal lines obtaining similar-sized sensory regions (<xref ref-type="fig" rid="pone-0091677-g004">Figure 4A</xref> right).</p>
<p>We then considered a second data set that used the same single-electrode stimulation patterns of the first data set, but that in addition presented three different intensity stimulation levels (low, medium and high). This stimulus set had 12 different stimuli and, as a consequence, there were 12 sensory regions. The addition of the stimulus amplitude variable that modulated the response in the motor region changed the geometry of the sensory regions in several interesting ways (<xref ref-type="fig" rid="pone-0091677-g004">Figure 4B</xref>). The increase of the evoked spike activity with stimulation was encoded as an increment of the distance from the center of the workspace along the two main diagonals. The algorithm generated sensory regions that were organized such that increasing stimulation intensities resulted in increasing distances from the center. Thus, while the position of the electrode was encoded as an angle from the origin of the plane, the amplitude of stimulation was encoded as a radial distance from the origin.</p>
<p>To investigate the effect on the geometry of the sensory interface of inserting more complex stimulation patterns into the stimulus set, we created a data set with new stimuli made with the simultaneous stimulation of neighboring electrodes (data set 3). This resulted in a total of 8 distinct stimulus patterns (<xref ref-type="fig" rid="pone-0091677-g004">Figure 4C</xref>). In paired stimulations, we assumed that the same current pattern was simultaneously delivered through two neighboring electrodes. For each combination of two electrodes, the evoked spike trains were projected by the algorithm into the portions of space left by the projections of the spike trains evoked by each single electrode of the couple. Thus, the spatial configuration of the sensory regions reflected the combination of the electrodes in the stimulating array.</p>
<p>We finally tested the algorithms by using all the 24 different stimulation patterns described above (data set 4). The generated sensory regions reflected the spatial configuration of the electrodes and the intensity of the stimulation patterns (<xref ref-type="fig" rid="pone-0091677-g004">Figure 4D</xref>). For simplicity in the following sections we will run the interface using only stimulus set made of individual electrode stimulations.</p>
</sec><sec id="s3b">
<title>Non-linear Dynamic BMI System: Dependence of Performance upon the Density of Stimulation Patterns</title>
<p>We next tested the dynamical behavior of the ndBMI and its ability to control and interact with the external device, by first constructing the sensory and motor interfaces as described above, and then evaluating the trajectories of the point mass controlled by the ndBMI on a separate test dataset.</p>
<p>We tested two different ndBMIs that implemented two types of desired control policy of the external object and corresponding to two different force fields. The first was a Gaussian force field with all the forces converging toward a single equilibrium point (<xref ref-type="fig" rid="pone-0091677-g002">Figure 2A</xref>). The second was a Dipole force field obtained by linear superposition of the previous force field with a divergent one (<xref ref-type="fig" rid="pone-0091677-g002">Figure 2B</xref>).</p>
<p>We used the test set of simulated neural responses to test the ability of the ndBMI to drive a simulated point-mass moving in a viscous fluid, with the goal of reaching an equilibrium target region (indicated by a white dotted circle) around the center of the field. The performance was evaluated by initially placing the mass at rest in a given location and then following its trajectory along the neurally generated force field. An example of the convergent behavior of the BMI in one single trajectory is shown in <xref ref-type="fig" rid="pone-0091677-g005">Figure 5</xref>, where we show how the neural activity, the decoded forces and the stimulation patterns evolve with time to accompany the evolution of the position and velocity of the simulated point mass from a peripheral position to the equilibrium target region.</p>
<fig id="pone-0091677-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g005</object-id><label>Figure 5</label><caption>
<title>Evolution of variables of the ndBMI system for a single simulated trajectory.</title>
<p>(A) Temporal evolution in terms of simulation steps of variables describing the behavior of the system for a single trajectory: for each step from top to bottom are represented the two components of the actual position and velocity of the simulated point mass, the sensory region where the actuator is, the delivered stimulation pattern and the force applied to the dynamical system. (B) Heat maps describing the recorded neural activity in terms of mean spike count for each recording electrodes in 6 different points of the trajectory. (C) A representation of the selected trajectory with a reference to the 6 points depicted in (B) superimposed to the sensory regions.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g005" position="float" xlink:type="simple"/></fig>
<p>To evaluate how the behavior of the ndBMI depends on the resolution of the information encoded by electrical stimulation, we evaluated how the performance of the ndBMI is affected by the spatial density and number of stimulus patterns available in the set. We generated three different sets of data (see <xref ref-type="table" rid="pone-0091677-t001">Table 1</xref>) by combining a variable number of stimulating electrodes (i.e. 4, 8 and 16 stimulating electrodes) with different stimulation intensities.</p>
<p><xref ref-type="fig" rid="pone-0091677-g006">Figure 6</xref> shows the behavior of the system obtained with a Gaussian force field (middle panel) and with a Dipole force field (bottom panel). As described previously, we first used the calibration data to compute the sensory regions associated with each stimulation pattern. These sensory regions (reported as blue-tonality filled regions in <xref ref-type="fig" rid="pone-0091677-g006">Figure 6</xref>) followed a pattern fully consistent with the rules of thumb described in the previous section. We then used the test data to run the interface starting from 24 different initial positions. The trajectory generated by the interface (red-tonality lines in <xref ref-type="fig" rid="pone-0091677-g006">Figure 6</xref>) were compared with the “ideal trajectories” (black lines) obtained by simulating the point mass in the exact desired force field (the one that is defined in <xref ref-type="disp-formula" rid="pone.0091677.e087">equation 14</xref> and <xref ref-type="disp-formula" rid="pone.0091677.e092">15</xref> and that would be generated by the ndBMI in case of infinite spatial resolution of the information encoded by the electrical stimulation and a noiseless neural motor activity). We run the system 10 times from each starting position, thus obtaining 240 trajectories.</p>
<fig id="pone-0091677-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g006</object-id><label>Figure 6</label><caption>
<title>Performance of the ndBMI depends on the resolution of the sensory interface.</title>
<p>(A) An illustration of one of the data sets used in this study (data set 6) which is obtained by stimulating 8 electrodes organized in a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e158" xlink:type="simple"/></inline-formula> square grid with 4 different electrical amplitudes. (B,D) The actual trajectories (lines colored in red-tonality) obtained with the Multiple-points algorithm and the ideal trajectories (black lines) superimposed to the sensory regions (areas colored in blue-tonality) for a Gaussian force field (top) and Dipole force field (bottom). (C,E) bar chart of the average difference (i.e. error) calculated as the difference between the ideal and the actual trajectory for each trial simulated by using the Single-point (blue) and the Multiple-points (red) decoding algorithm. The * denotes that <italic>wpte</italic> depended significantly on the number of stimuli (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e159" xlink:type="simple"/></inline-formula> one-way ANOVA) and is placed in correspondence of the number of stimuli for which <italic>wpte</italic> was significantly different from the “reference” condition with 32 stimuli (Tukey multiple comparison test <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e160" xlink:type="simple"/></inline-formula>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g006" position="float" xlink:type="simple"/></fig>
<p>We evaluated the interface with both the Single-point and the Multiple-points decoding algorithms for computing the force to be applied to the point mass (see section <italic>Material and Methods</italic>).</p>
<p>The analysis of the performances showed that an increase of the number of the stimulus patterns and, consequently, of the number of sensory regions, made the actual trajectories of the controlled device more similar to the “ideal” trajectories of the desired force field. The advantage of having more sensory regions was more pronounced for the Dipole force field than for the Gaussian force field. For the Gaussian force field there was no gain in increasing the sensory regions from 8 to 32 but the trajectory error decreased significantly when increasing the number of sensory regions to 128 (<xref ref-type="fig" rid="pone-0091677-g006">Figure 6C</xref>). For the Dipole force field, there was a significant decrease in the trajectory error both when increasing the sensory regions from 8 to 32 and from 32 to 128 (<xref ref-type="fig" rid="pone-0091677-g006">Figure 6E</xref>). This suggests that the gain of having a large number of sensory regions (and thus of patterns of electrical stimulations eliciting different neural responses) is more relevant when implementing more complex force fields and control policies. We also found out that the performance of the system for these simulation conditions was very similar with both the Single-point and the Multiple-point different decoding algorithms.</p>
</sec><sec id="s3c">
<title>Robustness Analysis of the ndBMI System</title>
<p>In a complex system, such as a bidirectional BMI, stability and robustness are crucial features that concern all the elements constituting the information flow, from the recorded electrophysiological signals to the design of the actuators <xref ref-type="bibr" rid="pone.0091677-Patil1">[33]</xref>. We tested the robustness of the presented algorithm by investigating its performance in a number of simulated scenarios in which the same degree of degradation of the stimulus-response properties was applied to both calibration and test data.</p>
<p>In all the following tests of the robustness of the interface reported in this subsection, for simplicity we concentrated on the middle-resolution stimulation set (i.e. data set 6, consisting of 32 stimulation patterns). As in the previous section, we run the interface starting from 24 initial positions and computing 10 trajectories of the neurally driven point mass for each of the 24 starting points. Again, we tested the interface with both the Gaussian and the Dipole force fields.</p>
<p>The first degradation scenario was simulated by progressively reducing the amount of available information about the stimulation pattern that it was possible to extract from the evoked neural response. This degradation was implemented by flattening the different response profiles between stimuli, modulated by the parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e161" xlink:type="simple"/></inline-formula> (see section <italic>Deteriorating the simulated quality of neural responses to investigate the robustness of the algorithm</italic>). This parameter, when varied from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e162" xlink:type="simple"/></inline-formula> (maximal information) to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e163" xlink:type="simple"/></inline-formula> (minimal information) progressively reduced the stimulus modulation of all motor cortical responses. Modulating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e164" xlink:type="simple"/></inline-formula> can be thought as modulating the effectiveness of the stimulation and recording electrode implant in eliciting selective responses. <xref ref-type="fig" rid="pone-0091677-g007">Figure 7A,C</xref> shows the trajectories collected using the Gaussian and Dipole force fields with 5 different values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e165" xlink:type="simple"/></inline-formula>. The corresponding mean error between the actual and ideal trajectories for each value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e166" xlink:type="simple"/></inline-formula> is shown in <xref ref-type="fig" rid="pone-0091677-g007">Figure 7B,D</xref>. This analysis shows that both Single-point and Multiple-points algorithms are relatively robust, for both force fields, to the degradation of the response. The mean trajectory error remained relatively stable as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e167" xlink:type="simple"/></inline-formula> is increased. The interface implementing the Gaussian force field was particularly robust, at its performance deteriorated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e168" xlink:type="simple"/></inline-formula> from the reference <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e169" xlink:type="simple"/></inline-formula> value when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e170" xlink:type="simple"/></inline-formula> with a small effects and with a large deterioration effects for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e171" xlink:type="simple"/></inline-formula> (corresponding to 90% deterioration of response selectivity). The performance of the Dipole force field interface deteriorated significantly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e172" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e173" xlink:type="simple"/></inline-formula> and above, with particularly large deterioration effects reached for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e174" xlink:type="simple"/></inline-formula>.</p>
<fig id="pone-0091677-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g007</object-id><label>Figure 7</label><caption>
<title>Performances of the ndBMI when reducing information about the stimulation pattern.</title>
<p>(A,C) Ideal (black lines) and actual (red-tonality lines) trajectories of the Multiple-points algorithm superimposed to the sensory regions (blue-tonality areas) by using data set 6 and two different force fields simulated by progressively reducing the amount of available information represented by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e175" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e176" xlink:type="simple"/></inline-formula>. (B,D) Bar chart of the <italic>wpte</italic> between the ideal and actual trajectories calculated for different value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e177" xlink:type="simple"/></inline-formula>. The * denotes that <italic>wpte</italic> depended significantly on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e178" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e179" xlink:type="simple"/></inline-formula> one-way ANOVA) and is placed in correspondence of the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e180" xlink:type="simple"/></inline-formula> for which <italic>wpte</italic> was significantly different from the “reference” condition with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e181" xlink:type="simple"/></inline-formula> (Tukey hsd <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e182" xlink:type="simple"/></inline-formula>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g007" position="float" xlink:type="simple"/></fig>
<p>The second simulated alteration of the neural responses tested the effect of the statistics of neural firing and consisted in generating spike trains with a Gamma distribution of interspike intervals, rather than with a Poisson process as in all the other simulations. The Gamma distribution has a so called “shape” parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e183" xlink:type="simple"/></inline-formula> that determines the spike count variance <xref ref-type="bibr" rid="pone.0091677-Maimon1">[32]</xref>. The case <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e184" xlink:type="simple"/></inline-formula> corresponds to the Poisson process (variance equal mean), whereas values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e185" xlink:type="simple"/></inline-formula> lower than (respectively higher than) one tend to generate trains with a higher (respectively lower) variance than the one of the Poisson process. When implementing the interface on simulated data with different values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e186" xlink:type="simple"/></inline-formula> and thus with varying degrees of variance (<xref ref-type="fig" rid="pone-0091677-g008">Figure 8</xref>), we found that the performance of the Gaussian force field interface was relatively insensitive to the firing statistics, with significant (P&lt;0.01) deviations from the Poisson case observed for very regular firing statistics (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e187" xlink:type="simple"/></inline-formula>; <xref ref-type="fig" rid="pone-0091677-g008">Figure 8A,B</xref>). The performance of the Dipole force field interface was more affected by firing statistics, with a particularly marked decrease of performance for processes with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e188" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pone-0091677-g008">Figure 8C,D</xref>). (Note that values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e189" xlink:type="simple"/></inline-formula> below 0.5 are extremely uncommon in cortical neurons <xref ref-type="bibr" rid="pone.0091677-Maimon1">[32]</xref>; therefor the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e190" xlink:type="simple"/></inline-formula> should be interpreted as a case of an extremely irregular firing processes with variability much higher than that of a typical cortical neuron).</p>
<fig id="pone-0091677-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g008</object-id><label>Figure 8</label><caption>
<title>Performances of the ndBMI by using a data set generated from a Gamma Interval process with different values of the shape parameter k.</title>
<p>(A, C) Ideal ad actual trajectories superimposed to the sensory regions obtained by using data generated by using five different values of the shape parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e191" xlink:type="simple"/></inline-formula> of a Gamma interval process used to set the inter-spike intervals of the simulated spike trains. We ran the interface using the Gaussian (A) and Dipole (C) force fields with the Multiple-points algorithm. (B, D) Average within-trajectory position error across the three different conditions shows how the error decreases by increasing the regularity of the spiking of the M1 neurons. The * denotes that <italic>wpte</italic> depended significantly on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e192" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e193" xlink:type="simple"/></inline-formula> one-way ANOVA) and is placed in correspondence of the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e194" xlink:type="simple"/></inline-formula> for which <italic>wpte</italic> was significantly different from the “reference” condition with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e195" xlink:type="simple"/></inline-formula> (Tukey hsd <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e196" xlink:type="simple"/></inline-formula>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g008" position="float" xlink:type="simple"/></fig>
<p>The third simulated alteration of neural responses tested the effect of adding spontaneous firing. We found that the Gaussian force field interface performance was again extremely robust to this alteration. It decreased only by a relatively small amount (less than 20%) even when adding a level of spontaneous activity that was more than twice larger than the peak response to the maximal simulated electrical stimulation amplitude (this stimulus provoked a peak activity of 40 spikes/trial in these simulations). The Dipole force field interface was also relatively robust to introduction of spontaneous activity of 40 spikes/trial (as large as the peak of the increase of response to the most effective stimulus, <xref ref-type="fig" rid="pone-0091677-g009">Figure 9C,D</xref>) but was less robust than the Gaussian force field to values of spontaneous activity much larger than the peak response (<xref ref-type="fig" rid="pone-0091677-g009">Figure 9A,B</xref>).</p>
<fig id="pone-0091677-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g009</object-id><label>Figure 9</label><caption>
<title>Performances of the ndBMI by adding different level of spontaneous activity to the stimulus-related activity.</title>
<p>(A, C) Ideal and actual trajectories superimposed to the sensory regions generated by adding to the stimulus-evoked activity of data set 6, two different levels of spontaneous activity in terms of trial-averaged spike count (i.e. 40 and 100 spikes/trial). We tested the interface by using the Gaussian force field and the Dipole force field with the Multiple-points decoding algorithm. (B, D) Average within-trajectory position error across the 3 different levels of added spontaneous activity tested with the two different decoding algorithms. The * denotes that <italic>wpte</italic> depended significantly on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e197" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e198" xlink:type="simple"/></inline-formula> one-way ANOVA) and is placed in correspondence of the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e199" xlink:type="simple"/></inline-formula> for which <italic>wpte</italic> was significantly different from the “reference” condition with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e200" xlink:type="simple"/></inline-formula> (Tukey hsd <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e201" xlink:type="simple"/></inline-formula>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g009" position="float" xlink:type="simple"/></fig>
<p>We then tested two other scenarios, in which we simulated that one of the recording electrodes (<xref ref-type="fig" rid="pone-0091677-g010">Figure 10B,F</xref>) or one of the stimulating electrodes (<xref ref-type="fig" rid="pone-0091677-g010">Figure 10C,G</xref>) were not effective. In the former scenario, we simulated a misplaced recording electrode that records activity outside the region affected by stimulation (and thus reported a constant number of spikes regardless the stimulus delivered). In the latter scenario, we simulated an ineffective stimulating electrode that failed to elicit any spatially localized modulation of responses in the recording electrodes. The Gaussian force field interface was extremely robust (no significant decrease in performance) in both the simulated scenarios. In contrast, the Dipole force field interface exhibited a decrease in performance (increase in wpte error) in both the simulated scenarios of electrode degradation. For the Dipole Field, the error with a defective recording electrode was 40% larger than the one of the clean simulation (<xref ref-type="fig" rid="pone-0091677-g010">Figure 10H</xref>).</p>
<fig id="pone-0091677-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g010</object-id><label>Figure 10</label><caption>
<title>Performances of the ndBMI when simulating one malfunctioning recording and stimulation electrode.</title>
<p>The actual trajectories of the Multiple-points algorithm (red-tonality lines) and the ideal trajectories (black lines) superimposed to the sensory regions (blue-tonality areas) by using data set 6 (i.e. 32 stimulating electrodes) and two force fields obtained by utilizing respectively (A, E) the original data set, (B, F) a data set simulating a misplaced recording electrode and (C, G) a data set simulating an ineffective stimulating electrode. (D, H) Bar chart representing the average within-trajectory position error (<italic>wtpe</italic>) of the trajectories obtained simulating a misplaced recording and ineffective stimulating electrode compared with the one simulated by using the original data set. The * denotes that <italic>wpte</italic> depended significantly on the malfunctioning electrodes conditions(<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e202" xlink:type="simple"/></inline-formula> one-way ANOVA) and is placed in correspondence of the malfunctioning conditions for which <italic>wpte</italic> was significantly different from the original data set (Tukey hsd <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e203" xlink:type="simple"/></inline-formula>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g010" position="float" xlink:type="simple"/></fig>
<p>As previously stated in the above simulations the same degree of degradation was applied to calibration and test data. However, a situation that may be encountered in real experiments is when the recording or stimulation system works well during calibration but then degrades during testing. This may be the case with alterations in signal quality during chronic recordings. We simulated this situation by first calibrating the interface on uncorrupted data (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e204" xlink:type="simple"/></inline-formula>) and then testing the interface on corrupted data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e205" xlink:type="simple"/></inline-formula>. The performance of the interface in this scenario is reported in <xref ref-type="fig" rid="pone-0091677-g011">Figure 11</xref>. It is interesting to compare this case of corruption of neural signal only during testing with the previously reported case (see <xref ref-type="fig" rid="pone-0091677-g007">Figure 7</xref>) in which the same corruption was present both during calibration and during testing. With respect to this previous case, in the case of corruption during testing only we found a mild decrease of performance of the interface for moderate values of corruption (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e206" xlink:type="simple"/></inline-formula> in the range 0.3–0.7), probably because of the mismatch between the neural firing properties between calibration and testing. However, for extreme values of corruption <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e207" xlink:type="simple"/></inline-formula> the interface was more robust when degradation happened only during testing. This, in our view, happened because its sensory regions, being computed from non-degraded activity, were of high quality for all values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e208" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pone-0091677-g011">Figure 11</xref>). For large degradation of neural responses, the beneficial effect of the uncorrupted sensory regions outweighed the negative effect of the mismatch between calibration and testing firing statistics.</p>
<fig id="pone-0091677-g011" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g011</object-id><label>Figure 11</label><caption>
<title>Performance of the ndBMI when reducing information about the stimulation pattern only during the testing phase.</title>
<p>(A,C) Ideal (black lines) and actual (red-tonality lines) trajectories of the Multiple-points algorithm superimposed to the sensory regions (blue tonality areas). Uncorrupted data were used during the calibration procedure <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e209" xlink:type="simple"/></inline-formula> and corrupted data were used during the testing phase (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e210" xlink:type="simple"/></inline-formula>), (B,D) Bar chart of the average within-trajectory position error (<italic>wtpe</italic>) between the ideal and actual trajectories calculated for different value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e211" xlink:type="simple"/></inline-formula>. The * denotes that <italic>wpte</italic> depended significantly on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e212" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e213" xlink:type="simple"/></inline-formula> one-way ANOVA) and is placed in correspondence of the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e214" xlink:type="simple"/></inline-formula> for which <italic>wpte</italic> was significantly different from the “reference” condition with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e215" xlink:type="simple"/></inline-formula> (Tukey hsd <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e216" xlink:type="simple"/></inline-formula>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g011" position="float" xlink:type="simple"/></fig></sec><sec id="s3d">
<title>Addition of Volitional Control to Shift at will the Position of the Target Region</title>
<p>In the above simulations, we considered a neural system whose motor cortical response properties depended only upon the specific pattern of electrical stimulation to the sensory region. In this configuration is that the BMI implements, in an essentially automated way, only the particular behavior (for example, reaching a fixed target region chosen at the stage of calibration) implied by the desired force field that was programmed into the sensory and motor interfaces. This raises the question of how the brain may control and modulate at will the operation of the interface, for example by shifting or reaching the target regions at will. We addressed this issue by simulating the presence (during test trials) of a volitional control input aiming to shift the equilibrium position of the point mass from the original equilibrium point of the force field set during calibration to a new location. In fact, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e217" xlink:type="simple"/></inline-formula> is the force fields programmed by the calibration of the BMI, a simple change may be imposed by a transformation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e218" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e219" xlink:type="simple"/></inline-formula> is a component introduced by volitional activity impinging upon the recorded population from structures outside the pathway between stimulation and recording arrays. Accordingly, the force field is changed by volition to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e220" xlink:type="simple"/></inline-formula> To describe how we can introduce such a volitional modulation, let us consider the case in which, as described above, calibration is made on data that do not contain any volitional component. After the calibration, the sensory interface maps a position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e221" xlink:type="simple"/></inline-formula> into a pattern of stimulation that evokes neural activity with a spike count output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e222" xlink:type="simple"/></inline-formula>. This is the neural response caused by the stimulation array as described in Section <italic>Simulated neural data</italic>. Let us now assume that during test trials the neural activity recorded from motor cortex contains an additional component expressing a volitional command, for example due to inputs to the considered motor region that do not originate from the sensory region stimulated by the interface. For simplicity, we assume that the volitional component is additive. In this case, the spike count obtained after electrical stimulation is made of a stimulus-evoked component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e223" xlink:type="simple"/></inline-formula> and of a volitional component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e224" xlink:type="simple"/></inline-formula> that is independent from the current state of the device and reflects only the intention of the subject to modify the trajectory:<disp-formula id="pone.0091677.e225"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e225" xlink:type="simple"/><label>(23)</label></disp-formula></p>
<p>Consider now for simplicity the case of the Gaussian force field, and suppose that the purpose of the voluntary addition is to move the target equilibrium position to a new point different from the center of the Gaussian force field. The addition of a volitional constant firing rate term to motor cortical activity can be used to shift the position of target region at will. To do so, it is enough to add a term which, if emitted in isolation (without noise and without the firing rate emitted by the non-volitional part), would lead to a force pointing toward the target from the equilibrium point. In the case of the radial field as in the example, this is simply computed as<disp-formula id="pone.0091677.e226"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e226" xlink:type="simple"/><label>(24)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e227" xlink:type="simple"/></inline-formula> is the volitional target position. In this way, the translation of the total firing rate given by the motor interface tends to provide a constant shift of the dynamics toward the desired equilibrium point.</p>
<p><xref ref-type="fig" rid="pone-0091677-g012">Figure 12A</xref> reports the trajectories that we obtained by adding a volitional firing rate term (computed as described in <xref ref-type="disp-formula" rid="pone.0091677.e226">equation 24</xref> given the chosen position of the new wanted equilibrium point) to an ndBMI with a Gaussian force field. We ran this algorithm using the Multiple-points decoding algorithm. Since the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e228" xlink:type="simple"/></inline-formula> function is defined as constant over sensory regions rather than having a different value for each point of the state space of the actuator, we chose as volitional target positions only positions onto which one or more of the calibration trials were projected. The number of spikes due to the volitional input was generated in each trial using a Poisson distribution with the average spike count specified by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0091677.e229" xlink:type="simple"/></inline-formula>, and added to the spikes generated by the intrinsic sensory to motor area mapping described previously. In each of the 4 panels of <xref ref-type="fig" rid="pone-0091677-g012">Figure 12A</xref> we report results for 4 different volitional components, which lead each to a different desired equilibrium point (represented by a yellow dot in the domain). In each of these 4 cases we generated a set of trajectories originating from 16 different starting points. These trajectories should be compared with those shown in the middle panel of <xref ref-type="fig" rid="pone-0091677-g006">Figure 6B</xref>, which show trajectories with the same interface parameters but without the addition of voluntary firing rate component. In agreement with the intuition explained above, the effect of the voluntary input is a shift of target toward different locations surrounding the center of the workspace.</p>
<fig id="pone-0091677-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0091677.g012</object-id><label>Figure 12</label><caption>
<title>Performances of the ndBMI when adding a voluntary command and an external perturbation.</title>
<p>Actual trajectories of the Multiple-points algorithm (red-tonality lines) superimposed to the sensory regions (blue-tonality areas) obtained using data set 6 (32 stimulating electrodes) obtained by adding (A) a voluntary input signal that drives the system toward 4 new equilibrium points (yellow dots) and (B) an external perturbation in the form of skew-symmetric velocity dependent force field.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0091677.g012" position="float" xlink:type="simple"/></fig>
<p>We further tested the stability of the volitional shift of target by adding an external perturbation to the force field, in the form of a skew-symmetric velocity dependent field:<disp-formula id="pone.0091677.e230"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0091677.e230" xlink:type="simple"/><label>(25)</label></disp-formula></p>
<p>The effect of this field is to apply a force orthogonal to the movement and proportional to its instantaneous speed. Several studies of motor learning <xref ref-type="bibr" rid="pone.0091677-Thoroughman1">[34]</xref>, <xref ref-type="bibr" rid="pone.0091677-Gandolfo1">[35]</xref> have employed this type of force perturbations for challenging arm movement stability and investigating adaptive control. The simulation results in <xref ref-type="fig" rid="pone-0091677-g012">Figure 12B</xref> illustrate the stability of the volitional perturbation, as the motion of the point mass converges toward the attractors encoded by the volitional control despite trajectories are deflected in a general counterclockwise pattern.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<sec id="s4a">
<title>Laying the Foundations for Bidirectional BMIs</title>
<p>The idea of controlling robotic devices by brain activities has been driven by two different perspectives. One is the perspective of providing people with severe form of paralysis with a new “channel to the world”. The other is to provide researchers in Neuroscience with a new family of experimental tools for answering basic questions, such as how the known mechanism of neuroplasticity may provide the physiological foundation for learning and memory. While in the last decade there have been substantial advances on both perspectives, most practical and conceptual challenges remain widely open. Research in brain-computer or brain-machine interfaces is attracting a growing number of scientists from different disciplines and now forms a sizeable scientific community. This community is actively exploring all aspects that affect the information flow of a BMI system, from improvements in the materials that are used to build the electrodes to the development of new decoding algorithms that more reliably transform the neural signals into motor commands for an artificial limb.</p>
<p>In this context, the classical scheme of a brain-machine interface includes neural sensors to record motor signals <xref ref-type="bibr" rid="pone.0091677-Grill1">[36]</xref> and decoders to extract the motor intents of the subject from the available neural signals <xref ref-type="bibr" rid="pone.0091677-Wessberg1">[4]</xref>, <xref ref-type="bibr" rid="pone.0091677-Schwartz1">[37]</xref>. This approach, although successful <xref ref-type="bibr" rid="pone.0091677-Hochberg1">[38]</xref>, still considers any sensory feedback as a separate channel, conceptually divided from the decoding of motor command and necessary only in cases where natural feedback is lacking. Another aspect that is missing in this approach is that by directly translating motor cortical signals into a desired movement trajectory, one ignores the functionality of sub-cortical structures, such as the spinal cord, that also participate in the natural production and control of motor behavior. In recent years these two aspects have been explored in a more systematic way obtaining systems and methodologies in which closing the loop between the brain and the artificial object becomes a fundamental aspect <xref ref-type="bibr" rid="pone.0091677-ODoherty1">[8]</xref>, <xref ref-type="bibr" rid="pone.0091677-ODoherty2">[9]</xref>, <xref ref-type="bibr" rid="pone.0091677-Jackson1">[39]</xref>. Also the possibility of using the decoded signal to stimulate the spinal cord directly to generate a movement is a topic that has been addressed <xref ref-type="bibr" rid="pone.0091677-Zimmermann1">[40]</xref>. To explore how to bring together these two key research directions, here we developed a proof of concept for a novel approach to brain-machine interfaces. Our approach is based on two main concepts: the interface creates a closed loop system in which brain activities from a motor area are decoded into a force acting upon the external device and the state of the external device is encoded into an electrical stimulus delivered to a sensory area, and the encoding and decoding components of the interface are set-up concurrently, so as to approximate a desired force field of arbitrary form.</p>
<p>The final output of the brain-machine interface is determined by three factors, namely i) the encoding and decoding rules, ii) the external environment, which contributes to establishing the state of the controlled device, and iii) the inputs to the recorded neurons other than those caused by the electrical stimulus. The latter includes any random background activity impinging on the recorded population as well as activities driven by volitional commands. Thus, the resulting behavior is a combined effect of the approximated field, neural noise, environmental influences and voluntary control. In this respect, our approach extends the more conventional BMI methods based only on decoding the output activity as a desired state of the controlled device. In these methods, the voluntary commands modulate the firing of the output neurons under the assumption that these activities are the only determinant of the state of motion of the external device. If a perturbation takes place, it can only be detected by vision (or other sensory stimuli) and corrected based on some high order voluntary process. Instead, in our approach some aspects of the response to external influences are encoded in the desired field and can be modulated by higher order voluntary activity.</p>
</sec><sec id="s4b">
<title>Force Fields as Motor Control Policies to Control Dynamical Systems</title>
<p>In this new framework, our BMI does not translate a motor intention into a particular movement, but rather into a specified “dynamical behavior”. By this term we mean a prescription of how the controlled system, for example an artificial limb or in our simpler implementation a point mass, interacts with the environment. The mechanical interaction between a control system and its environment is governed by the exchange of power, specified by effort and motion variables. The controller/environment interaction takes two canonical forms <xref ref-type="bibr" rid="pone.0091677-Hogan1">[41]</xref>, <xref ref-type="bibr" rid="pone.0091677-Karnopp1">[42]</xref>, i.e. a) the environment dictates the state of motion (position and velocity) and the controller responds with a force (i.e. the controller is an impedance and the environment an admittance), or b) the controller sets a state of motion and the environment responds with a force. Considerations on the passive mechanics of the musculoskeletal system suggest that the first case is a more plausible description of biological control policies <xref ref-type="bibr" rid="pone.0091677-Hogan2">[43]</xref>. In fact, earlier experimental studies on spinalized frogs <xref ref-type="bibr" rid="pone.0091677-Bizzi1">[15]</xref>, <xref ref-type="bibr" rid="pone.0091677-Giszter1">[44]</xref>, <xref ref-type="bibr" rid="pone.0091677-MussaIvaldi4">[45]</xref> and rats <xref ref-type="bibr" rid="pone.0091677-Tresch2">[46]</xref> demonstrated that activation of spinal cord interneurons results in a field of forces that drive the limb along different trajectories, depending on the state of motion in which the limb is placed by the interaction with the external environment. This is a natural description of motor control, if one considers that muscles are spring-like elements establishing (non-invertible) mappings from a limb’s state of motion to a resulting viscoelastic force. Since forces are inherently additive, the combined actions of multiple muscles result in the summation of their force fields. Therefore, the description of motor control policies as force fields has the important property of providing a compositional mechanism for the generation of a large repertoire of behaviors from the sum of a relatively small number of force-field “primitives” <xref ref-type="bibr" rid="pone.0091677-MussaIvaldi2">[20]</xref>.</p>
<p>We have developed the computational analysis in parallel with ongoing electrophysiological experiments <xref ref-type="bibr" rid="pone.0091677-Vato1">[21]</xref>. For this reason, we considered brain regions that are known a) to play functional role in receiving sensory information and dispatching motor commands and b) to have a pattern of interconnections. Furthermore, cortical regions are significantly easier to access and manipulate experimentally than the spinal cord or other subcortical regions. We focus on the transformation that is carried out by the neural circuits intervening between stimulation and recording arrays, because we expect that the output of the recording array can also be modulated by volitional influences. In a recent study <xref ref-type="bibr" rid="pone.0091677-Vato1">[21]</xref> on anesthetized rats we tested the first prototype of a bidirectional BMI in which motor cortical activities were linearly mapped to force vectors acting upon a simulated point mass and the position of the point mass was encoded into an electrical stimulus delivered to the somatosensory cortex. With this approach, we were able to approximate a linear force field converging to a single equilibrium location. However, a limiting constraint for that approach was the requirement that the relation from position to force was invertible. This was due to the fact that the approximation procedure first defined the domain upon which the applicable forces were defined and then the forces produced by each stimulation pattern were mapped during the calibration to the locations at which these force were to be applied. This approach drastically limited the repertoire of feasible control policies, a limit that is now removed by the current algorithm. Here, the position of the controlled object maps to an electrical stimulus and the response to this stimulus - which is also open to other inputs, such as volitional activities - is decoded in the location at which the force is calculated based on the predefined force field. Therefore, the information flow from position to force never needs to be inverted. The possibility to represent a broader repertoire of fields is of essential importance since relevant motor behaviors and control policies are not limited to force fields converging toward a single equilibrium point. More generally, force fields also offer an adequate description of the stretch reflex, first described by Sherrington <xref ref-type="bibr" rid="pone.0091677-Sherrington1">[47]</xref> and of spinal pattern generators. The latter induce a cyclical motion of the limbs. Grillner and coworkers <xref ref-type="bibr" rid="pone.0091677-Grillner1">[16]</xref> offered a compelling model of locomotion pattern in the lamprey, and in both cases the rhythmic activity is sustained by a phase-shift between the state of motion and the consequent forces.</p>
<p>In the current implementations we have only considered a fixed force field, established by coordinating the calibration of the sensory and motor interfaces. This approach however is open to future developments in which, for example, multiple force fields, with different structures, are implemented in parallel. In this case, the voluntary activity could effectively generate a larger repertoire of behaviors by establishing weighted combinations of these force fields.</p>
</sec><sec id="s4c">
<title>Limitations of the Simulated Neural Systems used to Test the ndBMI</title>
<p>The performance and robustness of our new ndBMI was tested and validated with a simple descriptive model of stimulation and neural responses in the sensory-motor loop inspired by the cortical sensory motor loop in the rat whisker system. The model captures, in an idealized and simplified way, two observed features of cortical responses: Poisson variability of spike train responses and topographic organization between stimulated and evoked activity.</p>
<p>Poisson processes are simplified model of neural responses, because they neglect any form of auto- and cross-correlation among the spike trains. Yet this model is a relatively realistic one, in that it correctly represents the approximate order of magnitude of the trial-to-trial variance of cortical responses, which (like in the Poisson model) is relatively close to its mean. An important question for practical applications of this technique is whether the simplified nature of the Poisson model may limit the inferences that we can make about the performance of the algorithm on real data. The first consideration is that the algorithms seem to be remarkably robust; we found they were robust even to very large degradations of the information carried by neural recordings. In many respects, the assumptions of the Poisson model are conservative with respect to the information content of neural activity, as cortical responses often report sub-Poisson variance <xref ref-type="bibr" rid="pone.0091677-Maimon1">[32]</xref>, <xref ref-type="bibr" rid="pone.0091677-Kayser1">[48]</xref>, including in the animal models that we use for developing bidirectional BMIs <xref ref-type="bibr" rid="pone.0091677-Vato1">[21]</xref>. Moreover, autocorrelations and cross-correlations of neural activity found in real data usually have small effects on the information content, compared to what would be expected if statistics followed the Poisson model <xref ref-type="bibr" rid="pone.0091677-Hatsopoulos1">[49]</xref>–<xref ref-type="bibr" rid="pone.0091677-Scaglione1">[52]</xref>. Whatever the exact response statistics of the neurons under consideration, it is important to bear in mind that the ndBMI algorithms presented here do not rely at all on the assumption that the data are distributed according to a Poisson distribution. They can operate with correlated data and can capture information or metric structure encoded by correlated firing, if present.</p>
<p>An organization of motor neural responses that preserves the geometry of sensory stimulation patterns is also supported by data in the sensory motor whisker system <xref ref-type="bibr" rid="pone.0091677-Ferezou1">[29]</xref>. While the precision of topography implemented in our simulations may be difficult to obtain in experimental situations, we demonstrated a strong robustness of the algorithm to loss of specificity of responses, and the algorithms do not assume or rely on topography of responses at all.</p>
<p>Therefore, although of course a full validation of the capabilities and potentials of the algorithms presented here will require their future testing on real data, our expectation is that the simulated study presented has a sufficient realism to investigate and validate the computational properties of our algorithms.</p>
</sec><sec id="s4d">
<title>Considerations on Volitional Control</title>
<p>In the prevalent BMI system models <xref ref-type="bibr" rid="pone.0091677-Wessberg1">[4]</xref>, <xref ref-type="bibr" rid="pone.0091677-Hauschild1">[6]</xref>, <xref ref-type="bibr" rid="pone.0091677-Schwartz1">[37]</xref>, <xref ref-type="bibr" rid="pone.0091677-Hochberg1">[38]</xref> neural activities are decoded by some algorithm, which dictates the instantaneous position of a controlled device, such as a robotic arm or a cursor on a computer monitor. Here, we suggest that the brain activities, instead of specifying a position, contribute to determine the force vector that is applied to the device. We stress the word “contribute” instead of “dictate” because the net force generated by the interface results from the combination of the volitional command with the state-dependent component from the sensory interface. In this study we have limited the analysis to demonstrate through simulation that it is possible - in principle - for the volitional activity to shape the force field so as to drive the device to a desired target. In a physical implementation, this possibility rests upon the ability of the brain to address by volitional activity the neural population that is being recorded and to learn how to shape the field according to the behavioral goal. This is of course a major open challenge, whose possibility of success is supported by the demonstrated ability of the brain to shape by volition the activities of specific target neurons <xref ref-type="bibr" rid="pone.0091677-Fetz1">[53]</xref>, <xref ref-type="bibr" rid="pone.0091677-Black1">[54]</xref>.</p>
<p>Our approach is based upon generating a field by closing the loop between recording and stimulation. With this, we do not deny the validity of having control system dynamics external to the brain. On the contrary, while here we consider rather primitive forms of external dynamics (a point mass in viscous fluid) more advanced applications can be considered, including some external controller. The issue of using neural or artificial controllers is similar to the debate on whether using M1 activities to control the dynamics of a robotic arm, instant by instant, or decode higher level commands from the posterior parietal cortex and have a robot implementing the desired goals. We feel that at this time it is important to explore all these alternatives. The rationale for our approach over one based on an external device is that we want to consider the possibility for the brain to access within its volitional centers, the same sensory information that, through the dBMI, causes the activation of the recorded neurons.</p>
<p>The bidirectional interface proposed here can generate patterns of automatic sensory-motor responses in a way analogous to spinal <xref ref-type="bibr" rid="pone.0091677-Sherrington2">[55]</xref> and supraspinal <xref ref-type="bibr" rid="pone.0091677-Evarts1">[56]</xref> reflex mechanisms. With this approach, we are implicitly assuming that the alert brain would be able to modulate the output of the interface, thus adding a volitional decision-making component to the picture. This assumption does not rest on blind faith, but on a repertoire of examples in which the brain learned to focally control the output of individual neurons and neuronal populations for the operation of external device <xref ref-type="bibr" rid="pone.0091677-Chapin1">[3]</xref>, <xref ref-type="bibr" rid="pone.0091677-Wessberg1">[4]</xref>, <xref ref-type="bibr" rid="pone.0091677-Schwartz1">[37]</xref>. In these previous examples, brain activities were directly decoded into some state variable, like the desired position of a manipulator or of a cursor. Here, instead, we propose that the volitional neural activities modulate the field established by the bidirectional interface. We demonstrated in one example that this may lead to effective control over the desired position of the target. However, this volitional signal combined with the field encoded by the interface does not only establish a target position but effectively a whole family of trajectories. Furthermore, the field properties offer a mechanism to ensure stability of the resulting motions, which can reach the desired target in spite of external perturbing forces acting on the controlled device. The repertoire of possible behaviors is not limited to movements directed toward an equilibrium position. We have shown that the inherently additive nature of force fields allows the programming of combinations of multiple goals, such as reaching a target while avoiding an obstacle. Furthermore, the structure of the force field can be shaped to drive the controlled device in cyclical and other behaviors. Ultimately, what we are proposing in this example is to move one step forward toward the implementation of bio-mimetic control mechanisms, by reproducing a structure of control processes that is analogous to the interaction between brain and spinal cord in vertebrates. This interaction is based on the seamless integration of voluntary commands with a peripheral neuromechanical structure. As a result our movements are endowed with adaptive properties that emerge from the coupling of neural information processing with the physical properties of the environment and of the musculoskeletal apparatus.</p>
<p>In some ways, our approach is an attempt at effectively emulating the spinal cord in the portion of the brain that connects the recording and stimulating electrodes. While we have already obtained some experimental validation of this approach <xref ref-type="bibr" rid="pone.0091677-Vato1">[21]</xref>, we do not suggest that we are ready for clinical application. At this time, we are merely proposing to coordinate the input and output interfaces based on a shared goal, the generation of a force field to be modulated by central activities. Would such a system eventually disrupt the normal operation of the brain? Indeed, it would not be wise to take over brain regions that are normally functional. The brain machine interface has been proposed as a paradigm for severely paralyzed stroke and spinal cord injury survivors. Looking at a future application of our system, as of any other BMI, it will be critically important to avoid interference with functional structures of the sensory-motor apparatus.</p>
</sec></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pone.0091677-vonNeumann1"><label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">von Neumann J (1958) The computer and the brain: Yale University Press.</mixed-citation>
</ref>
<ref id="pone.0091677-Vidal1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vidal</surname><given-names>JJ</given-names></name> (<year>1973</year>) <article-title>Toward direct brain-computer communication</article-title>. <source>Annu Rev Biophys Bioeng</source> <volume>2</volume>: <fpage>157</fpage>–<lpage>180</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Chapin1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chapin</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Moxon</surname><given-names>KA</given-names></name>, <name name-style="western"><surname>Markowitz</surname><given-names>RS</given-names></name>, <name name-style="western"><surname>Nicolelis</surname><given-names>MA</given-names></name> (<year>1999</year>) <article-title>Real-time control of a robot arm using simultaneously recorded neurons in the motor cortex</article-title>. <source>Nat Neurosci</source> <volume>2</volume>: <fpage>664</fpage>–<lpage>670</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Wessberg1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wessberg</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Stambaugh</surname><given-names>CR</given-names></name>, <name name-style="western"><surname>Kralik</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Beck</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Laubach</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2000</year>) <article-title>Real-time prediction of hand trajectory by ensembles of cortical neurons in primates</article-title>. <source>Nature</source> <volume>408</volume>: <fpage>361</fpage>–<lpage>365</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Kim1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname><given-names>HK</given-names></name>, <name name-style="western"><surname>Carmena</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Biggs</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Hanson</surname><given-names>TL</given-names></name>, <name name-style="western"><surname>Nicolelis</surname><given-names>MA</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>The muscle activation method: an approach to impedance control of brain-machine interfaces through a musculoskeletal model of the arm</article-title>. <source>IEEE Trans Biomed Eng</source> <volume>54</volume>: <fpage>1520</fpage>–<lpage>1529</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Hauschild1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hauschild</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Mulliken</surname><given-names>GH</given-names></name>, <name name-style="western"><surname>Fineman</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Loeb</surname><given-names>GE</given-names></name>, <name name-style="western"><surname>Andersen</surname><given-names>RA</given-names></name> (<year>2012</year>) <article-title>Cognitive signals for brain-machine interfaces in posterior parietal cortex include continuous 3D trajectory commands</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>109</volume>: <fpage>17075</fpage>–<lpage>17080</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Chao1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chao</surname><given-names>ZC</given-names></name>, <name name-style="western"><surname>Bakkum</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Potter</surname><given-names>SM</given-names></name> (<year>2008</year>) <article-title>Shaping embodied neural networks for adaptive goal-directed behavior</article-title>. <source>PLoS Comput Biol</source> <volume>4</volume>: <fpage>e1000042</fpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-ODoherty1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>O’Doherty</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Lebedev</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Hanson</surname><given-names>TL</given-names></name>, <name name-style="western"><surname>Fitzsimmons</surname><given-names>NA</given-names></name>, <name name-style="western"><surname>Nicolelis</surname><given-names>MA</given-names></name> (<year>2009</year>) <article-title>A brain-machine interface instructed by direct intracortical microstimulation</article-title>. <source>Front Integr Neurosci</source> <volume>3</volume>: <fpage>20</fpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-ODoherty2"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>O’Doherty</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Lebedev</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Ifft</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Zhuang</surname><given-names>KZ</given-names></name>, <name name-style="western"><surname>Shokur</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Active tactile exploration using a brain-machine-brain interface</article-title>. <source>Nature</source> <volume>479</volume>: <fpage>228</fpage>–<lpage>231</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-MussaIvaldi1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name>, <name name-style="western"><surname>Alford</surname><given-names>ST</given-names></name>, <name name-style="western"><surname>Chiappalone</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Fadiga</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Karniel</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>New Perspectives on the Dialogue between Brains and Machines</article-title>. <source>Front Neurosci</source> <volume>4</volume>: <fpage>44</fpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Hill1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hill</surname><given-names>AV</given-names></name> (<year>1938</year>) <article-title>The Heat of Shortening and the Dynamic Constants of Muscle</article-title>. <source>Proceedings of the Royal Society of London Series B, Biological Sciences</source> <volume>126</volume>: <fpage>136</fpage>–<lpage>195</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Gordon1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gordon</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Huxley</surname><given-names>AF</given-names></name>, <name name-style="western"><surname>Julian</surname><given-names>FJ</given-names></name> (<year>1966</year>) <article-title>Tension development in highly stretched vertebrate muscle fibres</article-title>. <source>J Physiol</source> <volume>184</volume>: <fpage>143</fpage>–<lpage>169</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Rack1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rack</surname><given-names>PM</given-names></name>, <name name-style="western"><surname>Westbury</surname><given-names>DR</given-names></name> (<year>1969</year>) <article-title>The effects of length and stimulus rate on tension in the isometric cat soleus muscle</article-title>. <source>J Physiol</source> <volume>204</volume>: <fpage>443</fpage>–<lpage>460</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Nichols1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nichols</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Houk</surname><given-names>J</given-names></name> (<year>1976</year>) <article-title>Improvement in linearity and regulation of stiffness that results from actions of stretch reflex</article-title>. <source>Journal of Neurophysiology</source> <volume>39</volume>: <fpage>119</fpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Bizzi1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bizzi</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name>, <name name-style="western"><surname>Giszter</surname><given-names>S</given-names></name> (<year>1991</year>) <article-title>Computations underlying the execution of movement: a biological perspective</article-title>. <source>Science</source> <volume>253</volume>: <fpage>287</fpage>–<lpage>291</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Grillner1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grillner</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Matsushima</surname><given-names>T</given-names></name> (<year>1991</year>) <article-title>The neural network underlying locomotion in lamprey–synaptic and cellular mechanisms</article-title>. <source>Neuron</source> <volume>7</volume>: <fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Tresch1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tresch</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Jarc</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>The case for and against muscle synergies</article-title>. <source>Curr Opin Neurobiol</source> <volume>19</volume>: <fpage>601</fpage>–<lpage>607</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Sutton1"><label>18</label>
<mixed-citation publication-type="other" xlink:type="simple">Sutton RS, Barto AG (1998) Reinforcement learning: An introduction: Cambridge Univ Press.</mixed-citation>
</ref>
<ref id="pone.0091677-Bienenstock1"><label>19</label>
<mixed-citation publication-type="other" xlink:type="simple">Bienenstock E, Geman S (1995) Compositionality in Neural Systems. In: Arbib MA, editor. The Handbook of Brain Theory and Neural Networks. Cambridge, MA: MIT Press. 223–226.</mixed-citation>
</ref>
<ref id="pone.0091677-MussaIvaldi2"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name>, <name name-style="western"><surname>Bizzi</surname><given-names>E</given-names></name> (<year>2000</year>) <article-title>Motor learning through the combination of primitives</article-title>. <source>Philosophical Transactions of the Royal Society London B</source> <volume>355</volume>: <fpage>1755</fpage>–<lpage>1769</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Vato1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vato</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Semprini</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Maggiolini</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Szymanski</surname><given-names>FD</given-names></name>, <name name-style="western"><surname>Fadiga</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Shaping the dynamics of a bidirectional neural interface</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>e1002578</fpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Kim2"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname><given-names>SP</given-names></name>, <name name-style="western"><surname>Simeral</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Hochberg</surname><given-names>LR</given-names></name>, <name name-style="western"><surname>Donoghue</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Black</surname><given-names>MJ</given-names></name> (<year>2008</year>) <article-title>Neural control of computer cursor velocity by decoding motor cortical spiking activity in humans with tetraplegia</article-title>. <source>J Neural Eng</source> <volume>5</volume>: <fpage>455</fpage>–<lpage>476</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Houghton1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Houghton</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Sen</surname><given-names>K</given-names></name> (<year>2008</year>) <article-title>A new multineuron spike train metric</article-title>. <source>Neural Comput</source> <volume>20</volume>: <fpage>1495</fpage>–<lpage>1511</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Reich1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reich</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Mechler</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Victor</surname><given-names>JD</given-names></name> (<year>2001</year>) <article-title>Independent and redundant information in nearby cortical neurons</article-title>. <source>Science</source> <volume>294</volume>: <fpage>2566</fpage>–<lpage>2568</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Panzeri1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Petroni</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Petersen</surname><given-names>RS</given-names></name>, <name name-style="western"><surname>Diamond</surname><given-names>ME</given-names></name> (<year>2003</year>) <article-title>Decoding neuronal population activity in rat somatosensory cortex: role of columnar organization</article-title>. <source>Cereb Cortex</source> <volume>13</volume>: <fpage>45</fpage>–<lpage>52</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Victor1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Victor</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Purpura</surname><given-names>KP</given-names></name> (<year>1996</year>) <article-title>Nature and precision of temporal coding in visual cortex: a metric-space analysis</article-title>. <source>J Neurophysiol</source> <volume>76</volume>: <fpage>1310</fpage>–<lpage>1326</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-MussaIvaldi3"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name> (<year>1992</year>) <article-title>From basis functions to basis fields: vector field approximation from sparse data</article-title>. <source>Biol Cybern</source> <volume>67</volume>: <fpage>479</fpage>–<lpage>489</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Khatib1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khatib</surname><given-names>O</given-names></name> (<year>1986</year>) <article-title>Real-Time Obstacle Avoidance for Manipulators and Mobile Robots</article-title>. <source>The International Journal of Robotics Research</source> <volume>5</volume>: <fpage>90</fpage>–<lpage>98</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Ferezou1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ferezou</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Haiss</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Gentet</surname><given-names>LJ</given-names></name>, <name name-style="western"><surname>Aronoff</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Weber</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Spatiotemporal dynamics of cortical sensorimotor integration in behaving mice</article-title>. <source>Neuron</source> <volume>56</volume>: <fpage>907</fpage>–<lpage>923</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Chakrabarti1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chakrabarti</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Alloway</surname><given-names>KD</given-names></name> (<year>2008</year>) <article-title>MI neuronal responses to peripheral whisker stimulation: relationship to neuronal activity in si barrels and septa</article-title>. <source>J Neurophysiol</source> <volume>100</volume>: <fpage>50</fpage>–<lpage>63</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Szymanski1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Szymanski</surname><given-names>FD</given-names></name>, <name name-style="western"><surname>Semprini</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name>, <name name-style="western"><surname>Fadiga</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Dynamic Brain-Machine Interface: a novel paradigm for bidirectional interaction between brains and dynamical systems</article-title>. <source>Conf Proc IEEE Eng Med Biol Soc</source> <volume>2011</volume>: <fpage>4592</fpage>–<lpage>4595</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Maimon1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maimon</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Assad</surname><given-names>JA</given-names></name> (<year>2009</year>) <article-title>Beyond Poisson: increased spike-time regularity across primate parietal cortex</article-title>. <source>Neuron</source> <volume>62</volume>: <fpage>426</fpage>–<lpage>440</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Patil1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patil</surname><given-names>PG</given-names></name>, <name name-style="western"><surname>Turner</surname><given-names>DA</given-names></name> (<year>2008</year>) <article-title>The development of brain-machine interface neuroprosthetic devices</article-title>. <source>Neurotherapeutics</source> <volume>5</volume>: <fpage>137</fpage>–<lpage>146</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Thoroughman1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thoroughman</surname><given-names>KA</given-names></name>, <name name-style="western"><surname>Shadmehr</surname><given-names>R</given-names></name> (<year>2000</year>) <article-title>Learning of action through adaptive combination of motor primitives</article-title>. <source>Nature</source> <volume>407</volume>: <fpage>742</fpage>–<lpage>747</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Gandolfo1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gandolfo</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name>, <name name-style="western"><surname>Bizzi</surname><given-names>E</given-names></name> (<year>1996</year>) <article-title>Motor learning by field approximation</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>93</volume>: <fpage>3843</fpage>–<lpage>3846</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Grill1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grill</surname><given-names>WM</given-names></name>, <name name-style="western"><surname>Norman</surname><given-names>SE</given-names></name>, <name name-style="western"><surname>Bellamkonda</surname><given-names>RV</given-names></name> (<year>2009</year>) <article-title>Implanted neural interfaces: biochallenges and engineered solutions</article-title>. <source>Annu Rev Biomed Eng</source> <volume>11</volume>: <fpage>1</fpage>–<lpage>24</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Schwartz1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwartz</surname><given-names>AB</given-names></name> (<year>2007</year>) <article-title>Useful signals from motor cortex</article-title>. <source>J Physiol</source> <volume>579</volume>: <fpage>581</fpage>–<lpage>601</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Hochberg1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hochberg</surname><given-names>LR</given-names></name>, <name name-style="western"><surname>Bacher</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Jarosiewicz</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Masse</surname><given-names>NY</given-names></name>, <name name-style="western"><surname>Simeral</surname><given-names>JD</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Reach and grasp by people with tetraplegia using a neurally controlled robotic arm</article-title>. <source>Nature</source> <volume>485</volume>: <fpage>372</fpage>–<lpage>375</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Jackson1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jackson</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Fetz</surname><given-names>EE</given-names></name> (<year>2011</year>) <article-title>Interfacing with the computational brain</article-title>. <source>IEEE Trans Neural Syst Rehabil Eng</source> <volume>19</volume>: <fpage>534</fpage>–<lpage>541</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Zimmermann1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zimmermann</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Seki</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>A</given-names></name> (<year>2011</year>) <article-title>Reanimating the arm and hand with intraspinal microstimulation</article-title>. <source>J Neural Eng</source> <volume>8</volume>: <fpage>054001</fpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Hogan1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hogan</surname><given-names>N</given-names></name> (<year>1985</year>) <article-title>Impedance control: An approach to manipulation. Parts I, II, III</article-title>. <source>ASME Journal of Dynamic Systems, Measurement and Control</source> <volume>107</volume>: <fpage>1</fpage>–<lpage>24</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Karnopp1"><label>42</label>
<mixed-citation publication-type="other" xlink:type="simple">Karnopp DC, Margolis DL, Rosenberg RC (1990) System dynamics: a unified approach. New York: Wiley.</mixed-citation>
</ref>
<ref id="pone.0091677-Hogan2"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hogan</surname><given-names>N</given-names></name> (<year>1985</year>) <article-title>The mechanics of multi-joint posture and movement control</article-title>. <source>Biol Cybern</source> <volume>52</volume>: <fpage>315</fpage>–<lpage>331</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Giszter1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Giszter</surname><given-names>SF</given-names></name>, <name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name>, <name name-style="western"><surname>Bizzi</surname><given-names>E</given-names></name> (<year>1993</year>) <article-title>Convergent force fields organized in the frog’s spinal cord</article-title>. <source>J Neurosci</source> <volume>13</volume>: <fpage>467</fpage>–<lpage>491</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-MussaIvaldi4"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name>, <name name-style="western"><surname>Giszter</surname><given-names>SF</given-names></name>, <name name-style="western"><surname>Bizzi</surname><given-names>E</given-names></name> (<year>1994</year>) <article-title>Linear combinations of primitives in vertebrate motor control</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>91</volume>: <fpage>7534</fpage>–<lpage>7538</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Tresch2"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tresch</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Bizzi</surname><given-names>E</given-names></name> (<year>1999</year>) <article-title>Responses to spinal microstimulation in the chronically spinalized rat and their relationship to spinal systems activated by low threshold cutaneous stimulation</article-title>. <source>Exp Brain Res</source> <volume>129</volume>: <fpage>401</fpage>–<lpage>416</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Sherrington1"><label>47</label>
<mixed-citation publication-type="other" xlink:type="simple">Sherrington CS (1906) The Integrative Action of the Nervous System: Yale University Press.</mixed-citation>
</ref>
<ref id="pone.0091677-Kayser1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kayser</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Logothetis</surname><given-names>NK</given-names></name>, <name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Visual enhancement of the information representation in auditory cortex</article-title>. <source>Curr Biol</source> <volume>20</volume>: <fpage>19</fpage>–<lpage>24</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Hatsopoulos1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hatsopoulos</surname><given-names>NG</given-names></name>, <name name-style="western"><surname>Ojakangas</surname><given-names>CL</given-names></name>, <name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Donoghue</surname><given-names>JP</given-names></name> (<year>1998</year>) <article-title>Information about movement direction obtained from synchronous activity of motor cortical neurons</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>95</volume>: <fpage>15706</fpage>–<lpage>15711</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Petersen1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Petersen</surname><given-names>RS</given-names></name>, <name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Diamond</surname><given-names>ME</given-names></name> (<year>2001</year>) <article-title>Population coding of stimulus location in rat somatosensory cortex</article-title>. <source>Neuron</source> <volume>32</volume>: <fpage>503</fpage>–<lpage>514</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Golledge1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Golledge</surname><given-names>HD</given-names></name>, <name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Zheng</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Pola</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Scannell</surname><given-names>JW</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Correlations, feature-binding and population coding in primary visual cortex</article-title>. <source>Neuroreport</source> <volume>14</volume>: <fpage>1045</fpage>–<lpage>1050</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Scaglione1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scaglione</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Moxon</surname><given-names>KA</given-names></name>, <name name-style="western"><surname>Aguilar</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Foffani</surname><given-names>G</given-names></name> (<year>2011</year>) <article-title>Trial-to-trial variability in the responses of neurons carries information about stimulus location in the rat whisker thalamus</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>14956</fpage>–<lpage>14961</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Fetz1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fetz</surname><given-names>EE</given-names></name>, <name name-style="western"><surname>Finocchio</surname><given-names>DV</given-names></name> (<year>1971</year>) <article-title>Operant conditioning of specific patterns of neural and muscular activity</article-title>. <source>Science</source> <volume>174</volume>: <fpage>431</fpage>–<lpage>435</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Black1"><label>54</label>
<mixed-citation publication-type="other" xlink:type="simple">Black AH (1972) The operant conditioning of central nervous system electrical activity. In: Bower GH, editor. The Psychology of Learning and Motivation. New York: Academic Press. 47–95.</mixed-citation>
</ref>
<ref id="pone.0091677-Sherrington2"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sherrington</surname><given-names>CS</given-names></name> (<year>1910</year>) <article-title>Flexion-reflex of the limb, crossed extension-reflex, and reflex stepping and standing</article-title>. <source>J Physiol</source> <volume>40</volume>: <fpage>28</fpage>–<lpage>121</lpage>.</mixed-citation>
</ref>
<ref id="pone.0091677-Evarts1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Evarts</surname><given-names>EV</given-names></name>, <name name-style="western"><surname>Fromm</surname><given-names>C</given-names></name> (<year>1981</year>) <article-title>Transcortical reflexes and servo control of movement</article-title>. <source>Can J Physiol Pharmacol</source> <volume>59</volume>: <fpage>757</fpage>–<lpage>775</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>