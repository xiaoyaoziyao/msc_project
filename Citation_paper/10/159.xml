<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0196004</article-id>
<article-id pub-id-type="publisher-id">PONE-D-17-36914</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Plants</subject><subj-group><subject>Trees</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Remote sensing</subject><subj-group><subject>Lidar</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Terrestrial environments</subject><subj-group><subject>Urban environments</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Plant science</subject><subj-group><subject>Dendrology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Multivariate analysis</subject><subj-group><subject>Principal component analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Multivariate analysis</subject><subj-group><subject>Principal component analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Urban ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Urban ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Remote sensing</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Automatic tree parameter extraction by a Mobile LiDAR System in an urban context</article-title>
<alt-title alt-title-type="running-head">Automatic tree parameter extraction by a Mobile LiDAR System in an urban context</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4134-557X</contrib-id>
<name name-style="western">
<surname>Herrero-Huerta</surname>
<given-names>Mónica</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Lindenbergh</surname>
<given-names>Roderik</given-names>
</name>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Rodríguez-Gonzálvez</surname>
<given-names>Pablo</given-names>
</name>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Geoscience and Remote Sensing, Delft University of Technology, Delft, The Netherlands</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>TIDOP Research Group, Higher Polytechnic School of Avila, University of Salamanca, Avila, Spain</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Agronomy, Purdue University, West-Lafayette, Indiana, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Department of Mining Technology, Topography and Structures, Universidad de León, Ponferrada, Spain</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Loiselle</surname>
<given-names>Steven Arthur</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Siena, ITALY</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">monicaherrero@usal.es</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>24</day>
<month>4</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<year>2018</year>
</pub-date>
<volume>13</volume>
<issue>4</issue>
<elocation-id>e0196004</elocation-id>
<history>
<date date-type="received">
<day>14</day>
<month>10</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>4</day>
<month>4</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Herrero-Huerta et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0196004"/>
<abstract>
<p>In an urban context, tree data are used in city planning, in locating hazardous trees and in environmental monitoring. This study focuses on developing an innovative methodology to automatically estimate the most relevant individual structural parameters of urban trees sampled by a Mobile LiDAR System at city level. These parameters include the Diameter at Breast Height (DBH), which was estimated by circle fitting of the points belonging to different height bins using RANSAC. In the case of non-circular trees, DBH is calculated by the maximum distance between extreme points. Tree sizes were extracted through a connectivity analysis. Crown Base Height, defined as the length until the bottom of the live crown, was calculated by voxelization techniques. For estimating Canopy Volume, procedures of mesh generation and α-shape methods were implemented. Also, tree location coordinates were obtained by means of Principal Component Analysis. The workflow has been validated on 29 trees of different species sampling a stretch of road 750 m long in Delft (The Netherlands) and tested on a larger dataset containing 58 individual trees. The validation was done against field measurements. DBH parameter had a correlation R<sup>2</sup> value of 0.92 for the height bin of 20 cm which provided the best results. Moreover, the influence of the number of points used for DBH estimation, considering different height bins, was investigated. The assessment of the other inventory parameters yield correlation coefficients higher than 0.91. The quality of the results confirms the feasibility of the proposed methodology, providing scalability to a comprehensive analysis of urban trees.</p>
</abstract>
<funding-group>
<funding-statement>The research is partly funded by the FP7 project IQmulus (FP7-ICT-2011-318787), aiming at the design and implementation of a high volume fusion and analysis Platform for geospatial point clouds, coverages and volumetric data sets.</funding-statement>
</funding-group>
<counts>
<fig-count count="11"/>
<table-count count="9"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Tree inventory information and monitoring tree changes over time are critical input for tree management systems, ecosystem services and aboveground biomass estimation. This information could also show the ecosystem influence on climate change, carbon and water cycling [<xref ref-type="bibr" rid="pone.0196004.ref001">1</xref>]. Furthermore, the canopy structure affects the radiation regime and other biochemical and ecological processes. In an urban context, tree register data is used in city and environmental planning, in deriving and modelling urban pollution and temperatures, in locating hazardous trees and for biodiversity monitoring [<xref ref-type="bibr" rid="pone.0196004.ref002">2</xref>]. Recently, the municipality of Delft (The Netherlands) has opened a data-base where all the trees from the urban area of Delft are listed with properties as location, DBH range, dimension range, species health conditions, year of plantation and inspection date [<xref ref-type="bibr" rid="pone.0196004.ref003">3</xref>].</p>
<p>Dendometric variables have traditionally been estimated with field campaigns. The advent of recent remote and near sensing technologies has opened up a new field of possibilities for carrying out such work through non-destructive methods, providing advantages regarding the economic costs involved, the time invested and the quality of results [<xref ref-type="bibr" rid="pone.0196004.ref004">4</xref>]. In that sense, the use of active high-resolution sensors, such as Light Detection and Ranging (LiDAR) enables high accuracy in estimation of tree parameters. This active remote sensing technology based on the principle of laser ranging [<xref ref-type="bibr" rid="pone.0196004.ref005">5</xref>], provides precise and efficient information on the horizontal and vertical distribution of vegetation and canopy structure. Many studies also use other data sources, such as digital aerial photographs [<xref ref-type="bibr" rid="pone.0196004.ref006">6</xref>] or combine high resolution and hyperspectral images with LiDAR data in urban vegetation mapping [<xref ref-type="bibr" rid="pone.0196004.ref007">7</xref>]. A comprehensive review of the application of LiDAR remote sensing for the retrieval of forest structural parameters at different scales is provided by [<xref ref-type="bibr" rid="pone.0196004.ref008">8</xref>].</p>
<p>More recently, Mobile LiDAR Systems (MLS) have emerged as an excellent tool to assess urban structural tree parameters and the distribution of their constituents, enabling fast and accurately capturing of 3D data of individual trees with high spatial detail along the road [<xref ref-type="bibr" rid="pone.0196004.ref009">9</xref>]. However, the size of the data files can be considerable, complicating the handling and storage of 3D information and requiring long processing times. MLS operates at a scale between manual and airborne LiDAR measurements and has better acquisition geometry for trees. Indeed, airborne LiDAR has a limited ability to sample the vertical distribution of the canopy [<xref ref-type="bibr" rid="pone.0196004.ref010">10</xref>] by the narrow near nadir scan angle and density of vegetation causing occlusions. Since a MLS involves several sensors to acquire a georeferenced 3D point cloud, the final precision includes individual error sources, like LiDAR, Inertial measurement unit (IMU) and global navigation satellite systems (GNSS). Comparisons proved that an accuracy better than 3 cm (standard deviation of the differences between measured and reference data) can be achieved by the system in good GNSS conditions [<xref ref-type="bibr" rid="pone.0196004.ref011">11</xref>]. The main disadvantage of MLS of having no-access to non-transitable areas is being dismissed by the new developments of MLS boarded in a backpack [<xref ref-type="bibr" rid="pone.0196004.ref012">12</xref>]. However these solutions are still being tested in terms of precision and performance in different scenarios. Another related technology is Terrestrial Laser Scanner (TLS), which has been employed for mapping vegetation properties and tree reconstruction [<xref ref-type="bibr" rid="pone.0196004.ref013">13</xref>]. But it is time-consuming compared with MLS in an urban context. Henning et al. [<xref ref-type="bibr" rid="pone.0196004.ref014">14</xref>] applied a TLS in a study area of 20x40 m<sup>2</sup> in a species-limited and non-urban context. However, the completeness of the tree representation might be less for MLS compared to TLS campaigns, where trees are typically scanned from multiple positions.</p>
<p>Diameter at Breast Height (DBH) is considered an essential parameter in tree allometry. Many countries store the DBH of urban trees in cadaster databases for monitoring purposes [<xref ref-type="bibr" rid="pone.0196004.ref003">3</xref>]. Several studies estimated DBH from TLS [<xref ref-type="bibr" rid="pone.0196004.ref015">15</xref>] and airborne LiDAR [<xref ref-type="bibr" rid="pone.0196004.ref016">16</xref>]. MLS data has already been used to estimate stem diameter in a forest environment from the intensity captured by the laser from different echoes, reaching a RMSE of 14% [<xref ref-type="bibr" rid="pone.0196004.ref017">17</xref>]. Other critical measurements are Tree Height (TH) and Base Crown Volume (BCV) that afford qualitative information about the stand and quantitative tree information. Correlation with <italic>in situ</italic> data with TLS based DBH and TH were reported to be between 0.91 and 0.97 and 0.92, respectively [<xref ref-type="bibr" rid="pone.0196004.ref015">15</xref>]. The tree stem curve could help to describe the BCV, specifying the stem tapering as a function of the height. Another key parameter is the Crown Base Height (CBH) normally used in fire modelling, which can be estimated from airborne LiDAR data through voxelization techniques based on moving voxels [<xref ref-type="bibr" rid="pone.0196004.ref018">18</xref>]. However, estimating CBH is a challenging task because, normally, it is difficult to measure it in the field. A novel method to obtain these tree parameters from MLS data is developed by [<xref ref-type="bibr" rid="pone.0196004.ref019">19</xref>] using voxelization techniques reaching a R<sup>2</sup> value of over 0.8.</p>
<p>The accurate measurement of canopy architecture and tree crown parameters such as Crown Width (CW) or Canopy Volume (CV) is critical for plant physiology and vegetal health monitoring, typically related to photosynthesis and energy transfer. To date, little research has been done to retrieve Crown Width using TLS [<xref ref-type="bibr" rid="pone.0196004.ref020">20</xref>] and the estimations with airborne LiDAR reach coefficients of determination as low as 0.63 [<xref ref-type="bibr" rid="pone.0196004.ref007">7</xref>]. Moreover, several studies have been focused on modelling the canopy to estimate tree crown variables using TLS and airborne LiDAR [<xref ref-type="bibr" rid="pone.0196004.ref021">21</xref>]. <xref ref-type="fig" rid="pone.0196004.g001">Fig 1</xref> represents a schematic cartoon of the mentioned tree parameters.</p>
<fig id="pone.0196004.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Schema of tree parameters.</title>
<p>Location coordinates (x, y), Tree Height (TH), Crown Width (CW), Diameter at Breast Height (DBH), Crown Base Height (CBH), Base Crown Volume (BCV) and Canopy Volume (CV).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g001" xlink:type="simple"/>
</fig>
<p>The aim of the present work is to develop an efficient and precise methodology to obtain structural parameters of individual trees in urban inventories at city level based on point clouds derived from MLS. For the extraction of individual trees, the pipeline shown and tested in [<xref ref-type="bibr" rid="pone.0196004.ref022">22</xref>] at large scales is employed. However this initial approach only estimated tree size and location. The methodology proposed here has to face difficulties due to the variable driving speed (different point density) and the specific acquisition geometry of the MLS technology, resulting in partial 3D data (only one side view), and presence of noise in the data. Occluding vegetation may lead to underestimation of selected parameters compared to manually collected field data [<xref ref-type="bibr" rid="pone.0196004.ref023">23</xref>]. In this work, the following parameters are estimated: location coordinates, Tree Height (TH), Crown Width (CW), Diameter at Breast Height (DBH), Crown Base Height (CBH), Base Crown Volume (BCV) and Canopy Volume (CV). More concretely, a connectivity analysis is performed to calculate TH and CW; voxelization technique is employed to estimate CBH. From these parameters, the stem curve is computed until CBH. A RANSAC-based fitting in conjunction with a dimensional analysis of the variance covariance matrix by Principal Component Analysis (PCA) is used to estimate tree location, tree orientation and DBH. CV is obtained by canopy meshing followed by an α-shape refinement step. To validate the methodology, field measurements were taken from 29 trees of different species. Furthermore, this workflow was tested on an additional dataset which contains 58 trees in order to provide scalability. Additionally, the influence of the number of points from different height bins on the accuracy of DBH estimations was investigated.</p>
<p>The proposed methodology is part of a robust and efficient workflow which considers the automated extraction of tree parameters, and which has been implemented in the infrastructure of the FP7 IQmulus project, as part of the so-called urban showcase [<xref ref-type="bibr" rid="pone.0196004.ref024">24</xref>].</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec003">
<title>Acquisition system</title>
<p>The acquisition system used in this work is the Fugro Drivemap system, shown in <xref ref-type="fig" rid="pone.0196004.g002">Fig 2</xref>. This MLS is composed of two high performance Riegl VQ250 laser scanners, an all-terrain vehicle and a navigation system. The navigation system of the vehicle is the Applanix POS LV 520 that integrates a GNSS receiver, an IMU and a distance measuring instrument. The IMU defines the centre of the vehicle coordinate system and, accordingly, the other sensors were aligned with it. The GNSS positioning system is used for mapping vehicle local coordinates to absolute coordinates with a planimetric precision of about 0.02 m. It should be noted that precision properties are highly dependent on GNSS availability, which can be considered good for this study. The GNSS-receiver has 10 Hz positioning rate and the laser technical specifications are defined in <xref ref-type="table" rid="pone.0196004.t001">Table 1</xref>.</p>
<table-wrap id="pone.0196004.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.t001</object-id>
<label>Table 1</label> <caption><title>Technical specifications of the Mobile LiDAR System.</title></caption>
<alternatives>
<graphic id="pone.0196004.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Parameter</th>
<th align="center">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Laser Pulse Rate</td>
<td align="left">0.133·10<sup>6</sup> pulses / s</td>
</tr>
<tr>
<td align="left">Laser Point Density</td>
<td align="left">115000 points / m<sup>2</sup></td>
</tr>
<tr>
<td align="left">Field of View</td>
<td align="left">360<sup>0</sup> * 0.0023<sup>0</sup></td>
</tr>
<tr>
<td align="left">Ranging Accuracy</td>
<td align="left">&lt; 2 cm</td>
</tr>
<tr>
<td align="left">Sweep Angle</td>
<td align="left">360<sup>0</sup></td>
</tr>
<tr>
<td align="left">Maximum Range</td>
<td align="left">30 m (0.10 reflectivity)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pone.0196004.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Fugro Drive-map system used for the data acquisition (a) and its LiDAR System (b) (source: Fugro).</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>Methodology for estimating structural tree parameters</title>
<p>The proposed methodology aims at extracting structural tree parameters derived from MLS data. Before estimating these parameters, the extraction of individual trees from the point cloud is necessary through an automated workflow by voxel analysis, as explained in [<xref ref-type="bibr" rid="pone.0196004.ref025">25</xref>]. Assuming a point cloud consists of a number of separated trees, the following steps are performed for each individual tree, as <xref ref-type="fig" rid="pone.0196004.g003">Fig 3</xref> illustrates.</p>
<fig id="pone.0196004.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Workflow of the methodology for structural tree parameter extraction; scheme (Fig 3a) and illustrated workflow (Fig 3b).</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g003" xlink:type="simple"/>
</fig>
<p>The proposed methodology was implemented in C++ using Point Cloud Library (PCL) [<xref ref-type="bibr" rid="pone.0196004.ref026">26</xref>] and compiled and run on the Ubuntu 14.04 64-bit operating system. The computational cost of the algorithm regarding the run time can be defined as a real time process. For the α-shape calculations, the open-source 3D mesh processing system is used [<xref ref-type="bibr" rid="pone.0196004.ref027">27</xref>].</p>
<sec id="sec005">
<title>Outlier removal</title>
<p>The point cloud sample may contain outliers and noisy points caused by interference effects (persons, vehicles,…). Such points are not regarded as samples of actual trees and the first step is to filter them from the point cloud. To remove isolated points or small point clusters, a statistical analysis on each point’s neighbourhood is performed by assuming a Gaussian distribution of neighbours’ distances (<italic>d</italic>). This distances are weighting with the variable point densities due to the combined effect of the distance to the sensor, occlusions and driving speed. So, for each MLS point, the average distance to its <italic>k</italic>-nearest neighbours are computed and evaluated against the Upper Confidence Limit (UCL) of a normal error distribution. A <italic>j</italic>-th point (<italic>j</italic> = 1…<italic>k</italic>) will be excluded as outlier if the ratio between their distance and the UCL, for a given confidence level (<italic>p</italic>), is higher than 1, as is shown in (<xref ref-type="disp-formula" rid="pone.0196004.e001">1</xref>).
<disp-formula id="pone.0196004.e001">
<alternatives>
<graphic id="pone.0196004.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0196004.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
where <inline-formula id="pone.0196004.e002"><alternatives><graphic id="pone.0196004.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0196004.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and σ<sub>d</sub> are the mean and standard deviation of the distances to the <italic>k</italic>-nearest neighbours in the evaluated point vicinity (<italic>j</italic> = 1…<italic>k</italic>) respectively. The confidence level (<italic>p</italic>) is expressed as the critical value associated in the standard normal density curve.</p>
</sec>
<sec id="sec006">
<title>Tree Height (TH) and Crown Width (CW)</title>
<p>Starting from the point clouds of each individual tree, Tree Height and Crown Width are estimated by extracting the minimal and maximal points in the three Cartesian coordinate directions from the MLS dataset, taking into account the point cloud density and their connectivity [<xref ref-type="bibr" rid="pone.0196004.ref028">28</xref>]. These extreme points should be computed from a minimum sample size (spatial resolution) and the distance between the closest voxels should be less than a predefined threshold (spatial connectivity).</p>
</sec>
<sec id="sec007">
<title>Crown Base Height (CBH)</title>
<p>For this parameter, individual trees are uniformly downsampled through a 3D voxel data structure (<xref ref-type="fig" rid="pone.0196004.g003">Fig 3</xref>, step A).</p>
<p>The voxels are defined by the side of the cube, which is directly related to the a-priori spatial resolution of the MLS data. As results, the originally gathered points are substituted by the coordinates of the voxel center defined by the mean of the points in the voxel generating a new 3D model space. The advantages of using voxels is that their use reduces the computational time of the subsequent steps and decreases the effects of tree branches.</p>
<p>The tree vertical distribution is characterized by the voxel distribution along the Z axis (since trees are vertically oriented). For each vertical interval, the number of LiDAR hits is accumulated (<xref ref-type="fig" rid="pone.0196004.g003">Fig 3</xref>, step A). As result, a histogram of the vertical distribution is generated [<xref ref-type="bibr" rid="pone.0196004.ref029">29</xref>]. The CBH is defined as the lowest inflexion point of the histogram (the inflexion of a curve is a point where the curvature changes its sign while a tangent exists) under the null hypothesis that the lowest living branch belongs to the crown. As a result, the trunk can be separated from the canopy using the estimated CBH value.</p>
</sec>
<sec id="sec008">
<title>Trunk orientation by PCA</title>
<p>In MLS data, trunks are not necessarily orthogonal to the XY plane, as many trees have a more or less tilted trunk. In order to assess the trunk direction, the trunk 3D points bounded by the ground and the CBH (<xref ref-type="fig" rid="pone.0196004.g003">Fig 3</xref>, step B) are evaluated by a PCA algorithm [<xref ref-type="bibr" rid="pone.0196004.ref030">30</xref>]. Hereafter, the 3D voxel data structure will not be used anymore, but we return to the original point cloud data. This statistical analysis uses the first and second moments of these points and results in three orthogonal vectors centred on the centroid of the point cloud. The PCA synthesizes the distribution of points along the three dimensions, and therefore models the principal directions and magnitudes of variation of the point distribution around the centre of gravity.</p>
<p>Considering a 3D point cloud with <italic>k</italic> points sampling the trunk surface, the coordinates <italic>xi</italic>, <italic>y</italic><sub><italic>i</italic></sub> and <italic>z</italic><sub><italic>i</italic></sub> for each point <italic>i = 1</italic>,… <italic>k</italic> are collected in a matrix <italic>X</italic> (<xref ref-type="disp-formula" rid="pone.0196004.e003">2</xref>).</p>
<disp-formula id="pone.0196004.e003">
<alternatives>
<graphic id="pone.0196004.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0196004.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>X</mml:mtext></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<p>The covariance matrix (Σ) of the trunk point cloud (X) is defined by:
<disp-formula id="pone.0196004.e004">
<alternatives>
<graphic id="pone.0196004.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0196004.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:mo>∑</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi></mml:mrow><mml:mtext>k</mml:mtext></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
<disp-formula id="pone.0196004.e005">
<alternatives>
<graphic id="pone.0196004.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0196004.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
<disp-formula id="pone.0196004.e006">
<alternatives>
<graphic id="pone.0196004.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0196004.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow/></mml:msubsup><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where <italic>E(j)</italic> is the expected value of the <italic>j</italic>-th dimension, (<italic>σ</italic><sup>2</sup><sub><italic>x</italic></sub>, <italic>σ</italic><sup>2</sup><sub><italic>y</italic></sub>, <italic>σ</italic><sup>2</sup><sub><italic>z</italic></sub>) are the variances of the variables, and the elements outside the main diagonal of Σ are the covariances for each pair of variables. The principal trunk direction is defined as the first eigenvector of the covariance matrix.</p>
</sec>
<sec id="sec009">
<title>DBH and tree location through RANSAC</title>
<p>Due to possible variation of spatial resolution of the MLS points, different bins or intervals are considered to achieve a robust estimation of the DBH parameter. More concretely, with respect to the ground level, Z = 0, trunk points have been extracted from the following vertical bin intervals: (a) 1.25–1.35 m; (b) 1.20–1.40 m; (c) 1.10–1.50 m and (d) 1.00–1.60 m. The selected points are projected into a plane orthogonal to the axis corresponding to the principal direction of the trunk (see previous step), under the hypothesis that the diameter does not vary significantly along a short length of the stem for mature trees.</p>
<p>DBH is estimated by means of RANSAC (RANdom SAmple Consensus) circle fitting. This estimator has favourable properties such as robustness, generality and simplicity. RANSAC extracts arbitrary primitive types by randomly drawing minimal sets from the point data and is reliable even in the presence of a considerable proportion of outliers [<xref ref-type="bibr" rid="pone.0196004.ref031">31</xref>]. In an iterative process, a minimal set of points is randomly selected to define the geometric primitive, which is evaluated against the sample. The number of required iterations depends on the probability to find an outlier free sample. The thereshold that defines if a point is considered an inlier is based on the a-priori MLS error, as specified by the MLS manufacturer. Circle fitting is applied to the reference XY plane defined by the PCA approach to estimate DBH (<xref ref-type="fig" rid="pone.0196004.g003">Fig 3</xref>, step C). This procedure fits a partially sampled circle. First, points from the selected DBH bin are projected to the reference xy plane, obtained for the PCA approach. The projected points outline a partially sampled circle. Next, the tree location is defined as the projection of the derived circle centre in the trunk’s principal direction by its intersecting with the terrain. The diameter of this circle is estimated using RANSAC. The diameter is an estimator of the DBH.</p>
</sec>
<sec id="sec010">
<title>Stem curve and Base Crown Volume (BCV)</title>
<p>The stem curve is automatically derived from the point cloud, between the minimum height and CBH starting from diameters at 0.65 meter above the ground, followed by diameters at the DBH height and consecutively at every meter above the DBH height until the CBH is reached. To determine the diameter at different heights, the RANSAC circle fitting approach is followed, estimating circle parameters of the projected trunk points at 0.20 m interval size. As a constraint, the diameter is required to remain constant or decrease with increasing height.</p>
<p>The BCV (dm<sup>3</sup>) is computed from the stem curve, summing the volume of each stem section, as shown in (<xref ref-type="disp-formula" rid="pone.0196004.e007">6</xref>):
<disp-formula id="pone.0196004.e007">
<alternatives>
<graphic id="pone.0196004.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0196004.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mrow><mml:mn>40</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>D</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⋅</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>65</mml:mn><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mi>π</mml:mi><mml:mrow><mml:mn>160</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
where <italic>m</italic> is the number of stem sections, <italic>v</italic><sub><italic>i</italic></sub> is the volume of the <italic>i-th</italic> stem section in dm<sup>3</sup>, <italic>D</italic><sub><italic>i</italic></sub> is the diameter of the end of the <italic>i-th</italic> section in cm, and <italic>l</italic><sub><italic>i</italic></sub> is the length of the <italic>i-th</italic> stem section in m. <xref ref-type="disp-formula" rid="pone.0196004.e007">Eq (6)</xref> assumes that the cross-section of the tree stem is circular. In fact, tree stem shapes exhibit an abundant variety since different tree species have diverse forms and irregularities such as knots and bulges. However the circular shape is most often employed to generalize the stem sections when the tree trunk is modelled [<xref ref-type="bibr" rid="pone.0196004.ref032">32</xref>].</p>
</sec>
<sec id="sec011">
<title>Canopy Volume (CV) by generating a canopy mesh</title>
<p>The foliage pattern elements are important for understanding the radiation regime and canopy structure. LiDAR systems acquire detailed measurements corresponding to the 3D distribution of canopy components [<xref ref-type="bibr" rid="pone.0196004.ref033">33</xref>]. However, the acquisition is only partial due to the one-sided field of view of the MLS. This subsection is devoted to synthesize and quantify the canopy shape (canopy volume—CV) from the MLS partial point clouds of the individual trees.</p>
<p>The approach is supported by 3D modelling of the point cloud of the canopy by a 3D Delaunay triangulation (DT) [<xref ref-type="bibr" rid="pone.0196004.ref034">34</xref>]. The result is a triangulated irregular network (TIN) which requires a filter phase to obtain a tree canopy model close to reality. The approximation shown in [<xref ref-type="bibr" rid="pone.0196004.ref035">35</xref>] is used in this step which incorporates several automatic and sequential tasks:</p>
<list list-type="bullet">
<list-item><p>Hole filling based on interpolators of radial basis function [<xref ref-type="bibr" rid="pone.0196004.ref036">36</xref>].</p></list-item>
<list-item><p>Fill meshing gaps, based on minimum threshold distance algorithms.</p></list-item>
<list-item><p>Removal of topological noise, allowing the mesh to be re-triangulated locally.</p></list-item>
<list-item><p>Removal of geometric noise by algorithms that apply filters such as anti-aliased Laplacians in general or in specific zones [<xref ref-type="bibr" rid="pone.0196004.ref037">37</xref>].</p></list-item>
</list>
<p>Once the canopy mesh is reconstructed (<xref ref-type="fig" rid="pone.0196004.g003">Fig 3</xref>, step D), an approximate envelop of the mesh is computed using α-shape techniques [<xref ref-type="bibr" rid="pone.0196004.ref038">38</xref>]. The intermediate step of calculating the canopy mesh, improves the efficiency of the α-shape processing of the dense point cloud of the canopy.</p>
<p>An α-shape is a family of piecewise parametric simple curves in Euclidean space associated with a set of points. The α-shape of a finite point set is a polytope that is uniquely determined by the set and a real number α ϵ [0, ∞], being in the extreme case (α = ∞) coincident with the convex hull. As the real number approaches zero, the α-shape develops cavities that could be converted in tunnels or holes. It expresses the intuitive notion of the shape of the point set and α is a parameter that controls the level of detail reflected by the polytope, that is to say, the maximum “curvature” of any cavity. As a result, the α-shape is homeomorphic to the original object sampled by the point cloud and approximates it within a fixed error bound.</p>
<p>As MLS only provides a partial view, the recovery of the non-visible side is achieved through symmetry, estimating the symmetry axis by a 180° field of view from the tree location. The hidden side of the canopy is closed by a flat surface. Finally, the canopy shape is obtained (<xref ref-type="fig" rid="pone.0196004.g003">Fig 3</xref>, step E) which allows the direct estimation of the CV.</p>
</sec>
<sec id="sec012">
<title>Quality control</title>
<p>To validate and to assess the proposed methodology, different statistical evaluations are carried out (<xref ref-type="fig" rid="pone.0196004.g003">Fig 3</xref>, step F). The key parameter assessed is the DBH, since it is linked to various tree attributes. For DBH, the ground truth was acquired on location by tape in May 2016. The estimated accuracy of these measurements is reported as ±0.1 cm [<xref ref-type="bibr" rid="pone.0196004.ref039">39</xref>]. The protocol carried out in this field campaign was supported by [<xref ref-type="bibr" rid="pone.0196004.ref040">40</xref>]. The quality of the remaining parameters is assessed by TLS, measuring the trees in high-resolution from multiple directions to obtain complete and dense, high quality point clouds. This part of the field validation campaign was carried out in December 2016 (same phenotypic epoch as dataset 1) using a Leica Scan Station C10 TLS. The single point range accuracy of the Leica Scan Station C10 is reported to be 0.4 cm [<xref ref-type="bibr" rid="pone.0196004.ref041">41</xref>]. Between November 2015 and December 2016, no maintenance was done to these urban trees, guaranteeing similar tree parameters. A point cloud data expert estimated high quality parameter values from the TLS point clouds in a suitable graphical user interface.</p>
<p>The quality of the estimated parameters is expressed by the Squared Pearson Correlation Coefficient, or coefficient of determination (R<sup>2</sup>) and the Root Mean Square Error (RMSE) of the linear regression established between actual and estimated parameters. The Pearson correlation coefficient (R) only measures the precision of a linear relationship [<xref ref-type="bibr" rid="pone.0196004.ref042">42</xref>]. Also employed is Lin’s concordance correlation coefficient (CCC) [<xref ref-type="bibr" rid="pone.0196004.ref043">43</xref>] for assessing the agreement between quantitative measurements taken from different sources [<xref ref-type="bibr" rid="pone.0196004.ref044">44</xref>]. As result, it allows to evaluate reproducibility. At this point CCC (<xref ref-type="disp-formula" rid="pone.0196004.e008">7</xref>) measures also the accuracy, yielding a value between -1 and 1, where 1 indicates a perfect agreement. It is computed as:
<disp-formula id="pone.0196004.e008">
<alternatives>
<graphic id="pone.0196004.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0196004.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mrow><mml:mtext>CCC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>2</mml:mtext><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>xy</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>x</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>y</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>2</mml:mtext></mml:msup></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
where σ<sub>xy</sub>, σ<sub>x</sub><sup>2</sup>, σ <sub>y</sub><sup>2</sup>, μ<sub>x</sub> and μ<sub>x</sub> are the covariance, variances and means of the evaluated variables.</p>
<p>The RMSE provided by the regression is only valid if the sample follows a Gaussian distribution. So, the error sample is assessed by a Robust Jarque-Bera [<xref ref-type="bibr" rid="pone.0196004.ref045">45</xref>] normality test, implemented in the statistical software STAR (Statistics Tests for Analyzing of Residuals) [<xref ref-type="bibr" rid="pone.0196004.ref046">46</xref>]. In case the error sample does not follow the Gaussian hypothesis, the normalized median absolute deviation (NMAD) (<xref ref-type="disp-formula" rid="pone.0196004.e009">8</xref>) is employed as a robust estimator of error dispersion.</p>
<disp-formula id="pone.0196004.e009">
<alternatives>
<graphic id="pone.0196004.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0196004.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:mrow><mml:mtext>NMAD</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>4826</mml:mn><mml:mo>⋅</mml:mo><mml:mtext>MAD</mml:mtext></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
<p>The NMAD allows to compare error dispersions from Gaussian samples, since it is normalized by the inverse of the cumulative distribution function of the Gaussian distribution (1.4826).</p>
</sec>
</sec>
</sec>
<sec id="sec013" sec-type="results">
<title>Results</title>
<sec id="sec014">
<title>Study area and field protocol</title>
<p>The study area is located at the Delft University of Technology campus (lat. 52°00′ N; long. 4°22′ E; 1 m a.s.l., The Netherlands) and tree species studied are <italic>Aesculus hippocastanun</italic> and <italic>Quercus palustris</italic>. Both species are deciduous and synoecious trees, widely cultivated in streets and parks throughout the temperate world. The acquisition was carried out at a medium speed of 40 km/h, with non-significant speed variation in the data adquisition. In order to get accurate and comparable results, only trees that are less than 10 meters from the road are considered. Two different datasets were analysed with distinct purposes; data referred to as dataset 1 provides validation of the methodology and dataset 2 analyses the scalability of the proposed methodology.</p>
<p>Dataset 1 (<xref ref-type="supplementary-material" rid="pone.0196004.s001">S1 Dataset</xref>) was collected on the 4<sup>th</sup> of November 2015 covering an area of approximately 750 x 1200 m, on a day with a gentle breeze [<xref ref-type="bibr" rid="pone.0196004.ref047">47</xref>]. This dataset has 105,369,108 points and consists of <italic>x</italic>, <italic>y</italic>, <italic>z</italic> coordinates and laser intensity. A pre-processing phase of the dataset was carried out in order to obtain the individual trees of the zone of interest. After that, the point cloud has been reduced to 18,601,566 points, with an average amount of 640,000 points per tree. In the study zone are a total of 29 trees: 14 <italic>Aesculus</italic> and 15 <italic>Quercus</italic>, both in leaf-off condition. The first species are characterized by larger trunk diameters than the second. <xref ref-type="fig" rid="pone.0196004.g004">Fig 4</xref> shows the location of the study area and dataset 1 outlined in red and the point clouds of the individual trees (in random colours) in plan-view, being the <italic>Aesculus</italic> horizontally placed and vertically the <italic>Quercus</italic>.</p>
<fig id="pone.0196004.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Study area (left) and dataset 1, view on floor (right): Aerial LiDAR (top) and point cloud from MLS of individual trees (bottom).</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g004" xlink:type="simple"/>
</fig>
<p>Dataset 2 was collected on the 5<sup>th</sup> of May 2016 at the Delft University of Technology campus, covering an area of approximately 2100 x 3600 m, again on a day with a gentle breeze [<xref ref-type="bibr" rid="pone.0196004.ref047">47</xref>]. Following a similar approach, the final point cloud includes a total of 31,645,755 points for 58 <italic>Aesculus hippocastanun</italic> trees in leaf-on condition, which is equivalent to 560,000 points per tree on average.</p>
</sec>
<sec id="sec015">
<title>Experimental results</title>
<p>Both datasets were processed according to the proposed methodology and analysed correspondingly to the goal set: validation (dataset 1) and scalability (dataset 2). To demonstrate some characteristics of the MLS data, the point cloud density from dataset 1 is obtained. The point density of points sampling individual trunks is computed according to an ideal equilateral triangle distribution for a circular neighbourhood [<xref ref-type="bibr" rid="pone.0196004.ref048">48</xref>]. <xref ref-type="table" rid="pone.0196004.t002">Table 2</xref> shows the different density values, which depends on the tree species (see <xref ref-type="fig" rid="pone.0196004.g005">Fig 5</xref> as example) and tree-MLS sensor distance: the higher density for the Quercus species corresponds to a lower tree-MLS system while the density variation is higher due to the tree morphology, as <xref ref-type="table" rid="pone.0196004.t002">Table 2</xref> shows.</p>
<fig id="pone.0196004.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Schematic example of the proposed methodology according to species for dataset 1.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g005" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0196004.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.t002</object-id>
<label>Table 2</label> <caption><title>MLS point density for each tree.</title></caption>
<alternatives>
<graphic id="pone.0196004.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Specie</th>
<th align="center">Mean (cm)</th>
<th align="center">Std (cm)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><italic>Aesculus hippocastanun</italic></td>
<td align="char" char=".">4.2</td>
<td align="char" char=".">0.5</td>
</tr>
<tr>
<td align="center"><italic>Quercus palustris</italic></td>
<td align="char" char=".">9.3</td>
<td align="char" char=".">4.3</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The different automatic processing steps required to obtain the structural tree parameters are summarized in <xref ref-type="fig" rid="pone.0196004.g005">Fig 5</xref> for dataset 1.</p>
<p>The first step involves the determination of the CBH (Crown Base Height) to separate the canopy from the trunk by means of histogram analysis of the individual tree voxelization. In this case, a 10 cm voxel size is fixed to obtain CBH. For the determination of the other tree parameters, the original point cloud is employed, namely: TH (Tree Height), CW (Crown Width), DBH (Diameter at Breast Height), BCV (Base Crown Volume), CV (Canopy Volume) and location.</p>
<p>In order to avoid any distortion in the methodology analysis, an outlier filter based on the so called Pope test [<xref ref-type="bibr" rid="pone.0196004.ref049">49</xref>] is applied to the discrepancies or residuals in DBH estimations. This outlier rejection test is based on the definition of standardized residuals, which are evaluated against a Tau distribution since they are not normally distributed. For a significance level of 5% the statistical threshold is set at 2.944, removing all points whose standardized residual is lower. The trees rejected by the Pope test have a non-circular trunk. Moreover, the BCV parameter derived directly from the stem curve (<xref ref-type="disp-formula" rid="pone.0196004.e007">6</xref>) was computed according to the constraint that diameters from the ground plane until CBH are not larger than DBH. Altough the tree location is not a structural tree variable, it has special relevance in tree management in urban environments, compare for example [<xref ref-type="bibr" rid="pone.0196004.ref003">3</xref>]. Regarding volumetric measures, the α coefficient used to estimate the Canopy Volume (CV) parameter through the canopy envelop controls the level of detail of the final canopy. This effect is illustrated in <xref ref-type="fig" rid="pone.0196004.g006">Fig 6</xref>, where various canopy results are shown for different choices of the α coefficient. The volume variation in these cases is negligible (&lt;3%). α = 0.05 is chosen, by a sensitive analysis, as the coefficient for estimating the canopy envelope. This value also complies with the homeomorphic requirements for shape-reconstruction and is the optimum one indicated by [<xref ref-type="bibr" rid="pone.0196004.ref050">50</xref>]. To tune this coefficient the the point cloud density and shape of the object should be taken into account. The main factor is the point density which is inverse correlated to the α coefficient, so for low spatial resolution datasets it should be increased. The secondary factor is the shape of the object as local shape variations affect local point density. If the separation distance between two branches is similar to the spatial resolution, they might be fused in the final envelope.</p>
<fig id="pone.0196004.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Canopy envelop results using different α coefficients from the triangulation mesh (the best result is obtained by α = 0.05).</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g006" xlink:type="simple"/>
</fig>
<p>Final tree parameters from dataset 1, obtained by the proposed methodology following the specifications as shown in <xref ref-type="table" rid="pone.0196004.t003">Table 3</xref>.</p>
<table-wrap id="pone.0196004.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.t003</object-id>
<label>Table 3</label> <caption><title>Tree parameter results from dataset 1.</title> <p>Location coordinates (x UTM, y UTM), Tree Height (TH), Crown Width (CW), Diameter at Breast Height (DBH), Crown Base Height (CBH), Base Crown Volume (BCV) and Canopy Volume (CV).</p></caption>
<alternatives>
<graphic id="pone.0196004.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">ID</th>
<th align="center">x <sub>UTM</sub> (m)</th>
<th align="center">y <sub>UTM</sub> (m)</th>
<th align="center">TH (m)</th>
<th align="center">CW (m)</th>
<th align="center">DBH (m)</th>
<th align="center">CBH (m)</th>
<th align="center">BCV (dm<sup>3</sup>)</th>
<th align="center">CV (dm<sup>3</sup>)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td align="char" char=".">85029.79</td>
<td align="char" char=".">446503.46</td>
<td align="char" char=".">15.21</td>
<td align="char" char=".">13.35</td>
<td align="char" char=".">0.75</td>
<td align="char" char=".">1.4</td>
<td align="char" char=".">85.2</td>
<td align="char" char=".">898.9</td>
</tr>
<tr>
<td align="center">2</td>
<td align="char" char=".">85056.50</td>
<td align="char" char=".">446514.77</td>
<td align="char" char=".">13.80</td>
<td align="char" char=".">13.51</td>
<td align="char" char=".">0.67</td>
<td align="char" char=".">1.3</td>
<td align="char" char=".">46.5</td>
<td align="char" char=".">726.8</td>
</tr>
<tr>
<td align="center">3</td>
<td align="char" char=".">85069.61</td>
<td align="char" char=".">446520.18</td>
<td align="char" char=".">16.21</td>
<td align="char" char=".">12.82</td>
<td align="char" char=".">0.67</td>
<td align="char" char=".">1.3</td>
<td align="char" char=".">58.1</td>
<td align="char" char=".">880.3</td>
</tr>
<tr>
<td align="center">4</td>
<td align="char" char=".">85082.68</td>
<td align="char" char=".">446526.32</td>
<td align="char" char=".">15.00</td>
<td align="char" char=".">12.84</td>
<td align="char" char=".">0.99</td>
<td align="char" char=".">1.4</td>
<td align="char" char=".">100.2</td>
<td align="char" char=".">809.5</td>
</tr>
<tr>
<td align="center">5</td>
<td align="char" char=".">85096.52</td>
<td align="char" char=".">446532.46</td>
<td align="char" char=".">13.72</td>
<td align="char" char=".">12.63</td>
<td align="char" char=".">0.76</td>
<td align="char" char=".">1.3</td>
<td align="char" char=".">59.4</td>
<td align="char" char=".">662.7</td>
</tr>
<tr>
<td align="center">6</td>
<td align="char" char=".">85107.73</td>
<td align="char" char=".">446537.74</td>
<td align="char" char=".">16.01</td>
<td align="char" char=".">12.42</td>
<td align="char" char=".">1.08</td>
<td align="char" char=".">1.8</td>
<td align="char" char=".">119.4</td>
<td align="char" char=".">1035.3</td>
</tr>
<tr>
<td align="center">7</td>
<td align="char" char=".">85119.77</td>
<td align="char" char=".">446543.13</td>
<td align="char" char=".">15.63</td>
<td align="char" char=".">13.82</td>
<td align="char" char=".">0.83</td>
<td align="char" char=".">1.4</td>
<td align="char" char=".">117.5</td>
<td align="char" char=".">997.3</td>
</tr>
<tr>
<td align="center">8</td>
<td align="char" char=".">85134.52</td>
<td align="char" char=".">446550.18</td>
<td align="char" char=".">15.99</td>
<td align="char" char=".">14.25</td>
<td align="center">-</td>
<td align="char" char=".">1.3</td>
<td align="center">-</td>
<td align="char" char=".">1168.9</td>
</tr>
<tr>
<td align="center">9</td>
<td align="char" char=".">85147.13</td>
<td align="char" char=".">446555.82</td>
<td align="char" char=".">15.31</td>
<td align="char" char=".">11.7</td>
<td align="char" char=".">0.77</td>
<td align="char" char=".">1.3</td>
<td align="char" char=".">68.4</td>
<td align="char" char=".">777.1</td>
</tr>
<tr>
<td align="center">10</td>
<td align="char" char=".">85161.06</td>
<td align="char" char=".">446562.13</td>
<td align="char" char=".">13.91</td>
<td align="char" char=".">13.76</td>
<td align="char" char=".">0.50</td>
<td align="char" char=".">2.2</td>
<td align="char" char=".">44.2</td>
<td align="char" char=".">621.4</td>
</tr>
<tr>
<td align="center">11</td>
<td align="char" char=".">85173.11</td>
<td align="char" char=".">446567.45</td>
<td align="char" char=".">16.99</td>
<td align="char" char=".">14.45</td>
<td align="char" char=".">0.77</td>
<td align="char" char=".">1.2</td>
<td align="char" char=".">95.7</td>
<td align="char" char=".">1261.0</td>
</tr>
<tr>
<td align="center">12</td>
<td align="char" char=".">85187.02</td>
<td align="char" char=".">446573.90</td>
<td align="char" char=".">12.86</td>
<td align="char" char=".">9.01</td>
<td align="char" char=".">0.60</td>
<td align="char" char=".">2.3</td>
<td align="char" char=".">40.4</td>
<td align="char" char=".">359.3</td>
</tr>
<tr>
<td align="center">13</td>
<td align="char" char=".">85201.51</td>
<td align="char" char=".">446580.57</td>
<td align="char" char=".">15.02</td>
<td align="char" char=".">11.45</td>
<td align="char" char=".">0.78</td>
<td align="char" char=".">1.9</td>
<td align="char" char=".">76.1</td>
<td align="char" char=".">860.0</td>
</tr>
<tr>
<td align="center">14</td>
<td align="char" char=".">85218.22</td>
<td align="char" char=".">446587.79</td>
<td align="char" char=".">15.58</td>
<td align="char" char=".">14.97</td>
<td align="center">-</td>
<td align="char" char=".">2.3</td>
<td align="center">-</td>
<td align="char" char=".">1042.1</td>
</tr>
<tr>
<td align="center">15*</td>
<td align="char" char=".">85257.16</td>
<td align="char" char=".">446586.70</td>
<td align="char" char=".">13.64</td>
<td align="char" char=".">8.56</td>
<td align="char" char=".">0.35</td>
<td align="char" char=".">2.8</td>
<td align="char" char=".">23.6</td>
<td align="char" char=".">333.5</td>
</tr>
<tr>
<td align="center">16*</td>
<td align="char" char=".">85260.07</td>
<td align="char" char=".">446579.31</td>
<td align="char" char=".">14.17</td>
<td align="char" char=".">7.59</td>
<td align="char" char=".">0.32</td>
<td align="char" char=".">3.2</td>
<td align="char" char=".">18.6</td>
<td align="char" char=".">333.4</td>
</tr>
<tr>
<td align="center">17*</td>
<td align="char" char=".">85263.18</td>
<td align="char" char=".">446571.97</td>
<td align="char" char=".">14.96</td>
<td align="char" char=".">9.09</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">3.3</td>
<td align="char" char=".">22.4</td>
<td align="char" char=".">351.8</td>
</tr>
<tr>
<td align="center">18*</td>
<td align="char" char=".">85266.35</td>
<td align="char" char=".">446564.60</td>
<td align="char" char=".">14.60</td>
<td align="char" char=".">8.59</td>
<td align="char" char=".">0.55</td>
<td align="char" char=".">2.7</td>
<td align="char" char=".">46.7</td>
<td align="char" char=".">355.6</td>
</tr>
<tr>
<td align="center">19*</td>
<td align="char" char=".">85269.26</td>
<td align="char" char=".">446557.10</td>
<td align="char" char=".">14.57</td>
<td align="char" char=".">8.53</td>
<td align="char" char=".">0.31</td>
<td align="char" char=".">2.8</td>
<td align="char" char=".">14.3</td>
<td align="char" char=".">339.4</td>
</tr>
<tr>
<td align="center">20*</td>
<td align="char" char=".">85272.33</td>
<td align="char" char=".">446549.97</td>
<td align="char" char=".">15.31</td>
<td align="char" char=".">7.34</td>
<td align="char" char=".">0.40</td>
<td align="char" char=".">3.3</td>
<td align="char" char=".">22.6</td>
<td align="char" char=".">300.7</td>
</tr>
<tr>
<td align="center">21*</td>
<td align="char" char=".">85275.20</td>
<td align="char" char=".">446542.53</td>
<td align="char" char=".">14.69</td>
<td align="char" char=".">7.56</td>
<td align="center">-</td>
<td align="char" char=".">2.8</td>
<td align="center">-</td>
<td align="char" char=".">394.2</td>
</tr>
<tr>
<td align="center">22*</td>
<td align="char" char=".">85278.79</td>
<td align="char" char=".">446534.73</td>
<td align="char" char=".">14.27</td>
<td align="char" char=".">7.38</td>
<td align="char" char=".">0.34</td>
<td align="char" char=".">3.7</td>
<td align="char" char=".">24.1</td>
<td align="char" char=".">347.3</td>
</tr>
<tr>
<td align="center">23*</td>
<td align="char" char=".">85281.45</td>
<td align="char" char=".">446527.61</td>
<td align="char" char=".">8.35</td>
<td align="char" char=".">6.53</td>
<td align="char" char=".">0.35</td>
<td align="char" char=".">1.8</td>
<td align="char" char=".">28.9</td>
<td align="char" char=".">203.5</td>
</tr>
<tr>
<td align="center">24*</td>
<td align="char" char=".">85246.63</td>
<td align="char" char=".">446518.54</td>
<td align="char" char=".">12.84</td>
<td align="char" char=".">7.22</td>
<td align="char" char=".">0.40</td>
<td align="char" char=".">2.9</td>
<td align="char" char=".">24.2</td>
<td align="char" char=".">252.7</td>
</tr>
<tr>
<td align="center">25*</td>
<td align="char" char=".">85253.94</td>
<td align="char" char=".">446522.11</td>
<td align="char" char=".">12.94</td>
<td align="char" char=".">6.88</td>
<td align="char" char=".">0.41</td>
<td align="char" char=".">3.8</td>
<td align="char" char=".">31.6</td>
<td align="char" char=".">228.3</td>
</tr>
<tr>
<td align="center">26*</td>
<td align="char" char=".">85251.02</td>
<td align="char" char=".">446529.52</td>
<td align="char" char=".">14.00</td>
<td align="char" char=".">6.41</td>
<td align="char" char=".">0.36</td>
<td align="char" char=".">4.3</td>
<td align="char" char=".">33.3</td>
<td align="char" char=".">210.6</td>
</tr>
<tr>
<td align="center">27*</td>
<td align="char" char=".">85247.81</td>
<td align="char" char=".">446536.71</td>
<td align="char" char=".">12.42</td>
<td align="char" char=".">7.53</td>
<td align="char" char=".">0.50</td>
<td align="char" char=".">3.7</td>
<td align="char" char=".">26.1</td>
<td align="char" char=".">313.7</td>
</tr>
<tr>
<td align="center">28*</td>
<td align="char" char=".">85244.86</td>
<td align="char" char=".">446544.16</td>
<td align="char" char=".">16.10</td>
<td align="char" char=".">7.53</td>
<td align="char" char=".">0.37</td>
<td align="char" char=".">2.8</td>
<td align="char" char=".">17.6</td>
<td align="char" char=".">407.7</td>
</tr>
<tr>
<td align="center">29*</td>
<td align="char" char=".">85241.91</td>
<td align="char" char=".">446551.73</td>
<td align="char" char=".">14.07</td>
<td align="char" char=".">9.25</td>
<td align="char" char=".">0.48</td>
<td align="char" char=".">4.2</td>
<td align="char" char=".">57.7</td>
<td align="char" char=".">452.9</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001"><p>The <italic>Quercus</italic> trees are labelled with an asterisk (*).</p></fn>
</table-wrap-foot>
</table-wrap>
<p><xref ref-type="table" rid="pone.0196004.t004">Table 4</xref> shows the average tree parameters of dataset 1 to highlight the different morphology of the trees involved in the experimental results.</p>
<table-wrap id="pone.0196004.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.t004</object-id>
<label>Table 4</label> <caption><title>Tree summary from dataset 1.</title></caption>
<alternatives>
<graphic id="pone.0196004.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.t004" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Specie</th>
<th align="center">TH (m)</th>
<th align="center">CW (m)</th>
<th align="center">DBH (m)</th>
<th align="center">CBH (m)</th>
<th align="center">BCV (dm<sup>3</sup>)</th>
<th align="center">CV (dm<sup>3</sup>)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><italic>Aesculus hippocastanun</italic></td>
<td align="char" char=".">15.09</td>
<td align="char" char=".">12.93</td>
<td align="char" char=".">0.76</td>
<td align="char" char=".">1.60</td>
<td align="char" char=".">75.99</td>
<td align="char" char=".">864.39</td>
</tr>
<tr>
<td align="center"><italic>Quercus palustris</italic></td>
<td align="char" char=".">13.78</td>
<td align="char" char=".">7.62</td>
<td align="char" char=".">0.39</td>
<td align="char" char=".">3.14</td>
<td align="char" char=".">25.73</td>
<td align="char" char=".">312.37</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>One of the advantages of the availability of the tree parameters as given in <xref ref-type="table" rid="pone.0196004.t003">Table 3</xref>, is the possibility to generate a simplified or structural, view of the individual trees without the need of employing the potentially many original MLS 3D points (<xref ref-type="fig" rid="pone.0196004.g006">Fig 6</xref>). This leads to a clear advantage in terms of quick visualization and data storage. This structural conceptualization shows the canopy as a rectangular prism such that its volume equals CV, its height the difference between TH and CBH and its width equals CW. Meanwhile, the trunk is simplified as a cylinder centred in the <italic>x</italic>,<italic>y</italic> coordinates, with a diameter equal to DBH and a height coincident to CBH. In case DBH was rejected by the Pope test, the canopy prism is marked in red in <xref ref-type="fig" rid="pone.0196004.g007">Fig 7</xref> and the cylindrical trunk is omitted.</p>
<fig id="pone.0196004.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Tree parameter results from dataset 1.</title>
<p>Schematic representation of tree location, TH, CW, DBH, BCH and CV.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g007" xlink:type="simple"/>
</fig>
<p>To evaluate the scalability at city level of the methodology, dataset 2 consisting of 58 individual <italic>Aesculus hippocastanum</italic> was processed. <xref ref-type="table" rid="pone.0196004.t005">Table 5</xref> sums up the average (μ) and standard deviation (σ) of the estimated parameters, providing an indication of the morphological homogeneity of the studied trees.</p>
<table-wrap id="pone.0196004.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.t005</object-id>
<label>Table 5</label> <caption><title>Average (μ) and standard deviation (σ) of tree parameter results from dataset 2.</title></caption>
<alternatives>
<graphic id="pone.0196004.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.t005" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center">TH (m)</th>
<th align="center">CW (m)</th>
<th align="center">DBH (cm)</th>
<th align="center">CBH (m)</th>
<th align="center">BCV (dm<sup>3</sup>)</th>
<th align="center">CV (dm<sup>3</sup>)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">μ</td>
<td align="char" char=".">19.86</td>
<td align="char" char=".">18.46</td>
<td align="char" char=".">65.96</td>
<td align="char" char=".">2.69</td>
<td align="char" char=".">174.72</td>
<td align="char" char=".">317.60</td>
</tr>
<tr>
<td align="center">σ</td>
<td align="char" char=".">1.09</td>
<td align="char" char=".">2.70</td>
<td align="char" char=".">13.85</td>
<td align="char" char=".">1.13</td>
<td align="char" char=".">64.49</td>
<td align="char" char=".">58.40</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>To highlight the scalability of the proposed methodology, in <xref ref-type="fig" rid="pone.0196004.g008">Fig 8</xref>, superimposed on the point cloud, are the CW values represented as a circumference centred in the computed <italic>x</italic>, <italic>y</italic> coordinates (black dot). This shows that the workflow is able to extract tree parameters even in high density tree areas, which is a common case in urban environments.</p>
<fig id="pone.0196004.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Tree parameter results (location and CW) overlapping to dataset 2 for scalability.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g008" xlink:type="simple"/>
</fig>
<p>The computation time for dataset 2 is less than 10 seconds, indicating that the algorithm could be run at city level.</p>
</sec>
</sec>
<sec id="sec016" sec-type="conclusions">
<title>Discussion</title>
<p>In this section, the sensitivity of the results with respect to the different parameters is discussed, as well as the validation of the results against <italic>in situ</italic> data.</p>
<sec id="sec017">
<title>DBH analysis</title>
<p>First, the accuracy of the DBH estimation is evaluated for dataset 1. As commented in the previous section, different bin intervals along the trunk were considered to robustly fit DBH, namely: 1.25–1.35 m; 1.20–1.40 m; 1.10–1.50 m and 1.00–1.60 m. The linear regressions of DBH at different bin sizes are shown in <xref ref-type="fig" rid="pone.0196004.g009">Fig 9</xref>.</p>
<fig id="pone.0196004.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g009</object-id>
<label>Fig 9</label>
<caption>
<title>DBH linear regressions at different bin sizes for dataset 1.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g009" xlink:type="simple"/>
</fig>
<p>Linear regression parameters are listed in <xref ref-type="table" rid="pone.0196004.t006">Table 6</xref>, being analysed the discrepancies between real and estimated DBH at different height bins. Both correlations coefficients: Pearson’s coefficient of determination (R<sup>2</sup>) as well as Lin’s Concordance Correlation Coefficient (CCC) are listed. The last one was computed as shown in (<xref ref-type="disp-formula" rid="pone.0196004.e008">7</xref>). As comment, indicate that CCC cannot exceed the absolute value of Pearson’s correlation coefficient (R). For the error dispersion measurement, the sample is assessed by a robust Jarque-Bera normality test [<xref ref-type="bibr" rid="pone.0196004.ref045">45</xref>]. In all cases, the p-value of the normality test is higher than the significance level of 0.05, validating the RMSE as measure of error dispersion. Due to the nature of the applied regression, the error central tendency is compatible with zero.</p>
<table-wrap id="pone.0196004.t006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.t006</object-id>
<label>Table 6</label> <caption><title>Summary of DBH determination for different heigh bins for dataset 1.</title> <p>Correlations coefficients (R<sup>2</sup> and CCC), error dispersion (RMSE) and normality assessment of error sample.</p></caption>
<alternatives>
<graphic id="pone.0196004.t006g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.t006" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Height Bin (m)</th>
<th align="center">R<sup>2</sup></th>
<th align="center">CCC</th>
<th align="center">RMSE (cm)</th>
<th align="center">Normality (p-value)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>1.25–1.35</bold></td>
<td align="char" char=".">0.69</td>
<td align="char" char=".">0.80</td>
<td align="char" char=".">10.7</td>
<td align="char" char=".">0.63</td>
</tr>
<tr>
<td align="center"><bold>1.20–1.40</bold></td>
<td align="char" char=".">0.92</td>
<td align="char" char=".">0.95</td>
<td align="char" char=".">4.9</td>
<td align="char" char=".">0.87</td>
</tr>
<tr>
<td align="center"><bold>1.10–1.50</bold></td>
<td align="char" char=".">0.76</td>
<td align="char" char=".">0.85</td>
<td align="char" char=".">9.2</td>
<td align="char" char=".">0.42</td>
</tr>
<tr>
<td align="center"><bold>1.00–1.60</bold></td>
<td align="char" char=".">0.89</td>
<td align="char" char=".">0.94</td>
<td align="char" char=".">6.0</td>
<td align="char" char=".">0.84</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>According to the results in <xref ref-type="table" rid="pone.0196004.t005">Table 5</xref>, we can conclude that the 20 cm height bin, using points from 1.20 m to 1.40 m height of each individual tree to estimate the DBH provides the best results.</p>
<p>Next, the influence of point cloud density on DBH estimation is analysed by considering the point density for different height bins and the corresponding error in DBH estimation. The results are listed in <xref ref-type="table" rid="pone.0196004.t007">Table 7</xref>, where no significant correlation is shown. A bit higher correlation appears for the 20 cm interval results, but a check revealed that this is caused by the presence of an observation with a higher discrepancy, near to the outlier filter threshold, which was not automatically eliminated.</p>
<table-wrap id="pone.0196004.t007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.t007</object-id>
<label>Table 7</label> <caption><title>Relationship between errors and MLS point density for each individual tree.</title> <p>Correlations coefficients (R<sup>2</sup> and CCC).</p></caption>
<alternatives>
<graphic id="pone.0196004.t007g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.t007" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Height Bin (m)</th>
<th align="center">R<sup>2</sup></th>
<th align="center">CCC</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>1.25–1.35</bold></td>
<td align="char" char=".">0.0001</td>
<td align="char" char=".">-0.0031</td>
</tr>
<tr>
<td align="center"><bold>1.20–1.40</bold></td>
<td align="char" char=".">0.1873</td>
<td align="char" char=".">0.1857</td>
</tr>
<tr>
<td align="center"><bold>1.10–1.50</bold></td>
<td align="char" char=".">0.0023</td>
<td align="char" char=".">0.0230</td>
</tr>
<tr>
<td align="center"><bold>1.00–1.60</bold></td>
<td align="char" char=".">0.0019</td>
<td align="char" char=".">-0.0191</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Moreover, the number of points involved in the robust fitting process was compared against the regression parameters (<xref ref-type="table" rid="pone.0196004.t006">Table 6</xref>). <xref ref-type="table" rid="pone.0196004.t008">Table 8</xref> lists the minimum, maximum and average number of points involved in the DBH fitting using different bin sizes. Additionally, the coefficients of determination among the different variables are shown, to illustrate their independency, namely: mean number of points for circle fitting versus RMSE, and versus CCC.</p>
<table-wrap id="pone.0196004.t008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.t008</object-id>
<label>Table 8</label> <caption><title>Relationship between number of points and error in DBH estimation.</title></caption>
<alternatives>
<graphic id="pone.0196004.t008g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.t008" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="2">Height Bin (m)</th>
<th align="center" colspan="3">Number of points</th>
<th align="center" colspan="2">Coefficient of determination (R<sup>2</sup>)</th>
</tr>
<tr>
<th align="center">Min</th>
<th align="center">Mean</th>
<th align="center">Max</th>
<th align="center">RMSE</th>
<th align="center">CCC</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>1.25–1.35</bold></td>
<td align="center">5</td>
<td align="char" char=".">73.3</td>
<td align="center">535</td>
<td align="char" char="." rowspan="4">0.0494</td>
<td align="char" char="." rowspan="4">0.0960</td>
</tr>
<tr>
<td align="center"><bold>1.20–1.40</bold></td>
<td align="center">6</td>
<td align="char" char=".">84.7</td>
<td align="center">249</td>
</tr>
<tr>
<td align="center"><bold>1.10–1.50</bold></td>
<td align="center">11</td>
<td align="char" char=".">245.6</td>
<td align="center">2015</td>
</tr>
<tr>
<td align="center"><bold>1.00–1.60</bold></td>
<td align="center">17</td>
<td align="char" char=".">346.9</td>
<td align="center">2824</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec018">
<title>Analysis of other parameters</title>
<p>The rest of the tree parameters, Tree Height, Crown Width, BCV, BCV and Canopy volume are assessed in a similar way as the results presented in <xref ref-type="table" rid="pone.0196004.t005">Table 5</xref>. In all cases both correlation coefficients are higher than 91% as shown in <xref ref-type="table" rid="pone.0196004.t009">Table 9</xref>.</p>
<table-wrap id="pone.0196004.t009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.t009</object-id>
<label>Table 9</label> <caption><title>Summary of tree parameters for dataset 1.</title> <p>Correlations coefficients (R<sup>2</sup> and CCC), error dispersion (RMSE and NMAD) and normality assessment of error sample (p-value).</p></caption>
<alternatives>
<graphic id="pone.0196004.t009g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.t009" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Parameter</th>
<th align="center">R<sup>2</sup></th>
<th align="center">CCC</th>
<th align="center">RMSE</th>
<th align="center">NMAD</th>
<th align="center">Normality (p-value)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>TH</bold></td>
<td align="char" char=".">0.9801</td>
<td align="char" char=".">0.9749</td>
<td align="center"><italic>(16</italic>.<italic>2 cm)</italic></td>
<td align="center">5.9 cm</td>
<td align="char" char=".">&lt;0.0001</td>
</tr>
<tr>
<td align="center"><bold>CW</bold></td>
<td align="char" char=".">0.9693</td>
<td align="char" char=".">0.9770</td>
<td align="center"><italic>(47</italic>.<italic>0 cm)</italic></td>
<td align="center">10.4 cm</td>
<td align="char" char=".">&lt;0.0001</td>
</tr>
<tr>
<td align="center"><bold>CBH</bold></td>
<td align="char" char=".">0.9689</td>
<td align="char" char=".">0.9771</td>
<td align="center">15.7 cm</td>
<td align="center"><italic>(20</italic>.<italic>8 cm)</italic></td>
<td align="char" char=".">0.3242</td>
</tr>
<tr>
<td align="center"><bold>BCV</bold></td>
<td align="char" char=".">0.9186</td>
<td align="char" char=".">0.9666</td>
<td align="center">8.8 dm<sup>3</sup></td>
<td align="center"><italic>(11</italic>.<italic>8 dm</italic><sup><italic>3</italic></sup><italic>)</italic></td>
<td align="char" char=".">0.4687</td>
</tr>
<tr>
<td align="center"><bold>CV</bold></td>
<td align="char" char=".">0.9970</td>
<td align="char" char=".">0.9984</td>
<td align="center">17.8 dm<sup>3</sup></td>
<td align="center"><italic>(14</italic>.<italic>5 dm</italic><sup><italic>3</italic></sup><italic>)</italic></td>
<td align="char" char=".">0.4464</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Due to the non-normality of TH and CW, instead of RMSE, the NMAD (<xref ref-type="disp-formula" rid="pone.0196004.e009">8</xref>) is employed as robust measure of error dispersion. Both values are listed in <xref ref-type="table" rid="pone.0196004.t009">Table 9</xref> for comparative purposes. In italics are shown that are rejected, according to the normality assessment. In the case of the TH and CW parameters, the RMSE tends to overestimate the error dispersion by a factor 2.8–4.5, as the error samples do not follow a normal distribution. So, the employment of RMSE as evaluator would lead to false the conclusions. For the other three parameters listed in <xref ref-type="table" rid="pone.0196004.t009">Table 9</xref>, the normality is verified to be inside the 95% confidence level.</p>
</sec>
<sec id="sec019">
<title>Specifications of the study</title>
<p>In some cases it was not possible to estimate DBH confidently due to the morphological shape of the tree trunk which caused the generation of a non-circular shape in the analysed bin. <xref ref-type="fig" rid="pone.0196004.g010">Fig 10</xref> shows an example (<xref ref-type="fig" rid="pone.0196004.g010">Fig 10a</xref>) against a regular trunk shape (<xref ref-type="fig" rid="pone.0196004.g010">Fig 10b</xref>) of proposed methodology.</p>
<fig id="pone.0196004.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Trunk morphology effects on DBH estimation.</title>
<p>Point cloud bin (left) and circle fit of the projected points in plan-view for a circular trunk shape (a) and a non-circular trunk shape (b). Both cases correspond to a 40 cm bin.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g010" xlink:type="simple"/>
</fig>
<p>The geometric configuration of the sensor with respect to the trees did not result in underestimation for the height, width and canopy volume. By contrast, many studies in forest have reported tree height (TH) underestimation when attempting to use TLS for biomass estimation [<xref ref-type="bibr" rid="pone.0196004.ref021">21</xref>]. The cause is the complexity of the canopy obstructing the laser beam from reaching the top of the tree. In the present experiment, the laser was able to measure the full visible side of the urban trees.</p>
<p>However, the algorithm has to be improved for trunk detection, since in some scenarios it could derive erroneous DBH. These difficulties occur when there are objects in the trunk vicinity at a similar height, e.g. branches lower than CBH, or urban furniture/appliances in the trunk range (<xref ref-type="fig" rid="pone.0196004.g011">Fig 11</xref>). These examples are not present in the above datasets. In future studies, we will be focusing on providing geometric solutions to overcome this challenge. Another test will be dealing with the intensity value provided by the laser scanner to improve the segmentation between trunk and canopy.</p>
<fig id="pone.0196004.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0196004.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Examples of difficult tree scenarios.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.g011" xlink:type="simple"/>
</fig>
<p>A final comment is that the proposed methodology could be extrapolated to point clouds obtained by structure-from-motion technique. But in that case, results are expected to be affected by the inability to penetrate through the canopy, and the higher level of noise since it is a passive technique.</p>
</sec>
</sec>
<sec id="sec020" sec-type="conclusions">
<title>Conclusions</title>
<p>The manuscript presents an efficient and non-invasive method for urban tree inventory based on point clouds acquired by MLS. The methodology is focused on the estimation of tree structural parameters in a fast, robust and objective way. Field measurements were used to validate these parameters. The methodology and derived results will help decision making related to urban trees.</p>
<p>This study discussed the influence of the number of points used for DBH estimation. Considering MLS point density and used height bin, no-significant relationship was reported. The optimal results in terms of correlation coefficient and error dispersion were for 20 cm bin heights, with a R<sup>2</sup> of 0.92 and a RMSE of 4.9 cm. Moreover, the rest of the mentioned tree parameters were reported with a coefficient of determination higher than 0.91. The associated error was reported according to the best suitable statistis according to the error sample nature; RMSE or NMAD. In addition, the results show that working only on one side of the tree, the visible side from the road, is still feasible for approximating different tree structural parameters and canopy architecture with an accurate fit.</p>
<p>The methodology can be extrapolated to a comprehensive study of urban trees at city level [<xref ref-type="bibr" rid="pone.0196004.ref022">22</xref>]. Current experimental results indicate the reliability of the proposed algorithm and its possible employment when big data processing is required in an efficient way. The simple yet reliable approach makes the algorithm feasible for real-time processing and provides the advantage of running the workflow easily on different platforms.</p>
<p>Different applications from the proposed workflow would be broad-scale mapping, data fusion or calibration of remote sensing platforms to retrieve tree structural parameters and urban tree management. As a next work, we consider allometric relationships from the TIN to tree structure taking into account the point cloud density.</p>
<p>Future studies will address automated registration of LiDAR with imaging sensors, to satisfy the wide range of data requirements of urban tree characterization. The more promising sensors are multispectral and/or hyperspectral imaging sensors, which will allow a robust species classification.</p>
</sec>
<sec id="sec021">
<title>Supporting information</title>
<supplementary-material id="pone.0196004.s001" position="float" xlink:href="info:doi/10.1371/journal.pone.0196004.s001" xlink:type="simple">
<label>S1 Dataset</label>
<caption>
<title>Consists of a .xyz file of individual trees from MLS of dataset 1.</title>
<p>(XYZ)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The research is all funded by the FP7 project IQmulus (FP7-ICT-2011-318787), aiming at the design and implementation of a high volume fusion and analysis Platform for geospatial point clouds, coverages and volumetric data sets. There was no additional external funding received for this study.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0196004.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nikolov</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Zeller</surname> <given-names>KF</given-names></name>. <article-title>Modeling coupled interactions of carbon, water, and ozone exchange between terrestrial ecosystems and the atmosphere. I: Model description</article-title>. <source>Environmental Pollution</source>. <year>2003</year>;<volume>124</volume>(<issue>2</issue>):<fpage>231</fpage>–<lpage>46</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0269-7491(02)00471-2" xlink:type="simple">https://doi.org/10.1016/S0269-7491(02)00471-2</ext-link>. <object-id pub-id-type="pmid">12713923</object-id></mixed-citation></ref>
<ref id="pone.0196004.ref002"><label>2</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Grey</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Frederick</surname> <given-names>JD</given-names></name>. <source>Urban forestry</source>. <publisher-name>John Wiley and Sons</publisher-name>; <year>1978</year>.</mixed-citation></ref>
<ref id="pone.0196004.ref003"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Gemeente Delft. 2017. <ext-link ext-link-type="uri" xlink:href="http://data-delft.opendata.arcgis.com/" xlink:type="simple">http://data-delft.opendata.arcgis.com/</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Evans</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Roberts</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Parker</surname> <given-names>RC</given-names></name>. <article-title>LiDAR A new tool for forest measurements?</article-title> <source>The Forestry Chronicle</source>. <year>2006</year>;<volume>82</volume>(<issue>2</issue>):<fpage>211</fpage>–<lpage>8</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5558/tfc82211-2" xlink:type="simple">https://doi.org/10.5558/tfc82211-2</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref005"><label>5</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Young</surname> <given-names>M</given-names></name>. <source>Optics and Lasers: Including Fibers and Optical Waveguides</source>: <publisher-name>Springer</publisher-name>; <year>2000</year>.</mixed-citation></ref>
<ref id="pone.0196004.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fensham</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Fairfax</surname> <given-names>RJ</given-names></name>. <article-title>Aerial photography for assessing vegetation change: a review of applications and the relevance of findings for Australian vegetation history</article-title>. <source>Australian Journal of Botany</source>. <year>2002</year>;<volume>50</volume>(<issue>4</issue>):<fpage>415</fpage>–<lpage>29</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1071/BT01032" xlink:type="simple">https://doi.org/10.1071/BT01032</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Qiu</surname> <given-names>F</given-names></name>. <article-title>Mapping Individual Tree Species in an Urban Forest Using Airborne Lidar Data and Hyperspectral Imagery</article-title>. <source>Photogrammetric Engineering &amp; Remote Sensing</source>. <year>2012</year>;<volume>78</volume>(<issue>10</issue>):<fpage>1079</fpage>–<lpage>87</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/110.14358/PERS.78.10.1079" xlink:type="simple">https://doi.org/110.14358/PERS.78.10.1079</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van Leeuwen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nieuwenhuis</surname> <given-names>M</given-names></name>. <article-title>Retrieval of forest structural parameters using LiDAR remote sensing</article-title>. <source>European Journal of Forest Research</source>. <year>2010</year>;<volume>129</volume>(<issue>4</issue>):<fpage>749</fpage>–<lpage>70</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10342-010-0381-4" xlink:type="simple">https://doi.org/10.1007/s10342-010-0381-4</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref009"><label>9</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Holopainen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vastaranta</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kankare</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kantola</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kaartinen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kukko</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <chapter-title>Mobile terrestrial laser scanning in urban tree inventory</chapter-title>. <source>SilviLaser</source> <year>2011</year>, <month>Sept</month>. <day>16–20</day>, <fpage>2011</fpage> <publisher-loc>Hobart, Australia</publisher-loc></mixed-citation></ref>
<ref id="pone.0196004.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lim</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Treitz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wulder</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>St-Onge</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Flood</surname> <given-names>M</given-names></name>. <article-title>LiDAR remote sensing of forest structure</article-title>. <source>Progress in Physical Geography</source>. <year>2003</year>;<volume>27</volume>(<issue>1</issue>):<fpage>88</fpage>–<lpage>106</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1191/0309133303pp360ra" xlink:type="simple">https://doi.org/10.1191/0309133303pp360ra</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Toschi</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Rodríguez-Gonzálvez</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Remondino</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Minto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Orlandini</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fuller</surname> <given-names>A</given-names></name>. <article-title>Accuracy evaluation of a mobile mapping system with advanced statistical methods</article-title>. <source>The International Archives of Photogrammetry, Remote Sensing and Spatial Information Sciences</source>. <year>2015</year>;<volume>XL-5/W4</volume>:<fpage>245</fpage>–<lpage>53</lpage>.</mixed-citation></ref>
<ref id="pone.0196004.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lauterbach</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Borrmann</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Heß</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Eck</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Schilling</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Nüchter</surname> <given-names>A</given-names></name>. <article-title>Evaluation of a Backpack-Mounted 3D Mobile Scanning System</article-title>. <source>Remote Sensing</source>. <year>2015</year>;<volume>7</volume>(<issue>10</issue>):<fpage>13753</fpage>–<lpage>81</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/rs71013753" xlink:type="simple">https://doi.org/10.3390/rs71013753</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raumonen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kaasalainen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Åkerblom</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kaasalainen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kaartinen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Vastaranta</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Fast Automatic Precision Tree Models from Terrestrial Laser Scanner Data</article-title>. <source>Remote Sensing</source>. <year>2013</year>;<volume>5</volume>(<issue>2</issue>):<fpage>491</fpage>–<lpage>520</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/rs5020491" xlink:type="simple">https://doi.org/10.3390/rs5020491</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henning</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Radtke</surname> <given-names>PJ</given-names></name>. <article-title>Ground-based Laser Imaging for Assessing Three-dimensional Forest Canopy Structure</article-title>. <source>Photogrammetric Engineering &amp; Remote Sensing</source>. <year>2006</year>;<volume>72</volume>(<issue>12</issue>):<fpage>1349</fpage>–<lpage>58</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.14358/PERS.72.12.1349" xlink:type="simple">https://doi.org/10.14358/PERS.72.12.1349</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Srinivasan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Popescu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Eriksson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ku</surname> <given-names>N-W</given-names></name>. <article-title>Terrestrial Laser Scanning as an Effective Tool to Retrieve Tree Level Height, Crown Width, and Stem Diameter</article-title>. <source>Remote Sensing</source>. <year>2015</year>;<volume>7</volume>(<issue>2</issue>):<fpage>1877</fpage>–<lpage>96</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/rs70201877" xlink:type="simple">https://doi.org/10.3390/rs70201877</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bucksch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lindenbergh</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rahman</surname> <given-names>MZA</given-names></name>, <name name-style="western"><surname>Menenti</surname> <given-names>M</given-names></name>. <article-title>Breast Height Diameter Estimation From High-Density Airborne LiDAR Data</article-title>. <source>IEEE Geoscience and Remote Sensing Letters</source>. <year>2014</year>;<volume>11</volume>(<issue>6</issue>):<fpage>1056</fpage>–<lpage>60</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/LGRS.2013.2285471" xlink:type="simple">https://doi.org/10.1109/LGRS.2013.2285471</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Forsman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Holmgren</surname> <given-names>J</given-names></name> and <name name-style="western"><surname>Olofsson</surname> <given-names>K</given-names></name>. <article-title>Tree Stem Diameter Estimation from Mobile Laser Scanning Using Line-Wise Intensity-Based Clustering</article-title>. <source>Forests</source> <year>2016</year>,<volume>7</volume>,<fpage>206</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/f7090206" xlink:type="simple">10.3390/f7090206</ext-link></comment></mixed-citation></ref>
<ref id="pone.0196004.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maguya</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tegel</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Junttila</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kauranne</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Korhonen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Burns</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Moving Voxel Method for Estimating Canopy Base Height from Airborne Laser Scanner Data</article-title>. <source>Remote Sensing</source>. <year>2015</year>;<volume>7</volume>(<issue>7</issue>):<fpage>8950</fpage>–<lpage>72</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/110.3390/rs70708950" xlink:type="simple">https://doi.org/110.3390/rs70708950</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Yue</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Shu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tan</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A Voxel-Based Method for Automated Identification and Morphological Parameters Estimation of Individual Street Trees from Mobile Laser Scanning Data</article-title>. <source>Remote Sens</source>. <year>2013</year>, <volume>5</volume>, <fpage>584</fpage>–<lpage>611</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/rs5020584" xlink:type="simple">10.3390/rs5020584</ext-link></comment></mixed-citation></ref>
<ref id="pone.0196004.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holopainen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vastaranta</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kankare</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Räty</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vaaja</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Liang</surname> <given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Biomass estimation of individual trees using stem and crown diameter TLS measurements</article-title>. <source>ISPRS-International Archives of the Photogrammetry, Remote Sensing and Spatial Information Sciences</source>. <year>2011</year>;<volume>XXXVIII-5/W12</volume>:<fpage>91</fpage>–<lpage>5</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5194/isprsarchives-XXXVIII-5-W12-91-2011" xlink:type="simple">https://doi.org/10.5194/isprsarchives-XXXVIII-5-W12-91-2011</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jung</surname> <given-names>S-E</given-names></name>, <name name-style="western"><surname>Kwak</surname> <given-names>D-A</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>W-K</given-names></name>, <name name-style="western"><surname>Yoo</surname> <given-names>S</given-names></name>. <article-title>Estimating Crown Variables of Individual Trees Using Airborne and Terrestrial Laser Scanners</article-title>. <source>Remote Sensing</source>. <year>2011</year>;<volume>3</volume>(<issue>11</issue>):<fpage>2346</fpage>–<lpage>63</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/rs3112346" xlink:type="simple">https://doi.org/10.3390/rs3112346</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lindenbergh</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Berthold</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sirmacek</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Herrero-Huerta</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ebersbach</surname> <given-names>D</given-names></name>. <article-title>Automated large scale parameter extraction of road-side trees sampled by a laser mobile mapping system</article-title>. <source>The International Archives of Photogrammetry, Remote Sensing and Spatial Information Sciences</source>. <year>2015</year>;<volume>XL-3/W3</volume>:<fpage>589</fpage>–<lpage>94</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5194/isprsarchives-XL-3-W3-589-201" xlink:type="simple">https://doi.org/10.5194/isprsarchives-XL-3-W3-589-201</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moskal</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Zheng</surname> <given-names>G</given-names></name>. <article-title>Retrieving Forest Inventory Variables with Terrestrial Laser Scanning (TLS) in Urban Heterogeneous Forest</article-title>. <source>Remote Sensing</source>. <year>2012</year>;<volume>4</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>20</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/rs4010001" xlink:type="simple">https://doi.org/10.3390/rs4010001</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Böhm</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bredif</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gierlinger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Krämer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lindenbergh</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>The Iqmulus urban showcase: Automatic tree classification and identification in huge mobile mapping point clouds</article-title>. <source>The International Archives of the Photogrammetry, Remote Sensing and Spatial Information Sciences</source>. <year>2016</year>;<volume>XLI-B3</volume>:<fpage>301</fpage>–<lpage>7</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5194/isprsarchives-XLI-B3-301-201" xlink:type="simple">https://doi.org/10.5194/isprsarchives-XLI-B3-301-201</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref025"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Wang, J. (2017). Scalable information extraction from point cloud data obtained by mobile laser scanner.</mixed-citation></ref>
<ref id="pone.0196004.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aldoma</surname> <given-names>AA.</given-names></name>, <name name-style="western"><surname>Marton</surname> <given-names>ZC</given-names></name>, <name name-style="western"><surname>Tombari</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wohlkinger</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Potthast</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zeisl</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Tutorial: Point Cloud Library: Three-Dimensional Object Recognition and 6 DOF Pose Estimation</article-title>. <source>IEEE Robotics &amp; Automation Magazine</source>. <year>2012</year>;<volume>19</volume>(<issue>3</issue>):<fpage>80</fpage>–<lpage>91</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/MRA.2012.2206675" xlink:type="simple">http://dx.doi.org/10.1109/MRA.2012.2206675</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cignoni</surname> <given-names>PB.</given-names></name>, <name name-style="western"><surname>Corsini</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ranzuglia</surname> <given-names>G</given-names></name>. <article-title>Meshlab: an open-source 3D mesh processing system</article-title>. <source>ERCIM News</source>. <year>2008</year>;<volume>73</volume>:<fpage>45</fpage>–<lpage>6</lpage>.</mixed-citation></ref>
<ref id="pone.0196004.ref028"><label>28</label><mixed-citation publication-type="other" xlink:type="simple">Rusu RB, Cousins S. 3D is here: Point Cloud Library (PCL). 2011 IEEE International Conference on Robotics and Automation; 2011 9–13 May 2011; Shanghai, China.</mixed-citation></ref>
<ref id="pone.0196004.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Popescu</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>K</given-names></name>. <article-title>A voxel-based lidar method for estimating crown base height for deciduous and pine trees</article-title>. <source>Remote Sensing of Environment</source>. <year>2008</year>;<volume>112</volume>(<issue>3</issue>):<fpage>767</fpage>–<lpage>81</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.rse.2007.06.011" xlink:type="simple">https://doi.org/10.1016/j.rse.2007.06.011</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref030"><label>30</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Jolliffe</surname> <given-names>IT</given-names></name>. <chapter-title>Graphical Representation of Data Using Principal Components</chapter-title>. <source>Principal Component Analysis</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer New York</publisher-name>; <year>2002</year>. p. <fpage>78</fpage>–<lpage>110</lpage>.</mixed-citation></ref>
<ref id="pone.0196004.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schnabel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wahl</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Klein</surname> <given-names>R</given-names></name>. <article-title>Efficient RANSAC for Point-Cloud Shape Detection</article-title>. <source>Computer Graphics Forum</source>. <year>2007</year>;<volume>26</volume>(<issue>2</issue>):<fpage>214</fpage>–<lpage>26</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1467-8659.2007.01016.x" xlink:type="simple">https://doi.org/10.1111/j.1467-8659.2007.01016.x</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kankare</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Hyyppä</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Holopainen</surname> <given-names>M</given-names></name>. <article-title>Automated Stem Curve Measurement Using Terrestrial Laser Scanning</article-title>. <source>IEEE Transactions on Geoscience and Remote Sensing</source>. <year>2014</year>;<volume>52</volume>(<issue>3</issue>):<fpage>1739</fpage>–<lpage>48</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TGRS.2013.2253783" xlink:type="simple">https://doi.org/10.1109/TGRS.2013.2253783</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Omasa</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hosoi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Konishi</surname> <given-names>A</given-names></name>. <article-title>3D lidar imaging for detecting and understanding plant responses and canopy structure</article-title>. <source>Journal of Experimental Botany</source>. <year>2007</year>;<volume>58</volume>(<issue>4</issue>):<fpage>881</fpage>–<lpage>98</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/jxb/erl142" xlink:type="simple">https://doi.org/10.1093/jxb/erl142</ext-link>. <object-id pub-id-type="pmid">17030540</object-id></mixed-citation></ref>
<ref id="pone.0196004.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Golias</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Dutton</surname> <given-names>RW</given-names></name>. <article-title>Adaptive Meshing, Part 2 Delaunay triangulation and 3D adaptive mesh generation</article-title>. <source>Finite Elements in Analysis and Design</source>. <year>1997</year>;<volume>25</volume>(<issue>3</issue>):<fpage>331</fpage>–<lpage>41</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0168-874X(96)00054-6" xlink:type="simple">http://dx.doi.org/10.1016/S0168-874X(96)00054-6</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Attene</surname> <given-names>M</given-names></name>. <article-title>A lightweight approach to repairing digitized polygon meshes</article-title>. <source>The Visual Computer</source>. <year>2010</year>;<volume>26</volume>(<issue>11</issue>):<fpage>1393</fpage>–<lpage>406</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00371-010-0416-3" xlink:type="simple">http://dx.doi.org/10.1007/s00371-010-0416-3</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref036"><label>36</label><mixed-citation publication-type="other" xlink:type="simple">Branch, J, Prieto, F, Boulanger, P. Automatic hole-filling of triangular meshes using local radial basis function. In Third International Symposium on 3D Data Processing, Visualization, and Transmission. IEEE.2006; 727–734.</mixed-citation></ref>
<ref id="pone.0196004.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fan</surname> <given-names>Y-Z</given-names></name>, <name name-style="western"><surname>Tam</surname> <given-names>B-S</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>J</given-names></name>. <article-title>Maximizing spectral radius of unoriented Laplacian matrix over bicyclic graphs of a given order</article-title>. <source>Linear and Multilinear Algebra</source>. <year>2008</year>;<volume>56</volume>(<issue>4</issue>):<fpage>381</fpage>–<lpage>97</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/03081080701306589" xlink:type="simple">http://dx.doi.org/10.1080/03081080701306589</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edelsbrunner</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Mücke</surname> <given-names>EP</given-names></name>. <article-title>Three-dimensional alpha shapes</article-title>. <source>ACM Transactions on Graphics</source>. <year>1994</year>;<volume>13</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>72</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1145/174462.156635" xlink:type="simple">http://dx.doi.org/10.1145/174462.156635</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref039"><label>39</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Roberts</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Richter</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Le</surname> <given-names>T-T</given-names></name>, <name name-style="western"><surname>Wiener</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <source>Evaluating Tree Growth and Soil Development on Restored Coal Mine Sites in Eastern Kentucky</source>. <publisher-name>UNC Chapel Hill</publisher-name>, <year>2015</year>.</mixed-citation></ref>
<ref id="pone.0196004.ref040"><label>40</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Kauffman</surname> <given-names>J B</given-names></name>, <name name-style="western"><surname>Arifanti</surname> <given-names>V B</given-names></name>, <name name-style="western"><surname>Basuki</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Kurnianto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Novita</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Murdiyarso</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <source>Protocols for the measurement, monitoring, and reporting of structure, biomass, carbon stocks and greenhouse gas emissions in tropical peat swamp forests</source>. <publisher-name>Center for International Forestry Research (CIFOR), Bogor Google Scholar</publisher-name>. <year>2016</year></mixed-citation></ref>
<ref id="pone.0196004.ref041"><label>41</label><mixed-citation publication-type="other" xlink:type="simple">Leica Geosystems 2011. Specifications of the Leica ScanStation C10. <ext-link ext-link-type="uri" xlink:href="https://hds.leicageosystems.com/downloads123/hds/hds/ScanStation%20C10/brochures-datasheet/Leica_ScanStation_C10_DS_en.pdf" xlink:type="simple">https://hds.leicageosystems.com/downloads123/hds/hds/ScanStation%20C10/brochures-datasheet/Leica_ScanStation_C10_DS_en.pdf</ext-link>. Cited 8 February 2018</mixed-citation></ref>
<ref id="pone.0196004.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barnhart</surname> <given-names>HX</given-names></name>, <name name-style="western"><surname>Haber</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>J</given-names></name>. <article-title>Overall Concordance Correlation Coefficient for Evaluating Agreement Among Multiple Observers</article-title>. <source>Biometrics</source>. <year>2002</year>;<volume>58</volume>(<issue>4</issue>):<fpage>1020</fpage>–<lpage>7</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.0006-341X.2002.01020.x" xlink:type="simple">https://doi.org/10.1111/j.0006-341X.2002.01020.x</ext-link>. <object-id pub-id-type="pmid">12495158</object-id></mixed-citation></ref>
<ref id="pone.0196004.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lawrence</surname> <given-names>IKL</given-names></name>. <article-title>A Concordance Correlation Coefficient to Evaluate Reproducibility</article-title>. <source>Biometrics</source>. <year>1989</year>;<volume>45</volume>(<issue>1</issue>):<fpage>255</fpage>–<lpage>68</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/2532051" xlink:type="simple">https://doi.org/10.2307/2532051</ext-link>. <object-id pub-id-type="pmid">2720055</object-id></mixed-citation></ref>
<ref id="pone.0196004.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>C-C</given-names></name>, <name name-style="western"><surname>Barnhart</surname> <given-names>HX</given-names></name>. <article-title>Assessing agreement with intraclass correlation coefficient and concordance correlation coefficient for data with repeated measures</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2013</year>;<volume>60</volume>:<fpage>132</fpage>–<lpage>45</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csda.2012.11.004" xlink:type="simple">https://doi.org/10.1016/j.csda.2012.11.004</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gel</surname> <given-names>YR</given-names></name>, <name name-style="western"><surname>Gastwirth</surname> <given-names>JL</given-names></name>. <article-title>A robust modification of the Jarque–Bera test of normality</article-title>. <source>Economics Letters</source>. <year>2008</year>;<volume>99</volume>(<issue>1</issue>):<fpage>30</fpage>–<lpage>2</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.econlet.2007.05.022" xlink:type="simple">https://doi.org/10.1016/j.econlet.2007.05.022</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rodríguez-Gonzálvez</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>González-Aguilera</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hernández-López</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>González-Jorge</surname> <given-names>H</given-names></name>. <article-title>Accuracy assessment of airborne laser scanner dataset by means of parametric and non-parametric statistical methods</article-title>. <source>IET Science, Measurement &amp; Technology</source>. <year>2015</year>;<volume>9</volume>(<issue>4</issue>):<fpage>505</fpage>–<lpage>13</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/10.1049/iet-smt.2014.0053" xlink:type="simple">https://doi.org/10.1016/10.1049/iet-smt.2014.0053</ext-link>.</mixed-citation></ref>
<ref id="pone.0196004.ref047"><label>47</label><mixed-citation publication-type="other" xlink:type="simple">Koninklijk Nederlands Meteorologisch Instituut. 2017. Koninklijk Neterlands Meteorologisch Instituut. 2017. <ext-link ext-link-type="uri" xlink:href="http://www.knmi.nl/home" xlink:type="simple">http://www.knmi.nl/home</ext-link></mixed-citation></ref>
<ref id="pone.0196004.ref048"><label>48</label><mixed-citation publication-type="other" xlink:type="simple">Rodríguez-Gonzálvez P, Nocerino E, Menna F, Minto S, Remondino F. 3D Surveying &amp; modeling of underground passages in WWI fortifications. 3D-Arch 2015 – 3D Virtual Reconstruction and Visualization of Complex Architectures; Avila (Spain) 2015. p. 17–24.</mixed-citation></ref>
<ref id="pone.0196004.ref049"><label>49</label><mixed-citation publication-type="other" xlink:type="simple">Pope AJ. The statistics of residuals and the detection of outliers. NOAA Technical Report. 1976; NOS 65 NGS 1:133.</mixed-citation></ref>
<ref id="pone.0196004.ref050"><label>50</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Bernardini</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bajaj</surname> <given-names>CL</given-names></name>. <source>Sampling and reconstructing manifolds using alpha-shapes</source>. <publisher-name>Purdue University, Department Computer Science</publisher-name>; <year>1997</year>.</mixed-citation></ref>
</ref-list>
</back>
</article>