<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-02103</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004912</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Biological tissue</subject><subj-group><subject>Connective tissue</subject><subj-group><subject>Tendons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Biological tissue</subject><subj-group><subject>Connective tissue</subject><subj-group><subject>Tendons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Joints (anatomy)</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Joints (anatomy)</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Pelvis</subject><subj-group><subject>Hip</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Pelvis</subject><subj-group><subject>Hip</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biomechanics</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Walking</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Walking</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Walking</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Bioassays and physiological analysis</subject><subj-group><subject>Electrophysiological techniques</subject><subj-group><subject>Muscle electrophysiology</subject><subj-group><subject>Electromyography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Motion</subject><subj-group><subject>Torque</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biomechanics</subject><subj-group><subject>Musculoskeletal mechanics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Muscle physiology</subject><subj-group><subject>Musculoskeletal mechanics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Muscle physiology</subject><subj-group><subject>Musculoskeletal mechanics</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Human Leg Model Predicts Muscle Forces, States, and Energetics during Walking</article-title>
<alt-title alt-title-type="running-head">Human Leg Model Predicts Muscle Function during Walking</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Markowitz</surname> <given-names>Jared</given-names></name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Herr</surname> <given-names>Hugh</given-names></name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>MIT Media Lab, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Haith</surname> <given-names>Adrian M</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Johns Hopkins University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: HH JM. Performed the experiments: JM. Analyzed the data: JM. Contributed reagents/materials/analysis tools: JM HH. Wrote the paper: JM HH.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">hherr@media.mit.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>5</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>13</day>
<month>5</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>5</issue>
<elocation-id>e1004912</elocation-id>
<history>
<date date-type="received">
<day>6</day>
<month>9</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>11</day>
<month>4</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Markowitz, Herr</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004912"/>
<abstract>
<p>Humans employ a high degree of redundancy in joint actuation, with different combinations of muscle and tendon action providing the same net joint torque. Both the resolution of these redundancies and the energetics of such systems depend on the dynamic properties of muscles and tendons, particularly their force-length relations. Current walking models that use stock parameters when simulating muscle-tendon dynamics tend to significantly overestimate metabolic consumption, perhaps because they do not adequately consider the role of elasticity. As an alternative, we posit that the muscle-tendon morphology of the human leg has evolved to maximize the metabolic efficiency of walking at self-selected speed. We use a data-driven approach to evaluate this hypothesis, utilizing kinematic, kinetic, electromyographic (EMG), and metabolic data taken from five participants walking at self-selected speed. The kinematic and kinetic data are used to estimate muscle-tendon lengths, muscle moment arms, and joint moments while the EMG data are used to estimate muscle activations. For each subject we perform an optimization using prescribed skeletal kinematics, varying the parameters that govern the force-length curve of each tendon as well as the strength and optimal fiber length of each muscle while seeking to simultaneously minimize metabolic cost and maximize agreement with the estimated joint moments. We find that the metabolic cost of transport (MCOT) values of our participants may be correctly matched (on average 0.36±0.02 predicted, 0.35±0.02 measured) with acceptable joint torque fidelity through application of a single constraint to the muscle metabolic budget. The associated optimal muscle-tendon parameter sets allow us to estimate the forces and states of individual muscles, resolving redundancies in joint actuation and lending insight into the potential roles and control objectives of the muscles of the leg throughout the gait cycle.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Neuromuscular systems often employ redundancy in joint actuation, with different combinations of muscle and tendon action producing the same net joint torque. Both the resolution of these redundancies and the energetics of such systems depend strongly on the force-length relations of muscles and tendons. Many human walking models fail to properly account for elasticity by failing to scale muscle-tendon parameters for different individuals, relying instead on stock values taken from cadaver studies. This can result in inaccurate estimates of metabolic consumption as well as of the forces and states of individual muscles. Instead we estimate muscle-tendon parameters using a data-driven optimization procedure, testing the hypothesis that the human leg has evolved to maximize the metabolic efficiency of walking at self-selected speed. We find that the experimentally observed metabolic consumption can be matched with reasonable joint torque fidelity through the addition of a single constraint on the per-muscle metabolic budget. The associated muscle-tendon parameter sets were used to compute muscle force and state estimates, lending insight into potential roles and control objectives of the major muscles of the leg throughout the gait cycle.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000104</institution-id>
<institution>National Aeronautics and Space Administration</institution>
</institution-wrap>
</funding-source>
<award-id>6926843</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Herr</surname> <given-names>Hugh Miller</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This project was supported by the National Aeronautics and Space Administration (<ext-link ext-link-type="uri" xlink:href="https://www.nasa.gov/" xlink:type="simple">https://www.nasa.gov/</ext-link>) under grant number 6926843. The grant was received by HH. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="7"/>
<page-count count="30"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The data sets used in this publication can be found at: <ext-link ext-link-type="uri" xlink:href="http://web.media.mit.edu/~hherr/markowitz_2016/" xlink:type="simple">http://web.media.mit.edu/~hherr/markowitz_2016/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Human walking relies on a complex interplay of several physiological systems, with each exhibiting some degree of redundancy. The nervous system directs muscle contraction while receiving input from many different neural pathways. Muscles work together to produce motion, but different combinations of muscle action can produce the same net torque at a given joint. Tendons provide the interface between muscle and bone, but the energy transferred to the skeleton can come from either the active muscle or the compliance of the tendon. Understanding how humans resolve these redundancies has been a long-standing problem in the fields of neuroscience and biomechanics [<xref ref-type="bibr" rid="pcbi.1004912.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref002">2</xref>].</p>
<p>Knowledge of how the neuromuscular system allocates load during a given task would provide insight into the control objectives that govern its actions. Potential objectives (reviewed in [<xref ref-type="bibr" rid="pcbi.1004912.ref003">3</xref>]) include joint trajectory planning or minimization of metabolic energy consumption, active muscle volume, or muscle fatigue. However without an adequate understanding of the roles of each component of the system, such control hypotheses remain mere speculation.</p>
<p>The roles of individual muscles and tendons in producing motion depend on the neural drive to the muscles and on the force generation properties of both the muscles and the tendons. Several modes of experimental observations provide glimpses of these elements. Electromyography (EMG) can be used to quantify the neural drive to individual muscles, revealing which muscles contribute to a given movement and giving some measure of intensity [<xref ref-type="bibr" rid="pcbi.1004912.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004912.ref006">6</xref>]. However it is limited by signal variability, measurement artifacts, and an inexact mapping to physiology and muscle force. Ultrasound probes have recently been used to image the individual motions of some distal leg muscles and tendons <italic>in vivo</italic> [<xref ref-type="bibr" rid="pcbi.1004912.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1004912.ref013">13</xref>], but are practical only for small muscles and limited tasks. Motion capture can be combined with a knowledge of anatomy to infer the net movement of muscle-tendon units under much more general circumstances [<xref ref-type="bibr" rid="pcbi.1004912.ref014">14</xref>]; however breaking the resulting movement profiles into individual muscle and tendon contributions requires knowledge of often unavailable force generation parameters of muscles and tendons. These parameters are typically estimated through cadaver studies, but the scaling of the relevant quantities among different muscles and subjects (not to mention the differences with living specimens) is not well understood [<xref ref-type="bibr" rid="pcbi.1004912.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1004912.ref016">16</xref>] and can have a significant impact on the resulting modeled dynamics [<xref ref-type="bibr" rid="pcbi.1004912.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref016">16</xref>].</p>
<p>Given the incomplete view afforded by current experimental measures, a unifying theoretical framework that combines the available data modes into a model of neuromuscular function is desirable. Two primary approaches have been taken to address this issue in walking: optimal control and optimal design.</p>
<p>Human walking studies based on optimal control [<xref ref-type="bibr" rid="pcbi.1004912.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref018">18</xref>] model the morphology of leg muscle tendon units (MTUs) using literature-based estimates. They infer muscle activation through optimization, choosing control objectives such as metabolic energy minimization and/or motion tracking. They have been successful in predicting joint moments, joint torques, and ground reaction forces but often significantly overestimate the metabolic cost required for locomotion [<xref ref-type="bibr" rid="pcbi.1004912.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref019">19</xref>]. While it is clear that the neural control of the biological system is optimized in some way, it may be infeasible to determine the true objective function for this approach. Many different muscle activation combinations can produce similar muscle torque values, and several different unknown control objectives and neurological factors may contribute at once. Further the underlying uncertainty in the muscle-tendon morphology may result in the excess metabolic cost observed, as improper leveraging of tendon compliance would affect muscle force and state and therefore metabolic estimates.</p>
<p>Human walking models based on optimal design utilize the efficiency gains that can be made through MTU parameter tuning. As Lichtwark and Wilson showed [<xref ref-type="bibr" rid="pcbi.1004912.ref020">20</xref>], experimentally observed muscle-tendon strains may be predicted by maximizing the efficiency of isolated MTUs. This result likely stems from the well-documented ability of tendon to enable muscle to operate economically [<xref ref-type="bibr" rid="pcbi.1004912.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref022">22</xref>]. Krishnaswamy and Herr [<xref ref-type="bibr" rid="pcbi.1004912.ref023">23</xref>] further explored the potential of optimal design, estimating the torque breakdown of the muscles spanning the ankle during the stance phase of walking at self-selected speed. This work used EMG signals to estimate muscle activation during walking and developed an optimization framework based on the assumption that the morphology of the muscle-tendon units spanning the ankle has evolved to minimize the metabolic cost required for walking at self-selected speed. Its results indicated that one solution set is able to match both human metabolics and kinetics, demonstrating an efficient load-sharing amongst the plantar flexors that qualitatively matched available experimental data.</p>
<p>In this work we further the study of [<xref ref-type="bibr" rid="pcbi.1004912.ref023">23</xref>], modifying and extending it to permit investigation of the full leg. We collected kinematic, kinetic, electromyographic, and metabolic data from five subjects walking at self-selected speed and used them to perform optimizations with prescribed skeletal kinematics. We varied the parameters that determine where each muscle operates on its force-length curve as well as those that shape the force-length relation of each tendon, seeking to simultaneously minimize metabolic cost and maximize agreement with the observed joint moments. Each muscle in the model was modeled as Hill-type [<xref ref-type="bibr" rid="pcbi.1004912.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref024">24</xref>] and driven by activation estimates produced from EMG data. Overviews of the system model and procedure are shown in Figs <xref ref-type="fig" rid="pcbi.1004912.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1004912.g002">2</xref>, respectively. We found that the correct metabolic consumption can be matched with reasonable fidelity in the modeled joint torque through application of a single constraint on the per-muscle metabolic budget. The resulting optimal parameter sets were used to compute muscle force and state, with fascicle length profiles being compared to available experimental measurements.</p>
<fig id="pcbi.1004912.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.g001</object-id>
<label>Fig 1</label>
<caption>
<title>System model.</title>
<p>The red rectangles indicate Hill type muscles while the crunched lines represent compliant elements. All compliant elements are tendons in series with muscle except for the hip flexor ligament, which provides a passive flexion moment at the hip.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.g001" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004912.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Muscle-tendon system identification procedure.</title>
<p>The Non-linear Contraction Dynamics box comprises Hill-type representations of all muscles in the model as well as non-linear tendon dynamics.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.g002" xlink:type="simple"/>
</fig>
<p>Our results are organized as follows. First we provide our estimated muscle activation profiles, discussing their quality and implications. Second we display the results of our dual objective optimization problem and summarize the methodology used for choosing one optimal solution for each subject. Third we evaluate the optimal solutions, producing estimates of energetic variables and muscle state. We compare these results with available experimental measures, finding quantitative agreement with metabolic data and qualitative agreement with muscle fascicle length data.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Muscle Activation Estimation</title>
<p>Muscle activation provides a scaling factor for the active force generation capability of a given muscle at a given time. As described in Methods, we applied a hybrid approach similar to that of [<xref ref-type="bibr" rid="pcbi.1004912.ref023">23</xref>] to estimate muscle activation from surface EMG measurements of five participants during walking. A Bayesian algorithm first proposed by Sanger [<xref ref-type="bibr" rid="pcbi.1004912.ref025">25</xref>] was tuned (as described in <xref ref-type="sec" rid="sec007">Methods</xref>) and used to perform a hidden state estimation that effectively determined the neural excitation of each muscle. This method was chosen over more conventional bandpass filtering methods [<xref ref-type="bibr" rid="pcbi.1004912.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004912.ref006">6</xref>] because the slightly delayed timing of the profiles it produced more easily allows the production of the observed joint torques. We elaborate on this point further in the Discussion section. The estimated neural excitation was then passed to a shaping filter [<xref ref-type="bibr" rid="pcbi.1004912.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref027">27</xref>] that represents muscle activation dynamics. The resulting average profiles are plotted in <xref ref-type="fig" rid="pcbi.1004912.g003">Fig 3</xref>. As can be seen from this plot, significant variations occurred (both within and among subjects) in the activation estimates obtained from the muscles spanning the hip. This lack of consistency was likely due to some combination of the relatively large depth of these muscles beneath the skin, motion artifacts, and the relative inaccessibility of the area. To prevent this from compromising the ensuing analysis, neural excitation profiles from the wire electrode experiments of [<xref ref-type="bibr" rid="pcbi.1004912.ref028">28</xref>] were used for the monoarticular muscles spanning the hip. These neural excitation profiles were passed to the activation dynamics from [<xref ref-type="bibr" rid="pcbi.1004912.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref027">27</xref>] for temporal consistency and subsequently used as model input along with the data-based activation estimates from all other muscles. Further details about this procedure are given in Methods and <xref ref-type="supplementary-material" rid="pcbi.1004912.s001">S1 Text</xref>. While there is no available ground truth to compare our activation estimates to, we note that the time dependence of the results (when normalized to percent gait cycle) were relatively invariant across trial and subject. The profiles follow the expected build up and decay time scales of muscle activation and, as can be seen in the following, allow the model to produce realistic kinetic and metabolic results.</p>
<fig id="pcbi.1004912.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Mean activation trajectories for all muscles of all subjects at the walking speed where Metabolic Cost of Transport (MCOT) is minimal.</title>
<p>Each color represents one participant and the shaded regions represent ± one standard deviation around the average profile.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>Muscle-Tendon Parameter Identification</title>
<p>The estimated muscle activations <italic>a</italic>(<italic>t</italic>) as well as joint kinematics <italic>θ</italic><sub><italic>joint</italic></sub>(<italic>t</italic>) derived from motion capture data were used to actuate the full leg model shown in <xref ref-type="fig" rid="pcbi.1004912.g001">Fig 1</xref> according to the scheme shown in <xref ref-type="fig" rid="pcbi.1004912.g002">Fig 2</xref>. The leg muscle-tendon model <italic>M</italic> was specified by a set <inline-formula id="pcbi.1004912.e001"><alternatives><graphic id="pcbi.1004912.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> of morphological parameters that describe the force generation characteristics of each MTU as well as two parameters that enable passive force generation by the iliofemoral, ischiofemoral, and pubofemoral ligaments as well as other connective tissue at the hip. These ligaments are known to prevent hip overextension and here allow for the recovery of elastic energy in the joint [<xref ref-type="bibr" rid="pcbi.1004912.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref029">29</xref>]; specifically they reduce the load on the iliacus muscle around toe-off. The contributions of each MTU to <inline-formula id="pcbi.1004912.e002"><alternatives><graphic id="pcbi.1004912.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> were its maximum isometric force <italic>F</italic><sub><italic>max</italic></sub>, an overall scaling factor for tendon slack length <italic>l</italic><sub><italic>sl</italic></sub> and optimal muscle length <italic>l</italic><sub><italic>opt</italic></sub>, its tendon reference strain λ<sub><italic>ref</italic></sub>, and its tendon shape factor <italic>K</italic><sub><italic>sh</italic></sub>. The lumped hip flexor ligament (HFL) acted as a simple rotary spring, parameterized by spring constant <italic>K</italic><sub><italic>HFL</italic></sub> and engagement angle <italic>θ</italic><sub>0,<italic>HFL</italic></sub>. Each parameterization of the model generated kinetic (<italic>τ</italic><sub><italic>mod</italic></sub>(<italic>t</italic>)) and metabolic (<italic>C</italic>) output costs:
<disp-formula id="pcbi.1004912.e003"><alternatives><graphic id="pcbi.1004912.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>o</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>→</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>o</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>The parameter vector <inline-formula id="pcbi.1004912.e004"><alternatives><graphic id="pcbi.1004912.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> was varied using a stochastic dual objective optimization scheme [<xref ref-type="bibr" rid="pcbi.1004912.ref030">30</xref>] that simultaneously minimized metabolic cost and the difference between the computed joint moments of the data and those produced by the model. The bounds were specified as described in the Materials and Methods section; they were chosen wide enough that they were not approached by the chosen optimal parameter sets. The solution spaces for this optimization are shown in <xref ref-type="fig" rid="pcbi.1004912.g004">Fig 4</xref>. For each participant, the set of Pareto optimal solutions (i.e. the set of solutions where one would have to compromise on one objective to improve on the other) forms a rounded corner in the objective space. In the ideal case, this corner would be sharp and consist of one solution that optimizes both objectives. However this ideal does not typically occur in noisy (realistic) systems and does not here.</p>
<fig id="pcbi.1004912.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Best solution for each participant and its relation to measured metabolic cost of transport (MCOT; light gray band) and MCOT range for all participants (dark gray band).</title>
<p>In these plots, each trial solution is represented by a dot whose x-value is its required MCOT and whose y-value is the average <italic>R</italic><sup>2</sup> of its kinetic predictions compared to measured ankle, knee, and hip moments.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.g004" xlink:type="simple"/>
</fig>
<p>To generate predictions based on our model, we chose one optimal parameter set along the Pareto Front for each subject. This was accomplished by evaluating the per-muscle metabolic consumption among all Pareto optimal solutions (<xref ref-type="fig" rid="pcbi.1004912.g005">Fig 5</xref>). Within the set of solutions, those where the metabolic cost was low and the kinetic fit was poor were seen to have uniformly low expenditure per muscle. Those that had the very best kinetic fits but relatively large metabolic costs were seen to be sinking large amounts of metabolic energy into a small number of muscles to produce incremental improvements in the kinetic fit. Such a phenomenon was likely enabled by noise in the data (particularly in the EMG signals) and the imperfect ability of our lumped, partial muscle set to match the force produced by the full set of the human body. The ramp up in metabolic energy seen in this subset of muscles is not physical as it would lead to either rapid fatigue or to the muscle being modeled as much larger than it actually is (since muscle mass scales with <italic>F</italic><sub><italic>max</italic></sub>). Hence we excluded solutions that displayed this behavior, choosing as optimal the remaining Pareto optimal solution with best kinetic fit. Mathematically this was achieved by setting a cutoff on the fractional expenditure of the vastus, as the metabolic cost of this muscle group was the largest and increased significantly as kinetic fit improved. The chosen fractional cutoff allowed us to apply one criterion to every participant to match the experimental metabolic cost, as shown in Figs <xref ref-type="fig" rid="pcbi.1004912.g004">4</xref> and <xref ref-type="fig" rid="pcbi.1004912.g005">5</xref>. <xref ref-type="table" rid="pcbi.1004912.t001">Table 1</xref> shows how our choice of optimal solution is able to quantitatively match the experimentally-observed metabolic cost of transport in four out of five subjects (and on average) while maintaining acceptable joint moment agreement. The lone subject where quantitative metabolic agreement was not reached displayed only a 6% error. Further details of the cutoff are included in Materials and Methods and in <xref ref-type="supplementary-material" rid="pcbi.1004912.s003">S3 Text</xref> while the optimal parameter set for each participant is given at the end of this document.</p>
<table-wrap id="pcbi.1004912.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.t001</object-id>
<label>Table 1</label>
<caption>
<title>Performance of multi-objective optimization for chosen solution for each participant walking at self-selected speed.</title>
<p>Experimentally measured and modeled metabolic cost of transport (MCOT) are shown as are the coefficients of determination for the modeled moments of the ankle, knee, and hip joints as compared to the data.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004912.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Participant</th>
<th align="center">Experimental MCOT</th>
<th align="center">Model MCOT</th>
<th align="center">Ankle <italic>R</italic><sup>2</sup></th>
<th align="center">Knee <italic>R</italic><sup>2</sup></th>
<th align="center">Hip <italic>R</italic><sup>2</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td align="center">0.32 ± 0.01</td>
<td align="center">0.34</td>
<td align="center">0.90</td>
<td align="center">0.89</td>
<td align="center">0.92</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">0.38 ± 0.01</td>
<td align="center">0.38</td>
<td align="center">0.86</td>
<td align="center">0.89</td>
<td align="center">0.94</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">0.35 ± 0.01</td>
<td align="center">0.35</td>
<td align="center">0.72</td>
<td align="center">0.70</td>
<td align="center">0.83</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">0.37 ± 0.01</td>
<td align="center">0.37</td>
<td align="center">0.82</td>
<td align="center">0.79</td>
<td align="center">0.92</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">0.34 ± 0.01</td>
<td align="center">0.34</td>
<td align="center">0.78</td>
<td align="center">0.73</td>
<td align="center">0.93</td>
</tr>
<tr>
<td align="center">Mean</td>
<td align="center">0.35 ± 0.02</td>
<td align="center">0.36 ± 0.02</td>
<td align="center">0.82 ± 0.07</td>
<td align="center">0.80 ± 0.09</td>
<td align="center">0.91 ± 0.04</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1004912.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Fifth order polynomial fit to the per-muscle fractional metabolic cost as a function of kinetic fit along the Pareto Front, for each participant.</title>
<p>The black lines are bounds on the observed metabolic cost while the dotted blue lines represent the locations of the chosen optimal solutions. These lines were derived by mapping the <italic>R</italic><sup>2</sup> values listed on the x-axis here to their corresponding metabolic costs in the solutions shown in <xref ref-type="fig" rid="pcbi.1004912.g004">Fig 4</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.g005" xlink:type="simple"/>
</fig>
<p>To further evaluate the quality of our joint moment estimates we computed the fractional mean absolute error (FMAE)
<disp-formula id="pcbi.1004912.e005"><alternatives><graphic id="pcbi.1004912.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi> <mml:mi>M</mml:mi> <mml:mi>A</mml:mi> <mml:mi>E</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mtext>range</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>x</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mfenced close="|" open="|" separators=""><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>x</mml:mi> <mml:mi>p</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>o</mml:mi> <mml:mi>d</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
between the modeled joint moments <italic>τ</italic><sub><italic>mod</italic></sub> and the experimentally observed joint moments <italic>τ</italic><sub><italic>obs</italic></sub>. These quantities are computed only over the stance phase to facilitate comparison with those generated from another current EMG-driven analysis, [<xref ref-type="bibr" rid="pcbi.1004912.ref031">31</xref>]. The quantities quoted from [<xref ref-type="bibr" rid="pcbi.1004912.ref031">31</xref>] represent an average over four different activities (walking, running, side stepping, and crossover) but are generally close to those they generate for walking only (except for the hip, which had lower errors for walking). Their analysis included two treatments; one that considered only one degree of freedom and one that considered multiple degrees of freedom (as in our model). In general our moment fits compare favorably (<xref ref-type="table" rid="pcbi.1004912.t002">Table 2</xref>).</p>
<table-wrap id="pcbi.1004912.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.t002</object-id>
<label>Table 2</label>
<caption>
<title>Comparison of the fractional mean absolute error (FMAE) in our modeled joint moments and those generated by another current EMG-driven analysis [<xref ref-type="bibr" rid="pcbi.1004912.ref031">31</xref>].</title>
<p>Note that only the stance phase was considered here. The numbers provided from [<xref ref-type="bibr" rid="pcbi.1004912.ref031">31</xref>] represent an average over four different activities but are generally close to those they generate for walking only. Their analysis included two treatments; one that considered only one degree of freedom and one that considered multiple degrees of freedom (as in our model). In general our moment fits compare favorably.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004912.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Participant</th>
<th align="center">Ankle FMAE</th>
<th align="center">Knee FMAE</th>
<th align="center">Hip FMAE</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td align="center">0.07</td>
<td align="center">0.08</td>
<td align="center">0.07</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">0.10</td>
<td align="center">0.07</td>
<td align="center">0.06</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">0.13</td>
<td align="center">0.13</td>
<td align="center">0.09</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">0.11</td>
<td align="center">0.11</td>
<td align="center">0.06</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">0.12</td>
<td align="center">0.12</td>
<td align="center">0.06</td>
</tr>
<tr>
<td align="center">Mean</td>
<td align="center">0.11 ± 0.02</td>
<td align="center">0.10 ± 0.03</td>
<td align="center">0.07 ± 0.01</td>
</tr>
<tr>
<td align="center">Sartori et. al 1DOF</td>
<td align="center">0.12 ± 0.03</td>
<td align="center">0.12 ± 0.04</td>
<td align="center">0.20 ± 0.04</td>
</tr>
<tr>
<td align="center">Sartori et. al MDOF</td>
<td align="center">0.09 ± 0.01</td>
<td align="center">0.12 ± 0.05</td>
<td align="center">0.20 ± 0.07</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The metabolic expenditure of our model also aligns with previously published results. Across subjects, we found the average efficiency of positive muscle work to be 0.26 ± 0.02, consistent with [<xref ref-type="bibr" rid="pcbi.1004912.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref033">33</xref>]. We also estimated the metabolic expenditure of the model during different portions of the gait cycle by cross referencing the simulation with the input force plate data. The results are compiled in <xref ref-type="table" rid="pcbi.1004912.t003">Table 3</xref> and show a breakdown that is very similar to that simulated in [<xref ref-type="bibr" rid="pcbi.1004912.ref034">34</xref>].</p>
<table-wrap id="pcbi.1004912.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.t003</object-id>
<label>Table 3</label>
<caption>
<title>Fractional metabolic cost expenditure over the double support, single support, and swing phases of the gait cycle (as viewed from one leg).</title>
<p>The average distribution for our five participants is seen to approximate that simulated in [<xref ref-type="bibr" rid="pcbi.1004912.ref034">34</xref>].</p>
</caption>
<alternatives>
<graphic id="pcbi.1004912.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Participant</th>
<th align="center">Double support</th>
<th align="center">Single Support</th>
<th align="center">Swing</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td align="center">.28</td>
<td align="center">.50</td>
<td align="center">.23</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">.23</td>
<td align="center">.51</td>
<td align="center">.26</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">.28</td>
<td align="center">.46</td>
<td align="center">.25</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">.27</td>
<td align="center">.48</td>
<td align="center">.26</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">.28</td>
<td align="center">.41</td>
<td align="center">.31</td>
</tr>
<tr>
<td align="center">Mean</td>
<td align="center">.27 ± .02</td>
<td align="center">.47 ± .04</td>
<td align="center">.26 ± 0.03</td>
</tr>
<tr>
<td align="center">Umberger et al. 2010</td>
<td align="center">.27</td>
<td align="center">.44</td>
<td align="center">.29</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec005">
<title>Muscle Behavior in Optimal Solutions</title>
<p>The optimal muscle-tendon parameter sets estimated by our optimization procedure provide a means to resolve the redundancy in joint actuation for each subject. When applied in conjunction with the computed kinematics and estimated muscle activations, individual muscle force and state may be estimated. <xref ref-type="fig" rid="pcbi.1004912.g006">Fig 6</xref> shows the torque breakdown for each joint in terms of percentage of body weight times height and averaged over all subjects. <xref ref-type="fig" rid="pcbi.1004912.g007">Fig 7</xref> shows the trajectories of the muscle fascicle length normalized by <italic>l</italic><sub><italic>opt</italic></sub> and averaged over all subjects. Note that the spread of some of these profiles is not due to a difference in general shape but rather to an overall offset in length, as evidenced by their nearly constant standard deviations. The soleus, hamstring, and vastus fascicle lengths in this plot all agree quite well in both shape and offset with the predictions in [<xref ref-type="bibr" rid="pcbi.1004912.ref035">35</xref>]. The soleus force and length also agree qualitatively with the projections of [<xref ref-type="bibr" rid="pcbi.1004912.ref011">11</xref>]. <xref ref-type="fig" rid="pcbi.1004912.g008">Fig 8</xref> shows the velocity trajectories for each muscle fascicle normalized by its maximal value <italic>v</italic><sub><italic>max</italic></sub> and again averaged over all participants. As can be seen from the small variation in the shapes of the profiles in these plots, muscle force and state followed similar trajectories across participants. These predictions were also seen to vary little along the Pareto front in the experimentally measured metabolic band of a given subject.</p>
<fig id="pcbi.1004912.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Contributions of individual muscles to joint torques, in terms of percentage of body weight times height and averaged over all participants.</title>
<p>The error bands represent the standard deviation over different participants.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.g006" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004912.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Muscle fascicle lengths produced by the model, normalized by optimal muscle length, and averaged over all subjects.</title>
<p>The error bands of these profiles represent the standard deviation over different participants and their spread is largely provided by a constant offset rather than different shapes, as evidenced by the relatively constant standard deviations (over time) and <xref ref-type="fig" rid="pcbi.1004912.g008">Fig 8</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.g007" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004912.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Muscle fascicle velocities produced by the model, normalized by maximum values (<italic>v</italic><sub><italic>max</italic></sub>), and averaged over all participants.</title>
<p>Here positive velocity refers to eccentric motion (muscle lengthening). The horizontal dotted lines at 0,−0.17,−0.30<italic>v</italic><sub><italic>ce</italic></sub>/<italic>v</italic><sub><italic>max</italic></sub> represent the low energy, maximum efficiency, and maximum power operating speeds of muscle, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.g008" xlink:type="simple"/>
</fig>
<p>In general, muscle fascicle state is extremely difficult to measure. The only currently available means to obtain these profiles is ultrasonography, which is only practical for the relatively short distal muscles of the leg. In <xref ref-type="fig" rid="pcbi.1004912.g009">Fig 9</xref> the modeled fascicle trajectories of muscles from one subject are compared with the experimental profiles available from published ultrasound studies. In each case the muscle fascicle lengths <italic>l</italic><sub><italic>m</italic></sub> are normalized by their length at heel strike, <italic>l</italic><sub><italic>mHS</italic></sub>. To generate these plots we took the modeled muscle from the subject who most closely matched the average height and weight of the experimental study. Soleus and gastrocnemius profiles came from Ishikawa et al [<xref ref-type="bibr" rid="pcbi.1004912.ref008">8</xref>], a gastrocnemius profile came from Fukunaga et al [<xref ref-type="bibr" rid="pcbi.1004912.ref007">7</xref>], and the vastus lateralis profile came from Chleboun [<xref ref-type="bibr" rid="pcbi.1004912.ref010">10</xref>]. In the plantar flexors, long stretches of nearly isometric operation are observed in mid-stance in both the model and <italic>in vivo</italic> profiles. In the vastus, the fascicle trajectory is seen to somewhat track the flexion of the knee in both the model and the published data. However while the qualitative trends of each muscle are consistent, quantitative agreement is not observed. We believe that observed differences come from (i) the difference in walking speed between our study and the literature, (ii) natural variation in the kinematics of early stance (which affects the initial muscle length for normalization), and (iii) uncertainty in the breakdown of what constitutes muscle and what constitutes tendon in ultrasound studies. We hope that future experimental methodologies, perhaps employing implantable sensors, will be able to further test our predicted fascicle trajectories.</p>
<fig id="pcbi.1004912.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Comparison of model fascicle trajectories with <italic>in vivo</italic> ultrasound data [<xref ref-type="bibr" rid="pcbi.1004912.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref010">10</xref>].</title>
<p>In each case the muscle fascicle lengths <italic>l</italic><sub><italic>m</italic></sub> are normalized by their length at heel strike, <italic>l</italic><sub><italic>mHS</italic></sub>. In our study the modeled muscle was taken from the subject who most closely matched the average height and weight of the experimental study.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.g009" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec006" sec-type="conclusions">
<title>Discussion</title>
<p>Several observations may be made about both the methodology employed and the results obtained in this study. On the methodology side, we first address the steps taken to estimate the activations of the muscles in our model. As mentioned above, the conventional approach for estimating muscle excitation based on EMG data involves a bandpass filter [<xref ref-type="bibr" rid="pcbi.1004912.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004912.ref006">6</xref>]. We tried this approach with our optimization scheme (on all subjects) but found that it provided an inferior ability to match the observed joint moments compared to the implemented method. Digging further into this we found that two main differences existed between the approaches; (i) the chosen Bayesian method produces a profile that turns on and off more sharply than the signal produced by the bandpass filter and (ii) the signal produced by the Bayesian method consistently lags the bandpassed signal by about 50 ms. The sharpness of the profile does not affect the results significantly as it is mostly washed out by the ensuing activation dynamics and averaging. However the time dependence does matter; this lag enables the build up of muscle force in a manner consistent with the observed joint torques. Interestingly we found that [<xref ref-type="bibr" rid="pcbi.1004912.ref036">36</xref>] introduced a 40 ms lag to their EMG signal to “account for electromechanical delay between surface EMG and force production.” This lag was employed by other studies [<xref ref-type="bibr" rid="pcbi.1004912.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref038">38</xref>] and fell within the 10−100 ms range given for these processes in the literature [<xref ref-type="bibr" rid="pcbi.1004912.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref040">40</xref>]. We found that adding a 40 ms lag as in [<xref ref-type="bibr" rid="pcbi.1004912.ref036">36</xref>] to the excitations produced by bandpassed filtered EMG signals gave performance nearly as good as those provided by the Sanger algorithm, with less variation among gait cycles. However this lagged bandpass method does not lend itself to a biophysical interpretation as clearly as the Bayesian model does.</p>
<p>Despite our best efforts at EMG data collection and activation estimation, deficiencies in this part of our data set clearly exist. Surface EMG in general is prone to noise and artifacts, and Sanger’s algorithm (tested only isometrically in his publication [<xref ref-type="bibr" rid="pcbi.1004912.ref025">25</xref>]) does not remove them. While the effects of inconsistent artifacts was minimized by discarding the EMG data from clearly compromised gait cycles and the use of average trajectories in our model, they were likely not removed entirely. Better results may be obtained in future work through fine wire EMG measurements, which while more invasive are known to produce more reliable signals. Here generic fine wire EMG profiles reported in [<xref ref-type="bibr" rid="pcbi.1004912.ref028">28</xref>] were used to replace the noisy surface EMG measurements of the muscles spanning the hip. Interestingly our model actually displayed slightly better agreement with the observed hip torque profiles than with those of the other joints, but this is misleading as most of the modeled hip moment came from the hamstrings and the hip flexor ligament (which were unaffected by the generic profiles).</p>
<p>A more minor deficiency in the EMG pipeline was normalization by the maximal voluntary contraction (MVC) values. While we do not know of a better alternative, this approach did lead to the normalized excitations of our muscles occasionally exceeding one in fast walking trials. When that occurred we renormalized by the value in the fast walking trial and reprocessed, but the normalization constant could still have been too small in other cases. Fortunately the impact of this scaling is extremely minimal because the estimated activation directly multiplies the maximum isometric force <italic>F</italic><sub><italic>max</italic></sub>, which is optimized. A small effect remains because the normalization occurs before the excitation undergoes the activation dynamics (5), but that effect is largely irrelevant to our results.</p>
<p>The system identification component of this study produced a methodology for estimating muscle-tendon parameters capable of matching the measured metabolic consumption while producing joint torque profiles that tracked observations reasonably well. One criterion based on the metabolic consumption of the vastus muscle group (the largest in the model) enabled the metabolic match for all participants. While the accuracies of our modeled joint torque profiles compare favorably with other current EMG driven modeling procedures [<xref ref-type="bibr" rid="pcbi.1004912.ref031">31</xref>], they do tend to underestimate the required joint torques. This characteristic is likely due to the exclusion of some muscles as well as the lumping of some muscle groups. In particular the deficiency exhibited in ankle moment during late stance is likely due to the exclusion of smaller plantar flexor muscles which are known to engage during that time [<xref ref-type="bibr" rid="pcbi.1004912.ref028">28</xref>]. Similarly the lumping of the three hamstring muscles (semimembranosus, semitendinosus, and biceps femoris long head) may be responsible for some of the deficiencies observed in the knee flexion moments throughout the gait cycle. Further resolution of these and other muscle groups where the muscle activations are not quite concurrent and the muscle-tendon lines of action are not quite aligned would likely improve the predictive power of this approach, allowing more accurate determination of the roles of each muscle during a given task.</p>
<p>One notable aspect of the model was the importance of the hip flexor ligament, which produced nearly all of the required hip flexion moment near toe off at no metabolic cost. Its linear form was chosen as in [<xref ref-type="bibr" rid="pcbi.1004912.ref029">29</xref>] for maximal simplicity, but did not agree with the nonlinear damped form used in previous work [<xref ref-type="bibr" rid="pcbi.1004912.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref041">41</xref>]. Given that it produced torque for free it may have suppressed the required action of the other hip flexors (notably the iliacus) near toe off and produced a better hip moment fit than would have otherwise been possible for the same metabolic cost. However the suppression of other hip flexors could not have been large as these muscles are not strong enough to produce the required torque alone and are not significantly stretched in this time frame. It is also known that the hip ligaments produce the flexion torque necessary to balance the upper body against gravity in a standing position, where the line of gravity passes posterior to the hip joint [<xref ref-type="bibr" rid="pcbi.1004912.ref042">42</xref>]. They enable people to stand erect and even carry extra weight without significant muscle work at the hip, allowing a low metabolic cost to be maintained [<xref ref-type="bibr" rid="pcbi.1004912.ref043">43</xref>]. Since the engagement angles we used are consistent with standing and damping in human connective tissue is believed to yield only a slight drift over walking time scales [<xref ref-type="bibr" rid="pcbi.1004912.ref016">16</xref>], we believe that the contribution of the hip flexor ligament in our model is physiologically reasonable.</p>
<p>The optimal muscle-tendon parameters found in this study play different roles in facilitating efficient locomotion. The maximal muscle isometric force (<italic>F</italic><sub><italic>max</italic></sub>) must be large enough to meet the torque requirements at each joint, but small enough to keep muscle size and metabolic cost reasonable. The tendon slack lengths <italic>l</italic><sub><italic>sl</italic></sub> and muscle optimal lengths <italic>l</italic><sub><italic>opt</italic></sub> govern the timing of force production, acting in concert with muscle activation. The tendon shape parameters λ<sub><italic>ref</italic></sub> and <italic>K</italic><sub><italic>sh</italic></sub> define the elastic properties of the tendon and are tuned to ensure correct muscle operation and joint actuation. The resulting muscles and tendons together produce an interconnected system capable of producing the joint torque necessary for locomotion at a minimal metabolic cost.</p>
<p>Evaluating the velocities at which the muscles in our model contract while activated can lend insight to the goals of their control. As was emphasized in [<xref ref-type="bibr" rid="pcbi.1004912.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref044">44</xref>], muscles minimize metabolic consumption at low speeds (i.e. when operating approximately isometrically). Further, A.V. Hill [<xref ref-type="bibr" rid="pcbi.1004912.ref045">45</xref>] demonstrated that skeletal muscle maximizes its efficiency while shortening at <italic>v</italic><sub><italic>CE</italic></sub> ≈ −0.17<italic>v</italic><sub><italic>max</italic></sub> and its power output at <italic>v</italic><sub><italic>CE</italic></sub> ≈ −0.30<italic>v</italic><sub><italic>max</italic></sub>. These three speeds (<italic>v</italic><sub><italic>CE</italic></sub> = 0,−0.17,−0.30<italic>v</italic><sub><italic>max</italic></sub>) are indicated by the horizontal dashed lines in <xref ref-type="fig" rid="pcbi.1004912.g008">Fig 8</xref>. Combining this with <xref ref-type="fig" rid="pcbi.1004912.g003">Fig 3</xref> allows us to contextualize the modeled velocities of each muscle when activated. At the ankle, the tibialis anterior is seen to operate at low speeds when engaged. This minimizes metabolic cost and is consistent with isometric contractions, as modeled in [<xref ref-type="bibr" rid="pcbi.1004912.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref044">44</xref>]. Both the soleus and gastrocnemius are seen to operate approximately isometrically through their activation in mid-stance before rapidly increasing their contraction velocity in a power stroke toward the end of stance (≈ 60% GC). The required positive work of the plantar flexors is consistent with the need seen in [<xref ref-type="bibr" rid="pcbi.1004912.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref044">44</xref>], but their rapid contraction at the end of stance does not strictly agree with the efficiency goal of the soleus and power goal of the gastrocnemius noted in [<xref ref-type="bibr" rid="pcbi.1004912.ref023">23</xref>]. This inconsistency amounts to a phase difference; the observation in [<xref ref-type="bibr" rid="pcbi.1004912.ref023">23</xref>] was based on muscle speed at toe off but our plantar flexor velocities reach approximately the same levels around 53% GC. At the knee, most muscles are seen to operate approximately isometrically. This agrees with [<xref ref-type="bibr" rid="pcbi.1004912.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref044">44</xref>], which note that these muscles primarily serve to modulate the stiffness of the joint in an optimally economical fashion. It is worth noting that the vastus group is seen to re-engage at the end of swing near the the optimal efficiency regime (extending the knee for heel strike) before returning to the low speed regime. At the hip, most muscles are observed to contract at low speed when activated. Two exceptions are the iliacus and the adductor longus, both of which gravitate toward maximal efficiency as they flex the hip around toe off. The adductor magnus may also approach the maximal efficiency regime as it extends the hip around heel strike, but this is less clear. Endo et al [<xref ref-type="bibr" rid="pcbi.1004912.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref044">44</xref>] found that the muscles spanning the hip could not be modeled strictly isometrically, consistent with these observations.</p>
<p>Several avenues exist for extending this work in future studies. One route would be to expand the model past the sagittal plane; as shown in [<xref ref-type="bibr" rid="pcbi.1004912.ref031">31</xref>] matching moments in three dimensions could have an impact on the optimized parameter sets. Another route would be to validate the model by testing under different walking conditions. If more reliable EMG measurements could be obtained, we could train the model based on level-ground walking at self-selected speed and then evaluate the ability of the optimal parameter set to match the observed joint torque profiles and metabolic costs under different conditions (speeds, inclines, etc.) In this case new experimental observations of the change in plantar flexor function across speed [<xref ref-type="bibr" rid="pcbi.1004912.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref013">13</xref>] could be used to evaluate the model. Another possibility is that our overarching hypothesis is incomplete- maybe the body, instead of adapting its morphology to maximize its efficiency at (the presumably most common task of) walking at self-selected speed, actually optimizes with multiple tasks in mind. One could imagine additionally collecting data from a subject running a self-selected speed and adding extra dimensions to the cost function wherein that task is optimized concurrently with walking at self-selected speed. The procedure followed here for self-selected speed walking could thus become part of a larger optimization scheme by including other tasks.</p>
<p>While such experiments could lend considerable insight, they will undoubtedly prove challenging due to the difficulties associated with collecting EMG under the stated conditions. One alternative would be to simulate the neural control of the model. Recent forward dynamic models driven by reflexive feedback have shown the ability to walk stably across different terrains [<xref ref-type="bibr" rid="pcbi.1004912.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref046">46</xref>], at different speeds [<xref ref-type="bibr" rid="pcbi.1004912.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref048">48</xref>], and in three dimensions [<xref ref-type="bibr" rid="pcbi.1004912.ref048">48</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref049">49</xref>]. These models are built for a subject with “average” dimensions and could therefore be improved through data-driven customization for individual subjects and the inclusion of more realistic muscle-tendon geometries and morphologies. This would include scaling segment inertias, refining muscle-tendon lines of action and moment arms [<xref ref-type="bibr" rid="pcbi.1004912.ref014">14</xref>], and optimization of muscle-tendon morphologies to simultaneously minimize metabolic cost and maximize agreement to experimentally observed kinematic and/or kinetic data. In this way a more realistic representation of an individual subject could be obtained, leading to further insights about the roles of individual muscles and tendons during gait and their variation amongst subjects. One could also imagine altering the neural control in this paradigm and using the framework to study movement disorders such as cerebral palsy.</p>
</sec>
<sec id="sec007" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec008">
<title>Ethics Statement</title>
<p>The experiments of this study were conducted in compliance with the principles of the Declaration of Helsinki. The study was approved by the MIT Committee on the Use of Humans as Experimental Subjects (Protocol 1101004266). Prior to the experiments all participants provided written consent for data collection, analysis, and publication.</p>
</sec>
<sec id="sec009">
<title>Data Collection</title>
<p>Kinematic, kinetic, electromyographic, and metabolic data were collected at the Harvard University Skeletal Biology Lab. Five healthy adult males participated in the study, with their average height, mass, and age being 1.77 ± 5 m, 70.4 ± 6.3 kg, and 26 ± 2 years, respectively. The required data sets were collected in two phases. First the subjects were outfitted with a portable oxygen consumption mask attached to a Cosmed <italic>K</italic>4<italic>B</italic><sup>2</sup> <italic>VO</italic><sub>2</sub> system. This system employs a standard open-circuit gas analysis technique to estimate metabolic energy consumption based on measurements of oxygen inspired and expired [<xref ref-type="bibr" rid="pcbi.1004912.ref050">50</xref>]. Three of the subjects were asked to stand still for seven minutes while a basal measurement was recorded, with the rates of the other two participants taken to be the mean of these three closely grouped rates (1.38 ± 0.06 W/kg, 1.60 ± 0.07 W/kg, 1.63 ± 0.06 W/kg). Participants then walked barefoot on an instrumented treadmill for seven minutes at each of six speeds (0.75 m/s, 1.00 m/s, 1.25 m/s, 1.50 m/s, 1.75 m/s, and 2.00 m/s), allowing the variation of metabolic energy expenditure to be measured across speed. The results were quickly tabulated and used to estimate the walking speed where the metabolic cost of transport (MCOT) was minimal.</p>
<p>Once the metabolic cost measurements were completed, the oxygen consumption mask and Cosmed system were removed and each participant was outfitted for the second phase. In this phase kinematic, kinetic, and electromyographic data were collected for two minutes of barefoot walking at each of seven speeds; the six listed above and the speed where the subject’s MCOT was found to be minimal. An infrared camera system (8 cameras, Qualisys Motion Capture Systems, Gothenburg, Sweden) was used to track the motion of subjects as they walked in the capture volume. Reflective markers were placed at 43 (bilateral) locations on the participant’s body and their three dimensional trajectories were recorded at 500 Hz. The marker locations were chosen specifically to track joint motion, as prescribed by the Helen Hayes marker model. The ground reaction forces and contact centers of pressure were measured using a split-belt instrumented force plate treadmill (Bertec Corporation, Columbus, OH). Electromyographic signals were collected using a surface system from Motion Lab Systems (Baton Rouge, LA) and electrode placements as dictated in [<xref ref-type="bibr" rid="pcbi.1004912.ref051">51</xref>]. Fourteen muscles (tibialis anterior, soleus, medial gastrocnemius, vastus lateralis, biceps femoris shorthead, rectus femoris, semimembranosus, biceps femoris long head, illiacus, gluteus maximus (lower), gluteus maximus (upper), gluteus medius, adductor longus, and adductor magnus) on one leg of each subject were recorded, with symmetry being assumed for the other leg. The signals were recorded at the surface using pre-gelled bipolar electrodes (Electrode Store Model BS-24SAF, part number DDN-20), sampled at 1000 Hz, and amplified 20 times by pre-amplifiers (Motion Lab Systems, part number MA-411). Prior to walking trials a maximum voluntary contraction (MVC) trial was conducted for each muscle group wherein the participant was asked to work that particular group as hard as possible. These MVC trials were used for normalization purposes in muscle excitation estimates.</p>
<sec id="sec010">
<title>Estimation of joint dynamics and muscle-tendon geometries</title>
<p>The marker and force plate data were downsampled to 125 Hz and processed using SIMM (Software for Interactive Musculoskeletal Modeling, Musculographics Inc., Evanston, IL). A static trial was used to scale the SIMM full body dynamic model for each participant, with all subsequent analyses being based on that scaling. Joint angles, muscle-tendon lengths, and muscle-tendon moment arms for each trial were obtained through an inverse kinematic analysis. Joint moments were computed using the SIMM Dynamics Pipeline, which utilizes the SDFAST Software (PTC, Needham, MA). All resulting trajectories were broken into gait cycles, normalized temporally to percent gait cycle, and averaged. Gross outliers (typically caused by gait irregularities or lost markers; on the order of 5% of gait cycles) were removed prior to averaging.</p>
</sec>
<sec id="sec011">
<title>Muscle activation estimation</title>
<p>Muscle activation provides a measure of a muscle’s active force generation capability as a function of time. It is defined as the relative amount of calcium bound to troponin in a muscle, with higher values indicating more potential for cross bridge formation and higher muscle forces. Activation is driven by electrical neural excitation signals and may therefore be estimated through EMG measurements. Surface EMG signals represent a combination of the action potentials, depolarization currents, and ion flows within a muscle. They provide valuable information for resolving muscle contributions but, due to large signal variability and measurement artifacts, must be carefully processed to provide reliable inputs to quantitative models.</p>
<p>Standard EMG analysis models the signal as an amplitude-modulated band-limited noise source [<xref ref-type="bibr" rid="pcbi.1004912.ref004">4</xref>], rectifying and low pass filtering it to produce an amplitude envelope [<xref ref-type="bibr" rid="pcbi.1004912.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref006">6</xref>]. While elegant, this approach did not perform as well in our optimization problem as a more recently introduced method by Sanger [<xref ref-type="bibr" rid="pcbi.1004912.ref025">25</xref>]. As detailed above, we found that the slight delay in the profiles produced by Sanger’s method (relative to bandpass-based methods) allows our model to more naturally build up the required muscle force. Sanger’s method models the EMG signal as a filtered random process with random rate and seeks to infer an underlying neural driving signal <italic>x</italic>(<italic>t</italic>) that evolves as
<disp-formula id="pcbi.1004912.e006"><alternatives><graphic id="pcbi.1004912.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi> <mml:mi>x</mml:mi> <mml:mo>=</mml:mo> <mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mi>W</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>U</mml:mi> <mml:mo>-</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
In this continuous-time stochastic differential equation <italic>dW</italic> is the differential of standard Brownian motion with rate <italic>α</italic>, <italic>dN</italic><sub><italic>β</italic></sub> is the differential of a counting process with <italic>β</italic> events occurring per unit time (the jump term), and <italic>U</italic> is a uniformly distributed random variable in [0, 1]. Without the driving <italic>dN</italic><sub><italic>β</italic></sub> term this equation would amount to a random walk. The hidden state <italic>x</italic>(<italic>t</italic>) is measured via
<disp-formula id="pcbi.1004912.e007"><alternatives><graphic id="pcbi.1004912.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>emg</mml:mtext> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mtext>emg</mml:mtext> <mml:mo>/</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <italic>P</italic>(emg|<italic>x</italic>) is the conditional probability of observing a rectified raw signal emg given driving signal <italic>x</italic>(<italic>t</italic>). This model reflects the observed Laplacian distribution of relevant EMG signals and wraps all elements of the measurement- the various fibers and electrical sources, the filter of skin and fat, the placement and impedances of the electrodes- into one equation. Combining these relations with Bayes’ Rule and solving recursively, Sanger derives the maximum a posteriori (MAP) estimate of the driving signal, i.e. the <italic>x</italic>(<italic>t</italic>) that maximizes <italic>P</italic>[<italic>x</italic>(<italic>t</italic>)|emg(<italic>t</italic>), emg(<italic>t</italic>−1),..].</p>
<p>The resulting driving signal has been shown to accurately track the turn on and turn off times of torque profiles produced by maximal isometric contractions while minimizing the noise floor when a muscle is inactive [<xref ref-type="bibr" rid="pcbi.1004912.ref025">25</xref>]. However, as noted in [<xref ref-type="bibr" rid="pcbi.1004912.ref023">23</xref>], it cannot correspond to expected activation signals because (i) the near instantaneous transitions are too sharp and (ii) the profiles do not build up while activated. These differences stem from the disparity between the modeled jump-diffusion process and the true build up of muscle activation. The sudden jumps in [<xref ref-type="bibr" rid="pcbi.1004912.ref025">25</xref>] capture the start and stop of neural excitation signals, but do not account for the time required for the slower calcium binding dynamics. Further, the muscle active state is known to rise faster than it decays [<xref ref-type="bibr" rid="pcbi.1004912.ref052">52</xref>]. This feature is not present in the Sanger model; the diffusion and jump rates are symmetric with respect to the derivative of <italic>x</italic>(<italic>t</italic>). Combining these facts it becomes clear that the hidden state <italic>x</italic>(<italic>t</italic>) more closely represents the neural excitation of the muscle than the muscle active state. To obtain an activation estimate, we apply activation dynamics in the form [<xref ref-type="bibr" rid="pcbi.1004912.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref027">27</xref>]
<disp-formula id="pcbi.1004912.e008"><alternatives><graphic id="pcbi.1004912.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close="]" open="[" separators=""><mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>act</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>deact</mml:mtext></mml:msub></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>≥</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>deact</mml:mtext></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
to the output of the Sanger algorithm <italic>x</italic>(<italic>t</italic>). Here <italic>a</italic> is muscle activation while <italic>τ</italic><sub><italic>act</italic></sub> and <italic>τ</italic><sub><italic>deact</italic></sub> are the activation and deactivation time constants, respectively. These time constants are known to depend on muscle fiber composition; the specific values used for each muscle in this study are given in <xref ref-type="supplementary-material" rid="pcbi.1004912.s002">S2 Text</xref>. The resulting estimate combines the timing inferred by the Sanger algorithm with the known biophysics of muscle activation.</p>
<p>The complete approach was implemented on collected EMG data using MATLAB (Mathworks, Natick, MA). The raw signal of each EMG data channel was preprocessed by removing the DC offset, clipping the signal beyond 5 standard deviations, normalizing to the resulting maximum value, and rectifying. The clipping was first included by Sanger to prevent the Bayesian algorithm from trying to estimate conditional densities from exceedingly rare values, which cannot be done accurately and likely result from artifacts. The data was then passed through the Sanger Bayesian algorithm described above to estimate the neural excitation <italic>x</italic>(<italic>t</italic>) of each muscle (link to source code in References). The diffusion and jump terms (<italic>α</italic> and <italic>β</italic>) in [<xref ref-type="bibr" rid="pcbi.1004912.ref025">25</xref>] were adjusted to 0.5 and 5 × 10<sup>−31</sup>, respectively, to allow weaker/shorter signals to more reliably be captured without introducing excess random jumps in the output signal or affecting its timing. The drawback of this tuning was a decrease in sharpness of the turn on/turn off of muscle excitations, but this would have occurred in the ensuing filtering and averaging anyway. The resulting excitations were re-normalized by values estimated during maximal voluntary contraction (MVC) trials. The MVC trials were processed in the same way with the average magnitude of the largest burst (of duration at least 1 s) being taken as the MVC value. Occasionally we found that an MVC trial was exceeded in fast walking trials; in that case we renormalized to the larger value and reprocessed. The normalized profiles were then thresholded to remove the noise floor and passed to the shaping filter (5) representing muscle activation dynamics, which was implemented using the ode15s (stiff/NDF) solver in MATLAB Simulink. The output activation profiles <italic>a</italic>(<italic>t</italic>) were broken into gait cycles, normalized temporally to percent gait cycle, and averaged. Gross outliers (about 10% of gait cycles) were again discarded; in this case additional error sources included motion artifacts and instances of poor electrode connection. The resulting average activation estimates are plotted at the speed of minimal MCOT for all subjects in <xref ref-type="fig" rid="pcbi.1004912.g003">Fig 3</xref>.</p>
<p>Unfortunately not all EMG channels provided satisfactory activation estimates, with low signal to noise ratios being observed particularly in muscles spanning the hip. This was caused by the relatively complicated geometry of that joint, the preponderance of associated motion artifacts, the muscles being located deep beneath the skin, and the relative lack of access to that area. Such problems can be minimized through the use of fine wire electrodes, as in [<xref ref-type="bibr" rid="pcbi.1004912.ref028">28</xref>], and in fact we found that the profiles in [<xref ref-type="bibr" rid="pcbi.1004912.ref028">28</xref>] could be used to more precisely estimate the turn on and turn off times of the neural excitation signals for the muscles spanning the hip than our surface measurements. Hence we used these literature profiles to produce neural excitation profiles for the iliacus, adductor longus, adductor magnus, gluteus maximus, and gluteus medius. The profiles were digitized using MATLAB, specifically the “ginput” function. The literature profiles were given in term of percent gait cycle; for each participant we resampled to make the duration of the profile match that of the subject’s average gait cycle. No amplitude renormalization was necessary. The resulting profiles were then passed through the dynamics (5) to produce activation estimates. In the infrequent event that the data from another muscle was not salvageable for a given subject, the trajectory of that muscle was taken to be the average of the trajectories for that muscle in all subjects where the measurement was acceptable. Further details and a statistical analysis of this approach are given in <xref ref-type="supplementary-material" rid="pcbi.1004912.s001">S1 Text</xref>.</p>
</sec>
</sec>
<sec id="sec012">
<title>Musculoskeletal Model</title>
<p>The processed data were used to build a dynamic model of the leg during walking (<xref ref-type="fig" rid="pcbi.1004912.g001">Fig 1</xref>). The model includes all muscles that make significant contributions to the components of ankle, knee, and hip torque perpendicular to the sagittal plane during walking. Several muscle groups were lumped together for simplicity; this was deemed appropriate if all muscles within a group had similar lines of action and were activated simultaneously during walking. These included the GAS group (medial and lateral gastrocnemius), the VAS group (vastus lateralis, medialis, and intermedius), the HAM group (semimembranosus, semitendinosus, and biceps femoris long head), and the ILL group (iliacus and psoas). Each muscle group had one effective tendon to represent the net compliance of the muscle’s interaction with the skeleton. In addition to the muscle-tendon units a passive ligament spanning the hip was included to allow for the recovery of elastic energy in that joint. This element represents the contributions of the iliofemoral, ischiofemoral, and pubofemoral ligaments as well as those of other connective tissue at the hip and was modeled using a nonlinear equation in [<xref ref-type="bibr" rid="pcbi.1004912.ref018">18</xref>]; for simplicity we took it to be a linear spring that only engages around the time the hip goes vertical and begins to extend [<xref ref-type="bibr" rid="pcbi.1004912.ref029">29</xref>]:
<disp-formula id="pcbi.1004912.e009"><alternatives><graphic id="pcbi.1004912.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mi>F</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>H</mml:mi> <mml:mi>F</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>h</mml:mi> <mml:mi>i</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi> <mml:mi>F</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
Note that both the moment and the angle in this equation were defined with flexion being positive. Below we describe the muscle, tendon, and joint dynamics of the system.</p>
<sec id="sec013">
<title>Muscle dynamics</title>
<p>All muscles in the model were taken to have Hill-type contraction dynamics similar to those described in [<xref ref-type="bibr" rid="pcbi.1004912.ref019">19</xref>]. Each muscle contains a contractile element (CE) that represents the active muscle fibers and a parallel elastic element (PE) that represents the elastic structures surrounding the muscle. The contractile element force <italic>F</italic><sub><italic>CE</italic></sub> depends on the muscle activation <italic>a</italic>, the contractile element length <italic>l</italic><sub><italic>CE</italic></sub>, and the contractile element velocity <italic>v</italic><sub><italic>CE</italic></sub>. The parallel elastic element force <italic>F</italic><sub><italic>PE</italic></sub> depends only on the contractile element length and engages only above the optimal fiber length <italic>l</italic><sub><italic>opt</italic></sub>. <italic>l</italic><sub><italic>opt</italic></sub> and the maximal isometric force <italic>F</italic><sub><italic>max</italic></sub> vary with muscle size while the maximal contractile element velocity <italic>v</italic><sub><italic>max</italic></sub> varies with muscle fiber composition. For further details on the implemented muscle model including predefined constants see <xref ref-type="supplementary-material" rid="pcbi.1004912.s002">S2 Text</xref>; for details on how the differential equations were solved see [<xref ref-type="bibr" rid="pcbi.1004912.ref019">19</xref>] and its accompanying source code.</p>
</sec>
<sec id="sec014">
<title>Tendon dynamics</title>
<p>As mentioned above, tendons are non-linear elastic elements that join muscle to bone. Their force-strain relation may be modeled by the general form [<xref ref-type="bibr" rid="pcbi.1004912.ref016">16</xref>]:
<disp-formula id="pcbi.1004912.e010"><alternatives><graphic id="pcbi.1004912.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>S</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext> <mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>h</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>λ</mml:mo></mml:mfenced> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>h</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>λ</mml:mo> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>λ</mml:mo> <mml:mo>≤</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
where
<disp-formula id="pcbi.1004912.e011"><alternatives><graphic id="pcbi.1004912.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>λ</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>S</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
is the strain of the tendon beyond its slack length <italic>l</italic><sub><italic>sl</italic></sub>. Here <italic>F</italic><sub><italic>max</italic></sub> is the maximum muscle isometric force, <italic>K</italic><sub><italic>sh</italic></sub> is a shape factor, and λ<sub><italic>ref</italic></sub> is a reference strain. <italic>K</italic><sub><italic>sh</italic></sub> determines where the force-length curve transitions from its flat lower (“toe”) region to its nearly linear behavior for large strains. λ<sub><italic>ref</italic></sub> is the strain where <italic>F</italic><sub><italic>SE</italic></sub> = <italic>F</italic><sub><italic>max</italic></sub>. These four parameters define the morphology of a particular tendon; <italic>F</italic><sub><italic>max</italic></sub> and <italic>l</italic><sub><italic>sl</italic></sub> scale with the size of the tendon while <italic>K</italic><sub><italic>sh</italic></sub> and λ<sub><italic>ref</italic></sub> depend on the material properties of the tendon.</p>
</sec>
<sec id="sec015">
<title>Muscle-tendon dynamics</title>
<p>Muscle and tendon act in series but are typically oriented obliquely, with the angle in between the two being known as the pennation angle. The forces exerted by the tendon (SE), muscle (M), and full muscle tendon complex are:
<disp-formula id="pcbi.1004912.e012"><alternatives><graphic id="pcbi.1004912.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mi>T</mml:mi> <mml:mi>C</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>S</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>l</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>cos</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
Here the muscle contractile element length <italic>l</italic><sub><italic>CE</italic></sub> represents the state variable. The total length of the muscle tendon complex is
<disp-formula id="pcbi.1004912.e013"><alternatives><graphic id="pcbi.1004912.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mi>T</mml:mi> <mml:mi>C</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>S</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>cos</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
The pennation angle <italic>θ</italic>(<italic>t</italic>) varies so as to keep the width of the muscle approximately constant [<xref ref-type="bibr" rid="pcbi.1004912.ref015">15</xref>] and can be written as a function of fascicle length:
<disp-formula id="pcbi.1004912.e014"><alternatives><graphic id="pcbi.1004912.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>p</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
Here the angle <italic>θ</italic><sub>0</sub> is the pennation angle when <italic>l</italic><sub><italic>CE</italic></sub> = <italic>l</italic><sub><italic>opt</italic></sub> (which is very near the resting length of the muscle [<xref ref-type="bibr" rid="pcbi.1004912.ref016">16</xref>]). It was found that allowing this angle to vary with fascicle length was necessary to obtain muscle fascicle trajectories that produced human-like metabolic cost estimates. The total muscle torque at a given joint is then the sum of all muscle-tendon unit forces multiplied by their respective time-varying moment arms <italic>r</italic><sub><italic>i</italic></sub>(<italic>t</italic>):
<disp-formula id="pcbi.1004912.e015"><alternatives><graphic id="pcbi.1004912.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>o</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mi>T</mml:mi> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
To resolve the redundancy in joint actuation, each time varying muscle-tendon force <italic>F</italic><sub><italic>MTC</italic>,<italic>i</italic></sub>(<italic>t</italic>) must be determined.</p>
</sec>
</sec>
<sec id="sec016">
<title>Optimization Inputs, Outputs, and Parameters</title>
<p>An overview of the applied optimization procedure is shown in <xref ref-type="fig" rid="pcbi.1004912.g002">Fig 2</xref>. There were two categories of inputs for each muscle in our model: (i) <italic>a</italic>(<italic>t</italic>), <italic>l</italic><sub><italic>mtc</italic></sub>(<italic>t</italic>), and <italic>r</italic><sub><italic>i</italic></sub>(<italic>t</italic>)- all estimated from the data and (ii) muscle-tendon morphological parameters <inline-formula id="pcbi.1004912.e016"><alternatives><graphic id="pcbi.1004912.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> which were identified via optimization. Morphological parameters which affect the Hill-type contraction dynamics of the modeled muscles include muscle maximum isometric force <italic>F</italic><sub><italic>max</italic></sub>, length where active muscle force is maximal <italic>l</italic><sub><italic>opt</italic></sub>, fiber composition <italic>FT</italic>, tendon slack length <italic>l</italic><sub><italic>sl</italic></sub>, tendon shape factor <italic>K</italic><sub><italic>sh</italic></sub>, and tendon reference strain λ<sub><italic>ref</italic></sub>. We evaluated the consequences of varying all of these variables, finding differing levels of sensitivity for each. The variables to which the model was insensitive were fixed, leaving <italic>F</italic><sub><italic>max</italic></sub>, <italic>K</italic><sub><italic>sh</italic></sub>, λ<sub><italic>ref</italic></sub>, and an overall scaling factor for <italic>l</italic><sub><italic>sl</italic></sub> and <italic>l</italic><sub><italic>opt</italic></sub> as the parameters to optimize. The last factor was chosen to ensure that the muscle operated in reasonable regions of its force-length space while preventing overfitting. The ratio <italic>l</italic><sub><italic>sl</italic></sub>/<italic>l</italic><sub><italic>opt</italic></sub> is known to vary significantly among muscles but not significantly in the same muscle among subjects [<xref ref-type="bibr" rid="pcbi.1004912.ref014">14</xref>], justifying this choice.</p>
<p>As mentioned above, our optimization is built on the hypothesis that the muscle-tendon morphologies of the muscles comprising the leg have evolved to minimize the metabolic cost of walking at the speed where the MCOT is minimal. This assumption is supported by the fundamental importance of bipedal walking as a means of transport and the tendency of humans to walk at or near this speed. For each subject we therefore sought a set of morphological parameters <inline-formula id="pcbi.1004912.e017"><alternatives><graphic id="pcbi.1004912.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> that match the measured joint torques at the ankle, knee, and hip while consuming a minimal amount of metabolic energy. This amounts to a dual objective optimization problem, with metabolic and kinetic cost functions being simultaneously minimized. The specific forms of these two costs are summarized below.</p>
<sec id="sec017">
<title>Metabolic cost estimation</title>
<p>Muscle metabolic consumption is known to depend on several factors including fascicle size, excitation level, activation level, length, velocity, force, and active force production [<xref ref-type="bibr" rid="pcbi.1004912.ref024">24</xref>]. For a given muscle in our model all of these quantities except for the excitation and activation levels depend on the muscle-tendon morphology and therefore vary across potential solutions. To model these effects we use the metabolic consumption model derived by Umberger et al [<xref ref-type="bibr" rid="pcbi.1004912.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1004912.ref034">34</xref>]. This function has demonstrated exceptional predictive power in a number of applications and is the most widely-accepted metabolic cost measure available. It expresses metabolic power per unit muscle mass <inline-formula id="pcbi.1004912.e018"><alternatives><graphic id="pcbi.1004912.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mover accent="true"><mml:mi>E</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> as the sum of four terms:
<disp-formula id="pcbi.1004912.e019"><alternatives><graphic id="pcbi.1004912.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>A</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>M</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>S</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
Here <inline-formula id="pcbi.1004912.e020"><alternatives><graphic id="pcbi.1004912.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the activation heat rate, which is associated with the transport of Ca<sup>2+</sup> ions from the sarcoplasmic reticulum. <inline-formula id="pcbi.1004912.e021"><alternatives><graphic id="pcbi.1004912.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>M</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the maintenance heat rate; both it and the shortening/lengthening heat rate <inline-formula id="pcbi.1004912.e022"><alternatives><graphic id="pcbi.1004912.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>S</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are due to actomyosin interaction. <inline-formula id="pcbi.1004912.e023"><alternatives><graphic id="pcbi.1004912.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the mechanical work rate of the contractile element, normalized to muscle mass. For a full mathematical description of these terms see [<xref ref-type="bibr" rid="pcbi.1004912.ref024">24</xref>] and the supplementary materials of [<xref ref-type="bibr" rid="pcbi.1004912.ref034">34</xref>].</p>
<p>To estimate full body metabolic cost, we integrate <inline-formula id="pcbi.1004912.e024"><alternatives><graphic id="pcbi.1004912.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mover accent="true"><mml:mi>E</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> for each muscle of the leg, multiply by each appropriate muscle mass, and sum. Bilateral symmetry was assumed as full data were collected for only one leg of each participant. For each muscle <italic>i</italic> the mass <italic>M</italic><sub><italic>i</italic></sub> was estimated using
<disp-formula id="pcbi.1004912.e025"><alternatives><graphic id="pcbi.1004912.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>ρ</mml:mi> <mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>p</mml:mi> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mi>σ</mml:mi></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
where <italic>ρ</italic> = 1059.7kgm<sup>−3</sup> and <italic>σ</italic> = 0.25MPa are the average density and specific tension of skeletal muscle, respectively. The metabolism for the rest of the body (excluding leg muscles) was estimated by multiplying the remaining mass by the measured basal rate <inline-formula id="pcbi.1004912.e026"><alternatives><graphic id="pcbi.1004912.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>a</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> ([W/kg]) of standing. The final metabolic cost in the model <italic>C</italic><sub><italic>met</italic></sub> in a time window T was then
<disp-formula id="pcbi.1004912.e027"><alternatives><graphic id="pcbi.1004912.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>e</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>M</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mfenced> <mml:mo>+</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>M</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mfenced> <mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>a</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mi>T</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
where <italic>M</italic> is total body mass and the sums were taken over all muscles in both legs.</p>
</sec>
<sec id="sec018">
<title>Kinetic cost function</title>
<p>In addition to minimizing metabolic cost, we sought solutions that most accurately reproduced the measured joint moments. We defined the corresponding cost <italic>C</italic><sub><italic>kin</italic></sub> as
<disp-formula id="pcbi.1004912.e028"><alternatives><graphic id="pcbi.1004912.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>n</mml:mi> <mml:mi>k</mml:mi> <mml:mi>l</mml:mi> <mml:mi>e</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>R</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi> <mml:mi>e</mml:mi> <mml:mi>e</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>R</mml:mi> <mml:mrow><mml:mi>h</mml:mi> <mml:mi>i</mml:mi> <mml:mi>p</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow> <mml:mn>3</mml:mn></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where the <italic>R</italic><sup>2</sup> values are the coefficients of determination between the modeled and observed joint torques.</p>
</sec>
</sec>
<sec id="sec019">
<title>System Identification Procedure</title>
<p>As mentioned above, optimal muscle-tendon parameters were identified using a dual objective optimization. Fifty morphological parameters were optimized for each subject; four morphological parameters for each of the twelve modeled muscles and two additional parameters describing the hip flexor ligament. The chosen muscle-tendon parameter bounds are shown in <xref ref-type="table" rid="pcbi.1004912.t004">Table 4</xref>. The maximum isometric force (<italic>F</italic><sub><italic>max</italic></sub>) values for each muscle were constrained to fall in a window surrounding the scaled value from SIMM. The large width of this window helped to compensate for uncertainties in the EMG normalization (via MVC values, as discussed above). The scaling factor for <italic>l</italic><sub><italic>slack</italic></sub> and <italic>l</italic><sub><italic>opt</italic></sub> was chosen to ensure that the muscle fascicle length stayed within reasonable physiological operating ranges. The bounds for <italic>K</italic><sub><italic>sh</italic></sub> and λ<sub><italic>ref</italic></sub> were taken from [<xref ref-type="bibr" rid="pcbi.1004912.ref016">16</xref>]. The bounds for the spring constant of the hip flexor ligament was chosen so that the ligament could provide anywhere from none to all of the required hip flexion moment near toe off. The engagement angle was chosen so that the tendon could turn on with the hip no more than 10° flexed, as its physiological role is to prevent overextension.</p>
<table-wrap id="pcbi.1004912.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.t004</object-id>
<label>Table 4</label>
<caption>
<title>Optimization problem parameter bounds.</title>
<p>The maximum isometric force (<italic>F</italic><sub><italic>max</italic></sub>) values for each muscle were constrained to fall in a fairly wide window surrounding the scaled value from SIMM. The scaling factor for <italic>l</italic><sub><italic>slack</italic></sub> and <italic>l</italic><sub><italic>opt</italic></sub> was chosen to ensure that each muscle fascicle length stayed within physical operating ranges. Here the parameter <italic>w</italic> governs the width of the active force-length relation of the muscle; its value varies by muscle and all values are given in <xref ref-type="supplementary-material" rid="pcbi.1004912.s002">S2 Text</xref>. The bounds for <italic>K</italic><sub><italic>sh</italic></sub> and λ<sub><italic>ref</italic></sub> were taken from [<xref ref-type="bibr" rid="pcbi.1004912.ref016">16</xref>]. The bounds for the spring constant of the hip flexor ligament was chosen so that the ligament could provide anywhere from none to all of the required hip flexion moment near toe off. The engagement angle was chosen so that the tendon could engage with the hip no more than 10° flexed, as its physiological role is to prevent overextension.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004912.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Parameter</th>
<th align="center">Lower Bound</th>
<th align="center">Upper Bound</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><italic>F</italic><sub><italic>max</italic></sub></td>
<td align="center">0.5*<italic>F</italic><sub><italic>max</italic>,<italic>SIMM</italic></sub></td>
<td align="center">3.0*<italic>F</italic><sub><italic>max</italic>,<italic>SIMM</italic></sub></td>
</tr>
<tr>
<td align="center"><italic>l</italic><sub><italic>sl</italic></sub>,<italic>l</italic><sub><italic>opt</italic></sub> mult.</td>
<td align="center">Ensure <italic>l</italic><sub><italic>m</italic></sub> &lt; <italic>l</italic><sub><italic>opt</italic></sub>(1 + <italic>w</italic>)</td>
<td align="center">Ensure <italic>l</italic><sub><italic>m</italic></sub> ≥ <italic>l</italic><sub><italic>opt</italic></sub>(1−<italic>w</italic>)</td>
</tr>
<tr>
<td align="center"><italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">λ<sub><italic>ref</italic></sub></td>
<td align="center">0.02</td>
<td align="center">0.09</td>
</tr>
<tr>
<td align="center"><italic>θ</italic><sub><italic>HFL</italic></sub></td>
<td align="center">−<italic>π</italic>/18</td>
<td align="center">|min(<italic>θ</italic><sub><italic>hip</italic></sub>)|</td>
</tr>
<tr>
<td align="center"><italic>K</italic><sub><italic>HFL</italic></sub></td>
<td align="center">0</td>
<td align="center">2*max(<italic>τ</italic><sub><italic>hip</italic></sub>)/|min(<italic>θ</italic><sub><italic>hip</italic></sub>)|</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The model was constructed using MATLAB and Simulink and integrated using the ode15s (stiff/NDF) solver. Computations were parallelized and carried out using the Mathworks Cloud Center, a computer cluster operated through Amazon Web Services. This resource proved useful as our runs were configured to test many solutions and took about 10 hours to run on a single CPU. The optimization algorithm employed was MATLAB’s gamultiobj, a controlled elitist genetic algorithm that is a variant of the NSGA-II algorithm [<xref ref-type="bibr" rid="pcbi.1004912.ref030">30</xref>]. This method was chosen because of the likely presence of local minima in both objectives and tuned as shown in <xref ref-type="table" rid="pcbi.1004912.t005">Table 5</xref>. Optimization tunings were chosen to ensure generations sufficiently large to force the optimizer to thoroughly search the space, eliminating the need for population seeding. Each trial solution was allowed to run for two gait cycles, with only the results of the second gait cycle being considered. This removed initial transient effects and allowed evaluation of the system over the full gait cycle.</p>
<table-wrap id="pcbi.1004912.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.t005</object-id>
<label>Table 5</label>
<caption>
<title>Optimization settings in MATLAB.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004912.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.t005" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Optimizer Setting</th>
<th align="center">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">PopulationSize</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">EliteCount</td>
<td align="center">25</td>
</tr>
<tr>
<td align="center">Generations</td>
<td align="center">100</td>
</tr>
<tr>
<td align="center">MutationFcn</td>
<td align="center">mutationadaptfeasible</td>
</tr>
<tr>
<td align="center">CrossoverFraction</td>
<td align="center">0.8</td>
</tr>
<tr>
<td align="center">Vectorized</td>
<td align="center">On</td>
</tr>
<tr>
<td align="center">PopInitRange</td>
<td align="center">Full Space</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<sec id="sec020">
<title>Choosing an optimal solution</title>
<p>The result of our multi-objective optimization is a Pareto Front, a set of solutions where one cost function cannot be further reduced without compromising on another. In the ideal case this front consists of one solution where all objectives are optimized; however this rarely occurs in noisy systems. Our dual objective optimization leads to a rounded Pareto Front, from which we chose one “best” solution.</p>
<p>As can be seen in <xref ref-type="fig" rid="pcbi.1004912.g004">Fig 4</xref>, our Pareto optimal solutions are composed of three regions. The solutions in the lower left represent relatively low metabolic cost but fail to track the observed joint torque profiles. The performance of these solutions is typically accounted for by small <italic>F</italic><sub><italic>max</italic></sub> values; minimizing these parameters causes metabolically inexpensive but weak muscle forces. In the upper right corner are solutions with excellent kinetic agreement but high metabolic costs. These solutions essentially overfit the observed torque profiles by driving one or more muscles harder than is physically reasonable. This effort is required to maximize the kinetic fit because of deficiencies in the data, particularly in the EMG measurements. The solutions that represent the human should be somewhere between these two extremes, producing a good kinetic fit at a reasonable metabolic cost.</p>
<p>In order to choose a solution in the biologically plausible region, we consulted the metabolic energy budget of each subject. <xref ref-type="fig" rid="pcbi.1004912.g005">Fig 5</xref> shows a polynomial fit of the fraction of full body metabolic cost consumed by each modeled muscle as a function of kinetic fit (quantified by average joint torque <italic>R</italic><sup>2</sup>) along the Pareto Front for each participant. The fractions represent the sum over both legs and take basal expenditures into account. As can be seen from the plots, the budget is fairly consistent for low to moderate kinetic fit and MCOT, then sees a few muscles begin to dominate as the high <italic>R</italic><sup>2</sup> and metabolic cost range is approached. Typically one to three muscles overexert themselves to force a marginally better kinetic fit, causing the metabolic cost distribution to differ significantly from more reasonable energies. Physically this would lead to fatigue of the muscle in question, or in it being modeled as much larger than its actual size (since muscle mass is taken to be proportional to <italic>F</italic><sub><italic>max</italic></sub>). <xref ref-type="fig" rid="pcbi.1004912.g005">Fig 5</xref> shows that the vastus (VAS) muscle group provides the largest contribution to metabolic cost for each participant and ramps up its fractional contribution as kinetic fit is maximized. This is caused by the large size of the vastus and the tendency of the optimizer to throw progressively more energy into it if the knee extension moment in early stance is inadequate. Given the importance of this muscle to the overall metabolic budget and its consistent ramp up, we chose to use it for selecting an optimal solution.</p>
<p>To find our optimal solutions, we first fit the trends in fractional metabolic cost as a function of kinetic fit with a fifth order polynomial, as shown in <xref ref-type="fig" rid="pcbi.1004912.g005">Fig 5</xref>. We then considered the relative change in vastus fractional metabolic consumption Δ<sub><italic>VAS</italic></sub>:
<disp-formula id="pcbi.1004912.e029"><alternatives><graphic id="pcbi.1004912.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>V</mml:mi> <mml:mi>A</mml:mi> <mml:mi>S</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>V</mml:mi> <mml:mi>A</mml:mi> <mml:mi>S</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>V</mml:mi> <mml:mi>A</mml:mi> <mml:mi>S</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>min</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>V</mml:mi> <mml:mi>A</mml:mi> <mml:mi>S</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>max</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>V</mml:mi> <mml:mi>A</mml:mi> <mml:mi>S</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>min</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula></p>
<p>Here <italic>F</italic><sub><italic>VAS</italic></sub> represents the fraction of overall metabolic cost attributed to the vastus, as a function of the mean coefficient of determination for the kinetic fit (<italic>R</italic><sup>2</sup>). We found that choosing Δ<sub><italic>VAS</italic>,<italic>opt</italic></sub> = 0.63 as a cutoff allowed us to quantitatively match the experimental metabolic costs in four out of five participants and led to an average MCOT error smaller than 0.01. This cutoff is represented by the dotted blue vertical lines in <xref ref-type="fig" rid="pcbi.1004912.g005">Fig 5</xref>, with the vertical black lines representing the uncertainty in the experimental measurement. Both sets of vertical lines were obtained by mapping the <italic>R</italic><sup>2</sup> values listed on the x-axis in <xref ref-type="fig" rid="pcbi.1004912.g005">Fig 5</xref> to their corresponding metabolic costs in the solutions shown in <xref ref-type="fig" rid="pcbi.1004912.g004">Fig 4</xref>. The chosen optimal solution was taken to be the point with maximal kinetic fit along the Pareto Front that had Δ<sub><italic>VAS</italic></sub> &lt; Δ<sub><italic>VAS</italic>,<italic>opt</italic></sub>. In <xref ref-type="fig" rid="pcbi.1004912.g004">Fig 4</xref>, this point is represented as a white diamond on the solution space plot of each participant. The full parameter sets for these optimal solutions are displayed in <xref ref-type="table" rid="pcbi.1004912.t006">Table 6</xref>. For reference a list of frequently used abbreviations and symbols is given in <xref ref-type="table" rid="pcbi.1004912.t007">Table 7</xref>.</p>
<table-wrap id="pcbi.1004912.t006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.t006</object-id>
<label>Table 6</label>
<caption>
<title>Parameter values for the chosen optimal solution for each participant.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004912.t006g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.t006" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Parameter</th>
<th align="center">Participant 1</th>
<th align="center">Participant 2</th>
<th align="center">Participant 3</th>
<th align="center">Participant 4</th>
<th align="center">Participant 5</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">TA <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">477</td>
<td align="center">874</td>
<td align="center">523</td>
<td align="center">497</td>
<td align="center">617</td>
</tr>
<tr>
<td align="center">TA <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.214</td>
<td align="center">0.192</td>
<td align="center">0.210</td>
<td align="center">0.191</td>
<td align="center">0.193</td>
</tr>
<tr>
<td align="center">TA λ<sub><italic>ref</italic></sub></td>
<td align="center">0.040</td>
<td align="center">0.057</td>
<td align="center">0.045</td>
<td align="center">0.069</td>
<td align="center">0.061</td>
</tr>
<tr>
<td align="center">TA <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.19</td>
<td align="center">2.33</td>
<td align="center">2.73</td>
<td align="center">2.45</td>
<td align="center">2.97</td>
</tr>
<tr>
<td align="center">SOL <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">3974</td>
<td align="center">4632</td>
<td align="center">4219</td>
<td align="center">1992</td>
<td align="center">3858</td>
</tr>
<tr>
<td align="center">SOL <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.282</td>
<td align="center">0.244</td>
<td align="center">0.266</td>
<td align="center">0.255</td>
<td align="center">0.253</td>
</tr>
<tr>
<td align="center">SOL λ<sub><italic>ref</italic></sub></td>
<td align="center">0.061</td>
<td align="center">0.080</td>
<td align="center">0.064</td>
<td align="center">0.048</td>
<td align="center">0.051</td>
</tr>
<tr>
<td align="center">SOL <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.90</td>
<td align="center">2.98</td>
<td align="center">2.51</td>
<td align="center">2.76</td>
<td align="center">3.31</td>
</tr>
<tr>
<td align="center">GAS <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">2075</td>
<td align="center">1819</td>
<td align="center">1816</td>
<td align="center">1616</td>
<td align="center">2278</td>
</tr>
<tr>
<td align="center">GAS <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.438</td>
<td align="center">0.369</td>
<td align="center">0.411</td>
<td align="center">0.382</td>
<td align="center">0.385</td>
</tr>
<tr>
<td align="center">GAS λ<sub><italic>ref</italic></sub></td>
<td align="center">0.047</td>
<td align="center">0.053</td>
<td align="center">0.051</td>
<td align="center">0.047</td>
<td align="center">0.051</td>
</tr>
<tr>
<td align="center">GAS <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.49</td>
<td align="center">2.93</td>
<td align="center">2.86</td>
<td align="center">2.93</td>
<td align="center">3.81</td>
</tr>
<tr>
<td align="center">VAS <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">3864</td>
<td align="center">3229</td>
<td align="center">8141</td>
<td align="center">4472</td>
<td align="center">4827</td>
</tr>
<tr>
<td align="center">VAS <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.192</td>
<td align="center">0.162</td>
<td align="center">0.177</td>
<td align="center">0.167</td>
<td align="center">0.171</td>
</tr>
<tr>
<td align="center">VAS λ<sub><italic>ref</italic></sub></td>
<td align="center">0.055</td>
<td align="center">0.056</td>
<td align="center">0.052</td>
<td align="center">0.061</td>
<td align="center">0.079</td>
</tr>
<tr>
<td align="center">VAS <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.00</td>
<td align="center">2.73</td>
<td align="center">3.03</td>
<td align="center">2.61</td>
<td align="center">2.86</td>
</tr>
<tr>
<td align="center">BFSH <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">317</td>
<td align="center">289</td>
<td align="center">404</td>
<td align="center">358</td>
<td align="center">398</td>
</tr>
<tr>
<td align="center">BFSH <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.156</td>
<td align="center">0.110</td>
<td align="center">0.147</td>
<td align="center">0.133</td>
<td align="center">0.116</td>
</tr>
<tr>
<td align="center">BFSH λ<sub><italic>ref</italic></sub></td>
<td align="center">0.052</td>
<td align="center">0.058</td>
<td align="center">0.063</td>
<td align="center">0.067</td>
<td align="center">0.055</td>
</tr>
<tr>
<td align="center">BFSH <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.15</td>
<td align="center">2.40</td>
<td align="center">2.85</td>
<td align="center">2.60</td>
<td align="center">2.48</td>
</tr>
<tr>
<td align="center">RF <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">681</td>
<td align="center">888</td>
<td align="center">1293</td>
<td align="center">511</td>
<td align="center">621</td>
</tr>
<tr>
<td align="center">RF <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.408</td>
<td align="center">0.353</td>
<td align="center">0.381</td>
<td align="center">0.369</td>
<td align="center">0.371</td>
</tr>
<tr>
<td align="center">RF λ<sub><italic>ref</italic></sub></td>
<td align="center">0.067</td>
<td align="center">0.060</td>
<td align="center">0.059</td>
<td align="center">0.071</td>
<td align="center">0.054</td>
</tr>
<tr>
<td align="center">RF <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.93</td>
<td align="center">2.22</td>
<td align="center">3.05</td>
<td align="center">2.76</td>
<td align="center">3.03</td>
</tr>
<tr>
<td align="center">HAM <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">1503</td>
<td align="center">1189</td>
<td align="center">1694</td>
<td align="center">1177</td>
<td align="center">1232</td>
</tr>
<tr>
<td align="center">HAM <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.410</td>
<td align="center">0.343</td>
<td align="center">0.385</td>
<td align="center">0.386</td>
<td align="center">0.387</td>
</tr>
<tr>
<td align="center">HAM λ<sub><italic>ref</italic></sub></td>
<td align="center">0.067</td>
<td align="center">0.051</td>
<td align="center">0.058</td>
<td align="center">0.060</td>
<td align="center">0.073</td>
</tr>
<tr>
<td align="center">HAM <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.30</td>
<td align="center">2.11</td>
<td align="center">2.90</td>
<td align="center">2.46</td>
<td align="center">2.67</td>
</tr>
<tr>
<td align="center">ILL <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">713</td>
<td align="center">737</td>
<td align="center">991</td>
<td align="center">560</td>
<td align="center">1079</td>
</tr>
<tr>
<td align="center">ILL <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.103</td>
<td align="center">0.119</td>
<td align="center">0.118</td>
<td align="center">0.105</td>
<td align="center">0.107</td>
</tr>
<tr>
<td align="center">ILL λ<sub><italic>ref</italic></sub></td>
<td align="center">0.067</td>
<td align="center">0.061</td>
<td align="center">0.057</td>
<td align="center">0.047</td>
<td align="center">0.059</td>
</tr>
<tr>
<td align="center">ILL <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.16</td>
<td align="center">2.60</td>
<td align="center">2.46</td>
<td align="center">2.30</td>
<td align="center">3.15</td>
</tr>
<tr>
<td align="center">GMAX <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">1405</td>
<td align="center">1452</td>
<td align="center">1074</td>
<td align="center">973</td>
<td align="center">1035</td>
</tr>
<tr>
<td align="center">GMAX <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.109</td>
<td align="center">0.114</td>
<td align="center">0.125</td>
<td align="center">0.115</td>
<td align="center">0.110</td>
</tr>
<tr>
<td align="center">GMAX λ<sub><italic>ref</italic></sub></td>
<td align="center">0.070</td>
<td align="center">0.060</td>
<td align="center">0.056</td>
<td align="center">0.048</td>
<td align="center">0.056</td>
</tr>
<tr>
<td align="center">GMAX <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.63</td>
<td align="center">2.86</td>
<td align="center">3.02</td>
<td align="center">2.33</td>
<td align="center">3.35</td>
</tr>
<tr>
<td align="center">GMED <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">1266</td>
<td align="center">1311</td>
<td align="center">1376</td>
<td align="center">1011</td>
<td align="center">1508</td>
</tr>
<tr>
<td align="center">GMED <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.054</td>
<td align="center">0.057</td>
<td align="center">0.052</td>
<td align="center">0.058</td>
<td align="center">0.053</td>
</tr>
<tr>
<td align="center">GMED λ<sub><italic>ref</italic></sub></td>
<td align="center">0.051</td>
<td align="center">0.051</td>
<td align="center">0.056</td>
<td align="center">0.049</td>
<td align="center">0.056</td>
</tr>
<tr>
<td align="center">GMED <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.79</td>
<td align="center">2.67</td>
<td align="center">3.05</td>
<td align="center">2.45</td>
<td align="center">3.14</td>
</tr>
<tr>
<td align="center">ADDL <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">403</td>
<td align="center">353</td>
<td align="center">447</td>
<td align="center">337</td>
<td align="center">628</td>
</tr>
<tr>
<td align="center">ADDL <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.119</td>
<td align="center">0.115</td>
<td align="center">0.105</td>
<td align="center">0.097</td>
<td align="center">0.103</td>
</tr>
<tr>
<td align="center">ADDL λ<sub><italic>ref</italic></sub></td>
<td align="center">0.048</td>
<td align="center">0.060</td>
<td align="center">0.057</td>
<td align="center">0.042</td>
<td align="center">0.050</td>
</tr>
<tr>
<td align="center">ADDL <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.19</td>
<td align="center">2.00</td>
<td align="center">2.99</td>
<td align="center">2.67</td>
<td align="center">3.80</td>
</tr>
<tr>
<td align="center">ADDM <italic>F</italic><sub><italic>max</italic></sub> (N)</td>
<td align="center">805</td>
<td align="center">874</td>
<td align="center">851</td>
<td align="center">758</td>
<td align="center">1054</td>
</tr>
<tr>
<td align="center">ADDM <italic>l</italic><sub><italic>sl</italic></sub>, <italic>l</italic><sub><italic>opt</italic></sub> scaling</td>
<td align="center">0.138</td>
<td align="center">0.109</td>
<td align="center">0.131</td>
<td align="center">0.126</td>
<td align="center">0.127</td>
</tr>
<tr>
<td align="center">ADDM λ<sub><italic>ref</italic></sub></td>
<td align="center">0.069</td>
<td align="center">0.053</td>
<td align="center">0.055</td>
<td align="center">0.044</td>
<td align="center">0.053</td>
</tr>
<tr>
<td align="center">ADDM <italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="center">2.28</td>
<td align="center">2.59</td>
<td align="center">2.80</td>
<td align="center">2.43</td>
<td align="center">3.61</td>
</tr>
<tr>
<td align="center"><italic>K</italic><sub><italic>HFL</italic></sub> (Nm)</td>
<td align="center">193</td>
<td align="center">142</td>
<td align="center">567</td>
<td align="center">128</td>
<td align="center">319</td>
</tr>
<tr>
<td align="center"><italic>θ</italic><sub>0,<italic>HFL</italic></sub> (rad)</td>
<td align="center">0.040</td>
<td align="center">-0.023</td>
<td align="center">-0.050</td>
<td align="center">0.045</td>
<td align="center">0.006</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pcbi.1004912.t007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004912.t007</object-id>
<label>Table 7</label>
<caption>
<title>Frequently Used Abbreviations and Symbols.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004912.t007g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.t007" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>F</italic><sub><italic>max</italic></sub></td>
<td align="left">Maximal muscle isometric force</td>
</tr>
<tr>
<td align="left"><italic>l</italic><sub><italic>sl</italic></sub></td>
<td align="left">Tendon slack length</td>
</tr>
<tr>
<td align="left"><italic>l</italic><sub><italic>opt</italic></sub></td>
<td align="left">Optimal muscle length</td>
</tr>
<tr>
<td align="left"><italic>K</italic><sub><italic>sh</italic></sub></td>
<td align="left">Tendon force-length shape factor</td>
</tr>
<tr>
<td align="left">λ<sub><italic>ref</italic></sub></td>
<td align="left">Tendon reference strain</td>
</tr>
<tr>
<td align="left"><italic>K</italic><sub><italic>HFL</italic></sub></td>
<td align="left">Iliofemoral/hip flexor ligament spring constant</td>
</tr>
<tr>
<td align="left"><italic>θ</italic><sub>0,<italic>HFL</italic></sub></td>
<td align="left">Hip flexor ligament engagement angle</td>
</tr>
<tr>
<td align="left"><italic>l</italic><sub><italic>m</italic></sub>, <italic>l</italic><sub><italic>ce</italic></sub></td>
<td align="left">Muscle fascicle/contractile element length (same)</td>
</tr>
<tr>
<td align="left"><italic>v</italic><sub><italic>m</italic></sub>, <italic>v</italic><sub><italic>ce</italic></sub></td>
<td align="left">Muscle fascicle/contracitle element velocity (same)</td>
</tr>
<tr>
<td align="left"><italic>v</italic><sub><italic>max</italic></sub></td>
<td align="left">Maximum muscle fascicle velocity</td>
</tr>
<tr>
<td align="left"><italic>θ</italic>(<italic>t</italic>)</td>
<td align="left">Muscle pennation angle as a function of time</td>
</tr>
<tr>
<td align="left"><italic>l</italic><sub><italic>mHS</italic></sub></td>
<td align="left">Muscle fascicle length at heel strike</td>
</tr>
<tr>
<td align="left">
<inline-formula id="pcbi.1004912.e030">
<alternatives>
<graphic id="pcbi.1004912.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e030" xlink:type="simple"/>
<mml:math display="inline" id="M30">
<mml:mover accent="true">
<mml:mo>m</mml:mo>
<mml:mo>→</mml:mo>
</mml:mover>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">Morphological parameter vector</td>
</tr>
<tr>
<td align="left">
<inline-formula id="pcbi.1004912.e031">
<alternatives>
<graphic id="pcbi.1004912.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004912.e031" xlink:type="simple"/>
<mml:math display="inline" id="M31">
<mml:mover accent="true">
<mml:mo>E</mml:mo>
<mml:mo>˙</mml:mo>
</mml:mover>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">Metabolic consumption</td>
</tr>
<tr>
<td align="left"><italic>x</italic>(<italic>t</italic>)</td>
<td align="left">Muscle excitation</td>
</tr>
<tr>
<td align="left"><italic>a</italic>(<italic>t</italic>)</td>
<td align="left">Muscle activation</td>
</tr>
<tr>
<td align="left"><italic>r</italic>(<italic>t</italic>)</td>
<td align="left">Muscle moment arm</td>
</tr>
<tr>
<td align="left"><italic>τ</italic>(<italic>t</italic>)</td>
<td align="left">Torque</td>
</tr>
<tr>
<td align="left"><italic>R</italic><sup>2</sup></td>
<td align="left">Coefficient of determination</td>
</tr>
<tr>
<td align="left">TA</td>
<td align="left">Tibialis anterior</td>
</tr>
<tr>
<td align="left">SOL</td>
<td align="left">Soleus</td>
</tr>
<tr>
<td align="left">GAS</td>
<td align="left">Gastrocnemius</td>
</tr>
<tr>
<td align="left">VAS</td>
<td align="left">Vastus</td>
</tr>
<tr>
<td align="left">BFSH</td>
<td align="left">Biceps femoris short head</td>
</tr>
<tr>
<td align="left">RF</td>
<td align="left">Rectus femoris</td>
</tr>
<tr>
<td align="left">HAM</td>
<td align="left">Hamstring</td>
</tr>
<tr>
<td align="left">ILL</td>
<td align="left">Illiacus</td>
</tr>
<tr>
<td align="left">ADDL</td>
<td align="left">Adductor Longus</td>
</tr>
<tr>
<td align="left">ADDM</td>
<td align="left">Adductor Magnus</td>
</tr>
<tr>
<td align="left">HAB</td>
<td align="left">Hip abductors</td>
</tr>
<tr>
<td align="left">GLU</td>
<td align="left">Gluteus maximus</td>
</tr>
<tr>
<td align="left">GC</td>
<td align="left">Gait cycle</td>
</tr>
<tr>
<td align="left">EMG</td>
<td align="left">Electromyography</td>
</tr>
<tr>
<td align="left">MVC</td>
<td align="left">Maximal Voluntary Contraction</td>
</tr>
<tr>
<td align="left">MCOT</td>
<td align="left">Metabolic Cost of Transport</td>
</tr>
<tr>
<td align="left">MTU/MTC</td>
<td align="left">Muscle tendon unit/complex (same)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
</sec>
<sec id="sec021">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004912.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Addressing missing EMG data.</title>
<p>Discusses the methods employed when EMG data (particularly in the muscles spanning the hip) were not adequate for analysis.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004912.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Hill-type muscle dynamics.</title>
<p>Provides the mathematical details of the modeled contraction dynamics as well as muscle-specific parameters.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004912.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004912.s003" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Choosing an optimal solution.</title>
<p>Describes the method used to pick one optimal solution for each dual objective optimization problem and provides the resulting optimal muscle-tendon parameters for each participant.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We wish to thank Peter Loan, Brian Umberger, and Bruce Deffenbaugh for their help in building this model. We would also like to thank Daniel Lieberman for allowing us to use his laboratory to collect the data used in this study.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004912.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chao</surname> <given-names>EY</given-names></name>, <name name-style="western"><surname>An</surname> <given-names>KN</given-names></name>. <article-title>Graphical Interpretation of the solution to the redundant problem in biomechanics</article-title>. <source>J Biomech. Engng</source> <year>1978</year>;<volume>100</volume>(<issue>3</issue>):<fpage>159</fpage>–<lpage>167</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1115/1.3426207" xlink:type="simple">10.1115/1.3426207</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yamaguchi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Morana</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>J</surname> <given-names>S</given-names></name>. <article-title>A computationally efficient method for solving the redundant problem in biomechanics</article-title>. <source>J Biomech</source>. <year>1995</year>;<volume>28</volume>:<fpage>999</fpage>–<lpage>1005</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0021-9290(94)00145-T" xlink:type="simple">10.1016/0021-9290(94)00145-T</ext-link></comment> <object-id pub-id-type="pmid">7673268</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref003">
<label>3</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kandel</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Schwartz</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Jessell</surname> <given-names>TM</given-names></name>. <source>Principles of Neural Science</source>. <edition>4th ed</edition>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>McGraw-Hill</publisher-name>; <year>2000</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Clancy</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Morin</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Merletti</surname> <given-names>R</given-names></name>. <article-title>Sampling, noise-reduction and amplitude estimation issues in surface electromyography</article-title>. <source>Journal of Electromyography and Kinesiology</source>. <year>2002</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1050-6411(01)00033-5" xlink:type="simple">10.1016/S1050-6411(01)00033-5</ext-link></comment> <object-id pub-id-type="pmid">11804807</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hogan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Mann</surname> <given-names>RW</given-names></name>. <article-title>Myoelectric Signal Processing: Optimal Estimation Applied to Electromyography- Part II: Experimental Demonstration of Optimal Myoprocessor Performance</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>1980</year>;<volume>27</volume>(<issue>7</issue>):<fpage>396</fpage>–<lpage>410</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TBME.1980.326653" xlink:type="simple">10.1109/TBME.1980.326653</ext-link></comment> <object-id pub-id-type="pmid">7409805</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hogan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Mann</surname> <given-names>RW</given-names></name>. <article-title>Myoelectric Signal Processing: Optimal Estimation Applied to Electromyography- Part I: Derivation of the Optimal Myoprocessor</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>1980</year>;<volume>27</volume>(<issue>7</issue>):<fpage>382</fpage>–<lpage>395</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TBME.1980.326652" xlink:type="simple">10.1109/TBME.1980.326652</ext-link></comment> <object-id pub-id-type="pmid">7409804</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fukunaga</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kubo</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kawakami</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Fukashiro</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kanehisa</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Maganaris</surname> <given-names>CN</given-names></name>. <article-title>In vivo behaviour of human muscle tendon during walking</article-title>. <source>Proceedings Biological sciences / The Royal Society</source>. <year>2001</year> <month>Feb</month>;<volume>268</volume>(<issue>1464</issue>):<fpage>229</fpage>–<lpage>33</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1088596&amp;tool=pmcentrez&amp;rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1088596&amp;tool=pmcentrez&amp;rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.2000.1361" xlink:type="simple">10.1098/rspb.2000.1361</ext-link></comment> <object-id pub-id-type="pmid">11217891</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ishikawa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Komi</surname> <given-names>PV</given-names></name>, <name name-style="western"><surname>Grey</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Lepola</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Bruggemann</surname> <given-names>GP</given-names></name>. <article-title>Muscle-tendon interaction and elastic energy usage in human walking</article-title>. <source>Journal of applied physiology (Bethesda, Md: 1985)</source>. <year>2005</year> <month>Aug</month>;<volume>99</volume>(<issue>2</issue>):<fpage>603</fpage>–<lpage>8</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/15845776" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/15845776</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/japplphysiol.00189.2005" xlink:type="simple">10.1152/japplphysiol.00189.2005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lichtwark</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Bougoulias</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>AM</given-names></name>. <article-title>Muscle fascicle and series elastic element length changes along the length of the human gastrocnemius during walking and running</article-title>. <source>Journal of Biomechanics</source>. <year>2007</year>;<volume>40</volume>:<fpage>157</fpage>–<lpage>164</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jbiomech.2005.10.035" xlink:type="simple">10.1016/j.jbiomech.2005.10.035</ext-link></comment> <object-id pub-id-type="pmid">16364330</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chleboun</surname> <given-names>GS</given-names></name>. <article-title>Fascicle Length Change of the Human Tibialis Anterior and Vastus Lateralis During Walking</article-title>. <source>Journal of Orthopaedic and Sports Physical Therapy</source>. <year>2007</year> <month>Jul</month>;<volume>37</volume>(<issue>7</issue>):<fpage>372</fpage>–<lpage>379</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.jospt.org/issues/id.1286/article_detail.asp" xlink:type="simple">http://www.jospt.org/issues/id.1286/article_detail.asp</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2519/jospt.2007.2440" xlink:type="simple">10.2519/jospt.2007.2440</ext-link></comment> <object-id pub-id-type="pmid">17710906</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rubenson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pires</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Loi</surname> <given-names>HO</given-names></name>, <name name-style="western"><surname>Pinniger</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Shannon</surname> <given-names>DG</given-names></name>. <article-title>On the ascent: the soleus operating length is conserved to the ascending limb of the force-length curve across gait mechanics in humans</article-title>. <source>Journal of Experimental Biology</source> <year>2012</year>; <volume>215</volume>: <fpage>3539</fpage>–<lpage>3551</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1242/jeb.070466" xlink:type="simple">10.1242/jeb.070466</ext-link></comment> <object-id pub-id-type="pmid">22771749</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Farris</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Sawicki</surname> <given-names>GS</given-names></name>. <article-title>Human medial gastrocnemius force-velocity behavior shifts with locomotion speed and gait</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2012</year> <month>Jan</month>; <volume>109</volume>(<issue>3</issue>): <fpage>977</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1107972109" xlink:type="simple">10.1073/pnas.1107972109</ext-link></comment> <object-id pub-id-type="pmid">22219360</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lai</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lichtwark</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Schache</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>Y-C</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>NAT</given-names></name>, <name name-style="western"><surname>Pandy</surname> <given-names>MG</given-names></name>. <article-title>In vivo behavior of the human soleus muscle with increasing walking and running speeds</article-title>. <source>Journal of Applied Physiology</source>. <year>2015</year> <month>May</month>; <volume>118</volume>(<issue>10</issue>):<fpage>1266</fpage>–<lpage>1275</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/japplphysiol.00128.2015" xlink:type="simple">10.1152/japplphysiol.00128.2015</ext-link></comment> <object-id pub-id-type="pmid">25814636</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Delp</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Loan</surname> <given-names>JP</given-names></name>. <article-title>A Graphics-Based Software System to Develop and Analyze Models of Musculoskeletal Structures</article-title>. <source>Computers in Biology and Medicine</source>. <year>1995</year>;<volume>25</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>34</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0010-4825(95)98882-E" xlink:type="simple">10.1016/0010-4825(95)98882-E</ext-link></comment> <object-id pub-id-type="pmid">7600758</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zajac</surname> <given-names>FE</given-names></name>. <article-title>Muscle and Tendon: Properties, Models, Scaling, and Application to Biomechanics and Motor Control</article-title>. <source>Critical reviews in biomedical engineering</source>. <year>1989</year>;<volume>17</volume>(<issue>4</issue>):<fpage>359</fpage>–<lpage>411</lpage>. <object-id pub-id-type="pmid">2676342</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref016">
<label>16</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Winters</surname> <given-names>JM</given-names></name>. <chapter-title>Hill-Based Muscle Models: A Systems Engineering Perspective</chapter-title>. In: <name name-style="western"><surname>Winters</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Woo</surname> <given-names>SLY</given-names></name>, editors. <source>Multiple Muscle Systems: Biomechanics and Movement Organization</source>. <publisher-name>Springer-Verlag</publisher-name>; <year>1990</year>. p. <fpage>69</fpage>–<lpage>93</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>FC</given-names></name>, <name name-style="western"><surname>Pandy</surname> <given-names>MG</given-names></name>. <article-title>Dynamic Optimization of Human Walking</article-title>. <source>Journal of Biomechanical Engineering</source>. <year>2001</year>;<volume>123</volume>(<issue>5</issue>):<fpage>381</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://link.aip.org/link/JBENDY/v123/i5/p381/s1&amp;Agg=doi" xlink:type="simple">http://link.aip.org/link/JBENDY/v123/i5/p381/s1&amp;Agg=doi</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1115/1.1392310" xlink:type="simple">10.1115/1.1392310</ext-link></comment> <object-id pub-id-type="pmid">11601721</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Neptune</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Sasaki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kautz</surname> <given-names>Sa</given-names></name>. <article-title>The effect of walking speed on muscle function and mechanical energetics</article-title>. <source>Gait &amp; posture</source>. <year>2008</year> <month>Jul</month>;<volume>28</volume>(<issue>1</issue>):<fpage>135</fpage>–<lpage>43</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2409271&amp;tool=pmcentrez&amp;rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2409271&amp;tool=pmcentrez&amp;rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.gaitpost.2007.11.004" xlink:type="simple">10.1016/j.gaitpost.2007.11.004</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Geyer</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Herr</surname> <given-names>H</given-names></name>. <article-title>A muscle-reflex model that encodes principles of legged mechanics produces human walking dynamics and muscle activities</article-title>. <source>IEEE transactions on neural systems and rehabilitation engineering: a publication of the IEEE Engineering in Medicine and Biology Society</source>. <year>2010</year> <month>Jun</month>;<volume>18</volume>(<issue>3</issue>):<fpage>263</fpage>–<lpage>73</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20378480" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/20378480</ext-link>. Code available from: <ext-link ext-link-type="uri" xlink:href="https://www.cs.cmu.edu/~hgeyer/Software/Neuromuscular%20Model/Geyer%20Neuromuscular%20Model.zip" xlink:type="simple">https://www.cs.cmu.edu/~hgeyer/Software/Neuromuscular%20Model/Geyer%20Neuromuscular%20Model.zip</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNSRE.2010.2047592" xlink:type="simple">10.1109/TNSRE.2010.2047592</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lichtwark</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>A</given-names></name>. <article-title>Optimal muscle fascicle length and tendon stiffness for maximising gastrocnemius efficiency during human walking and running</article-title>. <source>J Theor Biol</source>. <year>2008</year>;<volume>252</volume>(<issue>4</issue>):<fpage>662</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2008.01.018" xlink:type="simple">10.1016/j.jtbi.2008.01.018</ext-link></comment> <object-id pub-id-type="pmid">18374362</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hill</surname> <given-names>AV</given-names></name>. <article-title>The Heat of Shortening and the Dynamic Constants of Muscle</article-title>. <source>Proceedings of the Royal Society of London Series B, Biological Sciences</source>. <year>1938</year>;<volume>126</volume>(<issue>843</issue>):<fpage>136</fpage>–<lpage>195</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.1938.0050" xlink:type="simple">10.1098/rspb.1938.0050</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roberts</surname> <given-names>T</given-names></name>. <article-title>The integrated function of muscles and tendons during locomotion</article-title>. <source>Comp Biochem Physiol A Mol Integr Physiol</source>. <year>2002</year>;<volume>133</volume>:<fpage>1087</fpage>–<lpage>1099</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1095-6433(02)00244-1" xlink:type="simple">10.1016/S1095-6433(02)00244-1</ext-link></comment> <object-id pub-id-type="pmid">12485693</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krishnaswamy</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Herr</surname> <given-names>HM</given-names></name>. <article-title>Human leg model predicts ankle muscle-tendon morphology, state, roles and energetics in walking</article-title>. <source>PLoS computational biology</source>. <year>2011</year> <month>Mar</month>;<volume>7</volume>(<issue>3</issue>):<fpage>e1001107</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3060164&amp;tool=pmcentrez&amp;rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3060164&amp;tool=pmcentrez&amp;rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1001107" xlink:type="simple">10.1371/journal.pcbi.1001107</ext-link></comment> <object-id pub-id-type="pmid">21445231</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Umberger</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Gerritsen</surname> <given-names>KGM</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>PE</given-names></name>. <article-title>A model of human muscle energy expenditure</article-title>. <source>Computer methods in biomechanics and biomedical engineering</source>. <year>2003</year> <month>Apr</month>;<volume>6</volume>(<issue>2</issue>):<fpage>99</fpage>–<lpage>111</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/12745424" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/12745424</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/1025584031000091678" xlink:type="simple">10.1080/1025584031000091678</ext-link></comment> <object-id pub-id-type="pmid">12745424</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sanger</surname> <given-names>TD</given-names></name>. <article-title>Bayesian filtering of myoelectric signals</article-title>. <source>Journal of neurophysiology</source>. <year>2007</year> <month>Feb</month>;<volume>97</volume>(<issue>2</issue>):<fpage>1839</fpage>–<lpage>45</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/17182908" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/17182908</ext-link>. Code available from: <ext-link ext-link-type="uri" xlink:href="http://www.kidsmove.org/bayesemgdemo.html" xlink:type="simple">http://www.kidsmove.org/bayesemgdemo.html</ext-link> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00936.2006" xlink:type="simple">10.1152/jn.00936.2006</ext-link></comment> <object-id pub-id-type="pmid">17182908</object-id></mixed-citation></ref>
<ref id="pcbi.1004912.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>He</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Loeb</surname> <given-names>GE</given-names></name>. <article-title>Feedback Gains for Correcting Small Perturbations to Standing Posture</article-title>. <source>IEEE Trans. on Automatic Control</source>. <year>1991</year>;<volume>36</volume>:<fpage>322</fpage>–<lpage>332</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/9.73565" xlink:type="simple">10.1109/9.73565</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raasch</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Zajac</surname> <given-names>FE</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>WS</given-names></name>. <article-title>Muscle coordination of maximum-speed pedaling</article-title>. <source>Journal of Biomechanics</source>. <year>1997</year>;<volume>30</volume>:<fpage>595</fpage>–<lpage>602</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0021-9290(96)00188-1" xlink:type="simple">10.1016/S0021-9290(96)00188-1</ext-link></comment> <object-id pub-id-type="pmid">9165393</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref028">
<label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Perry</surname> <given-names>J</given-names></name>. <source>Gait Analysis</source>. <edition>1st ed</edition>. <publisher-loc>Thorofare, NJ 08086-9447</publisher-loc>: <publisher-name>SLACK Incorporated</publisher-name>; <year>1992</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Endo</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Herr</surname> <given-names>H</given-names></name>. <article-title>A Model of Muscle-Tendon Function in Human Walking at Self-Selected Speed</article-title>. <source>IEEE transactions on neural systems and rehabilitation engineering: a publication of the IEEE Engineering in Medicine and Biology Society</source>. <year>2013</year>;<volume>22</volume>:<fpage>352</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNSRE.2013.2291903" xlink:type="simple">10.1109/TNSRE.2013.2291903</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref030">
<label>30</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Deb</surname> <given-names>K</given-names></name>. <source>Multi-Objective Optimization Using Evolutionary Algorithms</source>. <publisher-loc>Hoboken, NJ 07030-5774</publisher-loc>: <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sartori</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Reggiani</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Farina</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>DG</given-names></name>. <article-title>EMG-Driven Forward-Dynamic Estimation of Muscle Force and Joint Moment about Multiple Degrees of Freedom in the Human Lower Extremity</article-title>. <source>PLoS ONE</source>. <year>2012</year>;<volume>7</volume>(<issue>12</issue>):<fpage>e52618</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0052618" xlink:type="simple">10.1371/journal.pone.0052618</ext-link></comment> <object-id pub-id-type="pmid">23300725</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref032">
<label>32</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>McMahon</surname> <given-names>TA</given-names></name>. <source>Muscles, reflexes, and locomotion</source>. <publisher-loc>Princeton, NJ</publisher-loc>: <publisher-name>Princeton University Press</publisher-name>; <year>1984</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sawicki</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ferris</surname> <given-names>D</given-names></name>. <article-title>Mechanics and energetics of level walking with powered ankle exoskeletons</article-title>. <source>J Exp Biol</source>. <year>2008</year>;<volume>211</volume>:<fpage>1402</fpage>–<lpage>1413</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1242/jeb.009241" xlink:type="simple">10.1242/jeb.009241</ext-link></comment> <object-id pub-id-type="pmid">18424674</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Umberger</surname> <given-names>BR</given-names></name>. <article-title>Stance and swing phase costs in human walking</article-title>. <source>Journal of the Royal Society, Interface / the Royal Society</source>. <year>2010</year> <month>Sep</month>;<volume>7</volume>(<issue>50</issue>):<fpage>1329</fpage>–<lpage>40</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2894890&amp;tool=pmcentrez&amp;rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2894890&amp;tool=pmcentrez&amp;rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2010.0084" xlink:type="simple">10.1098/rsif.2010.0084</ext-link></comment> <object-id pub-id-type="pmid">20356877</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Arnold</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Delp</surname> <given-names>SL</given-names></name>. <article-title>Fibre operating lengths of human lower limb muscles during walking</article-title>. <source>Phil. Trans. R. Soc. B</source> <year>2011</year>;<volume>366</volume>: <fpage>1530</fpage>–<lpage>1539</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2010.0345" xlink:type="simple">10.1098/rstb.2010.0345</ext-link></comment> <object-id pub-id-type="pmid">21502124</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Arnold</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Hamner</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Seth</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Millard</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Delp</surname> <given-names>SL</given-names></name>. <article-title>How muscle fiber lengths and velocities affect muscle force generation as humans walk and run at different speeds</article-title>. <source>Journal of Experimental Biology</source> <year>2013</year>;<volume>216</volume>: <fpage>2150</fpage>–<lpage>2160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1242/jeb.075697" xlink:type="simple">10.1242/jeb.075697</ext-link></comment> <object-id pub-id-type="pmid">23470656</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buchanan</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Manal</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Besier</surname> <given-names>TF</given-names></name>. <article-title>Estimation of muscle forces and joint moments using a forward-inverse dynamics model</article-title>. <source>Med. Sci. Sports Exerc</source>. <year>2005</year>; <volume>37</volume>: <fpage>1911</fpage>–<lpage>1916</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lloyd</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Besier</surname> <given-names>TF</given-names></name>. <article-title>An EMG-driven musculoskeletal model to estimate muscle forces and knee joint moments in vivo</article-title>. <source>J. Biomech</source>. <year>2003</year>; <volume>36</volume>: <fpage>765</fpage>–<lpage>776</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0021-9290(03)00010-1" xlink:type="simple">10.1016/S0021-9290(03)00010-1</ext-link></comment> <object-id pub-id-type="pmid">12742444</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Corcos</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Gottlieb</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Latash</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Almeida</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Agarwal</surname> <given-names>GC</given-names></name>. <article-title>Electromechanical delay: an experimental artifact</article-title>. <source>J. Electromyogr. Kinesiol</source>. <year>1992</year>; <volume>2</volume>: <fpage>59</fpage>–<lpage>68</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/1050-6411(92)90017-D" xlink:type="simple">10.1016/1050-6411(92)90017-D</ext-link></comment> <object-id pub-id-type="pmid">20719599</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Guimaraes</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Herzog</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Allinger</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>YT</given-names></name>. <article-title>The EMG?force relationship of the cat soleus muscle and its association with contractile conditions during locomotion</article-title>. <source>J. Exp. Biol</source>. <year>1995</year>; <volume>198</volume>: <fpage>975</fpage>–<lpage>987</lpage>. <object-id pub-id-type="pmid">7730759</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Davy</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Audu</surname> <given-names>ML</given-names></name> <article-title>A dynamic optimization technique for predicting muscle forces in the swing phase of gait</article-title>. <source>J. Biomech</source>. <year>1987</year>; <volume>20</volume>:<fpage>187</fpage>–<lpage>201</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0021-9290(87)90310-1" xlink:type="simple">10.1016/0021-9290(87)90310-1</ext-link></comment> <object-id pub-id-type="pmid">3571299</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref042">
<label>42</label>
<mixed-citation publication-type="other" xlink:type="simple">O’Rahilly R, Müller F, Carpenter S, Swenson R. Basic Human Anatomy Copyright O’Rahilly 2004. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.dartmouth.edu/~humananatomy/" xlink:type="simple">https://www.dartmouth.edu/~humananatomy/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref043">
<label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Pandolf KB, Givoni B, Goldman RF. Predicting energy expenditure with loads while standing or walking very slowly. US Army Research Institute of Environmental Medicine. Report No M 3/77, 1976.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref044">
<label>44</label>
<mixed-citation publication-type="other" xlink:type="simple">Endo K, Paluska D, Herr H. A quasi-passive model of human leg function in level-ground walking. 2006 IEEE/RSJ International Conference on Intelligent Robots and Systems. 2006 Oct; p. 4935–4939. Available from: <ext-link ext-link-type="uri" xlink:href="http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=4059202" xlink:type="simple">http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=4059202</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hill</surname> <given-names>AV</given-names></name>. <article-title>The efficiency of mechanical power development during muscular shortening and its relation to load</article-title>. <source>Proceedings of the Royal Society of London Series B, Biological Sciences</source>. <year>1964</year>;<volume>159</volume>(<issue>975</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.1964.0005" xlink:type="simple">10.1098/rspb.1964.0005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref046">
<label>46</label>
<mixed-citation publication-type="other" xlink:type="simple">Song S, Desai R, Geyer H. Integration of an adaptive swing control into a neuromuscular human walking model. Conference proceedings: IEEE Annual International Conference of the Engineering in Medicine and Biology Society, Osaka, Japan Conference. 2013 Jul;p. 4915–4918.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref047">
<label>47</label>
<mixed-citation publication-type="other" xlink:type="simple">Song, S, Geyer, H. Regulating speed and generating large speed transitions in a neuromuscular human walking model. 2012 IEEE International Conference on Robotics and Automation. 2012 May;p. 511–516. Available from: <ext-link ext-link-type="uri" xlink:href="http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=6225307" xlink:type="simple">http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=6225307</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Hamner</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Delp</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Koltun</surname> <given-names>V</given-names></name>. <article-title>Optimizing Locomotion Controllers Using Biologically-Based Actuators and Objectives</article-title>. <source>ACM Transactions on Graphics (Proc SIGGRAPH 2012)</source>. <year>2012</year>;<volume>31</volume>(<issue>4</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref049">
<label>49</label>
<mixed-citation publication-type="other" xlink:type="simple">Song S, Geyer H. Generalization of a Muscle-Reflex Control Model to 3D Walking. Conference proceedings: IEEE Annual International Conference of the Engineering in Medicine and Biology Society, Osaka, Japan Conference. 2013 Jul;p. 7463–7466.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brockway</surname> <given-names>JM</given-names></name>. <article-title>Derivation of formulae used to calculate energy expenditure in man</article-title>. <source>Human nutrition Clinical nutrition</source>. <year>1987</year> <month>Nov</month>;<volume>41</volume>(<issue>6</issue>):<fpage>463</fpage>–<lpage>71</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/3429265" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/3429265</ext-link>. <object-id pub-id-type="pmid">3429265</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004912.ref051">
<label>51</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Cram</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Kasman</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Holtz</surname> <given-names>J</given-names></name> <source>Introduction to Surface Electromyography 1st ed</source>. <publisher-loc>Gaithersburg, MD 20878</publisher-loc>: <publisher-name>Aspen Publishers</publisher-name>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004912.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hatze</surname> <given-names>H</given-names></name>. <article-title>A Myocybernetic Control Model of Skeletal Muscle</article-title>. <source>Biological Cybernetics</source>. <year>1977</year>;<volume>25</volume>:<fpage>103</fpage>–<lpage>119</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00337268" xlink:type="simple">10.1007/BF00337268</ext-link></comment> <object-id pub-id-type="pmid">836914</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>