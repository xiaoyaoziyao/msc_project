<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-13-14216</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0078122</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories>
<title-group>
<article-title>Mapping the Shapes of Phylogenetic Trees from Human and Zoonotic RNA Viruses</article-title>
<alt-title alt-title-type="running-head">Shapes of Human and Zoonotic RNA Virus Phylogenies</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Poon</surname><given-names>Art F. Y.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Walker</surname><given-names>Lorne W.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Murray</surname><given-names>Heather</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>McCloskey</surname><given-names>Rosemary M.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Harrigan</surname><given-names>P. Richard</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Liang</surname><given-names>Richard H.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>British Columbia Centre for Excellence in HIV/AIDS, Vancouver, British Columbia, Canada</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Medicine, University of British Columbia, Vancouver, British Columbia, Canada</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>School of Medicine, University of California San Diego, La Jolla, California, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Crandall</surname><given-names>Keith A.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>George Washington University, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">apoon@cfenet.ubc.ca</email></corresp>
<fn fn-type="conflict"><p>AFYP is a member of the PLOS ONE Editorial Board, and that this does not alter the authors' adherence to all the PLOS ONE policies on sharing data and materials.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: AFYP. Performed the experiments: AFYP RL HM RM. Analyzed the data: AFYP. Contributed reagents/materials/analysis tools: LW. Wrote the paper: AFYP PRH.</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>1</day><month>11</month><year>2013</year></pub-date>
<volume>8</volume>
<issue>11</issue>
<elocation-id>e78122</elocation-id>
<history>
<date date-type="received"><day>5</day><month>4</month><year>2013</year></date>
<date date-type="accepted"><day>9</day><month>9</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Poon et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>A phylogeny is a tree-based model of common ancestry that is an indispensable tool for studying biological variation. Phylogenies play a special role in the study of rapidly evolving populations such as viruses, where the proliferation of lineages is constantly being shaped by the mode of virus transmission, by adaptation to immune systems, and by patterns of human migration and contact. These processes may leave an imprint on the shapes of virus phylogenies that can be extracted for comparative study; however, tree shapes are intrinsically difficult to quantify. Here we present a comprehensive study of phylogenies reconstructed from 38 different RNA viruses from 12 taxonomic families that are associated with human pathologies. To accomplish this, we have developed a new procedure for studying phylogenetic tree shapes based on the ‘kernel trick’, a technique that maps complex objects into a statistically convenient space. We show that our kernel method outperforms nine different tree balance statistics at correctly classifying phylogenies that were simulated under different evolutionary scenarios. Using the kernel method, we observe patterns in the distribution of RNA virus phylogenies in this space that reflect modes of transmission and pathogenesis. For example, viruses that can establish persistent chronic infections (such as HIV and hepatitis C virus) form a distinct cluster. Although the visibly ‘star-like’ shape characteristic of trees from these viruses has been well-documented, we show that established methods for quantifying tree shape fail to distinguish these trees from those of other viruses. The kernel approach presented here potentially represents an important new tool for characterizing the evolution and epidemiology of RNA viruses.</p>
</abstract>
<funding-group><funding-statement>This study was supported by a Canadian Institutes of Health Research (CIHR) operating grant (HOP-111406) awarded to AFYP. AFYP is supported by a Scholar Award from the Michael Smith Foundation for Health Research (MSFHR)/St. ∼Paul’s Hospital Foundation-Providence Health Care Research Institute (SPHF-PHCRI) Career Investigator program, and by a New Investigator Award from the CIHR HIV Vaccine Initiative (CHVI) for Vaccine Discovery and Social Research. RMM was supported by a Vice President Research Undergraduate Student Research Award (VPR-USRA) from Simon Fraser University. HM was supported by a Centre for Blood Research Summer Studentship from the University of British Columbia. PRH is supported by a CIHR/GSK Research Chair in Clinical Virology. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="11"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Trees have long been used as a metaphor for making sense of a diverse living world. The modern phylogenetic tree is a model of the evolutionary relatedness of populations or individuals, which is increasingly based on the similarity of their genetic makeup. Phylogenies have become an indispensable tool for the study of biological variation by providing a framework for modelling evolutionary processes along lineages of descent from common ancestors. In particular, phylogenies are used extensively in the study of viruses. Viruses, especially those with RNA genomes, exhibit some of the fastest rates of molecular evolution in the natural world, driven by high rates of mutation <xref ref-type="bibr" rid="pone.0078122-Drake1">[1]</xref>, large population sizes and short generation times. Many viral lineages can proliferate on time scales measured in days, as opposed to the millions of years it would require for many branches on the macroscopic ‘Tree of Life’ to grow to the same extent. The substantial variation in the shapes of RNA virus phylogenies (<xref ref-type="fig" rid="pone-0078122-g001">Figure 1</xref>) may be determined by epidemiological processes that operate at the scale of the host population. These processes may in turn be shaped by the ongoing evolution of the virus. The study of this multi-level interaction is known as ‘phylodynamics’ <xref ref-type="bibr" rid="pone.0078122-Grenfell1">[2]</xref>.</p>
<fig id="pone-0078122-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0078122.g001</object-id><label>Figure 1</label><caption>
<title>Diversity in phylogenetic tree shapes for animal RNA viruses.</title>
<p>These phylogenies were generated from samples of genetic sequences from HIV-1 subtype B (HIV1-B), dengue virus serotype 1II (DEN-1II), influenza A virus serotype H3N2 (IAV-H3), and coxsackievirus A24 variant (CA24v).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0078122.g001" position="float" xlink:type="simple"/></fig>
<p>Identifying the reproducible shape characteristics among virus phylogenies and the epidemiological and evolutionary determinants of these shapes are key research questions of phylodynamics <xref ref-type="bibr" rid="pone.0078122-Holmes1">[3]</xref>. For instance, the stark contrast between phylogenies generated respectively from influenza A virus (IAV) and human immunodeficiency virus (HIV) type 1 sequences is a prototypical example of how virus phylogenies can be shaped by phylodynamic processes <xref ref-type="bibr" rid="pone.0078122-Korber1">[4]</xref>, <xref ref-type="bibr" rid="pone.0078122-Sharp1">[5]</xref>. A phylogeny reconstructed from sequences of IAV hemagglutinin, a receptor-binding glycoprotein which is a primary target of the host immune system, has a distinctively pectinate (‘comb-like’) shape (<xref ref-type="fig" rid="pone-0078122-g001">Figure 1</xref>) that is hypothesized to be driven by the short infectious period and antigenic drift of IAV, in which very few lineages persist between successive epidemics <xref ref-type="bibr" rid="pone.0078122-Nelson1">[6]</xref>. In contrast, the life-long nature of HIV infection and ongoing transmission among hosts has enabled rapidly diverging lineages to proliferate and persist over time, leading to ‘star-like’ phylogenies with short branches near the root and long branches at the tips (<xref ref-type="fig" rid="pone-0078122-g001">Figure 1</xref>).</p>
<p>Until recently, our understanding of phylodynamics through the comparative study of virus phylogenies has been generally limited to conspicuous differences in tree shape, such as that between HIV and IAV phylogenies, because tree shapes are inherently difficult to quantify. A phylogenetic tree is an acyclic graph in which the nodes represent either observed entities (leaf nodes) or their common ancestors (internal nodes) which must be reconstructed from the variation observed at the leaf nodes. These nodes are linked by branches whose lengths represent either the passage of time or the amount of evolutionary change that has occurred between nodes. As a result, the shape of a phylogenetic tree is a complex object that incorporates both the lengths and distribution of branches among nodes. There is an abundance of descriptive statistics of tree shape that focus on the concept of ‘tree balance’, which refers to the skewed distribution of internal nodes in a tree due to variation in rates of branching <xref ref-type="bibr" rid="pone.0078122-Blum1">[7]</xref>. For example, the Sackin index <xref ref-type="bibr" rid="pone.0078122-Sackin1">[8]</xref> counts the number of internal nodes along the path from each leaf node to the root of the tree. When branching events occur preferentially along specific lineages, the corresponding phylogeny should tend to have a higher Sackin index. However, tree balance statistics are notoriously sensitive to sample size <xref ref-type="bibr" rid="pone.0078122-Pompei1">[9]</xref> and capture only one abstraction of tree shape; for example, differences in branch lengths are generally not taken into consideration.</p>
<p>Here, we present a new approach to the study of phylodynamics using a versatile method from machine learning <xref ref-type="bibr" rid="pone.0078122-Aizerman1">[10]</xref>. We begin with a function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e001" xlink:type="simple"/></inline-formula> that maps an object <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e002" xlink:type="simple"/></inline-formula> into a representation space <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e003" xlink:type="simple"/></inline-formula> that is more amenable to analysis than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e004" xlink:type="simple"/></inline-formula>. A well-conceived <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e005" xlink:type="simple"/></inline-formula> can be extremely useful for dealing with structured data such as trees, which otherwise have no direct numerical representation. For example, Sackin’s index is a function that maps from the space of all possible tree shapes to the set of all positive integers. While integer representations of tree shape are far more convenient for analysis, this choice for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e006" xlink:type="simple"/></inline-formula> is not adequate for our purposes because it captures only a small fraction of the variation among tree shapes. When dealing with complex data, it is more appropriate to use a function that maps objects into a representation space with many dimensions. For example, one could devise a function to be applied to blocks of text that counted the occurrence of substrings of any length. Every possible substring adds a new dimension to the feature space, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e007" xlink:type="simple"/></inline-formula> is referred to in the field of pattern recognition. As the data become larger and more complex, the number of possible features (and thereby the dimensionality of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e008" xlink:type="simple"/></inline-formula>) may become enormous. Thus, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e009" xlink:type="simple"/></inline-formula> can provide a detailed representation of complex objects, it also becomes infeasible to operate within. Because we are interested specifically in finding linear relations between objects that have been mapped to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e010" xlink:type="simple"/></inline-formula>, we bypass the difficult task of explicitly mapping each object to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e011" xlink:type="simple"/></inline-formula> by defining a function that efficiently evaluates the inner product between two representations of objects in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e012" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e013" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e014" xlink:type="simple"/></inline-formula>. This procedure is known as the <italic>kernel trick</italic> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e015" xlink:type="simple"/></inline-formula> is referred to as the kernel function <xref ref-type="bibr" rid="pone.0078122-Vert1">[11]</xref>. As kernel functions are generally designed to take larger values when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e016" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e017" xlink:type="simple"/></inline-formula> have a greater number of features in common, they can each be interpreted as a non-linear measure of similarity.</p>
<p>To provide an intuition to this use of the kernel trick, imagine a person who has encountered three texts written in English – specifically, the texts contained in Agapow and Purvis <xref ref-type="bibr" rid="pone.0078122-Agapow1">[12]</xref>, Huelsenbeck <italic>et al.</italic> <xref ref-type="bibr" rid="pone.0078122-Huelsenbeck1">[13]</xref>, and Robinson and Foulds <xref ref-type="bibr" rid="pone.0078122-Robinson1">[14]</xref>. Moreover, suppose this person has absolutely no knowledge of the English language, let alone phylogenetics. Realizing that there are discrete shapes (words) and that many of them appear repeatedly, he or she carries out the lengthy task of cataloguing the number of times that each shape appears in each text. (For the sake of example, we ignore such complications as punctuation and typography.) While there are many shapes that are unique to a given text, there is a much smaller subset of shapes that appear in two or more texts. Therefore, in order to compare two of these lists, it is convenient to multiply the counts of shapes that appear in both lists (knowing that unique shapes would multiply to zero) and sum these products to generate a similarity score. Multiplying the counts has the useful effect of emphasizing shapes that appear in both texts at roughly equal frequencies. For example, ‘tree’ appears 37 times in both <xref ref-type="bibr" rid="pone.0078122-Agapow1">[12]</xref> and <xref ref-type="bibr" rid="pone.0078122-Robinson1">[14]</xref>, which contributes a score of 1369. In contrast, if all but one of the 74 occurrences of ‘tree’ appeared in one of the two texts, then the score would have increased by only 73. This exercise yields three numbers corresponding to the pairwise comparisons: 264630 <xref ref-type="bibr" rid="pone.0078122-Agapow1">[12]</xref>, <xref ref-type="bibr" rid="pone.0078122-Huelsenbeck1">[13]</xref>, 141470 <xref ref-type="bibr" rid="pone.0078122-Agapow1">[12]</xref>, <xref ref-type="bibr" rid="pone.0078122-Robinson1">[14]</xref>, and 277008 <xref ref-type="bibr" rid="pone.0078122-Huelsenbeck1">[13]</xref>, <xref ref-type="bibr" rid="pone.0078122-Robinson1">[14]</xref>. However, <xref ref-type="bibr" rid="pone.0078122-Huelsenbeck1">[13]</xref> is a much lengthier text that the other two, which has inflated the scores for pairwise comparisons that included this text. It is necessary to normalize each score for the size of the corresponding texts <xref ref-type="bibr" rid="pone.0078122-Collins1">[15]</xref>; upon doing so, our imagined person is able to conclude that <xref ref-type="bibr" rid="pone.0078122-Agapow1">[12]</xref> and <xref ref-type="bibr" rid="pone.0078122-Robinson1">[14]</xref> are the most similar (0.84) without knowing that these papers are, in fact, both on the subject of phylogenetic tree shape, whereas <xref ref-type="bibr" rid="pone.0078122-Huelsenbeck1">[13]</xref> (with normalized scores of 0.82 and 0.78, respectively) concerns the problem of inferring the root of a phylogeny.</p>
<p>To construct a kernel function on phylogenetic tree shapes, we adapted a natural language processing kernel function <xref ref-type="bibr" rid="pone.0078122-Moschitti1">[16]</xref> that was originally designed to classify text on the basis of its syntactic structure (a generative tree in which words descend from linguistic precursors <xref ref-type="bibr" rid="pone.0078122-Collins1">[15]</xref>). Our modified kernel function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e018" xlink:type="simple"/></inline-formula> extracts all the subset trees that are the common features of two phylogenetic trees <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e019" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e020" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pone-0078122-g002">Figure 2</xref>). A subset tree is a contiguous collection of descendants of a specific node, but unlike a subtree, it does not necessarily include all of the descendants. Thus, our approach is similar to the Robinson-Foulds metric <xref ref-type="bibr" rid="pone.0078122-Robinson1">[14]</xref> which compares alternative trees for a given set of taxa by counting the number of subtrees in common. Unlike the Robinson-Foulds metric, however, our kernel function not only allows us to compare trees relating different numbers and kinds of taxa, but it also accounts for differences in the branch lengths between matching subset trees. We assess the performance of our kernel function against nine measures of tree shape at classifying simulated phylogenies with varying rates of speciation, and then apply our function to a large collection of human and zoonotic RNA virus phylogenies.</p>
<fig id="pone-0078122-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0078122.g002</object-id><label>Figure 2</label><caption>
<title>Kernel-assisted comparison of two tree shapes.</title>
<p>For trees comprising <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e021" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e022" xlink:type="simple"/></inline-formula> nodes, respectively, there are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e023" xlink:type="simple"/></inline-formula> pairs of nodes to evaluate. (A) Starting from a given pair of nodes (indicated in figure by circles with double-outlines), the algorithm finds the largest common subset tree rooted at these nodes. First, we find that for both nodes, neither of the branches terminate at a ‘leaf node’ (marked with ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e024" xlink:type="simple"/></inline-formula>‘). This match contributes a relatively small amount to our kernel score, not only because the matching subset trees (highlighted in thick blue lines) comprise only one node each, but also because their discordant branch lengths lead to a substantial penalty. (B) Next, we descend down the left branch in both trees. The current nodes (open circles) in both trees spawn one leaf node and one internal node; therefore, the subset trees continue to match. In addition, their branch lengths are similar, so their contribution to the cumulative kernel score is given greater weight. (C) Finally, we descend down the right branch in both trees and find that the subset trees no longer match beyond this point. We also proceed down the right branch of the reference nodes and find no match, so our traversal of the two trees from these nodes is complete and we restart our search at the next pair of nodes.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0078122.g002" position="float" xlink:type="simple"/></fig></sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<sec id="s2a">
<title>Data Collection</title>
<p>A working list of RNA viruses associated with human pathologies was obtained from the ViralZone web resource (<ext-link ext-link-type="uri" xlink:href="http://viralzone.expasy.org/all_by_species/678.html" xlink:type="simple">http://viralzone.expasy.org/all_by_species/678.html</ext-link>) <xref ref-type="bibr" rid="pone.0078122-Hulo1">[17]</xref>. For each virus, we attempted to gather as many sequences as available covering a region of the genome with extensive genetic variation, based on prior knowledge or phylogenetic studies in the literature. When available, we used curated virus-specific sequence databases. HIV-1 <italic>nef</italic> gene sequences were obtained from the Los Alamos National Laboratory (LANL) HIV Sequence database (<ext-link ext-link-type="uri" xlink:href="http://www.hiv.lanl.gov/" xlink:type="simple">http://www.hiv.lanl.gov/</ext-link>) using subtype-specific search queries excluding sequences annotated as recombinants, and restricting the result to one sequence per patient. Further screening for HIV-1 recombinant sequences was carried out using SCUEAL (Subtype Classification Using Evolutionary ALgorithms) <xref ref-type="bibr" rid="pone.0078122-KosakovskyPond1">[18]</xref>. Hepatitis C virus E1 sequences were obtained from the LANL HCV sequence database (<ext-link ext-link-type="uri" xlink:href="http://hcv.lanl.gov" xlink:type="simple">http://hcv.lanl.gov</ext-link>) <xref ref-type="bibr" rid="pone.0078122-Kuiken1">[19]</xref> using genotype-specific search queries excluding recombinants. Search results were reduced to one sequence per patient based on patient clone annotation in the sequence headers using a custom Python script, as this functionality was not available for the LANL HCV sequence database. Influenza A virus hemagglutinin (HA) sequences were obtained from the National Institute of Allergy and Infectious Diseases (NIAID) Influenza Research Database (<ext-link ext-link-type="uri" xlink:href="http://www.fludb.org" xlink:type="simple">http://www.fludb.org</ext-link>), using subtype-specific search queries excluding isolates from non-human hosts and laboratory strains.</p>
<p>Gene sequences from all other viruses were obtained from the GenBank sequence database by primary organism taxonomy identifier (‘txid’). Queries yielding fewer than 100 records irrespective of gene were omitted at this stage. In all cases, sequence data were downloaded as FASTA formatted files; these published data were already anonymized and did not include any information about patients’ medical records. Sequences annotated as multiple clonal isolates from the same patient, sequences from patents or laboratory strains were excluded from these data. For all viruses other than HCV, HIV and IAV, we retrieved collection dates and host organism data, when available, for each sequence by its Genbank accession number using an automated query algorithm implemented in Python. By convention, Genbank records are annotated with this information in a ‘source’ field; however, this field is not always included in data submissions. For HCV, HIV and IAV sequences, which were already screened for human hosts, collection dates were parsed from sequence headers that were generated by the respective database engines.</p>
</sec><sec id="s2b">
<title>Sequence Alignment</title>
<p>For each FASTA file, one sequence was selected as a reference for initial pairwise alignment of all other sequences using an implementation of the modified Gotoh algorithm in HyPhy <xref ref-type="bibr" rid="pone.0078122-Gotoh1">[20]</xref>, <xref ref-type="bibr" rid="pone.0078122-KosakovskyPond2">[21]</xref>. Sequences were trimmed to the aligned portion and converted to a multiple sequence alignment using MUSCLE <xref ref-type="bibr" rid="pone.0078122-Edgar1">[22]</xref> version 3.8 under default settings. All alignments were visually inspected and adjusted using Se-Al (Andrew Rambaut, <ext-link ext-link-type="uri" xlink:href="http://tree.bio.ed.ac.uk/software/seal" xlink:type="simple">http://tree.bio.ed.ac.uk/software/seal</ext-link>). Columns in the alignment comprising over 50% gaps were excluded. A table of all viruses, subtypes and genomic regions used for phylogenetic reconstruction is provided as Supporting Information (<xref ref-type="supplementary-material" rid="pone.0078122.s005">Table S1</xref>).</p>
<p>Initial phylogenies were generated using FastTree (version 2.1.4) <xref ref-type="bibr" rid="pone.0078122-Price1">[23]</xref> under the general time-reversible model of nucleotide substitution. These phylogenies were used to identify clusters of sequences that could represent multiple isolates from the same individual, which we determined by evaluating the publications linked with sequences within putative clusters. Furthermore, the initial phylogenies were used to partition or filter alignments by genotype or subtype, because the Genbank sequence records were not consistently annotated with this information. The data sets that were partitioned or filtered using the initial phylogenies were: astrovirus, dengue virus type 1, hepatitis delta virus, hepatitis E virus, influenza A virus H1, Japanese encephalitis virus, Norwalk virus genotype II, poliovirus (wild and vaccine variants), rabies virus, rotavirus A, rubella virus, sapovirus, tick-borne encephalitis virus, and West Nile virus.</p>
</sec><sec id="s2c">
<title>Phylogenetic Reconstruction</title>
<p>Although it is possible to apply our kernel method (described below) to an unrooted tree by counting subtrees from the deepest node outwards, phylodynamic studies of tree shapes have conventionally been carried out on rooted trees which can be more informative about evolutionary processes. The root of a phylogeny is a hypothesis on the location of most recent common ancestor (the earliest point in time) on the tree. We used an outgroup criterion <xref ref-type="bibr" rid="pone.0078122-Huelsenbeck1">[13]</xref> to infer rooted phylogenies from the alignments. This method relies on selecting an outgroup sequence that is sufficiently closely related to the true ancestor. For each alignment, we selected an outgroup sequence based on previous phylogenetic studies on the respective viruses in the literature, either a representative sequence from a closely-related virus genotype or subtype (<italic>e.g.</italic>, HIV-1 subtype D), or the earliest/prototype virus isolate (<italic>e.g.</italic>, West Nile virus isolate B956 <xref ref-type="bibr" rid="pone.0078122-Smithburn1">[24]</xref>). A list of outgroup sequence accession numbers and literature citations is provided in <xref ref-type="supplementary-material" rid="pone.0078122.s005">Table S1</xref>. We assessed the suitability of the respective outgroup sequences by generating preliminary rooted trees using FastTree2. While results based on tree balance statistics were sensitive to outgroup rooting, our results based on the kernel analysis were robust to choice of outgroup (data not shown).</p>
<p>For alignments with 200 or more sequences, we generated 100 replicate subsets of 100 sequences sampled at random without replacement from each data set for phylogenetic reconstructions. This resampling controlled for the effect of excessive variation in tree size (number of sequences) on comparisons of tree shape. Otherwise, a single phylogeny was generated for each alignment with fewer than 200 sequences (Crimean-Congo hemorrhagic fever virus; Chikungunya virus; encephalomyocarditis virus; HIV-1 subtype A; Hantaan virus; human rotavirus C; influenza A virus H2; influenza C virus; Murray valley encephalitis virus; mumps virus; Oropouche virus; human parainfluenza virus; Rift valley fever virus; rhinovirus A; rotavirus A genotypes 3, 4, and 12; rubella virus clade 2; sapovirus; tick-borne encephalitis virus, European and Far-Eastern strains; yellow fever virus). For data sets in which 200 or more sequences were annotated with collection dates, we generated 10 additional samples of 100 sequences drawn uniformly at random with respect to the year of collection. Phylogenies reconstructed from these latter samples provided a means to assess the sensitivity of our analyses to biased sample collection with respect to time.</p>
<p>Phylogenetic reconstruction for every sample was carried out using a multithreaded implementation of RAxML (version 7.3.0) <xref ref-type="bibr" rid="pone.0078122-Stamatakis1">[25]</xref> under a general time-reversible model of nucleotide substitution with 25 rate categories across sites, followed by optimization under a discretized gamma distribution of rate categories (GTRCAT). All phylogenies contained a number of ‘soft’ polytomies, in which the phylogenetic reconstruction was unable to assign a non-zero branch length at an internal node due to inadequate genetic divergence. Because RAxML is limited to strictly bifurcating representations of phylogenetic trees (with the exception of the deepest node from which all branches are interpreted as descendants), soft polytomies were automatically resolved by the software into an arbitrary binary tree with branch lengths set to a small non-zero value. By randomizing the resolution of soft polytomies into binary trees, we found that our results were robust to this source of uncertainty in phylogenetic reconstruction (data not shown).</p>
<p>For every phylogeny, we calculated two popular summary statistics of tree balance, Sackin’s index and Colless’ index following the formulae in <xref ref-type="bibr" rid="pone.0078122-Kirkpatrick1">[26]</xref>. Next, we generated a kernel matrix for all phylogenies using an implementation of our phylogenetic tree shape kernel as described in the following section.</p>
</sec><sec id="s2d">
<title>Kernel Analysis</title>
<p>To apply the kernel function to these data, we needed to iterate through all internal nodes in two phylogenies and count all subset trees with the same topology (branching order) in both phylogenies (<xref ref-type="fig" rid="pone-0078122-g002">Figure 2</xref>). This is akin to quantifying the similarity of two manuscripts by counting the number of times that various words appeared in both texts, as illustrated by our example in the Introduction. Unlike a text, however, the shape of a tree is an ambiguous characteristic of a phylogeny. Rotating the branches around a node can produce a tree that has a different shape, despite remaining evolutionarily equivalent to the original. The number of different shapes for a tree of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e025" xlink:type="simple"/></inline-formula> tips (where we distinguish left from right and, for the moment, ignore branch lengths) is given by the Catalan numbers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e026" xlink:type="simple"/></inline-formula>. For example, a tree of 100 tips has nearly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e027" xlink:type="simple"/></inline-formula> shapes. This presents a problem: how do we know which resolutions of shapes are being compared between two trees? We resolved this issue by ‘ladderizing’ the trees: rotating branches around every node so that branches leading to the larger number of descendants (tips) were always on the same side. This procedure, conventionally used to produce a more aesthetically pleasing visualization of a phylogeny, greatly increases the chance of finding matching subset trees between two phylogenies. Furthermore, we rotated branches around all ‘cherries’ (nodes that are the direct ancestor of two tips) such that the longer branch was always on the same side. Based on simulations (see below), we determined that this combination of ladderization and rotating cherries significantly improved our ability to correctly classify simulated trees (<xref ref-type="supplementary-material" rid="pone.0078122.s006">Table S2</xref>), indicating that these steps resolved different trees into shapes which could be compared in a consistent and meaningful way.</p>
<p>Following Moschitti’s notation <xref ref-type="bibr" rid="pone.0078122-Moschitti1">[16]</xref>, we defined a phylogenetic tree shape kernel by:<disp-formula id="pone.0078122.e028"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0078122.e028" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e029" xlink:type="simple"/></inline-formula> is the set of all nodes from the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e030" xlink:type="simple"/></inline-formula> tree <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e031" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e032" xlink:type="simple"/></inline-formula> is defined as follows:</p>
<list list-type="bullet"><list-item>
<p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e033" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e034" xlink:type="simple"/></inline-formula> are leaf nodes, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e035" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e036" xlink:type="simple"/></inline-formula> is a constant decay factor.</p>
</list-item><list-item>
<p>If the numbers of children descending from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e037" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e038" xlink:type="simple"/></inline-formula> are the same (always two for bifurcating trees) and, of these, the numbers of leaf nodes are also the same, then:</p>
</list-item></list>
<p><disp-formula id="pone.0078122.e039"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0078122.e039" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e040" xlink:type="simple"/></inline-formula> is the number of children descending from node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e041" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e042" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e043" xlink:type="simple"/></inline-formula>-th child of node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e044" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e045" xlink:type="simple"/></inline-formula> is a Gaussian radial basis function on the vectors of branch lengths descending from nodes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e046" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e047" xlink:type="simple"/></inline-formula>, denoted as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e048" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e049" xlink:type="simple"/></inline-formula> respectively:</p>
<p><disp-formula id="pone.0078122.e050"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0078122.e050" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e051" xlink:type="simple"/></inline-formula> is the variance parameter that determines how strongly subset trees are penalized for discordant branch lengths.</p>
<list list-type="bullet"><list-item>
<p>Otherwise, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e052" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
<p>Note that matching subset trees were weighted in proportion to their size (number of nodes). Because a tree will match its own shape exactly, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e053" xlink:type="simple"/></inline-formula> can take overwhelmingly large values. This ‘large diagonal’ effect <xref ref-type="bibr" rid="pone.0078122-Weston1">[27]</xref> can severely curtail the effectiveness of subsequent analyses of the kernel matrix (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e054" xlink:type="simple"/></inline-formula>), which is a symmetric matrix that is obtained by applying the kernel function to all pairs of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e055" xlink:type="simple"/></inline-formula> trees, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e056" xlink:type="simple"/></inline-formula>. Therefore, the constant decay factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e057" xlink:type="simple"/></inline-formula> served to penalize larger subset trees because it declined exponentially with tree size <xref ref-type="bibr" rid="pone.0078122-Collins1">[15]</xref>. The Gaussian radial basis function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e058" xlink:type="simple"/></inline-formula> further penalized subset trees by the discordance in branch lengths for pairs of branches originating from the matching nodes (<xref ref-type="fig" rid="pone-0078122-g002">Figure 2</xref>). Although this incorporation of branch lengths is a significant departure from the original tree kernel for natural language processing, we prove that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e059" xlink:type="simple"/></inline-formula> is a valid positive semi-definite kernel function (<xref ref-type="supplementary-material" rid="pone.0078122.s007">Text S1</xref>).</p>
<p>Phylogenies were imported from the Newick tree strings produced by RAxML into Python using the Phylo module from the Biopython package <xref ref-type="bibr" rid="pone.0078122-Cock1">[28]</xref>, <xref ref-type="bibr" rid="pone.0078122-Talevich1">[29]</xref>. Branch lengths in each phylogeny were normalized by the mean branch length to facilitate comparisons between viruses with different overall rates of evolution. A kernel matrix was computed from this collection of phylogenies using a custom Python module, which we have made publicly available on our webserver (<ext-link ext-link-type="uri" xlink:href="http://bioinfo.cfenet.ubc.ca/pub/phylokernel" xlink:type="simple">http://bioinfo.cfenet.ubc.ca/pub/phylokernel</ext-link>). Although the kernel function can be computed quickly <xref ref-type="bibr" rid="pone.0078122-Moschitti1">[16]</xref>, we needed to compute the kernel matrix for 4153 phylogenies (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e060" xlink:type="simple"/></inline-formula> replicates + <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e061" xlink:type="simple"/></inline-formula> samples by collection year + <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e062" xlink:type="simple"/></inline-formula>) with over 8 million pairwise comparisons. To speed up this calculation, we performed parallel computation on a Linux cluster with a message-passing interface (MPI) environment <xref ref-type="bibr" rid="pone.0078122-Dalcn1">[30]</xref>. The matrix was confirmed to be positive semi-definite by Cholesky decomposition. Following Collins and Duffy <xref ref-type="bibr" rid="pone.0078122-Collins1">[15]</xref>, all entries in the matrix were normalized by the formula<disp-formula id="pone.0078122.e063"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0078122.e063" xlink:type="simple"/></disp-formula>so that the resulting kernel matrix was less sensitive to differences in the sizes of the respective trees. Values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e064" xlink:type="simple"/></inline-formula> for replicate sets of phylogenies generated from random samples were averaged for every pairwise comparison of viruses or virus clades, and the resulting group mean distance matrix was renormalized. Kernel principal components analysis and support vector machine classification were performed on this normalized kernel matrix using the <italic>R</italic> package <italic>kernlab</italic> <xref ref-type="bibr" rid="pone.0078122-Karatzoglou1">[31]</xref>.</p>
</sec><sec id="s2e">
<title>Simulating Phylogenies</title>
<p>We used the R package <italic>diversitree</italic> <xref ref-type="bibr" rid="pone.0078122-FitzJohn1">[32]</xref> to simulate the growth of phylogenies under different evolutionary scenarios of branching or ‘speciation’ rates. Trees were generated under a Quantitative State Speciation and Extinction (QuaSSE) model <xref ref-type="bibr" rid="pone.0078122-FitzJohn2">[33]</xref> whereby speciation rates were determined by a continuous trait whose evolution was simulated by a Brownian motion (with zero drift and variance per unit time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e065" xlink:type="simple"/></inline-formula>) under two different mutation rates (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e066" xlink:type="simple"/></inline-formula> = 0.1 and 0.01). This continuous trait was mapped to a speciation rate by a sigmoidal function with a zero midpoint, exponential decay rate of 0.25, and minimum and maximum values of 0.05 and 0.25, respectively. We performed two sets of 100 replicate simulations under the different mutation rate scenarios. The simulated data were converted into Newick tree strings using a Python script derived from the Biopython Phylo module <xref ref-type="bibr" rid="pone.0078122-Talevich1">[29]</xref>. These strings are publicly available at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.cfenet.ubc.ca/pub/phylokernel" xlink:type="simple">http://bioinfo.cfenet.ubc.ca/pub/phylokernel</ext-link>. We calculated nine different tree balance statistics – Colless’ index, Sackin’s index, mean path length, variation in path length, Shao and Sokal’s <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e067" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e068" xlink:type="simple"/></inline-formula>, and the sum, total mean, and mean of the 10 earliest nodes of Fusco and Cronk’s imbalance statistic <xref ref-type="bibr" rid="pone.0078122-Purvis1">[34]</xref> – for all trees using functions written in Python. A kernel matrix was computed for all trees using the methods described above. We trained a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e069" xlink:type="simple"/></inline-formula>-support vector machine classifier <xref ref-type="bibr" rid="pone.0078122-Schlkopf1">[35]</xref> using the R package <italic>kernlab</italic> on a random subset of half of the phylogenies, and then measured the sensitivity and specificity of classification by mutation rate on the remaining half. Likewise, the sensitivity and specificity of classifying trees by tree balance statistics was evaluated at varying cutoffs using the R package <italic>ROCR</italic> <xref ref-type="bibr" rid="pone.0078122-Sing1">[36]</xref>.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Performance on Simulated Trees</title>
<p>We simulated two sets of 100 replicate phylogenies under different mutation rates (200 trees total) that influenced the branching rates in the phylogeny in an autocorrelated fashion <xref ref-type="bibr" rid="pone.0078122-FitzJohn1">[32]</xref>. In other words, the branching rate was allowed to evolve as each phylogeny grew from a common ancestor to 100 descendants. These simulations provide a reasonable approximation of the kind of evolutionary scenarios between which tree balance statistics were meant to differentiate <xref ref-type="bibr" rid="pone.0078122-Agapow1">[12]</xref>, since preferential branching along fewer lineages will tend to produce an imbalanced tree. For all simulated phylogenies, we computed nine different balance statistics (the eight statistics assessed in <xref ref-type="bibr" rid="pone.0078122-Agapow1">[12]</xref> and Sackin’s index). In addition, we computed the kernel matrix for all simulated phylogenies using our phylogenetic tree shape kernel. Note that the kernel method does not function as a summary statistic; it cannot assign a value to a given tree in the absence of any other information. Consequently, we compared the kernel method to balance statistics by evaluating their performance at correctly classifying trees that had been generated under different models of speciation, which is analogous to the transmission of an infectious disease between hosts.</p>
<p>The sensitivity and specificity of classifying the simulated phylogenies by mutation rates (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e070" xlink:type="simple"/></inline-formula> = 0.01 and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e071" xlink:type="simple"/></inline-formula> = 0.1) is summarized in <xref ref-type="fig" rid="pone-0078122-g003">Figure 3</xref>. Using our kernel method, we obtained a median sensitivity of 97.7% (interquartile range, IQR = 95.6%, 98.0%) and specificity of 90.8% (IQR = 89.1%, 92.8%) when averaged over 100 replicate training sets. These results were unambiguously superior to all nine balance statistics that were evaluated over the same simulated data. For instance, the sum of Fusco and Cronk’s imbalance statistic was the most effective among the balance statistics, but none could exceed a sensitivity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e072" xlink:type="simple"/></inline-formula>80% without a corresponding drop in specificity below <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e073" xlink:type="simple"/></inline-formula>80%. Thus, the kernel method is capable of providing a substantial advantage for recognizing virus trees that have evolved under different evolutionary and epidemiological scenarios.</p>
<fig id="pone-0078122-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0078122.g003</object-id><label>Figure 3</label><caption>
<title>Classification of simulated phylogenies using nine balance statistics and the kernel function.</title>
<p>We simulated the growth of two sets of 100 phylogenies relating 100 taxa under different scenarios in which rates of speciation (branching) evolved at different rates. Greater variation in speciation rates tended to produce more imbalanced trees. Nine different balance statistics, including eight from <xref ref-type="bibr" rid="pone.0078122-Agapow1">[12]</xref>, were computed for all phylogenies: Colless’ index, Sackin’s index, the mean and variance in path lengths from tips to the root, Shao and Sokal’s <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e074" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e075" xlink:type="simple"/></inline-formula> statistics, and the imbalance value (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e076" xlink:type="simple"/></inline-formula>) for the sum, total mean, and the mean of the earliest 10 internal nodes of the tree. This plot illustrates the trade-off between sensitivity and specificity of classifying phylogenies by applying a cutoff value each of these balance statistics. A single point (star) indicates the sensitivity and specificity attained by applying the phylogenetic kernel function (with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e077" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e078" xlink:type="simple"/></inline-formula>) to train a support vector machine (SVM) on a random subset (50%) of the phylogenies, and classifying the remaining half.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0078122.g003" position="float" xlink:type="simple"/></fig>
<p>To determine the sensitivity of the kernel function to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e079" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e080" xlink:type="simple"/></inline-formula>, we evaluated our ability to classify simulated phylogenies under varying parameter settings. We found that both sensitivity and specificity were robust to different settings of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e081" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e082" xlink:type="simple"/></inline-formula> (<xref ref-type="supplementary-material" rid="pone.0078122.s001">Figure S1</xref>). For example, mean sensitivities varied by less than 1% (0.97 to 0.98) for values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e083" xlink:type="simple"/></inline-formula> ranging from 1.0 to 20.0, given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e084" xlink:type="simple"/></inline-formula>; setting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e085" xlink:type="simple"/></inline-formula> conferred a slight advantage over this range in the classification of simulated phylogenies. These tests indicated that results from applying our kernel function to RNA virus phylogenies would be robust to varying parameter settings. This conjecture was supported in a comparison of kernel matrix projections under different settings (<xref ref-type="supplementary-material" rid="pone.0078122.s002">Figure S2</xref>; see below).</p>
</sec><sec id="s3b">
<title>Tree Balance in RNA Viruses</title>
<p>We used maximum likelihood-based heuristics to reconstruct phylogenies from 62 sequence alignments representing 38 different human and zoonotic RNA viruses from 12 different taxonomic families (<xref ref-type="supplementary-material" rid="pone.0078122.s005">Table S1</xref>). Genetic sequences from viruses with highly divergent clades, such as the human immunodeficiency virus type 1 (HIV-1) subtypes or influenza A virus serotypes, were grouped accordingly into separate multiple sequence alignments to allow for clade-specific epidemiological or evolutionary dynamics. Replicate phylogenies were generated from random samples of 100 sequences (given adequate sample size) to control for the well-documented confounding effect of variation in sample size on conventional tree shape statistics <xref ref-type="bibr" rid="pone.0078122-Pompei1">[9]</xref>.</p>
<p>For each alignment, we calculated the means across replicates of two tree balance statistics (Colless’ index and Sackin’s index), which quantify the asymmetry in rates of branching among ancestral lineages in each tree. Specifically, Sackin’s index <xref ref-type="bibr" rid="pone.0078122-Sackin1">[8]</xref> counts the number of ancestral nodes separating each tip to the root, while Colless’ index <xref ref-type="bibr" rid="pone.0078122-Colless1">[37]</xref> evaluates the difference in the number of tips that descend from the left and right branches of each bifurcating ancestral node. The distribution of mean Colless’ indices is displayed in <xref ref-type="fig" rid="pone-0078122-g004">Figure 4</xref>. As expected, influenza A virus (IAV) serotype H3 assumed one of the highest mean Colless’ indices (0.544) indicating that the replicate trees were severely imbalanced; only Murray valley encephalitis virus (MVEV) presented a higher index (0.548). Only 39 published MVEV envelope sequences were available after culling 7 identical sequences; however, Colless’ index is expected to be biased downwards with decreasing sample size, suggesting that the mean index for 100-sequence MVEV trees could have been even greater still. MVEV is endemic to Australia and Papua New Guinea and comprised almost entirely of mosquito isolates sampled over six decades (1956–2008). The IAV H3 sequences were strictly human isolates from around the globe but also sampled over a period of several decades (1968–2012).</p>
<fig id="pone-0078122-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0078122.g004</object-id><label>Figure 4</label><caption>
<title>Distribution of mean normalized Colless’ indices.</title>
<p>Each label represents the mean index of a virus or virus clade. The vertical axis is used to elucidate the clustering of points by forcing overlapping labels (phylogenies with similar indices) to ‘pile up’ like a histogram. A higher Colless’ index corresponds to a less ‘balanced’ tree in which branching events tend to occur along the same lineage. A conventional histogram is displayed in the background. Labels are defined as follows: AstV = <italic>astrovirus</italic>; CCHF = <italic>Crimean-Congo hemorrhagic fever virus</italic>; ChikV = <italic>chikungunya virus</italic>; CA24v = <italic>coxsackievirus A24</italic>; DEN = <italic>dengue virus</italic>; E30 = <italic>echovirus 30</italic>; EMCV = <italic>encephalomyocarditis virus</italic>; EV71 = <italic>enterovirus 71</italic>; GBVC = <italic>GB virus C</italic>; HTNV = <italic>Hantaan virus</italic>; H[A-E]V = <italic>hepatitis [A-E] virus</italic>; HIV = <italic>human immunodeficiency virus type 1</italic>; I[A-C]V = <italic>influenza [A-C] virus</italic>; JEV = <italic>Japanese encephalitis virus</italic>; MeV = <italic>measles virus</italic>; MuV = <italic>mumps virus</italic>; MVEV = <italic>Murray valley encephalitis virus</italic>; NV = <italic>Norwalk virus</italic>; OROV = <italic>Oropouche virus</italic>; hPIV-1 = <italic>human parainfluenza virus</italic>; PV = <italic>poliovirus</italic>; Rab = <italic>rabies virus</italic>; Rot = <italic>human rotavirus</italic>; RhiV = <italic>human rhinovirus</italic>; RSV = <italic>human respiratory syncytical virus</italic>; Rub = <italic>rubella virus</italic>; RVF = <italic>Rift valley fever virus</italic>; SapV = <italic>sapovirus</italic>; SeoV = <italic>Seoul virus</italic>; TBEV = <italic>tick-borne encephalitis virus</italic>; WNV = <italic>West Nile virus</italic>; YFV = <italic>yellow fever virus</italic>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0078122.g004" position="float" xlink:type="simple"/></fig>
<p>This raises a concern of whether tree balance is an artefact of biased sampling of virus isolates over time, such that the overrepresentation of isolates from a narrow range of years might tend to yield balanced trees. To address this, we calculated the mean Colless’ indices for phylogenies generated from samples that were uniform with respect to sample collection years for alignments in which an adequate number of sequences were annotated with collection dates (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e086" xlink:type="simple"/></inline-formula>). Using Lin’s concordance correlation coefficient (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e087" xlink:type="simple"/></inline-formula>) <xref ref-type="bibr" rid="pone.0078122-Lin1">[38]</xref> to quantify the agreement between indices, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e088" xlink:type="simple"/></inline-formula> indicates perfect agreement and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e089" xlink:type="simple"/></inline-formula> indicates no agreement, we found that the mean Colless’ indices for phylogenies whose tips were uniformly distributed over years were highly concordant with indices from random samples (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e090" xlink:type="simple"/></inline-formula>, 95% C.I.<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e091" xlink:type="simple"/></inline-formula>). In other words, constraining the phylogenies of other viruses such as HIV to have evenly distributed tips over time did not make their Colless’ indices more IAV-like.</p>
<p>In sum, the distribution of mean Colless’ indices was highly peaked in the interval between 0.15 to 0.2, such that this summary statistic did not discriminate substantially among the phylogenies of most RNA viruses in our study (<xref ref-type="fig" rid="pone-0078122-g004">Figure 4</xref>). For example, the third-highest mean index (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e092" xlink:type="simple"/></inline-formula>) derived from IAV serotype H1 phylogenies was similar to the index of a hepatitis C virus (HCV) genotype 2a phylogeny (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e093" xlink:type="simple"/></inline-formula>), which would not seem to be consistent with the observation that phylogenies from HCV and IAV have conspicuously different shapes <xref ref-type="bibr" rid="pone.0078122-Grenfell1">[2]</xref>. Specifically, we found that 6 out of 100 replicate samples of IAV-H1 sequences led to Colless’ indices that were less than the value observed for HCV-2a. Similarly, the relatively low Colless’ indices of phylogenies of influenza B virus (IBV, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e094" xlink:type="simple"/></inline-formula>), which together with IAV serotypes H1 and H3 is responsible for the majority of seasonal influenza outbreaks, implies that the imbalance of IBV-derived trees is no different from the bulk of animal RNA viruses (<xref ref-type="fig" rid="pone-0078122-g004">Figure 4</xref>). Furthermore, the mean Colless’ index did not differentiate the phylogenies of HIV and HCV from other RNA viruses. We obtained the same qualitative results from an evaluation of mean Sackin’s indices (<xref ref-type="supplementary-material" rid="pone.0078122.s003">Figure S3</xref>), which were highly correlated with the respective mean Colless’ indices (Pearson’s <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e095" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e096" xlink:type="simple"/></inline-formula>). There is much more to the conspicuously star-like shape of HIV and HCV phylogenies that remains unquantifiable by balance statistics. Consequently, relying too heavily on tree balance statistics potentially limits our ability to measure the diversity of human and zoonotic RNA virus phylogenies, and to link recurring shapes to epidemiological or evolutionary processes.</p>
</sec><sec id="s3c">
<title>Kernel Analysis of RNA Virus Trees</title>
<p>Here, we develop and apply a new approach to comparing RNA virus tree shapes by using a method from machine learning known as the ‘kernel trick’ <xref ref-type="bibr" rid="pone.0078122-Aizerman1">[10]</xref>. Rather than attempting to reduce a complex tree shape down to one or more summary statistics, like the tree balance indices examined above, we defined a kernel function (<xref ref-type="fig" rid="pone-0078122-g002">Figure 2</xref>) that efficiently computes inner products between phylogenies with respect to their tree shapes. By this approach, a tree’s shape is quantified only by its comparison to other trees. We have shown above that this method can be highly effective at discriminating between the shapes of phylogenies that were simulated under different evolutionary scenarios. We applied this phylogenetic tree kernel to our collection of RNA virus phylogenies to generate a kernel matrix that is akin to a pairwise similarity matrix. Entries in the kernel matrix were averaged across replicate phylogenies from the same alignments, and renormalized to yield a smaller kernel matrix with rows or columns corresponding to different viruses or virus clades and sampling schemes (completely at random or uniformly with respect to collection year). According to the eigenvalues of this projection, about 90% of the variance was explained by the first 2 principal components alone, with about 70% of the variance explained by the first component; these percentages varied slightly with different parameter settings of the kernel function (<xref ref-type="supplementary-material" rid="pone.0078122.s002">Figure S2</xref>). In all cases, the first component distinctly separated the phylogenies derived from HIV and HCV sequences from the rest of the RNA viruses. However, none of the remaining principal components were as readily interpretable. Furthermore, neither Sackin’s nor Colless’ indices were significantly correlated with any of the principal components based on a simple Pearson correlation test after adjusting for multiple comparisons. Additionally, we trained a support vector regression model using the kernel matrix and Colless’ indices for a random subset of the data. The mean concordance correlation coefficient <xref ref-type="bibr" rid="pone.0078122-Lawrence1">[39]</xref> between the observed Colless’ indices and those predicted by this model for the remaining phylogenies was only 0.12 (interquartile range 0.07, 0.18), which is considered poor. These results, which were robust to varying <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e097" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e098" xlink:type="simple"/></inline-formula>, suggested that the kernel was manifesting aspects of phylogenetic tree shapes other than those captured by tree balance statistics.</p>
<p>A scatterplot of the largest 2 principal components from the preceding analysis described a single arc in which HIV and HCV phylogenies comprised a distinct cluster from the other RNA viruses (<xref ref-type="supplementary-material" rid="pone.0078122.s002">Figure S2</xref>). However, the majority of the other viruses were agglomerated at the base of the arc, making it difficult to discern patterns from this visualization. This is a known issue in PCA in which the largest components are assumed to represent the important structure in the data whereas smaller components represent noise. To provide a clearer visualization, we generated another scatterplot (<xref ref-type="fig" rid="pone-0078122-g005">Figure 5</xref>) using a t-distributed stochastic neighbor embedding algorithm (t-SNE) which attempts to preserve both global and local structure in a low-dimensional visualization of high-dimensional data <xref ref-type="bibr" rid="pone.0078122-vanderMaaten1">[40]</xref>. Again, HIV and HCV comprised a distinct cluster in this visualization. Phylogenies derived from these viruses tend to feature long terminal branches and relatively short internal branches (<xref ref-type="fig" rid="pone-0078122-g001">Figure 1</xref>), which has been attributed to the exponential spread of these viruses and their propensity to establish persistent infections. This outcome was robust to partitioning sequences by clade; for example, a phylogeny comprised of all three HIV subtypes in our study mapped adjacent to the HIV subtype-specific phylogenies in both types of projections (data not shown).</p>
<fig id="pone-0078122-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0078122.g005</object-id><label>Figure 5</label><caption>
<title>A visualization of RNA virus phylogenies in the tree shape kernel space (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e099" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e100" xlink:type="simple"/></inline-formula>) using t-distributed stochastic neighbor embedding (t-SNE).</title>
<p>The t-SNE algorithm attempts to find the optimal map of high-dimensional data into a low-dimensional space while preserving the distances among points as much as possible. Thus, the distance between pair of viruses or virus clades (labelled by the same abbreviations as <xref ref-type="fig" rid="pone-0078122-g004">Figure 4</xref>) is approximately proportional to their mean kernel distance. Groups of virus clades of particular interest are highlighted with the corresponding colours: HIV, red; HCV, yellow; Dengue (DEN), green; IAV-H3, IAV-H1, and IBV (blue).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0078122.g005" position="float" xlink:type="simple"/></fig>
<p>GB virus C (GBVC), which is not known to be associated with any human disease, was consistently located within the cluster of HIV and HCV phylogenies in the kernel PCA projections. (Due to the stochastic nature of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e101" xlink:type="simple"/></inline-formula>-SNE algorithm, GBVC was not always embedded in the vicinity of HIV and HCV.) A close relative of HCV, GBVC can establish persistent infections in its human hosts and may inhibit HIV replication when an individual has become co-infected by both viruses <xref ref-type="bibr" rid="pone.0078122-Williams1">[41]</xref>. Thus, the ability to establish persistent infections appears to be a common characteristic of viruses whose phylogenies map to this region of tree shape space. To test this hypothesis, we trained a support vector machine (SVM) classifier to differentiate between viruses having the ability to establish persistent chronic infections (HIV, HCV, and GBVC) and those without. We randomly selected half of the members from each category and used the corresponding rows and columns in the kernel matrix as training data. Validating the classifier on the remaining half of the kernel matrix, we consistently obtained a sensitivity and specificity of 1.0 irrespective of varying the kernel parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e102" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e103" xlink:type="simple"/></inline-formula>, indicating that viruses that can establish persistent chronic infections were unambiguously separated from the other RNA viruses in the space defined by the tree kernel.</p>
<p>The influenza viruses predominantly responsible for the seasonal epidemics around the world (IAV-H1, IAV-H3, and IBV) were located close together in both projections of the kernel matrix. In contrast, the Sackin’s and Colless’ indices for IBV were substantially lower than those of IAV-H1 and IAV-H3. This suggests that the kernel was more successful in identifying commonalities in the shapes of the phylogenies of these influenza viruses. On the other hand, these influenza viruses were located in the midst of many other RNA viruses in both projections, despite the strikingly pectinate shape of IAV-H3 (<xref ref-type="fig" rid="pone-0078122-g001">Figure 1</xref>). Phylogenies from the other influenza viruses in this study (IAV-H2, IAV-H5, and influenza C virus) mapped further away from the seasonal epidemic influenza viruses. These other phylogenies tended to have longer internal branches (relative to terminal branches) than the phylogenies of IAV-H1, IAV-H3, and IBV. Specifically, the ratio of the median branch lengths of internal and terminal branches, respectively, was significantly greater for the other influenza viruses than the seasonal epidemic influenza viruses (Wilcoxon rank sum test <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e104" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e105" xlink:type="simple"/></inline-formula>). A possible explanation for this pattern is that the H2 and H5 subtypes are infrequently re-introduced into the human population from under-sampled avian host populations; consequently, the evolving diversity of these viruses would be represented by only a small number of lineages in phylogenies.</p>
<p>Our survey of animal RNA viruses included several examples of zoonotic viruses. One might anticipate that these viruses could map to one or more distinct regions in projections of the kernel matrix. We observed that mosquito-transmitted zoonotic viruses such as the highly divergent dengue serotypes (DEN-1 to -4), the arboviral encephalitides (Japanese encephalitis virus and West Nile virus), and yellow fever virus tended to map to a similar region in projections of the kernel matrix, although this region was not exclusive of other viruses for which humans are the only known natural hosts, such as rubella virus and poliovirus (<xref ref-type="fig" rid="pone-0078122-g005">Figure 5</xref>). Another interesting feature of this projection was that phylogenies representing clades of the zoonotic rabies virus (RabV-1 to -3) mapped to a similar region as the mosquito-transmitted zoonotic viruses. The majority of the rabies virus sequences were isolated from non-human hosts predominated by canine (numbered here as clades 1 and 3) and bat species (clade 2), with about 2%–9% sequences isolated from human hosts (<xref ref-type="supplementary-material" rid="pone.0078122.s005">Table S1</xref>).</p>
<p>Finally, we observed that phylogenies from certain viruses shared a distinctive rapid proliferation of short terminal branches within one or more specific clades which may be a signature of sporadic outbreaks, as illustrated by the coxsackievirus A24 variant phylogeny (CA24v) depicted in <xref ref-type="fig" rid="pone-0078122-g001">Figure 1</xref>. For example, the majority of CA24v sequences within the highly unresolved clade of its phylogenies were sampled during outbreaks of acute hemorrhagic conjunctivitis in Brazil and China. The proximity of the zoonotic viruses Hantaan virus (HTNV) and Murray Valley encephalitis virus (MVEV) to CA24v in projections of the kernel matrices (<xref ref-type="supplementary-material" rid="pone.0078122.s002">Figure S2</xref>) suggested that the shapes of the respective phylogenies may have also been shaped by sporadic outbreaks.</p>
<p>To assess the potential bias of uneven sampling over time, we incorporated replicate phylogenies into the kernel matrix that were generated from samples of virus sequences drawn at random with respect to collection year. We found that the mean distances between phylogenies sampled completely at random and phylogenies sampled uniformly by collection year from the same virus or virus clade were significantly shorter (larger kernel scores) than the mean distances between phylogenies from different viruses or virus clades (Wilcoxon rank sum test, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e106" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e107" xlink:type="simple"/></inline-formula>). Specifically, the mean normalized kernel score between phylogenies of the same virus obtained by different sampling schemes was 0.98, whereas the mean among phylogenies from different viruses was 0.84, where a normalized score of 1.0 indicates an exact match with respect to tree shape. On visually examining a PCA projection of this kernel matrix, we found that sampling uniformly by collection year tended to shift phylogenies along the same trajectory in the space of tree shapes (<xref ref-type="supplementary-material" rid="pone.0078122.s004">Figure S4</xref>). With the exception of HCV genotype 6a (for which about 50% of isolates were obtained in 2006 alone), the cluster of HIV and HCV viruses remained distinct from other RNA viruses including the influenza viruses.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>In this study, we have proposed a new framework for comparing phylogenetic tree shapes by extending a parse tree kernel from computational linguistics <xref ref-type="bibr" rid="pone.0078122-Moschitti1">[16]</xref>. Our kernel function compares all subset trees shared by two phylogenies and weights this comparison by the concordance of branch lengths that comprise the respective subset trees (<xref ref-type="fig" rid="pone-0078122-g002">Figure 2</xref>). It therefore bears some similarity to the weighted Robinson-Foulds metric that is based on comparing the lengths of branches that descend from each ancestral node <xref ref-type="bibr" rid="pone.0078122-Robinson1">[14]</xref>. However, the Robinson-Foulds metric is restricted to comparing alternative trees relating the same taxa; in other words, the terminal branches must have the same labels. This requirement makes it impossible to use the Robinson-Foulds metric to compare phylogenies from different viruses. In contrast, our kernel is designed to compare trees from completely different sets of taxa because it discriminates among subset trees primarily by the number of terminal branches that descend from each ancestral node, regardless of what taxa occupy the tips of those branches. Moreover, if two phylogenies had a subset tree in common, that subset tree would have to occur in the same location of the trees to be counted towards the Robinson-Foulds metric. In contrast, since the tree shape kernel iterates over all internal nodes in both phylogenies, subset trees in different locations can contribute towards the kernel score. This is an important distinction because we are primarily interested in recurring motifs in tree shape, irrespective of where they appear in either tree, because this commonality may represent the imprint of a common epidemiological or evolutionary process acting on both viruses.</p>
<p>Using conventional tree balance statistics, we found limited variation among phylogenies from different RNA viruses, with most viruses falling into a narrow range of Colless’ or Sackin’s indices after controlling for sample size variation. In contrast, our kernel function was able to separate the distinctively star-like phylogenies of HIV and hepatitis C virus. However, it was unable to distinguish the conspicuously pectinate shapes of IAV-H1 and -H3 phylogenies to the same extent as the tree balance statistics. This is most likely due to our use of a decay factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e108" xlink:type="simple"/></inline-formula> in computing the kernel function to penalize larger subset tree matches. Unless we penalize subset trees by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e109" xlink:type="simple"/></inline-formula>, large phylogenies would result in enormous values along the diagonal of the kernel matrix because a phylogeny will always match itself exactly, washing out any patterns from comparisons between different phylogenies. In other words, our use of a decay factor places greater emphasis on local than global similarities between the shapes of two phylogenies. Using a decay factor evidently prevents the full extent of the imbalance in the IAV-H1 or -H3 phylogenies from being expressed in the kernel matrix, since the longer subset trees that would represent this large-scale pattern are penalized more heavily.</p>
<p>A common concern directed at studies of phylogenetic tree shapes is that variation in tree shapes may be an artefact of differences in sampling. For example, influenza A virus sequences in our data were sampled over a wide range of years from 1925 to 2012, with 72% of sequences sampled after 2001. It is possible that differences among viruses in the distributions of sample dates may introduce a bias to tree balance statistics or the kernel method. However, when we constrained samples across viruses to be sampled uniformly with respect to collection years, we found no significant effect on the distributions of RNA viruses for either tree balance or kernel-based methods. Analyses of tree shapes can be robust to temporal sampling biases because the internal structures of the phylogenies are often comprised of ancestors that are substantially further back in time. For example, there was very little clustering of HIV-1 subtype B sequences in the phylogeny with respect to collection year, implying that a phylogeny reconstructed a tree from sequences collected in a specific year will retain most of its deeper structure.</p>
<p>The tree shape kernel presented here potentially represents an important new exploratory tool for studying RNA virus phylogenies. By extracting recurring local motifs in the internal structures of different phylogenies, it can complement the established tree balance statistics to provide a more complete description of the diversity of tree shapes among RNA viruses <xref ref-type="bibr" rid="pone.0078122-Holmes1">[3]</xref>. Our kernel is not a parametric model in itself; unlike recent advances in viral phylodynamics <xref ref-type="bibr" rid="pone.0078122-Frost1">[42]</xref>, it does not attempt to directly estimate epidemiological model parameters from tree shapes. Unlike a tree balance statistic, the kernel function cannot assign a numerical value to a single phylogeny in the absence of any other data. Without summary statistics to compare to reported values in the literature, it is necessary to have at hand all the phylogenies that one wishes to compare in order to compute the entire kernel matrix. On the other hand, the use of a kernel method presents opportunities to utilize other techniques from machine learning such as support vector machines (SVMs) to extract and analyze patterns in phylogenetic tree shapes. For example, we simulated phylogenies under two different evolutionary scenarios that influenced the asymmetry in branching rates among lineages, and we found that an SVM assisted by our kernel function clearly outperformed nine different tree balance statistics at predicting which phylogeny was generated under which scenario (<xref ref-type="fig" rid="pone-0078122-g003">Figure 3</xref>). Furthermore, we trained another SVM classifier on a random subset of phylogenies labelled by whether the respective RNA viruses could establish persistent chronic infections. The trained model consistently predicted these labels for the remaining phylogenies with very high sensitivity and specificity (see Results section).</p>
<p>It is possible that a similar procedure could be used, for example, to determine the natural animal reservoir of an incompletely characterized zoonotic virus. This may not only require further development of kernel methods such as those presented here, but also greater coverage and more detailed annotation of published sequence data for RNA viruses that are under-represented in public databases. Additionally, the tree shape kernel may provide an effective distance measure for fitting complex phylodynamic models by approximate Bayesian computation <xref ref-type="bibr" rid="pone.0078122-Ratmann1">[43]</xref>, a rapidly emerging class of highly versatile and efficient computational methods in which a distance measure (such as the difference in summary statistics) is used to assess the congruence between model simulations and observed data.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pone.0078122.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0078122.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Sensitivities (solid lines) and specificities (dashed lines) of classifying simulated phylogenies where the kernel matrix was generated under different settings of </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e110" xlink:type="simple"/></inline-formula><bold> and </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e111" xlink:type="simple"/></inline-formula><bold>.</bold> Classification was performed using a kernel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e112" xlink:type="simple"/></inline-formula>-support vector machine implemented in the <italic>R</italic> package <italic>kernlab</italic> <xref ref-type="bibr" rid="pone.0078122-Karatzoglou1">[31]</xref>. For a given kernel matrix, sensitivity and specificity were averaged over 1000 replicate cross-validations on random samples of trees stratified by evolutionary scenario. Note that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e113" xlink:type="simple"/></inline-formula>-axis is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e114" xlink:type="simple"/></inline-formula>-transformed and the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e115" xlink:type="simple"/></inline-formula>-axis is scaled to the range of the observed values, which all exceeded the performance of classifications based on tree balance statistics. Varying the decay factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e116" xlink:type="simple"/></inline-formula> had little effect on either sensitivity or specificity; setting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e117" xlink:type="simple"/></inline-formula> conferred a very slight advantage in sensitivity over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e118" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e119" xlink:type="simple"/></inline-formula>. Both sensitivity and specificity were fairly robust to a wide range of values for the Gaussian radial basis function variance parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e120" xlink:type="simple"/></inline-formula>. For example, mean sensitivities varied by less than 1% for values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e121" xlink:type="simple"/></inline-formula> ranging from 1 to 20.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0078122.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0078122.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>PCA projections for kernel matrices generated from the RNA virus phylogenies under different settings for kernel function parameters </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e122" xlink:type="simple"/></inline-formula><bold> and </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e123" xlink:type="simple"/></inline-formula><bold>.</bold> Labels corresponding to virus species and clades are the same in <xref ref-type="fig" rid="pone-0078122-g004">Figure 4</xref>. Viruses of particular interest (such as HIV and the common pandemic influenza A viruses) are highlighted with coloured convex hulls as in <xref ref-type="fig" rid="pone-0078122-g005">Figure 5</xref>. The proportion of variance explained by the first two principal components (roughly 90% to 95%), as determined by eigenvalues, are reported as percentages in the axes labels.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0078122.s003" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0078122.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>Distribution of mean normalized Sackin’s indices.</bold> Each label represents the mean index of a virus or virus clade. The vertical axis is used to elucidate the clustering of points by forcing overlapping labels (phylogenies with similar indices) to ‘pile up’ like a histogram. A higher Sackin index corresponds to a less ‘balanced’ tree in which branching events tend to occur along the same lineage. Label annotations are identical to <xref ref-type="fig" rid="pone-0078122-g004">Figure 4</xref>.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0078122.s004" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0078122.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>Visualizing the effect of resampling virus sequences uniformly at random with respect to year of collection.</bold> The kernel matrix calculated from the original sample phylogenies (black) and the additional phylogenies from uniform sampling by year (red) is projected onto the first two principal components. Arrows are drawn between phylogenies generated by different sampling schemes from the same set of virus sequences. Note that this PCA projection is slightly different from projection generated under the same settings (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e124" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e125" xlink:type="simple"/></inline-formula>) depicted in <xref ref-type="supplementary-material" rid="pone.0078122.s002">Figure S2</xref> because it incorporates the uniform sample points.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0078122.s005" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0078122.s005" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p><bold>A list of all animal RNA viruses in this study, grouped by taxonomic family (bold face).</bold> Abbrev. = abbreviation used in figures. <italic>N</italic> = number of sequences. %human = percentage of sequences isolated from human hosts. <italic>L</italic> = length of alignment in nucleotides. Outgroup accession = Genbank accession number of sequence used as outgroup. Reference = citation of article in peer-reviewed literature on which choice of outgroup is based; or a short note on the method used for outgroup selection.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0078122.s006" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0078122.s006" position="float" xlink:type="simple"><label>Table S2</label><caption>
<p><bold>Performance of kernel support vector machine classifier on 200 simulated phylogenies.</bold> Trees were simulated with the R package <italic>diversitree</italic> by evolving a latent character state (with mutation rates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e126" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e127" xlink:type="simple"/></inline-formula>) which controlled the rate of speciation (branching). All trees were modified by rotating branches around nodes according to some predefined scheme, resulting in different but evolutionarily invariant shapes. Kernel matrices were generated with the parameter settings <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e128" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e129" xlink:type="simple"/></inline-formula>. Sensitivity and specificity values were generated by R package <italic>ROCR</italic> and averaged across 1000 cross-validations (using a random subset of 100 trees to train the kernel classifier and validating on the remaining 100). Empirical 95% confidence intervals (C.I.) were derived from the 25th and 975th-ranked cross validations. Randomly rotating branches in the trees did not significantly affect our ability to classify them by evolutionary scenario (Student’s <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e130" xlink:type="simple"/></inline-formula>-test, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e131" xlink:type="simple"/></inline-formula>). Ladderizing the trees, such that the most prolific branches were rotated to the same side, conferred a substantial and significant gain in sensitivity and specificity of classification relative to the unmodified trees (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e132" xlink:type="simple"/></inline-formula>). Rotating ‘cherries’ (pairs of tips that descend directly from their common ancestor) of a ladderized tree, so that the longest branch was always to the same side, conferred a slight but significant advantage in classification (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e133" xlink:type="simple"/></inline-formula>). However, we found no advantage to rotating branches around internal nodes according to any of the schemes we evaluated. ‘Ties’ refer to nodes that are not cherries and have the same number of descendant tips to the left and right, making them ambiguous to ladderization. Rotating branches ‘by subtree’ indicates that the branch with the largest total branch length in the descendant subtree was rotated to the same side.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0078122.s007" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0078122.s007" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Proof that </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0078122.e134" xlink:type="simple"/></inline-formula><bold> is a positive semidefinite kernel.</bold></p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>The authors thank Chelsea Himsworth for providing valuable feedback on interpreting patterns among RNA viruses with respect to animal reservoirs; Jonathan Carlson for suggesting the use of t-distributed stochastic neighbor embedding to visualize the kernel matrix; and Paul-Michael Agapow for advice on simulating phylogenies.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0078122-Drake1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Drake</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Charlesworth</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Charlesworth</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Crow</surname><given-names>JF</given-names></name> (<year>1998</year>) <article-title>Rates of spontaneous mutation</article-title>. <source>Genetics</source> <volume>148</volume>: <fpage>1667</fpage>–<lpage>86</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Grenfell1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grenfell</surname><given-names>BT</given-names></name>, <name name-style="western"><surname>Pybus</surname><given-names>OG</given-names></name>, <name name-style="western"><surname>Gog</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Wood</surname><given-names>JLN</given-names></name>, <name name-style="western"><surname>Daly</surname><given-names>JM</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Unifying the epidemio-logical and evolutionary dynamics of pathogens</article-title>. <source>Science</source> <volume>303</volume>: <fpage>327</fpage>–<lpage>32</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Holmes1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holmes</surname><given-names>EC</given-names></name>, <name name-style="western"><surname>Grenfell</surname><given-names>BT</given-names></name> (<year>2009</year>) <article-title>Discovering the phylodynamics of RNA viruses</article-title>. <source>PLoS Com-put Biol</source> <volume>5</volume>: <fpage>e1000505</fpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Korber1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Korber</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Gaschen</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Yusim</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Thakallapally</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kesmir</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Evolutionary and immunological implications of contemporary HIV-1 variation</article-title>. <source>Br Med Bull</source> <volume>58</volume>: <fpage>19</fpage>–<lpage>42</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Sharp1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sharp</surname><given-names>PM</given-names></name> (<year>2002</year>) <article-title>Origins of human virus diversity</article-title>. <source>Cell</source> <volume>108</volume>: <fpage>305</fpage>–<lpage>12</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Nelson1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nelson</surname><given-names>MI</given-names></name>, <name name-style="western"><surname>Holmes</surname><given-names>EC</given-names></name> (<year>2007</year>) <article-title>The evolution of epidemic influenza</article-title>. <source>Nat Rev Genet</source> <volume>8</volume>: <fpage>196</fpage>–<lpage>205</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Blum1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blum</surname><given-names>MGB</given-names></name>, <name name-style="western"><surname>François</surname><given-names>O</given-names></name> (<year>2005</year>) <article-title>On statistical tests of phylogenetic tree imbalance: the sackin and other indices revisited</article-title>. <source>Math Biosci</source> <volume>195</volume>: <fpage>141</fpage>–<lpage>53</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Sackin1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sackin</surname><given-names>MJ</given-names></name> (<year>1972</year>) <article-title>“Good” and “bad” phenograms</article-title>. <source>Sys Zool</source> <volume>21</volume>: <fpage>225</fpage>–<lpage>226</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Pompei1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pompei</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Loreto</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Tria</surname><given-names>F</given-names></name> (<year>2012</year>) <article-title>Phylogenetic properties of rna viruses</article-title>. <source>PLoS One</source> <volume>7</volume>: <fpage>e44849</fpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Aizerman1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aizerman</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Braverman</surname><given-names>EM</given-names></name>, <name name-style="western"><surname>Rozoner</surname><given-names>LI</given-names></name> (<year>1964</year>) <article-title>Theoretical foundations of 1 the potential function method in pattern recognition learning</article-title>. <source>Automation and Remote Control</source> <volume>25</volume>: <fpage>821</fpage>–<lpage>837</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Vert1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vert</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Tsuda</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Schölkopf</surname><given-names>B</given-names></name> (<year>2004</year>) <article-title>Kernel methods in computational biology, MIT Press, chapter</article-title>. <volume>2</volume>: <fpage>35</fpage>–<lpage>70</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Agapow1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Agapow</surname><given-names>PM</given-names></name>, <name name-style="western"><surname>Purvis</surname><given-names>A</given-names></name> (<year>2002</year>) <article-title>Power of eight tree shape statistics to detect nonrandom diversification: a comparison by simulation of two models of cladogenesis</article-title>. <source>Syst Biol</source> <volume>51</volume>: <fpage>866</fpage>–<lpage>72</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Huelsenbeck1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Bollback</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>AM</given-names></name> (<year>2002</year>) <article-title>Inferring the root of a phylogenetic tree</article-title>. <source>Syst Biol</source> <volume>51</volume>: <fpage>32</fpage>–<lpage>43</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Robinson1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Foulds</surname><given-names>L</given-names></name> (<year>1981</year>) <article-title>Comparison of phylogenetic trees</article-title>. <source>Math Biosci</source> <volume>53</volume>: <fpage>131</fpage>–<lpage>147</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Collins1"><label>15</label>
<mixed-citation publication-type="other" xlink:type="simple">Collins M, Duffy N (2002) Convolution kernels for natural language. In: Dietterich TG, Becker S, Ghahramani Z, editors, Advances in Neural Information Processing Systems 14. Cambridge, MA: MIT Press.</mixed-citation>
</ref>
<ref id="pone.0078122-Moschitti1"><label>16</label>
<mixed-citation publication-type="other" xlink:type="simple">Moschitti A (2006) Making tree kernels practical for natural language learning. In: Proceedings of the 11th Conference of the European Chapter of the Association for Computational Linguistics.</mixed-citation>
</ref>
<ref id="pone.0078122-Hulo1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hulo</surname><given-names>C</given-names></name>, <name name-style="western"><surname>de Castro</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Masson</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Bougueleret</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Bairoch</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>ViralZone: a knowledge resource to understand virus diversity</article-title>. <source>Nucleic Acids Res</source> <volume>39</volume>: <fpage>D576</fpage>–<lpage>82</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-KosakovskyPond1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Posada</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Stawiski</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Chappey</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Poon</surname><given-names>AFY</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>An evo- lutionary model-based algorithm for accurate phylogenetic breakpoint mapping and subtype prediction in HIV-1</article-title>. <source>PLoS Comput Biol</source> <volume>5</volume>: <fpage>e1000581</fpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Kuiken1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuiken</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Yusim</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Boykin</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Richardson</surname><given-names>R</given-names></name> (<year>2005</year>) <article-title>The Los Alamos hepatitis C sequence database</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>379</fpage>–<lpage>84</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Gotoh1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gotoh</surname><given-names>O</given-names></name> (<year>1982</year>) <article-title>An improved algorithm for matching biological sequences</article-title>. <source>J Mol Biol</source> <volume>162</volume>: <fpage>705</fpage>–<lpage>8</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-KosakovskyPond2"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Frost</surname><given-names>SDW</given-names></name>, <name name-style="western"><surname>Muse</surname><given-names>SV</given-names></name> (<year>2005</year>) <article-title>HyPhy: hypothesis testing 1 using phylogenies</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>676</fpage>–<lpage>679</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Edgar1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name> (<year>2004</year>) <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source> <volume>32</volume>: <fpage>1792</fpage>–<lpage>7</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Price1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Price</surname><given-names>MN</given-names></name>, <name name-style="western"><surname>Dehal</surname><given-names>PS</given-names></name>, <name name-style="western"><surname>Arkin</surname><given-names>AP</given-names></name> (<year>2010</year>) <article-title>Fasttree 2–approximately maximum-likelihood trees for large alignments</article-title>. <source>PLoS One</source> <volume>5</volume>: <fpage>e9490</fpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Smithburn1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smithburn</surname><given-names>KC</given-names></name>, <name name-style="western"><surname>Hughes</surname><given-names>TP</given-names></name>, <name name-style="western"><surname>Burke</surname><given-names>AV</given-names></name>, <name name-style="western"><surname>Paul</surname><given-names>JH</given-names></name> (<year>1940</year>) <article-title>A neurotropic virus isolated from the blood of a native of uganda</article-title>. <source>Am J Trop Med Hyg</source> <volume>20</volume>: <fpage>471</fpage>–<lpage>492</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Stamatakis1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stamatakis</surname><given-names>A</given-names></name> (<year>2006</year>) <article-title>RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title>. <source>Bioinformatics</source> <volume>22</volume>: <fpage>2688</fpage>–<lpage>90</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Kirkpatrick1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kirkpatrick</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Slatkin</surname><given-names>M</given-names></name> (<year>1993</year>) <article-title>Searching for evolutionary patterns in the shape of a phylogenetic tree</article-title>. <source>Evolution</source> <volume>47</volume>: <fpage>1171</fpage>–<lpage>1181</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Weston1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weston</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Schölkopf</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Eskin</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Leslie</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Noble</surname><given-names>W</given-names></name> (<year>2003</year>) <article-title>Dealing with large diagonals in kernel matrices</article-title>. <source>Annals of the Institute of Statistical Mathematics</source> <volume>55</volume>: <fpage>391</fpage>–<lpage>408</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Cock1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cock</surname><given-names>PJA</given-names></name>, <name name-style="western"><surname>Antao</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Chang</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Chapman</surname><given-names>BA</given-names></name>, <name name-style="western"><surname>Cox</surname><given-names>CJ</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Biopython: freely available python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1422</fpage>–<lpage>3</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Talevich1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Talevich</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Invergo</surname><given-names>BM</given-names></name>, <name name-style="western"><surname>Cock</surname><given-names>PJA</given-names></name>, <name name-style="western"><surname>Chapman</surname><given-names>BA</given-names></name> (<year>2012</year>) <article-title>Bio.phylo: a unified toolkit for processing, analyzing and visualizing phylogenetic trees in biopython</article-title>. <source>BMC Bioinformatics</source> <volume>13</volume>: <fpage>209</fpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Dalcn1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dalcín</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Paz</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Storti</surname><given-names>M</given-names></name>, <name name-style="western"><surname>D’Elía</surname><given-names>J</given-names></name> (<year>2008</year>) <article-title>Mpi for python: Performance improvements and mpi-2 extensions</article-title>. <source>Journal of Parallel and Distributed Computing</source> <volume>68</volume>: <fpage>655</fpage>–<lpage>662</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Karatzoglou1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Karatzoglou</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Smola</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hornik</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Zeileis</surname><given-names>A</given-names></name> (<year>2004</year>) <article-title>kernlab – an S4 package for kernel methods in R. Journal of Statistical Software</article-title>. <volume>11</volume>: <fpage>1</fpage>–<lpage>20</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-FitzJohn1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>FitzJohn</surname><given-names>RG</given-names></name> (<year>2012</year>) <article-title>Diversitree: comparative phylogenetic analyses of diversification 1 in r</article-title>. <source>Methods in Ecology and Evolution</source> <volume>3</volume>: <fpage>1084</fpage>–<lpage>1092</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-FitzJohn2"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>FitzJohn</surname><given-names>RG</given-names></name> (<year>2010</year>) <article-title>Quantitative traits and diversification</article-title>. <source>Systematic Biology</source> <volume>59</volume>: <fpage>619</fpage>–<lpage>633</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Purvis1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Purvis</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Katzourakis</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Agapow</surname><given-names>PM</given-names></name> (<year>2002</year>) <article-title>Evaluating phylogenetic tree shape: two modifications to fusco &amp; cronk’s method</article-title>. <source>J Theor Biol</source> <volume>214</volume>: <fpage>99</fpage>–<lpage>103</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Schlkopf1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schölkopf</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Smola</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Williamson</surname><given-names>RC</given-names></name>, <name name-style="western"><surname>Bartlett</surname><given-names>PL</given-names></name> (<year>2000</year>) <article-title>New support vector algorithms</article-title>. <source>Neural computation</source> <volume>12</volume>: <fpage>1207</fpage>–<lpage>1245</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Sing1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sing</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Lengauer</surname><given-names>T</given-names></name> (<year>2005</year>) <article-title>Rocr: visualizing classifier performance in r</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>3940</fpage>–<lpage>3941</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Colless1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Colless</surname><given-names>DH</given-names></name> (<year>1982</year>) <article-title>Review of “phylogenetics: the theory and practice of phylogenetic system- atics”</article-title>. <source>Sys Zool</source> <volume>31</volume>: <fpage>100</fpage>–<lpage>104</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Lin1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lin</surname><given-names>LIK</given-names></name> (<year>1989</year>) <article-title>A concordance correlation coefficient to evaluate reproducibility</article-title>. <source>Biometrics</source> <volume>45</volume>: <fpage>255</fpage>–<lpage>268</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Lawrence1"><label>39</label>
<mixed-citation publication-type="other" xlink:type="simple">Lawrence I, Lin K (1989) A concordance correlation coefficient to evaluate reproducibility. Biometrics : 255–268.</mixed-citation>
</ref>
<ref id="pone.0078122-vanderMaaten1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van der Maaten</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Hinton</surname><given-names>G</given-names></name> (<year>2008</year>) <article-title>Visualizing data using t-sne</article-title>. <source>J Mach Learn Res</source> <volume>9</volume>: <fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Williams1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Williams</surname><given-names>CF</given-names></name>, <name name-style="western"><surname>Klinzman</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Yamashita</surname><given-names>TE</given-names></name>, <name name-style="western"><surname>Xiang</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Polgreen</surname><given-names>PM</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Persistent GB virus C infection and survival in HIV-infected men</article-title>. <source>N Engl J Med</source> <volume>350</volume>: <fpage>981</fpage>–<lpage>90</lpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Frost1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frost</surname><given-names>SDW</given-names></name>, <name name-style="western"><surname>Volz</surname><given-names>EM</given-names></name> (<year>2013</year>) <article-title>Modelling tree shape and structure in viral phylodynamics</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source> <volume>368</volume>: <fpage>20120208</fpage>.</mixed-citation>
</ref>
<ref id="pone.0078122-Ratmann1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ratmann</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Donker</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Meijer</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Fraser</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Koelle</surname><given-names>K</given-names></name> (<year>2012</year>) <article-title>Ph1 ylodynamic inference and model assessment with approximate bayesian computation: influenza as a case study</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>e1002835</fpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>