<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-12-01783</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0036706</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Anatomy and physiology</subject>
            <subj-group>
              <subject>Cardiovascular system</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Biophysics</subject>
            <subj-group>
              <subject>Biophysics simulations</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Biophysic al simulations</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
          <subj-group>
            <subject>Computer applications</subject>
            <subj-group>
              <subject>Computer-assisted instruction</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Computing methods</subject>
            <subj-group>
              <subject>Computer animation</subject>
              <subject>Computer graphics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Engineering</subject>
          <subj-group>
            <subject>Bioengineering</subject>
            <subj-group>
              <subject>Biomedical engineering</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Physics</subject>
          <subj-group>
            <subject>Biophysics</subject>
            <subj-group>
              <subject>Biophysics simulations</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Physiology</subject>
          <subject>Computational Biology</subject>
          <subject>Biotechnology</subject>
          <subject>Biophysics</subject>
          <subject>Computer Science</subject>
          <subject>Physics</subject>
        </subj-group>
      </article-categories><title-group><article-title>A Kinematic Approach for Efficient and Robust Simulation of the Cardiac Beating Motion</article-title><alt-title alt-title-type="running-head">Kinematic Cardiac Beating Simulation</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Ijiri</surname>
            <given-names>Takashi</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Ashihara</surname>
            <given-names>Takashi</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Umetani</surname>
            <given-names>Nobuyuki</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Igarashi</surname>
            <given-names>Takeo</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Haraguchi</surname>
            <given-names>Ryo</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Yokota</surname>
            <given-names>Hideo</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Nakazawa</surname>
            <given-names>Kazuo</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Bio-research Infrastructure Construction Team, RIKEN, Wako, Japan</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Cardiovascular and Respiratory Medicine, Heart Rhythm Center, Shiga University of Medical Science, Otsu, Japan</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Department of Computer Science, The University of Tokyo, Tokyo, Japan</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Laboratory of Biomedical Science and Information Management, National Cerebral and Cardiovascular Center Research Institute, Suita, Japan</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Bauer</surname>
            <given-names>Wolfgang Rudolf</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University Hospital of Würzburg, Germany</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">takashi.ijiri@riken.jp</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: T. Ijiri TA HY KN. Performed the experiments: T. Ijiri NU. Analyzed the data: T. Ijiri TA HY T. Igarashi KN. Contributed reagents/materials/analysis tools: RH TA KN T. Igarashi. Wrote the paper: T. Ijiri AT.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>30</day>
        <month>5</month>
        <year>2012</year>
      </pub-date><volume>7</volume><issue>5</issue><elocation-id>e36706</elocation-id><history>
        <date date-type="received">
          <day>13</day>
          <month>1</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>5</day>
          <month>4</month>
          <year>2012</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Ijiri et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Computer simulation techniques for cardiac beating motions potentially have many applications and a broad audience. However, most existing methods require enormous computational costs and often show unstable behavior for extreme parameter sets, which interrupts smooth simulation study and make it difficult to apply them to interactive applications. To address this issue, we present an efficient and robust framework for simulating the cardiac beating motion. The global cardiac motion is generated by the accumulation of local myocardial fiber contractions. We compute such local-to-global deformations using a kinematic approach; we divide a heart mesh model into overlapping local regions, contract them independently according to fiber orientation, and compute a global shape that satisfies contracted shapes of all local regions as much as possible. A comparison between our method and a physics-based method showed that our method can generate motion very close to that of a physics-based simulation. Our kinematic method has high controllability; the simulated ventricle-wall-contraction speed can be easily adjusted to that of a real heart by controlling local contraction timing. We demonstrate that our method achieves a highly realistic beating motion of a whole heart in real time on a consumer-level computer. Our method provides an important step to bridge a gap between cardiac simulations and interactive applications.</p>
      </abstract><funding-group><funding-statement>This work was supported in part by Grant-in-Aid for Young Scientists (B) (22700115; 21790717), Grant-in-Aid for Scientific Research (C) (21500420), Grant-in-Aid for Scientific Research on Innovative Areas (22136011), and JSPS Research Fellowship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="9"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>The heart is a muscular organ, in which the myocardial fibers are helically aligned <xref ref-type="bibr" rid="pone.0036706-Streeter1">[1]</xref>–<xref ref-type="bibr" rid="pone.0036706-Nielsen1">[3]</xref>. When the heart is beating, myocardial fibers receive an electrical signal and contract in the longitudinal direction. The accumulation of these local contractions results in a global pumping motion. Computer simulation of such motions has many potential applications, including off-line tools for identifying cardiac functions and interactive tools for supporting communications between physicians and patients, designing digital contents, or assisting education.</p>
      <p>Many studies have been published on simulating heart motion <xref ref-type="bibr" rid="pone.0036706-Lin1">[4]</xref>–<xref ref-type="bibr" rid="pone.0036706-Amano1">[8]</xref>. Most of the existing cardiac-muscle models are based on Hill-type model <xref ref-type="bibr" rid="pone.0036706-Hill1">[9]</xref>–<xref ref-type="bibr" rid="pone.0036706-Teran1">[11]</xref>. Lin and Yin presented a multiaxial constitutive law for computing actively contracting myocardium <xref ref-type="bibr" rid="pone.0036706-Lin1">[4]</xref>. These mechanical models were integrated with electrophysiological simulations of excitation propagation and blood flow simulation to emulate total heart behavior <xref ref-type="bibr" rid="pone.0036706-Feng1">[5]</xref>–<xref ref-type="bibr" rid="pone.0036706-Amano1">[8]</xref>. However, applying these methods to interactive applications is very difficult, as they usually require specific hardware (e.g., supercomputers) and off-line computational time. The main target of these models is to study cardiac mechanisms; thus, they emphasize physically precise modeling rather than computational efficiency. In contrast, our goal is to provide a simulation framework for interactive applications. Our focus is on computational efficiency and robustness.</p>
      <p>The key idea is to employ a kinematic approach rather than physics-based approach. We compute cardiac beating motion by dividing a heart model into overlapping local regions, contracting the shapes of the local regions, and estimating a global deformation that satisfies all contracted local shapes as much as possible. When estimating the global deformation from local contractions, we apply shape-matching dynamics (SMD) method <xref ref-type="bibr" rid="pone.0036706-Mller1">[12]</xref>, <xref ref-type="bibr" rid="pone.0036706-Rivers1">[13]</xref>. SMD is a geometry-based elastic body representation used in the computer graphics field. It replaces mechanical equilibrium equations of physics-based simulation with geometric constraints and achieves high computational efficiency and unconditional robustness. As we compute organ-level beating deformation from fiber-level contractions, we call our simulation kinematic approach. We have previously presented a similar method for designing motions of soft objects such as mollusks and muscles <xref ref-type="bibr" rid="pone.0036706-Ijiri1">[14]</xref>. In the present study, we extend the previous study to assess whole-heart motion. We introduce fiber direction-dependent weights to emulate anisotropic stiffness of the myocardium <xref ref-type="bibr" rid="pone.0036706-Demer1">[15]</xref>, <xref ref-type="bibr" rid="pone.0036706-Ohayon1">[16]</xref> and provide tools to specify local contraction timing and myocardial fiber directions.</p>
      <p>To evaluate the reproduction performance of our proposed method, we provide detailed comparison between our method and a physics-based method using a simplified situation. This indicated that our method achieves contracted shapes that closely resemble those of the physics-based method. Our kinematic approach has high controllability; since our method generates global motion from the accumulation of local contractions, we can easily adjust macroscopic motions of simulation results to that of observations by modifying local contraction timing. Such controllability is particularly important to reproduce observed motions. We found that the left ventricle ejection fraction (LVEF) of the simulated whole heart was very close to the average LVEF of a real heart. Since our method never requires solving equilibrium equations, it achieves high computational efficiency and robustness. With carefully tuned parameters, our method can generate realistic cardiac beating motions in real-time. To illustrate the feasibility of our real-time framework, we provide three interactive tools.</p>
      <p>We would like to emphasize that our method does not replace existing physics-based approaches but provides an alternative. As our method is a purely kinematic simulation, it is limited to producing motions. In other words, it is difficult to obtain physical values, such as stress distributions or ventricular wall pressures, from simulation results. However, we believe our method is useful for estimating LVEF, predicting kinematic changes in response to altered fiber orientations, or generating interactive animations. Hopefully our method will expand the audience for interactive cardiac simulations.</p>
    </sec>
    <sec id="s2" sec-type="methods">
      <title>Methods</title>
      <sec id="s2a">
        <title>Overview of the simulation framework</title>
        <p><xref ref-type="fig" rid="pone-0036706-g001">Figure 1</xref> shows a two-dimensional (2D) illustration of our simulation outline. We represent a heart with a volumetric tetrahedral mesh model. In the 2D case, we consider a horizontal cross section of the heart, and the target model is represented with a 2D triangular mesh (<xref ref-type="fig" rid="pone-0036706-g001">Figure 1A and 1B</xref>). Before running a simulation, we construct a local region, <italic>N<sub>i</sub></italic>, around each <italic>i</italic>-th vertex, <bold>x</bold><italic><sub>i</sub></italic>, of the model by connecting its immediate (1-ring) neighbors (<xref ref-type="fig" rid="pone-0036706-g001">Figure 1D</xref>). The local region represents a fragment of myocardium, and neighboring local regions overlap. During each simulation step, we first deform all local regions independently, and then deform the global shape to satisfy the contracted local regions as much as possible. In <xref ref-type="fig" rid="pone-0036706-g001">Figure 1E</xref>, local regions are contracted in the circumferential direction (i.e., fiber direction) and expanded in the transmural direction. As a result, the ventricular wall thickens, and the right and left ventricles (RV and LV, respectively) shrink (<xref ref-type="fig" rid="pone-0036706-g001">Figure 1F and 1C</xref>).</p>
        <fig id="pone-0036706-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036706.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>An overview of our kinematic approach.</title>
            <p>(A) Heart model. LA, RA, LV, and RV stand for left/right atrium, and left/right ventricle, respectively. (B) Target mesh model in 2D. Constructed local regions (D) are constructed along the fiber orientation so as to maintain their original volumes (E). (F, C)We deform global shape so as to satisfy the shapes of the constructed local regions as much as possible.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.g001" xlink:type="simple"/>
        </fig>
        <p>A major difference between our method and traditional physics-based methods is that we replace internal force computations with local regional contractions and compute global motion using geometric constraints. This effectively avoids overshooting, an inherent problem in traditional physics-based methods, and achieves unconditional robustness.</p>
      </sec>
      <sec id="s2b">
        <title>Contraction Function</title>
        <p>We denote the contraction condition of the <italic>i</italic>-th local region, <italic>N<sub>i</sub></italic>, at time <italic>t</italic>, with the contraction function <bold>T</bold><italic><sub>i</sub></italic>(<italic>t</italic>). As excited myocardial fibers contract along their longitudinal direction and expand in the transverse direction, we define <bold>T</bold><italic><sub>i</sub></italic>(<italic>t</italic>) as anisotropic scaling. To determine <bold>T</bold><italic><sub>i</sub></italic>(<italic>t</italic>), we consider the three most important elements: local myocardial fiber direction, contraction timing, and contraction rate.</p>
        <sec id="s2b1">
          <title>Myocardial fiber direction is represented with a smooth vector field, in which a single unit vector, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e001" xlink:type="simple"/></inline-formula>, is defined at each local region, <italic>N<sub>i</sub></italic>. Although such a vector field can be captured by using diffusion tensor magnetic resonance imaging (MRI) <xref ref-type="bibr" rid="pone.0036706-Zhukov1">[17]</xref>, it requires specific techniques and devices</title>
          <p>For simulation purpose, mathematical representations are useful to represent a vector field inside a simplified LV model <xref ref-type="bibr" rid="pone.0036706-Nielsen1">[3]</xref>, <xref ref-type="bibr" rid="pone.0036706-Amano1">[8]</xref>. To construct vector fields in complicated whole heart model, Takayama et al. <xref ref-type="bibr" rid="pone.0036706-Takayama1">[18]</xref> presented a sketch based interface. In this paper, we used latter two methods.</p>
        </sec>
        <sec id="s2b2">
          <title>Contraction timing and rate are also important elements to determine contraction conditions of local regions</title>
          <p>Some researchers have computed them using electrophysiological simulations <xref ref-type="bibr" rid="pone.0036706-Feng1">[5]</xref>–<xref ref-type="bibr" rid="pone.0036706-Amano1">[8]</xref>, <xref ref-type="bibr" rid="pone.0036706-Ashihara1">[19]</xref>, <xref ref-type="bibr" rid="pone.0036706-Matsuoka1">[20]</xref>; however, these simulations usually require a lot of computational time. Our purpose is to achieve an interactive framework, and then we specify the contraction timing and rate by a <italic>time-contraction curve</italic>, which plots contraction ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e002" xlink:type="simple"/></inline-formula> at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e003" xlink:type="simple"/></inline-formula>, where <italic>T</italic> is a time cycle (Section 3 and <xref ref-type="supplementary-material" rid="pone.0036706.s001">Video S1</xref>). Given the contraction rate <italic>c</italic>(<italic>t</italic>), we compute the scaling ratio along the fiber direction as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.e004" xlink:type="simple"/><label>(1)</label></disp-formula>where <italic>A<sup>mc</sup></italic><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e005" xlink:type="simple"/></inline-formula>[0,1) is a <italic>maximum contraction (MC) rate</italic>. For example, when <italic>A<sup>mc</sup></italic>  = 0.2, the local regions are contracted by 20% (scaled to 0.8 times) along the fiber direction when <italic>c</italic>(<italic>t</italic>) = 1.0. Note that the time-contraction curve lacks the ability to represent excitation propagation phenomena. To emulate this in an easy-to-control way, we used a phase-shift field presented in <xref ref-type="bibr" rid="pone.0036706-Ijiri1">[14]</xref>.</p>
        </sec>
        <sec id="s2b3">
          <title>Contraction function</title>
          <p>Given the fiber direction vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e006" xlink:type="simple"/></inline-formula> and the scaling rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e007" xlink:type="simple"/></inline-formula> for each local region, <italic>N<sub>i</sub></italic>, at time <italic>t</italic>, the contraction function <bold>T</bold><italic><sub>i</sub></italic>(<italic>t</italic>)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e008" xlink:type="simple"/></inline-formula>R<sup>3×3</sup> is defined as an anisotropic scaling matrix,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.e009" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e010" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e011" xlink:type="simple"/></inline-formula> are arbitrary unit vectors orthogonal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e012" xlink:type="simple"/></inline-formula>, orthogonal to each other, and satisfy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e013" xlink:type="simple"/></inline-formula>. Thus, {<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e014" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e015" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e016" xlink:type="simple"/></inline-formula>} constructs a normalized orthogonal basis at <italic>N<sub>i</sub></italic>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e017" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e018" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e019" xlink:type="simple"/></inline-formula> represent the scaling rate along <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e020" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e021" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e022" xlink:type="simple"/></inline-formula>, respectively. We define<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e023" xlink:type="simple"/></inline-formula> so that a scaled local region maintains its original volume.</p>
          <p>Notice that, our simulation framework is not limited to manually designed fiber orientations and time-contraction curves; it would be easy to import fiber orientation data obtained from a real heart <xref ref-type="bibr" rid="pone.0036706-Zhukov1">[17]</xref> and contraction timing obtained from excitation propagation simulations <xref ref-type="bibr" rid="pone.0036706-Ashihara1">[19]</xref>, <xref ref-type="bibr" rid="pone.0036706-Matsuoka1">[20]</xref>.</p>
        </sec>
      </sec>
      <sec id="s2c">
        <title>Kinematic Approach</title>
        <p>As previously mentioned, we construct overlapping local regions, <italic>N<sub>i</sub></italic>, at each vertex, <bold>x</bold><italic><sub>i</sub></italic>, by connecting neighboring vertices. The contraction condition at <italic>N<sub>i</sub></italic> at time <italic>t</italic> is defined by <bold>T</bold><italic><sub>i</sub></italic>(<italic>t</italic>)<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e024" xlink:type="simple"/></inline-formula>R<sup>3×3</sup>. For each simulation frame, we compute global motion in two steps: computing goal position <bold>g</bold><italic><sub>i</sub></italic> and updating position <bold>x</bold><italic><sub>i</sub></italic> and velocity <bold>v</bold><italic><sub>i</sub></italic> of the <italic>i</italic>-th vertex.</p>
        <sec id="s2c1">
          <title>Goal position computation</title>
          <p>The goal position <bold>g</bold><italic><sub>i</sub></italic> is the desired position of the <italic>i</italic>-th vertex in the next simulation frame. This is obtained by computing the best-fitting rigid transformations from the rest shapes to the deformed shapes of all local regions and blending the results. <xref ref-type="fig" rid="pone-0036706-g002">Figure 2</xref> provides a 2D illustration of the goal position computation. Let us focus on the <italic>r</italic>-th local region <italic>N<sub>r</sub></italic>. The relative locations of <italic>N<sub>r</sub></italic> rest shape vertices with respect to its mass center, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e025" xlink:type="simple"/></inline-formula>, are defined as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.e026" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e027" xlink:type="simple"/></inline-formula> is the <italic>i</italic>-th vertex position of the undeformed original shape, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e028" xlink:type="simple"/></inline-formula> represents orientation-dependent weights (we explain this later). Note that we scale the original relative positions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e029" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e030" xlink:type="simple"/></inline-formula>. Similarly, the relative locations of the current shape vertices with respect to its mass center, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e031" xlink:type="simple"/></inline-formula>, are defined as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.e032" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e033" xlink:type="simple"/></inline-formula> is the <italic>i</italic>-th vertex position of the deformed current shape. We then compute the rotation matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e034" xlink:type="simple"/></inline-formula> which fits the rest shape to the current deformed shape of <italic>N<sub>r</sub></italic> by solving,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.e035" xlink:type="simple"/><label>(5)</label></disp-formula></p>
          <fig id="pone-0036706-g002" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0036706.g002</object-id>
            <label>Figure 2</label>
            <caption>
              <title>2D illustration of goal-position computation.</title>
              <p>Focus on the <italic>r</italic>-th region, <italic>N<sub>r</sub></italic>. We have its undeformed original shape (A) and current deformed shape (C). The rest shape of <italic>N<sub>r</sub></italic> is obtained by scaling the original shape (B). We translate the rest shape to fit its mass center to that of the current shape (D) and then rotate the rest shape to fit the current shape as much as possible (E). We compute the shape matching for all local regions (F) and blend the results to obtain the goal positions (G). In (F), we visualize the fitting results of only four regions.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.g002" xlink:type="simple"/>
          </fig>
          <p>Please see <xref ref-type="bibr" rid="pone.0036706-Mller1">[12]</xref>, <xref ref-type="bibr" rid="pone.0036706-Ijiri1">[14]</xref> for a detailed method to solve this minimization problem. Given the fitting rotation matrix <bold>R</bold><italic><sub>r</sub></italic>, we can estimate the goal positions of vertices in <italic>N<sub>r</sub></italic> as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.e036" xlink:type="simple"/><label>(6)</label></disp-formula></p>
          <p>The process that computes the best-fitting rigid transformation from a rest shape to a current shape in each local region is called <italic>shape matching</italic>. Now, we compute shape matching for all local regions. As one vertex belongs to multiple local regions, multiple goal positions are derived for each vertex. Finally, we blend them to obtain the goal positions:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.e037" xlink:type="simple"/><label>(7)</label></disp-formula></p>
        </sec>
        <sec id="s2c2">
          <title>Update vertex positions and velocities</title>
          <p>Given goal position <bold>g</bold><italic><sub>i</sub></italic>, we update positions <bold>x</bold><italic><sub>i</sub></italic> and velocities <bold>v</bold><italic><sub>i</sub></italic> of the current simulation frame to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.e038" xlink:type="simple"/><label>(8)</label></disp-formula>where <italic>h</italic> is a time step, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e039" xlink:type="simple"/></inline-formula> is an external force on the <italic>i</italic>-th vertex, and <italic>m<sub>i</sub></italic> is the mass of the <italic>i</italic>-th vertex.</p>
        </sec>
        <sec id="s2c3">
          <title>Stiffness control</title>
          <p>Stiffness control is an important topic. Rivers and James <xref ref-type="bibr" rid="pone.0036706-Rivers1">[13]</xref> modified stiffness by changing the size of local regions, whereas Ijiri et al. <xref ref-type="bibr" rid="pone.0036706-Ijiri1">[14]</xref> controlled stiffness by repeating the goal position computation. In our setup, the local region size cannot be changed. Because each region represents a fragment of myocardium and is linearly contracted, a large local region causes large errors. We therefore use the repetitive method <xref ref-type="bibr" rid="pone.0036706-Ijiri1">[14]</xref>. We first apply shape matching to the current shape <bold>x</bold><italic><sub>i</sub></italic> to obtain the initial goal position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e040" xlink:type="simple"/></inline-formula>. We then use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e041" xlink:type="simple"/></inline-formula> as the target shape and apply shape matching to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e042" xlink:type="simple"/></inline-formula> to obtain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e043" xlink:type="simple"/></inline-formula>. We iteratively compute <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e044" xlink:type="simple"/></inline-formula> and use it as the goal position. A force applied on a vertex affects vertices farther away for a larger value of <italic>M</italic>, resulting in stiffer deformations. We specify <italic>M</italic> = 10 for all examples in this study excepting <xref ref-type="fig" rid="pone-0036706-g003">Figure 3</xref>.</p>
          <fig id="pone-0036706-g003" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0036706.g003</object-id>
            <label>Figure 3</label>
            <caption>
              <title>The effect of fiber-direction-dependent weights.</title>
              <p>We specified horizontal (B), vertical (C), and 45°-slanted (D) fiber orientation in a thick -sheet model (100 mm×100 mm×20 mm) (A). We then fixed the top regions and observed the resting shapes in a gravity field without activation. The resting shapes (B–D) show that the model is stiffer in the fiber direction than in the perpendicular direction. We specified gravity acceleration as 9.8 m/s<sup>2</sup>, time step <italic>h</italic> = 0.005 s, and stiffness iteration <italic>M</italic> = 3. Note that we used small stiffness value so as to observe large deformations.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.g003" xlink:type="simple"/>
          </fig>
        </sec>
        <sec id="s2c4">
          <title>Fiber direction dependent weights</title>
          <p>Weighting coefficients, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e045" xlink:type="simple"/></inline-formula>, for computing the mass centers of local regions and blending shape-matching results are important in the SMD framework. Previous studies <xref ref-type="bibr" rid="pone.0036706-Rivers1">[13]</xref>, <xref ref-type="bibr" rid="pone.0036706-Ijiri1">[14]</xref> specified these coefficients as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e046" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e047" xlink:type="simple"/></inline-formula> is the number of vertices in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e048" xlink:type="simple"/></inline-formula>. This results in isotropic elasticity. However, cardiac muscle exhibits anisotropic elastic behavior; the muscle is stiffer in the fiber direction than in the plane perpendicular to the fiber direction <xref ref-type="bibr" rid="pone.0036706-Teran1">[11]</xref>, <xref ref-type="bibr" rid="pone.0036706-Demer1">[15]</xref>, <xref ref-type="bibr" rid="pone.0036706-Ohayon1">[16]</xref>. To achieve this anisotropic stiffness, we define the weights depending on the local fiber direction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e049" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e050" xlink:type="simple"/></inline-formula> is a unit fiber direction vector at <italic>N<sub>r</sub></italic> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e051" xlink:type="simple"/></inline-formula> is the location of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0036706.e052" xlink:type="simple"/></inline-formula> relative to the mass center of <italic>N<sub>r</sub></italic>. That is, we place stronger weights for vertices of which the relative position is along the fiber direction. This simple modification efficiently achieves anisotropic stiffness (<xref ref-type="fig" rid="pone-0036706-g003">Figure 3</xref>).</p>
        </sec>
        <sec id="s2c5">
          <title>Volume preservation</title>
          <p>Although we contract local regions so that they maintain their original volumes and use them as the rest states, the total volume of the computed goal position is seldom maintained. This is because the complicated fiber orientation causes locally inconsistent contractions, and the goal position is obtained as a result of local compromise. To guarantee preservation of the total volume, we modify the goal position, similar to the volume-preserving SMD presented by Takamatsu and Kanai <xref ref-type="bibr" rid="pone.0036706-Takamatsu1">[21]</xref>. This method first generates a global displacement vector field from the boundary surface normal and then computes a sufficient displacement.</p>
        </sec>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <sec id="s3a">
        <title>Comparison with a physics-based model</title>
        <p>To evaluate the reproduction performance of our method, we compared deformation simulation results generated with our kinematic and physics-based approaches. As a target for comparison, we used a 3D body extension <xref ref-type="bibr" rid="pone.0036706-Teran1">[11]</xref> of the Zajac muscle model <xref ref-type="bibr" rid="pone.0036706-Hill1">[9]</xref>, <xref ref-type="bibr" rid="pone.0036706-Zajac1">[10]</xref>. Note that, although this is a skeletal muscle model, this primitive muscle model is very widely used and recently presented myocardial model <xref ref-type="bibr" rid="pone.0036706-Lin1">[4]</xref> shares similar characteristics, e.g., incompressible elasticity, non-linear stress-strain relationship, and sarcomere length dependency, with the Zajac model <xref ref-type="bibr" rid="pone.0036706-Hill1">[9]</xref>, <xref ref-type="bibr" rid="pone.0036706-Zajac1">[10]</xref>. We adopted this simple but essential model to evaluate how much our kinematic approach can reproduce fundamental traits of cardiac motion. We used the following material parameters, Young's modulus, 0.02 MPa; relative density, 1.1; and maximum stress, 0.4 MPa, inferred from previous studies <xref ref-type="bibr" rid="pone.0036706-Zajac1">[10]</xref>, <xref ref-type="bibr" rid="pone.0036706-Herman1">[22]</xref>. As a simplified LV model, we prepared a thick-walled-cylinder with a 10 mm thickness, a 45 mm inner diameter, and 50 mm an axial length (<xref ref-type="fig" rid="pone-0036706-g004">Figure 4</xref>). Myocardial fiber orientation inside the model is usually denoted using two angles, <italic>α<sub>trans</sub></italic> and <italic>α<sub>helix</sub></italic>, which define the angle between the circumference direction and the fiber orientation on a plane perpendicular to the LV longitudinal axis and the inclination of the fiber orientation from the plane perpendicular to the LV longitudinal axis, respectively. Using this notation, we specified the fiber orientation as <italic>α<sub>trans</sub></italic> = 0°, and <italic>α<sub>helix</sub></italic> as linearly varying from +60° to −60° along the transmural direction <xref ref-type="bibr" rid="pone.0036706-Streeter1">[1]</xref>, <xref ref-type="bibr" rid="pone.0036706-Nielsen1">[3]</xref>, <xref ref-type="bibr" rid="pone.0036706-Amano1">[8]</xref> (<xref ref-type="fig" rid="pone-0036706-g004">Figure 4B and 4C</xref>). We also specified a simple time-activation curve for the physics-based method and the same shaped time-contraction curve for our method as in <xref ref-type="fig" rid="pone-0036706-g005">Figure 5A</xref>.</p>
        <fig id="pone-0036706-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036706.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>A simplified LV model.</title>
            <p>(A) A simplified LV model. (B) Two angles, <italic>α<sub>trans</sub></italic> and <italic>α<sub>helix</sub></italic>, denote the myocardial fiber orientation in the model. (C) The specified <italic>α<sub>helix</sub></italic> varies linearly along the transmural direction.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.g004" xlink:type="simple"/>
        </fig>
        <fig id="pone-0036706-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036706.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Simulation results of the simplified LV model.</title>
            <p>Simulation results computed using the physics-based method <xref ref-type="bibr" rid="pone.0036706-Zajac1">[10]</xref>, <xref ref-type="bibr" rid="pone.0036706-Teran1">[11]</xref> and our method. In the top row (A–E), we compare the two methods with the same time-activation/contraction curve (A). In the bottom row (F–J), we modify the time-contraction curve for our method (F) and compare the two methods. In (A) and (F), solid lines indicate time-activation curves for the physical method and dashed lines are time-contraction curves for our method. While (B–E) show temporal variations in the four shape measurements computed with (A), (G–J) show those computed with (F). In (B–E) and (G–J), the solid line indicates the results of the physics-based method, and the dashed red lines denote the results of our method with different MC rates.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.g005" xlink:type="simple"/>
        </fig>
        <p>Both methods generate axially symmetric deformations and we measured the following four values: wall thickness, <italic>W</italic>; vertical length, <italic>L</italic>; spatial volume, <italic>V</italic>; and slant angle of the external surface, <italic>S<sup>ext</sup></italic> (<xref ref-type="fig" rid="pone-0036706-g004">Figure 4A</xref>). The spatial volume represents the volume of an internal cylinder, which corresponds to the volume of the LV chamber. The slant angle is that between the cylinder axis and the vertical edges that exist on an external cylinder vertically oriented in the undeformed state. This exhibits the magnitude of twisting deformation. <xref ref-type="fig" rid="pone-0036706-g005">Figure 5B, C, D, E</xref> shows the temporal variations of the four values. The solid line corresponds to the physical model, whereas the dashed red lines correspond to the deformations computed using our method with different MC rates (i.e., <italic>A<sup>mc</sup></italic> = 0.1, 0.3, 0.5, and 0.7).</p>
        <p>During full activation (i.e., time 0.5–0.75), our method with <italic>A<sup>mc</sup> = 0.5</italic> achieved values very close to those of the physics method for <italic>W</italic>, <italic>V</italic>, and <italic>S<sup>ext</sup></italic> (<xref ref-type="fig" rid="pone-0036706-g005">Figure 5B, 5D, and 5E</xref>). The decrease ratio of <italic>L</italic> was less than 15% in the both methods (<xref ref-type="fig" rid="pone-0036706-g005">Figure 5C</xref>). We found a difference between the two methods in the temporal variation of the four measurements during the activation rate varying (i.e., time 0.25–0.5 and 0.75–1.0). Our method generated approximately linear variations in <italic>W</italic> and <italic>L</italic>, whereas the physics-based method resulted in nonlinear variations (<xref ref-type="fig" rid="pone-0036706-g005">Figure 5B and 5C</xref>). This nonlinearity of the physical model is caused by two major reasons; the active muscular force depends on the both activation rate and muscle elongation rate <xref ref-type="bibr" rid="pone.0036706-Zajac1">[10]</xref>, and Mooney-Rivlin hyperelastic material used in <xref ref-type="bibr" rid="pone.0036706-Teran1">[11]</xref> has a nonlinear strain-stress relationship. Whereas, our kinematic method simply translates local contractions into global deformation; the global deformations are obtained from the accumulations of local scaling and local rotation. When the influence of local scaling is dominant (i.e., influence of local rotation is small enough), temporal variations of global measurements are almost proportional to the specified time-contraction curve.</p>
      </sec>
      <sec id="s3b">
        <title>Contraction speed fitting</title>
        <p>The gradient of temporal variation of the global shape measurements represents contraction speed that is important clinically. For heart simulators, the ability to reproduce an observed contraction speed is very important. Using our method, the temporal changes in the simulated motion can easily be controlled by modifying the time-contraction curve based on physiological or clinical data.</p>
        <p>As mentioned above, it can be estimated that a temporal variation of a global measurement is almost proportional to the specified time-contraction curve, when the effect of local scaling is dominant. Based on this estimation, we designed a new time-contraction curve by taking the time-<italic>W</italic> curve obtained by the physics-based simulation (the solid curve in <xref ref-type="fig" rid="pone-0036706-g005">Figure 5B</xref>) and normalizing its domain and range into [0,1] as in <xref ref-type="fig" rid="pone-0036706-g005">Figure 5F</xref>. We then simulated deformations with it. As a result, our method achieved temporal variations (chart shapes) very close to those of the physics simulation in <italic>W</italic>, <italic>L</italic>, and <italic>V</italic> (<xref ref-type="fig" rid="pone-0036706-g005">Figure 5G, 5H, and 5J</xref>). However, we found small difference in slant angle, <italic>S<sup>ext</sup></italic> (<xref ref-type="fig" rid="pone-0036706-g005">Figure 5I</xref>). Since <italic>S<sup>ext</sup></italic> is affected by the both local contraction and rotation, it is difficult to perfectly adjust it with our current method. Notice that the difference in <italic>S<sup>ext</sup></italic> is small enough for our main purposes, i.e., estimating LVEFs and generating real-time animations.</p>
      </sec>
      <sec id="s3c">
        <title>Influence of fiber orientation</title>
        <p>To examine the influence of myocardial fiber orientation on global deformation, four different fiber orientations were specified in the simplified LV model. Then the deformation was computed using our method and the physics-based method. Because the MC rate that provides the deformation closest to that of the physics-based method depends on fiber orientation, we tested all <italic>A<sup>mc</sup></italic> values within the interval of 0.05 for each of the four cases and selected the one that output the deformed shape closest to the physics-based simulation. We used spatial volume value as a metric for closeness.</p>
        <p><xref ref-type="fig" rid="pone-0036706-g006">Figure 6</xref> and <xref ref-type="supplementary-material" rid="pone.0036706.s002">Video S2</xref> summarize the specified fiber orientations, selected MC rates, and contracted shapes with their three measurements. In all four cases, our method achieved results very close to the physics-based method. In the cases of <italic>α<sub>helix</sub></italic> = 90° and −60° (<xref ref-type="fig" rid="pone-0036706-g006">Figure 6C and 6D</xref>), the decrease in spatial volume was very small or almost zero, meaning that the two models do not have pump ability. In the case of <italic>α<sub>helix</sub></italic> = 0° (<xref ref-type="fig" rid="pone-0036706-g006">Figure 6B</xref>), the model was elongated in the vertical direction, which is never observed in an actual heart. Varying <italic>α<sub>helix</sub></italic> from +60° to −60° along the transmural direction resulted in the highest decrease ratio of spatial volume, indicating that this model has potential as an efficient pump (<xref ref-type="fig" rid="pone-0036706-g006">Figure 6A</xref>).</p>
        <fig id="pone-0036706-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036706.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>A comparison between our approach and the physics-based method using four different fiber orientations.</title>
            <p>Each panel provides the specified fiber orientation and <italic>A<sup>mc</sup></italic> value on the top, a contracted shape with the physics-based method on the bottom left (blue), and a contracted shape with our method on the bottom right (red).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.g006" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s3d">
        <title>Whole heart model construction</title>
        <p>Next, we applied our method to a whole-heart model. We constructed a tetrahedral mesh model of a whole heart from electrocardiogram-gated MRI images. We extracted the heart region from human chest images at end-diastole and generated a tetrahedral mesh from the boundary surface of the extracted region using TetGen <xref ref-type="bibr" rid="pone.0036706-H1">[23]</xref>. <italic>Model A</italic> in <xref ref-type="fig" rid="pone-0036706-g007">Figure 7A</xref> is the obtained model. Its approximate sizes were 160 mm in the longitudinal direction and 120 mm in the lateral direction, and the wall thicknesses were approximately 11 mm (LV), 13 mm (mid-wall), and 5 mm (RV). To accurately capture the transmural variation in myocardial fiber orientation, an edge-based subdivision <xref ref-type="bibr" rid="pone.0036706-Ruprecht1">[24]</xref> was applied to the obtained model; we subdivided all edges of <italic>model A</italic> longer than 10 mm to obtain <italic>model B</italic> and 5 mm to obtain <italic>model C</italic>. Note that the LV walls of <italic>models A</italic>, <italic>B</italic>, and <italic>C</italic> had approximately two, three, and four vertices (layers), respectively, in the transmural direction (<xref ref-type="fig" rid="pone-0036706-g007">Figure 7A</xref>).</p>
        <fig id="pone-0036706-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036706.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>A whole heart model.</title>
            <p>(A) Three heart tetrahedral-mesh models with different subdivision levels. (B–D) Fiber orientation field construction process with the painting interface <xref ref-type="bibr" rid="pone.0036706-Takayama1">[18]</xref>. In (B), constraint points for the three regions (i.e., epicardium, RV/RA endocardium, and LV/LA endocardium) are highlighted in blue, green, and red and have depth values of 0.0, 0.5, and 1.0, respectively. In (D), light blue curves indicated the specified orientation strokes. (E) Smooth myocardial fiber orientation fields of the atrium (left) and ventricle (right) constructed. (F) Segmented local regions; atrium and ventricle regions are highlighted in blue and green.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.g007" xlink:type="simple"/>
        </fig>
        <p>We manually designed a myocardial fiber orientation in the models using a two step sketching interface <xref ref-type="bibr" rid="pone.0036706-Takayama1">[18]</xref>. We first created a layer structure inside the model by placing constraint points with depth values. After placement, the depth values of all points are smoothly interpolated inside the model, and a smooth depth field is obtained (<xref ref-type="fig" rid="pone-0036706-g007">Figure 7B and C</xref>). We then draw multiple orientation strokes on each layer. The strokes represent local fiber orientation at their locations. We referred to anatomical studies on myocardial fiber orientation in ventricles <xref ref-type="bibr" rid="pone.0036706-Streeter1">[1]</xref>–<xref ref-type="bibr" rid="pone.0036706-Nielsen1">[3]</xref>, <xref ref-type="bibr" rid="pone.0036706-Zhukov1">[17]</xref> and in atria <xref ref-type="bibr" rid="pone.0036706-Ho1">[25]</xref> to specify the orientation strokes. The stroke orientations are interpolated inside the model resulting in smooth fiber orientation field (<xref ref-type="fig" rid="pone-0036706-g007">Figure 7D and E</xref>). We also segmented the local regions into atrial, ventricular, or excluded regions (<xref ref-type="fig" rid="pone-0036706-g007">Figure 7F</xref>).</p>
        <p>We designed the time-contraction curve as in <xref ref-type="fig" rid="pone-0036706-g008">Figure 8C</xref>. The green chart indicates the contraction rate of local regions in the ventricle, and the blue is for those in the atrium. The time-contraction curve of the ventricle (green chart) was designed according to a real heart. A temporal variation in LV wall thickness of a real heart was observed by Traill et al. <xref ref-type="bibr" rid="pone.0036706-Traill1">[26]</xref> (<xref ref-type="fig" rid="pone-0036706-g008">Figure 8A</xref>). We normalized this time-wall thickness curve and used it as the time-contraction curve. During <italic>t0–t1</italic>, the atrial regions contract, during <italic>t1–t3</italic> (systole), the ventricle regions contract and the atrial regions are relaxed returning to their original shapes, and during <italic>t3–t0</italic> (diastole), the ventricular regions are relaxed.</p>
        <fig id="pone-0036706-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036706.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Beating motion of the whole heart model.</title>
            <p>(A) The temporal variation of wall thickness of an actual healthy heart observed by Traill et al. <xref ref-type="bibr" rid="pone.0036706-Traill1">[26]</xref>. The four dashed red lines in (B) indicate the temporal variations of wall thickness of our simulation results with different MC rates (<italic>A<sup>mc</sup></italic> = 0.4, 0.5, 0.6., and 0.7). (C) Specified time-contraction curve; the blue chart is for atrial regions and the green chart is for ventricular regions. (D, E) Representative frames of the whole-heart simulation with different visualization. (F–H) Three interaction tools. (F, G) Cross sections and myocardial layers of the heart at time <italic>t0</italic> and <italic>t3</italic>. (H) Direct dragging tool. White arrows indicate the grabbed point and black arrows are dragged direction.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.g008" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s3e">
        <title>Beating simulation of a whole heart</title>
        <p>We computed the beating motions of <italic>model B</italic> with time cycle <italic>T</italic> = 1.1 s, time step <italic>h</italic> = 0.01 s, and different MC rates (i.e., <italic>A<sup>mc</sup></italic> = 0.4, 0.5, 0.6, and 0.7). The dashed red lines in <xref ref-type="fig" rid="pone-0036706-g008">Figure 8B</xref> show the temporal changes of LV posterior wall thickness of the simulated beating motion. This demonstrates that our method achieves temporal changes of wall thickness that are very close to those observed in an actual heart <xref ref-type="bibr" rid="pone.0036706-Traill1">[26]</xref>. The two rows in <xref ref-type="fig" rid="pone-0036706-g008">Figure 8D and 8E</xref> indicate representative frames of the simulated beating motion with <italic>A<sup>mc</sup></italic> = 0.5. The top row highlights activated local regions in yellow, and the second row transparently visualizes the deformation of each chamber. <xref ref-type="supplementary-material" rid="pone.0036706.s003">Video S3</xref> shows the simulation results in an animation.</p>
        <p>To illustrate the feasibility of our real-time framework, we implemented three interaction tools: a cutting tool, a peeling tool, and a direct deformation tool (<xref ref-type="fig" rid="pone-0036706-g008">Figure 8F, G</xref> and <xref ref-type="supplementary-material" rid="pone.0036706.s004">Video S4</xref>). The cutting tool allows the user to temporally cut the model to observe a cross section by drawing a stroke. The peeling tool allows peeling the model and observing the motions of muscular layers. The direct dragging tool allows grabbing and dragging a vertex of the heart model. During dragging, the system adds an external force oriented to the dragged direction onto the grabbed vertex. Because our algorithm guarantees unconditional robustness, the simulation never diverges even if extremely large forces are applied.</p>
        <p>We next observed LVEF, which is a common parameter for evaluating cardiac function, to evaluate further the resulting motion quantitatively. We simulated the beating motions of <italic>models A</italic>, <italic>B</italic>, and <italic>C</italic> using the same setup as shown in <xref ref-type="fig" rid="pone-0036706-g008">Figure 8</xref>. The two charts in <xref ref-type="fig" rid="pone-0036706-g009">Figure 9</xref> indicate the LVEF of the three models with respect to different MC rates. While we used the anisotropic stiffness model to obtain the left chart, the right was computed using the traditional isotropic stiffness model <xref ref-type="bibr" rid="pone.0036706-Rivers1">[13]</xref>, <xref ref-type="bibr" rid="pone.0036706-Ijiri1">[14]</xref>.</p>
        <fig id="pone-0036706-g009" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036706.g009</object-id>
          <label>Figure 9</label>
          <caption>
            <title>LVEFs of the simulated beating motion with respect to different MC rates.</title>
            <p>The left chart was computed with the presented fiber-direction-dependent anisotropic stiffness model, and the right chart was computed with the isotropic stiffness model. The bottom panels show the whole-hearts at end-diastole (time <italic>t0</italic>) and end-systole (time <italic>t3</italic>).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.g009" xlink:type="simple"/>
        </fig>
        <p>Our orientation-dependent stiffness model generated a higher LVEF than the isotropic stiffness model. This can be explained as follows. All ventricular regions contract along the fiber direction and expand in the orthogonal direction. Our anisotropic model places higher weights on the contraction along the fiber direction and lower weights on the orthogonal expansion, whereas the isotropic model deals with the contraction and expansion fairly. As a result, the anisotropic model causes a strange vertical elongation (<xref ref-type="fig" rid="pone-0036706-g009">Figure 9</xref>, bottom right). Also, no significant difference in LVEF with respect to model resolution was observed in the anisotropic stiffness model.</p>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <sec id="s4a">
        <title>Evaluations of simulated motion</title>
        <p>We compared the motion simulated by our approach and the physics-based method (<xref ref-type="fig" rid="pone-0036706-g005">Figures 5</xref> and <xref ref-type="fig" rid="pone-0036706-g006">6</xref>) and demonstrated that our kinematic method achieved contracted shapes that were very close to those of the physics-based method.</p>
        <p>We applied our method to whole-heart models. <xref ref-type="fig" rid="pone-0036706-g008">Figure 8</xref> shows that our method achieved beating motion with a physical appearance comparably close to real heart motion. The local contraction ratio of actual healthy hearts is approximately 15% and the LVEF is 60–80% <xref ref-type="bibr" rid="pone.0036706-Buckberg1">[27]</xref>. Meanwhile, in our framework, the MC rate, <italic>A<sup>mc</sup></italic>, represents an ideal local contraction rate and an actual local contraction rate is usually smaller. This is because the complicated fiber orientation causes inconsistent local contraction, and the global shape is obtained with local compromises. Taking this into account, the LVEF of our simulated beating motion of anisotropic stiffness model in <xref ref-type="fig" rid="pone-0036706-g009">Figure 9</xref> (∼75%) was within the normal range of the LVEF of actual heart (60–80%). This suggests that our kinematic approach can recreate physiologically consistent heart contraction.</p>
        <p>Since our kinematic approach directly compute global deformation from the accumulations of regional fiber-level contractions, it allows temporal variation of global shape measurements to be easily controlled by modifying the time-contraction curve so that its shape is proportional to the desired temporal variation curve (<xref ref-type="fig" rid="pone-0036706-g005">Figures 5</xref> and <xref ref-type="fig" rid="pone-0036706-g008">8</xref>). This controllability is particularly useful for reproducing observed motions. A cardiac simulation method with such a high controllability has never been achieved before.</p>
      </sec>
      <sec id="s4b">
        <title>Performance</title>
        <p><xref ref-type="table" rid="pone-0036706-t001">Table 1</xref> shows the number of vertices of the three heart models and the total time taken to compute a single simulation frame. The number of vertices is equivalent to the number of local regions. Timing was generated on an Intel Core i7 3.33-GHz machine. Our system achieved an interactive frame rate even for the finest model. <xref ref-type="table" rid="pone-0036706-t001">Table 1</xref> also provides simulation times for the simple LV model (<xref ref-type="fig" rid="pone-0036706-g004">Figure 4</xref>) computed using our method and the physics-based method <xref ref-type="bibr" rid="pone.0036706-Zajac1">[10]</xref>, <xref ref-type="bibr" rid="pone.0036706-Teran1">[11]</xref>. Since it is possible to accelerate the physics-based method retaining similar results by reducing the degrees of freedom, we provide its computational time with a coarser discretized LV model (bottom of <xref ref-type="table" rid="pone-0036706-t001">Table 1</xref>). The coarser model was created by halving the number of elements in the axial and circumferential directions. These results indicate that our method outperforms the physics-based method in computational time. Notice that this timing is limited to our specific implementation and do not fairly compare the kinematic and physics-based methods. However, we believe that our kinematic method is more efficient since it does not solve equilibrium equations and is more suitable for real-time applications. Also, further acceleration of our method would be possible using GP-GPU techniques <xref ref-type="bibr" rid="pone.0036706-Rungjiratananon1">[28]</xref>, <xref ref-type="bibr" rid="pone.0036706-Liao1">[29]</xref>.</p>
        <table-wrap id="pone-0036706-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0036706.t001</object-id><label>Table 1</label><caption>
            <title>Simulation Performance.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0036706-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">No. of vertices</td>
                <td align="left" colspan="1" rowspan="1">Time/frame (ms)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Model A</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">2479</td>
                <td align="left" colspan="1" rowspan="1">7.3</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Model B</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">7116</td>
                <td align="left" colspan="1" rowspan="1">24.2</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Model C</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">28685</td>
                <td align="left" colspan="1" rowspan="1">110.7</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"><italic>Simple LV</italic>(<xref ref-type="fig" rid="pone-0036706-g004"><italic>Fig. 4</italic></xref>) (<italic>our method</italic>)</td>
                <td align="left" colspan="1" rowspan="1">1200</td>
                <td align="left" colspan="1" rowspan="1">4.1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"><italic>Simple LV</italic>(<xref ref-type="fig" rid="pone-0036706-g004"><italic>Fig. 4</italic></xref>) (<italic>physics-based method</italic>)</td>
                <td align="left" colspan="1" rowspan="1">1200</td>
                <td align="left" colspan="1" rowspan="1">554.2</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"><italic>Coarser discretized Simple LV</italic> (<xref ref-type="fig" rid="pone-0036706-g004"><italic>Fig. 4</italic></xref>) (<italic>physics-based method</italic>)</td>
                <td align="left" colspan="1" rowspan="1">300</td>
                <td align="left" colspan="1" rowspan="1">118.3</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>Time/frame indicates an average time to compute a single simulation frame.</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s4c">
        <title>Potential applications</title>
        <p>The biggest advantage of our method is its computational efficiency and robustness. Because our simulator can run on a consumer-level PC, it is accessible to many people with little knowledge of computer-science and would be a good tool for understanding the heart. If it were integrated into electronic medical-chart systems, the real-time beating animation generated by our system would help patients to understand their disease conditions and expected recoveries. Similarly, education, digital content creation, and surgery simulators are good potential applications of our system.</p>
        <p>Although our method is not based on a physical model, little difference was found between the physics-based method and our approach using a simplified LV model with the same fiber orientation. We believe that our method can provide a useful tool for studying the influence of specific fiber orientation on the LVEF. If the mechanical changes of a patient with myocardial infarction were integrated into our method, the LVEF of the infarcted heart could be estimated immediately, and the abnormal LV wall motion could be observed in real time on a consumer-level PC.</p>
      </sec>
      <sec id="s4d">
        <title>Limitations and Future work</title>
        <p>Since our method induces global motion not by inner forces but by local contractions, at present it is unable to observe some physical values, such as stress distributions or ventricular wall pressures. It is also difficult to estimate the relationship between macroscopic deformation speed and internal muscular forces. The quantitative relationship between the SMD and various physics-based methods has not yet reported, and its detailed analysis remains as our future work. Another future work includes integrating electrophysiological simulations or fluid simulations into our method and comparing our simulation results with the motions of actual hearts captured by four-dimensional imaging devices. We also intend to tackle an inverse elastic body kinematics problem, in which local contraction conditions will be estimated from observed global deformation.</p>
      </sec>
      <sec id="s4e">
        <title>Conclusions</title>
        <p>We have presented a kinematic method for efficiently and robustly simulating the beating motion of the heart in real time on a consumer-level PC. Our method computes motion in two steps: contracting local regions along the fiber direction and estimating the global shape that best satisfies all contracted local regions by SMD. By introducing fiber-direction-dependent weights into SMD, we can emulate the anisotropic stiffness of the myocardium. A comparison between our method and a physics-based method <xref ref-type="bibr" rid="pone.0036706-Zajac1">[10]</xref>, <xref ref-type="bibr" rid="pone.0036706-Teran1">[11]</xref> indicated that both methods generated very similar beating motions. Our method achieved a highly realistic beating motion with a LVEF comparable to that of an actual heart. We found that our method has high controllability; it allowed us to easily adjust the contraction speeds of the simulated motion to observed data by modifying the time-contraction curve. Finally, we believe that our method provides an important step to bridge a gap between the unwieldy heart contraction simulations and the user-friendly interactive applications. Hopefully, this method will be used in various interactive applications and enhance the value of cardiac simulations.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pone.0036706.s001" mimetype="video/x-ms-wmv" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.s001" xlink:type="simple">
        <label>Video S1</label>
        <caption>
          <p><bold>A basic interface of our prototype system.</bold> This video shows a basic interface for modifying local contraction rate and timing, and our real-time simulation result.</p>
          <p>(WMV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0036706.s002" mimetype="video/x-ms-wmv" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.s002" xlink:type="simple">
        <label>Video S2</label>
        <caption>
          <p><bold>Comparison between our method and a physics-based method.</bold> This video shows simulation results generated with our method and the physics based method side-by-side.</p>
          <p>(WMV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0036706.s003" mimetype="video/x-ms-wmv" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.s003" xlink:type="simple">
        <label>Video S3</label>
        <caption>
          <p><bold>Left ventricle ejection fraction of a simulated whole heart.</bold> This video shows simulated whole heart motions with three different maximum contraction rates.</p>
          <p>(WMV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0036706.s004" mimetype="video/x-ms-wmv" position="float" xlink:href="info:doi/10.1371/journal.pone.0036706.s004" xlink:type="simple">
        <label>Video S4</label>
        <caption>
          <p><bold>Three interaction tools.</bold> This video shows our three interaction tools, a cutting tool, a peeling tool, and a direct deformation tool.</p>
          <p>(WMV)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="pone.0036706-Streeter1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Streeter</surname><given-names>DD</given-names></name><name name-style="western"><surname>Spotnitz</surname><given-names>HM</given-names></name><name name-style="western"><surname>Patel</surname><given-names>DP</given-names></name><name name-style="western"><surname>Ross</surname><given-names>J</given-names></name><name name-style="western"><surname>Sonnenblick</surname><given-names>EH</given-names></name></person-group>             <year>1969</year>             <article-title>Fiber orientation in the canine left ventricle during diastole and systole.</article-title>             <source>Circ Res</source>             <volume>24</volume>             <fpage>339</fpage>             <lpage>347</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Greenbaum1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Greenbaum</surname><given-names>RA</given-names></name><name name-style="western"><surname>Ho</surname><given-names>SY</given-names></name><name name-style="western"><surname>Gibson</surname><given-names>DG</given-names></name><name name-style="western"><surname>Becker</surname><given-names>AE</given-names></name><name name-style="western"><surname>Anderson</surname><given-names>RH</given-names></name></person-group>             <year>1981</year>             <article-title>Left ventricular fibre architecture in man.</article-title>             <source>Br Heart J</source>             <volume>45</volume>             <fpage>248</fpage>             <lpage>263</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Nielsen1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nielsen</surname><given-names>PM</given-names></name><name name-style="western"><surname>Le Grice</surname><given-names>IJ</given-names></name><name name-style="western"><surname>Smaill</surname><given-names>BH</given-names></name><name name-style="western"><surname>Hunter</surname><given-names>PJ</given-names></name></person-group>             <year>1991</year>             <article-title>Mathematical model of geometry and fibrous structure of the heart.</article-title>             <source>Am J Physiol Heart Circ Physiol</source>             <volume>260</volume>             <fpage>H1365</fpage>             <lpage>H1378</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Lin1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>DH</given-names></name><name name-style="western"><surname>Yin</surname><given-names>FC</given-names></name></person-group>             <year>1998</year>             <article-title>A multiaxial constitutive law for mammalian left ventricular myocardium in steady state barium contracture of tetanus.</article-title>             <source>J Biomech Eng</source>             <volume>120</volume>             <fpage>505</fpage>             <lpage>517</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Feng1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Feng</surname><given-names>L</given-names></name><name name-style="western"><surname>Weixue</surname><given-names>L</given-names></name><name name-style="western"><surname>Ling</surname><given-names>X</given-names></name><name name-style="western"><surname>Guohua</surname><given-names>W</given-names></name></person-group>             <year>2001</year>             <article-title>The construction of three-dimensional composite finite element mechanical model of human left ventricle.</article-title>             <source>JSME Int J Ser C</source>             <volume>44</volume>             <fpage>125</fpage>             <lpage>133</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Watanabe1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Watanabe</surname><given-names>H</given-names></name><name name-style="western"><surname>Hisada</surname><given-names>T</given-names></name><name name-style="western"><surname>Sugiura</surname><given-names>S</given-names></name><name name-style="western"><surname>Okada</surname><given-names>J</given-names></name><name name-style="western"><surname>Fukunari</surname><given-names>H</given-names></name></person-group>             <year>2002</year>             <article-title>Computer simulation of blood flow, left ventricular wall motion and their interrelationship by fluid-structure interaction finite element method.</article-title>             <source>JSME Int J Ser C</source>             <volume>45</volume>             <fpage>1003</fpage>             <lpage>1012</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Hunter1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hunter</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Pullan</surname><given-names>AJ</given-names></name><name name-style="western"><surname>Smaill</surname><given-names>BH</given-names></name></person-group>             <year>2003</year>             <article-title>Modeling total heart function.</article-title>             <source>Annu Rev Biomed Eng</source>             <volume>5</volume>             <fpage>147</fpage>             <lpage>177</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Amano1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Amano</surname><given-names>A</given-names></name><name name-style="western"><surname>Kanada</surname><given-names>K</given-names></name><name name-style="western"><surname>Shibayama</surname><given-names>T</given-names></name><name name-style="western"><surname>Kamei</surname><given-names>Y</given-names></name><name name-style="western"><surname>Matsuda</surname><given-names>T</given-names></name></person-group>             <year>2004</year>             <article-title>Model generation interface for simulation of left ventricular motion.</article-title>             <source>Proc IEEE Eng Med Biol Soc</source>             <volume>5</volume>             <fpage>3658</fpage>             <lpage>3661</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Hill1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hill</surname><given-names>A</given-names></name></person-group>             <year>1938</year>             <article-title>The heat of shortening and the dynamic constants of muscle.</article-title>             <source>Proc R Soc Lond B</source>             <volume>126</volume>             <fpage>136</fpage>             <lpage>195</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Zajac1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zajac</surname><given-names>FE</given-names></name></person-group>             <year>1989</year>             <article-title>Muscle and tendon: properties, models, scaling, and application to biomechanics and motor control.</article-title>             <source>Crit Rev Biomed Eng</source>             <volume>17</volume>             <fpage>359</fpage>             <lpage>411</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Teran1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Teran</surname><given-names>J</given-names></name><name name-style="western"><surname>Blemker</surname><given-names>S</given-names></name><name name-style="western"><surname>Ng</surname><given-names>V</given-names></name><name name-style="western"><surname>Fedkiw</surname><given-names>R</given-names></name></person-group>             <year>2003</year>             <article-title>Finite volume methods for the simulation of skeletal muscle.</article-title>             <source>Proc Symp Comput Anim</source>             <volume>2003</volume>             <fpage>68</fpage>             <lpage>74</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Mller1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Müller</surname><given-names>M</given-names></name><name name-style="western"><surname>Hheidelberger</surname><given-names>B</given-names></name><name name-style="western"><surname>Teschner</surname><given-names>M</given-names></name><name name-style="western"><surname>Gross</surname><given-names>M</given-names></name></person-group>             <year>2005</year>             <article-title>Meshless deformations based on shape matching.</article-title>             <source>ACM Trans Graph</source>             <volume>24</volume>             <fpage>471</fpage>             <lpage>478</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Rivers1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rivers</surname><given-names>A</given-names></name><name name-style="western"><surname>James</surname><given-names>DL</given-names></name></person-group>             <year>2007</year>             <article-title>FastLSM: fast lattice shape matching for robust real-time deformation.</article-title>             <source>ACM Trans Graph</source>             <volume>26</volume>             <fpage>82</fpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Ijiri1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ijiri</surname><given-names>T</given-names></name><name name-style="western"><surname>Takayama</surname><given-names>K</given-names></name><name name-style="western"><surname>Yokota</surname><given-names>H</given-names></name><name name-style="western"><surname>Igarashi</surname><given-names>T</given-names></name></person-group>             <year>2009</year>             <article-title>ProcDef: local-to-global deformation for skeleton-free character animation.</article-title>             <source>Comp Graph Forum</source>             <volume>27</volume>             <fpage>1821</fpage>             <lpage>1828</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Demer1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Demer</surname><given-names>LL</given-names></name><name name-style="western"><surname>Yin</surname><given-names>FC</given-names></name></person-group>             <year>1983</year>             <article-title>Passive biaxial mechanical properties of isolated canine myocardium.</article-title>             <source>J Physiol</source>             <volume>339</volume>             <fpage>615</fpage>             <lpage>630</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Ohayon1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ohayon</surname><given-names>J</given-names></name><name name-style="western"><surname>Chadwick</surname><given-names>RS</given-names></name></person-group>             <year>1988</year>             <article-title>Effects of collagen microstructure on the mechanics of the left ventricle.</article-title>             <source>Biophys J</source>             <volume>54</volume>             <issue>6</issue>             <fpage>1077</fpage>             <lpage>1088</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Zhukov1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhukov</surname><given-names>L</given-names></name><name name-style="western"><surname>Barr</surname><given-names>AH</given-names></name></person-group>             <year>2003</year>             <article-title>Heart-muscle fiber reconstruction from diffusion tensor MRI.</article-title>             <source>Proc IEEE Vis</source>             <volume>2003</volume>             <fpage>597</fpage>             <lpage>602</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Takayama1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Takayama</surname><given-names>K</given-names></name><name name-style="western"><surname>Ashihara</surname><given-names>T</given-names></name><name name-style="western"><surname>Ijiri</surname><given-names>T</given-names></name><name name-style="western"><surname>Igarashi</surname><given-names>T</given-names></name><name name-style="western"><surname>Haraguchi</surname><given-names>R</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>A sketch-based interface for modeling myocardial fiber orientation that considers the layered structure of the ventricles.</article-title>             <source>J Physiol Sci</source>             <volume>58</volume>             <fpage>487</fpage>             <lpage>492</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Ashihara1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ashihara</surname><given-names>T</given-names></name><name name-style="western"><surname>Namba</surname><given-names>T</given-names></name><name name-style="western"><surname>Ito</surname><given-names>M</given-names></name><name name-style="western"><surname>Kinoshita</surname><given-names>M</given-names></name><name name-style="western"><surname>Nakazawa</surname><given-names>K</given-names></name></person-group>             <year>1999</year>             <article-title>The dynamics of vortex-like reentry wave filaments in three-dimensional computer models.</article-title>             <source>J Electrocardiol</source>             <volume>32</volume>             <supplement>Suppl</supplement>             <fpage>129</fpage>             <lpage>138</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Matsuoka1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Matsuoka</surname><given-names>S</given-names></name><name name-style="western"><surname>Sarai</surname><given-names>N</given-names></name><name name-style="western"><surname>Kuratomi</surname><given-names>S</given-names></name><name name-style="western"><surname>Ono</surname><given-names>K</given-names></name><name name-style="western"><surname>Noma</surname><given-names>A</given-names></name></person-group>             <year>2003</year>             <article-title>Role of individual ionic current systems in ventricular cells hypothesized by a model study.</article-title>             <source>Jpn J Physiol</source>             <volume>53</volume>             <fpage>105</fpage>             <lpage>123</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Takamatsu1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Takamatsu</surname><given-names>K</given-names></name><name name-style="western"><surname>Kanai</surname><given-names>T</given-names></name></person-group>             <year>2009</year>             <article-title>Volume-preserving LSM deformations.</article-title>             <source>ACM SIGGRAPH ASIA 2009 Sketches</source>             <volume>15</volume>          </element-citation>
      </ref>
      <ref id="pone.0036706-Herman1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Herman</surname><given-names>IP</given-names></name></person-group>             <year>2007</year>             <article-title>Physics of the human body (Biological and Medical Physics, Biomedical Engineering).</article-title>             <source>Springer</source>          </element-citation>
      </ref>
      <ref id="pone.0036706-H1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>H</surname><given-names>Si</given-names></name></person-group>             <year>2006</year>             <article-title>On refinement of constrained Delaunay tetrahedralizations.</article-title>             <source>Proc 15th Int Meshing Roundtable</source>             <fpage>509</fpage>             <lpage>528</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Ruprecht1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ruprecht</surname><given-names>D</given-names></name><name name-style="western"><surname>Müller</surname><given-names>H</given-names></name></person-group>             <year>1998</year>             <article-title>A scheme for edge-based adaptive tetrahedron subdivision. (Math. Vis.).</article-title>             <source>Springer</source>             <fpage>61</fpage>             <lpage>70</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Ho1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ho</surname><given-names>SY</given-names></name><name name-style="western"><surname>Sánchez-Quintana</surname><given-names>D</given-names></name></person-group>             <year>2009</year>             <article-title>The importance of atrial structure and fibers.</article-title>             <source>Clin Anat</source>             <volume>22</volume>             <fpage>52</fpage>             <lpage>63</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Traill1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Traill</surname><given-names>TA</given-names></name><name name-style="western"><surname>Gibson</surname><given-names>DG</given-names></name><name name-style="western"><surname>Brown</surname><given-names>DJ</given-names></name></person-group>             <year>1978</year>             <article-title>Study of left ventricular wall thickness and dimension changes using echocardiography.</article-title>             <source>Br Heart J</source>             <volume>40</volume>             <fpage>162</fpage>             <lpage>169</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Buckberg1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Buckberg</surname><given-names>GD</given-names></name><name name-style="western"><surname>Coghlan</surname><given-names>HC</given-names></name><name name-style="western"><surname>Hoffman</surname><given-names>JI</given-names></name><name name-style="western"><surname>Torrent-Guasp</surname><given-names>F</given-names></name></person-group>             <year>2001</year>             <article-title>The structure and function of the helical heart and its buttress wrapping. VII. Critical importance of septum for right ventricular function.</article-title>             <source>Semin Thorac Cardiovasc Surg</source>             <volume>13</volume>             <fpage>402</fpage>             <lpage>416</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Rungjiratananon1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rungjiratananon</surname><given-names>W</given-names></name><name name-style="western"><surname>Kanamori</surname><given-names>Y</given-names></name><name name-style="western"><surname>Nishita</surname><given-names>T</given-names></name></person-group>             <year>2010</year>             <article-title>Chain shape matching for simulating complex hairstyles.</article-title>             <source>Comp Graph Forum</source>             <volume>29</volume>             <fpage>2438</fpage>             <lpage>2446</lpage>          </element-citation>
      </ref>
      <ref id="pone.0036706-Liao1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liao</surname><given-names>S</given-names></name><name name-style="western"><surname>Liang</surname><given-names>Y</given-names></name><name name-style="western"><surname>Li</surname><given-names>L</given-names></name><name name-style="western"><surname>Zou</surname><given-names>B</given-names></name><name name-style="western"><surname>Zhu</surname><given-names>X</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Practical craniofacial surgery simulator based on GPU accelerated lattice shape matching.</article-title>             <source>Comp Anim Virt Worlds</source>             <volume>22</volume>             <fpage>269</fpage>             <lpage>276</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>