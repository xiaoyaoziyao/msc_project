<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-13-45044</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0102713</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Evolutionary modeling</subject><subject>Population modeling</subject></subj-group></subj-group><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject><subj-group><subject>Natural selection</subject></subj-group></subj-group><subj-group><subject>Evolutionary theory</subject><subject>Organismal evolution</subject></subj-group></subj-group><subj-group><subject>Population biology</subject><subj-group><subject>Population dynamics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer and information sciences</subject><subj-group><subject>Computing systems</subject><subj-group><subject>Digital computing</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>The Effect of Conflicting Pressures on the Evolution of Division of Labor</article-title>
<alt-title alt-title-type="running-head">Conflicting Pressures and Division of Labor</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Goldsby</surname><given-names>Heather J.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Knoester</surname><given-names>David B.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Kerr</surname><given-names>Benjamin</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ofria</surname><given-names>Charles</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Biology, University of Washington, Seattle, Washington, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Microbiology and Molecular Genetics, Michigan State University, East Lansing, Michigan, United States of America</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Computer Science and Engineering, Michigan State University, East Lansing, Michigan, United States of America</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>BEACON Center for Evolution in Action, Michigan State University, East Lansing, Michigan, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Gudelj</surname><given-names>Ivana</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Exeter, United Kingdom</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">goldsby@uw.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: HG DK BK CO. Performed the experiments: HG. Analyzed the data: HG. Contributed reagents/materials/analysis tools: HG DK. Wrote the paper: HG DK BK CO. Designed and wrote the software used in experiments: HG DK. Wrote the analysis software: HG DK.</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>5</day><month>8</month><year>2014</year></pub-date>
<volume>9</volume>
<issue>8</issue>
<elocation-id>e102713</elocation-id>
<history>
<date date-type="received"><day>4</day><month>11</month><year>2013</year></date>
<date date-type="accepted"><day>23</day><month>6</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Goldsby et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Within nature, many groups exhibit division of labor. Individuals in these groups are under seemingly antagonistic pressures to perform the task most directly beneficial to themselves and to potentially perform a less desirable task to ensure the success of the group. Performing experiments to study how these pressures interact in an evolutionary context is challenging with organic systems because of long generation times and difficulties related to group propagation and fine-grained control of within-group and between-group pressures. Here, we use groups of digital organisms (i.e., self-replicating computer programs) to explore how populations respond to antagonistic multilevel selection pressures. Specifically, we impose a within-group pressure to perform a highly-rewarded role and a between-group pressure to perform a diverse suite of roles. Thus, individuals specializing on highly-rewarded roles will have a within-group advantage, but groups of such specialists have a between-group disadvantage. We find that digital groups could evolve to be either single-lineage or multi-lineage, depending on experimental parameters. These group compositions are reminiscent of different kinds of major evolutionary transitions that occur within nature, where either relatives divide labor (fraternal transitions) or multiple different organisms coordinate activities to form a higher-level individual (egalitarian transitions). Regardless of group composition, organisms embraced phenotypic plasticity as a means for genetically similar individuals to perform different roles. Additionally, in multi-lineage groups, organisms from lineages performing highly-rewarded roles also employed reproductive restraint to ensure successful coexistence with organisms from other lineages.</p>
</abstract>
<funding-group><funding-statement>This work was supported by the BEACON Center for the Study of Evolution in Action (NSF Cooperative Agreement DBI-0939454), an NSF CAREER award to B.K. (DEB0952825), NSF FELLOWSHIP award to H.G (OCI-1122620) and D.K (OCI-1122617), and NSF Grants (CCF-0643952, CCF-0820220). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>In <italic>The Origin of Species</italic> <xref ref-type="bibr" rid="pone.0102713-Darwin1">[1]</xref>, Darwin used examples of artificial selection to lay the groundwork for his natural selection analog. More recently, experiments using artificial selection have greatly increased our understanding of both short- and long-term evolutionary processes <xref ref-type="bibr" rid="pone.0102713-Goodnight1">[2]</xref>. Indeed, while the role of group selection in natural settings is a controversial topic <xref ref-type="bibr" rid="pone.0102713-Okasha1">[3]</xref>, <xref ref-type="bibr" rid="pone.0102713-Wilson1">[ 4]</xref>, artificial group selection experiments have demonstrated that selection at the level of the group can produce targeted evolutionary responses <xref ref-type="bibr" rid="pone.0102713-Goodnight1">[2]</xref>, <xref ref-type="bibr" rid="pone.0102713-Swenson1">[ 5]</xref>–<xref ref-type="bibr" rid="pone.0102713-Wade2">[8]</xref>. For example, in a classic group selection experiment, Wade preferentially selected groups of flour beetles (<italic>Tribolium castancum</italic>) for both large and small group sizes <xref ref-type="bibr" rid="pone.0102713-Wade1">[7]</xref>. After nine group-selection events, the beetles selected for large group size averaged 178 individuals, while the beetles selected for small group size averaged only 20 individuals. More recently, Swenson <italic>et al.</italic> have shown that artificial group selection can produce soil systems supporting an increased plant biomass <xref ref-type="bibr" rid="pone.0102713-Swenson1">[5]</xref>, and aquatic ecosystems with a specific pH <xref ref-type="bibr" rid="pone.0102713-Swenson2">[6]</xref>.</p>
<p>Of particular interest are instances of <italic>antagonistic multilevel selection</italic>, where the between-group pressure (i.e., whether groups thrive) conflicts with the within-group pressure (i.e., whether individuals within the group thrive). For example, within Wade's study, there are indications that selecting groups for larger population sizes involved antagonistic multilevel selection pressures. Cannibalism would provide an individual with a within-group advantage, but groups of cannibals would likely have a smaller population size and thus a between-group disadvantage. Specifically, when groups with larger population sizes were preferentially propagated, cannibalism was a group-level liability. Indeed, individuals exhibited lower rates of cannibalism when large groups were selected for <xref ref-type="bibr" rid="pone.0102713-Wade2">[8]</xref>. Conversely, cannibalism rates were higher when groups with smaller populations were preferentially propagated.</p>
<p>Antagonistic multilevel pressures are frequently observed in groups that exhibit division of labor within nature, where there is a within-group pressure to specialize on the role with the highest reward and a between-group pressure to perform a diverse suite of tasks. These groups, which vary in scale and complexity, include a host cell and its mitochondria <xref ref-type="bibr" rid="pone.0102713-Queller1">[9]</xref>, the cells of a multicellular organism <xref ref-type="bibr" rid="pone.0102713-Queller1">[9]</xref>, <xref ref-type="bibr" rid="pone.0102713-Buss1">[ 10]</xref>, insects within colonies of eusocial arthropods <xref ref-type="bibr" rid="pone.0102713-Crespi1">[11]</xref>–<xref ref-type="bibr" rid="pone.0102713-Wilson2">[15]</xref>, and even humans within societies <xref ref-type="bibr" rid="pone.0102713-Gintis1">[16]</xref>, <xref ref-type="bibr" rid="pone.0102713-Smith1">[ 17]</xref>. Even though these groups are the epitome of high-level functionality, when the within-group pressure asserts itself, it can produce ills such as mitochondrial and nuclear genome interactions that result in plants that do not produce viable pollen <xref ref-type="bibr" rid="pone.0102713-Fujii1">[18]</xref>, cancer within multicellular organisms <xref ref-type="bibr" rid="pone.0102713-Axelrod1">[19]</xref>, defector insects within eusocial colonies <xref ref-type="bibr" rid="pone.0102713-Sundstrm1">[20]</xref>, and criminals within human societies <xref ref-type="bibr" rid="pone.0102713-Fehr1">[21]</xref>. While we present our work in terms of multilevel selection <xref ref-type="bibr" rid="pone.0102713-Traulsen1">[22]</xref>, <xref ref-type="bibr" rid="pone.0102713-Sober1">[ 23]</xref>, such evolution can also be viewed from an inclusive fitness perspective <xref ref-type="bibr" rid="pone.0102713-Hamilton1">[24]</xref>–<xref ref-type="bibr" rid="pone.0102713-Bourke1">[26]</xref> (where a focal individual's fitness can be decomposed into the effects of its phenotype on individuals within its group, including itself, weighted by its relatedness to these individuals). Ideally, a complete analysis of antagonistic multilevel selection pressures would include open-ended evolutionary dynamics in a system that has rapid generation times and is tractable enough to facilitate an exploration of mechanisms.</p>
<p>For this study, we use the Avida digital evolution platform <xref ref-type="bibr" rid="pone.0102713-Ofria1">[27]</xref>. Digital evolution is a form of experimental evolution, where organisms are self-replicating computer programs that evolve in a user-defined computational environment and are subject to mutations and natural selection. These <italic>digital organisms</italic> execute instructions in their genome to metabolize resources in the environment, interact with neighboring organisms, and self-replicate. Digital evolution has previously been used to study topics in evolutionary biology ranging from the origin of complex features <xref ref-type="bibr" rid="pone.0102713-Lenski1">[28]</xref>, modularity <xref ref-type="bibr" rid="pone.0102713-Ofria2">[29]</xref>, leader election <xref ref-type="bibr" rid="pone.0102713-Knoester1">[30]</xref>, <xref ref-type="bibr" rid="pone.0102713-Knoester2">[ 31]</xref>, altruism <xref ref-type="bibr" rid="pone.0102713-Goings1">[32]</xref>–<xref ref-type="bibr" rid="pone.0102713-Johnson2">[35]</xref>, and division of labor <xref ref-type="bibr" rid="pone.0102713-Goldsby1">[36]</xref>–<xref ref-type="bibr" rid="pone.0102713-Goldsby3">[38]</xref>. Digital evolution fills a unique niche in the study of evolutionary phenomena. In contrast to analytical models and simulations, the digital approach is an open-ended instance of evolution. However, in contrast to experimental evolution with organic systems, digital evolution enables us to study evolution over many more generations, and with unparalleled experimental control and automated data collection, which facilitates the exploration of mechanisms employed by digital organisms. For this study, digital evolution enables us to manipulate factors that may affect the course of evolution within a group-structured system. Specifically, we vary the degree of antagonism among group and individual selection pressures, the methods by which groups are formed, and how group members interact.</p>
<p>We first examine the evolutionary trajectories of groups that exhibit division of labor when individual roles have different fitness benefits. We begin these experiments with several isolated groups of genetically-identical ancestor organisms, and allow these organisms to differentiate via mutation. In this paper, we address the question: Given both a between-group pressure to perform a variety of tasks, and a within-group pressure to perform the task with the highest associated fitness benefit, under which conditions will groups of organisms evolve to perform a diverse suite of tasks? Second, when division of labor evolves, we explore how individuals fill different roles, especially roles that have a within -group disadvantage. Within nature, we observe two common strategies: (1) Organisms may form single-lineage groups (i.e., groups of closely-related individuals), where some members perform less rewarded roles via phenotypic plasticity (e.g., workers in eusocial colonies and somatic cells within multicellular organisms); or (2), organisms may coexist within genetically heterogeneous groups (e.g., a host cell and its mitochondria), where different genetic lineages occupy distinct niches and are co-transmitted to the next generation. Digital evolution enables us to examine the conditions under which single-lineage or multi-lineage groups of organisms are favored by selection. We then explore the mechanisms by which individuals within single-lineage and multi-lineage groups coordinate to perform different roles.</p>
</sec><sec id="s2">
<title>Avida Digital Evolution System</title>
<p>Within Avida, digital organisms compete for space in their environment. Each digital organism is a fully functional computer program, arranged as a circular list of instructions, and a virtual CPU that executes the instructions. The instructions in an organism's genome determine the organism's behavior, including its ability to sense and change properties of its environment. Because organisms are <italic>self-replicating</italic>, the genome itself must contain the sequence of instructions needed to create an offspring. When an organism replicates, a neighboring location is selected from the environment, and any previous inhabitant of the target location is replaced (killed and overwritten) by the offspring. Genomes are subject to random mutations (substitutions, insertions, and deletions) during the replication process, leading to offspring that are genetically distinct from their parents.</p>
<p>The genomes of digital organisms can include a variety of different instructions drawn from the Avida instruction set. These instructions include those for basic computational tasks (e.g., addition, subtraction, and bit-shifts), controlling execution flow, communication, environmental interaction, and self-replication (these instructions are described in detail in <xref ref-type="bibr" rid="pone.0102713-Ofria1">[27]</xref>). The standard Avida instruction set is designed so that any combination of instructions is a syntactically correct program, albeit one that may not perform any meaningful computation <xref ref-type="bibr" rid="pone.0102713-Ofria3">[39]</xref>. In this study, the instruction set also included several instructions that were developed to facilitate distributed problem solving <xref ref-type="bibr" rid="pone.0102713-McKinley1">[40]</xref>; these instructions enable organisms to send messages to one neighbor (an adjacent organism on a toroidal grid), to all of their neighbors, to retrieve a message, and to access their spatial position (i.e., x-y coordinates) within the group. Additionally, organisms were able to transmit epigenetic information to their offspring. Specifically, numerical values stored in one particular register were not erased during replication and could be used to facilitate coordination.</p>
<p>The <italic>metabolic rate</italic> of a digital organism determines the relative rate at which an organism's virtual CPU executes the instructions in its genome. For example, an organism with a metabolic rate of 10 will, on average, execute instructions twice as quickly as one with a metabolic rate of 5. Because organisms self-replicate and compete for space, an organism with a higher metabolic rate will generally grow to dominate the world, all else being equal. Within Avida, an organism can perform a <italic>task</italic> (or exhibit a specific phenotype) in order to consume resources that will increase its metabolic rate. For most of the experiments described in this study, we use five mutually-exclusive logic operation tasks. Specifically, to receive a reward, an organism must perform a bitwise Boolean logic operation on 32-bit integers. The tasks are configured such that the organisms that perform them receive unequal rewards. Specifically, if an organism performs task <monospace>NOT</monospace> or <monospace>NAND</monospace> (the simplest tasks), then its metabolic rate is doubled. If an organism performs task <monospace>AND</monospace> or <monospace>ORNOT</monospace>, its metabolic rate is tripled. If an organism performs task <monospace>OR</monospace> (the most complex task in this environment), its metabolic rate is quadrupled. An organism can only receive a reward for performing one task. Thus, an organism that performed task <monospace>NAND</monospace> could not subsequently receive a reward for performing task <monospace>ORNOT</monospace>.</p>
<p>To study multilevel selection in Avida, we divided the digital organisms into distinct <italic>groups</italic> that compete. An Avida world consists of 400 groups. In this study, groups compete and are replicated via tournament selection. For <italic>tournament selection</italic>, every 100 updates, groups that exhibit division of labor have a fecundity advantage (<xref ref-type="fig" rid="pone-0102713-g001">Figure 1</xref>). (An <italic>update</italic> is the unit of experimental time in Avida corresponding to an average of 30 virtual CPU instructions per organism.) We refer to the time period between tournament events in which we compete the groups as the <italic>inter-tournament period length</italic>. Each round of between-group selection consists of 400 tournaments, where the groups in each tournament are selected at random with replacement. Within each tournament, the group that performs the greatest variety of types of tasks is replicated to the next group-generation (ties are broken randomly). The strength of tournament selection varies with the size of each tournament. For example, a tournament size of five groups results in a stronger between-group pressure than a tournament of two groups. We performed most of the experiments described in this paper with tournaments of size 5. However, to more fully understand how tournament size affects division of labor, we also included additional treatments in which groups compete in tournaments that vary in size from 2 to 20. (<xref ref-type="supplementary-material" rid="pone.0102713.s007">Text S1</xref>, <xref ref-type="supplementary-material" rid="pone.0102713.s001">Figure S1</xref>.)</p>
<fig id="pone-0102713-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0102713.g001</object-id><label>Figure 1</label><caption>
<title>Depiction of the group replication process.</title>
<p>Group A performs a more diverse suite of tasks than group B. Thus, when the groups compete in the tournament, group A is preferentially replicated and a mutated copy of group A replaces group B. Colors indicate different phenotypes.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0102713.g001" position="float" xlink:type="simple"/></fig>
<p>Within each group, organisms are still able to self-replicate and experience mutations. Organisms are allocated CPU cycles on the basis of their metabolic rate compared to the population. However, organisms directly compete with their group members for space. Specifically, when an organism replicates, it replaces a member of its group. As a result, it is possible to establish either single-lineage or multi-lineage groups. Since all constituent organisms are copied when we replicate a group, an individual's long-term survival is dependent not only on its ability to out-compete its neighbors for the limited space available in its group, but also on the collective ability of the group to out-compete other groups.</p>
</sec><sec id="s3">
<title>Results</title>
<p>First, we examine how various combinations of multilevel selection pressures affect the diversity of the suite of tasks performed by groups of organisms. Next, we vary key parameters and observe their effect on the evolution of division of labor. Finally, we explore the mechanisms used by individuals within successful groups to coordinate their roles.</p>
<sec id="s3a">
<title>How do groups of organisms evolve to respond to multilevel selection pressures?</title>
<p>In our central experiment, we investigate whether division of labor evolves under treatments that vary the within-group and between-group pressures. Specifically, we define four treatments: <monospace>Within</monospace> includes within-group pressures only; <monospace>Between</monospace> includes between-group pressures only; <monospace>Both</monospace> includes both within- and between-group pressures; and <monospace>None</monospace> includes neither within-group nor between-group pressures (a control). (Refer to Materials and Methods for details.) We predict that if between-group selection is necessary for evolving division of labor, then treatments <monospace>Between</monospace> and <monospace>Both</monospace> should evolve to exhibit a wider range of tasks than treatments <monospace>Within</monospace> and <monospace>None</monospace>. Moreover, if treatment <monospace>Both</monospace> performs a wider range of tasks, then we are also able to provide evidence that the between-group selection pressure for division of labor is sufficient to counteract the within-group selection pressure to perform the most highly-rewarded role.</p>
<p><xref ref-type="fig" rid="pone-0102713-g002">Figure 2</xref> depicts the number of unique types of tasks performed by groups of organisms for these four treatments. Treatments that include the between-group pressure (<monospace>Both</monospace> and <monospace>Between</monospace>) evolved to perform a wider range of tasks than those without the between-group pressure (Kruskal-Wallis multiple comparison, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e001" xlink:type="simple"/></inline-formula>). Summary statistics for this and all future treatments can be found in <xref ref-type="table" rid="pone-0102713-t001">Table 1</xref>. The mean of the <monospace>None</monospace> treatment is close to one. This result occurs because the <monospace>None</monospace> treatment removes differential task pressures by rewarding all tasks evenly. However, an organism that performs any task outcompetes all organisms that perform no tasks. Counterintuitively, the mean of the <monospace>Both</monospace> treatment exceeds that of the <monospace>Between</monospace> treatment (though this is a non-significant difference). Multilevel selection pressures exist in a continuum of conflict ranging from complete alignment to complete opposition of within-group and between-group pressures. The <monospace>Both</monospace> treatment explores one form of antagonistic pressures present within division of labor systems, where antagonism results from a within-group pressure to perform the most highly-rewarded tasks and a between-group pressure to perform all tasks. However, within the <monospace>Both</monospace> treatment, the multilevel selection pressures are not completely in conflict – An individual always receives a reward for performing a task that is beneficial for the group. We performed an additional treatment, where the pressures were more antagonistic (i.e., all tasks are individually detrimental to varying degrees). For this treatment, we rewarded the tasks as follows: <monospace>NOT</monospace> (0.25), <monospace>NAND</monospace> (0.25), <monospace>AND</monospace> (0.50), <monospace>ORN</monospace> (0.50), and <monospace>OR</monospace> (0.75). In this case of extreme antagonism, the mean number of unique tasks performed was 3.66<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e002" xlink:type="simple"/></inline-formula>0.15 (standard error) in the <monospace>Both</monospace> treatment, whereas the mean number of unique tasks performed in the <monospace>Between</monospace> treatment is 4.46<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e003" xlink:type="simple"/></inline-formula>0.04 (Wilcox Multiple Comparison, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e004" xlink:type="simple"/></inline-formula>). We more fully explore the effects of modifying the within-group pressure in <xref ref-type="supplementary-material" rid="pone.0102713.s008">Text S2</xref> and <xref ref-type="supplementary-material" rid="pone.0102713.s002">Figures S2</xref> and <xref ref-type="supplementary-material" rid="pone.0102713.s003">S3</xref>.</p>
<fig id="pone-0102713-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0102713.g002</object-id><label>Figure 2</label><caption>
<title>Varying within-group and between-group pressures.</title>
<p>We report the mean number of different types of tasks performed by groups of organisms in each treatment. Values are taken over 30 replicates in an environment where each organism can perform one of five different logic tasks. Thus, the maximum number of different types of tasks that can be performed by a group (indicated by a black horizontal line) is 5. The treatments evolved with between-group selection pressures outperform the treatments evolved without between-group selection pressures. These results are evidence that, in this environment, the between-group component of the selection pressures is necessary to produce groups of organisms that succeed at performing a wide range of tasks.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0102713.g002" position="float" xlink:type="simple"/></fig><table-wrap id="pone-0102713-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0102713.t001</object-id><label>Table 1</label><caption>
<title>Summary statistics for experimental treatments.</title>
</caption><alternatives><graphic id="pone-0102713-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0102713.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Experiment</td>
<td align="left" rowspan="1" colspan="1">Treatment</td>
<td align="left" rowspan="1" colspan="1">Performance</td>
<td align="left" rowspan="1" colspan="1">Levenschtein Distance</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e005" xlink:type="simple"/></inline-formula> Standard Error</td>
<td align="left" rowspan="1" colspan="1">Mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e006" xlink:type="simple"/></inline-formula> Standard Error</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Multilevel Selection Pressures</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>Within</monospace></td>
<td align="left" rowspan="1" colspan="1">0.77<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e007" xlink:type="simple"/></inline-formula>0.09</td>
<td align="left" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>Between</monospace></td>
<td align="left" rowspan="1" colspan="1">4.46<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e008" xlink:type="simple"/></inline-formula>0.04</td>
<td align="left" rowspan="1" colspan="1">45.67<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e009" xlink:type="simple"/></inline-formula>0.53</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>Both</monospace></td>
<td align="left" rowspan="1" colspan="1">4.51<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e010" xlink:type="simple"/></inline-formula>0.06</td>
<td align="left" rowspan="1" colspan="1">27.98<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e011" xlink:type="simple"/></inline-formula>13.11</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>None</monospace></td>
<td align="left" rowspan="1" colspan="1">0.89<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e012" xlink:type="simple"/></inline-formula>0.06</td>
<td align="left" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Inter-Tournament Period Length</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>50-update</monospace></td>
<td align="left" rowspan="1" colspan="1">4.71<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e013" xlink:type="simple"/></inline-formula>0.02</td>
<td align="left" rowspan="1" colspan="1">41.46<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e014" xlink:type="simple"/></inline-formula>7.90</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>100-update*</monospace></td>
<td align="left" rowspan="1" colspan="1">4.51<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e015" xlink:type="simple"/></inline-formula>0.06</td>
<td align="left" rowspan="1" colspan="1">27.98<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e016" xlink:type="simple"/></inline-formula>13.11</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>250-update</monospace></td>
<td align="left" rowspan="1" colspan="1">4.18<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e017" xlink:type="simple"/></inline-formula>0.06</td>
<td align="left" rowspan="1" colspan="1">8.03<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e018" xlink:type="simple"/></inline-formula>3.10</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>500-update</monospace></td>
<td align="left" rowspan="1" colspan="1">3.85<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e019" xlink:type="simple"/></inline-formula>0.06</td>
<td align="left" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Migration Rate</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>0%*</monospace></td>
<td align="left" rowspan="1" colspan="1">4.51<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e020" xlink:type="simple"/></inline-formula>0.06</td>
<td align="left" rowspan="1" colspan="1">27.98<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e021" xlink:type="simple"/></inline-formula>13.11</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>5%</monospace></td>
<td align="left" rowspan="1" colspan="1">2.99<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e022" xlink:type="simple"/></inline-formula>0.06</td>
<td align="left" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>10%</monospace></td>
<td align="left" rowspan="1" colspan="1">2.46<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e023" xlink:type="simple"/></inline-formula>0.05</td>
<td align="left" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>20%</monospace></td>
<td align="left" rowspan="1" colspan="1">2.05<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e024" xlink:type="simple"/></inline-formula>0.04</td>
<td align="left" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Propagule Size</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>25*</monospace></td>
<td align="left" rowspan="1" colspan="1">4.51<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e025" xlink:type="simple"/></inline-formula>0.06</td>
<td align="left" rowspan="1" colspan="1">27.98<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e026" xlink:type="simple"/></inline-formula>13.11</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>1-S</monospace></td>
<td align="left" rowspan="1" colspan="1">3.02<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e027" xlink:type="simple"/></inline-formula>0.13</td>
<td align="left" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>2-S</monospace></td>
<td align="left" rowspan="1" colspan="1">3.65<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e028" xlink:type="simple"/></inline-formula>0.11</td>
<td align="left" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>3-S</monospace></td>
<td align="left" rowspan="1" colspan="1">4.24<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e029" xlink:type="simple"/></inline-formula>0.04</td>
<td align="left" rowspan="1" colspan="1">0.04<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e030" xlink:type="simple"/></inline-formula>0.12</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>5-S</monospace></td>
<td align="left" rowspan="1" colspan="1">4.43<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e031" xlink:type="simple"/></inline-formula>0.04</td>
<td align="left" rowspan="1" colspan="1">0.30<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e032" xlink:type="simple"/></inline-formula>0.09</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>15-S</monospace></td>
<td align="left" rowspan="1" colspan="1">4.57<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e033" xlink:type="simple"/></inline-formula>0.07</td>
<td align="left" rowspan="1" colspan="1">9.61<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e034" xlink:type="simple"/></inline-formula>5.81</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><monospace>25-S</monospace></td>
<td align="left" rowspan="1" colspan="1">4.51<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e035" xlink:type="simple"/></inline-formula>0.05</td>
<td align="left" rowspan="1" colspan="1">15.30<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e036" xlink:type="simple"/></inline-formula>4.11</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>Mean and standard error are computed over 30 replicates at the final time point. An asterisk (*) denotes that the data from the Both treatment from our original experiment was used for the particular treatment.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3b">
<title>How is division of labor affected by inter-tournament period length, migration rate, and propagule size?</title>
<p>Three factors that have the potential to disrupt the evolution of division of labor are: (1) the frequency at which groups compete compared to the life-span of individual organisms, (2) the degree to which established groups are isolated from others, and (3) the method by which new groups are formed. Here we explore the effect of these factors on division of labor. For all of these experiments, we maintain the same multilevel selection pressures used for the <monospace>Both</monospace> treatment.</p>
<sec id="s3b1">
<title>1. Inter-tournament period length</title>
<p>The inter-tournament period length alters the relative strength of between-group selection as compared to within-group selection. Specifically, as the duration of this period increases, the force of between-group selection is weakened; conversely, as the duration of this period shrinks, the force of between-group selection is strengthened. Given the effect of the between-group pressure, the amount of division of labor present within the groups should decline as the duration of the period between tournaments increases. To test this prediction, we performed an experiment where treatments had inter-tournament periods of 50, 100, 250, and 500 updates. Within our central experiment, the <monospace>Both</monospace> treatment used an inter-tournament period of 100 updates.</p>
<p><xref ref-type="fig" rid="pone-0102713-g003">Figure 3</xref> depicts the results of this experiment (see <xref ref-type="table" rid="pone-0102713-t001">Table 1</xref> for summary statistics). In general, as the inter-tournament period increases, the mean number of unique types of tasks performed by group members decreases. The 50-update and 100-update treatments are both significantly different than the 250-update and 500-update treatments, but not from each other (Kruskal-Wallis multiple comparison, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e037" xlink:type="simple"/></inline-formula>). While increasing the inter-tournament period length decreases the amount of division of labor evolved, it does not have a large effect. Specifically, we observe that changing from a competition period of 50 updates to one ten times longer (500 updates) results in the loss of less than one task on average (4.71<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e038" xlink:type="simple"/></inline-formula>0.02 for the 50-update treatment and 3.85<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e039" xlink:type="simple"/></inline-formula>0.06 for 500-update treatment). In further analyses, we also determined that the organisms evolved to time their task performance to coincide with the inter-tournament period length and performance decreased when we transplanted organisms evolved with a short period into a long period and vice versa (<xref ref-type="supplementary-material" rid="pone.0102713.s006">Table S1</xref>).</p>
<fig id="pone-0102713-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0102713.g003</object-id><label>Figure 3</label><caption>
<title>Varying the inter-tournament period length.</title>
<p>We report the number of different types of tasks performed by groups of organisms in each treatment, where treatments had different between-group selection intervals. The maximum number of different types of tasks that can be performed by a group (indicated by a black horizontal line) is 5. The asterisk (*) indicates the <monospace>Both</monospace> treatment. As the inter-tournament period length increased, the amount of division of labor exhibited by the groups decreased. However, inter-tournament period length does not have a qualitatively large effect.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0102713.g003" position="float" xlink:type="simple"/></fig></sec><sec id="s3b2">
<title>2. Migration</title>
<p>A second factor that has the potential to disrupt the ability of groups of organisms to evolve to perform a wide range of tasks is migration. Within Avida, migration occurs as part of the individual replication process. Specifically, a configurable migration rate determines the probability that an offspring organism will be placed into a group different than that of its parent. For our central experiment, the migration rate was set to 0% (no migration), ensuring that all offspring were born into the same group as their parent. As the migration rate increases, the cohesiveness of the group declines, since organisms may not be placed in groups with kin or other mutualistic clades that their ancestors evolved with. Thus, our prediction is that higher migration rates will result in a decline in the amount of division of labor exhibited by evolved groups. To study the effects of migration, we performed an experiment in which treatments had migration rates of 0%, 5%, 10%, and 20%.</p>
<p><xref ref-type="fig" rid="pone-0102713-g004">Figure 4</xref> depicts the results of our migration experiment (see <xref ref-type="table" rid="pone-0102713-t001">Table 1</xref> for summary statistics). 0% migration is significantly different than all other treatments and 5% migration is significantly different than 20% (Kruskal-Wallis multiple comparison, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e040" xlink:type="simple"/></inline-formula>). Even a small probability of migration has a large effect on the ability of the group members to perform a wide range of tasks. Specifically, changing from a migration rate of 0% to a migration rate of 5% causes a loss of 1.523 tasks on average, and the number of tasks continues to drop as migration rate is increased further.</p>
<fig id="pone-0102713-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0102713.g004</object-id><label>Figure 4</label><caption>
<title>Varying migration rates.</title>
<p>We report the number of different types of tasks performed by groups of organisms in each treatment, where treatments had different migration rates. The maximum number of different types of tasks that can be performed by a group (indicated by a black horizontal line) is 5. The asterisk (*) indicates the Both treatment. As migration rate increased, the number of types of tasks performed by the groups substantially decreased.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0102713.g004" position="float" xlink:type="simple"/></fig></sec><sec id="s3b3">
<title>3. Propagule Size</title>
<p>There are several different methods by which we can generate an offspring group from a parent. These methods include creating a copy of the parent group, mixing individuals from two or more groups, and sampling individuals from a successful group to form the offspring group <xref ref-type="bibr" rid="pone.0102713-Swenson2">[6]</xref>, <xref ref-type="bibr" rid="pone.0102713-Penn1">[41]</xref>–<xref ref-type="bibr" rid="pone.0102713-Williams1">[43]</xref>. In our central experiment, to create a new group, we copied all the digital organisms from a single successful group. However, it is possible that varying how a new group is created may affect the ability of its constituent organisms to coordinate roles and thus to perform division of labor. To ascertain how other approaches to group creation affect division of labor, we performed an additional experiment in which we created new groups by sampling organisms from the original group with replacement. Additionally, we varied the <italic>propagule size</italic>, which is the number of organisms used to seed the new group, from 1 to 25. Groups created with a propagule of size 25 differ from the <monospace>Both</monospace> treatment in our central experiment in that, as a result of sampling, they may not include all participants from the source group.</p>
<p><xref ref-type="fig" rid="pone-0102713-g005">Figure 5</xref> depicts the results of our propagule experiment (see <xref ref-type="table" rid="pone-0102713-t001">Table 1</xref> for summary statistics). At small propagule sample sizes (1–3), group members perform a less diverse suite of tasks (Kruskal-Wallis multiple comparison, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e041" xlink:type="simple"/></inline-formula>). One explanation for this phenomenon is that sampling may select inferior group members for propagation. Once the propagule size increases to 5, however, the number of unique types of tasks evolved is indistinguishable from larger propagule sizes.</p>
<fig id="pone-0102713-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0102713.g005</object-id><label>Figure 5</label><caption>
<title>Varying propagule size.</title>
<p>We report the number of different types of tasks performed by groups of organisms in each treatment, where treatments had different propagule sizes. The maximum number of different types of tasks that can be performed by a group (indicated by a black horizontal line) is 5. The asterisk (*) indicates the <monospace>Both</monospace> treatment. Small propagule sizes (1–3) correspond to a lower diversity of tasks within the group. However, the performance of propagule sizes of 5 or more are not significantly different from each other. Here “S” indicates that propagules were created using sampling with replacement.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0102713.g005" position="float" xlink:type="simple"/></fig>
<p>Overall, these experiments demonstrate that groups of organisms that perform division of labor are able to evolve under a variety of conditions. Such groups of organisms evolve when placed under multilevel selection pressures that range from antagonistic to aligned (see <xref ref-type="supplementary-material" rid="pone.0102713.s008">Text S2</xref> for further details). Additionally, groups of organisms that exhibit division of labor are favored over a broad range of evolutionary parameters, including different inter-tournament period lengths and propagule sizes three or above. However, the amount of division of labor within evolved groups of organisms is substantially less when members migrate between groups.</p>
</sec></sec><sec id="s3c">
<title>What strategies do organisms use to successfully address the antagonistic multilevel selection pressures?</title>
<p>While these results demonstrate that division of labor evolves under a variety of multilevel selection regimes, they tell us little about <italic>how</italic> the organisms acquire their roles given the disparate fitness benefits. Within our experiments, groups initially consisted of genetically-identical organisms, but over time mutations accrued as part of the individual replication process could produce either single or multi-lineage groups. For this portion of the study, we focus on treatments where the mean number of unique tasks exceeds four. First, to determine whether the groups were single-lineage or multi-lineage, we measured genotypic variation within the groups. To do so, we calculated the mean <italic>Levenshtein distance</italic> (i.e., the minimum number of insertions, deletions, and substitutions necessary to convert one genome into another <xref ref-type="bibr" rid="pone.0102713-Levenshtein1">[44]</xref>) of random pairs of organisms within each group. A potentially confounding factor for this analysis was genetic diversity introduced as the result of deleterious mutations (e.g., a mutation that caused task loss) introduced into the genome of offspring organisms. Such genetic diversity is likely not adaptive. To eliminate this effect, prior to calculating the Levenshtein distance, we subjected all of the organisms to a 1,000 update <italic>ecological period</italic> during which no mutations occurred. The ecological period purged the groups of genotypes with lower fitness. During this period, we continued to compete the groups every 100 updates for a total of 10 tournaments.</p>
<p><xref ref-type="table" rid="pone-0102713-t001">Table 1</xref> provides the mean Levenshtein distance and standard error within groups for the various treatments whose performance exceeded four tasks. Based on these data, we make several observations. First, these treatments have produced both single-lineage and multi-lineage groups. The Levenshtein distances vary from a mean of 0.04 (treatment 3-S), which indicates a single-lineage group, to 45.67 (treatment <monospace>Between</monospace>), which indicates a multi-lineage group.</p>
<p>Second, genetic variation is inversely proportional to the inter-tournament period length. Replicates with a tournament length of 50 updates had significantly more genetic variation than replicates with tournament lengths of 250 (Kruskal-Wallis multiple comparison, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e042" xlink:type="simple"/></inline-formula>). These data suggest that decreasing the between-group selective pressure by extending the duration of the tournament not only reduces the number of distinct types of tasks performed by group members, but also reduces the amount of genetic variation present.</p>
<p>Third, larger propagule sizes increase the amount of genetic diversity present within groups without decreasing overall number of types of tasks performed by members of the groups. Groups of organisms evolved with small propagule sizes adopted single-lineage strategies, whereas groups of organisms evolved with larger propagule sizes exhibited strategies that relied on genetic diversity (e.g., the Levenshtein distance for a sampled propagule of size 3 is 0.04<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e043" xlink:type="simple"/></inline-formula>0.12 compared to 15.30<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e044" xlink:type="simple"/></inline-formula>4.11 for a propagule of size 25). We further explored these results by analyzing the number of types of tasks performed and genetic diversity of individual replicates within the treatments. We consider a replicate to be genetically heterogeneous if it had a Levenschtein distance greater than 25. (The ancestor organisms were 100 instructions long, thus a Levenschtein distance of 25 means that on average approximately 25% of the genomes differ.) For these treatments, only <monospace>15-S</monospace>, <monospace>25-S</monospace>, and <monospace>25</monospace> contained replicates that were genetically heterogeneous. This result strongly supports the observation that only replicates with larger propagule sizes exhibited strategies that relied upon genetic diversity. Intuitively, this is to be expected because organisms within a group with a small propagule size could not rely on representatives of each lineage to be copied during a group replication event. Within the three treatments that had replicates that exhibited both single lineage and multi-lineage strategies, the amount of division of labor exhibited by the replicates that used single-lineage strategies exceeded that of the replicates that used multi-lineage strategies. The mean amount of division of labor (number of different types of tasks performed) for the multi-lineage replicates were: 4.22<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e045" xlink:type="simple"/></inline-formula>0.16 for <monospace>15-S</monospace>, 4.30<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e046" xlink:type="simple"/></inline-formula>0.02 for <monospace>25-S</monospace>, and 4.33<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e047" xlink:type="simple"/></inline-formula>0.16 for <monospace>25</monospace>. In contrast, for the single-lineage replicates, they were: 4.56<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e048" xlink:type="simple"/></inline-formula>0.08 for <monospace>15-S</monospace>, 4.61<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e049" xlink:type="simple"/></inline-formula>0.05 for <monospace>25-S</monospace>, and 4.60<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e050" xlink:type="simple"/></inline-formula>0.04 for <monospace>25</monospace>.</p>
<p>A second effect captured within these results is how sampling affects genetic diversity. In the original Both treatment, all group members were copied. This treatment (<monospace>25*</monospace>) has the highest amount of genetic diversity, which surpasses that of a propagule size of <monospace>25</monospace> created by sampling from the original group (<monospace>25-S</monospace>). This result indicates that, similar to smaller propagule sizes, sampling reduces reliance on multi-lineage strategies, since it decreases the probability that a member from each lineage will be selected as part of the propagule.</p>
<p>Finally, upon closer examination, we noted that the Levenshtein distance of the replicates for the <monospace>Both</monospace> treatment indicated a bifurcated strategy: The genetic variation of some replicates collapsed to negligible amounts, whereas the genetic variation of other replicates remained quite high. A <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e051" xlink:type="simple"/></inline-formula>-means clustering of Levenshtein distances revealed that 18 replicates were clustered into a group with a mean distance of 4.214 instructions, 11 replicates were clustered into a group with a mean of 33.060 instructions, and 1 replicate, an outlier, had a distance of 399.937 instructions. Some replicates exhibited a wide-range of tasks within the context of single-lineage groups, whereas other replicates maintained multi-lineage groups.</p>
<p>These results demonstrate the ability of Avida to evolve strategies that reflect those commonly observed in nature. Moreover, they highlight the benefit of the open-ended approach to studying this question. The experimental design is such that, depending on the balance of pressures, either a single-lineage or a multi-lineage strategy may emerge.</p>
</sec><sec id="s3d">
<title>What mechanisms are used by organisms to preserve diversity within groups?</title>
<p>In this study, groups maintained two forms of diversity. First, both single and multi-lineage groups maintained phenotypic diversity, in that the organisms performed a diverse suite of tasks. Second, multi-lineage groups also maintained genotypic diversity. Here we investigate the strategies used by groups to maintain both forms of diversity.</p>
<sec id="s3d1">
<title>Phenotypic diversity</title>
<p>For both single-lineage and multi-lineage strategies, organisms evolved to coordinate roles and maintain phenotypic diversity. Within single-lineage groups, such mechanisms were critical for organisms to differentiate roles and thus achieve division of labor. Evolved mechanisms could rely on either stochasticity or phenotypic plasticity. Previous studies using Avida have demonstrated the ability of organisms to evolve phenotypic plasticity <xref ref-type="bibr" rid="pone.0102713-Clune1">[33]</xref> using either environmental inputs or execution flow to differentiate, so the underlying mechanism can clearly be evolved by the organisms.</p>
<p>Organisms were provided with several coordination instructions that, in principle, could be used to differentiate roles. To understand how the emergent behavior of a group of organisms is influenced by the instructions within its constituent genomes, we conducted <italic>knockout analyses</italic>, where we replaced one or more instructions in all of the genomes in a group with a neutral instruction. We then subjected the organisms to an ecological period and monitored their behavior. If the group members performed fewer types of tasks when a coordination instruction was removed, then we can conclude that the knocked-out instruction contributed to the division of labor exhibited by the group.</p>
<p>We performed three different sets of knockout analyses: (1) Knockouts of location-sensing capabilities (i.e., the <monospace>get-cell-xy </monospace>instruction); (2) Knockouts of messaging capabilities (i.e., the <monospace>retrieve-msg </monospace>instruction); and (3) Knockouts of the epigenetic information capability (i.e., the <monospace>get-epigenetic </monospace>instruction). For the control treatments, which underwent an ecological period, but did not experience any knockouts, the median number of types of tasks performed was 5 (the maximum) and the mean was 4.500. When we knocked out the ability to communicate using messaging, the median number of types of tasks performed remained at 5 and the mean dropped only slightly to 4.467, indicating that most of the organisms were not using messaging. When we knocked out location-sensing information, the median number of types of tasks performed dropped to 4 and the mean was 4.003, indicating that the organisms were making limited use of location information to coordinate roles. However, when we knocked out epigenetic information, the median number of types of tasks performed dropped to 3 with a mean of 3.2, thus indicating the organisms were making use of epigenetic information to coordinate roles.</p>
<p>In further analyses of the strategies employed by members of multi-lineage groups (<xref ref-type="supplementary-material" rid="pone.0102713.s009">Text S3</xref> and <xref ref-type="supplementary-material" rid="pone.0102713.s004">Figures S4</xref> and <xref ref-type="supplementary-material" rid="pone.0102713.s005">S5</xref>) and single-lineage groups (<xref ref-type="supplementary-material" rid="pone.0102713.s010">Text S4</xref>), we confirmed that organisms used epigenetic information to differentiate roles by passing values from parent to offspring that were used in subsequent computations. This behavior is similar to cellular differentiation in which parent cells pass state information to offspring cells, which they use to become increasingly specialized over time <xref ref-type="bibr" rid="pone.0102713-Jablonka1">[45]</xref>. Within a multi-lineage group, each lineage may perform multiple tasks using epigenetic information. However, in general, it is the case that different lineages perform different subsets of tasks. Thus, within these groups, all lineages must be present to perform the full suite of tasks. One question that arises is how do lineages that perform more highly-rewarded tasks avoid replicating over other lineages? In other words, how is genetic diversity sustained within multi-lineage groups?</p>
</sec><sec id="s3d2">
<title>Genetic diversity</title>
<p>To understand how genetic diversity is maintained, we examine the behavior of groups of organisms evolved as part of the <monospace>Both</monospace> treatment. To maintain genetic variation within a group, organisms with different lineages must balance their rate of replication. If the rates of replication were greatly disparate, organisms within the most successful lineage would fix within the group, thus decreasing genetic diversity and the amount of division of labor exhibited by the group.</p>
<p>In Avida, an organism's rate of replication, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e052" xlink:type="simple"/></inline-formula>, is defined as: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e053" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e054" xlink:type="simple"/></inline-formula> is metabolic rate and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e055" xlink:type="simple"/></inline-formula> is gestation investment. The metabolic rate of a digital organism defines the number of virtual CPU cycles it is allocated per unit time, and is modified by the rewards of any tasks that the organism performs. An organism's <italic>gestation investment</italic> is the number of virtual CPU cycles that are expended to produce an offspring. The primary factor that affect an organism's gestation investment is the efficiency of replication (i.e., how many cycles it takes to produce an offspring). A genotype's rate of replication is considered to be the mean rate of replication of all the organisms that share that genotype.</p>
<p>As a first step, we verified that <italic>genotypes</italic> present within the same group had similar rates of replication. To perform this measurement, we selected the group from each replicate that exhibited the greatest amount of division of labor after being subjected to an ecological period of 1,000 updates. The variance in the replication rate of genotypes within groups is significantly smaller than the variance in the replication rate of genotypes among groups (permutation test using Anova F-statistic, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e056" xlink:type="simple"/></inline-formula>). This result is consistent with the idea that the organisms are indeed evolving to equalize rates of replication among genotypes present within each group.</p>
<p>Thus far, we have confirmed that genotypes present within the same group share similar rates of replication. Additionally, we know that organisms within the group have different metabolic rates because they are performing different tasks. If organisms within a group are in fact balancing their respective replication rates, then we would expect to see a positive relationship between gestational investment and metabolic rate for <italic>organisms</italic> in the same group. To address this prediction, we recorded the gestational investment and metabolic rate of every organism in each sampled group over a period of 100 updates. We find that the slope of the least squares line for the (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e057" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e058" xlink:type="simple"/></inline-formula>) data of organisms within each group is always positive. One concern is that there may be a system-level constraint within Avida that forces all (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e059" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e060" xlink:type="simple"/></inline-formula>) pairs to have the same relationship. To test whether the slope of this relationship varied among groups, we permuted the group membership of the organisms and recorded the sum of squares for the least squares linear fit for each group and summed this metric across groups. For all 1000 permutations, the total sum of squares was higher than that of the original data, suggesting that the null hypothesis that all groups have the same relationship between gestational investment and metabolic rate can be rejected. Consistent with the previous permutation test, this one also suggests that the balancing of replication rates is occurring within each group independently and does not reflect an inherent constraint of Avida.</p>
<p>To further establish that the relationship between gestational investment and merit did not result from an artifact of Avida, we also examined how the relationship degraded when the between-group pressure was removed. Specifically, for each selected group, we filled a population with copies of the same group. We ran this population for an additional 10,000 update period without the between-group pressure, but with mutations. After that, for a 100 update period, we recorded the gestational investment and metabolic rate of every organism. We compared the metabolic rate to gestational investment ratio of the organisms within the evolved population to those within the original groups. Over 85% of the organisms evolved to exhibit a higher ratio indicating that they were abandoning their balance of metabolic rate and gestational investment to become more fit. These data are evidence that the multilevel selection pressures, rather than an artifact of Avida, produce the positive covariance between gestational investment and metabolic rate. By balancing these factors, different genotypes within the same group maintain similar replication rates and thus avoid eliminating one another.</p>
</sec></sec></sec><sec id="s4">
<title>Discussion</title>
<p>We have explored the evolution of organisms that experience multilevel selection pressures. We investigated a continuum of within-group and between-group pressures and demonstrated that it is possible to evolve groups of organisms that exhibit division of labor even when the within-group pressure to perform a highly-rewarded task counters the between-group pressure to perform a diversity of tasks. Additionally, we have explored how the performance of these groups of organisms is affected by the duration between group competitions (inter-tournament period length), migration rate, and method by which the groups are formed. From the multilevel perspective, these factors affect group homogeneity, thus affecting the balance of power between the within-group pressure and between-group pressure. From the inclusive fitness perspective, these factors affect the coefficient of relatedness among individuals within a group. We found that the amount of division of labor exhibited by groups of organisms was robust to various inter-tournament period lengths and propagule sizes over 3. However, even a small amount of migration substantially decreases the amount of division of labor exhibited by the groups.</p>
<p>Next we examined the mechanisms by which tasks were allocated among organisms within successful groups, in particular, how some members came to perform less rewarded roles. The groups of organisms exhibited both single-lineage and multi-lineage strategies. Organisms within both single-lineage and multi-lineage groups used phenotypic plasticity to differentiate roles. Additionally, within multi-lineage groups, mutualistic lineages balanced their fecundity to avoid replicating over one another.</p>
<p>Major transitions in evolution occur when formerly distinct individuals form a higher-level unit that functions as a single reproductive entity <xref ref-type="bibr" rid="pone.0102713-MaynardSmith1">[46]</xref>. These transitions can be <italic>fraternal</italic>, where genetically similar individuals (i.e., close kin) differentiate to perform various tasks, or <italic>egalitarian</italic> in which formerly distinct organisms create a super-organism that replicates all of its genetic material <xref ref-type="bibr" rid="pone.0102713-Queller1">[9]</xref>, <xref ref-type="bibr" rid="pone.0102713-Queller3">[47]</xref>. For example, fraternal transitions include single cells transitioning into multicellular organisms and solitary insects transitioning into eusocial colonies; egalitarian transitions include the “eukaryotic alliance between a host cell and its mitochondria” <xref ref-type="bibr" rid="pone.0102713-Queller1">[9]</xref>. These transitions raise evolutionary questions regarding why formerly distinct individuals would cooperate with others and, once they did, how this arrangement persisted. Groups formed via fraternal and egalitarian transitions exhibit division of labor, where individuals within the groups perform different associated roles. Within our current experiments, we have observed groups of organisms evolving strategies that parallel the end results of the two types of transitions. Specifically, some groups of organisms evolved single lineage strategies in which genetic diversity was low and others evolved multi-lineage strategies with greater degrees of genetic diversity.</p>
<p>Fraternal and egalitarian major transitions must both address two central challenges: (1) the origination of differentiated roles, and (2) the persistence of the higher-level entity in light of cheaters occurring at the lower-level <xref ref-type="bibr" rid="pone.0102713-Queller1">[9]</xref>, <xref ref-type="bibr" rid="pone.0102713-Kerr1">[ 48]</xref>. For egalitarian transitions, the second challenge poses a significant problem. This defector behavior compromises the success and survival of the group as a whole. As a result, groups that undergo egalitarian transitions must evolve mechanisms that prevent cheaters. Within this study, groups of organisms that evolved a multi-lineage solution to the problem faced the same challenge – to ensure continued group success, they needed to evolve a mechanism for preventing cheaters. Our analyses revealed the groups of organisms evolved to accomplish this objective by carefully balancing the average replication rate of genotypes to ensure rate of replication equity among the lineages within the group. These results highlight the potential for digital evolution experiments to address core evolutionary questions surrounding the major transitions in evolution.</p>
</sec><sec id="s5" sec-type="materials|methods">
<title>Materials and Methods</title>
<p>All experiments were conducted using the Avida digital evolution platform <xref ref-type="bibr" rid="pone.0102713-Ofria1">[27]</xref>, using the deme-based grouping system. For our experiments, an Avida world consisted of 400 groups, where each group could contain up to 25 organisms. Each organism competed with others within its group for space – i.e., when an organism replicated, it replaced another organism within the group. Groups of organisms also competed for space in tournaments that occurred, in general, every 100 updates. When between-group selection occurs, tournament winners are chosen based on the range of tasks performed by organisms in the group. When between-group selection pressures are not used, tournament winners are selected at random. When we apply within-group selection pressures, the five different logic tasks are associated with varying rewards that affect the rate at which an organism reproduces within the group. Otherwise, all tasks are rewarded equally at the mean reward amount (2.8) and thus different task performance does not affect the reproductive rate of individual organisms. To study the effect of these pressures, we define four treatments: <monospace>Within</monospace>, which includes within-group pressures only; <monospace>Between</monospace>, which includes between-group pressures; <monospace>Both</monospace>, which includes both within- and between-group pressures; and <monospace>None</monospace>, a treatment that includes neither within nor between-group pressures (a control).</p>
<p>Relevant parameters for our experiments are summarized in <xref ref-type="table" rid="pone-0102713-t002">Table 2</xref>. We initialized each replicate with 400 groups of digital organisms, where each group comprised 25 copies of the ancestor organism. The ancestor organism did not perform any tasks; it contains only the 12 instructions required for self-replication and 88 <monospace>nop-C</monospace> instructions, which perform no computation, but provide ample targets for mutation. In all cases, each treatment was replicated 30 times.</p>
<table-wrap id="pone-0102713-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0102713.t002</object-id><label>Table 2</label><caption>
<title>Common Avida configurations used for this study.</title>
</caption><alternatives><graphic id="pone-0102713-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0102713.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Configuration</td>
<td align="left" rowspan="1" colspan="1">Value</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Replicates per treatment</td>
<td align="left" rowspan="1" colspan="1">30</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Max. population size</td>
<td align="left" rowspan="1" colspan="1">10,000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Number of groups</td>
<td align="left" rowspan="1" colspan="1">400, each a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e061" xlink:type="simple"/></inline-formula> toroidal grid</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Inter-tournament period length</td>
<td align="left" rowspan="1" colspan="1">100 updates</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Tournament size</td>
<td align="left" rowspan="1" colspan="1">5 groups</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Copy mutation rate</td>
<td align="left" rowspan="1" colspan="1">0.0075 (0.0003) (per instruction)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Insertion mutation rate</td>
<td align="left" rowspan="1" colspan="1">0.05 (0.002) (per replication)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Deletion mutation rate</td>
<td align="left" rowspan="1" colspan="1">0.05 (0.002) (per replication)</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap></sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pone.0102713.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0102713.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Varying tournament size.</bold> The mean number of different types of tasks performed by groups of organisms, where treatments had different tournament competition sizes. The maximum number of different types of tasks that can be performed by a group (indicated by a black horizontal line) is 5. Each treatment included 30 replicates.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0102713.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0102713.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>Varying reward displacement.</bold> Each treatment has a different reward displacement ranging from 1/2 (all tasks are punished) to 4 (all tasks are highly rewarded). The maximum number of different types of tasks that can be performed by a group (indicated by a black horizontal line) is 5. In general, when organisms accrue an individual benefit for performing a task (i.e., the reward is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0102713.e062" xlink:type="simple"/></inline-formula>1), then the groups of organisms perform a greater diversity of types of tasks.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0102713.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0102713.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>Varying reward distribution.</bold> Treatments vary the distribution of the rewards among the five tasks. The maximum number of different types of tasks that can be performed by a group (indicated by a black horizontal line) is 5. In general, varying the distribution does not appreciably affect performance.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0102713.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0102713.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>The first twenty instructions for genotypes A and B.</bold> Visually inspecting the differences between the genomes provides a flavor of the genetic variation present within the group.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0102713.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0102713.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p><bold>A visual depiction of the genotype and phenotypes of the case study.</bold> Each square represents an organism in the group, where the shading represents the genotype and the text describes the task performed. Blank squares are organisms that did not perform a task during the analysis period.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0102713.s006" xlink:href="info:doi/10.1371/journal.pone.0102713.s006" mimetype="application/x-tex" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p><bold>The performance of groups of organisms when competed under inter-tournament competition periods different than the one in which they evolved.</bold> In general, the number of unique tasks performed by group of organisms decreased.</p>
<p>(TEX)</p>
</caption></supplementary-material><supplementary-material id="pone.0102713.s007" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0102713.s007" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Tournament size.</bold> An analysis of the effect of varying tournament competition sizes.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0102713.s008" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0102713.s008" position="float" xlink:type="simple"><label>Text S2</label><caption>
<p><bold>Antagonistic Multilevel Selection Pressures.</bold> Additional experimental results that vary the degree of antagonism between the between-group and within-group pressures.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0102713.s009" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0102713.s009" position="float" xlink:type="simple"><label>Text S3</label><caption>
<p><bold>Multi-Lineage Group Case Study.</bold> An analysis of one highly fit group of organisms that cumulatively perform all five tasks and also exhibit genetic variation.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0102713.s010" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0102713.s010" position="float" xlink:type="simple"><label>Text S4</label><caption>
<p><bold>Single-Lineage Group Case Study.</bold> An analysis of one highly fit group of organisms that cumulatively perform all five tasks, but all share the same genotype.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank the Digital Evolution Laboratory, the Kerr Laboratory, and members of the BEACON Center for comments on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0102713-Darwin1"><label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">Darwin C (1859) On the origin of species by means of natural selection.</mixed-citation>
</ref>
<ref id="pone.0102713-Goodnight1"><label>2</label>
<mixed-citation publication-type="other" xlink:type="simple">Goodnight C, Stevens L (1997) Experimental studies of group selection: what do they tell us about group selection in nature? American Naturalist: 59–79.</mixed-citation>
</ref>
<ref id="pone.0102713-Okasha1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Okasha</surname><given-names>S</given-names></name> (<year>2001</year>) <article-title>Why Won't the Group Selection Controversy Go Away?</article-title> <source>The British journal for the philosophy of science</source> <volume>52</volume>: <fpage>25</fpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Wilson1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname><given-names>D</given-names></name> (<year>1983</year>) <article-title>The group selection controversy: history and current status</article-title>. <source>Annual review of ecology and systematics</source> <volume>14</volume>: <fpage>159</fpage>–<lpage>187</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Swenson1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Swenson</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Arendt</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>D</given-names></name> (<year>2000</year>) <article-title>Artificial selection of microbial ecosystems for 3-chloroaniline biodegradation</article-title>. <source>Environmental Microbiology</source> <volume>2</volume>: <fpage>564</fpage>–<lpage>571</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Swenson2"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Swenson</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Elias</surname><given-names>R</given-names></name> (<year>2000</year>) <article-title>Artificial ecosystem selection</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>97</volume>: <fpage>9110</fpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Wade1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wade</surname><given-names>M</given-names></name> (<year>1977</year>) <article-title>An experimental study of group selection</article-title>. <source>Evolution</source> <volume>31</volume>: <fpage>134</fpage>–<lpage>153</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Wade2"><label>8</label>
<mixed-citation publication-type="other" xlink:type="simple">Wade MJ (1980) Group selection, population growth rate, and competitive ability in the flour beetles, tribolium spp. Ecology: 1056–1064.</mixed-citation>
</ref>
<ref id="pone.0102713-Queller1"><label>9</label>
<mixed-citation publication-type="other" xlink:type="simple">Queller DC (1997) Cooperators since life began. Quarterly Review of Biology: 184–188.</mixed-citation>
</ref>
<ref id="pone.0102713-Buss1"><label>10</label>
<mixed-citation publication-type="other" xlink:type="simple">Buss L (1987) The evolution of individuality. Princeton University Press Princeton, New Jersey.</mixed-citation>
</ref>
<ref id="pone.0102713-Crespi1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Crespi</surname><given-names>BJ</given-names></name> (<year>2001</year>) <article-title>The evolution of social behavior in microorganisms</article-title>. <source>Trends in Ecology &amp; Evolution</source> <volume>16</volume>: <fpage>178</fpage>–<lpage>183</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Duffy1"><label>12</label>
<mixed-citation publication-type="other" xlink:type="simple">Duffy JE (2003) The ecology and evolution of eusociality in sponge-dwelling shrimp. In: Genes, Behaviors and Evolution of Social Insects. Hokkaido University Press.</mixed-citation>
</ref>
<ref id="pone.0102713-Jandt1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jandt</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Dornhaus</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Spatial organization and division of labour in the bumblebee bombus impatiens</article-title>. <source>Animal Behavior</source> <volume>77</volume>: <fpage>641</fpage>–<lpage>651</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Queller2"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Queller</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Strassmann</surname><given-names>JE</given-names></name> (<year>2003</year>) <article-title>Eusociality</article-title>. <source>Current Biology</source> <volume>13</volume>: <fpage>R861</fpage>–<lpage>863</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Wilson2"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname><given-names>EO</given-names></name> (<year>1980</year>) <article-title>Caste and Division of Labor in Leaf-Cutter Ants (Hymenoptera: Formicidae: Atta): I. The Overall Pattern in <italic>A. sexdens</italic></article-title>. <source>Behavioral Ecology and Sociobiology</source> <volume>7</volume>: <fpage>143</fpage>–<lpage>156</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Gintis1"><label>16</label>
<mixed-citation publication-type="other" xlink:type="simple">Gintis H, Bowles S, Boyd R, Fehr E (2005) Moral Sentiments and Material Interests: On the Foundations of Cooperation in Economic Life. Cambridge, MA, USA: MIT Press.</mixed-citation>
</ref>
<ref id="pone.0102713-Smith1"><label>17</label>
<mixed-citation publication-type="other" xlink:type="simple">Smith A (1776) The Wealth of Nations.</mixed-citation>
</ref>
<ref id="pone.0102713-Fujii1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fujii</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Bond</surname><given-names>CS</given-names></name>, <name name-style="western"><surname>Small</surname><given-names>ID</given-names></name> (<year>2011</year>) <article-title>Selection patterns on restorer-like genes reveal a conflict between nuclear and mitochondrial genomes throughout angiosperm evolution</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>108</volume>: <fpage>1723</fpage>–<lpage>1728</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Axelrod1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Axelrod</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Axelrod</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Pienta</surname><given-names>KJ</given-names></name> (<year>2006</year>) <article-title>Evolution of cooperation among tumor cells</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>103</volume>: <fpage>13474</fpage>–<lpage>13479</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Sundstrm1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sundström</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Boomsma</surname><given-names>JJ</given-names></name> (<year>2001</year>) <article-title>Conflicts and alliances in insect families</article-title>. <source>Heredity</source> <volume>86</volume>: <fpage>515</fpage>–<lpage>521</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Fehr1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fehr</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Fischbacher</surname><given-names>U</given-names></name> (<year>2003</year>) <article-title>The nature of human altruism</article-title>. <source>Nature</source> <volume>425</volume>: <fpage>785</fpage>–<lpage>791</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Traulsen1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Traulsen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Nowak</surname><given-names>M</given-names></name> (<year>2006</year>) <article-title>Evolution of cooperation by multilevel selection</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>103</volume>: <fpage>10952</fpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Sober1"><label>23</label>
<mixed-citation publication-type="other" xlink:type="simple">Sober E, Wilson DS (1998) Unto Others: The Evolution and Psychology of Unselfish Behavior. Harvard University Press.</mixed-citation>
</ref>
<ref id="pone.0102713-Hamilton1"><label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Hamilton WD (1963) The evolution of altruistic behavior. American Naturalist 97.</mixed-citation>
</ref>
<ref id="pone.0102713-Hamilton2"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hamilton</surname><given-names>WD</given-names></name> (<year>1964</year>) <article-title>The genetical evolution of social behaviour. i</article-title>. <source>Journal of theoretical biology</source> <volume>7</volume>: <fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Bourke1"><label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Bourke A (2011) Principles of social evolution. Oxford University Press.</mixed-citation>
</ref>
<ref id="pone.0102713-Ofria1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ofria</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Wilke</surname><given-names>CO</given-names></name> (<year>2004</year>) <article-title>Avida: A software platform for research in computational evolutionary biology</article-title>. <source>Journal of Artificial Life</source> <volume>10</volume>: <fpage>191</fpage>–<lpage>229</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Lenski1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lenski</surname><given-names>RE</given-names></name>, <name name-style="western"><surname>Ofria</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Pennock</surname><given-names>RT</given-names></name>, <name name-style="western"><surname>Adami</surname><given-names>C</given-names></name> (<year>2003</year>) <article-title>The evolutionary origin of complex features</article-title>. <source>Nature</source> <volume>423</volume>: <fpage>139</fpage>–<lpage>144</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Ofria2"><label>29</label>
<mixed-citation publication-type="other" xlink:type="simple">Ofria C, Adami C (1999) Evolution of genetic organization in digital organisms. In: Proceedings of DIMACS Workshop on Evolution as Computation.</mixed-citation>
</ref>
<ref id="pone.0102713-Knoester1"><label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Knoester DB, McKinley PK (2009) Evolution of probabilistic consensus in digital organisms. In: Self-Adaptive and Self-Organizing Systems, 2009. SASO'09. Third IEEE International Conference on. IEEE, pp. 223–232.</mixed-citation>
</ref>
<ref id="pone.0102713-Knoester2"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Knoester</surname><given-names>D</given-names></name>, <name name-style="western"><surname>McKinley</surname><given-names>P</given-names></name> (<year>2011</year>) <article-title>Evolution of synchronization and desynchronization in digital organisms</article-title>. <source>Artificial life</source> <volume>17</volume>: <fpage>1</fpage>–<lpage>20</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Goings1"><label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Goings S, Clune J, Ofria C, Pennock R (2004) Kin selection: The rise and fall of kin-cheaters. In: Ninth International Conference on Artificial Life. Boston MA, pp. 303–308.</mixed-citation>
</ref>
<ref id="pone.0102713-Clune1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clune</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Goldsby</surname><given-names>HJ</given-names></name>, <name name-style="western"><surname>Ofria</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Pennock</surname><given-names>RT</given-names></name> (<year>2011</year>) <article-title>Selective pressures for accurate altruism targeting: Evidence from digital evolution for difficult-to-test aspects of inclusive fitness theory</article-title>. <source>Royal Society B</source> <volume>278</volume>: <fpage>666</fpage>–<lpage>674</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Johnson1"><label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Johnson AE, Goldsby HJ, Goings S, Ofria C (2014) Exploring the evolution of kin inclusivity using digital organisms. In: Proceedings of the Genetic and Evolutionary Computation Conference (GECCO).</mixed-citation>
</ref>
<ref id="pone.0102713-Johnson2"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Johnson</surname><given-names>AE</given-names></name>, <name name-style="western"><surname>Strauss</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Pickett</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Adami</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Dworkin</surname><given-names>I</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>More bang for your buck: Quorum-sensing capabilities improve the efficacy of suicidal altruism</article-title>. <source>Artificial Life</source> <volume>14</volume>: <fpage>120</fpage>–<lpage>128</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Goldsby1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goldsby</surname><given-names>HJ</given-names></name>, <name name-style="western"><surname>Dornhaus</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kerr</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Ofria</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>Task-switching costs promote the evolution of division of labor and shifts in individuality</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>109</volume>: <fpage>13686</fpage>–<lpage>13691</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Goldsby2"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goldsby</surname><given-names>HJ</given-names></name>, <name name-style="western"><surname>Knoester</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Ofria</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Kerr</surname><given-names>B</given-names></name> (<year>2014</year>) <article-title>The evolutionary origin of somatic cells under the dirty work hypothesis</article-title>. <source>PLoS biology</source> <volume>12</volume>: <fpage>e1001858</fpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Goldsby3"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goldsby</surname><given-names>HJ</given-names></name>, <name name-style="western"><surname>Serra</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Dyer</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Kerr</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Ofria</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>The evolution of temporal polyethism</article-title>. <source>Artificial Life</source> <volume>13</volume>: <fpage>178</fpage>–<lpage>185</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Ofria3"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ofria</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Adami</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Collier</surname><given-names>TC</given-names></name> (<year>2002</year>) <article-title>Design of evolvable computer languages</article-title>. <source>IEEE Transactions in Evolutionary Computation</source> <volume>6</volume>: <fpage>420</fpage>–<lpage>424</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-McKinley1"><label>40</label>
<mixed-citation publication-type="other" xlink:type="simple">McKinley PK, Cheng BHC, Ofria C, Knoester DB, Beckmann B, <etal>et al</etal>.. (2008) Harnessing digital evolution. IEEE Computer 41.</mixed-citation>
</ref>
<ref id="pone.0102713-Penn1"><label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Penn A (2003) Modelling artificial ecosystem selection: A preliminary investigation. Advances in Artificial Life: 659–666.</mixed-citation>
</ref>
<ref id="pone.0102713-Penn2"><label>42</label>
<mixed-citation publication-type="other" xlink:type="simple">Penn A, Harvey I (2004) The role of non-genetic change in the heritability, variation, and response to selection of artificially selected ecosystems. In: Artificial life IX: proceedings of the Ninth International Conference on the Simulation and Synthesis of Artificial Life. The MIT Press, p. 352.</mixed-citation>
</ref>
<ref id="pone.0102713-Williams1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Williams</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lenton</surname><given-names>T</given-names></name> (<year>2007</year>) <article-title>Artificial selection of simulated microbial ecosystems</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>104</volume>: <fpage>8918</fpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Levenshtein1"><label>44</label>
<mixed-citation publication-type="other" xlink:type="simple">Levenshtein VI (1966) Binary codes capable of correcting deletions, insertions, and reversals. Soviet Physics Doklady 10.</mixed-citation>
</ref>
<ref id="pone.0102713-Jablonka1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jablonka</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Raz</surname><given-names>G</given-names></name> (<year>2009</year>) <article-title>Transgenerational epigenetic inheritance: Prevalence, mechanisms, and implications for the study of heredity and evolution</article-title>. <source>The Quarterly Review of Biology</source> <volume>84</volume>: <fpage>131</fpage>–<lpage>176</lpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-MaynardSmith1"><label>46</label>
<mixed-citation publication-type="other" xlink:type="simple">Maynard Smith J, Szathmáry E (1997) The major transitions in evolution. New York, NY, USA: Oxford University Press.</mixed-citation>
</ref>
<ref id="pone.0102713-Queller3"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Queller</surname><given-names>DC</given-names></name> (<year>2000</year>) <article-title>Relatedness and the fraternal major transitions</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>355</volume>: <fpage>1647</fpage>.</mixed-citation>
</ref>
<ref id="pone.0102713-Kerr1"><label>48</label>
<mixed-citation publication-type="other" xlink:type="simple">Kerr B, Nahum J (2011) Setting the stage for an egalitarian major transition: The evolution of restraint. In: The Major Transitions Revisited: The Evolution of Individuality.</mixed-citation>
</ref>
</ref-list></back>
</article>