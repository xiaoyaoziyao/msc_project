<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0204714</article-id>
<article-id pub-id-type="publisher-id">PONE-D-18-26285</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Plant science</subject><subj-group><subject>Plant anatomy</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Plant science</subject><subj-group><subject>Plant anatomy</subject><subj-group><subject>Leaves</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Paleontology</subject><subj-group><subject>Paleobiology</subject><subj-group><subject>Paleobotany</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Paleontology</subject><subj-group><subject>Paleobiology</subject><subj-group><subject>Paleobotany</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Paleontology</subject><subj-group><subject>Paleobotany</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Paleontology</subject><subj-group><subject>Paleobotany</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Plants</subject><subj-group><subject>Flowering plants</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Paleontology</subject><subj-group><subject>Fossils</subject><subj-group><subject>Plant fossils</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Paleontology</subject><subj-group><subject>Fossils</subject><subj-group><subject>Plant fossils</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Software engineering</subject><subj-group><subject>Preprocessing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Software engineering</subject><subj-group><subject>Preprocessing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Machine learning</subject><subj-group><subject>Support vector machines</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Plant leaf tooth feature extraction</article-title>
<alt-title alt-title-type="running-head">Plant leaf tooth feature extraction</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6558-847X</contrib-id>
<name name-style="western">
<surname>Wang</surname>
<given-names>Hu</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Tian</surname>
<given-names>Di</given-names>
</name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Li</surname>
<given-names>Chu</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Tian</surname>
<given-names>Yan</given-names>
</name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zhou</surname>
<given-names>Haoyu</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>China Shipbuilding Industry Corporation, No. 722 Research Institute, Wuhan, Peoples Republic of China</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Faculty of Information Science and Technology, Wenhua College, Wuhan, Peoples Republic of China</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Electrical and Information Engineering Department, Huazhong University of Science and Technology, Wuhan, Peoples Republic of China</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Jiang</surname>
<given-names>Yi</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Georgia State University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The work was supported by China Shipbuilding Industry Corporation, no. 722 Research Institute. HW, CL and HZ are employed by China Shipbuilding Industry Corporation. There are no patents, products in development or marketed products to declare. This does not alter our adherence to all the PLOS ONE policies on sharing data and materials.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">tiandi_2015@foxmail.com</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>13</day>
<month>2</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<year>2019</year>
</pub-date>
<volume>14</volume>
<issue>2</issue>
<elocation-id>e0204714</elocation-id>
<history>
<date date-type="received">
<day>10</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>10</day>
<month>1</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Wang et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0204714"/>
<abstract>
<p>Leaf tooth can indicate several systematically informative features and is extremely useful for circumscribing fossil leaf taxa. Moreover, it can help discriminate species or even higher taxa accurately. Previous studies extract features that are not strictly defined in botany; therefore, a uniform standard to compare the accuracies of various feature extraction methods cannot be used. For efficient and automatic retrieval of plant leaves from a leaf database, in this study, we propose an image-based description and measurement of leaf teeth by referring to the leaf structure classification system in botany. First, image preprocessing is carried out to obtain a binary map of plant leaves. Then, corner detection based on the curvature scale-space (CSS) algorithm is used to extract the inflection point from the edges; next, the leaf tooth apex is extracted by screening the convex points; then, according to the definition of the leaf structure, the characteristics of the leaf teeth are described and measured in terms of number of orders of teeth, tooth spacing, number of teeth, sinus shape, and tooth shape. In this manner, data extracted from the algorithm can not only be used to classify plants, but also provide scientific and standardized data to understand the history of plant evolution. Finally, to verify the effectiveness of the extraction method, we used simple linear discriminant analysis and multiclass support vector machine to classify leaves. The results show that the proposed method achieves high accuracy that is superior to that of other methods.</p>
</abstract>
<funding-group>
<funding-statement>The work was supported by China Shipbuilding Industry Corporation, no. 722 Research Institute. The funder provided support in the form of salaries for authors [WH LC ZHY], but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are articulated in the ‘author contributions’ section.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="8"/>
<page-count count="16"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The minimal data set has been uploaded to Figshare and is available at the following link: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/60d984461451a0c69e8e" xlink:type="simple">https://figshare.com/s/60d984461451a0c69e8e</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The potential value of leaf structure research in plant systematics, conservation biology, paleobotany, ecology, and paleoecology has begun to attract attention [<xref ref-type="bibr" rid="pone.0204714.ref001">1</xref>]. Generally, leaf structure allows closely related taxa to be distinguished from one another [<xref ref-type="bibr" rid="pone.0204714.ref002">2</xref>][<xref ref-type="bibr" rid="pone.0204714.ref003">3</xref>][<xref ref-type="bibr" rid="pone.0204714.ref004">4</xref>]. Moreover, it is found that the leaf architectural characteristics within the framework of molecular phylogenetic analysis can further highlight some evolutionary trends across angiosperms [<xref ref-type="bibr" rid="pone.0204714.ref005">5</xref>]. According to the biological characteristics of plant leaves, leaf structure has been examined and refined, and a relatively complete leaf structure system has been formed. In 2012, the Manual of Leaf Architecture provided a clearly defined and legendary terminology system for related research that could support wider use of leaf structure characters [<xref ref-type="bibr" rid="pone.0204714.ref006">6</xref>]. As one of the characteristics of plant leaves, leaf tooth is an important basis for the classification of plant leaf structure. A leaf tooth contains many characteristics of plant systematics and are extremely useful for circumscribing fossil leaf taxa [<xref ref-type="bibr" rid="pone.0204714.ref005">5</xref>][<xref ref-type="bibr" rid="pone.0204714.ref007">7</xref>][<xref ref-type="bibr" rid="pone.0204714.ref008">8</xref>]. Their prevalence in fossil floras provides reliable proxy data about pre-Quaternary terrestrial paleotemperatures [<xref ref-type="bibr" rid="pone.0204714.ref009">9</xref>][<xref ref-type="bibr" rid="pone.0204714.ref010">10</xref>][<xref ref-type="bibr" rid="pone.0204714.ref011">11</xref>]. Early studies have shown that species in colder regions have more leaf teeth, while plant species in warmer regions have smoother leaf edges and fewer leaf teeth [<xref ref-type="bibr" rid="pone.0204714.ref012">12</xref>–<xref ref-type="bibr" rid="pone.0204714.ref015">15</xref>]. For leaf specimens with intact leaf margins, the leaf features extracted in this study can be used as a “thermometer” to help simulate past climate [<xref ref-type="bibr" rid="pone.0204714.ref010">10</xref>][<xref ref-type="bibr" rid="pone.0204714.ref016">16</xref>].</p>
<p>Research on leaf features is basically divided into two categories: leaf shape and leaf margin (leaf edges). In a study on leaf shape, Xiaofeng et al. used Hu geometric moment and Zernike vertical distance to measure the shape of an input leaf image for automatic leaf classification [<xref ref-type="bibr" rid="pone.0204714.ref017">17</xref>]; Du et al. extracted eight characteristics such as the aspect ratio, rectangular and convex area of the leaf, convex perimeter ratio, sphericity, roundness, eccentricity, and shape factor [<xref ref-type="bibr" rid="pone.0204714.ref018">18</xref>]. In a study on leaf edge, Zheng et al. extracted the leaf edge by using the Harris and SUSAN algorithm and calculated three characteristic parameters: leaf edge sawtooth number, sharpness, and skewness [<xref ref-type="bibr" rid="pone.0204714.ref019">19</xref>]; Corney automatically acquired the shape and size of the leaf tooth by identifying the tooth on the leaf edge [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]; Jin proposed a method for classifying plant leaves using the sparse matrix of leaf tooth features [<xref ref-type="bibr" rid="pone.0204714.ref021">21</xref>]; Chen used the ratio between the internal distance of the leaf and the Euclidean distance to represent the local concavity and convexity of leaves [<xref ref-type="bibr" rid="pone.0204714.ref022">22</xref>], and classified the whole edge, tooth edge, wave edge, and leaf crack edge; Li used data dimensionality and character weighted semi-supervised clustering algorithm to identify the leaf by synthesizing leaf shape, leaf edge, texture, and other characteristics, which could be used for several applications [<xref ref-type="bibr" rid="pone.0204714.ref023">23</xref>]. In addition, several scholars have studied the extraction and classification of the non-botanical characteristics of leaves. Rahmani et al. studied the distance between the center of mass and the contour of the leaf margin and the texture features of the leaves. Then, they used a KNN classifier to classify the features of 1600 samples, with good accuracy [<xref ref-type="bibr" rid="pone.0204714.ref024">24</xref>]. Tsolaidis et al. extracted the features of the HOG and Zernike moments of 40 leaf samples from the Flavia and Swedish datasets, and classified the leaves with the extracted features using SVM. They achieved good results [<xref ref-type="bibr" rid="pone.0204714.ref025">25</xref>].</p>
<p>It should be noted that most of the extracted features are not strictly defined in botany, resulting in the inability to adopt a uniform standard to compare the accuracies of various feature extraction methods. In contrast to existing methods, in this study, the leaf tooth characteristics of plants are described and measured as per the botanical definition in the Manual of Leaf Architecture to provide reliable and effective features for automatic classification of plants. The basic process of the algorithm in this study is as follows: first, the leaf image is preprocessed to perform smoothing and denoising to obtain a better target image. Next, the curvature scale-space (CSS) [<xref ref-type="bibr" rid="pone.0204714.ref026">26</xref>] algorithm is used to extract the teeth. Based on this procedure, a method for detecting the edge of a leaf is proposed, and features such as number of orders of teeth, tooth spacing, number of teeth, sinus shape, and tooth shape are extracted according to their definition in the Manual of Leaf Architecture. The features are also extracted one by one. The data obtained through the algorithm can not only be used to classify plants, but also provide scientific and standardized data to determine the history of plant evolution.</p>
</sec>
<sec id="sec002">
<title>Proposed framework</title>
<p>The proposed algorithm framework presented in <xref ref-type="fig" rid="pone.0204714.g001">Fig 1</xref> was used to extract the leaf tooth features based on the image in this study.</p>
<fig id="pone.0204714.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Block diagram of proposed framework for leaf tooth feature extraction.</title>
<p><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.17504/protocols.io.wrxfd7n" xlink:type="simple">http://dx.doi.org/10.17504/protocols.io.wrxfd7n</ext-link> [PROTOCOL DOI].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.g001" xlink:type="simple"/>
</fig>
<p>As shown in <xref ref-type="fig" rid="pone.0204714.g001">Fig 1</xref>, the overall algorithm framework is divided into three parts: preprocessing, corner detection, and leaf tooth feature extraction. Preprocessing is employed to obtain the binary image of the leaf, which includes image graying, image segmentation, and image smoothing. Corner detection is used to extract the key points (the leaf tooth convex or concave points) of the leaf edge for description and measurement of the leaf tooth features. Finally, leaf tooth feature extraction is defined according to the Manual of Leaf Architecture, and features such as number of orders of teeth, tooth spacing, number of teeth, sinus shape, and tooth shape of the leaf teeth are extracted. The preprocessing phase is divided into three stages. The techniques involved are described below.</p>
<p>The extraction of the leaf tooth does not depend on the color of the leaf; therefore, the acquired color image is first converted to a grayscale image. The color image has three channels, R, G, and B, while the grayscale image has only one channel. After the image is grayed out, the overall and partial chromaticity and brightness of the image can be better maintained, and the amount of calculation can be drastically reduced. In this study, we use the weighted average method to convert the image to grayscale [<xref ref-type="bibr" rid="pone.0204714.ref027">27</xref>]. The weighted sum of the three channels of color images is expressed as follows:
<disp-formula id="pone.0204714.e001">
<alternatives>
<graphic id="pone.0204714.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0204714.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2pt"/><mml:mo>=</mml:mo><mml:mspace width="2pt"/><mml:mn>0.299</mml:mn><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>0.587</mml:mn><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>0.114</mml:mn><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula></p>
<p>The purpose of image segmentation is to separate the leaves from the background to form a binary image for subsequent calculation of shape and texture characters. Here, the maximum interclass variance method (abbreviated as OTSU) is used to binarize the image [<xref ref-type="bibr" rid="pone.0204714.ref028">28</xref>]. The principle of this method is mainly to distinguish the background and target in the image by the grayscale characteristics of the image, and to calculate the interclass variance of the background and the target. The larger the variance, the greater the discrimination between the background and the target. Therefore, the segmentation with the largest variance between classes has the least probability of resulting in a misclassification.</p>
<p>After the image is binarized, there may be voids and breaks in the image, which may hinder the integrity of leaf extraction. Therefore, closing operations are performed to fill small holes and gaps in the image, and finally the image is smoothed and denoised. The closed operation used in our study is expressed as follows:
<disp-formula id="pone.0204714.e002">
<alternatives>
<graphic id="pone.0204714.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0204714.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:mi>f</mml:mi><mml:mo>·</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>⊕</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⊖</mml:mo><mml:mi>b</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>Here, the radius of the disc structure element b is 2. This parameter was set after comparing the multi-group experimental effects. Using the parameters for closed operation can result in a good filling effect for tiny fractures (the leaf edge will have no obvious distortion), and also good robustness.</p>
<p>In corner detection based on the contour curve, methods based on calculation of the corner intensity are simple, but they are susceptible to noise interference. Methods based on calculation of the extreme curvature of the curve consider the local characteristics of corner points, but do not consider the global characteristics. This can result in the phenomenon of missed detection. To overcome these problems and achieve higher accuracy, a corner detection algorithm based on multiscale curvature space [<xref ref-type="bibr" rid="pone.0204714.ref026">26</xref>] is used to extract the leaf teeth, and a method for detecting the concave and convex points of a leaf edge is proposed based on this. Further, extraction of features including the number of orders of teeth, tooth spacing, number of teeth, sinus shape, and tooth shape of the leaf teeth is implemented according to their definition in the Manual of Leaf Architecture.</p>
</sec>
<sec id="sec003">
<title>Leaf tooth extraction algorithm</title>
<p>As extracting the features of leaf teeth is the main focus of this study, a method of extracting leaf teeth was developed according to the characteristics of plant leaves. Unlike other parts of the leaf, the characteristics of the leaf teeth are reflected in the particularity of the morphological structure, that is, leaf teeth have obvious convex and concave points, which appear as corner points on the image. Therefore, a general grading and stepwise refinement method to extract the leaf teeth can be adopted. First, the corner points (both convex and concave points in the leaf teeth) are extracted from the leaf image, and then the two are further identified according to the different characteristics of convex and concave points. The basic flowchart is shown in <xref ref-type="fig" rid="pone.0204714.g002">Fig 2</xref>.</p>
<fig id="pone.0204714.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Flowchart of the leaf tooth feature extraction scheme.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.g002" xlink:type="simple"/>
</fig>
<sec id="sec004">
<title>Corner detection algorithm based on multiscale curvature space</title>
<p>As mentioned above, as a result of the good performance of the multiscale space corner detection algorithm proposed in [<xref ref-type="bibr" rid="pone.0204714.ref026">26</xref>], it was used for leaf corner detection. The algorithm proceeds as follows: (1) Following preprocessing of the image, the Canny operator is used to extract the leaf edge. (The setting of the two thresholds (H and L) is explained in [<xref ref-type="bibr" rid="pone.0204714.ref029">29</xref>].) (2) After single pixelization of the leaf edges, the open-close situation of the contour curve is judged according to the preset threshold (Gap_size), then periodic convolution smoothing is used for the closed curve, and the open curve is convolved with the Gaussian function with width controlled by <italic>δ</italic>. (3) The curvature of all points on the curve is then calculated, and the point with the maximum local curvature value is defined as the corner candidates. (4) The threshold value C of the round corners removal is adaptively calculated according to the average curvature in the ROS region, and corners with curvature less than C are removed [<xref ref-type="bibr" rid="pone.0204714.ref030">30</xref>]. (5) The angle of the remaining corner candidates is calculated based on the recalculated dynamic support region, and corner candidates with angle smaller than the preset parameter T_angle are removed (removing the false corner). (6) The positions of the corner points are compared with the endpoints of the open curve and, if they are far apart, the endpoints are marked as candidate corners as well. The basic flowchart is shown in <xref ref-type="fig" rid="pone.0204714.g003">Fig 3</xref>.</p>
<fig id="pone.0204714.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Flowchart of the CSS algorithm.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.g003" xlink:type="simple"/>
</fig>
<p>The parameters involved in the extraction of the leaf tooth feature are H, L, Gap_size, C, T_angle, and endpoint. Parameters such as H, L, Gap_size, T_angle, C, and Endpoint directly refer to the relevant parameters in [<xref ref-type="bibr" rid="pone.0204714.ref026">26</xref>] [<xref ref-type="bibr" rid="pone.0204714.ref029">29</xref>–<xref ref-type="bibr" rid="pone.0204714.ref031">31</xref>], where their robustness in the algorithm has been discussed in detail. The values are as follows: C = 1.5; T_angle = 162; sig = 4; H = 0.35; L = 0; Endpoint = 1; and Gap_size = 3. Because the value of threshold <italic>δ</italic> has the greatest influence on the extraction of the leaf teeth using this method, we tested the detection of the leaf teeth for eight types of leaves (as shown in <xref ref-type="fig" rid="pone.0204714.g004">Fig 4</xref>) with threshold values of 2, 4, 5, 6, and 7 (the leaf teeth of a and b are the most dense, whereas those of g and h are the most sparse). See <xref ref-type="table" rid="pone.0204714.t001">Table 1</xref> for details.</p>
<fig id="pone.0204714.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The eight types of leaves.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.g004" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0204714.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.t001</object-id>
<label>Table 1</label> <caption><title>Relationship between the number of extracted leaf teeth and the value of <italic>δ</italic>.</title></caption>
<alternatives>
<graphic id="pone.0204714.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Leaf</th>
<th align="center">A</th>
<th align="center">B</th>
<th align="center">C</th>
<th align="center">D</th>
<th align="center">E</th>
<th align="center">F</th>
<th align="center">G</th>
<th align="center">H</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><italic>δ</italic> <bold>= 2</bold></td>
<td align="center">210</td>
<td align="center">134</td>
<td align="center">93</td>
<td align="center">54</td>
<td align="center">29</td>
<td align="center">34</td>
<td align="center">30</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center"><italic>δ</italic> <bold>= 4</bold></td>
<td align="center">164</td>
<td align="center">115</td>
<td align="center">90</td>
<td align="center">52</td>
<td align="center">31</td>
<td align="center">30</td>
<td align="center">25</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center"><italic>δ</italic> <bold>= 5</bold></td>
<td align="center">135</td>
<td align="center">99</td>
<td align="center">78</td>
<td align="center">43</td>
<td align="center">24</td>
<td align="center">28</td>
<td align="center">25</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center"><italic>δ</italic> <bold>= 6</bold></td>
<td align="center">102</td>
<td align="center">78</td>
<td align="center">67</td>
<td align="center">39</td>
<td align="center">21</td>
<td align="center">25</td>
<td align="center">23</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center"><italic>δ</italic> <bold>= 7</bold></td>
<td align="center">85</td>
<td align="center">68</td>
<td align="center">57</td>
<td align="center">18</td>
<td align="center">19</td>
<td align="center">20</td>
<td align="center">23</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center"><bold>Manual observation</bold></td>
<td align="center">136</td>
<td align="center">104</td>
<td align="center">82</td>
<td align="center">53</td>
<td align="center">36</td>
<td align="center">30</td>
<td align="center">23</td>
<td align="center">6</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>It can be seen from <xref ref-type="table" rid="pone.0204714.t001">Table 1</xref> that the value of <italic>δ</italic> affects the accuracy of leaf tooth extraction. The number of leaf teeth detected by this method decreases as the value of <italic>δ</italic> increases. For different types of leaves, the value of <italic>δ</italic>is different corresponding to the smallest extraction error. For example, leaves a and b with dense teeth have the highest accuracy at <italic>δ</italic> = 5, and leaves g and h with sparse numbers of teeth have the highest accuracy at <italic>δ</italic> = 6. That is, for leaves with dense teeth, the leaf tooth point is captured more accurately when the curvature scale is small, and for leaves with sparse teeth, when the curvature scale is large, a part of the noise can be shielded to obtain a more precise leaf tooth point.</p>
<p>Studies have shown that the number of leaf teeth is related to the climate temperature, and the higher the temperature, the smaller the number of teeth [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]. In actual cases, it is generally easier to obtain information such as the temperature of the test sample growing place. Therefore, this priori information can be used to estimate the range of the number of leaf teeth and set the δ value. The number of teeth of most of the leaves used for testing was distributed between 25 and 90 in experiment 1. To minimize the extraction error of the number of teeth, a value δ = 4 was used in all the experiments presented in this study.</p>
</sec>
<sec id="sec005">
<title>Extraction of convex and concave points of leaf tooth</title>
<p>As for extraction of the concave and convex points of leaf teeth, the most direct method is to use the curvature feature to extract them directly. In this study, a robust extraction method for the concave-convex points of leaf teeth is proposed. The procedure is as follows: first, all the corner points are detected as the candidate points by the multiscale curvature spatial corner detection method introduced in Section 3.1. Second, considering the detected corner points may contain concave points and non-convex non-concave points, the convex points must be detected based on the different characteristics of these three types of points.</p>
<p>The specific detection method of the convex points is as follows:</p>
<list list-type="order">
<list-item><p>Use the CSS algorithm to detect all the corner points of the leaf;</p></list-item>
<list-item><p>With the corner point as the center, set the radius to L, and calculate the number of target points and background points falling in the circle. If the number of target points is less than that of the background points, it is a convex point. As shown in <xref ref-type="fig" rid="pone.0204714.g005">Fig 5A</xref>, P<sub>1</sub> is a convex point, and <xref ref-type="fig" rid="pone.0204714.g005">Fig 5B</xref> is the actual image with convex points calibrated by the algorithm.</p></list-item>
</list>
<p>As shown in <xref ref-type="fig" rid="pone.0204714.g005">Fig 5A</xref>, the method of extracting the leaf tooth concave points is as follows: P<sub>1</sub> and P<sub>2</sub> are two adjacent convex points, the concave point Q will be between the two convex points, and the distance d<sub>max</sub> between Q and the line P<sub>1</sub>P<sub>2</sub> is inevitably greater than the distance d between the other points on the curve between P1 and P2. Therefore, by calculating the distance d from the point on the curve to the straight line determined by the two adjacent convex points, and comparing it, point Q corresponding to the maximum distance d<sub>max</sub> is found to be a concave point.</p>
<fig id="pone.0204714.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Example of convex points calibrated by the algorithm.</title>
<p>(A) Schematic diagram of corner detection of leaf edge. (B) Example of the convex points of the algorithm calibration</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.g005" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec006">
<title>Extraction of leaf tooth features</title>
<p>According to the leaf structure classification system, the characteristics of the leaf teeth can be described by the number of orders of teeth, tooth spacing, number of teeth, sinus shape, and tooth shape. The description and extraction methods of these features will be given one by one.</p>
<sec id="sec007">
<title>Leaf tooth feature description</title>
<list list-type="order">
<list-item><p>The number of orders of teeth is the number of discrete sizes of teeth. Order of one means that all teeth have the same or continuous change in size, as shown in <xref ref-type="fig" rid="pone.0204714.g006">Fig 6A</xref>. Order of two means teeth have two distinct sizes, as shown in <xref ref-type="fig" rid="pone.0204714.g006">Fig 6B</xref>. As the definition of 3rd order teeth in the Manual of Leaf Architecture is ambiguous, 3rd order teeth were not considered in the algorithm in this study.</p></list-item>
</list>
<list list-type="order">
<list-item><p>The tooth spacing refers to the distance between adjacent teeth. Here, we simply perform qualitative analysis, not quantitative analysis; if the minimum intertooth distance &gt; 60% of the maximum intertooth distance [<xref ref-type="bibr" rid="pone.0204714.ref032">32</xref>], the tooth spacing is regular, otherwise it is irregular [<xref ref-type="bibr" rid="pone.0204714.ref006">6</xref>].</p></list-item>
<list-item><p>The number of teeth is the total number of teeth on a leaf.</p></list-item>
<list-item><p>Sinus shape is the shape of a concave edge on the leaf, with angular or rounded shape, as shown in <xref ref-type="fig" rid="pone.0204714.g007">Fig 7</xref>.</p></list-item>
<list-item><p>The tooth shape is the distal and proximal flank curvatures relative to the midline of the tooth. The following states and abbreviations are used: convex (cv), straight (st), concave (cc), flexuous (fl), and retroflexed (rt) [<xref ref-type="bibr" rid="pone.0204714.ref006">6</xref>], as shown in <xref ref-type="fig" rid="pone.0204714.g008">Fig 8</xref>.</p></list-item>
</list>
<fig id="pone.0204714.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Schematic diagram of the orders of leaf tooth.</title>
<p>(A) One order leaf tooth. (B) Two orders leaf tooth</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.g006" xlink:type="simple"/>
</fig>
<fig id="pone.0204714.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Sinus shape.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.g007" xlink:type="simple"/>
</fig>
<fig id="pone.0204714.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Chart of possible tooth shapes.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.g008" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Leaf tooth feature extraction</title>
<p>According to the concave and convex points detection method proposed in Section 3.2 and the definition of leaf tooth feature in Section 4.1, the implementation method for extracting leaf tooth feature, was as follows:</p>
<sec id="sec009">
<title>Number of orders of teeth</title>
<list list-type="order">
<list-item><p>Calculate the distance from the convex point to the line formed by adjacent concave points to indicate the length of the teeth;</p></list-item>
<list-item><p>Normalize the teeth length, that is, divide the distance by the length of the longest tooth in the leaf (after removing abnormal points, which have values greater than twice the mean of the teeth length);</p></list-item>
<list-item><p>After normalization, the number of teeth for which the tooth length is less than the half of the maximum length are counted. If they are greater than half of the total number of leaf teeth, the leaf is considered to have two orders of teeth, otherwise it is considered to have the order of one;</p></list-item>
<list-item><p>If step 3 shows that the leaf has two orders of teeth, it is necessary to distinguish the first-order teeth and the second-order teeth by comparing the teeth length. The length of the first-order leaf teeth is significantly larger than the length of the two adjacent leaf teeth and the second-order teeth do not have this characteristic, the teeth can be distinguished.</p></list-item>
</list>
</sec>
<sec id="sec010">
<title>Tooth spacing</title>
<list list-type="order">
<list-item><p>Calculate the tooth spacing, that is, the distance between adjacent teeth;</p></list-item>
<list-item><p>Compare the minimum intertooth distance d<sub>min</sub> with the maximum intertooth distance d<sub>max</sub>. If d<sub>min</sub>&gt;(d<sub>max</sub>*0.6), the tooth spacing characters is regular; otherwise, it is irregular.</p></list-item>
</list>
</sec>
<sec id="sec011">
<title>Tooth number</title>
<p>Calculate the total number of teeth of a leaf (i.e., the number of convex points using the abovementioned detection method).</p>
</sec>
<sec id="sec012">
<title>Sinus shape</title>
<list list-type="order">
<list-item><p>Calculate the curvature at the concave point of a leaf whose concave shape is rounded;</p></list-item>
<list-item><p>Calculate the curvature at the concave point of a leaf that has an angular concave shape;</p></list-item>
<list-item><p>According to the statistical data in steps 1 and 2, determine the curvature threshold value that distinguishes the angular Sinus and the rounded Sinus. This study calculated the sinuses curvature of many sample leaves (a total of 900 pieces in eight categories from the Swedish Leaf and Flavia datasets), and the mean curvature of all types of leaves, as shown in <xref ref-type="table" rid="pone.0204714.t002">Table 2</xref>. The curvature of rounded sinuses was obtained as 0.009013–0.043190, while that of the angular sinuses was 0.061088–0.087059; hence, the threshold between the two sinus shapes can be set as 0.05, and can be used to determine the sinus shapes of other leaves without requiring alteration or re-training for different datasets.</p></list-item>
</list>
<table-wrap id="pone.0204714.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.t002</object-id>
<label>Table 2</label> <caption><title>Mean curvature of leaves calculated in the sinus shape experiment.</title></caption>
<alternatives>
<graphic id="pone.0204714.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Leaves</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
<th align="center">8</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Means of curvature</td>
<td align="center">0.087059</td>
<td align="center">0.078781</td>
<td align="center">0.065193</td>
<td align="center">0.061088</td>
<td align="center">0.043190</td>
<td align="center">0.025086</td>
<td align="center">0.016129</td>
<td align="center">0.009013</td>
</tr>
<tr>
<td align="center">Sinus shape</td>
<td align="center">Angular</td>
<td align="center">Angular</td>
<td align="center">Angular</td>
<td align="center">Angular</td>
<td align="center">Rounded</td>
<td align="center">Rounded</td>
<td align="center">Rounded</td>
<td align="center">Rounded</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec013">
<title>Tooth shape</title>
<list list-type="order">
<list-item><p>Extract the coordinates of an arc between a concave point and a convex point on the profile curve of the leaf tooth;</p></list-item>
<list-item><p>Fit the coordinates of the quadratic polynomial to obtain the corresponding polynomial;</p></list-item>
<list-item><p>Examine the quadratic parameter of the quadratic polynomial; if the parameter is equal to zero, it is straight; If the parameter is nonzero, the subsequent steps are taken to continue processing.</p></list-item>
<list-item><p>To further distinguish the tooth shape of CV, CC, FL, and RT, we use straight lines to connect the concavo-convex points, and count the number of black and white pixels in the closed area surrounded by the contour of leaf and straight line, and then judge the tooth shape according to the distribution of black and white pixels. As shown in <xref ref-type="fig" rid="pone.0204714.g009">Fig 9</xref>, A is the convex point of the leaf teeth, E is the concave point, and <inline-formula id="pone.0204714.e003"><alternatives><graphic id="pone.0204714.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0204714.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mtext>D</mml:mtext><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="true">⌢</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> is the contour of the leaf, C is the intersection point of line AE and the contour (usually there is only one intersection point at most), B is any point on the curve <inline-formula id="pone.0204714.e004"><alternatives><graphic id="pone.0204714.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0204714.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mo stretchy="true">⌢</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, and D is any point on the curve <inline-formula id="pone.0204714.e005"><alternatives><graphic id="pone.0204714.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0204714.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="true">⌢</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item>
<list-item><p>If point C does not exist, count respectively the number of pixels with values of zero (black) and one (white) in the area of the line AE and the arc <inline-formula id="pone.0204714.e006"><alternatives><graphic id="pone.0204714.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0204714.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="true">⌢</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, and denote them as <italic>n</italic><sub><italic>B</italic></sub> and <italic>n</italic><sub><italic>W</italic></sub> respectively; if <italic>n</italic><sub><italic>B &gt;</italic></sub> <italic>n</italic><sub><italic>D</italic></sub>, the leaf tooth shape is CV; otherwise, it is CC.</p></list-item>
<list-item><p>If point C exists, count respectively the number of pixels with values of zero (black) and one (white) in the area (P) of the line AC and the arc <inline-formula id="pone.0204714.e007"><alternatives><graphic id="pone.0204714.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0204714.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mtext>D</mml:mtext><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="true">⌢</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, and denote them respectively as <italic>n</italic><sub><italic>BB</italic></sub> and <italic>n</italic><sub><italic>BW</italic></sub>; if <italic>n</italic><sub><italic>BB &gt;</italic></sub> <italic>n</italic><sub><italic>BW</italic></sub>, the area P is recorded as Black; otherwise, it is recorded as White. Then, count respectively the number of pixels with values of zero (black) and one (white) in the area (Q) of the line AC and the arc <inline-formula id="pone.0204714.e008"><alternatives><graphic id="pone.0204714.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0204714.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mtext>D</mml:mtext><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="true">⌢</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, and denote them respectively as <italic>n</italic><sub><italic>DB</italic></sub> and <italic>n</italic><sub><italic>DW</italic></sub>; if <italic>n</italic><sub><italic>DB &gt;</italic></sub> <italic>n</italic><sub><italic>DW</italic></sub>, the area Q is recorded as Black; otherwise, it is recorded as White. If P is Black and Q is White, the tooth shape is RT. If P is White and Q is Black, the tooth shape is FL.</p></list-item>
</list>
<fig id="pone.0204714.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Tooth shape judgment diagram.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.g009" xlink:type="simple"/>
</fig>
</sec>
</sec>
</sec>
<sec id="sec014">
<title>Experimental evaluation</title>
<sec id="sec015">
<title>Experimental plan</title>
<p>To verify whether the proposed leaf structure feature description algorithm is scientific and effective, we implemented the algorithm using MATLAB 2017 (MathWorks, Natick, MA, USA) on a standard desktop PC (4.2 GHz CPU, 24 GB RAM). Processing of a single leaf took approximately 1.4 s. This could undoubtedly be improved through further optimization and/or using parallel computing. In this section, we provide relevant experimental results and analyze them.</p>
<p>The test data were obtained from standard plant leaf databases (Swedish Leaf dataset, Flavia dataset, and Institute of Botany, Chinese Academy of Sciences) [<xref ref-type="bibr" rid="pone.0204714.ref033">33</xref>], and several representative shaped leaves were selected, as shown in <xref ref-type="fig" rid="pone.0204714.g010">Fig 10</xref>.</p>
<fig id="pone.0204714.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Examples of test leaves.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.g010" xlink:type="simple"/>
</fig>
<p>The extraction algorithm proposed in Sections 3 and 4 in this paper was used to extract the tooth features. We verify the validity of features extracted in two ways. The first method uses a manual view (Experiment 1) to verify whether the features extracted by the method are consistent with the actual characters of the leaf; the second method applies the extracted features to a classification algorithm (Experiment 2) to indirectly verify the validity of the features by classification; the classification is performed using a general evaluation method: confusion matrix and Kappa statistics. The confusion matrix consists of four values: true positive, false positive, false negative, and true negative. Based on these data, the value of true negative rate (specificity), negative predictive value (NPV), precision, recall, accuracy, F-measure, and Kappa coefficient (Kappa) are calculated [<xref ref-type="bibr" rid="pone.0204714.ref034">34</xref>]. <xref ref-type="table" rid="pone.0204714.t003">Table 3</xref> lists the Kappa coefficients for the classification, and the accuracy criteria are determined using the method proposed by Landis and Koch [<xref ref-type="bibr" rid="pone.0204714.ref035">35</xref>].</p>
<table-wrap id="pone.0204714.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.t003</object-id>
<label>Table 3</label> <caption><title>Level of classification accuracy according to the Kappa coefficient value.</title></caption>
<alternatives>
<graphic id="pone.0204714.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Kappa Coefficient (K)</th>
<th align="center">Quality</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">K &lt; 0.2</td>
<td align="center">Poor</td>
</tr>
<tr>
<td align="center">0.2 ≥ K &lt; 0.4</td>
<td align="center">Reasonable</td>
</tr>
<tr>
<td align="center">0.4 ≥ K &lt; 0.6</td>
<td align="center">Good</td>
</tr>
<tr>
<td align="center">0.6 ≥ K &lt; 0.8</td>
<td align="center">Very Good</td>
</tr>
<tr>
<td align="center">K ≥ 0.8</td>
<td align="center">Excellent</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="sec016">
<title>Results and analysis</title>
<sec id="sec017">
<title>Experiment 1</title>
<p>The experimental results of the first method (manual view) of the algorithm validation are shown in <xref ref-type="table" rid="pone.0204714.t004">Table 4</xref> through <xref ref-type="table" rid="pone.0204714.t006">Table 6</xref>.</p>
<table-wrap id="pone.0204714.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.t004</object-id>
<label>Table 4</label> <caption><title>Results of tooth extraction.</title></caption>
<alternatives>
<graphic id="pone.0204714.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.t004" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Category</th>
<th align="center">Orders of teeth</th>
<th align="center">Tooth space</th>
<th align="center">Number of teeth</th>
<th align="center">Sinus shape</th>
<th align="center">tooth shape</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>Leaf 1</bold></td>
<td align="center">1</td>
<td align="center">Regular</td>
<td align="center">32</td>
<td align="center">Angular sinus</td>
<td align="center">CV.</td>
</tr>
<tr>
<td align="center"><bold>Leaf 2</bold></td>
<td align="center">2</td>
<td align="center">Irregular</td>
<td align="center">82</td>
<td align="center">Angular sinus</td>
<td align="center">CV..</td>
</tr>
<tr>
<td align="center"><bold>Leaf 3</bold></td>
<td align="center">2</td>
<td align="center">Irregular</td>
<td align="center">79</td>
<td align="center">Rounded sinus</td>
<td align="center">CC.</td>
</tr>
<tr>
<td align="center"><bold>Leaf 4</bold></td>
<td align="center">1</td>
<td align="center">Irregular</td>
<td align="center">12</td>
<td align="center">Angular sinus</td>
<td align="center">ST.</td>
</tr>
<tr>
<td align="center"><bold>Leaf 5</bold></td>
<td align="center">1</td>
<td align="center">Irregular</td>
<td align="center">84</td>
<td align="center">Angular sinus</td>
<td align="center">CV.</td>
</tr>
<tr>
<td align="center"><bold>Leaf 6</bold></td>
<td align="center">2</td>
<td align="center">Irregular</td>
<td align="center">57</td>
<td align="center">Angular sinus</td>
<td align="center">FL.</td>
</tr>
<tr>
<td align="center"><bold>Leaf 7</bold></td>
<td align="center">2</td>
<td align="center">Irregular</td>
<td align="center">23</td>
<td align="center">Rounded sinus</td>
<td align="center">RT.</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pone.0204714.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.t005</object-id>
<label>Table 5</label> <caption><title>Accuracy statistics of the orders of leaf tooth.</title></caption>
<alternatives>
<graphic id="pone.0204714.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.t005" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="2">Category</th>
<th align="center" colspan="2">First-order teeth</th>
<th align="center" rowspan="2">Accuracy</th>
<th align="center" colspan="2">Second-order teeth</th>
<th align="center" rowspan="2">Accuracy</th>
</tr>
<tr>
<th align="center">Positive</th>
<th align="center">Negative</th>
<th align="center">Positive</th>
<th align="center">Negative</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>Leaf 1</bold></td>
<td align="center">23</td>
<td align="center">6</td>
<td align="center">79%</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center"><bold>Leaf 2</bold></td>
<td align="center">17</td>
<td align="center">7</td>
<td align="center">70%</td>
<td align="center">42</td>
<td align="center">16</td>
<td align="center">72%</td>
</tr>
<tr>
<td align="center"><bold>Leaf 3</bold></td>
<td align="center">33</td>
<td align="center">1</td>
<td align="center">97%</td>
<td align="center">47</td>
<td align="center">6</td>
<td align="center">88%</td>
</tr>
<tr>
<td align="center"><bold>Leaf 4</bold></td>
<td align="center">11</td>
<td align="center">2</td>
<td align="center">84%</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center"><bold>Leaf 5</bold></td>
<td align="center">27</td>
<td align="center">8</td>
<td align="center">77%</td>
<td align="center"/>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"><bold>Leaf 6</bold></td>
<td align="center">15</td>
<td align="center">2</td>
<td align="center">88%</td>
<td align="center">34</td>
<td align="center">6</td>
<td align="center">85%</td>
</tr>
<tr>
<td align="center"><bold>Leaf 7</bold></td>
<td align="center">5</td>
<td align="center">2</td>
<td align="center">71%</td>
<td align="center">15</td>
<td align="center">6</td>
<td align="center">60%</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pone.0204714.t006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.t006</object-id>
<label>Table 6</label> <caption><title>Statistics of the curvature of the concave shape.</title></caption>
<alternatives>
<graphic id="pone.0204714.t006g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.t006" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Groups</th>
<th align="center">C1</th>
<th align="center">C2</th>
<th align="center">C3</th>
<th align="center">C4</th>
<th align="center">C5</th>
<th align="center">C6</th>
<th align="center">C7</th>
<th align="center">C8</th>
<th align="center">C N</th>
<th align="center">Mean Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>Rounded</bold></td>
<td align="char" char=".">0.0665</td>
<td align="char" char=".">0.1238</td>
<td align="char" char=".">0.0641</td>
<td align="char" char=".">0.0618</td>
<td align="center">0.0509</td>
<td align="char" char=".">0.1072</td>
<td align="char" char=".">0.0620</td>
<td align="char" char=".">0.1072</td>
<td align="center">…</td>
<td align="char" char=".">0.0673</td>
</tr>
<tr>
<td align="center"><bold>Angular</bold></td>
<td align="char" char=".">0.1344</td>
<td align="char" char=".">0.1806</td>
<td align="char" char=".">0.2540</td>
<td align="char" char=".">0.2649</td>
<td align="center">0.1853</td>
<td align="char" char=".">0.1764</td>
<td align="char" char=".">0.1774</td>
<td align="char" char=".">0.1905</td>
<td align="center">…</td>
<td align="char" char=".">0.2044</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>From the experimental results listed in Tables <xref ref-type="table" rid="pone.0204714.t003">3</xref>–<xref ref-type="table" rid="pone.0204714.t005">5</xref>, it can be seen that the method accurately extracts the tooth characteristics of the leaf. Moreover, the tooth spacing, the number of teeth, the shape of the concave points, and the number of orders of teeth are also in line with the observed results, which indicates that the CSS method is accurate and reliable for the extraction of leaf teeth features. Simultaneous curvature is an effective method to describe the shape of leaf concave shape.</p>
</sec>
</sec>
<sec id="sec018">
<title>Experiment 2</title>
<p>To further test the effectiveness of the extraction method proposed in this paper, the extracted features were used for leaf classification. Thus, the effectiveness of the method was verified in terms of classification accuracy. Because we use the same method to extract multiple features from the same sample, if the accuracy of the classification is higher, the features have a better distinction. An extraction method of leaf tooth features has been discussed in detail and the classification of leaves based on leaf teeth characteristics has been studied, with good results being achieved [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]. Other methods [<xref ref-type="bibr" rid="pone.0204714.ref021">21</xref>–<xref ref-type="bibr" rid="pone.0204714.ref023">23</xref>] use a combination of leaf tooth features and non-leaf tooth features. As the focus of this study was only on leaf teeth features, the comparison method was based on the selection proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]. A leaf identification method identifies features such as total area of teeth, internal angles, number of teeth, and total length of outer edges.</p>
<p>The original input uses four types of plant leaves, a total of 700 leaf images (from the Swedish Leaf Dataset [<xref ref-type="bibr" rid="pone.0204714.ref030">30</xref>]; the dataset contains scanned images of 15 leaves and the selected species have greater similarity, which is considered as challenging to be classified). We use our method to extract the leaf tooth features from the original leaves as an input dataset; we also need to divide the data into a non-overlapping training set (90% of the records) used to estimate the model parameters, and a testing set (10% of the records) used to estimate its accuracy.</p>
<p>First, we used multiclass linear discriminant analysis (LDA) to reduce the dimensions. Then, we used the shortest distance for classification and predicted the category labels. The feature classification test results extracted by the proposed method and the method proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>] are shown in <xref ref-type="table" rid="pone.0204714.t007">Table 7</xref>.</p>
<table-wrap id="pone.0204714.t007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.t007</object-id>
<label>Table 7</label> <caption><title>LDA results.</title></caption>
<alternatives>
<graphic id="pone.0204714.t007g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.t007" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Category</th>
<th align="center">Method</th>
<th align="center">Specificity</th>
<th align="center">NPV</th>
<th align="center">Precision</th>
<th align="center">Recall</th>
<th align="center">F1-measure</th>
<th align="center">Accuracy</th>
<th align="center">Kappa</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="2"><bold>1</bold></td>
<td align="center">Our method</td>
<td align="char" char=".">0.2667</td>
<td align="char" char=".">0.4444</td>
<td align="center">0.3939</td>
<td align="center">0.8667</td>
<td align="char" char=".">0.5417</td>
<td align="char" char=".">0.4167</td>
<td align="char" char=".">0.2222</td>
</tr>
<tr>
<td align="center">Proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]</td>
<td align="char" char=".">0.1333</td>
<td align="char" char=".">0.4</td>
<td align="center">0.2667</td>
<td align="center">0.8</td>
<td align="char" char=".">0.4</td>
<td align="char" char=".">0.3</td>
<td align="char" char=".">0.0667</td>
</tr>
<tr>
<td align="center" rowspan="2"><bold>2</bold></td>
<td align="center">Our method</td>
<td align="char" char=".">0.5556</td>
<td align="char" char=".">0.4464</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-</td>
<td align="char" char=".">0.4167</td>
<td align="char" char=".">0.2222</td>
</tr>
<tr>
<td align="center">Proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]</td>
<td align="char" char=".">0.3333</td>
<td align="char" char=".">0.2885</td>
<td align="center">0.375</td>
<td align="center">0.2</td>
<td align="char" char=".">0.2609</td>
<td align="char" char=".">0.3</td>
<td align="char" char=".">0.0667</td>
</tr>
<tr>
<td align="center" rowspan="2"><bold>3</bold></td>
<td align="center">Our method</td>
<td align="char" char=".">0.3778</td>
<td align="char" char=".">0.34</td>
<td align="center">0.8</td>
<td align="center">0.5333</td>
<td align="char" char=".">0.64</td>
<td align="char" char=".">0.4167</td>
<td align="char" char=".">0.2222</td>
</tr>
<tr>
<td align="center">Proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]</td>
<td align="char" char=".">0.3778</td>
<td align="char" char=".">0.2931</td>
<td align="center">0.5</td>
<td align="center">0.0667</td>
<td align="char" char=".">0.1176</td>
<td align="char" char=".">0.3</td>
<td align="char" char=".">0.0667</td>
</tr>
<tr>
<td align="center" rowspan="2"><bold>4</bold></td>
<td align="center">Our method</td>
<td align="char" char=".">0.4667</td>
<td align="char" char=".">0.4468</td>
<td align="center">0.3077</td>
<td align="center">0.2667</td>
<td align="char" char=".">0.2857</td>
<td align="char" char=".">0.4167</td>
<td align="char" char=".">0.2222</td>
</tr>
<tr>
<td align="center">Proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]</td>
<td align="char" char=".">0.3556</td>
<td align="char" char=".">0.2909</td>
<td align="center">0.4</td>
<td align="center">0.1333</td>
<td align="char" char=".">0.2</td>
<td align="char" char=".">0.3</td>
<td align="char" char=".">0.0667</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>It can be seen from <xref ref-type="table" rid="pone.0204714.t007">Table 7</xref> that the accuracy of leaf classification using the proposed method is 41.67%, and Kappa coefficient classified the result as “reasonable.” However, the accuracy of leaf classification is only 30% using the extraction method in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>] and the Kappa coefficient classified the result as “poor” according to the accuracy levels (K&lt;0.2). Therefore, the feature extracted by the proposed method has higher accuracy for leaf classification; that is, the features extracted using this method have better discrimination capability for different leaves.</p>
<p>Second, we used a multiclass support vector machine (SVM) classifier to predict the category of leaves. The results of the feature classification test for the proposed method and the method proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>] are shown in <xref ref-type="table" rid="pone.0204714.t008">Table 8</xref>.</p>
<table-wrap id="pone.0204714.t008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0204714.t008</object-id>
<label>Table 8</label> <caption><title>SVM classification results.</title></caption>
<alternatives>
<graphic id="pone.0204714.t008g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0204714.t008" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Category</th>
<th align="center">Method</th>
<th align="center">Specificity</th>
<th align="center">NPV</th>
<th align="center">Precision</th>
<th align="center">Recall</th>
<th align="center">F1-measure</th>
<th align="center">Accuracy</th>
<th align="center">Kappa</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="2"><bold>1</bold></td>
<td align="center">Our method</td>
<td align="char" char=".">0.8889</td>
<td align="char" char=".">0.8511</td>
<td align="center">1</td>
<td align="center">0.8667</td>
<td align="center">0.9286</td>
<td align="char" char=".">0.8833</td>
<td align="center">0.8444</td>
</tr>
<tr>
<td align="center">Proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]</td>
<td align="char" char=".">0.2667</td>
<td align="char" char=".">0.2791</td>
<td align="center">0.1765</td>
<td align="center">0.2</td>
<td align="center">0.1875</td>
<td align="char" char=".">0.25</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center" rowspan="2"><bold>2</bold></td>
<td align="center">Our method</td>
<td align="char" char=".">0.8889</td>
<td align="char" char=".">0.9302</td>
<td align="center">0.7647</td>
<td align="center">0.8667</td>
<td align="center">0.8125</td>
<td align="char" char=".">0.8833</td>
<td align="center">0.8444</td>
</tr>
<tr>
<td align="center">Proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]</td>
<td align="char" char=".">0.2444</td>
<td align="char" char=".">0.2683</td>
<td align="center">0.2105</td>
<td align="center">0.2667</td>
<td align="center">0.2353</td>
<td align="char" char=".">0.25</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center" rowspan="2"><bold>3</bold></td>
<td align="center">Our method</td>
<td align="char" char=".">0.8444</td>
<td align="char" char=".">0.8444</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="char" char=".">0.8833</td>
<td align="center">0.8444</td>
</tr>
<tr>
<td align="center">Proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]</td>
<td align="char" char=".">0.1556</td>
<td align="char" char=".">0.1944</td>
<td align="center">0.3333</td>
<td align="center">0.5333</td>
<td align="center">0.4103</td>
<td align="char" char=".">0.25</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center" rowspan="2"><bold>4</bold></td>
<td align="center">Our method</td>
<td align="char" char=".">0.9111</td>
<td align="char" char=".">0.9111</td>
<td align="center">0.8</td>
<td align="center">0.8</td>
<td align="center">0.8</td>
<td align="char" char=".">0.8833</td>
<td align="center">0.8444</td>
</tr>
<tr>
<td align="center">Proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>]</td>
<td align="char" char=".">0.3333</td>
<td align="char" char=".">0.25</td>
<td align="center">-</td>
<td align="center">0</td>
<td align="center">-</td>
<td align="char" char=".">0.25</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>It can be seen from <xref ref-type="table" rid="pone.0204714.t008">Table 8</xref> that the accuracy of leaf classification with the proposed extraction method is 88.33%, and the Kappa coefficient classified the solution as “excellent”; the accuracy of leaf classification is only 25% if we use the extraction method proposed in [<xref ref-type="bibr" rid="pone.0204714.ref020">20</xref>], and the 4th leaf is classified incorrectly, for which the Kappa coefficient classified the results as “poor.” This proves that the leaf tooth features as referred to leaf structure classification system in botany, such as number of orders of teeth, tooth spacing, tooth number, concave shape and so on, can accurately describe the differences between different types of plant leaves; the accuracy of SVM classification using this method is significantly higher than that using LDA method.</p>
</sec>
<sec id="sec019" sec-type="conclusions">
<title>Conclusion</title>
<p>The extraction of leaf features has important theoretical and practical significance in biological ecosystems and leaf retrieval. With the development of computer and image processing technology, automatic high-precision extraction of leaf structure has become an emerging interdisciplinary subject. For extracting leaf teeth characteristics, this study followed the biological leaf structure classification system; we focused on describing and extracting leaf teeth by identifying factors such as number of orders of leaf teeth, tooth spacing, number of teeth, sinus shape, and tooth shape. The experimental results showed that the leaf tooth description and measurement method proposed in this study can provide an effective way for a refined description of leaf features and leaf classification; however, the method is only applicable for plants with leaf teeth. For plants without leaf teeth, other features of leaves will need to be considered, which will also be the direction of our work in the next stage. For example, we will explore a method of automatic extraction of leaf-related features through image processing according to the description and definition of leaf organization, glands, petiole, and other features in the Manual of Leaf Architecture. These scientific and canonical leaf characterization data can be used to correlate and contrast plants at different times, thereby inferring the evolutionary history of plants.</p>
</sec>
</body>
<back>
<ack>
<p>We are grateful to the providers of the Swedish Leaf and Flavia datasets, Institute of Botany, Chinese Academy of Sciences, anonymous reviewers, and the members of the National Key Laboratory of Science and Technology on Multi-spectral Information Processing for their helpful advice regarding the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0204714.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>L</given-names></name>. <article-title>Study on the ecological plasticity and the composition and diversity of community functional groups of the microstructure of the stem and leaf of Leymus chinensis, a key species of steppe in northeast China</article-title>. <source>Institute of Botany, the Chinese Academy of Sciences</source>, <year>2003</year>.</mixed-citation></ref>
<ref id="pone.0204714.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Merrill</surname> <given-names>EK</given-names></name>. <article-title>Comparison of mature leaf architecture of three types in Sorbus L. (Rosaceae)</article-title>. <source>Bot Gaz</source>. <year>1978</year>;<volume>139</volume>(<issue>4</issue>):<fpage>447</fpage>–<lpage>453</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sajo</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Rudall</surname> <given-names>PJ</given-names></name>. <article-title>Leaf and stem anatomy of Vochysiaceae in relation to subfamilial and suprafamilial systematics</article-title>. <source>Bot J Linean Soc</source>. <year>2015</year>;<volume>138</volume>(<issue>3</issue>):<fpage>339</fpage>–<lpage>364</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Espinosa</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Llorente</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Morrone</surname> <given-names>JJ</given-names></name>. <article-title>ORIGINAL ARTICLE: Historical biogeographical patterns of the species of Bursera (Burseraceae) and their taxonomic implications</article-title>. <source>J Biogeogr</source>. <year>2006</year>;<volume>33</volume>(<issue>11</issue>):<fpage>1945</fpage>–<lpage>1958</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Doyle</surname> <given-names>JA</given-names></name>. <article-title>Systematic value and evolution of leaf architecture across the angiosperms in light of molecular phylogenetic analyses</article-title>. <source>Cour</source>. Forsch-Inst. Senckenberg. <year>2007</year>;<volume>258</volume>(<issue>258</issue>):<fpage>21</fpage>–<lpage>37</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref006"><label>6</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Ash</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ellis</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hickey</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wilf</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wing</surname> <given-names>S</given-names></name>. <chapter-title>Manual of leaf architecture</chapter-title>. <collab>Smithsonian Institution</collab>: <publisher-loc>Washington</publisher-loc>. <year>1999</year>.</mixed-citation></ref>
<ref id="pone.0204714.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walker</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Doyle</surname> <given-names>JA</given-names></name>. <article-title>The bases of angiosperm phylogeny: palynology</article-title>. <source>Ann Mo Bot Gard</source>. <year>1975</year>;<volume>62</volume>(<issue>3</issue>):<fpage>664</fpage>–<lpage>723</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hickey</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>DW</given-names></name>. <article-title>The leaf architecture of ticodendron and the application of foliar characters in discerning its relationships</article-title>. <source>Ann Mo Bot Gard</source>. <year>1991</year>;<volume>78</volume>(<issue>1</issue>):<fpage>105</fpage>–<lpage>130</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wolfe</surname> <given-names>JA</given-names></name>. <article-title>Tertiary climatic fluctuations and methods of analysis of tertiary floras</article-title>. <source>Palaeogeogr Palaeoclimatol Palaeoecol</source>. <year>1971</year>;<volume>9</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>57</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilf</surname> <given-names>P</given-names></name>. <article-title>When are leaves good thermometers? A new case for leaf margin analysis</article-title>. <source>Paleobiology</source>, <year>1997</year>;<volume>23</volume>(<issue>3</issue>):<fpage>373</fpage>–<lpage>390</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Utescher</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Mosbrugger</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Ashraf</surname> <given-names>AR</given-names></name>. <article-title>Terrestrial climate evolution in northwest Germany over the last 25 million years</article-title>. <source>Palaios</source>, <year>2000</year>;<volume>15</volume>(<issue>5</issue>):<fpage>430</fpage>–<lpage>449</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Royer</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Wilf</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Janesko</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Kowalski</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Dilcher</surname> <given-names>DL</given-names></name>. <article-title>Correlations of climate and plant ecology to leaf size and shape: Potential proxies for the fossil record</article-title>. <source>Am J Bot</source>. <year>2005</year>;<volume>92</volume>(<issue>7</issue>):<fpage>1141</fpage>–<lpage>1151</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3732/ajb.92.7.1141" xlink:type="simple">10.3732/ajb.92.7.1141</ext-link></comment> <object-id pub-id-type="pmid">21646136</object-id></mixed-citation></ref>
<ref id="pone.0204714.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Royer</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Wilf</surname> <given-names>P</given-names></name>. <article-title>Why do toothed leaves correlate with cold climates? Gas exchange at leaf margins provides new insights into a classic paleotemperature proxy</article-title>. <source>Int J Plant Sci</source>. <year>2006</year>;<volume>167</volume>(<issue>1</issue>):<fpage>11</fpage>–<lpage>18</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bailey</surname> <given-names>IW</given-names></name>, <name name-style="western"><surname>Sinnott</surname> <given-names>EW</given-names></name>. <article-title>A botanical index of Cretaceous and Tertiary climates</article-title>. <source>Science</source>. <year>1915</year>;<volume>41</volume>(<issue>1066</issue>): <fpage>831</fpage>–<lpage>834</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.41.1066.831" xlink:type="simple">10.1126/science.41.1066.831</ext-link></comment> <object-id pub-id-type="pmid">17835989</object-id></mixed-citation></ref>
<ref id="pone.0204714.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bailey</surname> <given-names>IW</given-names></name>, <name name-style="western"><surname>Sinnott</surname> <given-names>EW</given-names></name>. <article-title>The climatic distribution of certain types of angiosperm leaves</article-title>. <source>Am J Bot</source>, <year>1916</year>;<volume>3</volume>(<issue>1</issue>): <fpage>24</fpage>–<lpage>39</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huff</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Wilf</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Azumah</surname> <given-names>EJ</given-names></name>. <article-title>Digital future for paleoclimate estimation from fossil leaves? Preliminary results</article-title>. <source>Palaios</source>, <year>2003</year>;<volume>18</volume>(<issue>3</issue>):<fpage>266</fpage>–<lpage>274</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xiaofeng</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Deshuang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Jixiang</surname> <given-names>DU</given-names></name>. <article-title>Feature Extraction and Recognition for Leaf Images</article-title>. <source>Comput Eng Appl</source>, <year>2006</year>;<volume>42</volume>(<issue>3</issue>): <fpage>190</fpage>–<lpage>193</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bruno</surname> <given-names>OM</given-names></name>, <name name-style="western"><surname>de Oliveira Plotze</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Falvo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>de Castro</surname> <given-names>M</given-names></name>. <article-title>Fractal dimension applied to plant identification</article-title>. <source>Inf Sci</source>, <year>2008</year>;<volume>178</volume>(<issue>12</issue>): <fpage>2722</fpage>–<lpage>2733</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zheng</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Xiaojie</surname> <given-names>J</given-names></name>. <article-title>Application of SUSAN Algorithm in Feature Extraction of Leaf Margin</article-title>. <source>Chinese Agricultural Science Bulletin</source>, <year>2011</year>;<volume>7</volume>(<issue>27</issue>): <fpage>174</fpage>–<lpage>178</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Corney</surname> <given-names>DPA</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>HL</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>J</given-names></name>. <article-title>Automating digital leaf measurement: the tooth, the whole tooth, and nothing but the tooth</article-title>. <source>PLoS ONE</source> <year>2012</year>;<volume>7</volume>(<issue>8</issue>): <fpage>e42112</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0042112" xlink:type="simple">https://doi.org/10.1371/journal.pone.0042112</ext-link> <object-id pub-id-type="pmid">22870286</object-id></mixed-citation></ref>
<ref id="pone.0204714.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jin</surname> <given-names>T.</given-names></name>, <name name-style="western"><surname>Hou</surname> <given-names>X.</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>P.</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>F.</given-names></name> <article-title>A novel method of automatic plant species identification using sparse representation of leaf tooth features</article-title>. <source>PLoS One</source>, <year>2015</year>;<volume>10</volume>(<issue>10</issue>):<fpage>e0139482</fpage>:10.1371/journal.pone.0139482 <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0139482" xlink:type="simple">10.1371/journal.pone.0139482</ext-link></comment> <object-id pub-id-type="pmid">26440281</object-id></mixed-citation></ref>
<ref id="pone.0204714.ref022"><label>22</label><mixed-citation publication-type="other" xlink:type="simple">Chen Y. Leaf Margin Classification Based on Local Images Feature. Master’s thesis of Zhejiang A&amp;F University, 2014.</mixed-citation></ref>
<ref id="pone.0204714.ref023"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Li L. Semi-supervised clustering and its application on plant leaf image recognition. Doctor’s thesis of Northwest A&amp;F University, 2017.</mixed-citation></ref>
<ref id="pone.0204714.ref024"><label>24</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Rahmani</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Amine</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>RedaHamou</surname> <given-names>M</given-names></name>. <chapter-title>Plant leaves classification</chapter-title>. In: <source>The first international conference on big data, small data, linked data, open data</source>, <year>2015</year>:<fpage>75</fpage>–<lpage>80</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tsolaidis</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kosmopoulos</surname> <given-names>DI</given-names></name>, <name name-style="western"><surname>Papadourakis</surname> <given-names>G</given-names></name>. <article-title>Plant leaf recognition using zernike moments and histogram of oriented gradients</article-title>. <source>LNCS</source> <year>2014</year>:<fpage>406</fpage>–<lpage>417</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>He</surname> <given-names>AX</given-names></name>, <name name-style="western"><surname>Yung</surname> <given-names>NH</given-names></name>. <article-title>Corner detector based on global and local curvature properties</article-title>. <source>Opt Eng</source>, <year>2008</year>;<volume>47</volume>(<issue>5</issue>):<fpage>057008</fpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref027"><label>27</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>. <chapter-title>Image engineering (I) [M]</chapter-title>.<edition>3rd Ed</edition>. <publisher-loc>Beijing</publisher-loc>: <publisher-name>Tsinghua University Press</publisher-name>, <year>2012</year>:<fpage>304</fpage>–<lpage>305</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref028"><label>28</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Gonzalez</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Woods</surname> <given-names>RE</given-names></name>. <chapter-title>Digital Image Processing Second Edition [M1. Publishing House of Electronics Industry. 2007 [E8] Qiu Qiuqi</chapter-title>. <source>Digital Image Processing</source>. <publisher-loc>Beijing</publisher-loc>: <publisher-name>Publishing House of Electronics Industry</publisher-name>, <year>2004</year>.</mixed-citation></ref>
<ref id="pone.0204714.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mokhtarian</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Suomela</surname> <given-names>R</given-names></name>. <article-title>Robust Image Corner Detection Through Curvature Scale Space</article-title>, <source>IEEE Trans Pattern Anal Mach Intell</source>. <year>1998</year>;<volume>20</volume>(<issue>12</issue>): <fpage>1376</fpage>–<lpage>138</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref030"><label>30</label><mixed-citation publication-type="other" xlink:type="simple">He XC, Yung NH. Curvature scale space corner detector with adaptive threshold and dynamic region of support. In Pattern Recognition, 2004. ICPR 2004. Proceedings of the 17th International Conference on 2004 Aug 23 Vol. 2, p. 791–794. IEEE.</mixed-citation></ref>
<ref id="pone.0204714.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Otsu</surname> <given-names>N</given-names></name>. <article-title>A threshold selection method from gray-level histograms</article-title>. <source>IEEE Trans Syst Man Cybern</source>. <year>1979</year>;<volume>9</volume>(<issue>1</issue>): <fpage>62</fpage>–<lpage>66</lpage>.</mixed-citation></ref>
<ref id="pone.0204714.ref032"><label>32</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Ellis</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Daly</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Hickey</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Mitchell</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Wilf</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wing</surname> <given-names>SL</given-names></name>. <source>Manual of Leaf Architecture</source>. <publisher-loc>Ithaca</publisher-loc>: <publisher-name>Cornell University Press</publisher-name>, <year>2009</year>.</mixed-citation></ref>
<ref id="pone.0204714.ref033"><label>33</label><mixed-citation publication-type="other" xlink:type="simple">Söderkvist O. Computer vision classification of leaves from Swedish trees. Master Thesis, Linkoping University, Sweden, 2001.</mixed-citation></ref>
<ref id="pone.0204714.ref034"><label>34</label><mixed-citation publication-type="other" xlink:type="simple">Powers DMW. Evaluation: from Precision, Recall and F-Factor to ROC, Informedness, Markedness &amp; Correlation. Technical Report SIE-07-001, School of Informatics and Engineering, Flinders University. Adelaide, Australia; 2007.</mixed-citation></ref>
<ref id="pone.0204714.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Landis</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>GG</given-names></name>. <article-title>The measurement of observer agreement for categorical data</article-title>. <source>Biometrics</source> <year>1977</year>;<volume>33</volume>(<issue>1</issue>): <fpage>159</fpage>–<lpage>174</lpage>. <object-id pub-id-type="pmid">843571</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>