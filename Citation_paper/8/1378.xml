<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">08-PONE-RA-05437R2</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0004299</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computer Science</subject><subject>Computational Biology/Computational Neuroscience</subject><subject>Mathematics/Algorithms</subject><subject>Mathematics/Statistics</subject><subject>Neuroscience/Theoretical Neuroscience</subject></subj-group></article-categories><title-group><article-title>Extraction and Characterization of Essential Discharge Patterns from Multisite Recordings of Spiking Ongoing Activity</article-title><alt-title alt-title-type="running-head">Extracting Neuronal Patterns</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Storchi</surname><given-names>Riccardo</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Biella</surname><given-names>Gabriele E. M.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Liberati</surname><given-names>Diego</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Baselli</surname><given-names>Giuseppe</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Biomedical Sciences, University of Modena, Modena, Italy</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Institute of Molecular Bioimaging and Physiology, Milan, Italy</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>National Research Council, Institute of Molecular Bioimaging and Physiology, Milan, Italy</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Department of Electronic and Information, National Research Council, Politechnic School of Milan, Milan, Italy</addr-line>       </aff><aff id="aff5"><label>5</label><addr-line>Department of Biomedical Engineering, Politechnic School of Milan, Milan, Italy</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Sporns</surname><given-names>Olaf</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Indiana University, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">riccardo.storchi@gmail.com</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: GEMB. Performed the experiments: RS GEMB. Analyzed the data: RS. Contributed reagents/materials/analysis tools: RS GB DL. Wrote the paper: RS GEMB.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><year>2009</year></pub-date><pub-date pub-type="epub"><day>28</day><month>1</month><year>2009</year></pub-date><volume>4</volume><issue>1</issue><elocation-id>e4299</elocation-id><history>
<date date-type="received"><day>9</day><month>7</month><year>2008</year></date>
<date date-type="accepted"><day>5</day><month>12</month><year>2008</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2009</copyright-year><copyright-holder>Storchi et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><sec>
<title>Background</title>
<p>Neural activation patterns proceed often by schemes or motifs distributed across the involved cortical networks. As neurons are correlated, the estimate of all possible dependencies quickly goes out of control. The complex nesting of different oscillation frequencies and their high non-stationariety further hamper any quantitative evaluation of spiking network activities. The problem is exacerbated by the intrinsic variability of neural patterns.</p>
</sec><sec>
<title>Methodology/Principal Findings</title>
<p>Our technique introduces two important novelties and enables to insulate essential patterns on larger sets of spiking neurons and brain activity regimes. First, the sampling procedure over N units is based on a fixed spike number k in order to detect N-dimensional arrays (k-sequences), whose sum over all dimension is k. Then k-sequences variability is greatly reduced by a hierarchical separative clustering, that assigns large amounts of distinct k-sequences to few classes. Iterative separations are stopped when the dimension of each cluster comes to be smaller than a certain threshold. As threshold tuning critically impacts on the number of classes extracted, we developed an effective cost criterion to select the shortest possible description of our dataset. Finally we described three indexes (C,S,R) to evaluate the average pattern complexity, the structure of essential classes and their stability in time.</p>
</sec><sec>
<title>Conclusions/Significance</title>
<p>We validated this algorithm with four kinds of surrogated activity, ranging from random to very regular patterned. Then we characterized a selection of ongoing activity recordings. By the S index we identified unstable, moderatly and strongly stable patterns while by the C and the R indices we evidenced their non-random structure. Our algorithm seems able to extract interesting and non-trivial spatial dynamics from multisource neuronal recordings of ongoing and potentially stimulated activity. Combined with time-frequency analysis of LFPs could provide a powerful multiscale approach linking population oscillations with multisite discharge patterns.</p>
</sec></abstract><funding-group><funding-statement>Support was provided by the University of Modena and by San Raffaele Hospital. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="13"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>In the last twenty years, studies on information encoding in the nervous system have provided fundamental insights into the nature of neural inner dynamics and of sensorimotor representation and coding of the external world. Powerful and flexible statistical techniques have grown in time <xref ref-type="bibr" rid="pone.0004299-Rieke1">[1]</xref>–<xref ref-type="bibr" rid="pone.0004299-Johnson1">[5]</xref>, improving the analyses of stimulus-response experimental paradigms along with their corollary complexities.</p>
<p>Scant attention has been paid to other dynamic features such as spontaneous or ongoing activity. Nevertheless, this feature represents 90% percent of the whole metabolic exertion of the brain <xref ref-type="bibr" rid="pone.0004299-Vincent1">[6]</xref>. An exhaustive description of ongoing activity as a kind of substrate intermingling with signals generated by external sources, could provide fundamental insights into nervous system dynamics.</p>
<p>Spontaneous neuronal population activities from many sites in the central nervous system present complex combinations of different oscillation frequencies <xref ref-type="bibr" rid="pone.0004299-Steriade1">[7]</xref>–<xref ref-type="bibr" rid="pone.0004299-Steriade2">[9]</xref>. Regular and repetitive motifs nest within the frames of these global rhythms. Furthermore, stereotyped patterns of specific neuron subsets have been evidenced in many different experimental conditions such as at the onset of UP states <xref ref-type="bibr" rid="pone.0004299-Luczak1">[10]</xref> or in <italic>in vitro</italic> recordings with calcium imaging <xref ref-type="bibr" rid="pone.0004299-Cossart1">[11]</xref>, <xref ref-type="bibr" rid="pone.0004299-MacLean1">[12]</xref>.</p>
<p>Because of the surging number of items, the statistical evaluation of all possible discharge patterns in multisite recordings of even a few channels quickly goes out of control. Nevertheless, pioneering studies and further advancements have developed algorithms capable of recognizing small, repetitive and well-timed patterns in tonic activity regimes <xref ref-type="bibr" rid="pone.0004299-Abeles1">[13]</xref>–<xref ref-type="bibr" rid="pone.0004299-Tetko2">[17]</xref>. Still, timing is likely not the only encoding means valid in the CNS.</p>
<p>Repetitive spontaneous and evoked neuronal activation patterns evidenced time warping features, namely duration independent activity episodes, in most diverse behavioral conditions <xref ref-type="bibr" rid="pone.0004299-Nadasdy1">[18]</xref>–<xref ref-type="bibr" rid="pone.0004299-Euston1">[20]</xref>. These features may represent an additional piece of the multifarious presence of noise, a pervasive trait throughout the bottom-up (or top-down) scaling of brain analyses <xref ref-type="bibr" rid="pone.0004299-Faisal1">[21]</xref>, that affects the immediate detection of accessible regular and repetitive patterns. In any case the crucial role of noise in brain operations, as it has become evident in recent years, has gone largely unknown and is a current subject of wide debate.</p>
<p>In the context of a lack of comfortable theoretical background for the present scenario, we tried to design an efficient algorithm to detect the presence of regular motifs in all ongoing activity regimes and for most variable numbers of spikes or recording traces. We then developed and evaluated a set of measures to characterize such motifs in terms of spatial structure, complexity and temporal evolution.</p>
<p>Our approach is conceptually different from previous works as we introduced several important novel features. First, in addition to constant time bin sampling, we introduced a conditional sampling based on keeping the number of spikes constant in each sample. This procedure allows the rejection of common mode frequency modulations. Second, we applied a clustering procedure in order to extract a reasonable number of classes from the wide variety of distinct patterns and to reduce the effect of noise. Then, following a cost criterion, we extracted a selection of the most frequently occurring classes that we called essential classes (EC). Finally, we developed three indexes, labeled <italic>C</italic>, <italic>S</italic> and <italic>R</italic>, evaluating respectively the average pattern complexity (C), the structure of the ECs (<italic>S</italic>) and their stability in time (<italic>R</italic>). We applied such indexes both to simulated and to real data. We mainly focused on the results obtained by using conditional sampling. However the results obtained with constant time bin sampling will be reported as well and commented for comparison.</p>
<p>In the <xref ref-type="sec" rid="s2">Methods</xref> we describe the whole algorithm flow obtained by cascading constant time bin sampling or conditional sampling, the clustering procedure and the extraction of ECs (respectively subsections 1,2 and 3). We then describe the indexes <italic>C</italic>, <italic>R</italic> and <italic>S</italic> (subsection 4) and provide a detailed explanatory example of the whole procedure (subsection 5), in order to clarify the most critical steps of the algorithm. In the Results we evaluate the cost criterion performances (subsection 1) and apply the indexes <italic>C</italic>, <italic>R</italic> and <italic>S</italic> to several kinds of simulated activities (subsection 2) and to real data (subsection 3)</p>
<p>In subsections 2 and 3 we also compare the results obtained on simulations and on real data and the information provided by constant time bin and conditional sampling. In the Discussion we briefly discuss advantages and drawbacks of the techniques developed.</p>
</sec><sec id="s2">
<title>Materials and Methods</title>
<sec id="s2a">
<title>The sampling procedure</title>
<p>Given <italic>k</italic> spikes and <italic>N</italic> sources, we define a <italic>k</italic>-sequence as an <italic>N</italic>-dimensional vector whose values, on each dimension, are the number of spikes counted on each source, the sum over all dimensions being <italic>k</italic>. By fixing <italic>k</italic> and <italic>N</italic> it is possible to extract a finite set of <italic>k</italic>-sequences from each multisite recording (<xref ref-type="fig" rid="pone-0004299-g001">Fig. 1A</xref>).</p>
<fig id="pone-0004299-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0004299.g001</object-id><label>Figure 1</label><caption>
<title>Two different sampling procedures.</title>
<p>A) Conditional sampling. This procedure may provide adaptive time windows and detect as equal time-warped patterns with the same spatial distributions over the spiking sources. In this case note that by setting <italic>k</italic> = 8 three equal <italic>k</italic>-sequences are detected, as evidenced by the red ellipse). B) Constant time bin sampling applied to the same pattern. This is the most classical sampling procedure and is draw for comparison.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.g001" xlink:type="simple"/></fig>
<p>Consider a set of <italic>N</italic> spiking sources and let <italic>x<sub>1</sub></italic>, …, <italic>x<sub>N</sub></italic> be the number of spikes emitted by them in a variable time period. Then setting a constant sum <italic>Σ<sub>n</sub> x<sub>n</sub></italic> = <italic>k</italic> and collecting sets of <italic>k</italic>-sequences, we sample from the conditional probability distribution<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e001" xlink:type="simple"/></disp-formula><italic>K</italic>-sequences are sampled along the multichannel recording raster-plot on adjacent non-overlapping windows of variable duration (<xref ref-type="fig" rid="pone-0004299-g001">Fig. 1A</xref>). Conditional sampling does not rely on an “external” clock-the time of recording, but simply on the spike occurrences across the multiple emitting sources. This peculiar property makes this procedure, to a great extent, insensitive to the common mode frequency modulations that affect all the sampled spiking sources in the same way. A simple example of this property is provided in <xref ref-type="supplementary-material" rid="pone.0004299.s001">Document S1</xref>.</p>
<p>Unlike the classical constant time-bin sampling (reported in <xref ref-type="fig" rid="pone-0004299-g001">Fig. 1B</xref> for comparison), conditional sampling is robust relative to the time-warp, enabling us to consider patterns of different duration and equal spatial distribution just like a same pattern (see red circled samples in <xref ref-type="fig" rid="pone-0004299-g001">Fig. 1A</xref>). In analogy with <italic>k</italic>-sequences, we also define <italic>t</italic>-sequences as samples collected by using the classical constant time bin sampling procedure. In this context <italic>t</italic> represents the number of time-units <italic>Δt</italic>, being this term the largest time interval in which a source can emit at most one spike (typically <italic>Δt</italic> = 1 ms). More generally, when we will refer to both <italic>k</italic>-sequences and <italic>t</italic>-sequences, we will simply write sequences.</p>
</sec><sec id="s2b">
<title>The clustering procedure</title>
<p>The clustering procedure follows a bisecting divisive partitioning algorithm. At each iteration, the cluster bisection is obtained by applying in cascade the Principal Direction Divisive Partitioning (PDDP, see <xref ref-type="bibr" rid="pone.0004299-Boley1">[22]</xref>) and the Bisecting K-means (BK) algorithms.</p>
<p>Iterative separations are stopped when the dimension of each cluster is smaller than a predefined threshold <italic>D<sub>max</sub></italic>. The cluster dimension <italic>D<sub>j</sub></italic> of a <italic>j<sup>th</sup></italic> cluster, is computed as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e002" xlink:type="simple"/></disp-formula>and <italic>X<sub>i</sub></italic> is the set of values of the <italic>i<sup>th</sup></italic> dimension associated with the sequences belonging to the <italic>j<sup>th</sup></italic> cluster. For each cluster <italic>j</italic>, <italic>D<sub>i</sub></italic> can be interpreted as the number of all its possible distinct sequences and <italic>D<sub>max</sub></italic> as the maximum number for any cluster.</p>
<p>At the first step the whole dataset is bisected. Then, before any successive bisection, clusters are ranked by their dimension <italic>D</italic> and bisection is performed on the largest cluster. This criterion allows the obtaining of clusters which are roughly comparable in their cluster dimension.</p>
<p>Once we have chosen the cluster to bisect, we apply PDDP with the following steps. First, we subtract to each <italic>i<sup>th</sup></italic> dimension (of the chosen cluster) its mean value. Then, we compute the covariance matrix of the k-sequences belonging to the chosen cluster and we extract the eigenvector <bold><italic>v</italic></bold> associated with the largest eigenvalue. Finally, given two subclusters <italic>G<sub>1</sub></italic> and <italic>G<sub>2</sub></italic>, we assign each sequence <bold><italic>x</italic></bold> to one of them by evaluating the score <italic>A = </italic><bold><italic>x</italic></bold><italic><sup>T</sup></italic><bold><italic>v</italic></bold>. When <italic>A</italic> is larger than 0, we assign <bold><italic>x</italic></bold> to <italic>G<sub>1</sub></italic>. Otherwise we assign x to <italic>G<sub>2</sub></italic>. After preliminary bisection by PDDP we compute the centroids <bold><italic>w<sub>1</sub></italic></bold> and <bold><italic>w<sub>2</sub></italic></bold> on, respectively, <italic>G<sub>1</sub></italic> and <italic>G<sub>2</sub></italic>, and use them to initialize the BK algorithm.</p>
<p>The BK algorithm is iterative and is composed of two steps. First, each item is assigned to the nearest centroid. Then, the centroids are recalculated on the base of the last assignment stage. <italic>K</italic>-means always converge so that after a number of iterations centroids no longer change their positions. For a more detailed treatment of PDDP and BK refer to <xref ref-type="bibr" rid="pone.0004299-Boley1">[22]</xref>–<xref ref-type="bibr" rid="pone.0004299-McKay1">[24]</xref>.</p>
<p>As shown by Savaresi and Boley <xref ref-type="bibr" rid="pone.0004299-Savaresi1">[23]</xref>, the PDDP algorithm provides a wise centroid initialization while the BK algorithm refines the partitioning. The distinct clusters obtained by the clustering procedure constitute the sequence classes. Decreasing the values of <italic>D<sub>max</sub></italic> we obtain a more detailed description of the dataset, with a larger number of lower dimension sequence classes. However, too small <italic>D<sub>max</sub></italic> values may lead to overfitted descriptions failing to capture the salient properties of the noisy discharge patterns. A solution to this problem is proposed in the following paragraph.</p>
</sec><sec id="s2c">
<title><italic>D<sub>max</sub></italic> selection and essential pattern extraction</title>
<p>In the present subsection and in the next we propose a general evaluation method applicable to both <italic>k</italic>-sequences and <italic>t</italic>-sequences. Thus, although we will always refer to <italic>k</italic> and <italic>k</italic>-sequences, the same analysis could be applied to <italic>t</italic>-sequences simply by <italic>k</italic> to <italic>t</italic> label substitution.</p>
<p>To choose the best <italic>D<sub>max</sub></italic> value we associate each <italic>D<sub>max</sub></italic> with a cost. The cost is evaluated taking into account the encoding length (in bits) needed to represent a selected model and, using a model-dependent encoding, the data. Being <italic>c<sub>min</sub>(k,D<sub>max</sub>)</italic> the smallest cost associated with a selected <italic>D<sub>max</sub></italic> value, we define<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e003" xlink:type="simple"/></disp-formula>as the smallest cost, given <italic>k</italic>, of a <italic>k</italic>-sequence dataset.</p>
<p>The encoding algorithm relies on a re-elaboration of a scheme proposed by Willems <xref ref-type="bibr" rid="pone.0004299-Willems1">[25]</xref> and is described in detail in <xref ref-type="supplementary-material" rid="pone.0004299.s001">Document S1</xref>. This scheme has a simple and direct interpretation in terms of information theory, being straight on implementable as a true compression algorithm.</p>
<p>In brief, the <italic>k</italic>-sequence classes are ordered in a database by the number of their occurrences. The database represents the model. Among the possible subsets constituted by the first <italic>M</italic> classes, the one accomplishing the shortest encoding length is selected. To exploit the model knowledge about an <italic>i<sup>th</sup></italic> class we need first <italic>2Nlog(k+1)</italic> bits to store the class in the model and then <italic>log(i)+log(D<sub>max</sub>)</italic> bits at each occurrence of a <italic>k</italic>-sequence belonging to that class (for details see <xref ref-type="supplementary-material" rid="pone.0004299.s001">Document S1</xref>). Because <italic>log(i)</italic> is an increasing function of the class position in the database, classes occurring at high frequency have a smaller cost than rare ones. Not all classes are necessarily stored in the model. Some of them may not occur enough times to be conveniently stored. The classes contained in the model constitute the essential patterns we are looking for to describe the most regular part of our finite dataset.</p>
<p>The total cost of encoding the data without the database is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e004" xlink:type="simple"/></disp-formula>and <italic>n<sub>tot</sub>(k)</italic> is the overall number of <italic>k</italic>-sequences. <italic>Nlog(k+1)</italic> represents an upper limit for the number of possible <italic>k</italic>-sequences not accounting for the fact that the spike sum over all dimensions is <italic>k</italic>. This is done for the sake of generality. In fact, in the present form, the cost criterion can be used with any kind of sampling procedure (like constant time bin sampling). This approach is equivalent to the use of a common encoder without any <italic>a priori</italic> knowledge on the sampling procedure used.</p>
<p>To select the best model we start to test the first class by computing<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e005" xlink:type="simple"/></disp-formula>and, iteratively, test an increasing class number. At each iteration <italic>i</italic>, we evaluate the differential cost <italic>Δc<sub>i,i−1</sub>(k,D<sub>max</sub>)</italic> of adding a new <italic>i<sup>th</sup></italic> class. Such cost is divided into three components<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e006" xlink:type="simple"/></disp-formula>and <italic>n(i)</italic> indicates the number of the <italic>i<sup>th</sup></italic> class occurrences in the dataset.</p>
<p><italic>Δc<sub>1,i,i−1</sub>(k,D<sub>max</sub>)</italic> represents the differential database cost, that is the number of bits we need to store a class in the database. <italic>Δc<sub>2,i,i−1</sub>(k,D<sub>max</sub>)</italic> represents the gain, achievable by encoding <italic>n(i) k</italic>-sequences once stored the <italic>i<sup>th</sup></italic> class in the database. <italic>Δc<sub>3,i,i−1</sub>(k,D<sub>max</sub>)</italic> represents the differential flag cost (see <xref ref-type="supplementary-material" rid="pone.0004299.s001">Document S1</xref>). The database cost constitutes a regret term for too short datasets and fades away for long sequences, while the flag cost increases linearly with the length of the dataset thus constituting a constant regret term for the number of classes.</p>
<p>For increasing values of <italic>i</italic>, the <italic>i<sup>th</sup></italic> class will be accepted if the differential cost <italic>Δc<sub>i,i−1</sub>(k,D<sub>max</sub>)</italic> is negative.</p>
<p>Iterations are stopped when this is not verified. The <italic>i<sup>th</sup></italic> class is rejected and, setting <italic>M = i−1</italic>, <italic>c<sub>min</sub>(k,D<sub>max</sub>) = c<sub>M</sub>(k,D<sub>max</sub>)</italic>.</p>
<p>The asymptotic upper bound for the average cost of a <italic>k</italic>-sequence is (for details see <xref ref-type="supplementary-material" rid="pone.0004299.s001">Document S1</xref>)<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e007" xlink:type="simple"/></disp-formula>where <italic>p</italic> is the probability distribution of the class occurrence (all classes, not only the essentials), <italic>H(p)</italic> its entropy and <italic>log(log((k+1)<sup>N</sup>+1)+1)</italic> an upper limit for the flag cost <italic>log(log(M+1)+1)</italic>.</p>
</sec><sec id="s2d">
<title>Characterization of essential patterns</title>
<p>The application of the cost criterion described in the previous paragraph enables us to extract, for any <italic>k</italic>, distinct classes of essential patterns. Such patterns are associated with the <italic>D<sub>max</sub></italic> value for which <italic>c<sub>min</sub>(k,D<sub>max</sub>) = c<sub>min</sub>(k)</italic>.</p>
<p>To characterize the ECs we use three measures: <italic>C(k)</italic>, <italic>S(k)</italic> and <italic>R(k)</italic>.</p>
<p><italic>C(k)</italic> stands for complexity, is a general descriptor of a <italic>k</italic>-sequence dataset and is given by the ratio<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e008" xlink:type="simple"/></disp-formula><italic>S(k)</italic> stands for segregation and is computed as follows<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e009" xlink:type="simple"/></disp-formula>being <italic>x<sub>i</sub>(z)</italic> the <italic>i<sup>th</sup></italic> dimension of the <italic>z<sup>th</sup> k</italic>-sequence in the dataset and, respectively, <italic>E<sub>k</sub></italic> and <italic>n<sub>ess</sub>(k)</italic> the set of indexes and the number of <italic>k</italic>-sequences belonging to ECs. <italic>S(k)</italic> enables us to discriminate <italic>k</italic>-sequences where spikes are significantly segregated in some subset of sources, from <italic>k</italic>-sequences where spikes are homogeneously distributed among them.</p>
<p>Finally, <italic>R(k)</italic> (reiteracy) concerns the way successive <italic>k</italic>-sequences shift among different classes. By the evaluation of <italic>R(k)</italic> we can detect the presence of stable patterns. Namely, given a symbol string associated with a multichannel recording, we estimate the probability <italic>P<sub>R</sub>(k)</italic> that successive <italic>k</italic>-sequences belong to the same EC<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e010" xlink:type="simple"/></disp-formula>where <italic>z</italic> is the <italic>z<sup>th</sup></italic> symbol of a string associated with the <italic>z<sup>th</sup> k</italic>-sequence of the dataset and <italic>A<sub>k</sub></italic> is the set of symbols representing all the distinct ECs (only the essential, not all classes). If <italic>P<sub>R</sub>(k)</italic> is significantly higher than expected by chance, reiteracy is detected and we set <italic>R(k) = 1</italic>, otherwise <italic>R(k) = 0</italic>.</p>
<p>An approximated <italic>P<sub>R0</sub>(k)</italic> distribution under the null hypothesis is obtained by <italic>N<sub>S</sub></italic> shuffles on the original symbol sequence. We call <italic>N<sub>&lt;</sub></italic> the number of estimates for which <italic>P<sub>R0</sub>(k)&lt;P<sub>R</sub>(k)</italic>. The null hypothesis is rejected at level <italic>α</italic> if <italic>α&gt;(1−N<sub>&lt;</sub>/N<sub>S</sub>)</italic>.</p>
<p>The indexes <italic>C</italic>, <italic>R</italic> and <italic>S</italic> may be meaningfully applied to both <italic>k</italic>-sequences and <italic>t</italic>-sequences. In case of <italic>k</italic>-sequences, <italic>C(k)</italic> represents the spatial complexity connected to the number and the diversity of all the possible configurations collected from a multichannel recording regardless of their duration. <italic>R(k)</italic>, the shift indicator between two different <italic>k</italic>-sequence classes, determines the switching properties of the system. Positive reiteracy on <italic>k</italic>-sequences may be due to small reverberant circuits, to intrinsic single neuron spiking dynamics or, more generally, to any stable differential activity that emerges over common mode modulations of the considered channels. Finally, <italic>S(k)</italic> represents the average euclidean distance from the homogeneous sequence, i.e. that sequence where all spikes are equally distributed among the sources.</p>
<p>The significance of <italic>C</italic>,<italic>R</italic> and <italic>S</italic>, when dealing with t-sequences (respectively <italic>C(t)</italic>,<italic>R(t)</italic> and <italic>S(t)</italic>) is less unambiguous. In fact, while <italic>C(k)</italic>,<italic>R(k)</italic> and <italic>S(k)</italic> values simply evaluate spatial regularities, <italic>C(t)</italic>, <italic>R(t)</italic> and <italic>S(t)</italic> values mix spatial and temporal information. Thus, a <italic>t</italic>-sequence may have a low <italic>C(t)</italic> because of either stereotyped spatial configurations or regular frequency modulations (or both). The same remark holds true for <italic>R(t)</italic> and <italic>S(t)</italic>. Although positive reiteracy may be due to stable spatial patterns and significant segregation to a sparse source recruitment, both <italic>R(t)</italic> and <italic>S(t)</italic> may be substantially affected by frequency modulations slower than the sampling frequency.</p>
</sec><sec id="s2e">
<title>An Explanatory Example</title>
<p>To gain a better understanding of the whole procedure let's consider the example data shown in <xref ref-type="fig" rid="pone-0004299-g001">Fig. 1A</xref>. After conditional sampling, the associated <italic>k</italic>-sequence set, given <italic>k</italic> = 5, is displayed in <xref ref-type="fig" rid="pone-0004299-g001">Fig. 1A (bottom)</xref>. As this dataset is a bit too short for our analysis we build a larger one simply by repeating six times each item. Then, we add some noise deleting one spike from each <italic>k</italic>-sequence and reassigning it randomly to one of the 3 channels of the same <italic>k</italic>-sequence. The resulting set is</p>
<p>2 2 1 1 1 2 4 2 3 3 3 0 0 1</p>
<p>0 1 3 4 2 2 1 0 0 0 1 3 3 1</p>
<p>3 2 1 0 2 1 0 3 2 2 1 2 2 3</p>
<p>2 4 1 3 2 3 0 0 0 1 3 1 2 2</p>
<p>2 1 2 0 0 0 3 4 2 3 2 2 1 0</p>
<p>1 0 2 2 3 2 2 1 3 1 0 2 2 3</p>
<p>2 1 1 1 2 3 3 3 1 3 0 0 0 3</p>
<p>1 3 3 1 2 2 0 1 1 1 3 4 3 1</p>
<p>2 1 1 3 1 0 2 1 3 1 2 1 2 1</p>
<p>3 2 2 2 2 0 1 1 2 4 2 3</p>
<p>2 2 1 0 1 4 4 2 1 0 2 1</p>
<p>0 1 2 3 2 1 0 2 2 1 1 1</p>
<p>We apply the clustering algorithm with three different values of <italic>D<sub>max</sub></italic>, respectively 4,12,48,75.</p>
<p>By associating a symbol with each distinct cluster we get the following strings:</p>
<p><italic>abcdefgahhillafgehahldecmebabccafmhiaildlimfbabddebgfi</italic></p>
<p><italic>aabbccdaaadbbacdcaaabbcbdcaaabbacdadadbbbddcaaabbcadcd</italic></p>
<p><italic>aabbbbaaaaabbababaaabbbbabaaabbabaaaaabbbaabaaabbbaaba</italic></p>
<p><italic>aabbbbaaaaabbababaaabbbbabaaabbabaaaaabbbaabaaabbbaaba</italic></p>
<p>Because <italic>D<sub>max</sub></italic> value is critical, we select the best description by using the evaluation criterion described in paragraph 3 and in <xref ref-type="supplementary-material" rid="pone.0004299.s001">Document S1</xref>.</p>
<p>The description associated with <italic>D<sub>max</sub></italic> = 12 is selected as the most synthetic, by our criterion, being the complexity <italic>C(5)</italic> = 0.95.</p>
<p>The dimension of the clusters <italic>a</italic>,<italic>b</italic>,<italic>c</italic>,<italic>d</italic> are respectively 12,12,9,12. The cost <italic>c<sub>0</sub>(5)</italic> is 418.76 bits, while <italic>c<sub>min</sub>(5)</italic> = 398.84 bits, being the differential database cost <italic>Δc<sub>1,3,0</sub>(5,12)</italic> = <italic>2MNlog(k+1)</italic> = 2*3*3*log(6) = 46.53 bits, the differential gain <italic>Δc<sub>2,3,0</sub></italic> = Σ<italic><sub>i</sub>(Nlog(k+1)−log(i)−log(D<sub>max</sub>))n(i)</italic> = −152.34 bits and the differential flag cost <italic>Δc<sub>3,3,0(</sub>5,12)</italic> = <italic>t(k)log(log(M+1)+1)</italic> = 85.59 bits.</p>
<p><italic>K</italic>-sequence classes <italic>a</italic>,<italic>b</italic>,<italic>c</italic> are defined by our criterion as essential, while <italic>d</italic> does not occur enough times. Writing ‘<italic>-</italic>’ for non-ECs the final string is</p>
<p><italic>aabb--daaadbba-d-aaabb-bd-aaabba-dadadbbbdd-aaabb-ad-d</italic></p>
<p>On this string we finally compute, on ECs, reiteracy and segregation (<italic>S</italic> = 2.24). To evaluate <italic>R(5)</italic>, we calculate <italic>P<sub>R</sub></italic> = 0.31 on the original final string, then we shuffle the final string <italic>N<sub>S</sub></italic> = 10000 times in order to obtain <italic>P<sub>R0</sub></italic> (<xref ref-type="supplementary-material" rid="pone.0004299.s002">Fig. S1</xref>). Having set <italic>α</italic> = 0.05, and being <italic>(1−N<sub>&lt;</sub>/N<sub>S</sub>)</italic> = 0.046 we conclude that reiteracy is significant (<italic>R</italic> = 1) at level 0.05 (but not at level 0.01).</p>
<p>We can repeat the same procedure with constant time bin sampling. To obtain a reasonable dataset we replicate 6 times the data in <xref ref-type="fig" rid="pone-0004299-g001">Fig. 1B</xref> and add noise as in the previous case. The resulting set is</p>
<p>2 2 1 0 2 2 0 4 3 2 3 0 0 1</p>
<p>0 2 1 5 2 1 1 1 0 1 2 3 6 1</p>
<p>3 2 1 3 1 2 0 2 2 2 1 0 2 3</p>
<p>2 0 4 4 1 3 1 0 1 1 0 4 4 2</p>
<p>1 0 0 0 1 1 1 5 3 3 1 0 0 1</p>
<p>2 1 3 1 3 2 1 3 1 1 0 3 1 2</p>
<p>2 0 0 1 2 0 4 3 2 2 0 1 1 2</p>
<p>2 1 5 1 3 1 0 1 1 2 3 6 3 3</p>
<p>2 2 3 3 0 0 3 1 2 2 0 1 1 0</p>
<p>1 3 4 1 3 0 0 0 2 0 4 2</p>
<p>0 2 0 0 0 3 5 2 3 1 1 0</p>
<p>0 2 1 4 3 0 3 3 0 0 2 3</p>
<p>Then we apply the whole algorithm again. With <italic>D<sub>max</sub></italic> = 4,12,48,75 we obtain the following strings:</p>
<p><italic>abcdbbefgbhjkiblgmifcdjjegmbbndioeghbbjkjolhmagjdnoefa</italic></p>
<p><italic>abcdbbefgbfhdabcgfafcdhhegfbbedahegfbbhdhhcffaghdehefa</italic></p>
<p><italic>aaabaacddadcbaaaddadabcccddaacbaccddaacbccaddadcbcccda</italic></p>
<p><italic>aaabaabaaaabbaaaaaaaabbbbaaaabbabbaaaabbbbaaaaabbbbbaa</italic></p>
<p>Because of the larger number of possible <italic>t</italic>-sequences in respect to <italic>k</italic>-sequences, we expect the optimal <italic>D<sub>max</sub></italic> value to increase. In fact the final string is associated with <italic>D<sub>max</sub></italic> = 75</p>
<p><italic>aaa-aa-aaaa--aaaaaaaa----aaaa--a--aaaa----aaaaa-----aa</italic></p>
<p>being the dimension of the class <italic>a</italic> equal to 75 and the values of C,S equal to respectively 0.9966, 1.6016. To use the cost criterion described, we set <italic>k</italic> at the largest value collected on a single channel during constant time bin sampling (<italic>k</italic> = 6).</p>
<p>Being <italic>(1−N<sub>&lt;</sub>/N<sub>S</sub>)</italic> = 0.0406 we conclude that reiteracy is significant at level <italic>α</italic> = 0.05.</p>
</sec><sec id="s2f">
<title>Cost criterion performances</title>
<p>In this paragraph we analyze the relation between Entropy (<italic>H</italic>) and our cost criterion evaluation. We test the cost criterion on two different sources. We then compute <italic>c<sub>min</sub>(k<sub>max</sub>)</italic> as a function of the message length <italic>n<sub>tot</sub></italic>. A source is composed of a regular and a random part. The regular part is constituted by few sequences that are repeated a number of times. The random part is constituted by random sequences generated by <italic>N</italic> independent extractions from a homogeneous distribution: namely, all integers ranging from 0 to <italic>k<sub>max</sub></italic> have probability <italic>1/(k<sub>max</sub>+1)</italic> of occurrence.</p>
<p>Each message is composed of <italic>r n<sub>tot</sub></italic> and <italic>(1−r) n<sub>tot</sub></italic> sequences belonging, respectively, to the regular and to the random part.</p>
<p>We define <italic>n<sub>r</sub></italic> the number of distinct sequences of the regular part. Each of them occurs <italic>rn<sub>tot</sub>/n<sub>r</sub></italic> times in a message.</p>
<p>If <italic>N</italic> and <italic>k<sub>max</sub></italic> are not too small<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.e011" xlink:type="simple"/></disp-formula>For an infinitely long message of <italic>n<sub>tot</sub></italic> sequences, <italic>H</italic> represents the smallest possible average description length of a sequence. The asymptotic evaluation of our cost criterion, <italic>c<sub>min</sub></italic>(<italic>k<sub>max</sub></italic>), in <xref ref-type="supplementary-material" rid="pone.0004299.s001">Document S1</xref>, provides a significantly less parsimonious description. This holds true also for finite length messages, as can be observed in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2A,B,G,H</xref>, where the average values of <italic>H/(Nlog(k<sub>max</sub>+1)C(k))</italic> are plotted as a function of <italic>n<sub>tot</sub></italic>. The difference between entropy and <italic>c<sub>min</sub></italic>(<italic>k<sub>max</sub></italic>) descreases as <italic>n<sub>tot</sub></italic> increases. Conversely, it strongly increases as a function of <italic>r</italic>.</p>
<fig id="pone-0004299-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0004299.g002</object-id><label>Figure 2</label><caption>
<title>Cost criterion performances.</title>
<p>Upper row (plots A,B,C,D,E,F) related to the first source. <italic>k<sub>max</sub></italic> = 10, <italic>N</italic> = 5. A) The function <italic>H/(C(k<sub>max</sub>)Nlog(k<sub>max</sub>+1))</italic> is estimated, as a function of <italic>n<sub>tot</sub></italic>, at different <italic>r</italic> values ranging from 0 to 1. B) The same as in A). Here the cost criterion is modified to start evaluation from <italic>Δc<sub>2,1</sub></italic> instead of <italic>Δc<sub>1,0</sub></italic>. C,D) <italic>M</italic> values estimated with the original (C) and the modified (D) criterion. E,F) <italic>D<sub>max</sub></italic> estimated with the original (C) and the modified (D) criterion. Lower row (plots G,H,I,J,K,L) related to the second source (<italic>k<sub>max</sub></italic> = 10, <italic>N</italic> = 5).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.g002" xlink:type="simple"/></fig>
<p>The more regular the message, the worse <italic>c<sub>min</sub></italic>(<italic>k<sub>max</sub></italic>) approximates <italic>H</italic>. The differential database cost <italic>Δc<sub>1,M,0</sub> = 2Nlog(k<sub>max</sub>+1)</italic>, accounting for the lowest <italic>H/(Nlog(k+1)C(k))</italic> values at low <italic>n<sub>tot</sub></italic>, fades away for increasing values of this parameter (see <xref ref-type="sec" rid="s2">Methods</xref> section). The differential flag cost <italic>Δc<sub>3,M,0</sub></italic> is independent of message length and accounts for the non-optimality at large <italic>n<sub>tot</sub></italic> values. <italic>Δc<sub>3,M,0</sub></italic> plays a key role in the choice of the EC number, typically leading to a conservative selection that prevents from overfitting. The contribution of <italic>Δc<sub>3,M,0</sub></italic> could be reduced by modifying and expanding the flag and the database structures, in order to use a single flag to encode several sequences. This possibility, under current experimental check, can effectively reduce <italic>Δc<sub>3,M,0</sub></italic> and the number of flags, and will be presented in a forthcoming paper. The differential flag cost <italic>Δc<sub>3,M,0</sub></italic> is sometimes too large and may impair the detection of regular patterns that are significantly present in the message. To avoid the problem, the cost criterion can be evaluated starting from <italic>M</italic> = 1 instead than from <italic>M</italic> = 0. Results obtained with this modification are drawn in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2B,D,K,H,J,L</xref> while those relative to the original algorithm are presented in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2A,C,E,G,I,K</xref>. The values of <italic>M</italic> and <italic>D<sub>max</sub></italic> are reported, respectively, in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2C,D,I,J</xref> and in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2E,F,K,L</xref>.</p>
<p>The regular part of the first source (<xref ref-type="fig" rid="pone-0004299-g002">Fig. 2A–F</xref>) is composed of the following sequences</p>
<p>1 10 5 1</p>
<p>3 5 5 2</p>
<p>10 0 5 3</p>
<p>10 2 5 10</p>
<p>2 9 6 10</p>
<p>having set <italic>k<sub>max</sub></italic> = 10. For short <italic>r</italic> or <italic>n<sub>tot</sub></italic> values no ECs are detected from our algorithm (white region in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2E,F</xref>). Instead, increasing these parameters, the algorithm always extracts four distinct ECs with <italic>D<sub>max</sub></italic> = 1(blue region in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2E,F</xref>). The sharp transition between 0 and 4 ECs can be expected because the regular sequences we introduced are really different from each other.</p>
<p>The following sequences</p>
<p>1 0 1 0 2 0 0 2</p>
<p>3 4 4 4 3 3 4 4</p>
<p>10 10 9 10 10 10 10 10</p>
<p>10 9 10 10 10 10 10 9</p>
<p>2 3 2 2 1 3 2 1</p>
<p>are used to generate the regular part of the second source (<xref ref-type="fig" rid="pone-0004299-g002">Fig. 2G–L</xref>). No ECs are detected for low <italic>r</italic> or <italic>n<sub>tot</sub></italic> values (white region in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2K,L</xref>). With slight increments of these parameters, a single EC is detected containing 7 or 8 distinct sequences of the regular part (violet region in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2I,J</xref> and red region in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2K,L</xref>). When the EC contains all 8 sequences <italic>D<sub>max</sub></italic> = 72. In comparison with those of the first source, these sequences are very similar to each other. Accordingly, when the number of their occurrence is not too high, the algorithm detects them as different noisy versions of a unique essential pattern. For further increments of <italic>n<sub>tot</sub></italic> or <italic>r</italic>, our algorithm returns, as ECs, 7 of the 8 sequences composing the regular part of the message (red region in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2I,J</xref> and blue region in <xref ref-type="fig" rid="pone-0004299-g002">Fig. 2K,L</xref>). As expected, when the repetition of single sequences becomes significant, the regular sequences cannot be seen as a single noisy pattern. In fact, if it is true, the occurrence of the distinct 72 sequences represented in the EC should roughly follow a homogeneous distribution. This is not the case because only 8 out of 72 sequences occur with high probability (<italic>r/8</italic>) while the remaining ones have probability <italic>(1−r)/11<sup>5</sup></italic>.</p>
<p>A number of other sources have been tested, by varying <italic>k<sub>max</sub></italic> and <italic>N</italic>, with matching results. In general, the non optimality of the cost criterion leads to conservative choices about the number of the ECs. Moreover, by slightly modifying the cost criterion, the selection of ECs becomes more inclusive. The algorithm typically achieves good performances in the separation of regular components from noise. These include well-tuned generalization capabilities to avoid noise-induced multiplication of the ECs for messages that are too short.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Simulations</title>
<p>We used four different simulation groups to validate the algorithm.</p>
<list list-type="order"><list-item>
<p>We generated independent geometric processes with the parameter <italic>p<sub>a</sub> = [p<sub>a1</sub> … p<sub>aN</sub>]</italic> for a wide range of <italic>N</italic> sources and spiking frequencies <italic>f<sub>a</sub> = p<sub>a</sub>\Δt</italic>.</p>
</list-item><list-item>
<p>We generated <italic>M</italic> independent geometric processes with the parameter <italic>p<sub>a</sub></italic>, given <italic>M≤N</italic>. We called these events <italic>activation processes</italic> (<xref ref-type="fig" rid="pone-0004299-g002">Fig. 2A</xref>). At each event of activation, processes were assigned to a random subset of <italic>N\M</italic> sources (<xref ref-type="fig" rid="pone-0004299-g002">Fig. 2B</xref>). Then, for a period of <italic>T</italic> time-bins (the length of the activation period), the activated sources were driven by independent geometric processes with parameter <italic>p<sub>b</sub> = f<sub>b</sub> Δt</italic>.</p>
</list-item><list-item>
<p>We used the same strategy as simulation group 2, but we assigned the <italic>M</italic> activation processes to <italic>M</italic> predefined subsets of <italic>N\M</italic> sources.</p>
</list-item><list-item>
<p>All predefined <italic>M</italic> subsets were driven by a common trigger following a geometric process with parameter <italic>p<sub>a</sub></italic>. When an event took place all subsets were activated at successive lags of <italic>T</italic> time-bins.</p>
</list-item></list>
<p>Activation processes embody the strong non-stationarity of neuronal activity typical both of conscious and unconscious states. In particular, they closely mimic the transition between ‘up’ and ‘down’ states recorded both intracellularly and extracellularly during recordings of ongoing activity in sleep or anesthesia <xref ref-type="bibr" rid="pone.0004299-Destexhe1">[26]</xref>. The term ‘up’ states commonly indicates a depolarized state of intracellular potential typically constituting the substrate for high frequency discharges. Conversely, the term ‘down’ states indicates a hyperpolarized state of intracellular potential leading the cell firing activity to very low frequency regimes.</p>
<p>Homogeneous poisson-like activity is simulated by group 1 (<xref ref-type="fig" rid="pone-0004299-g003">Fig. 3A</xref>). Multisite activation processes can randomly distribute over the spiking sources (like in group 2, <xref ref-type="fig" rid="pone-0004299-g003">Fig. 3B</xref>), repeat on stereotyped subsets of sources (group 3, <xref ref-type="fig" rid="pone-0004299-g003">Fig. 3C</xref>) and even exhibit precise serial patterns among the different subsets (group 4, <xref ref-type="fig" rid="pone-0004299-g003">Fig. 3D</xref>). Such serial patterns were effectively observed in hippocampal place cells of rats <xref ref-type="bibr" rid="pone.0004299-Lee1">[19]</xref> in recordings performed both during spatially constrained tasks and, soon after that, during sleep. Task-related serial patterns expressed during asleep could be time-compressed up to a factor of 20.</p>
<fig id="pone-0004299-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0004299.g003</object-id><label>Figure 3</label><caption>
<title>Structure of simulations 2,3,4.</title>
<p>A) Structure of a single simulated source. Spikes are displayed as blue points. (*) Represent an inter-spike interval during an active state, having set at <italic>f<sub>b</sub></italic> the mean frequency during the active periods. (**) Represent a period between two successive activation given <italic>f<sub>a</sub></italic> the mean frequency of activation occurrence. B) Given N = 4 channels, we can observe three successive activations of overlapping subsets of N/M = 2 channels.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.g003" xlink:type="simple"/></fig>
<p>Constant time bin sampling was obtained by dividing each simulation into constant periods containing, on average, <italic>k</italic> spikes. The x axes in plots H–J represent these progressively augmenting periods called, for brevity, <italic>&lt;k&gt;</italic>.</p>
<p>When applied to <italic>k</italic>-sequences, the evaluation criterion, described in subsection 2 of <xref ref-type="sec" rid="s2">Methods</xref>, works quite well for large <italic>k</italic> values, typically for <italic>k</italic>&gt;5, while fpr <italic>k</italic>&lt; = 5, the flag cost <italic>Δc<sub>3,1,0</sub></italic> is often much higher than the gain <italic>Δc<sub>1,M,0</sub></italic> and the overall minimum cost is <italic>c<sub>0</sub>(k)</italic>. In these cases, as suggested in <xref ref-type="sec" rid="s2">Methods</xref>, <italic>R(k)</italic> and <italic>S(k)</italic> have been computed by skipping <italic>Δc<sub>1,0</sub>(k)</italic>.</p>
<p>A number of simulations were performed for a wide range of <italic>f<sub>a</sub></italic>, <italic>f<sub>b</sub></italic>, <italic>M</italic>, <italic>N</italic> values. On each simulated dataset we applied the whole algorithm flow described in <xref ref-type="sec" rid="s2">Methods</xref>. Some typical outcomes are displayed for <italic>k</italic>-sequences in <xref ref-type="fig" rid="pone-0004299-g004">Fig. 4E–G</xref>,<xref ref-type="fig" rid="pone-0004299-g005">5E–G</xref> and for <italic>t</italic>-sequences in <xref ref-type="fig" rid="pone-0004299-g004">Fig. 4H–J</xref>,<xref ref-type="fig" rid="pone-0004299-g005">5H–J</xref>. The results obtained with conditional and constant time bin sampling can be similar (<xref ref-type="fig" rid="pone-0004299-g004">Fig. 4E–J</xref>) or very different (<xref ref-type="fig" rid="pone-0004299-g005">Fig. 5E–J</xref>).</p>
<fig id="pone-0004299-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0004299.g004</object-id><label>Figure 4</label><caption>
<title>Some typical results from simulations.</title>
<p>Time-bin resolution <italic>Δ</italic>t was set at 1 ms while the total number of spikes on each simulation was 5000. A) Sample plot of a group 1 simulation given <italic>N</italic> = 6, <italic>f<sub>a</sub></italic> = 2 Hz. B,C,D) Sample plot of simulation belonging to group 2,3,4. We set N = 6, <italic>f<sub>a</sub></italic> = 5 Hz, <italic>f<sub>b</sub></italic> = 50 Hz, M = 3, T = 50 ms. E,F,G) Estimation of <italic>S(k)</italic> (E),<italic>R(k)</italic> (F) and <italic>C(k)</italic> (G). H,J,K) Estimation of <italic>S(t)</italic> (H),<italic>R(t)</italic> (J) and <italic>C(t)</italic> (K). Blue, red gree and black lines respectively represent group 1,2,3,4.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.g004" xlink:type="simple"/></fig><fig id="pone-0004299-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0004299.g005</object-id><label>Figure 5</label><caption>
<title>Rejection of common mode modulation in simulations.</title>
<p>Time-bin resolution <italic>Δ</italic>t was set at 1 ms while the total number of spikes on each simulation was 5000. A) Sample plot of a group 1 simulation given <italic>N</italic> = 6, <italic>f<sub>a</sub></italic> = 2 Hz. B) Sample plot of simulation belonging to group 2. We set <italic>N</italic> = 6, <italic>f<sub>a</sub></italic> = 5 Hz, <italic>f<sub>b</sub></italic> = 50 Hz, <italic>M</italic> = 1, <italic>T</italic> = 50 ms. C) Magnification of the plot B indicated by the red rectangle D) Sample plot from a group 3 simulation where we set <italic>M</italic> = 3 (the other parameters are kept fixed). E,F,G) Estimation of <italic>S(k)</italic> (E),<italic>R(k)</italic> (F) and <italic>C(k)</italic> (G). H,J,K) Estimation of <italic>S(t)</italic> (H),<italic>R(t)</italic> (J) and <italic>C(t)</italic> (K). Blue and red lines respectively represent group 1,2.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.g005" xlink:type="simple"/></fig>
<p>These two conditions were obtained by keeping fixed <italic>f<sub>a</sub></italic>, <italic>f<sub>b</sub></italic>, <italic>M</italic>, <italic>N</italic> values and setting, respectively, <italic>M</italic> = 3 (<xref ref-type="fig" rid="pone-0004299-g004">Fig. 4</xref>) and <italic>M</italic> = 1 (<xref ref-type="fig" rid="pone-0004299-g005">Fig. 5</xref>).</p>
<p>In <xref ref-type="fig" rid="pone-0004299-g004">Fig. 4</xref> it is easy to see how, by using <italic>C(k)</italic>,<italic>R(k)</italic> and <italic>S(k)</italic> and given the same values of <italic>f<sub>a</sub></italic>, <italic>f<sub>b</sub></italic>, <italic>M</italic> and <italic>N</italic>, the different groups 2, 3 and 4 are effectively discriminated and suitably different from the simulations belonging to group 1. The distinction between groups 2 and 3–4 and between groups 4 and 2–3 is evident respectively for mean <italic>C(k)</italic> and <italic>R(k)</italic> or <italic>S(k)</italic> values, while group 1 is clearly separated from the others in all the plots. In a way, also <italic>C(t)</italic>, <italic>R(t)</italic> and <italic>S(t)</italic> allow for a net discrimination among the different kinds of simulations.</p>
<p>Strong discharge pattern segregation is present in small channel subsets in simulation groups 2,3 and 4 (<xref ref-type="fig" rid="pone-0004299-g004">Fig 4B–D</xref>). Accordingly, segregation values <italic>S(k)</italic> and <italic>S(t)</italic> (<xref ref-type="fig" rid="pone-0004299-g004">Fig. 4E and 4H</xref>) in these simulations are much larger than in group 1 (<xref ref-type="fig" rid="pone-0004299-g004">Fig 4A</xref>), where spiking discharges contained in the sequences are, on average, more homogeneously distributed over all the spiking sources.</p>
<p>In group 2, the subsets of <italic>N/M</italic> = 2 sources are randomly assigned across the <italic>N</italic> = 6 channels, so that one among the <italic>N!/(N−N/M)!(N/M)!</italic> = 15 different subsets may be selected at each activation occurrence. Instead, in simulation groups 3 and 4, the subsets are predefined and only 3 non-overlapping subsets may be activated. The different spatial complexity between simulation group 2 and simulation groups 3 and 4 is reliably detected by <italic>C(k)</italic> and <italic>C(t)</italic> values (<xref ref-type="fig" rid="pone-0004299-g004">Fig. 4F,I</xref>).</p>
<p>Reiteracy <italic>R(k)</italic>, like <italic>S(k)</italic>, enables us to distinguish between simulation group 4 and simulation groups 2 and 3. Simulation group 1 displays negligible reiteracy (<xref ref-type="fig" rid="pone-0004299-g004">Fig. 4G,J</xref>). The non-null values are due to the decay of the significance level <italic>α</italic>, caused by multiple comparisons. Simulation groups 2 and 3 exhibit substantive reiteracy along the considered <italic>k</italic> interval. The sharp <italic>R(k)</italic> decay in simulation groups 4 reflects the regular transition between non-overlapping source subsets. The <italic>k</italic> value coupled with the decay is proportional to the product N<italic>Tf<sub>b</sub>/M</italic>, as shown by additional simulations in <xref ref-type="supplementary-material" rid="pone.0004299.s002">Fig. S2</xref>. Given that N<italic>Tf<sub>b</sub></italic>/M is the average number of spikes occurring during a subset activation, this last result is not surprising.</p>
<p>Unlike <italic>R(k)</italic>, <italic>R(t)</italic> decays in simulation groups 4 is faster than in simulation groups 2 and 3. The higher reiteracy <italic>R(t)</italic> in simulation group 4 is due to the longer silent periods between activation occurrences.</p>
<p>In simulation group 1, independently from f<sub>a</sub>, we did not detect significant stable patterns.</p>
<p>In <xref ref-type="fig" rid="pone-0004299-g005">Fig. 5</xref>, having only one subset including all channels (<italic>M</italic> = 1), simulation groups 2–4 are equivalent. For this reason in <xref ref-type="fig" rid="pone-0004299-g005">Fig. 5</xref> we reported only the results obtained with simulation groups 1 and 2 (<xref ref-type="fig" rid="pone-0004299-g005">Fig. 5A–C,E–J</xref>).</p>
<p>No reiteracy was detected with <italic>k</italic>-sequences in simulation group 2 (<xref ref-type="fig" rid="pone-0004299-g005">Fig. 5J</xref>). This is expected because setting <italic>M</italic> = 1 means that channels are all equally modulated. Sample plots from this group are reported in <xref ref-type="fig" rid="pone-0004299-g005">Fig. 5B,C</xref>. We also reported, for the sake of comparison, a sample plot from a simulation belonging to the group 4 with <italic>M</italic> = 3 (<xref ref-type="fig" rid="pone-0004299-g005">Fig. 5D</xref>). Note that the activation of the different channel subsets follows stereotyped serial patterns. This is not the case for simulation group 2 (<xref ref-type="fig" rid="pone-0004299-g005">Fig. 5B,C</xref>). All the channels are simply turned on and off at the same time so that no spatial reiteracy should be detected with conditional sampling. This kind of sampling, as explained in <xref ref-type="sec" rid="s2">Materials and Methods</xref> and <xref ref-type="supplementary-material" rid="pone.0004299.s001">Document S1</xref>, is insensitive to most of the common mode frequency modulations.</p>
<p>Moreover, no significant difference between simulation groups 1 and 2 can be detected either in terms of segregation S(<italic>k</italic>) (<xref ref-type="fig" rid="pone-0004299-g005">Fig. 5E</xref>) or complexity C(<italic>k</italic>) (<xref ref-type="fig" rid="pone-0004299-g005">Fig. 5F</xref>).</p>
<p>Conversely, constant time bin sampling provides remarkable differences in all the measures (<xref ref-type="fig" rid="pone-0004299-g005">Fig. 5H,I,J</xref>). In particular, strong reiteracy is due to the slow frequency modulations represented by the alternation of active and silent periods across all the simulated channels.</p>
<p>Constant time bin sampling mixes temporal and spatial information. Constant time bin and conditional sampling provide matching results when spatial information is salient and represents a major determinant in the clustering procedure (<xref ref-type="fig" rid="pone-0004299-g004">Fig. 4</xref>). Otherwise, when the clustering is dominated by frequency modulations, these two sampling procedures can provide incoherent results (<xref ref-type="fig" rid="pone-0004299-g005">Fig. 5</xref>).</p>
</sec><sec id="s3b">
<title>Real data</title>
<p>Several recordings of ongoing activity were analyzed both in normal and neuropathic isofluorane-anaesthetized rats. Experimental methods and general results are reported in a dedicated paper (Storchi et al. Submitted) while here we just focus on three recording groups to show and discuss some typical outcomes.</p>
<p>The recording groups 1 and 2 were performed in two normal rats while recording group 3 was obtained from a rat neuropathic model (Seltzer model, <xref ref-type="bibr" rid="pone.0004299-Seltzer1">[27]</xref>), known to exhibit neuropathic-deafferentative phenomenologies. The indexes were estimated in each recording group on 25 successive recording epochs, 5000 being the total number of spikes in each epoch (see <xref ref-type="fig" rid="pone-0004299-g006">Fig. 6</xref>,<xref ref-type="fig" rid="pone-0004299-g007">7</xref>,<xref ref-type="fig" rid="pone-0004299-g008">8</xref>).</p>
<fig id="pone-0004299-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0004299.g006</object-id><label>Figure 6</label><caption>
<title>Recording from normal rat 1 (<italic>N</italic> = 5).</title>
<p>A) A sample from the analyzed activity. B) Simulated group 1 activity. The mean frequency on each channel was set at the same value of the associated channel from the recorded activity. C,D,E) Estimation of <italic>S(k)</italic> (C),<italic>R(k)</italic> (D) and <italic>C(k)</italic> (E) from the recorded (red lines) and the simulated (blue lines) activities. Note that, although generalized oscillations are strong in all channels, the nested organization detected with <italic>S(k)</italic>,<italic>C(k)</italic> and <italic>R(k)</italic> is not different from the random simulated activity. F,G,H) Estimation of <italic>S(k)</italic> (F),<italic>R(k)</italic> (G) and <italic>C(k)</italic> (H) from the recorded (red lines) and the simulated (blue lines) activities. Note the strong reiteracy <italic>R(t)</italic> due to successive silent periods and compare with the negligible reiteray <italic>R(k)</italic>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.g006" xlink:type="simple"/></fig><fig id="pone-0004299-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0004299.g007</object-id><label>Figure 7</label><caption>
<title>Recording from neuropathic rat (<italic>N</italic> = 5).</title>
<p>A) A sample from the analyzed activity. B) Simulated group 1 activity. The mean frequency on each channel was set at the same value of the associated channel from the recorded activity. C,D,E) Estimation of <italic>S(k)</italic> (C),<italic>R(k)</italic> (D) and <italic>C(k)</italic> (E) from the recorded (red lines) and the simulated (blue lines) activities. F,G,H) Estimation of <italic>S(k)</italic> (F),<italic>R(k)</italic> (G) and <italic>C(k)</italic> (H) from the recorded (red lines) and the simulated (blue lines) activities. Discharge patterns are remarkably more stable (see <italic>R(k)</italic> and, to a less extent, <italic>R(t)</italic>) than in the normal rats 1 and 2.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.g007" xlink:type="simple"/></fig><fig id="pone-0004299-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0004299.g008</object-id><label>Figure 8</label><caption>
<title>Recording from normal rat 2 (<italic>N</italic> = 5).</title>
<p>A) A sample from the analyzed activity. B) Simulated group 1 activity. The mean frequency on each channel was set at the same value of the associated channel from the recorded activity. C,D,E) Estimation of <italic>S(k)</italic> (C),<italic>R(k)</italic> (D) and <italic>C(k)</italic> (E) from the recorded (red lines) and the simulated (blue lines) activities. F,G,H) Estimation of <italic>S(k)</italic> (F),<italic>R(k)</italic> (G) and <italic>C(k)</italic> (H) from the recorded (red lines) and the simulated (blue lines) activities. Recorded activity strongly differs from the random-like condition.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.g008" xlink:type="simple"/></fig>
<p>Each recording epoch was compared to a simulation belonging to the group 1 for which the parameter vector <italic>p<sub>a</sub></italic> was set equal to the values estimated in that epoch on real data (see Simulation section).</p>
<p>From a rough observation, the surrogated data do not show evident differences in comparison with the real ones in recording groups 2 and 3 (<xref ref-type="fig" rid="pone-0004299-g006">Fig. 6A,B</xref>, <xref ref-type="fig" rid="pone-0004299-g007">7A,B</xref>). This could lead us to conclude that such recordings just reflect unstructured noisy discharge patterns. However, by applying our algorithm it is easy to see how the first impression could be somewhat misleading. In fact the recorded discharge patterns exhibit significant segregation (<xref ref-type="fig" rid="pone-0004299-g006">Fig. 6C,F</xref>, <xref ref-type="fig" rid="pone-0004299-g007">7C,F</xref>) and larger complexity (<xref ref-type="fig" rid="pone-0004299-g006">Fig. 6D,G</xref>, <xref ref-type="fig" rid="pone-0004299-g007">7D,G</xref>) in comparison with surrogated data. Moreover, reiteracy is also significant, mostly for low <italic>k</italic> values in recording group 2 and over all considered <italic>k</italic> intervals in recording group 3 (<xref ref-type="fig" rid="pone-0004299-g006">Fig. 6E,H</xref>, <xref ref-type="fig" rid="pone-0004299-g007">7E,H</xref>).</p>
<p>The <italic>R(k)</italic> decay for increasing values of k, as can be observed in recording group 2, may provide a measure of the mean latency of repetitive configurations. For experimental applications, the detection of the <italic>k</italic> value associated with the <italic>R(k)</italic> decay (<italic>k<sub>decay</sub></italic>) can constitute an interesting tool. The mean <italic>k<sub>decay</sub></italic>-sequence duration represent the average switching period among different discharge pattern configurations. An altered switching period could represent a marker for altered ongoing activity such as the one we can observe in animal models of neuropathic pain (unpublished data). More generally, spontaneously switching configurations may represent a suitable neural substrate to integrate and contextualize incoming sensory information, amplifying relevant inputs and skipping irrelevant ones. Gain modulations of neural responses driven by an internal scheduling is a well-known general computational principle that enables the performance of a variety of tasks such as attention selection or coordinate transformation <xref ref-type="bibr" rid="pone.0004299-Salinas1">[28]</xref>. The capacity to switch between different active spatial configurations is embedded in recurrent neural networks <xref ref-type="bibr" rid="pone.0004299-Salinas2">[29]</xref>. EC and reiteracy can be used in this context of recurrent networks, like small cortical networks, to investigate those switching properties <italic>in vivo</italic>.</p>
<p>While <italic>k</italic>-sequence and <italic>t</italic>-sequence processing provide comparable results in recording groups 2 and 3, remarkable differences were obtained in recording group 1. Only indexes <italic>C(t)</italic>,<italic>S(t)</italic>,<italic>R(t)</italic> detect significant departures from the surrogated data (<xref ref-type="fig" rid="pone-0004299-g008">Fig. 8F,G,H</xref>). In fact, while <italic>C(k)</italic>, <italic>S(k)</italic> and <italic>R(k)</italic> indexes significantly discriminated between recording groups 2 and 3 and the relative surrogated data, this was not the case for recording group 1 (<xref ref-type="fig" rid="pone-0004299-g008">Fig. 8C,D,E</xref>). In this recording group, the presence of generalized activations synchronized across the recording sites is clearly observable (<xref ref-type="fig" rid="pone-0004299-g008">Fig. 8A,B</xref>). Fast ‘up’ states occur in the spindle oscillation regime (conventionally in the 7–14 Hz frequency interval). The presence of well-defined spindle-like oscillations could also suggest the presence of structured spatial configurations that match frequency modulations. Again a rough observation in time domain (<xref ref-type="fig" rid="pone-0004299-g008">Fig. 8A,B</xref>) is inappropriate. Both <italic>C(k)</italic> and <italic>S(k)</italic> fail to detect non-random spatial organizations in the <italic>k</italic>-sequence dataset (<xref ref-type="fig" rid="pone-0004299-g008">Fig. 8C,E</xref>). Moreover, negligible reiteration is detected (<xref ref-type="fig" rid="pone-0004299-g008">Fig. 8D</xref>). The whole set of measures depicts a situation very similar to the one described by simulation group 2 with <italic>M</italic> = 1 (see Simulations section and compare <xref ref-type="fig" rid="pone-0004299-g008">Fig. 8E–G</xref> with <xref ref-type="fig" rid="pone-0004299-g005">Fig. 5E–G</xref>). Apparently all the sources are driven by the same process and the time-variance of the driving process is the only difference with the surrogated activity. The last result suggests that within and among single fast ‘up’ states, occurring in the spindle oscillations regime, whose onset and decay are well synchronized across the recording sites, spatial organization of discharge patterns can be negligible or absent. This is consistent with the results of Kurths and coworkers <xref ref-type="bibr" rid="pone.0004299-Zhou1">[30]</xref>, who simulated a biologically plausible network whose nodes where constituted by subnetworks of interacting excitable neurons. They found that weak couplings among and within nodes reflected a complex hierarchical structure, well matched with the underlying architectural connectivity, while too strong couplings resulted in an undifferentiated generalized oscillatory activity. In this regard it is important to note how conditional sampling provides results that are independent from generalized frequency modulations. The presence of reiteracy <italic>R(k)</italic> provides us with additional and complementary information in respect to spiking frequency oscillations. Namely stable active subsets may be present independently of common mode firing frequency modulations.</p>
<p>On the whole, the properties extracted by the application of index <italic>C(k)</italic>,<italic>S(k)</italic> and <italic>R(k)</italic> and briefly highlighted here could lead to significant advances in the analysis of ongoing brain activity.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>In this paper we present an original method to extract and characterize sequences with fixed numbers of spikes and distributed on multisite sources in multiple electrode recordings. Being the samples collected on the base of fixed spike counts, their occurrence is detected in a time-independent fashion <italic>k</italic> across the spiking sources. Time independence yields a basic advantage making insensitive to brain oscillations and distinguishes spatial dynamics of multisite discharge patterns. Starting from the basic observation that the assessment of all possible patterns is unachievable because of the diverging increase of possible configurations as a function of <italic>k</italic> and <italic>N</italic>, we embedded in our algorithm a procedure, based on clustering, to extract the most salient pattern structures that we called <italic>essential classes</italic> (EC). To characterize the dynamics within and among the detected classes, we introduced three simple measures (C; R; S) evaluating, respectively, the average pattern complexity, the structure of ECs and their stability in time. Several kinds of surrogate activity, ranging from random to strongly structured, were used to validate the algorithm. Its application to real data significantly revealed both random and non-random spatial structures of ongoing discharge patterns and, in several cases, their remarkable stability.</p>
<p>The main drawback of our conditional sampling technique emerges when spiking frequency, synchrony or the number of sources is high. In these cases, when several spiking sources discharge simultaneously next to the completion of a <italic>k</italic>-sequence, it could happen to collect sequences containing more than the predefined <italic>k</italic> spikes. For example, given <italic>k</italic> = 5 and <italic>N</italic> = 2, it is possible that, during the sampling procedure, after 4 spikes there is a simultaneous emission from the two sources, resulting in a sequence of 6 spikes. A criterion to decide which of the two spikes will go in the completing sequence and which in the following could solve this problem. However any criterion will be necessarily arbitrary. Because the number of “overloaded” <italic>k</italic>-sequences is negligible in both the simulations and the data analyzed, we reasonably skipped the problem, potentially more demanding with larger source numbers.</p>
<p>As it concerns the clustering procedure, the algorithm we used <xref ref-type="bibr" rid="pone.0004299-Boley1">[22]</xref>, <xref ref-type="bibr" rid="pone.0004299-Savaresi1">[23]</xref> was selected for its wise initialization and computational efficiency. We also used the farthest-first transversal clustering algorithm <xref ref-type="bibr" rid="pone.0004299-Hochbaum1">[31]</xref>.This has the important property of keeping the clustering cost, defined as the largest cluster radius, below a twofold value of the optimal clustering (irrespectively to the number of clusters). The results were qualitatively the same as the ones shown above. In principle, any kind of clustering algorithm could be introduced in the algorithmic flow.</p>
<p>The use of an encoding scheme, inspired by the work of Willems <xref ref-type="bibr" rid="pone.0004299-Willems1">[25]</xref>, proved to be quite conservative in the extraction of the EC (typically 1–20), exhibiting reasonable generalization performances and avoiding overfitting. The ability to separate repetitive and random occurring sequences and the relation between Entropy and the cost criterion length have been analyzed. The scheme we described is readily implementable as a compression algorithm. We think that, in some cases, we could achieve much better compression by modifying the flag structure. In order to reduce the flag number, a single flag could be modified to encode several blocks, increasing the compression rate of those <italic>k</italic>-sequence datasets with regular serial dynamics. Conceptually, our approach is not very different from the first formulation of Minimum Description Length (MDL) <xref ref-type="bibr" rid="pone.0004299-Rissanen1">[32]</xref>, known as the two-part MDL. In adjunct to MDL, the scheme we developed allows the separation of a regular component (composed of the ECs and all their k-sequences) from a more random one. The final description length is the shortest achievable by the scheme and is asymptotically bounded by the entropy plus a constant factor.</p>
<p>Several algorithms have been developed in the last decades to evaluate spontaneous and evoked activities.</p>
<p>The method we described is original and not straightforwardly comparable with other preexisting algorithms in terms of performance. Instead, given its substantial novelties, our algorithm can be used in addition to other algorithms in order to provide complementary information. The work of Abeles and colleagues <xref ref-type="bibr" rid="pone.0004299-Abeles1">[13]</xref>, <xref ref-type="bibr" rid="pone.0004299-Prut1">[15]</xref> deals with precisely timed repeating sequences (also called “cortical songs”) while, with conditional sampling, we skip the time dimension and focus on the order of occurrence of spike groups. Thus, when observing tonic activity regimes, our pattern characterization seemingly spatially complements the precise firing reverberation sequences of well-timed activations of the synfire chain model <xref ref-type="bibr" rid="pone.0004299-Abeles2">[33]</xref>.</p>
<p>Some authors took into account the use of relative order of spike occurrence by assigning a distinct symbol to each source <xref ref-type="bibr" rid="pone.0004299-Lee1">[19]</xref>, <xref ref-type="bibr" rid="pone.0004299-Smith1">[34]</xref>. Those methods rely on template matching and allow for deciding whether arbitrary, user-chosen patterns occur more often than expected by chance. Such valuable techniques are currently contributing to the discovery of unexpected spiking schemes, such as time-compressed replays of behavior-related spike sequences in cortex and hippocampus <xref ref-type="bibr" rid="pone.0004299-Nadasdy1">[18]</xref>–<xref ref-type="bibr" rid="pone.0004299-Euston1">[20]</xref>. Our algorithm equally uses the relative order of spike occurrences, but, with conditional sampling and clustering, it assigns distinct symbols to different multisource configurations. The method is less detailed (we skip the precise order of occurrence of single spikes in a sequence) but provides more general information about all possible recurrent patterns. The algorithm automatically selects the ECs with no need for <italic>a priori</italic> knowledge of the patterns to be tested.</p>
<p>Conditional sampling might grant complementary spatial information independent from the domain of brain oscillations. Oscillations are a widespread and complex intermingled thread, pervading, at different temporal scales, the whole brain dynamics <xref ref-type="bibr" rid="pone.0004299-Hoffman1">[35]</xref>, <xref ref-type="bibr" rid="pone.0004299-Huguenard1">[36]</xref>. Local Field Potentials (LFP) or Electroencephalogram (EEG) provided extensive knowledge about the oscillation bands generated, among others, in the thalamo-cortical loop, and about their neural substrate and their functional significance <xref ref-type="bibr" rid="pone.0004299-Steriade1">[7]</xref>–<xref ref-type="bibr" rid="pone.0004299-Steriade2">[9]</xref>.</p>
<p>Recent data support an extended view of neural processing from the sole time-domain measures of oscillating brain dynamics to seemingly time-independent complementary measures as introduced by our work. A recent study highlighted, by simulation runs, the presence of the same dominant discharge patterns at significantly different oscillation frequencies staggered both in wide and in sharply peaked bands <xref ref-type="bibr" rid="pone.0004299-Galn1">[37]</xref>. Our method, based on single unit recordings, combined with the time-frequency analysis of EEG and LFP, might provide an interesting multiscale approach aimed to join population oscillatory rhythms with multisite discharge patterns.</p>
<p>The characterization of essential patterns in terms of stability has a solid theoretical background in the great body of work developed to investigate the attractor dynamics of neuronal networks <xref ref-type="bibr" rid="pone.0004299-MeyerLindenberg1">[38]</xref>–<xref ref-type="bibr" rid="pone.0004299-Marder1">[41]</xref>. Attractors constitute the essential elements for memory storage and retrieval. Several maintenance mechanisms for attractors have been proposed, ranging from recurrent excitation within cell assemblies to synfire-chains and single-cell bistability.</p>
<p>The presence of stereotyped attractor-like configurations or motifs among the whole set of possible neural combinations is a common finding in works dealing with spatiotemporal characterization of ongoing dynamics. Yuste and coworkers <xref ref-type="bibr" rid="pone.0004299-Cossart1">[11]</xref>, showed the presence of precise and repetitive patterns of discharge in somatosensory thalamocortical slices using calcium imaging. Such patterns could either arise spontaneously at the onset of ‘up’ states or could be evoked by thalamic stimulation <xref ref-type="bibr" rid="pone.0004299-MacLean1">[12]</xref>. Interestingly, spontaneous and evoked patterns were statistically indistinguishable. Accordingly, they hypothesized that spatiotemporal discharge patterns are predefined in the cortex, the thalamus simply providing a trigger signal. Ordered serial activations of specific neural subsets were also observed with single units in vivo in S1 cortex of rats <xref ref-type="bibr" rid="pone.0004299-Luczak1">[10]</xref>. The result was quite generalizable because it was obtained both in urethane and ketamine-xylazine anaesthetized and in unanaesthetized rats.</p>
<p>When triggered by incoming sensory stimulations or by pending tasks, the spontaneous subset activations could constitute the neural substrate for gain modulations, a widely analyzed and debated general computational principle <xref ref-type="bibr" rid="pone.0004299-Seltzer1">[27]</xref>.</p>
<p>In general the algorithm we developed, thanks to conditional sampling, to its robustness in respect to noise and to the novel cost criterion, could lead to the uncovering of unobserved general properties of spiking network dynamics. We propose its application in characterization of ongoing dynamics in diverse physiological and pathological conditions (sleep, chronic pain, visual-attentive processes, memory based rehearsal of past experiences a.s.o.) Specifically, we briefly showed how our indexes <italic>C(k)</italic>,<italic>S(k)</italic>,<italic>R(k)</italic> could be able to characterize altered ongoing activity in an experimental model of chronic pain.</p>
<p>Beyond the issues already discussed, among future applications and developments, the relation between activity and the underlying anatomical substrate represents a promising field of investigation. Several theoretical works have evidenced the fundamental role exerted by structural motifs on the emergence of variable functional motifs, on different time and spatial scales <xref ref-type="bibr" rid="pone.0004299-Zhou1">[30]</xref>, <xref ref-type="bibr" rid="pone.0004299-Sporns1">[42]</xref>, <xref ref-type="bibr" rid="pone.0004299-Honey1">[43]</xref>. More recently, a paper addressing explicitly the mutual relationships between network architecture and dominant patterns of neural activity stressed how synaptic connections determine the repertoire of spatial patterns in spontaneous activity <xref ref-type="bibr" rid="pone.0004299-Huguenard1">[36]</xref>. Spatial configurations identified by our method could represent a further starting point to address the problem of relation between functional and anatomical connectivity.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pone.0004299.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.s001" xlink:type="simple"><label>Document S1</label><caption>
<p>In the first paragraph some examples of conditional sampling are provided. In the second the encoding scheme used to develop the cost function is described in detail. In the third an upper bound for cmin(k,Dmax) is calculated.</p>
<p>(0.12 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0004299.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.s002" xlink:type="simple"><label>Figure S1</label><caption>
<p>Estimated distribution of P<sub>r0</sub>. P<sub>r0</sub> estimated with N<sub>s</sub> = 10000 shuffles of the final string. The estimated value of P<sub>r</sub> is represented by the blue vertical line.</p>
<p>(1.41 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0004299.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0004299.s003" xlink:type="simple"><label>Figure S2</label><caption>
<p>R(k) values of a group 4 simulation. We set N = 6, M = 2, T = 100 ms, f<sub>a</sub> = 0.5 Hz and f<sub>b</sub> = 20(blu line), 40(red),60(green),80(black) and 100 Hz(cyan). The values M T f<sub>b</sub> = 4, 8, 12, 16, 20 Hz, as expected, well reflects the position of R(k) sharp decay.</p>
<p>(1.46 MB TIF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We are indebted to Daniel Freedman for useful discussions and detailed manuscript revision. We also wish to thank the unknown reviewers for their helpful suggestions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0004299-Rieke1"><label>1</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rieke</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Warland</surname><given-names>D</given-names></name>
<name name-style="western"><surname>de Ruyter van Steveninck</surname><given-names>RR</given-names></name>
<name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name>
</person-group>             <source>Spikes: Exploring The Neural Code</source>             <publisher-loc>MIT Press</publisher-loc>             <publisher-loc>Cambridge, MA</publisher-loc>          </element-citation></ref>
<ref id="pone.0004299-Panzeri1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Treves</surname><given-names>A</given-names></name>
</person-group>             <year>1996</year>             <article-title>Analytical estimates of limited sampling bias in different information measures.</article-title>             <source>Network</source>             <volume>7</volume>             <fpage>87</fpage>             <lpage>107</lpage>          </element-citation></ref>
<ref id="pone.0004299-Nemenman1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nemenman</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name>
<name name-style="western"><surname>de Ruyter van Steveninck</surname><given-names>RR</given-names></name>
</person-group>             <year>2004</year>             <article-title>Entropy and information in neural spike trains: progress on the sampling problem.</article-title>             <source>Phys Rev E</source>             <volume>69</volume>             <fpage>056111</fpage>          </element-citation></ref>
<ref id="pone.0004299-Panzeri2"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Senatore</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Montemurro</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Petersen</surname><given-names>RS</given-names></name>
</person-group>             <year>2007</year>             <article-title>Correcting for the sampling bias problem in spike train information measures.</article-title>             <source>J Neurophysiol</source>             <volume>98</volume>             <fpage>1064</fpage>             <lpage>1072</lpage>          </element-citation></ref>
<ref id="pone.0004299-Johnson1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Johnson</surname><given-names>DH</given-names></name>
<name name-style="western"><surname>Gruner</surname><given-names>MG</given-names></name>
<name name-style="western"><surname>Baggerly</surname><given-names>K</given-names></name>
</person-group>             <year>2001</year>             <article-title>Information-Theoretic Analysis of Neural Coding.</article-title>             <source>Journal of Computational Neuroscicence</source>             <volume>10</volume>             <fpage>47</fpage>             <lpage>69</lpage>          </element-citation></ref>
<ref id="pone.0004299-Vincent1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Vincent</surname><given-names>JL</given-names></name>
<name name-style="western"><surname>Patel</surname><given-names>GH</given-names></name>
<name name-style="western"><surname>Fox</surname><given-names>MD</given-names></name>
<name name-style="western"><surname>Snyder</surname><given-names>AZ</given-names></name>
<name name-style="western"><surname>Baker</surname><given-names>JT</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Intrinsic functional architecture in the anaesthetized monkey brain.</article-title>             <source>Nature</source>             <volume>447</volume>             <fpage>83</fpage>             <lpage>86</lpage>          </element-citation></ref>
<ref id="pone.0004299-Steriade1"><label>7</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Steriade</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Jones</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Llinas</surname><given-names>R</given-names></name>
</person-group>             <year>1990</year>             <source>Thalamic Oscillations and Signaling</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>John Wiley \&amp; Sons Publishers</publisher-name>          </element-citation></ref>
<ref id="pone.0004299-Contreras1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Contreras</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Destexhe</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Sejnowski</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Steriade</surname><given-names>M</given-names></name>
</person-group>             <year>1996</year>             <article-title>Control of Spatiotemporal Coherence of a Thalamic Oscillation by Corticothalamic Feedback Science</article-title>             <volume>274(5288)</volume>             <fpage>771</fpage>             <lpage>774</lpage>          </element-citation></ref>
<ref id="pone.0004299-Steriade2"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Steriade</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Amzica</surname><given-names>F</given-names></name>
</person-group>             <year>1998</year>             <article-title>Coalescence of sleep rythms and their chronology in corticothalamic networks.</article-title>             <source>Sleep Res Online</source>             <volume>1(1)</volume>             <fpage>1</fpage>             <lpage>10</lpage>          </element-citation></ref>
<ref id="pone.0004299-Luczak1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Luczak</surname><given-names>Artur</given-names></name>
<name name-style="western"><surname>Barthó</surname><given-names>Peter</given-names></name>
<name name-style="western"><surname>Marguet</surname><given-names>StephanL</given-names></name>
<name name-style="western"><surname>Buzsáki</surname><given-names>György</given-names></name>
<name name-style="western"><surname>Harris</surname><given-names>KennethD</given-names></name>
</person-group>             <year>2007</year>             <article-title>Sequential structure of neocortical spontaneous activity in vivo.</article-title>             <source>Proc Natl Acad Sci USA, January 2</source>             <volume>104</volume>             <fpage>347</fpage>             <lpage>352</lpage>          </element-citation></ref>
<ref id="pone.0004299-Cossart1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cossart</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Aronov</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Yuste</surname><given-names>R</given-names></name>
</person-group>             <year>2003</year>             <article-title>Attractor dynamics of network UP states in the neocortex.</article-title>             <source>Nature</source>             <volume>423</volume>             <fpage>283</fpage>             <lpage>288</lpage>          </element-citation></ref>
<ref id="pone.0004299-MacLean1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>MacLean</surname><given-names>JN</given-names></name>
<name name-style="western"><surname>Watson</surname><given-names>BO</given-names></name>
<name name-style="western"><surname>Aaron</surname><given-names>GB</given-names></name>
<name name-style="western"><surname>Yuste</surname><given-names>R</given-names></name>
</person-group>             <year>2005</year>             <article-title>Internal dynamics determine the cortical response to thalamic stimulation.</article-title>             <source>Neuron</source>             <volume>48(5)</volume>             <fpage>811</fpage>             <lpage>823</lpage>          </element-citation></ref>
<ref id="pone.0004299-Abeles1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Abeles</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Gerstein</surname><given-names>GL</given-names></name>
</person-group>             <year>1988</year>             <article-title>Detecting spatiotemporal firing patterns among simultaneously recorded single neurons.</article-title>             <source>J Neurophysiol</source>             <volume>60</volume>             <fpage>909</fpage>             <lpage>924</lpage>          </element-citation></ref>
<ref id="pone.0004299-Aertsen1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Aertsen</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Gerstein</surname><given-names>GL</given-names></name>
<name name-style="western"><surname>Habib</surname><given-names>MK</given-names></name>
<name name-style="western"><surname>Palm</surname><given-names>G</given-names></name>
</person-group>             <year>1989</year>             <article-title>Dynamics of neural firing correlation: modulation of “effective connectivity.”</article-title>             <source>J Neurophysiol</source>             <volume>61</volume>             <fpage>900</fpage>             <lpage>917</lpage>          </element-citation></ref>
<ref id="pone.0004299-Prut1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Prut</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Vaadia</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Bergman</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Haalman</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Slovin</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Abeles</surname><given-names>M</given-names></name>
</person-group>             <year>1998</year>             <article-title>Spatiotemporal Structure of Cortical Activity: Properties and Behavioral Relevance.</article-title>             <source>J Neurophysiol</source>             <volume>79</volume>             <fpage>2857</fpage>             <lpage>2874</lpage>          </element-citation></ref>
<ref id="pone.0004299-Tetko1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tetko</surname><given-names>IV</given-names></name>
<name name-style="western"><surname>Villa</surname><given-names>AEP</given-names></name>
</person-group>             <year>2001</year>             <article-title>A pattern grouping algorithm for analysis of spatiotemporal patterns in neuronal spike trains. 1. Detection of repeated patterns.</article-title>             <source>J Neurosci Methods</source>             <volume>105</volume>             <fpage>1</fpage>             <lpage>14</lpage>          </element-citation></ref>
<ref id="pone.0004299-Tetko2"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tetko</surname><given-names>IV</given-names></name>
<name name-style="western"><surname>Villa</surname><given-names>AEP</given-names></name>
</person-group>             <year>2001</year>             <article-title>A pattern grouping algorithm for analysis of spatiotemporal patterns in neuronal spike trains. 2. Application in simultaneous single unit recordings.</article-title>             <source>J Neurosci Methods</source>             <volume>105</volume>             <fpage>15</fpage>             <lpage>24</lpage>          </element-citation></ref>
<ref id="pone.0004299-Nadasdy1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nadasdy</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Hirase</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Czurko</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Csicsvari</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Buzsáki</surname><given-names>G</given-names></name>
</person-group>             <year>1999</year>             <article-title>Replay and time compression of recurring spike sequences in the hippocampus.</article-title>             <source>J Neurosci</source>             <volume>19</volume>             <fpage>9497</fpage>             <lpage>9507</lpage>          </element-citation></ref>
<ref id="pone.0004299-Lee1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lee</surname><given-names>AK</given-names></name>
<name name-style="western"><surname>Wilson</surname><given-names>MA</given-names></name>
</person-group>             <year>2002</year>             <article-title>Memory of sequential experience in the hippocampus during slow wave sleep.</article-title>             <source>Neuron</source>             <volume>36</volume>             <fpage>1183</fpage>             <lpage>1194</lpage>          </element-citation></ref>
<ref id="pone.0004299-Euston1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Euston</surname><given-names>DR</given-names></name>
<name name-style="western"><surname>Tatsuno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>McNaughton</surname><given-names>BL</given-names></name>
</person-group>             <year>2007</year>             <article-title>Fast-forward playback of recent memory sequences in prefrontal cortex during sleep.</article-title>             <source>Science</source>             <volume>318(5853)</volume>             <fpage>1147</fpage>             <lpage>50</lpage>          </element-citation></ref>
<ref id="pone.0004299-Faisal1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Faisal</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Luc</surname><given-names>PJS</given-names></name>
<name name-style="western"><surname>Daniel</surname><given-names>MW</given-names></name>
</person-group>             <year>2008</year>             <article-title>Noise in the nervous system.</article-title>             <source>Nat Neurosci</source>             <volume>9</volume>             <fpage>292</fpage>             <lpage>303</lpage>          </element-citation></ref>
<ref id="pone.0004299-Boley1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Boley</surname><given-names>DL</given-names></name>
</person-group>             <year>1998</year>             <article-title>Principal Direction Divisive Partitioning.</article-title>             <source>Data Mining and Knowledge Discovery</source>             <volume>2(4)</volume>             <fpage>325</fpage>             <lpage>344</lpage>          </element-citation></ref>
<ref id="pone.0004299-Savaresi1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Savaresi</surname><given-names>SM</given-names></name>
<name name-style="western"><surname>Boley</surname><given-names>DL</given-names></name>
</person-group>             <year>2004</year>             <article-title>A Comparative Analysis on the Bisecting k-means and the PDDP Clustering Algorithms.</article-title>             <source>International Journal on Intelligent Data Analysis</source>             <volume>8(4)</volume>             <fpage>345</fpage>             <lpage>362</lpage>          </element-citation></ref>
<ref id="pone.0004299-McKay1"><label>24</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>McKay</surname><given-names>DJC</given-names></name>
</person-group>             <year>2003</year>             <source>Information Theory, Inference, and Learning Algorithms.</source>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref>
<ref id="pone.0004299-Willems1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Willems</surname><given-names>FMJ</given-names></name>
</person-group>             <year>1989</year>             <article-title>Universal data compression and repetitions times.</article-title>             <source>IEEE Transaction on Information Theory</source>             <volume>35(1)</volume>             <fpage>44</fpage>             <lpage>53</lpage>          </element-citation></ref>
<ref id="pone.0004299-Destexhe1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Destexhe</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Hughes</surname><given-names>SW</given-names></name>
<name name-style="western"><surname>Rudolph</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Crunelli</surname><given-names>V</given-names></name>
</person-group>             <year>2007</year>             <article-title>Are corticothalamic ‘up’ states fragments of wakefulness?.</article-title>             <source>Trends Neurosci</source>             <volume>30(7)</volume>             <fpage>334</fpage>             <lpage>42</lpage>          </element-citation></ref>
<ref id="pone.0004299-Seltzer1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Seltzer</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Dubner</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Shir</surname><given-names>Y</given-names></name>
</person-group>             <year>1990</year>             <article-title>A novel behavioral model of neuropathic pain disorders produced in rats by partial sciatic nerve injury.</article-title>             <source>Pain</source>             <volume>43</volume>             <fpage>205</fpage>             <lpage>18</lpage>          </element-citation></ref>
<ref id="pone.0004299-Salinas1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Salinas</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Thier</surname><given-names>P</given-names></name>
</person-group>             <year>2000</year>             <article-title>Gain Modulation: A Major Computational Principle of the Central Nervous System.</article-title>             <source>Neuron</source>             <volume>27</volume>             <fpage>15</fpage>             <lpage>21</lpage>          </element-citation></ref>
<ref id="pone.0004299-Salinas2"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Salinas</surname><given-names>Emilio</given-names></name>
</person-group>             <year>2003</year>             <article-title>Background Synaptic Activity as a Switch Between Dynamical States in a Network.</article-title>             <source>Neural Comp</source>             <volume>15</volume>             <fpage>1439</fpage>             <lpage>1475</lpage>          </element-citation></ref>
<ref id="pone.0004299-Zhou1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zhou</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Zemanova</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Zamora</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Hilgetag</surname><given-names>CC</given-names></name>
<name name-style="western"><surname>Kurths</surname><given-names>J</given-names></name>
</person-group>             <year>2006</year>             <article-title>Hierarchical organization unveiled by functional connectivity in complex brain networks.</article-title>             <source>Phys Rev Lett</source>             <volume>97</volume>             <fpage>238103</fpage>          </element-citation></ref>
<ref id="pone.0004299-Hochbaum1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hochbaum</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Shmoys</surname><given-names>D</given-names></name>
</person-group>             <year>1985</year>             <article-title>A best possible heuristic for the k-center problem.</article-title>             <source>Math Op Res</source>             <volume>10</volume>             <fpage>180</fpage>             <lpage>184</lpage>          </element-citation></ref>
<ref id="pone.0004299-Rissanen1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rissanen</surname><given-names>J</given-names></name>
</person-group>             <year>1978</year>             <article-title>Modeling by the shortest data description.</article-title>             <source>Automatica</source>             <volume>14</volume>             <fpage>465</fpage>             <lpage>471</lpage>          </element-citation></ref>
<ref id="pone.0004299-Abeles2"><label>33</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Abeles</surname><given-names>M</given-names></name>
</person-group>             <year>1991</year>             <source>Corticonics: Neural Circuits of the Cerebral Cortex</source>             <publisher-loc>Cambridge, New York, USA</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref>
<ref id="pone.0004299-Smith1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smith</surname><given-names>AC</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>P</given-names></name>
</person-group>             <year>2006</year>             <article-title>A set probability technique for detecting relative time order across multiple neurons.</article-title>             <source>Neural Comp</source>             <volume>18</volume>             <fpage>1197</fpage>             <lpage>1214</lpage>          </element-citation></ref>
<ref id="pone.0004299-Hoffman1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hoffman</surname><given-names>KL</given-names></name>
<name name-style="western"><surname>Battaglia</surname><given-names>FP</given-names></name>
<name name-style="western"><surname>Harris</surname><given-names>K</given-names></name>
<name name-style="western"><surname>MacLean</surname><given-names>JN</given-names></name>
<name name-style="western"><surname>Marshall</surname><given-names>L</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>The upshot of up states in the neocortex: from slow oscillations to memory formation.</article-title>             <source>J Neurosci</source>             <volume>27(44)</volume>             <fpage>11838</fpage>             <lpage>41</lpage>          </element-citation></ref>
<ref id="pone.0004299-Huguenard1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Huguenard</surname><given-names>JR</given-names></name>
<name name-style="western"><surname>McCormick</surname><given-names>DA</given-names></name>
</person-group>             <year>2007</year>             <article-title>Thalamic synchrony and dynamic regulation of global forebrain oscillations.</article-title>             <source>Trends in Neurosciences</source>             <volume>30</volume>             <fpage>350</fpage>             <lpage>356</lpage>          </element-citation></ref>
<ref id="pone.0004299-Galn1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Galán</surname><given-names>RF</given-names></name>
</person-group>             <year>2008</year>             <article-title>On How Network Architecture Determines the Dominant Patterns of Spontaneous Neural Activity.</article-title>             <source>PLoS ONE</source>             <volume>3(5)</volume>             <fpage>e2148</fpage>          </element-citation></ref>
<ref id="pone.0004299-MeyerLindenberg1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Meyer-Lindenberg</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Ziemann</surname><given-names>U</given-names></name>
<name name-style="western"><surname>Hajak</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Cohen</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Berman</surname><given-names>KF</given-names></name>
</person-group>             <year>2002</year>             <article-title>Transitions between dynamical states of differing stability in the human brain.</article-title>             <source>PNAS</source>             <volume>99</volume>             <fpage>10948</fpage>             <lpage>10953</lpage>          </element-citation></ref>
<ref id="pone.0004299-Hopfield1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hopfield</surname><given-names>JJ</given-names></name>
</person-group>             <year>1982</year>             <article-title>Neural networks and physical systems with emergent collective computational abilities.</article-title>             <source>PNAS</source>             <volume>79</volume>             <fpage>2554</fpage>             <lpage>2558</lpage>          </element-citation></ref>
<ref id="pone.0004299-Amit1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Amit</surname><given-names>DJ</given-names></name>
<name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name>
</person-group>             <year>1997</year>             <article-title>Model of global spontaneous activity and local structured activity during delay periods in the cerebral cortex.</article-title>             <source>Cerebral Cortex</source>             <volume>7</volume>             <fpage>237</fpage>             <lpage>252</lpage>          </element-citation></ref>
<ref id="pone.0004299-Marder1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Marder</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Abbott</surname><given-names>LF</given-names></name>
<name name-style="western"><surname>Turrigiano</surname><given-names>GG</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Golowasch</surname><given-names>J</given-names></name>
</person-group>             <year>1996</year>             <article-title>Memory from the dynamics of intrinsic membrane currents.</article-title>             <source>PNAS</source>             <volume>93</volume>             <fpage>13481</fpage>             <lpage>13486</lpage>          </element-citation></ref>
<ref id="pone.0004299-Sporns1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sporns</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Kotter</surname><given-names>R</given-names></name>
</person-group>             <year>2004</year>             <article-title>Motifs in brain networks.</article-title>             <source>PLoS Biol</source>             <volume>2</volume>             <fpage>e369</fpage>          </element-citation></ref>
<ref id="pone.0004299-Honey1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Honey</surname><given-names>CJ</given-names></name>
<name name-style="western"><surname>Kotter</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Breakspear</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Sporns</surname><given-names>O</given-names></name>
</person-group>             <year>2007</year>             <article-title>Network structure of cerebral cortex shapes functional connectivity on multiple time scales.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>10240</fpage>             <lpage>10245</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>