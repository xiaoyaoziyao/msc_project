<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-11-10057</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0029188</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Evolutionary biology</subject>
            <subj-group>
              <subject>Behavioral ecology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Computer modeling</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Social and behavioral sciences</subject>
          <subj-group>
            <subject>Psychology</subject>
            <subj-group>
              <subject>Behavior</subject>
              <subj-group>
                <subject>Human performance</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Human relations</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Sociology</subject>
            <subj-group>
              <subject>Computational sociology</subject>
              <subject>Social networks</subject>
              <subject>Social research</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computer Science</subject>
          <subject>Evolutionary Biology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Network Homophily and the Evolution of the Pay-It-Forward Reciprocity</article-title><alt-title alt-title-type="running-head">Network Homophily and Reciprocity</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Chiang</surname>
            <given-names>Yen-Sheng</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Takahashi</surname>
            <given-names>Nobuyuki</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Sociology and Institute for Mathematical Behavioral Science, University of California Irvine, Irvine, California, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Behavioral Science, Hokkaido University, Sapporo, Japan</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Marshall</surname>
            <given-names>James A. R.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University of Sheffield, United Kingdom</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">yenshenc@uci.edu</email></corresp>
        <fn fn-type="con">
          <p>Analyzed the data: YSC. Wrote the paper: YSC NT.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <year>2011</year>
      </pub-date><pub-date pub-type="epub">
        <day>15</day>
        <month>12</month>
        <year>2011</year>
      </pub-date><volume>6</volume><issue>12</issue><elocation-id>e29188</elocation-id><history>
        <date date-type="received">
          <day>7</day>
          <month>6</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>22</day>
          <month>11</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Chiang, Takahashi</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>The pay-it-forward reciprocity is a type of cooperative behavior that people who have benefited from others return favors to third parties other than the benefactors, thus pushing forward a cascade of kindness. The phenomenon of the pay-it-forward reciprocity is ubiquitous, yet how it evolves to be part of human sociality has not been fully understood. We develop an evolutionary dynamics model to investigate how network homophily influences the evolution of the pay-it-forward reciprocity. Manipulating the extent to which actors carrying the same behavioral trait are linked in networks, the computer simulation model shows that strong network homophily helps consolidate the adaptive advantage of cooperation, yet introducing some heterophily to the formation of network helps advance cooperation's scale further. Our model enriches the literature of inclusive fitness theory by demonstrating the conditions under which cooperation or reciprocity can be selected for in evolution when social interaction is not confined exclusively to relatives.</p>
      </abstract><funding-group><funding-statement>The authors have no support or funding to report.</funding-statement></funding-group><counts>
        <page-count count="9"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Reciprocity has long been recognized as an important constituent of human sociality that functions to lubricate social and economic exchange <xref ref-type="bibr" rid="pone.0029188-Becker1">[1]</xref>–<xref ref-type="bibr" rid="pone.0029188-Kolm1">[2]</xref>. Reciprocity takes many forms depending on the relationship between the beneficiary and the benefactor. When a person does another a favor and receives a benefit in return directly from the same person, it is called direct reciprocity—in this case, reciprocal relationship is dyadic <xref ref-type="bibr" rid="pone.0029188-Axelrod1">[3]</xref>. When the sender and the recipient of favors involve more than two parties, reciprocity goes beyond a dyad and involves a group or a network. This is referred to as indirect reciprocity <xref ref-type="bibr" rid="pone.0029188-Nowak1">[4]</xref> or generalized exchange <xref ref-type="bibr" rid="pone.0029188-Takahashi1">[5]</xref>. In this case, person A delivers a benefit to person B and receives a benefit from a different person C. Different theories attempt account for why indirect reciprocity can be sustained. One line of arguments attributes C's kindness made to A to C's gratitude toward a favor he received earlier from a different third party. Indirect reciprocity operating in this manner can be portrayed as a process whereby one helps another, who in turn helps yet a different person, forming a pay-it-forward cascade <xref ref-type="bibr" rid="pone.0029188-Ekeh1">[6]</xref>–<xref ref-type="bibr" rid="pone.0029188-LviStruss1">[8]</xref>. In the biological literature, this kind of indirect reciprocity is also termed upstream reciprocity <xref ref-type="bibr" rid="pone.0029188-Nowak2">[9]</xref> or generalized reciprocity <xref ref-type="bibr" rid="pone.0029188-Rankin1">[10]</xref>–<xref ref-type="bibr" rid="pone.0029188-Barta1">[11]</xref>.</p>
      <p>Our daily life is full of examples of the pay-it-forward reciprocity. For example, people hold the door for those coming afterwards in public places <xref ref-type="bibr" rid="pone.0029188-Santamaria1">[12]</xref>. One reason to why the norm is held is that people walking ahead of us hold the door for us first, and in return we reciprocate by acting the same to people following us. In charity donation, a real story shows that family members of a father who benefits from organ donation of a stranger are eager to sign up as prospective organ donors, in the hope that they can be of someone else's help in the future <xref ref-type="bibr" rid="pone.0029188-Christakis1">[13]</xref>. Experimental studies convey a similar message that subjects are more willing to help if they have been helped before <xref ref-type="bibr" rid="pone.0029188-Bartlett1">[14]</xref>. Finally, as a fictional yet quite illuminating example, the movie “Pay it Forward” portraits how kindness as a campaign can initiate from a naïve child to the whole community <xref ref-type="bibr" rid="pone.0029188-Hyde1">[15]</xref>.</p>
      <p>Given the ubiquity of the pay-it-forward phenomenon, an important question to be addressed is how it evolves to be part of human sociality. Explaining the evolution of reciprocity is challenging as a reciprocator does not seem to fare better than an opportunist who receive favors without reciprocating. The difference in welfare would make opportunism more advantageous, thus eliminating the survival of reciprocity. It leads us to wonder when reciprocity would triumph over self-interest. Investigating the circumstances under which indirect reciprocity evolves has become a core research endeavor in evolutionary biology <xref ref-type="bibr" rid="pone.0029188-Nowak1">[4]</xref>, <xref ref-type="bibr" rid="pone.0029188-Nowak3">[16]</xref>–<xref ref-type="bibr" rid="pone.0029188-Panchanathan1">[17]</xref>.</p>
      <p>In stark contrast to direct reciprocity where interaction is limited to a dyad, the pay-it-forward reciprocity is conducted in a web of social interactions, which typically can be represented by network. In the network, a tie designates the flow of benefit from one node to the other. Cooperation unfolds in networks when a cooperator initiates providing favors to his network neighbors and the recipients of favor reciprocate by acting similarly to their network neighbors, pushing forward the reciprocity cascade. The problem is that reciprocity could not continue as long as there is any defector in the chain of the pay-it-forward process. Hence, how cooperators and defectors are spatially distributed in networks is critical to how far reciprocity cascading spreads.</p>
      <p>Boyd and Richerson <xref ref-type="bibr" rid="pone.0029188-Boyd1">[18]</xref> is arguably the first study to discuss the pay-it-forward reciprocity. Their model considers a ring structure and shows that reciprocity (termed the upstream tit-for-tat in their paper) is possible to emerge only when group size is small. Nowak and Roch <xref ref-type="bibr" rid="pone.0029188-Nowak2">[9]</xref> conceptually distinguish two forms of indirect reciprocity and derive the mathematical condition for the pay-it-forward behavior (called upstream reciprocity in their paper) to evolve. A major finding of their mathematical model shows that upstream reciprocity provides a beneficial condition for cooperation to evolve if coupled with direct reciprocity. In <xref ref-type="bibr" rid="pone.0029188-Nowak2">[9]</xref>, <xref ref-type="bibr" rid="pone.0029188-Boyd1">[18]</xref>, a special ring structure is under investigation. A recent simulation study <xref ref-type="bibr" rid="pone.0029188-Iwagami1">[19]</xref> extends the model to different networks beyond a ring.</p>
      <p>The above models were proposed with different focuses: <xref ref-type="bibr" rid="pone.0029188-Boyd1">[18]</xref> is concerned about group size; <xref ref-type="bibr" rid="pone.0029188-Nowak2">[9]</xref> investigates the effect of coupling two forms of reciprocity, and <xref ref-type="bibr" rid="pone.0029188-Iwagami1">[19]</xref> examines the effect of network topology. It is noteworthy that although the abovementioned models all address network effects to different extents, none of them is concerned with the issue of how actors of different kinds are linked in networks. Given a network, actors can be placed on the network in different manners, and the spatial arrangement could render unexpected advantages or disadvantages to the survival of reciprocity in evolutionary dynamics. A recent study that investigates the effect of interactive assortment shows that generalized reciprocity (or the pay-it-forward reciprocity termed here) is possible to evolve in groups when reciprocators interact with the like more often than random chance <xref ref-type="bibr" rid="pone.0029188-Rankin1">[10]</xref>. In this paper, we continue a similar research endeavor to study how network homophily—the degree to which actors are linked with the like in networks <xref ref-type="bibr" rid="pone.0029188-McPherson1">[20]</xref>—influences the evolution of the pay-it-forward reciprocity. Our model differs from <xref ref-type="bibr" rid="pone.0029188-Rankin1">[10]</xref> by considering a larger strategy space and local behavioral adaptation in networks. We derive an interesting finding that strong network homophily helps consolidate the adaptive advantage of cooperation, but some heterophily helps promote cooperation to a higher scale.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>The Model</title>
        <p>Nowak and Roch proposed a “helping game” to model the pay-it-forward problem <xref ref-type="bibr" rid="pone.0029188-Nowak2">[9]</xref> (see below). We draw on this helping game to construct an evolutionary dynamics model comprising three components: a population of actors, social networks, and a rule that governs actors' behavioral adaptation.</p>
        <sec id="s2a1">
          <title>Population</title>
          <p>Two behavioral traits dissect the population into four groups: the first trait (<italic>p</italic>) governs the behavior of initiating helping, and the second trait (<italic>q</italic>) controls behavior of reciprocity. With <italic>p</italic> = 1, actors deliver help, and do nothing with <italic>p</italic> = 0. When <italic>q</italic> = 1, actors reciprocate and do nothing with <italic>q</italic> = 0. Four types of actors or four different strategies are generated accordingly: perfect cooperators (PC) for p = 1, q = 1, classical cooperators (CC) for p = 1, q = 0, reciprocal cooperators (RC) for p = 0, q = 1, and defectors (D) for p = 0, q = 0.</p>
        </sec>
        <sec id="s2a2">
          <title>Adaptation of Behavior</title>
          <p>Intermittently along the course of evolutionary dynamics, actors update their behavior in reference to their network neighbors. They search for the actor in their network neighborhood (including themselves) with the highest accumulated payoff and imitate his behavioral traits. If more than one actor possesses the highest payoff, one of them is randomly selected for imitation. This “learning-from-the-best” adaptation rule is also termed ‘imitation updating’ <xref ref-type="bibr" rid="pone.0029188-Ohtsuki1">[21]</xref>. For robustness testing, we also consider other adaptation rules reported in the following section.</p>
        </sec>
        <sec id="s2a3">
          <title>Social Network</title>
          <p>Actors are placed on a network with ties linked to a subset of the population. The structure of links determines the potential recipients of help. When updating behavior, actors use the same network to look for targets for imitation. In this paper, we consider a particular network structure—the regular square lattice—as the baseline network. The regular square lattice with periodic boundary condition (a torus) has been intensively studied in biology. Research on the so-called “spatial game theory” has showed that lattice structure helps preserve cooperation in clusters against the invasion of defection <xref ref-type="bibr" rid="pone.0029188-Nowak4">[22]</xref>–<xref ref-type="bibr" rid="pone.0029188-Hauert1">[24]</xref>. In a regular lattice, each node has the same number of ties (nodal degree). Even though ties are possible to be rewired, described as follows, so that the prefect uniformity in nodal degree cannot maintain, difference in nodal degree is kept small over the network. This helps us to tease out the effect of heterogeneity in nodal degree on the evolution of reciprocity as was noted in <xref ref-type="bibr" rid="pone.0029188-Iwagami1">[19]</xref>.</p>
        </sec>
        <sec id="s2a4">
          <title>Network Homophily</title>
          <p>We set up a torus network component of equal size for each group defined in <xref ref-type="table" rid="pone-0029188-t001">Table 1</xref>. As a baseline, the four tori are isolated from one another, representing full network homophily, where actors of the same type are linked exclusively to one another (illustrated in <xref ref-type="fig" rid="pone-0029188-g001">Figure 1</xref> left panel). New networks are generated to loosen up network homophily by rewiring some of the intra-group ties to be inter-group ties (see <xref ref-type="fig" rid="pone-0029188-g001">Figure 1</xref> right panel). Through tie rewiring, we change the ecology of a node's network neighborhood without changing network density <xref ref-type="bibr" rid="pone.0029188-Centola1">[25]</xref>–<xref ref-type="bibr" rid="pone.0029188-Judd1">[26]</xref>, thereby eliminating the effect of network density on the evolution of reciprocity. Tie rewiring is governed by a vector of probabilities that sums up to 1. To be more specific, consider the four groups defined in <xref ref-type="table" rid="pone-0029188-t001">Table 1</xref>. For each torus component specific to group <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0029188.e001" xlink:type="simple"/></inline-formula>, each tie of the component is checked, and with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0029188.e002" xlink:type="simple"/></inline-formula>, the tie that at present connects a pair of nodes in torus component <italic>i</italic> is reconnected to a member in torus <italic>j</italic>. It follows that with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0029188.e003" xlink:type="simple"/></inline-formula> the tie stays intact, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0029188.e004" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0029188.e005" xlink:type="simple"/></inline-formula>. Note that each group has its own set of probabilities governing the direction of tie rewiring, independent of how ties are rewired in other groups.</p>
          <fig id="pone-0029188-g001" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0029188.g001</object-id>
            <label>Figure 1</label>
            <caption>
              <title>Networks before and after ties are rewired.</title>
              <p><bold>Left panel:</bold> Four isolated tori, each characterized by a nodal shape. <bold>Right panel:</bold> Slight tie-rewiring to neighboring groups generates some inter-group ties.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.g001" xlink:type="simple"/>
          </fig>
          <table-wrap id="pone-0029188-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029188.t001</object-id><label>Table 1</label><caption>
              <title>The Four Types of Actors in the Helping Game.</title>
            </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0029188-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.t001" xlink:type="simple"/><table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="2" rowspan="1">Return help received?</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">Yes</td>
                  <td align="left" colspan="1" rowspan="1">No</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" colspan="1" rowspan="1">Initiate providing help?</td>
                  <td align="left" colspan="1" rowspan="1">Yes</td>
                  <td align="left" colspan="1" rowspan="1">Perfect Cooperator</td>
                  <td align="left" colspan="1" rowspan="1">Classical Cooperator</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">No</td>
                  <td align="left" colspan="1" rowspan="1">Reciprocal Cooperator</td>
                  <td align="left" colspan="1" rowspan="1">Defector</td>
                </tr>
              </tbody>
            </table></alternatives></table-wrap>
          <p>We index every node in each baseline torus. When a tie is prompted to rewire, it detaches one end of the tie and reconnects the other to a node in a different group with the same index number as the detached node (see <xref ref-type="fig" rid="pone-0029188-g002">Figure 2</xref> for illustration). Which node is detached and which is reconnected is a random choice. In so doing, we minimize the impact of tie rewiring on causing large difference in nodal degree.</p>
          <fig id="pone-0029188-g002" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0029188.g002</object-id>
            <label>Figure 2</label>
            <caption>
              <title>Illustration of the rule of rewiring ties.</title>
              <p><bold>Upper panel:</bold> Square shaped nodes represent one group (strategy) while circle shaped nodes represent another. All actors are indexed consecutively in their original torus components. The figure shows the joint network neighborhoods of actor 1 and 2; nodes and edges beyond the joint neighborhoods are omitted. <bold>Lower panel:</bold> If the tie of square 1-square 2 is prompted to rewire to the circle group, one of the end nodes, here node 2, is detached from the tie, and the other node, node 1, is reconnected to circle node 2.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.g002" xlink:type="simple"/>
          </fig>
        </sec>
        <sec id="s2a5">
          <title>The Helping Game</title>
          <p>We model the evolutionary dynamics of the helping game embedded in networks. In each round, actors first decide whether to deliver help. Actors with <italic>p</italic> = 1 incur a cost <italic>c</italic> and randomly pick <bold>one</bold> network neighbor as the beneficiary of help worth <italic>b</italic>. Actors with <italic>q</italic> = 1 reciprocate the favors, if any, received from network neighbors. They compute how many times they were helped in the previous round and repay the same amount of help to a random set of network neighbors (sampling with replacement). Initiating and reciprocating favors are synchronous in each round so actors reciprocate favors received in the <bold>previous</bold> round. At the end of every <italic>s</italic> round, each actor searches for actor in his network neighborhood (including oneself) who has the highest accumulated payoff. He inherits this most “successful” actor's behavior traits. The simulation is terminated when no occurrence of behavioral imitation persists continuously for <italic>y</italic> rounds or repetitive cycles are found. Once the simulation stops, we record the share of each type of actor (or strategy) in the population.</p>
        </sec>
      </sec>
      <sec id="s2b">
        <title>Evolutionary Dynamics of Two Groups</title>
        <p>Before we discuss the results of the four groups defined in <xref ref-type="table" rid="pone-0029188-t001">Table 1</xref>, it is beneficial to gain some preliminary insights through studying the evolution of two groups (strategies) pair-wisely across the four groups. We simulate a population of two groups with equal share (1/2). Each group adopts a unique strategy. The probability of tie rewiring in one group is <italic>p<sub>1</sub></italic> and <italic>p<sub>2</sub></italic> in the other. Manipulating <italic>p<sub>1</sub></italic> and <italic>p<sub>2</sub></italic> from 0 to 1, we examine the share of each strategy at the end of the evolution.</p>
        <sec id="s2b1">
          <title>Perfect Cooperator vs. Defector</title>
          <p>Defectors dominate prefect cooperators in most networks investigated. It makes sense because defectors receive benefits without reciprocating while perfect cooperators pay the cost of providing favors to others. Evolutionary theory shows that cooperators can survive when they interact assortatively with one another <xref ref-type="bibr" rid="pone.0029188-Eshel1">[27]</xref> or form clusters in networks <xref ref-type="bibr" rid="pone.0029188-Nowak4">[22]</xref>. Our simulation result confirms the finding: as is shown in <xref ref-type="fig" rid="pone-0029188-g003">Figure 3</xref> (upper-left panel), perfect cooperators end up with a share higher than one-half when they are cohesive to one another, i.e., they do not experience too much tie rewiring and instead keep most of their ties linked to themselves. A few “bridging” ties to other groups help cooperators to increase popularity. Increasing inter-group ties is beneficial only when the degree of network homophily is high—after some critical point, more inter-group ties can no longer benefit the selection of cooperators in evolution.</p>
          <fig id="pone-0029188-g003" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0029188.g003</object-id>
            <label>Figure 3</label>
            <caption>
              <title>The evolutionary advantages of different kinds of actors.</title>
              <p><bold>Upper left panel:</bold> The evolutionary advantages of <bold>perfect</bold> cooperators over <bold>defectors</bold>. The contour plot quantifies the average share of perfect cooperators over 100 cases. Share below 0.5 is in white color, representing inferiority when competing with defectors. The two axes mark rewiring probabilities with an increment of 0.025. <bold>Upper right panel:</bold> The evolutionary advantages of <bold>perfect</bold> cooperators over <bold>classical</bold> cooperators. Share below 0.5 is in white color, representing inferiority when competing with classical cooperators. <bold>Lower left panel:</bold> The evolutionary advantages of <bold>perfect</bold> cooperators over <bold>reciprocal</bold> cooperators. Share below 0.5 is in white color, representing inferiority when competing with reciprocal cooperators. <bold>Lower right panel:</bold> The evolutionary advantages of <bold>reciprocal</bold> cooperators over <bold>classical</bold> cooperators. Share below 0.5 is in white color, representing inferiority when competing with classical cooperators.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.g003" xlink:type="simple"/>
          </fig>
        </sec>
        <sec id="s2b2">
          <title>Perfect Cooperator vs. Classical Cooperator</title>
          <p>The competition between perfect cooperators and classical cooperators is similar to that between perfect cooperator and defectors. Like defectors, classical cooperators never reciprocate so perfect cooperators are disadvantaged when interacting with classical cooperators. In <xref ref-type="fig" rid="pone-0029188-g003">Figure 3</xref> (upper right panel), perfect cooperators dominate the population when both groups do not experience much tie rewiring, leaving only a few inter-group ties linked in between.</p>
        </sec>
        <sec id="s2b3">
          <title>Perfect Cooperator vs. Reciprocal Cooperator</title>
          <p>Perfect cooperators have relatively higher popularity when interacting with reciprocal cooperators. This is due to the fact that reciprocal cooperators respond to prefect cooperators' favors, and therefore perfect cooperators are not as disadvantaged as when they face the other two types of actors. Similarly, perfect cooperators dominate when they are cohesive, but different from the two cases above, it does not require that reciprocal cooperators be cohesive as well.</p>
        </sec>
        <sec id="s2b4">
          <title>Classical Cooperator vs. Reciprocal Cooperator</title>
          <p><xref ref-type="fig" rid="pone-0029188-g003">Figure 3</xref> (lower right panel) shows that classical cooperators dominate reciprocal cooperators most of the time. Because classical cooperators initiate helping and reciprocal cooperators respond, the two groups seem to be equally advantageous. Scrutiny of the simulation result shows that indeed <bold>on average</bold> the two groups perform equally well, but the variation in payoff is larger among classical cooperators than among reciprocal cooperators. It implies that actors with the highest fitness level are more likely to be classical cooperators. Since the current model uses a learning-from-the-local-best adaptation rule, classical cooperators are more likely to be the target for imitation. Reciprocal cooperators, on the other hand, dominate when they are cohesive while classical cooperators are not.</p>
        </sec>
        <sec id="s2b5">
          <title>Other Relationships</title>
          <p>Defectors completely dominate classical cooperators as the latter benefit the former without receiving anything in return. Unlike perfect cooperators, classical cooperators do not return favors to one another, failing to accumulate sufficient payoffs through reciprocation to outperform the advantages of defectors derived from exploitation on cooperators. No action takes place in a world comprising defectors and reciprocal cooperators only as in this case no one initiates helping and triggers reciprocation.</p>
        </sec>
      </sec>
      <sec id="s2c">
        <title>Evolutionary Dynamics of Four Groups</title>
        <p>We now discuss the model of four groups. Recall we introduce a set of probabilities, amounting to 1, to govern the direction of tie rewiring for each group (structured as a torus component) and thereby generate new networks with different degrees of network homophily. Our goal is to investigate what probability set results in high share of each group in evolution. Exhausting the union of four sets of probabilities, one for each group, is in essence implausible. For example, suppose we divide the probability space from 0 to 1 in 10 intervals (0, 0.1, 0.2,…,1). For each group (strategy) <italic>i</italic>, under the constraint that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0029188.e006" xlink:type="simple"/></inline-formula>, there are 275 possible probability sets. Then for four groups, the total number of possible probability sets would be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0029188.e007" xlink:type="simple"/></inline-formula>. In light of the challenge, we use genetic algorithm to save the computational burden <xref ref-type="bibr" rid="pone.0029188-Mitchell1">[28]</xref>.</p>
        <p>The operation of genetic algorithm can be briefly described as follows. Let matrix <italic>P</italic>, a 4 by 4 matrix, collects the four sets of probabilities that govern tie rewiring. Each row represents the probability set for a group. The algorithm starts with a sample pool of <italic>P</italic>. Without loss of generality, we consider the following probability sets as the initial condition: {0.25, 0.25, 0.25, 0.25}, {0.5, 0.5, 0, 0}, {0, 0, 0.5, 0.5} and {0, 0.5, 0.5, 0}, which represent, respectively, uniform, right-skewed, left-skewed, and central-peaked distributions. Each group can be assigned one of the four probability sets so the total number of matrix <italic>P</italic> considered for the first generation is 4<sup>4</sup> = 256. Each matrix <italic>P</italic> in the pool generates a network, and we run the evolutionary model of the helping game on the network. We then check how well a network performs with respect to the popularity of the kind of strategy investigated. In reference to the performance record, the next generation of <italic>P</italic> would be produced over the following steps: (1) Randomly select two <italic>P</italic> matrices from the pool (with replacement) with probability in proportion to their performances (2) For the two selected matrices, denoted <italic>P<sub>i</sub></italic> and <italic>P<sub>j</sub></italic>, randomly choose two rows from one matrix to pair up with the alternative two rows chosen from the other matrix. A new matrix <italic>P</italic> is thus formed by inheriting half of <italic>P<sub>i</sub></italic> and half of <italic>P<sub>j</sub></italic> (3). Allow mutation to occur to the new matrix by randomly selecting one row and one element to uplift it by 0.1. Choose a different element of the same row to reduce it by 0.1. Mutation follows the constraint that that probability of rewiring be not over 1 or below 0.</p>
        <p>When genetic algorithm is run, average performance of the pool of <italic>P</italic> would improve as generations accumulate. In each generation, we target the <italic>P</italic> that performs the best with respect to the popularity of each strategy. We run the genetic algorithm for 100 generations, before which the share of each strategy is found to converge to a fixed level. For each strategy, we select the best ten matrices <italic>P</italic> and report their means and standard deviations in <xref ref-type="table" rid="pone-0029188-t002">Table 2</xref>. For better illustration of the data, representative networks generated by following these rewiring principles are shown in <xref ref-type="fig" rid="pone-0029188-g004">Figure 4</xref>.</p>
        <fig id="pone-0029188-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0029188.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Graphic illustration of the optimal networks.</title>
            <p><bold>Upper left panel:</bold> A representative network generated by following the optimal rewiring strategy selected by genetic algorithm to maximize the popularity of <bold>prefect</bold> cooperators. Clockwise from the tiptop of the layout: the first quadrant are nodes of defectors, followed by the second quadrant of reciprocal cooperators, the third quadrant of classical cooperators and finally the fourth quadrant of perfect cooperators. <bold>Upper right panel:</bold> A representative network generated by following the optimal rewiring strategy selected by genetic algorithm to maximize the popularity of <bold>reciprocal</bold> cooperators. The layout of nodes is same as above. <bold>Lower left panel:</bold> A representative network generated by following the optimal rewiring strategy selected by genetic algorithm to maximize the popularity of <bold>classical</bold> cooperators. The layout of nodes is same as above. <bold>Lower right panel:</bold> A representative network generated by following the optimal rewiring strategy selected by genetic algorithm to maximize the popularity of <bold>defectors</bold>. The layout of nodes is same as above.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.g004" xlink:type="simple"/>
        </fig>
        <table-wrap id="pone-0029188-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029188.t002</object-id><label>Table 2</label><caption>
            <title>Means and standard deviations (in parentheses) of the ten optimal matrices <italic>P</italic> for each type of actor.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0029188-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.t002" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="4" rowspan="1">Matrices P that achieve the maximum share of:</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">D(average share = 0.99)</td>
                <td align="left" colspan="1" rowspan="1">RC(average share = 0.78)</td>
                <td align="left" colspan="1" rowspan="1">CC(average share = 0.93)</td>
                <td align="left" colspan="1" rowspan="1">PC(average share = 0.70)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>D→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>D</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.06 (0.08)</td>
                <td align="left" colspan="1" rowspan="1">0.69 (0.08)</td>
                <td align="left" colspan="1" rowspan="1">0.11 (0.06)</td>
                <td align="left" colspan="1" rowspan="1">0.25 (0.10)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>D→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>RC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.37 (0.10)</td>
                <td align="left" colspan="1" rowspan="1">0.14 (0.07)</td>
                <td align="left" colspan="1" rowspan="1">0.11 (0.08)</td>
                <td align="left" colspan="1" rowspan="1">0.51 (0.19)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>D→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>CC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.31 (0.10)</td>
                <td align="left" colspan="1" rowspan="1">0.10 (0.05)</td>
                <td align="left" colspan="1" rowspan="1">0.74 (0.06)</td>
                <td align="left" colspan="1" rowspan="1">0.24 (0.16)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>D→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>PC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.26 (0.13)</td>
                <td align="left" colspan="1" rowspan="1">0.07 (0.04)</td>
                <td align="left" colspan="1" rowspan="1">0.04 (0.02)</td>
                <td align="left" colspan="1" rowspan="1">0 (0)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>RC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>D</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.68 (0.11)</td>
                <td align="left" colspan="1" rowspan="1">0.02 (0.04)</td>
                <td align="left" colspan="1" rowspan="1">0.01 (0.03)</td>
                <td align="left" colspan="1" rowspan="1">0.06 (0.07)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>RC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>RC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.30 (0.11)</td>
                <td align="left" colspan="1" rowspan="1">0.73 (0.08)</td>
                <td align="left" colspan="1" rowspan="1">0.11 (0.06)</td>
                <td align="left" colspan="1" rowspan="1">0.83 (0.08)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>RC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>CC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0 (0)</td>
                <td align="left" colspan="1" rowspan="1">0.10 (0.05)</td>
                <td align="left" colspan="1" rowspan="1">0.84 (0.07)</td>
                <td align="left" colspan="1" rowspan="1">0.11 (0.11)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>RC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>PC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.02 (0.04)</td>
                <td align="left" colspan="1" rowspan="1">0.15 (0.11)</td>
                <td align="left" colspan="1" rowspan="1">0.04 (0.05)</td>
                <td align="left" colspan="1" rowspan="1">0 (0)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>CC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>D</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.66 (0.11)</td>
                <td align="left" colspan="1" rowspan="1">0.18 (0.04)</td>
                <td align="left" colspan="1" rowspan="1">0.04 (0.05)</td>
                <td align="left" colspan="1" rowspan="1">0.09 (0.06)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>CC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>RC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.11 (0.14)</td>
                <td align="left" colspan="1" rowspan="1">0.76 (0.07)</td>
                <td align="left" colspan="1" rowspan="1">0.12 (0.09)</td>
                <td align="left" colspan="1" rowspan="1">0.70 (0.08)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>CC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>CC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.10 (0.07)</td>
                <td align="left" colspan="1" rowspan="1">0.06 (0.07)</td>
                <td align="left" colspan="1" rowspan="1">0.68 (0.06)</td>
                <td align="left" colspan="1" rowspan="1">0.21 (0.07)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>CC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>PC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.13 (0.10)</td>
                <td align="left" colspan="1" rowspan="1">0 (0)</td>
                <td align="left" colspan="1" rowspan="1">0.16 (0.07)</td>
                <td align="left" colspan="1" rowspan="1">0 (0)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>PC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>D</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.62 (0.19)</td>
                <td align="left" colspan="1" rowspan="1">0.00 (0)</td>
                <td align="left" colspan="1" rowspan="1">0.00 (0)</td>
                <td align="left" colspan="1" rowspan="1">0 (0)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>PC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>RC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.07 (0.05)</td>
                <td align="left" colspan="1" rowspan="1">0.83 (0.08)</td>
                <td align="left" colspan="1" rowspan="1">0.08 (0.09)</td>
                <td align="left" colspan="1" rowspan="1">0.10 (0)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>PC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>CC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.06 (0.06)</td>
                <td align="left" colspan="1" rowspan="1">0.00 (0)</td>
                <td align="left" colspan="1" rowspan="1">0.74 (0.11)</td>
                <td align="left" colspan="1" rowspan="1">0 (0)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>P</italic>
                  <bold>
                    <italic>
                      <sub>PC→</sub>
                    </italic>
                  </bold>
                  <sub>
                    <italic>PC</italic>
                  </sub>
                </td>
                <td align="left" colspan="1" rowspan="1">0.25 (0.21)</td>
                <td align="left" colspan="1" rowspan="1">0.17 (0.08)</td>
                <td align="left" colspan="1" rowspan="1">0.18 (0.06)</td>
                <td align="left" colspan="1" rowspan="1">0.90 (0)</td>
              </tr>
            </tbody>
          </table></alternatives></table-wrap>
        <p>The simulation results suggest that the population of perfect cooperators can grow as high as roughly 70% in networks that have the following properties: (1) perfect cooperators are cohesive to one another, leaving only a few ties linked to reciprocal cooperators; (2) reciprocal cooperators are cohesive, and (3) classical cooperators are highly linked with reciprocal cooperators. The first fact is consistent with the two-group case studied earlier: reciprocal cooperators are perfect cooperators' best partner as perfect cooperators are more advantaged when facing reciprocal cooperators than the other two types of actors. The second and the third facts, consistent with earlier findings as well (<xref ref-type="fig" rid="pone-0029188-g003">Figure 3</xref>), ensure that reciprocal cooperators be sustained in early stages of the evolution. This is important as survival of reciprocal cooperators is important to the expansion of perfect cooperators as they are a bridging group to convert the other two types of actors into perfect cooperators. The simulation data (not reported) shows that reciprocal cooperators are the first group in time to be converted to perfect cooperators, followed by classical cooperators and defectors. The proportion of conversion of each group follows the same order.</p>
        <p>The share of reciprocal cooperators can be as high as 78% if (1) they are cohesive to one another; and (2) perfect and classical cooperators, but not defectors, are strongly attached to them. Both classical and perfect cooperators are help initiators. Upon receiving the benefits from the two types of actors, if most of reciprocal cooperators' ties are directed to themselves, they reciprocate by doing favors to one another, which invokes further rounds of reciprocity, and the virtuous circle provides an advantage in adaptive fitness to reciprocal cooperators <xref ref-type="bibr" rid="pone.0029188-Axelrod2">[29]</xref>, <xref ref-type="bibr" rid="pone.0029188-Rankin1">[10]</xref>. Classical cooperators can take a proportion as high as 93% if all actors are highly linked to them. A similar condition applies to the prosperity of defectors with one exception— to gain popularity, it is required that defectors not link to one another. This makes sense as the encounter of two defectors does not benefit the adaptive value of each other.</p>
        <p>In sum, a selection of optimal tie-rewiring probability sets screened by genetic algorithm over a hundred generations shows that the prosperity of the four types of actors each requires somewhat different conditions. For classical cooperators, the key lies in attraction of ties from all types of actors, including themselves. The same principle applies to reciprocal cooperators, except that defectors must be shunned in this case. Similarly, defectors prosper by having a dense network with all other types of actors, but not themselves. In contrast, perfect cooperators need to be isolated in structure, and their expansion is channeled through a few bridging ties with reciprocal cooperators. Group cohesiveness, i.e., ties with same group members, is required for prosperity of each type of actor except for defectors. Only classical cooperators can prosper with a dense network with defectors. Finally, it is noteworthy that prosperity of one type of actor is determined in part by how other types of actors are structured—manifesting the property of interdependency in complex systems.</p>
      </sec>
      <sec id="s2d">
        <title>Notes on Robustness of the Results and Limitations of the Model</title>
        <p>The simulation results reported in <xref ref-type="table" rid="pone-0029188-t002">Table 2</xref> attempt to illustrate the general conditions beneficial to the popularity of each type of strategy. Using genetic algorithm, we attempt to locate the probability sets, wrapped up in matrix <italic>P</italic>, that would maximize the share of each strategy in the population. As a typical optimization problem, we cannot be sure that the optimal matrix <italic>P</italic> is unique, nor is there any perfect algorithm that guarantees all the optimal solutions be located. In light of these facts, one should treat the numeric information reported in <xref ref-type="table" rid="pone-0029188-t002">Table 2</xref> as a general trend rather than a unique optimal condition. Nevertheless, the consistency in results between the four-group and the two-group cases, wherein full probability space is considered, confirms the merit of using genetic algorithm for search of optimal solutions.</p>
        <p>The simulation results presented here are built on a set of parameters whose values are subject to modifications. We run more simulations reported below to see how the results change when some of the modeling assumptions are relaxed, parameter values are adjusted, or alternative solutions are considered.</p>
        <sec id="s2d1">
          <title>Regarding b (benefit of help) and c (cost of helping)</title>
          <p>It is well established in mathematical/evolutionary biology that the benefit-cost ratio (<italic>b</italic>/<italic>c</italic>) of helping is critical to the selection of cooperation. A simple rule, derived originally from Hamilton <xref ref-type="bibr" rid="pone.0029188-Hamilton1">[30]</xref>, predicts that cooperators are more likely to survive if the benefit-cost ratio is large, other conditions being equal. We manipulate the magnitude of <italic>b</italic>, leaving other conditions fixed in the simulation model, to test how the benefit-cost ratio influences the results. For each type of strategy (<xref ref-type="table" rid="pone-0029188-t001">Table 1</xref>), we adopt the corresponding optimal network-tie-rewiring probability matrix (<xref ref-type="table" rid="pone-0029188-t002">Table 2</xref>) as the network generation principle. We then replicate five-hundred random cases of the pay-it-forward game dynamics. The online supporting material (<xref ref-type="supplementary-material" rid="pone.0029188.s001">Figure S1</xref>, <xref ref-type="supplementary-material" rid="pone.0029188.s002">Figure S2</xref>, <xref ref-type="supplementary-material" rid="pone.0029188.s003">Figure S3</xref> and <xref ref-type="supplementary-material" rid="pone.0029188.s004">Figure S4</xref>) reports the average share of each strategy over different values of <italic>b</italic>. Clearly, increasing <italic>b</italic> leads to higher proportions of perfect and reciprocal cooperators in the population. The effect, however, is not as pronounced on the growth of defectors and classical cooperators.</p>
        </sec>
        <sec id="s2d2">
          <title>Regarding network density</title>
          <p>In the current model, we consider a regular square lattice network with the Neumann neighborhood (a torus) as the default network (before tie rewiring takes place). In the Neumann neighborhood, each actor has four network neighbors. When a torus is projected on a (two-dimensional) plane, each actor is neighboring others who have one-unit of distance moving on the two coordinates. We can increase network density by allowing actors to link to others further away on the plane. Widening the neighborhood radius from one (Neumann neighborhood) to four increases the number of neighbors per actor from 4 to 24 (full network in the current model setting with N = 100). We run more simulations, changing network density in this manner, to see how network density influences the results. The online supporting material (<xref ref-type="supplementary-material" rid="pone.0029188.s001">Figure S1</xref>, <xref ref-type="supplementary-material" rid="pone.0029188.s002">Figure S2</xref>, <xref ref-type="supplementary-material" rid="pone.0029188.s003">Figure S3</xref> and <xref ref-type="supplementary-material" rid="pone.0029188.s004">Figure S4</xref>) shows that increasing network density does not impede, but instead benefits the selection of perfect and reciprocal cooperators. The finding is opposite to the general rule discussed in network-reciprocity modeling <xref ref-type="bibr" rid="pone.0029188-Nowak1">[4]</xref>: cooperation thrives if <italic>b/c&gt;k</italic>, where k represents average number of network neighbors per actor. The discrepancy in the effect of network density is due to the difference in modeling assumption: in modeling cooperation game on graphs (or network reciprocity defined in <xref ref-type="bibr" rid="pone.0029188-Nowak1">[4]</xref>), an actor interacts with <bold>each</bold> of his network neighbors, while in the pay-it-forward game studied in earlier work <xref ref-type="bibr" rid="pone.0029188-Nowak2">[9]</xref>, <xref ref-type="bibr" rid="pone.0029188-Iwagami1">[19]</xref> and here, a helper randomly picks <bold>one</bold> network neighbor as the recipient of help. It is easy to see that increasing network density inflicts heavier burden on cooperators in the former case as a cooperator needs incur the cost of helping for each neighbor. While costly in the network reciprocity game, higher network density renders more opportunities to receive favors from others in the pay-it-forward game studied here. Reciprocating these favors, albeit costly, form a virtuous circle by reinforcing the evolutionary advantages of cooperators when they are structured cohesively in networks. It explains why there is a difference in the effect of network density between the two models of the evolution of cooperation.</p>
        </sec>
        <sec id="s2d3">
          <title>Regarding the adaptation rule</title>
          <p>Throughout the paper thus far, we use a deterministic learning-from-the-local-best adaptation rule. Its empirical validity recently has received some support from behavioral experiments <xref ref-type="bibr" rid="pone.0029188-Traulsen1">[31]</xref>.Certainly this is not the only adaptation rule available for consideration. To see whether adaptation rules make a difference in results, we run more simulations, each of which adopts a unique adaptation process currently studied in the literature, leaving other conditions same as specified in the method section. We refer to a recent study <xref ref-type="bibr" rid="pone.0029188-Yamauchi1">[32]</xref> that summarizes a great variety of combinations of adaptation rules and update dynamics. Three adaptation rules considered here are: Best Imitation—a deterministic adaptation rule that imitates the strategy of the most successful neighbor in fitness (the default model of the paper); Fermi function—a stochastic adaptation rule that transforms exponentially the difference in fitness to the probability of strategy imitation, and Linear Probability Payoff Difference—a stochastic adaptation rule that transforms linearly the difference in fitness to the probability of strategy imitation. Moreover, two update dynamics are investigated: synchronous updating—in each round, all actors first play the pay-it-forward game, followed by strategy adaptation, and asynchronous updating—actors take turns playing the game and updating strategies. The online supporting material (<xref ref-type="supplementary-material" rid="pone.0029188.s005">Table S1</xref>, <xref ref-type="supplementary-material" rid="pone.0029188.s006">Table S2</xref>, <xref ref-type="supplementary-material" rid="pone.0029188.s007">Table S3</xref> and <xref ref-type="supplementary-material" rid="pone.0029188.s008">Table S4</xref>) shows how each strategy performs in different combinations of adaptation rules and update dynamics. The tables report average share of each strategy in networks generated by following their optimal tie-rewiring probability sets respectively reported in <xref ref-type="table" rid="pone-0029188-t002">Table 2</xref>. In general, asynchronous updating is more beneficial than synchronous updating to the increase of each strategy. Among the adaptation rules considered here, Fermi function works the best, followed by best imitation and linear probability function. Thus, the result presented earlier in the paper, considering a deterministic best imitation rule, represents a modest estimation of the evolutionary result.</p>
          <p>There could be a difference, however, between learning-from-the-<italic>local</italic>-best and learning-from-the-<italic>global</italic>-best adaptation rule. Actors under the former rule learn from the most successful one in their local network neighborhoods, while under the latter rule, they target the most successful one in the whole population. Learning from the local best is a less radical selection rule in evolutionary dynamics, and it helps preserve cooperation in locality. As we can imagine, if actors possess local vision only, a cluster of cooperators would learn from each other and remain cooperators despite the fact that a few defectors on the skirt of the cluster might fare better by exploiting cooperators positioned on the periphery of the cluster. However, under certain circumstances local adaptation is not beneficial to the selection of cooperation. It has been shown that when adaptation is made locally, altruism not only benefits a rival's fitness, but also increases his evolutionary advantages in taking over the neighborhoods which they both compete for <xref ref-type="bibr" rid="pone.0029188-Taylor1">[33]</xref>–<xref ref-type="bibr" rid="pone.0029188-Queller1">[35]</xref>. To modify Hamilton's rule to this case, we need to consider the extra cost of altruism associated with increasing the competiveness of neighboring rivals <xref ref-type="bibr" rid="pone.0029188-Queller1">[35]</xref>. Without loss of generality, the current paper assumes that actors have local vision both in playing the cooperation game and behavioral adaptation. It is rather rare to see actors have a local vision in one thing, yet a global one in the other.</p>
        </sec>
        <sec id="s2d4">
          <title>Other issues</title>
          <p>Varying population size is not expected to change the results as long as the share of each strategy stays fixed in the initial condition. Note that in the current model we start with four isolated tori—one for each strategy—before ties are rewired. Each strategy, instead of clustering in one torus, could begin with a bunch of tori of smaller sizes. For this inquiry, we run three separate simulations with the same N = 576. In one simulation, each strategy starts structured in 16 tori of size 9; in another simulation, each strategy is in 4 tori of size 36, and in the last simulation, each strategy is in 1 torus of size 144. We run 500 cases for each condition. The results show a weak effect of group size: the share of a strategy increases slightly when it starts with a smaller number of tori of larger sizes. For example, for perfect cooperators, the share is 0.59 in the first condition, 0.66 in the second and 0.68 in the third.</p>
          <p>Other technical details that control the simulation process, such as the interval of behavioral updating (<italic>s</italic>) and the continuum of no imitation occurring (<italic>y</italic>) used to stop the simulation, do not make differences to the results.</p>
        </sec>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>Anecdotes about daily-life activities and research findings from laboratory experiments have confirmed the universality of the pay-it-forward reciprocity in human nature. What is less clear is how this kind of prosocial behavior comes into being given its inferiority in adaptive value than self-interested acts. More than two decades ago, Boyd and Richerson <xref ref-type="bibr" rid="pone.0029188-Boyd1">[18]</xref> drew a pessimistic conclusion based on their evolutionary model that the pay-it-forward reciprocity is not possible to emerge except in small groups. Yet, a recent study <xref ref-type="bibr" rid="pone.0029188-Rankin1">[10]</xref> shows that generalized reciprocity is possible to emerge so long as assortative interaction is implemented. In this article, we argue that the pay-it-forward reciprocity could prevail in large populations structured by networks under certain spatial arrangements. Following the framework of <xref ref-type="bibr" rid="pone.0029188-Nowak2">[9]</xref>, we develop an evolutionary model and examine how network homophily influences the evolution of the pay-it-forward reciprocity. The simulation results carry two main messages: first, actors who inherit the behavioral trait of reciprocity need to be cohesive to one another in order to resist the invasion of defectors or non-reciprocal cooperators. However, contacts with non-reciprocator groups, albeit slightly, is important to further increasing the popularity of reciprocity. The first principle helps consolidate the adaptive advantage of cooperators, while the second principle helps market cooperation to defectors or non-reciprocators. These two principles taken together imply that moderate heterogeneity in the demographic composition of network neighborhood is beneficial to the emergence of cooperation. This insight is consistent with modeling work on cooperation along a ring structure <xref ref-type="bibr" rid="pone.0029188-Ehsel1">[36]</xref>, collective action dynamics <xref ref-type="bibr" rid="pone.0029188-Chiang1">[37]</xref>, the evolution of social norms <xref ref-type="bibr" rid="pone.0029188-Boyd2">[38]</xref>, and empirical finding of the spread of contraceptive use in social networks <xref ref-type="bibr" rid="pone.0029188-Valente1">[39]</xref>.</p>
      <p>The first principle that cohesion is necessary for reciprocators to be adaptive is in line with the previous research on inclusive fitness that stems from the original work on kin selection <xref ref-type="bibr" rid="pone.0029188-Traulsen1">[31]</xref>. According to the theory of kin selection, altruistic behavior is adaptive when <italic>rb</italic>-<italic>c</italic>&gt;0, where <italic>c</italic> is the cost, <italic>b</italic> is the benefit, and <italic>r</italic> is the relatedness of the two actors. This simple inequality means that higher levels of cooperation are attained when <italic>r</italic> or <italic>b</italic> is higher while <italic>c</italic> is lower. This simple rule has been shown to explain altruistic behavior in a wide range of social conditions <xref ref-type="bibr" rid="pone.0029188-Marshall1">[40]</xref>. Two possible mechanisms through which a high <italic>r</italic> could arise between individuals are kin discrimination and limited dispersal <xref ref-type="bibr" rid="pone.0029188-West1">[41]</xref>. Kin discrimination means that an individual can distinguish between relatives and non-relatives and preferentially direct cooperation towards relatives. Limited dispersal means that offspring are born and live around parents <xref ref-type="bibr" rid="pone.0029188-Hamilton1">[30]</xref>. As an unintended consequence, relatedness becomes higher among interacting individuals. It means that even if individuals engage in altruistic behavior indiscriminately, their targets are likely to be their relatives. Our model echoes the limited dispersal argument of inclusive fitness theory although the inclusive fitness costs and benefits of cooperation in viscous population can cancel out, unless the scales of interaction and selection are different <xref ref-type="bibr" rid="pone.0029188-Taylor1">[33]</xref>–<xref ref-type="bibr" rid="pone.0029188-Queller1">[35]</xref>. This is because the more likely cooperators interact with one another, despite higher benefits being achieved, the less likely defectors outside the clusters of cooperators can be reached and adapted to cooperation. Our model shows that adequate interaction with a different kind of actors does not impede, but instead benefits the increase of cooperation. It is not only because contacts with heterogeneous others help propagate the adaptive advantages of cooperation to non-cooperators, but also because the evolutionary advantages of cooperation stem in part from cohesive interactions across two different, yet mutually beneficial types of actors, such as perfect cooperators and reciprocal cooperators in the pay-it-forward game. Our model thus enriches inclusive fitness theory by demonstrating some conditions under which interaction with non-relatives can be beneficial for cooperators to be adaptive.</p>
      <p>Network homophily—the tendency of agents to form social relationships with those with similar attributes or backgrounds—is a universal phenomenon in various domains, ranging from the formation of friendship in high schools <xref ref-type="bibr" rid="pone.0029188-Moody1">[42]</xref> to partner choice in marriage <xref ref-type="bibr" rid="pone.0029188-Kalmijn1">[43]</xref>. It is unclear why humans possess a strong propensity to associate with the like, but in the study on group cooperation and coordination, research shows that homophily helps reduce communication cost and signify group identity, thereby facilitating cooperation within groups <xref ref-type="bibr" rid="pone.0029188-Barros1">[44]</xref>. The benefit of increasing group welfare can explain in part why homophily becomes a strong psychological principle guiding the formation of social relationships. However, cooperation induced by group homophily is limited to same-group members. Larger-scale cooperation, such as combating global warming, would inevitably require alliances that go beyond local group boundaries. As is pointed out in this article, the ingredient of moderate heterogeneity added to a homophilous environment sometimes does not hamper, but instead benefits the propagation of cooperation, although how heterogeneous is seen as optimal depends on the social context in question.</p>
      <p>The current study hopes to stimulate more empirical research on the network foundation for the emergence of the pay-it-forward reciprocity. As is emphasized in this article, not only is the typology of networks, but also the spatial distribution of heterogeneous actors is critical to how far the conduct of reciprocity spreads. To empirically test the idea, one can, for example, categorize subjects based on their prosociality propensity <xref ref-type="bibr" rid="pone.0029188-Simpson1">[45]</xref> and then manipulate the spatial distribution of these subjects in network settings conducted either in the laboratory or in the field. Feedback from the empirical research and new models modified according to it will enhance our understanding of how human morality emerges.</p>
    </sec>
    <sec id="s4" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>List of Parameter Values (for the simulation results reported in the context)</title>
        <p>Population size (<italic>N</italic>) = 100</p>
        <p>Benefit of help (<italic>b</italic>) = 5</p>
        <p>Cost of helping (<italic>c</italic>) = 3</p>
        <p>Simulation is stopped if no imitation occurs for (<italic>y</italic>) = 200 rounds</p>
        <p>Behaviors are consider for adaptation for every (<italic>s</italic>) = 5 rounds</p>
        <p>Number of replications for each rewiring probability set: 50</p>
        <p>The pseudo-code of the simulation model can be found in the online supporting material (File S1).</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pone.0029188.s001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.s001" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p>
            <bold>Average share of defectors over different levels of </bold>
            <bold>
              <italic>b</italic>
            </bold>
            <bold> and network density.</bold>
          </p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0029188.s002" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.s002" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p>
            <bold>Average share of reciprocal cooperators over different levels of </bold>
            <bold>
              <italic>b</italic>
            </bold>
            <bold> and network density.</bold>
          </p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0029188.s003" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.s003" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p>
            <bold>Average share of classical cooperators over different levels of </bold>
            <bold>
              <italic>b</italic>
            </bold>
            <bold> and network density.</bold>
          </p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0029188.s004" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.s004" xlink:type="simple">
        <label>Figure S4</label>
        <caption>
          <p>
            <bold>Average share of perfect cooperators over different levels of </bold>
            <bold>
              <italic>b</italic>
            </bold>
            <bold> and network density.</bold>
          </p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0029188.s005" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.s005" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p>
            <bold>Average share of defectors in different combinations of update dynamics and adaptation rules.</bold>
          </p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0029188.s006" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.s006" xlink:type="simple">
        <label>Table S2</label>
        <caption>
          <p>
            <bold>Average share of reciprocal cooperators in different combinations of update dynamics and adaptation rules.</bold>
          </p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0029188.s007" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.s007" xlink:type="simple">
        <label>Table S3</label>
        <caption>
          <p>
            <bold>Average share of classical cooperators in different combinations of update dynamics and adaptation rules.</bold>
          </p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0029188.s008" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pone.0029188.s008" xlink:type="simple">
        <label>Table S4</label>
        <caption>
          <p>
            <bold>Average share of perfect cooperators in different combinations of update dynamics and adaptation rules.</bold>
          </p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="pone.0029188-Becker1">
        <label>1</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Becker</surname><given-names>H</given-names></name></person-group>             <year>1956</year>             <source>Man in Reciprocity</source>             <publisher-loc>New York, NY</publisher-loc>             <publisher-name>Prager</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0029188-Kolm1">
        <label>2</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kolm</surname><given-names>S-C</given-names></name></person-group>             <year>2009</year>             <source>Recirpocity: an economics of social relations</source>             <publisher-loc>New York, NY</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0029188-Axelrod1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Axelrod</surname><given-names>R</given-names></name><name name-style="western"><surname>Hamiltion</surname><given-names>WD</given-names></name></person-group>             <year>1981</year>             <article-title>The evolution of cooperation.</article-title>             <source>Science</source>             <volume>211</volume>             <fpage>1390</fpage>             <lpage>1396</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Nowak1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>Five rules for the evolution of cooperation.</article-title>             <source>Science</source>             <volume>314</volume>             <fpage>1560</fpage>             <lpage>1563</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Takahashi1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Takahashi</surname><given-names>N</given-names></name></person-group>             <year>2000</year>             <article-title>The emergence of generalized exchange.</article-title>             <source>American Journal of Sociology</source>             <volume>105</volume>             <fpage>1105</fpage>             <lpage>1134</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Ekeh1">
        <label>6</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ekeh</surname><given-names>P</given-names></name></person-group>             <year>1974</year>             <source>Social exchange theory: the two traditions</source>             <publisher-loc>Cambridge, MA</publisher-loc>             <publisher-name>Harvard University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0029188-Gouldner1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gouldner</surname><given-names>AW</given-names></name></person-group>             <year>1960</year>             <article-title>The norm of reciprocity.</article-title>             <source>American Sociological Review</source>             <volume>25</volume>             <fpage>161</fpage>             <lpage>178</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-LviStruss1">
        <label>8</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lévi-Struss</surname><given-names>C</given-names></name></person-group>             <year>1969</year>             <source>The elementary structures of kinship</source>             <publisher-loc>Boston, MA</publisher-loc>             <publisher-name>Beacon Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0029188-Nowak2">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>M</given-names></name><name name-style="western"><surname>Roch</surname><given-names>S</given-names></name></person-group>             <year>2007</year>             <article-title>Upstream reciprocity and the evolution of gratitude.</article-title>             <source>Proceedings of the Royal Society B</source>             <volume>274</volume>             <fpage>605</fpage>             <lpage>609</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Rankin1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rankin</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Taborsky</surname><given-names>M</given-names></name></person-group>             <year>2009</year>             <article-title>Assortment and the evolution of generalized reciprocity.</article-title>             <source>Evolution</source>             <volume>63</volume>             <fpage>1913</fpage>             <lpage>1922</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Barta1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Barta</surname><given-names>Z</given-names></name><name name-style="western"><surname>McNamara</surname><given-names>JM</given-names></name><name name-style="western"><surname>Huszár</surname><given-names>DB</given-names></name><name name-style="western"><surname>Taborsky</surname><given-names>M</given-names></name></person-group>             <year>2011</year>             <article-title>Cooperation among non-relatives evolves by state-dependent generalized reciprocity.</article-title>             <source>Proceedings of the Royal Society B</source>             <volume>278</volume>             <fpage>843</fpage>             <lpage>848</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Santamaria1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Santamaria</surname><given-names>JP</given-names></name><name name-style="western"><surname>Rosenbaum</surname><given-names>DA</given-names></name></person-group>             <year>2011</year>             <article-title>Etiquette and effort: holding doors for others.</article-title>             <source>Psychological Science</source>             <volume>22</volume>             <fpage>584</fpage>             <lpage>588</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Christakis1">
        <label>13</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Christakis</surname><given-names>N</given-names></name><name name-style="western"><surname>Fowler</surname><given-names>J</given-names></name></person-group>             <year>2009</year>             <source>Connected: the surprising power of our social networks and how they shape our lives</source>             <publisher-loc>New York, NY</publisher-loc>             <publisher-name>Little, Brown and Company</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0029188-Bartlett1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bartlett</surname><given-names>MY</given-names></name><name name-style="western"><surname>DeSteno</surname><given-names>D</given-names></name></person-group>             <year>2006</year>             <article-title>Gratitude and prosocial behavior.</article-title>             <source>Psychological Science</source>             <volume>17</volume>             <fpage>319</fpage>             <lpage>325</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Hyde1">
        <label>15</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hyde</surname><given-names>C</given-names></name></person-group>             <year>2000</year>             <source>Pay it forward</source>             <publisher-loc>La Jolla, CA</publisher-loc>             <publisher-name>Simon &amp; Schuster</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0029188-Nowak3">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>M</given-names></name><name name-style="western"><surname>Sigmund</surname><given-names>K</given-names></name></person-group>             <year>1998</year>             <article-title>Evolution of indirect reciprocity by image scoring.</article-title>             <source>Nature</source>             <volume>393</volume>             <fpage>573</fpage>             <lpage>577</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Panchanathan1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Panchanathan</surname><given-names>K</given-names></name><name name-style="western"><surname>Boyd</surname><given-names>R</given-names></name></person-group>             <year>2004</year>             <article-title>Indirect reciprocity can stabilize cooperation without the second-order free-rider problem.</article-title>             <source>Nature:</source>             <volume>432</volume>             <fpage>499</fpage>             <lpage>502</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Boyd1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Boyd</surname><given-names>R</given-names></name><name name-style="western"><surname>Richerson</surname><given-names>P</given-names></name></person-group>             <year>1989</year>             <article-title>The evolution of indirect reciprocity.</article-title>             <source>Social Networks</source>             <volume>11</volume>             <fpage>213</fpage>             <lpage>236</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Iwagami1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Iwagami</surname><given-names>A</given-names></name><name name-style="western"><surname>Masuda</surname><given-names>N</given-names></name></person-group>             <year>2010</year>             <article-title>Upstream reciprocity in heterogeneous networks.</article-title>             <source>Journal of Theoretical Biology</source>             <volume>265</volume>             <fpage>297</fpage>             <lpage>305</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-McPherson1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>McPherson</surname><given-names>M</given-names></name><name name-style="western"><surname>Smith-Lovin</surname><given-names>L</given-names></name><name name-style="western"><surname>Cook</surname><given-names>J</given-names></name></person-group>             <year>2001</year>             <article-title>Birds of a feather.</article-title>             <source>Annual Review of Sociology</source>             <volume>27</volume>             <fpage>415</fpage>             <lpage>444</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Ohtsuki1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ohtsuki</surname><given-names>H</given-names></name><name name-style="western"><surname>Nowak</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>The replicator equation on graphs.</article-title>             <source>Journal of Theoretical Biology</source>             <volume>243</volume>             <fpage>86</fpage>             <lpage>97</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Nowak4">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>M</given-names></name><name name-style="western"><surname>May</surname><given-names>RM</given-names></name></person-group>             <year>1992</year>             <article-title>Evolutionary games and spatial chaos.</article-title>             <source>Nature</source>             <volume>359</volume>             <fpage>826</fpage>             <lpage>829</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Nowak5">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>M</given-names></name><name name-style="western"><surname>Bonhoeffer</surname><given-names>S</given-names></name><name name-style="western"><surname>May</surname><given-names>RM</given-names></name></person-group>             <year>1994</year>             <article-title>Spatial games and the maintenance of cooperation.</article-title>             <source>PNAS</source>             <volume>91</volume>             <fpage>4877</fpage>             <lpage>4881</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Hauert1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hauert</surname><given-names>C</given-names></name><name name-style="western"><surname>Doebeli</surname><given-names>M</given-names></name></person-group>             <year>2004</year>             <article-title>Spatial structure often inhibits the evolution of cooperation in the snowdrift game.</article-title>             <source>Nature</source>             <volume>428</volume>             <fpage>643</fpage>             <lpage>646</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Centola1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Centola</surname><given-names>D</given-names></name></person-group>             <year>2010</year>             <article-title>The spread of behavior in an online social network experiment.</article-title>             <source>Science</source>             <volume>329</volume>             <fpage>1194</fpage>             <lpage>1197</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Judd1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Judd</surname><given-names>S</given-names></name><name name-style="western"><surname>Kearns</surname><given-names>M</given-names></name><name name-style="western"><surname>Vorobeychik</surname><given-names>Y</given-names></name></person-group>             <year>2010</year>             <article-title>Behavioral dynamics and influence in networked coloring and consensus.</article-title>             <source>PNAS</source>             <volume>107</volume>             <fpage>14978</fpage>             <lpage>14982</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Eshel1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eshel</surname><given-names>I</given-names></name><name name-style="western"><surname>Cavalli-Sforza</surname><given-names>LL</given-names></name></person-group>             <year>1982</year>             <article-title>Assortment of encounters and evolution of cooperativeness.</article-title>             <source>PNAS</source>             <volume>79</volume>             <fpage>1331</fpage>             <lpage>1335</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Mitchell1">
        <label>28</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mitchell</surname><given-names>M</given-names></name></person-group>             <year>1998</year>             <source>An introduction to genetic algorithms</source>             <publisher-loc>Cambridge, MA</publisher-loc>             <publisher-name>MIT Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0029188-Axelrod2">
        <label>29</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Axelrod</surname><given-names>R</given-names></name></person-group>             <year>1984</year>             <source>The evolution of cooperation</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Basic Books</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0029188-Hamilton1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hamilton</surname><given-names>WD</given-names></name></person-group>             <year>1964</year>             <article-title>The genetical evolution of social behavior I and II.</article-title>             <source>Journal of Theoretical Biology</source>             <volume>7</volume>             <fpage>1</fpage>             <lpage>52</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Traulsen1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Traulsen</surname><given-names>A</given-names></name><name name-style="western"><surname>Semann</surname><given-names>D</given-names></name><name name-style="western"><surname>Sommerfeld</surname><given-names>RD</given-names></name><name name-style="western"><surname>Krambeck</surname><given-names>H-J</given-names></name><name name-style="western"><surname>Milinkski</surname><given-names>M</given-names></name></person-group>             <year>2010</year>             <article-title>Human strategy updating in evolutionary games.</article-title>             <source>PNAS</source>             <volume>107</volume>             <fpage>2962</fpage>             <lpage>2966</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Yamauchi1">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yamauchi</surname><given-names>A</given-names></name><name name-style="western"><surname>Tanimoto</surname><given-names>J</given-names></name><name name-style="western"><surname>Hagishima</surname><given-names>A</given-names></name></person-group>             <year>2010</year>             <article-title>An analysis of network reciprocity in prisoner's dilemma games using full factorial designs of experiment.</article-title>             <source>Biosystems</source>             <volume>103</volume>             <fpage>85</fpage>             <lpage>92</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Taylor1">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Taylor</surname><given-names>PD</given-names></name></person-group>             <year>1992</year>             <article-title>Altruism in viscous populations-an inclusive fitness approach.</article-title>             <source>Evolutionary Ecology</source>             <volume>5</volume>             <fpage>352</fpage>             <lpage>356</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Wilson1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wilson</surname><given-names>DS</given-names></name><name name-style="western"><surname>Pollock</surname><given-names>GB</given-names></name><name name-style="western"><surname>Dugatkin</surname><given-names>LA</given-names></name></person-group>             <year>1992</year>             <article-title>Can altruism evolve in purely viscous populations?</article-title>             <source>Evolutionary Ecology</source>             <volume>6</volume>             <fpage>331</fpage>             <lpage>341</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Queller1">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Queller</surname><given-names>DC</given-names></name></person-group>             <year>1994</year>             <article-title>Genetic relatedness in viscous populations.</article-title>             <source>Evolutionary Ecology</source>             <volume>8</volume>             <fpage>70</fpage>             <lpage>73</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Ehsel1">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ehsel</surname><given-names>I</given-names></name><name name-style="western"><surname>Samuelson</surname><given-names>L</given-names></name><name name-style="western"><surname>Shaked</surname><given-names>A</given-names></name></person-group>             <year>1998</year>             <article-title>Altruists, egoists, and hooligans in a local interaction model.</article-title>             <source>American Economic Review</source>             <volume>88</volume>             <fpage>157</fpage>             <lpage>179</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Chiang1">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chiang</surname><given-names>Y-S</given-names></name></person-group>             <year>2007</year>             <article-title>Birds of moderately different feathers.</article-title>             <source>Journal of Mathematical Sociology</source>             <volume>31</volume>             <fpage>47</fpage>             <lpage>69</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Boyd2">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Boyd</surname><given-names>R</given-names></name><name name-style="western"><surname>Richerson</surname><given-names>P</given-names></name></person-group>             <year>2002</year>             <article-title>Group beneficial norms can spread rapidly in a structured population.</article-title>             <source>Journal of Theoretical Biology</source>             <volume>215</volume>             <fpage>287</fpage>             <lpage>296</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Valente1">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Valente</surname><given-names>TW</given-names></name><name name-style="western"><surname>Watkins</surname><given-names>S</given-names></name><name name-style="western"><surname>Jato</surname><given-names>MN</given-names></name><name name-style="western"><surname>van der Straten</surname><given-names>A</given-names></name><name name-style="western"><surname>Tsitsol</surname><given-names>L-P</given-names></name></person-group>             <year>1997</year>             <article-title>Social network association with contraceptive use among Cameroonian women in voluntary associations.</article-title>             <source>Social Science and Medicine</source>             <volume>45</volume>             <fpage>677</fpage>             <lpage>687</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Marshall1">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Marshall</surname><given-names>JAR</given-names></name></person-group>             <year>2011</year>             <article-title>Ultimate causes and the evolution of altruism.</article-title>             <source>Behavioral and Sociobiology</source>             <volume>65</volume>             <fpage>503</fpage>             <lpage>512</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-West1">
        <label>41</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>West</surname><given-names>SA</given-names></name><name name-style="western"><surname>Griffin</surname><given-names>AS</given-names></name><name name-style="western"><surname>Gardner</surname><given-names>A</given-names></name></person-group>             <year>2007</year>             <article-title>Evolutionary explanations for cooperation.</article-title>             <source>Current Biology</source>             <volume>17</volume>             <fpage>661</fpage>             <lpage>672</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Moody1">
        <label>42</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Moody</surname><given-names>J</given-names></name></person-group>             <year>2001</year>             <article-title>Race, school integration, and friendship segregation in America.</article-title>             <source>American Journal of Sociology</source>             <volume>107</volume>             <fpage>679</fpage>             <lpage>716</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Kalmijn1">
        <label>43</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kalmijn</surname><given-names>M</given-names></name></person-group>             <year>1998</year>             <article-title>Intermarriage and homogamy.</article-title>             <source>Annual Review of Sociology</source>             <volume>24</volume>             <fpage>395</fpage>             <lpage>421</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Barros1">
        <label>44</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Barros</surname><given-names>B</given-names></name></person-group>             <year>2008</year>             <article-title>Group size, heterogeneity and prosocial behavior.</article-title>             <source>Journal of Law and Public Policy</source>             <volume>18</volume>             <fpage>203</fpage>             <lpage>221</lpage>          </element-citation>
      </ref>
      <ref id="pone.0029188-Simpson1">
        <label>45</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Simpson</surname><given-names>B</given-names></name><name name-style="western"><surname>Willer</surname><given-names>R</given-names></name></person-group>             <year>2008</year>             <article-title>Altruism and indirect reciprocity.</article-title>             <source>Social Psychology Quarterly</source>             <volume>71</volume>             <fpage>37</fpage>             <lpage>52</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>