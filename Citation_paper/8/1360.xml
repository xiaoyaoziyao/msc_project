<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-00725</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002385</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Computational neuroscience</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Neuroscience</subject>
            <subj-group>
              <subject>Computational neuroscience</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Physics</subject>
          <subj-group>
            <subject>Statistical mechanics</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
          <subject>Neuroscience</subject>
          <subject>Physics</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories><title-group><article-title>State-Space Analysis of Time-Varying Higher-Order Spike Correlation for Multiple Neural Spike Train Data</article-title><alt-title alt-title-type="running-head">State-Space Analysis of Spike Correlation</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Shimazaki</surname>
            <given-names>Hideaki</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Amari</surname>
            <given-names>Shun-ichi</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Brown</surname>
            <given-names>Emery N.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Grün</surname>
            <given-names>Sonja</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff5">
            <sup>5</sup>
          </xref>
          <xref ref-type="aff" rid="aff6">
            <sup>6</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>RIKEN Brain Science Institute, Wako-shi, Saitama, Japan</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Brain and Cognitive Sciences, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Department of Anesthesia and Critical Care, Massachusetts General Hospital, Boston, Massachusetts, United States of America</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Division of Health Sciences and Technology, Harvard Medical School/Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line>       </aff><aff id="aff5"><label>5</label><addr-line>Institute of Neuroscience and Medicine (INM-6), Computational and Systems Neuroscience, Research Center Jülich, Jülich, Germany</addr-line>       </aff><aff id="aff6"><label>6</label><addr-line>Theoretical Systems Neurobiology, RWTH Aachen University, Aachen, Germany</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Sporns</surname>
            <given-names>Olaf</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Indiana University, United States of America</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">shimazaki@brain.riken.jp</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: HS SA ENB SG. Performed the experiments: HS SG. Analyzed the data: HS SG. Contributed reagents/materials/analysis tools: HS SG. Wrote the paper: HS SA ENB SG.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>3</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>8</day>
        <month>3</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>3</issue><elocation-id>e1002385</elocation-id><history>
        <date date-type="received">
          <day>24</day>
          <month>5</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>28</day>
          <month>12</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Shimazaki et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Precise spike coordination between the spiking activities of multiple neurons is suggested as an indication of coordinated network activity in active cell assemblies. Spike correlation analysis aims to identify such cooperative network activity by detecting excess spike synchrony in simultaneously recorded multiple neural spike sequences. Cooperative activity is expected to organize dynamically during behavior and cognition; therefore currently available analysis techniques must be extended to enable the estimation of multiple time-varying spike interactions between neurons simultaneously. In particular, new methods must take advantage of the simultaneous observations of multiple neurons by addressing their higher-order dependencies, which cannot be revealed by pairwise analyses alone. In this paper, we develop a method for estimating time-varying spike interactions by means of a state-space analysis. Discretized parallel spike sequences are modeled as multi-variate binary processes using a log-linear model that provides a well-defined measure of higher-order spike correlation in an information geometry framework. We construct a recursive Bayesian filter/smoother for the extraction of spike interaction parameters. This method can simultaneously estimate the dynamic pairwise spike interactions of multiple single neurons, thereby extending the Ising/spin-glass model analysis of multiple neural spike train data to a nonstationary analysis. Furthermore, the method can estimate dynamic higher-order spike interactions. To validate the inclusion of the higher-order terms in the model, we construct an approximation method to assess the goodness-of-fit to spike data. In addition, we formulate a test method for the presence of higher-order spike correlation even in nonstationary spike data, e.g., data from awake behaving animals. The utility of the proposed methods is tested using simulated spike data with known underlying correlation dynamics. Finally, we apply the methods to neural spike data simultaneously recorded from the motor cortex of an awake monkey and demonstrate that the higher-order spike correlation organizes dynamically in relation to a behavioral demand.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>Nearly half a century ago, the Canadian psychologist D. O. Hebb postulated the formation of assemblies of tightly connected cells in cortical recurrent networks because of changes in synaptic weight (Hebb's learning rule) by repetitive sensory stimulation of the network. Consequently, the activation of such an assembly for processing sensory or behavioral information is likely to be expressed by precisely coordinated spiking activities of the participating neurons. However, the available analysis techniques for multiple parallel neural spike data do not allow us to reveal the detailed structure of transiently active assemblies as indicated by their dynamical pairwise and higher-order spike correlations. Here, we construct a state-space model of dynamic spike interactions, and present a recursive Bayesian method that makes it possible to trace multiple neurons exhibiting such precisely coordinated spiking activities in a time-varying manner. We also formulate a hypothesis test of the underlying dynamic spike correlation, which enables us to detect the assemblies activated in association with behavioral events. Therefore, the proposed method can serve as a useful tool to test Hebb's cell assembly hypothesis.</p>
      </abstract><funding-group><funding-statement>This work was supported in part by JSPS Research Fellowships for Young Scientists (HS), R01 MH59733 (ENB), DP1 OD003646 (ENB), R01 MH071847 (ENB), and RIKEN Strategic Programs for R&amp;D (SG). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="27"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Precise spike coordination within the spiking activities of multiple single neurons is discussed as an indication of coordinated network activity in the form of cell assemblies <xref ref-type="bibr" rid="pcbi.1002385-Hebb1">[1]</xref> comprising neuronal information processing. Possible theoretical mechanisms and conditions for generating and maintaining such precise spike coordination have been proposed on the basis of neuronal network models <xref ref-type="bibr" rid="pcbi.1002385-Abeles1">[2]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Kumar1">[4]</xref>. The effect of synchronous spiking activities on downstream neurons has been theoretically investigated and it was demonstrated that these are more effective in generating output spikes <xref ref-type="bibr" rid="pcbi.1002385-Kuhn1">[5]</xref>. Assembly activity was hypothesized to organize dynamically as a result of sensory input and/or in relation to behavioral context <xref ref-type="bibr" rid="pcbi.1002385-Gerstein1">[6]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Harris1">[10]</xref>. Supportive experimental evidence was provided by findings of the presence of excess spike synchrony occurring dynamically in relation to stimuli <xref ref-type="bibr" rid="pcbi.1002385-Aertsen1">[11]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Ito1">[14]</xref>, behavior <xref ref-type="bibr" rid="pcbi.1002385-Ito1">[14]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Kilavik1">[19]</xref>, or internal states such as memory retention, expectation, and attention <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Sakurai2">[20]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Takahashi1">[23]</xref>.</p>
      <p>Over the years, various statistical tools have been developed to analyze the dependency between neurons, with continuous improvement in their applicability to neuronal experimental data (see <xref ref-type="bibr" rid="pcbi.1002385-Brown1">[24]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Grn2">[26]</xref> for recent reviews). The cross-correlogram <xref ref-type="bibr" rid="pcbi.1002385-Perkel1">[27]</xref> was the first analysis method for detecting the correlation between pairs of neurons and focused on the detection of stationary correlation. The joint-peri stimulus time histogram (JPSTH) introduced by <xref ref-type="bibr" rid="pcbi.1002385-Aertsen1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Gerstein2">[28]</xref> is an extension of the cross-correlogram that allows a time resolved analysis of the correlation dynamics between a pair of neurons. This method relates the joint spiking activity of two neurons to a trigger event, as was done in the peri-stimulus time histogram (PSTH) <xref ref-type="bibr" rid="pcbi.1002385-Gerstein3">[29]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Shimazaki2">[31]</xref> for estimating the time dependent firing rate of a single neuron. The Unitary Event analysis method <xref ref-type="bibr" rid="pcbi.1002385-Grn1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Grn3">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Grn4">[33]</xref> further extended the correlation analysis to enable it to test the statistical dependencies between multiple, nonstationary spike sequences against a null hypothesis of full independence among neurons. Staude et al. developed a test method (CuBIC) that enables the detection of higher-order spike correlation by computing the cumulants of the bin-wise population spike counts <xref ref-type="bibr" rid="pcbi.1002385-Staude1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Staude2">[35]</xref>.</p>
      <p>In the last decade, other model-based methods have been developed that make it possible to capture the dependency among spike sequences by direct statistical modeling of the parallel spike sequences. Two related approaches based on a generalized linear framework are being extensively investigated. One models the spiking activities of single neurons as a continuous-time point process or as a discrete-time Bernoulli process. The point process intensities (instantaneous spike rates) or Bernoulli success probabilities of individual neurons are modeled in a generalized linear manner using a log link function or a logit link function, respectively <xref ref-type="bibr" rid="pcbi.1002385-Chornoboy1">[36]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Truccolo1">[38]</xref>. The dependency among neurons is modeled by introducing coupling terms that incorporate the spike history of other observed neurons into the instantaneous spike rate <xref ref-type="bibr" rid="pcbi.1002385-Truccolo1">[38]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Pillow1">[40]</xref>. Recent development in causality analysis for point process data <xref ref-type="bibr" rid="pcbi.1002385-Kim1">[41]</xref> makes it possible to perform formal statistical significance tests of the causal interactions in these models. Typically, the models additionally include the covariate stimulus signals in order to investigate receptive field properties of neurons, i.e., the relations between neural spiking activities and the known covariate signals. However, they are not suitable for capturing instantaneous, synchronous spiking activities, which are likely to be induced by an unobserved external stimulus or a common input from an unobserved set of neurons. Recently, a model was proposed to dissociate instantaneous synchrony from the spike-history dependencies; it additionally includes a common, non-spike driven latent signal <xref ref-type="bibr" rid="pcbi.1002385-Kulkarni1">[42]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Vidne1">[43]</xref>. These models provide a concise description of the multiple neural spike train data by assuming independent spiking activities across neurons conditional on these explanatory variables. As a result, however, they do not aim to directly model the joint distribution of instantaneous spiking activities of multiple neurons.</p>
      <p>In contrast, an alternative approach, which we will follow and extend in this paper, directly models the instantaneous, joint spiking activities by treating the neuronal system as an ensemble binary pattern generator. In this approach, parallel spike sequences are represented as binary events occurring in discretized time bins, and are modeled as a multivariate Bernoulli distribution using a multinomial logit link function. The dependencies among the binary units are modeled in the generalized linear framework by introducing undirected pairwise and higher-order interaction terms for instantaneous, synchronous spike events. This statistical model is referred to as the ‘log-linear model’ <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Nakahara1">[45]</xref>, or Ising/spin-glass model if the model contains only lower-order interactions. The latter is also referred to as the maximum entropy model when these parameters are estimated under the maximum likelihood principle. In contrast to the former, biologically-inspired network-style modeling, the latter approach using a log-linear model was motivated by the computational theory of artificial neural networks originating from the stationary distribution of a Boltzmann machine <xref ref-type="bibr" rid="pcbi.1002385-Ackley1">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari2">[47]</xref>, which is in turn the stochastic analogue of the Hopfield network model <xref ref-type="bibr" rid="pcbi.1002385-Amari3">[48]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Hopfield1">[49]</xref> for associative memory.</p>
      <p>The merit of the log-linear model is its ability to provide a well-defined measure of spike correlation. While the cross-correlogram and JPSTH provide a measure of the marginal correlation of two neurons, these methods cannot distinguish direct pairwise correlations from correlations that are indirectly induced through other neurons. In contrast, a simultaneous pairwise analysis based on the log-linear model (an analogue of the Ising/spin-glass analysis in statistical mechanics) can sort out all of the pair-dependencies of the observed neurons. A further merit of the log-linear model is that it can provide a measure of the ‘pure’ higher-order spike correlation, i.e., a state that can not be explained by lower-order interactions. Using the viewpoint of an information geometry framework <xref ref-type="bibr" rid="pcbi.1002385-Amari4">[50]</xref>, Amari et al. <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Nakahara1">[45]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari5">[51]</xref> demonstrated that the higher-order spike correlations can be extracted from the higher-order parameters of the log-linear model (a.k.a. the natural or canonical parameters). The strengths of these parameters are interpreted in relation to the lower-order parameters of the dual orthogonal coordinates (a.k.a. the expectation parameters). The information contained in the higher-order spike interactions of a particular log-linear model can be extracted by measuring the distance (e.g., the Kullback-Leibler divergence) between the higher-order model and its projection to a lower-order model space, i.e., a manifold spanned by the natural parameters whose higher-order interaction terms are fixed at zero <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Schneidman1">[52]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Roudi1">[54]</xref>.</p>
      <p>Recently, a log-linear model that considered only up to pairwise interactions (i.e., an Ising/spin-glass model) was proposed as a model for parallel spike sequences. Its adequateness was shown by the fact that the firing rates and pairwise interactions explained more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e001" xlink:type="simple"/></inline-formula>% of the data <xref ref-type="bibr" rid="pcbi.1002385-Schneidman2">[55]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Tang1">[57]</xref>. However, Roudi et al. <xref ref-type="bibr" rid="pcbi.1002385-Roudi1">[54]</xref> demonstrated that the small contribution of higher-order correlations found from their measure based on the Kullback-Leibler divergence could be an artifact caused by the small number of neurons analyzed. Other studies have reported that higher-order correlations are required to account for the dependencies between parallel spike sequences <xref ref-type="bibr" rid="pcbi.1002385-Santos1">[58]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Yu1">[59]</xref>, or for stimulus encoding <xref ref-type="bibr" rid="pcbi.1002385-Montani1">[53]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Ohiorhenuan1">[60]</xref>. In <xref ref-type="bibr" rid="pcbi.1002385-Ohiorhenuan1">[60]</xref>, they reported the existence of triple-wise spike correlations in the spiking activity of the neurons in the visual cortex and showed their stimulus dependent changes. It should be noted, though, that these analyses assumed stationarity, both of the firing rates of individual neurons and of their spike correlations. This was possible because the authors restricted themselves to data recorded either from <italic>in vitro</italic> slices or from anesthetized animals. However, in order to assess the behavioral relevance of pairwise and higher-order spike correlations in awake behaving animals, it is necessary to appropriately correct for time-varying firing rates within an experimental trial and provide an algorithm that reliably estimates the time-varying spike correlations within multiple neurons.</p>
      <p>We consider the presence of excess spike synchrony, in particular the excess synchrony explained by higher-order correlation, as an indicator of an active cell assembly. If some of the observed neurons are a subset of the neurons that comprise an assembly, they are likely to exhibit nearly completely synchronous spikes every time the assembly is activated. It may be that such spike patterns are not explained by mere pairwise correlations, but require higher-order correlations for explanation of their occurrence. One of the potential physiological mechanisms for higher-order correlated activity is a common input from a set of unobserved neurons to the assembly that includes the neurons under observation <xref ref-type="bibr" rid="pcbi.1002385-Grn1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Martignon1">[61]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Macke1">[63]</xref>. Such higher-order activity is transient in nature and expresses a momentary snapshot of the neuronal dynamics. Thus, methods that are capable of evaluating time-varying, higher-order spike correlations are crucial to test the hypothesis that biological neuronal networks organize in dynamic cell assemblies for information processing. However, many of the current approaches based on the log-linear model <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Nakahara1">[45]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Montani1">[53]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Schneidman2">[55]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Shlens1">[56]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Martignon1">[61]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Martignon2">[62]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Gtig1">[64]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari6">[65]</xref> are not designed to capture their dynamics. Very recently two approaches were proposed for testing the presence of non-zero pairwise <xref ref-type="bibr" rid="pcbi.1002385-Long1">[66]</xref> and higher-order <xref ref-type="bibr" rid="pcbi.1002385-Kass1">[67]</xref> correlations using a time-dependent formulation of a log-linear model. In contrast to these methods, the present paper aims to directly provide optimized estimates of the individual time-varying interactions with confidence intervals. This enables to identify short lasting, time-varying higher-order correlation and thus to relate them to behaviorally relevant time periods.</p>
      <p>In this paper, we propose an approach to estimate the dynamic assembly activities from multiple neural spike train data using a ‘state-space log-linear’ framework. A state-space model offers a general framework for modeling time-dependent systems by representing its parameters (states) as a Markov process. Brown et al. <xref ref-type="bibr" rid="pcbi.1002385-Brown2">[37]</xref> developed a recursive filtering algorithm for a point process observation model that is applicable to neural spike train data. Further, Smith and Brown <xref ref-type="bibr" rid="pcbi.1002385-Smith1">[68]</xref> developed a paradigm for joint state-space and parameter estimation for point process observations using an expectation-maximization (EM) algorithm. Since then, the algorithm has been continuously improved and was successfully applied to experimental neuronal spike data from various systems <xref ref-type="bibr" rid="pcbi.1002385-Truccolo1">[38]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Eden1">[69]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Truccolo2">[71]</xref> (see <xref ref-type="bibr" rid="pcbi.1002385-Chen1">[72]</xref> for a review). Here, we extend this framework, and construct a multivariate state-space model of multiple neural spike sequences by using the log-linear model to follow the dynamics of the higher-order spike interactions. Note that we assume for this analysis typical electrophysiological experiments in which multiple neural spike train data are repeatedly collected under identical experimental conditions (‘trials’). Thus, with the proposed method, we deal with the within-trial nonstationarity of the spike data that is expected in the recordings from awake behaving animals. We assume, however, that dynamics of the spiking statistics within trials, such as time-varying spike rates and higher-order interactions, are identical across the multiple experimental trials (across-trial stationarity).</p>
      <p>To validate the necessity of including higher-order interactions in the model, we provide a method for evaluating the goodness-of-fit of the state-space model to the observed parallel spike sequences using the Akaike information criterion <xref ref-type="bibr" rid="pcbi.1002385-Akaike1">[73]</xref>. We then formulate a hypothesis test for the presence of the latent, time-varying spike interaction parameters by combining the Bayesian model comparison method <xref ref-type="bibr" rid="pcbi.1002385-Jeffreys1">[74]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Kass2">[76]</xref> with a surrogate method. The latter test method provides us with a tool to detect assemblies that are momentarily activated, e.g., in association with behavioral events. We test the utility of these methods by applying them to simulated parallel spike sequences with known dependencies. Finally, we apply the methods to spike data of three neurons simultaneously recorded from motor cortex of an awake monkey and demonstrate that a triple-wise spike correlation dynamically organizes in relation to a behavioral demand.</p>
      <p>The preliminary results were presented in the proceedings of the IEEE ICASSP meeting in 2009 <xref ref-type="bibr" rid="pcbi.1002385-Shimazaki3">[77]</xref>, as well as in conference abstracts (Shimazaki et al., Neuro08, SAND4, NIPS08WS, Cosyne09, and CNS09).</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>General formulation</title>
        <sec id="s2a1">
          <title>Log-linear model of multiple neural spike sequences</title>
          <p>We consider an ensemble spike pattern of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e002" xlink:type="simple"/></inline-formula> neurons. The state of each neuron is represented by a binary random variable, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e003" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e004" xlink:type="simple"/></inline-formula> where ‘<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e005" xlink:type="simple"/></inline-formula>’ denotes a spike occurrence and ‘<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e006" xlink:type="simple"/></inline-formula>’ denotes silence. An ensemble spike pattern of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e007" xlink:type="simple"/></inline-formula> neurons is represented by a vector, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e008" xlink:type="simple"/></inline-formula>, with the total number of possible spike patterns equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e009" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e010" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e011" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e012" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e013" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e014" xlink:type="simple"/></inline-formula>), represent the joint probability mass function of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e015" xlink:type="simple"/></inline-formula>-tuple binary random variables, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e016" xlink:type="simple"/></inline-formula>. Because of the constraint <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e017" xlink:type="simple"/></inline-formula>, the probabilities of all the spike patterns are specified using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e018" xlink:type="simple"/></inline-formula> parameters. In information geometry <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>,<xref ref-type="bibr" rid="pcbi.1002385-Amari4">[50]</xref>, these <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e019" xlink:type="simple"/></inline-formula> parameters are viewed as ‘coordinates’ that span a manifold composed of the set of all probability distributions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e020" xlink:type="simple"/></inline-formula>. In the following, we consider two coordinate systems.</p>
          <p>The logarithm of the probability mass function can be expanded as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e021" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e022" xlink:type="simple"/></inline-formula>. In this study, a prime indicates the transposition operation to a vector or matrix. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e023" xlink:type="simple"/></inline-formula> is a log normalization parameter to satisfy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e024" xlink:type="simple"/></inline-formula>. The log normalization parameter, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e025" xlink:type="simple"/></inline-formula>, is a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e026" xlink:type="simple"/></inline-formula>. Eq. 1 is referred to as the log-linear model. The parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e027" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e028" xlink:type="simple"/></inline-formula>,…, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e029" xlink:type="simple"/></inline-formula> are the natural parameters of an exponential family distribution and form the ‘<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e030" xlink:type="simple"/></inline-formula>-coordinates’. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e031" xlink:type="simple"/></inline-formula>-coordinates play a central role in this paper.</p>
          <p>The other coordinates, called <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e032" xlink:type="simple"/></inline-formula>-coordinates, can be constructed using the following expectation parameters:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e033" xlink:type="simple"/><label>(2)</label></disp-formula>These parameters represent the expected rates of joint spike occurrences among the neurons indexed by the subscripts. We denote the set of expectation parameters as a vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e034" xlink:type="simple"/></inline-formula>.</p>
          <p>Eqs. 1 and 2 can be compactly written using the following ‘multi-indices’ notation. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e035" xlink:type="simple"/></inline-formula> be collections of all the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e036" xlink:type="simple"/></inline-formula>-element subsets of a set with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e037" xlink:type="simple"/></inline-formula> elements (i.e., a k-subset of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e038" xlink:type="simple"/></inline-formula> elements): <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e039" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e040" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e041" xlink:type="simple"/></inline-formula>, etc. We use the ‘multi-indices’ <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e042" xlink:type="simple"/></inline-formula> to represent the natural parameters and expectation parameters as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e043" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e044" xlink:type="simple"/></inline-formula>, respectively. Similarly, let us denote the interaction terms in Eq. 1 as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e045" xlink:type="simple"/><label>(3)</label></disp-formula>Using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e046" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e047" xlink:type="simple"/></inline-formula>), Eqs. 1 and 2 can now be compactly written as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e048" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e049" xlink:type="simple"/></inline-formula>, respectively.</p>
          <p>The higher-order natural parameters in the log-linear model represent the strength of the higher-order spike interactions. Amari et al. <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Nakahara1">[45]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari4">[50]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari5">[51]</xref> proved that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e050" xlink:type="simple"/></inline-formula>- and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e051" xlink:type="simple"/></inline-formula>-coordinates are dually ‘orthogonal’ coordinates and demonstrated that the natural parameters that are greater than or equal to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e052" xlink:type="simple"/></inline-formula>th-order, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e053" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e054" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e055" xlink:type="simple"/></inline-formula>), represent an excess or paucity of higher-order synchronous spikes in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e056" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e057" xlink:type="simple"/></inline-formula>) coordinates. To understand the potential influence of the higher-order natural parameters on the higher-order joint spike event rates, let us consider a log-linear model in which the parameters higher than or equal to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e058" xlink:type="simple"/></inline-formula>th-order vanish: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e059" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e060" xlink:type="simple"/></inline-formula>). In the dual representation, the higher-order joint spike event rates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e061" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e062" xlink:type="simple"/></inline-formula>), are chance coincidences expected from the lower-order joint spike event rates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e063" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e064" xlink:type="simple"/></inline-formula>). From this, it follows that the non-zero higher-order natural parameters that are greater than or equal to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e065" xlink:type="simple"/></inline-formula>th-order of a full log-linear model represent the excess or paucity of the higher-order joint spike event rates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e066" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e067" xlink:type="simple"/></inline-formula>), in comparison to their chance rates expected from the lower-order joint spike event rates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e068" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e069" xlink:type="simple"/></inline-formula>).</p>
          <p>However, in this framework, the excess or scarce synchronous spike events of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e070" xlink:type="simple"/></inline-formula> subset neurons reflected in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e071" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e072" xlink:type="simple"/></inline-formula>) are <italic>caused</italic> not only by the non-zero <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e073" xlink:type="simple"/></inline-formula>th-order interactions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e074" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e075" xlink:type="simple"/></inline-formula>), but also by all non-zero higher-order interactions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e076" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e077" xlink:type="simple"/></inline-formula>). Therefore, one cannot extract the influence of pure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e078" xlink:type="simple"/></inline-formula>th-order spike interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e079" xlink:type="simple"/></inline-formula>) on the higher-order synchrony rates unless the parameters higher than the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e080" xlink:type="simple"/></inline-formula>th-orders vanish, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e081" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e082" xlink:type="simple"/></inline-formula>). To formally extract the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e083" xlink:type="simple"/></inline-formula>th-order spike interactions, let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e084" xlink:type="simple"/></inline-formula> denote a log-linear model whose parameters higher than the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e085" xlink:type="simple"/></inline-formula>th-order are fixed at zero. By successively adding higher-order terms into the model, we can consider a set of log-linear models forming a hierarchical structure as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e086" xlink:type="simple"/></inline-formula>. Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e087" xlink:type="simple"/></inline-formula> denotes that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e088" xlink:type="simple"/></inline-formula> is a sub-manifold of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e089" xlink:type="simple"/></inline-formula> in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e090" xlink:type="simple"/></inline-formula>-coordinates. In <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e091" xlink:type="simple"/></inline-formula>, the set of non-zero <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e092" xlink:type="simple"/></inline-formula>th-order natural parameters explains the excess or paucity of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e093" xlink:type="simple"/></inline-formula>th-order synchronous spike events, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e094" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e095" xlink:type="simple"/></inline-formula>), in comparison to their chance occurrence rates expected from the lower-order marginal rates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e096" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e097" xlink:type="simple"/></inline-formula>). In a full model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e098" xlink:type="simple"/></inline-formula>, the last parameter in the log-linear model, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e099" xlink:type="simple"/></inline-formula>, represents the pure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e100" xlink:type="simple"/></inline-formula>th-order spike correlation among the observed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e101" xlink:type="simple"/></inline-formula> neurons. The information geometry theory developed by Amari and others <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Nakahara1">[45]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari4">[50]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari5">[51]</xref> provides a framework for illustrating the duality and orthogonal relations between the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e102" xlink:type="simple"/></inline-formula>- and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e103" xlink:type="simple"/></inline-formula>-coordinates and singling out the higher-order correlations from these coordinates using hierarchical models. In the <xref ref-type="sec" rid="s4">Methods</xref> subsection ‘Mathematical properties of log-linear model’ we describe the known properties of the log-linear model utilized in this study, and give references <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Nakahara1">[45]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari4">[50]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari5">[51]</xref> for further details on the information geometry approach to spike correlations.</p>
        </sec>
        <sec id="s2a2">
          <title>State-space log-linear model of multiple neural spike sequences</title>
          <p>To model the dynamics of the spike interactions, we extend the log-linear model to a time-dependent formulation. To do so, we parameterize the natural parameters as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e104" xlink:type="simple"/></inline-formula> in discrete time steps <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e105" xlink:type="simple"/></inline-formula>. We denote the dimension of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e106" xlink:type="simple"/></inline-formula> for an <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e107" xlink:type="simple"/></inline-formula>th-order model as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e108" xlink:type="simple"/></inline-formula>. The time-dependent log-linear model up to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e109" xlink:type="simple"/></inline-formula>-th order interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e110" xlink:type="simple"/></inline-formula>) at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e111" xlink:type="simple"/></inline-formula> is then defined as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e112" xlink:type="simple"/><label>(4)</label></disp-formula>The corresponding time-varying expectation parameters at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e113" xlink:type="simple"/></inline-formula> are written as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e114" xlink:type="simple"/></inline-formula>, where each element (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e115" xlink:type="simple"/></inline-formula>) is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e116" xlink:type="simple"/><label>(5)</label></disp-formula></p>
          <p>In neurophysiological experiments, neuronal responses are repeatedly obtained under identical experimental conditions (‘trials’). Thus, we here consider the parallel spike sequences repeatedly recorded simultaneously from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e117" xlink:type="simple"/></inline-formula> neurons over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e118" xlink:type="simple"/></inline-formula> trials and align them to a trigger event. We model these simultaneous spike sequences as time-varying, multivariate binary processes by assuming that these parallel spike sequences are discretized in time into <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e119" xlink:type="simple"/></inline-formula> bins of bin-width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e120" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e121" xlink:type="simple"/></inline-formula> be the observed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e122" xlink:type="simple"/></inline-formula>-tuple binary variables in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e123" xlink:type="simple"/></inline-formula>-th bin of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e124" xlink:type="simple"/></inline-formula>-th trial, whereby a bin containing ‘<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e125" xlink:type="simple"/></inline-formula>’ values indicates that one or more spikes occurred in the bin whereas ‘<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e126" xlink:type="simple"/></inline-formula>’ values indicate that no spike occurred in the bin. We regard the observed spike pattern <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e127" xlink:type="simple"/></inline-formula> at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e128" xlink:type="simple"/></inline-formula> as a sample (from a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e129" xlink:type="simple"/></inline-formula> trials) from a joint probability mass function. An efficient estimator of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e130" xlink:type="simple"/></inline-formula> is the observed spike synchrony rate defined for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e131" xlink:type="simple"/></inline-formula>-th bin as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e132" xlink:type="simple"/><label>(6)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e133" xlink:type="simple"/></inline-formula>. The synchrony rates up to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e134" xlink:type="simple"/></inline-formula>-th order, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e135" xlink:type="simple"/></inline-formula>, constitute a sufficient statistic for the log-linear model up to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e136" xlink:type="simple"/></inline-formula>-th order interaction.</p>
          <p>Using Eqs. 4 and 6, the likelihood of the observed parallel spike sequences is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e137" xlink:type="simple"/><label>(7)</label></disp-formula>with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e138" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e139" xlink:type="simple"/></inline-formula>. Here, we assumed that the observed spike patterns are conditionally independent across bins given the time-dependent natural parameters, and that the samples across trials are independent.</p>
          <p>Our prior assumption about the time-dependent natural parameters is expressed by the following state equation<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e140" xlink:type="simple"/><label>(8)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e141" xlink:type="simple"/></inline-formula>. Matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e142" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e143" xlink:type="simple"/></inline-formula> matrix) contains the first order autoregressive parameters. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e144" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e145" xlink:type="simple"/></inline-formula> matrix) is a random vector drawn from a zero-mean multivariate normal distribution with covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e146" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e147" xlink:type="simple"/></inline-formula> matrix). The initial values obey <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e148" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e149" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e150" xlink:type="simple"/></inline-formula> matrix) being the mean and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e151" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e152" xlink:type="simple"/></inline-formula> matrix) the covariance matrix. The parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e153" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e154" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e155" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e156" xlink:type="simple"/></inline-formula> are called hyper-parameters. In the following, we denote the set of hyper-parameters by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e157" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e158" xlink:type="simple"/></inline-formula>.</p>
          <p>Given the likelihood (Eq. 7) and prior distribution (Eq. 8), we aim at obtaining the posterior density<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e159" xlink:type="simple"/><label>(9)</label></disp-formula>using Bayes' theorem. The posterior density provides us with the most likely paths of the log-liner parameters given the spike data (maximum a posteriori, MAP, estimates) as well as the uncertainty in its estimation. The posterior density depends on the choice of the hyper-parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e160" xlink:type="simple"/></inline-formula>. Here, the hyper-parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e161" xlink:type="simple"/></inline-formula>, except for the covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e162" xlink:type="simple"/></inline-formula> for the initial parameters, are optimized using the principle of maximizing the logarithm of the marginal likelihood (the denominator of Eq. 9, also referred to as the evidence),<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e163" xlink:type="simple"/><label>(10)</label></disp-formula></p>
          <p>For non-Gaussian observation models such as Eq. 7, the exact calculation of Eq. 10 is difficult (but see the approximate formula in the <xref ref-type="sec" rid="s4">Methods</xref> section). Instead, we use the EM algorithm <xref ref-type="bibr" rid="pcbi.1002385-Smith1">[68]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Dempster1">[78]</xref> to efficiently combine the construction of the posterior density and the optimization of the hyper-parameters under the maximum likelihood principle. Using this algorithm, we iteratively construct a posterior density with the given hyper-parameters (E-step), and then use it to optimize the hyper-parameters (M-step). To obtain the posterior density (Eq. 9) in the E-step, we develop a nonlinear recursive Bayesian filter/smoother. The filter distribution is sequentially constructed by combining the prediction distribution for time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e164" xlink:type="simple"/></inline-formula> based on the state equation (Eq. 8) and the likelihood function for the spike data at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e165" xlink:type="simple"/></inline-formula>, Eq. 4. <xref ref-type="fig" rid="pcbi-1002385-g001">Figure 1</xref> illustrates the recursive filtering process in model subspace <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e166" xlink:type="simple"/></inline-formula>. In combination with a fixed-interval smoothing algorithm, we derive the smooth posterior density (Eq. 9). The time-dependent log-linear parameters (natural parameters) are estimated as MAP estimates of the optimized smooth posterior density. In the <xref ref-type="sec" rid="s4">Methods</xref> section, please refer to the subsection on ‘Bayesian estimation of dynamic spike interactions’ for the derivation of the optimization method for hyper-parameters, along with the filtering/smoothing methods. We summarize a method for estimating the dynamic spike interactions in <xref ref-type="table" rid="pcbi-1002385-t001">Table 1</xref>.</p>
          <fig id="pcbi-1002385-g001" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.g001</object-id>
            <label>Figure 1</label>
            <caption>
              <title>Geometric view of recursive filtering in subspace <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e167" xlink:type="simple"/></inline-formula>.</title>
              <p>Each point in this figure represents a probability distribution, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e168" xlink:type="simple"/></inline-formula>, of an <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e169" xlink:type="simple"/></inline-formula>-tuple binary variable, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e170" xlink:type="simple"/></inline-formula>. The underlying time-dependent model is represented by white circles in the space of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e171" xlink:type="simple"/></inline-formula>. The dashed lines indicate projections of the underlying models to the model subspace, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e172" xlink:type="simple"/></inline-formula>. The maximum a posteriori (MAP) estimates of the underlying models projected on subspace <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e173" xlink:type="simple"/></inline-formula> were obtained recursively: Starting from the MAP estimate at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e174" xlink:type="simple"/></inline-formula> (filter estimate, red circle), the model at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e175" xlink:type="simple"/></inline-formula> is predicted based on the prior knowledge of the state transition, Eq. 8 (blue arrow, prediction; black cross, a predicted distribution). The maximum likelihood estimate (MLE, black circle) for the spike data at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e176" xlink:type="simple"/></inline-formula> derived by Eq. 4 is expected to appear near the projection point of the underlying model at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e177" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e178" xlink:type="simple"/></inline-formula>. The filter distribution at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e179" xlink:type="simple"/></inline-formula> is obtained by correcting the prediction by the observation of data at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e180" xlink:type="simple"/></inline-formula> (black arrow). The filter estimation at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e181" xlink:type="simple"/></inline-formula> is used for predicting the model at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e182" xlink:type="simple"/></inline-formula> and so on. This recursive procedure allows us to retain past information while tracking the underlying time-dependent model based on the current observation.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.g001" xlink:type="simple"/>
          </fig>
          <table-wrap id="pcbi-1002385-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.t001</object-id><label>Table 1</label><caption>
              <title>Method for estimating dynamic spike interactions.</title>
            </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002385-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.t001" xlink:type="simple"/><table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left" colspan="1" rowspan="1">
                    <bold>I</bold>
                  </td>
                  <td align="left" colspan="3" rowspan="1">
                    <bold>Preprocessing parallel spike data</bold>
                  </td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">(1)</td>
                  <td align="left" colspan="2" rowspan="1">Align parallel spike sequences from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e183" xlink:type="simple"/></inline-formula> neurons at the onset of external clock that repeated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e184" xlink:type="simple"/></inline-formula> times.</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">(2)</td>
                  <td align="left" colspan="2" rowspan="1">Construct binary sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e185" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e186" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e187" xlink:type="simple"/></inline-formula>) using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e188" xlink:type="simple"/></inline-formula> bins of width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e189" xlink:type="simple"/></inline-formula> from the spike timing data.</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">(3)</td>
                  <td align="left" colspan="2" rowspan="1">Select <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e190" xlink:type="simple"/></inline-formula>, the order of interactions included in the model. At each bin, compute the joint spike event rates up to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e191" xlink:type="simple"/></inline-formula>th order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e192" xlink:type="simple"/></inline-formula>, using Eq. 6.</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">
                    <bold>II</bold>
                  </td>
                  <td align="left" colspan="3" rowspan="1">
                    <bold>Optimized estimation of time-varying log-linear parameters</bold>
                  </td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">(1)</td>
                  <td align="left" colspan="2" rowspan="1">Initialize the hyper parameters: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e193" xlink:type="simple"/></inline-formula>.<xref ref-type="table-fn" rid="nt101">†</xref></td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">(2)</td>
                  <td align="left" colspan="2" rowspan="1">E-step: Apply the recursive Bayesian filter/smoother to obtain posterior densities.</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">(i)</td>
                  <td align="left" colspan="1" rowspan="1">Filtering: For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e194" xlink:type="simple"/></inline-formula>, recursively obtain</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">the one-step prediction density, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e195" xlink:type="simple"/></inline-formula>, using Eqs. 25 and 26,</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">the filter density, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e196" xlink:type="simple"/></inline-formula>, using Eqs. 31 and 32.</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">(ii)</td>
                  <td align="left" colspan="1" rowspan="1">Smoothing: For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e197" xlink:type="simple"/></inline-formula>, recursively obtain</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">the smooth density, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e198" xlink:type="simple"/></inline-formula>, using Eqs. 34 and 35.</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">(3)</td>
                  <td align="left" colspan="2" rowspan="1">M-step: Optimize the hyper-parameters.</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">Update the hyper-parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e199" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e200" xlink:type="simple"/></inline-formula>, using Eqs. 38 and 39, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e201" xlink:type="simple"/></inline-formula>.</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">(4)</td>
                  <td align="left" colspan="2" rowspan="1">Repeat (2) and (3) until the iterations satisfy a predetermined convergence criterion.<xref ref-type="table-fn" rid="nt102">‡</xref></td>
                </tr>
              </tbody>
            </table></alternatives><table-wrap-foot>
              <fn id="nt101">
                <label>†</label>
                <p>In this study, we initialized the hyper-parameters using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e202" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e203" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e204" xlink:type="simple"/></inline-formula> and used a fixed diagonal covariance matrix for an initial density, as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e205" xlink:type="simple"/></inline-formula>, unless specified otherwise in the main text or figure captions.</p>
              </fn>
              <fn id="nt102">
                <label>‡</label>
                <p>In our algorithm, we computed the approximate log marginal likelihood, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e206" xlink:type="simple"/></inline-formula>, of the model using Eq. 45. We stopped the EM algorithm if the increment of the log marginal likelihood was smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e207" xlink:type="simple"/></inline-formula>.</p>
              </fn>
            </table-wrap-foot></table-wrap>
        </sec>
      </sec>
      <sec id="s2b">
        <title>Application of state-space log-linear model to simulated spike data</title>
        <sec id="s2b1">
          <title>Estimation of time-varying pairwise spike interaction</title>
          <p>To demonstrate the utility of the developed methods for the analysis of dynamic spike correlations, we first consider a nonstationary pairwise spike correlation analysis. For this goal, we apply the state-space method to two examples of simulated spike data, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e208" xlink:type="simple"/></inline-formula> neurons. The dynamic spike correlation between two neurons can be analyzed by conceptually simpler histogram-based methods, e.g., a joint peri-stimulus time histogram (JPSTH). However, even for the pair-analysis, the proposed method can be advantageous in the following two aspects. First, the proposed method provides a credible interval (a Bayesian analogue of a confidence interval). Using the recursive Bayesian filtering/smoothing algorithm developed in the <xref ref-type="sec" rid="s4">Methods</xref> section, we obtain the joint posterior density of the log-linear parameters (Eq. 9). The posterior density provides, not only the most likely path of the log-liner parameters (MAP estimates), but also the uncertainty in its estimation. The credible interval allows us to examine whether the pairwise spike correlation is statistically significant (but see the later section on “Testing spike correlation in nonstationary spike data” for the formal use of the joint posterior density for testing the existence of the spike correlation in behaviorally relevant time periods). Second, an EM algorithm developed in the proposed method optimizes the smoothness of the estimated dynamics of the pairwise correlation (i.e., optimization of the hyper-parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e209" xlink:type="simple"/></inline-formula> in the state equation, Eq. 8). By the automatic selection of the smoothness parameter, we can avoid the problem of spurious modulation in the estimated dynamic spike correlation caused by local noise, or excessive smoothing of the underlying modulation.</p>
          <p><xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2A</xref> displays an application of our state-space method to 2 parallel spike sequences, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e210" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e211" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e212" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e213" xlink:type="simple"/></inline-formula>), which are correlated in a time-varying fashion. The data are generated as realizations from a time-dependent formulation of a full log-linear model of 2 neurons (<xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2A</xref> left, repeated trials: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e214" xlink:type="simple"/></inline-formula>; duration: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e215" xlink:type="simple"/></inline-formula> bins of width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e216" xlink:type="simple"/></inline-formula>). Here, the underlying model parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e217" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e218" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e219" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2A</xref> right, dashed lines), are designed so that the individual spike rates are constant (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e220" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e221" xlink:type="simple"/></inline-formula>), while the spike correlation between the two neurons, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e222" xlink:type="simple"/></inline-formula>, varies in time, i.e., across bins (synchronous spike events caused by the time-dependent correlation are marked as blue circles in <xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2A</xref> left). While the bin-width, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e223" xlink:type="simple"/></inline-formula>, is an arbitrary value in this simulation analysis, the bin-width typically selected in spike correlation analyses is on the milli-second order. If the bin-width is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e224" xlink:type="simple"/></inline-formula>, the individual spike rates of simulated neurons 1 and 2 are 38.4 Hz and 19.4 Hz, respectively. The correlation coefficient calculated from these parallel spike sequences is 0.0763. These values are within the realistic range of values obtained from experimentally recorded neuronal spike sequences. By applying the state-space method to the parallel spike sequences, we obtain the smooth posterior density of the log-linear parameters. The right panels in <xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2A</xref> display the MAP estimates of the log-linear parameters (solid lines). The analysis reveals the time-varying pairwise interaction between the two neurons (<xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2A</xref> right, bottom). The gray bands indicate 99% credible intervals from the posterior density, Eq. 9. We used marginal posterior densities, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e225" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e226" xlink:type="simple"/></inline-formula>), to display the credible intervals for the individual log-linear parameters. The variances of the individual marginal densities were obtained from the diagonal of a covariance matrix of the smooth joint posterior density (Eq. 35).</p>
          <fig id="pcbi-1002385-g002" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.g002</object-id>
            <label>Figure 2</label>
            <caption>
              <title>Estimation of pairwise interactions in two simulated parallel spike sequences.</title>
              <p>(A) Application of the state-space log-linear model to parallel spike sequences with time-varying spike interaction. (Left) Based on a time-dependent formulation of the log-linear model (dashed lines in the right panels represent the model parameters), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e227" xlink:type="simple"/></inline-formula> parallel spike sequences, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e228" xlink:type="simple"/></inline-formula>, are simulated repeatedly for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e229" xlink:type="simple"/></inline-formula> trials (duration: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e230" xlink:type="simple"/></inline-formula> bins). The two panels show dot displays of the spike events of the variables, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e231" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e232" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e233" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e234" xlink:type="simple"/></inline-formula>). The observed synchronous spike events across the two spike sequences within the same trials are marked by blue circles. (Right) Smoothed estimates of the log-linear parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e235" xlink:type="simple"/></inline-formula> (solid lines, red: pairwise interaction; blue and green: the first order), estimated from the data shown in the left panels. The gray bands indicate the 99% credible interval from the posterior density of the log-linear parameters. The dashed lines are the underlying time-dependent model parameters used for the generation of the spike sequences in the left panels. (B) Application of the state-space log-linear model to independent parallel spike sequences with time-varying spike rates. Each panel retains the same presentation format as in A.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.g002" xlink:type="simple"/>
          </fig>
          <p><xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2B</xref> shows an application of the method to parallel spike sequences of time-varying spike rates. Here, the underlying model parameters are constructed so that the two parallel spike sequences are independent (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e236" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e237" xlink:type="simple"/></inline-formula>), while the individual spike rates vary in time (i.e., across the bins). The observation of synchronous spike events (<xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2B</xref> left, blue circles) confirms that chance spike coincidences frequently and trivially occur at higher spike rates. The analysis based on our state-space method reveals that virtually no spike correlation exists between the two neurons, despite the presence of time-varying rates of synchronous spike events (<xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2B</xref> right, bottom).</p>
        </sec>
        <sec id="s2b2">
          <title>Simultaneous estimation of time-varying pairwise spike interactions</title>
          <p>In this subsection, we extend the pairwise correlation analysis of 2 neurons to the simultaneous analysis of multiple pairwise interactions in the parallel spike sequences obtained from more than 2 neurons.</p>
          <p><xref ref-type="fig" rid="pcbi-1002385-g003">Figure 3</xref> demonstrates an application of our method to simulated spike sequences of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e238" xlink:type="simple"/></inline-formula> neurons. As an underlying model, we construct a time-dependent log-linear model of 8 neurons with time-varying rates and pairwise interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e239" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e240" xlink:type="simple"/></inline-formula>, duration: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e241" xlink:type="simple"/></inline-formula> bins). The higher-order log-linear parameters are set to zero, i.e., no higher-order interactions are included in the model. <xref ref-type="fig" rid="pcbi-1002385-g003">Figure 3A</xref> displays snapshots of the dynamics of the parameters of the individual spike rates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e242" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e243" xlink:type="simple"/></inline-formula>), and pairwise interactions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e244" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e245" xlink:type="simple"/></inline-formula>), at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e246" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pcbi-1002385-g003">Figure 3B</xref> shows the parallel spike sequences (50 out of 200 trials are displayed) simulated on the basis of this model. The spikes involved in the pairwise, synchronous spike events between any two of the neurons (in total: 28 pairs) are superimposed and marked with blue circles. <xref ref-type="fig" rid="pcbi-1002385-g003">Figure 3C</xref> displays snapshots of the simultaneous MAP estimates of the pairwise interactions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e247" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e248" xlink:type="simple"/></inline-formula>), of a log-linear model of 8 neurons applied to the parallel spike train data. In addition, the spike rates were estimated from the dual coordinates, i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e249" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e250" xlink:type="simple"/></inline-formula>). The results demonstrate that the simultaneous estimation of time-varying, multiple pairwise interactions can be carried out by using a state-space log-linear model with up to pairwise interaction terms.</p>
          <fig id="pcbi-1002385-g003" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.g003</object-id>
            <label>Figure 3</label>
            <caption>
              <title>Simultaneous estimation of pairwise interactions of 8 simulated neurons.</title>
              <p>(A) Snapshots of the underlying model parameters of a time-dependent log-linear model of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e251" xlink:type="simple"/></inline-formula> neurons containing up to pairwise interactions (duration: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e252" xlink:type="simple"/></inline-formula> bins) at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e253" xlink:type="simple"/></inline-formula> bins. No higher-order interactions are included in the model. Each node represents a single neuron. The strength of a pairwise interaction between the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e254" xlink:type="simple"/></inline-formula>th and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e255" xlink:type="simple"/></inline-formula>th neurons, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e256" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e257" xlink:type="simple"/></inline-formula>), is expressed by the color as well as the thickness of the link between the neurons (see legend at the right of panel B). A red solid line indicates a positive pairwise interaction, whereas a blue dashed line represents a negative pairwise interaction. The underlying spike rates of the individual neurons, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e258" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e259" xlink:type="simple"/></inline-formula>), are coded by the color of the nodes (see color bar to the right of panel A). (B) Dot displays of the simulated parallel spike sequences of 8 neurons, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e260" xlink:type="simple"/></inline-formula>, sampled repeatedly for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e261" xlink:type="simple"/></inline-formula> trials from the time-dependent log-linear model shown in A. For better visibility, only the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e262" xlink:type="simple"/></inline-formula> trials are displayed (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e263" xlink:type="simple"/></inline-formula>). Synchronous spike events between any two neurons (28 pairs in total) are marked by blue circles. (C) Pairwise analysis of the data illustrated in B (using all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e264" xlink:type="simple"/></inline-formula> trials) assuming a pairwise model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e265" xlink:type="simple"/></inline-formula>) of 8 neurons. The snapshots at the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e266" xlink:type="simple"/></inline-formula> bins show smoothed estimates of the time-varying pairwise interactions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e267" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e268" xlink:type="simple"/></inline-formula>), and the spike rates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e269" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e270" xlink:type="simple"/></inline-formula>). For this estimation, we use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e271" xlink:type="simple"/></inline-formula> for the prior density of initial parameters. The scales are identical to the one in panel A.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.g003" xlink:type="simple"/>
          </fig>
        </sec>
        <sec id="s2b3">
          <title>Estimation of time-varying triple-wise spike interaction</title>
          <p>Another important aspect of the proposed method is its ability to estimate time-varying higher-order spike interactions that cannot be revealed by a pairwise analysis. To demonstrate this, we apply the state-space log-linear model to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e272" xlink:type="simple"/></inline-formula> parallel spike sequences by considering up to a triple-wise interaction (i.e., the full log-linear model). Spike data (<xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4A</xref>) are generated by a time-dependent log-linear model (<xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref>, dashed lines) repeatedly in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e273" xlink:type="simple"/></inline-formula> trials. <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref> displays the MAP estimates (solid lines) of the log-linear parameters from the data shown in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4A</xref>. Here, non-zero parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e274" xlink:type="simple"/></inline-formula> represents a triple-wise spike correlation, i.e., excess synchronous spikes across the three neurons or absence of such synchrony compared to the expectation if assuming pairwise correlations. The gray band is the 99% credible interval from the marginal posterior density, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e275" xlink:type="simple"/></inline-formula>, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e276" xlink:type="simple"/></inline-formula>.</p>
          <fig id="pcbi-1002385-g004" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.g004</object-id>
            <label>Figure 4</label>
            <caption>
              <title>Estimation of triple-wise interaction from simulated parallel spike sequences of 3 neurons.</title>
              <p>(A) Dot displays of the simulated spike sequences, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e277" xlink:type="simple"/></inline-formula>, which are sampled repeatedly for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e278" xlink:type="simple"/></inline-formula> trials from a time-dependent log-linear model containing time varying pairwise and triple-wise interactions (duration: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e279" xlink:type="simple"/></inline-formula> bins; see the dashed lines in C for the model parameters). Each of the 3 panels shows the spike events for each of the 3 variables, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e280" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e281" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e282" xlink:type="simple"/></inline-formula>), as black dots. Synchronous spike events across the 3 neurons as detected in individual trials are marked by blue circles. (B) Observed rates of joint spike events, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e283" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e284" xlink:type="simple"/></inline-formula>). (Top) Observed rates of the synchronous spike events between all possible pair constellations as specified by index <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e285" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e286" xlink:type="simple"/></inline-formula>). (Bottom) Observed rate of the synchronous spikes across all 3 neurons, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e287" xlink:type="simple"/></inline-formula>. (C) Smoothed estimates of the time-varying log-linear parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e288" xlink:type="simple"/></inline-formula>. The three panels depict the smoothed estimates (solid lines) of the log-linear parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e289" xlink:type="simple"/></inline-formula>, of the different orders (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e290" xlink:type="simple"/></inline-formula>), as obtained from the data shown in A and B (top and middle: the first and second order log-linear parameters; bottom: triple-wise spike interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e291" xlink:type="simple"/></inline-formula>). The gray bands indicate the 99% credible interval of the marginal posterior densities of the log-linear parameters. The dashed lines indicate the underlying time-dependent parameters used for the generation of the spike sequences.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.g004" xlink:type="simple"/>
          </fig>
          <p>The credible interval of the higher-order (triple-wise) log-linear parameter in the bottom panel of <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref> appears to be larger than those of the lower-order parameters. In general, the observed frequency of simultaneous spike occurrences decreases as the number of neurons that join the synchronous spiking activities increases (note that the marginal joint spike occurrence rate, Eq. 2, is a non-increasing function with respect to the order of interaction, i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e292" xlink:type="simple"/></inline-formula> if the elements of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e293" xlink:type="simple"/></inline-formula> are included in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e294" xlink:type="simple"/></inline-formula>). Thus, the estimation variance typically increases for the higher-order parameters, as seen in the bottom panel of <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref>. Related to the above, because of the paucity of samples for higher-order joint spike events, the automatic smoothness optimization method selects hyper-parameters that make the trajectories of the higher-order log-linear parameters stiff in order to avoid statistical fluctuation caused by a local noise structure. Given the limited number of trials available for data analyses, these observations show the necessity of a method to validate inclusion of the higher-order interaction terms in the model.</p>
          <p>Additionally, we observe that in the later period of spike data (300–500 bins), the dynamics of the estimated triple-wise spike interaction do not follow the underlying trajectory faithfully: The underlying trajectory falls on outside the 99% credible interval. Similar results are sometimes observed when an autoregressive parameter, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e295" xlink:type="simple"/></inline-formula>, in a state model is optimized (Eq. 8). In contrast, when we replace the autoregressive parameter with an identity matrix (i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e296" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e297" xlink:type="simple"/></inline-formula> is the identity matrix), the credible intervals become larger. Therefore, such observations do not typically occur. Thus, we also need a method for validating the inclusion of the autoregressive parameter in the state model using an objective criterion. Detailed analyses of these topics will be given in the next section using the example of 3 simulated neurons displayed in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4</xref>. In the above example, the state-space log-linear model with an optimized <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e298" xlink:type="simple"/></inline-formula> provides a better overall fits to the spike data than the model using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e299" xlink:type="simple"/></inline-formula>, despite an inaccurate representation in part of its estimation. However, for the purpose of testing the spike correlation in a particular period of spike data, we recommend using an identity matrix as an autoregressive parameter, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e300" xlink:type="simple"/></inline-formula>, in the state model.</p>
        </sec>
      </sec>
      <sec id="s2c">
        <title>Selection of state-space log-linear model</title>
        <p>For a given number of neurons, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e301" xlink:type="simple"/></inline-formula>, we can construct state-space log-linear models that contain up to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e302" xlink:type="simple"/></inline-formula>th-order interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e303" xlink:type="simple"/></inline-formula>). While the inclusion of increasingly higher-order interaction terms in the model improves its accuracy when describing the probabilities of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e304" xlink:type="simple"/></inline-formula> spike patterns, the estimation of the higher-order log-linear parameters of the model may suffer from large statistical fluctuations caused by the paucity of synchronous spikes in the data, leading to an erroneous estimation of such parameters. This problem is known as ‘over-fitting’ the model to the data. An over-fitted model explains the observed data, but loses its predictive ability for unseen data (e.g., spike sequences in a new trial under the same experimental conditions). In this case, the exclusion of higher-order parameters from the model may better explain the unseen data even if an underlying spike generation process contains higher-order interactions. The model that has this predictive ability by optimally resolving the balance between goodness-of-fit to the observed data and the model simplicity is obtained by maximizing the cross-validated likelihood or minimizing the so-called information criterion. In this section, we select a state-space model that minimizes the Akaike information criterion (AIC) <xref ref-type="bibr" rid="pcbi.1002385-Akaike1">[73]</xref>, which is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e305" xlink:type="simple"/><label>(11)</label></disp-formula>The first term is the log marginal likelihood, as in Eq. 10. The second term that includes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e306" xlink:type="simple"/></inline-formula> is a penalization term. The AIC uses the number of free parameters in the marginal model (i.e., the number of free parameters in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e307" xlink:type="simple"/></inline-formula>) for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e308" xlink:type="simple"/></inline-formula>. Please see in the <xref ref-type="sec" rid="s4">Methods</xref> subsection ‘Selection of state-space model by information criteria’ for an approximation method to compute the marginal likelihood. Selecting a model that minimizes the AIC is expected to be equivalent to selecting a model that minimizes the expected (or average) distance between the estimated model and unknown underlying distribution that generated the data, where the ‘distance’ measure used is the Kullback-Leibler (KL) divergence. The expectation of the KL divergence is called the KL risk function.</p>
        <sec id="s2c1">
          <title>Selection from hierarchical models</title>
          <p>Here, we examine the validity of including higher-order interaction terms in the model by using the AIC. We apply the model selection method to the spike train data of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e309" xlink:type="simple"/></inline-formula> simulated neurons. The data are generated by the time-varying, full log-linear model that contains a non-zero triple-wise interaction terms shown in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref> (dashed lines). The AICs are computed for hierarchical state-space log-linear models, i.e., for models of interaction orders up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e310" xlink:type="simple"/></inline-formula>. To test the influence of the data sample size on the model selection, we vary the number of trials, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e311" xlink:type="simple"/></inline-formula>, used to fit the hierarchical log-linear models. The results are shown in <xref ref-type="table" rid="pcbi-1002385-t002">Table 2</xref> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e312" xlink:type="simple"/></inline-formula>. For a small number of trials (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e313" xlink:type="simple"/></inline-formula>), a model without any interaction structure (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e314" xlink:type="simple"/></inline-formula>) is selected. For larger numbers of trials, models with larger interaction orders are selected. For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e315" xlink:type="simple"/></inline-formula>, the full log-linear model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e316" xlink:type="simple"/></inline-formula>) is selected.</p>
          <table-wrap id="pcbi-1002385-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.t002</object-id><label>Table 2</label><caption>
              <title>AICs for different numbers of trials.</title>
            </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002385-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.t002" xlink:type="simple"/><table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" colspan="1" rowspan="1">The number of trials</td>
                  <td align="left" colspan="3" rowspan="1">Model order</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e317" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e318" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e319" xlink:type="simple"/></inline-formula>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e320" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">775.15*</td>
                  <td align="left" colspan="1" rowspan="1">807.146</td>
                  <td align="left" colspan="1" rowspan="1">841.96</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e321" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">1957.4</td>
                  <td align="left" colspan="1" rowspan="1">1890.6*</td>
                  <td align="left" colspan="1" rowspan="1">1922</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e322" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">7857.2</td>
                  <td align="left" colspan="1" rowspan="1">7565.1*</td>
                  <td align="left" colspan="1" rowspan="1">7585.8</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e323" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">37791</td>
                  <td align="left" colspan="1" rowspan="1">36264</td>
                  <td align="left" colspan="1" rowspan="1">36231*</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e324" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">75443</td>
                  <td align="left" colspan="1" rowspan="1">72366</td>
                  <td align="left" colspan="1" rowspan="1">72283*</td>
                </tr>
              </tbody>
            </table></alternatives><table-wrap-foot>
              <fn id="nt103">
                <label/>
                <p>This table displays the AICs of a state-space log-linear model with increasing interaction orders: an independent model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e325" xlink:type="simple"/></inline-formula>), pairwise model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e326" xlink:type="simple"/></inline-formula>), and full model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e327" xlink:type="simple"/></inline-formula>), applied to simulated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e328" xlink:type="simple"/></inline-formula> spike sequences with an increasing number of trials, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e329" xlink:type="simple"/></inline-formula>, considered in the analysis. The spike data are identical to that shown in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4A</xref>. The asterisk indicates the model that minimizes the AIC.</p>
              </fn>
            </table-wrap-foot></table-wrap>
          <p>Below, we examine whether the AIC selected a model that minimizes the KL risk function by directly computing its approximation using the known underlying model parameters. First, <xref ref-type="table" rid="pcbi-1002385-t003">Table 3</xref> shows how often a specific order is selected by the AIC by repeatedly applying the method to different samples generated from the same underlying log-linear parameters (<xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref>, dashed lines). We examine two examples: One in which a sample is composed of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e330" xlink:type="simple"/></inline-formula> trials (left) and the other of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e331" xlink:type="simple"/></inline-formula> trials (right). We repeatedly compute the AICs of state-space models of different orders (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e332" xlink:type="simple"/></inline-formula>) applied to 100 data realizations (of the respective number of trials). We then count how often a model of order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e333" xlink:type="simple"/></inline-formula> is selected by minimizing the AIC. For comparison, the table includes the outcomes from other criteria such as the Bayesian information criterion (BIC) <xref ref-type="bibr" rid="pcbi.1002385-Schwarz1">[79]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Rissanen1">[80]</xref> and the predictive divergence for indirect observation models (PDIO) <xref ref-type="bibr" rid="pcbi.1002385-Shimodaira1">[81]</xref>, which are suggested for models containing latent variables. Please see the <xref ref-type="sec" rid="s4">Methods</xref> section for the details of these criteria. Next, <xref ref-type="table" rid="pcbi-1002385-t004">Table 4</xref> displays the most frequently selected model (from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e334" xlink:type="simple"/></inline-formula> = 1,2,3) by the various information criteria when they are applied to 100 data realizations as a function of the number of trials in each data set, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e335" xlink:type="simple"/></inline-formula> (see <xref ref-type="table" rid="pcbi-1002385-t003">Table 3</xref> for the outcomes of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e336" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e337" xlink:type="simple"/></inline-formula>).</p>
          <table-wrap id="pcbi-1002385-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.t003</object-id><label>Table 3</label><caption>
              <title>Models selected using different information criteria.</title>
            </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002385-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.t003" xlink:type="simple"/><table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="3" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e338" xlink:type="simple"/></inline-formula> trials</td>
                  <td align="left" colspan="3" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e339" xlink:type="simple"/></inline-formula> trials</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e340" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e341" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e342" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e343" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e344" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e345" xlink:type="simple"/></inline-formula>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" colspan="1" rowspan="1">AIC</td>
                  <td align="left" colspan="1" rowspan="1">29</td>
                  <td align="left" colspan="1" rowspan="1">71*</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                  <td align="left" colspan="1" rowspan="1">97*</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">BIC</td>
                  <td align="left" colspan="1" rowspan="1">15</td>
                  <td align="left" colspan="1" rowspan="1">85*</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">99*</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">PDIO</td>
                  <td align="left" colspan="1" rowspan="1">46*</td>
                  <td align="left" colspan="1" rowspan="1">25</td>
                  <td align="left" colspan="1" rowspan="1">29</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                  <td align="left" colspan="1" rowspan="1">60*</td>
                  <td align="left" colspan="1" rowspan="1">37</td>
                </tr>
              </tbody>
            </table></alternatives><table-wrap-foot>
              <fn id="nt104">
                <label/>
                <p>The state-space log-linear models containing interactions up to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e346" xlink:type="simple"/></inline-formula>th-order (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e347" xlink:type="simple"/></inline-formula>) are applied to the data from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e348" xlink:type="simple"/></inline-formula> simultaneous spike sequences. The spike data is generated from a time-dependent full log-linear model (see dashed lines in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref>) repeatedly for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e349" xlink:type="simple"/></inline-formula> trials; either <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e350" xlink:type="simple"/></inline-formula> (left) or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e351" xlink:type="simple"/></inline-formula> (right) trials. For this data set, we compute three information criteria (AIC, BIC, and PDIO) and find the order of the model that minimizes these information criteria. We repeated the selection of the model order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e352" xlink:type="simple"/></inline-formula> times, using each of the criteria and using the spike data that contains respective number of trials (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e353" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e354" xlink:type="simple"/></inline-formula>). The count of the order of spike interactions that minimizes the applied information criteria is increased by 1, and finally expressed as a frequency. The asterisk marks the most frequently selected model.</p>
              </fn>
            </table-wrap-foot></table-wrap>
          <table-wrap id="pcbi-1002385-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.t004</object-id><label>Table 4</label><caption>
              <title>Model orders selected by different information criteria for different numbers of trials.</title>
            </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002385-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.t004" xlink:type="simple"/><table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="5" rowspan="1">The number of trials</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e355" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e356" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e357" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e358" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e359" xlink:type="simple"/></inline-formula>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" colspan="1" rowspan="1">AIC</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">BIC</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">PDIO</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">KL-risk</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">MSE</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                  <td align="left" colspan="1" rowspan="1">3</td>
                </tr>
              </tbody>
            </table></alternatives><table-wrap-foot>
              <fn id="nt105">
                <label/>
                <p>The state-space log-linear models of different orders (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e360" xlink:type="simple"/></inline-formula>) are applied to samples of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e361" xlink:type="simple"/></inline-formula> spike sequences of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e362" xlink:type="simple"/></inline-formula> repeated trials generated from a time-dependent full log-linear model (indicated by the dashed lines in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref>). Three data-driven information criteria, AIC, BIC, and PDIO, are computed for the fitted state-space models of the different orders, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e363" xlink:type="simple"/></inline-formula>. The count for the model order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e364" xlink:type="simple"/></inline-formula> that minimizes the respective criteria is determined by repeating the process for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e365" xlink:type="simple"/></inline-formula> repetitions as in <xref ref-type="table" rid="pcbi-1002385-t003">Table 3</xref>. The most frequently selected model order, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e366" xlink:type="simple"/></inline-formula>, is displayed for each of the information criteria and for the different numbers of trials, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e367" xlink:type="simple"/></inline-formula>. For comparison, we also show the order of interactions that minimizes the KL risk function (KL-risk) and mean squared error (MSE). We approximated the KL-risk and MSE as follows. At each bin, we compute the KL-divergence (Eq. 21), between a full underlying log-linear model of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e368" xlink:type="simple"/></inline-formula> neurons and the estimated log-linear model whose parameters are given by the MAP estimates of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e369" xlink:type="simple"/></inline-formula> th-order model. The total sum of the all KL-divergences from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e370" xlink:type="simple"/></inline-formula> bins is used as the distance between the two (time-dependent) models: i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e371" xlink:type="simple"/></inline-formula>, where the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e372" xlink:type="simple"/></inline-formula> is given in Eq. 21. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e373" xlink:type="simple"/></inline-formula> represents the underlying log-linear parameters used to generate the data. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e374" xlink:type="simple"/></inline-formula> is its estimate from one sample composed of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e375" xlink:type="simple"/></inline-formula> trials. The parameters higher than the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e376" xlink:type="simple"/></inline-formula> th-order that are not included in the model are set to zero. The KL-risk function is estimated as the average of the KL-divergences of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e377" xlink:type="simple"/></inline-formula> realizations of the spike data, each composed of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e378" xlink:type="simple"/></inline-formula> trials. To obtain the MSE, we first computed the sum of the squared errors (SE) : <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e379" xlink:type="simple"/></inline-formula>, using one sample composed of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e380" xlink:type="simple"/></inline-formula> trials. The MSE is then estimated as the average of the SEs over 100 samples.</p>
              </fn>
            </table-wrap-foot></table-wrap>
          <p>We compare the outcomes of the AIC and two other information criteria with the model order that minimizes the KL risk function (KL-risk). For this goal, we include in <xref ref-type="table" rid="pcbi-1002385-t004">Table 4</xref> the model order that minimizes the KL-risk between the underlying log-linear model (<xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref>, dashed lines) and estimates of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e381" xlink:type="simple"/></inline-formula> th-order model. In addition to the KL-risk, we calculate the mean squared error (MSE) between the underlying model parameters and corresponding estimates. Please see in the caption of <xref ref-type="table" rid="pcbi-1002385-t004">Table 4</xref> how we compute the KL-risk and MSE for this analysis. We find that the KL-risk and MSE select the same model, except for the case of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e382" xlink:type="simple"/></inline-formula> trials. In comparison to the KL-risk, the BIC tends to select models with an excessively higher-order of interaction (over-fitting) for a small number of trials (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e383" xlink:type="simple"/></inline-formula>) and tends to choose lower-order models for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e384" xlink:type="simple"/></inline-formula>. The PDIO mostly selects lower-order models. In contrast, the AIC follows the selection of the KL-risk minimization principle, except for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e385" xlink:type="simple"/></inline-formula>, where it shows a conservative choice compared to the KL-risk.</p>
          <p>We repeat the same analysis for spike data generated from an underlying model that contains up to pairwise interactions, but does not contain the triple-wise interaction term. The purpose of this analysis is to show that the methods do not select models with excessively higher orders of interaction than those actually contained in the data. To construct such an underlying model, we project the full model (shown in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref>) onto the subspace of a pairwise log-linear model, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e386" xlink:type="simple"/></inline-formula>. The projection model does not contain any triple-wise correlation, while the 1st and 2nd order expectation parameters (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e387" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e388" xlink:type="simple"/></inline-formula>) are the same as those of the full model that was used to generate the data in the analysis of <xref ref-type="table" rid="pcbi-1002385-t002">Tables 2</xref>–<xref ref-type="table" rid="pcbi-1002385-t003"/><xref ref-type="table" rid="pcbi-1002385-t004">4</xref>. <xref ref-type="table" rid="pcbi-1002385-t005">Table 5</xref> displays the most frequently selected model orders by the AIC, BIC, PDIO, along with the selections by the KL-risk and MSE. We find that the pairwise model is the most frequently selected model under all of the criteria for the samples with a large number of trials (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e389" xlink:type="simple"/></inline-formula>). Under this condition, only the AIC among the other data-driven methods follows the KL-risk selection. These results lead us to the conclusion that the AIC is a reliable measure to assess the goodness of fit of the state-space log-linear model.</p>
          <table-wrap id="pcbi-1002385-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.t005</object-id><label>Table 5</label><caption>
              <title>Model orders selected using different information criteria for model without triple-wise spike interaction.</title>
            </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002385-t005-5" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.t005" xlink:type="simple"/><table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="5" rowspan="1">The number of trials</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e390" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e391" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e392" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e393" xlink:type="simple"/></inline-formula>
                  </td>
                  <td align="left" colspan="1" rowspan="1">
                    <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e394" xlink:type="simple"/></inline-formula>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" colspan="1" rowspan="1">AIC</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">BIC</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">PDIO</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">KL-risk</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">MSE</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                </tr>
              </tbody>
            </table></alternatives><table-wrap-foot>
              <fn id="nt106">
                <label/>
                <p>Similar to <xref ref-type="table" rid="pcbi-1002385-t004">Table 4</xref>, the state-space log-linear models (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e395" xlink:type="simple"/></inline-formula>) are repeatedly applied to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e396" xlink:type="simple"/></inline-formula> samples of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e397" xlink:type="simple"/></inline-formula> spike sequences with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e398" xlink:type="simple"/></inline-formula> trials. In contrast to <xref ref-type="table" rid="pcbi-1002385-t004">Table 4</xref>, here a sample of spike sequences is generated from a pairwise (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e399" xlink:type="simple"/></inline-formula>) time-dependent log-liner model of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e400" xlink:type="simple"/></inline-formula> neurons. This underlying model is a projection of the full log-liner model examined in <xref ref-type="table" rid="pcbi-1002385-t004">Table 4</xref> (dashed lines in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref>) to the pairwise model space. The frequencies of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e401" xlink:type="simple"/></inline-formula> th order model that minimizes AIC, BIC, and PDIO are counted by repeatedly applying models with different orders (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e402" xlink:type="simple"/></inline-formula>) to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e403" xlink:type="simple"/></inline-formula> samples (each with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e404" xlink:type="simple"/></inline-formula> trials). The most frequently selected models are displayed for the different criteria and for different numbers of trials, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e405" xlink:type="simple"/></inline-formula>, as in <xref ref-type="table" rid="pcbi-1002385-t004">Table 4</xref>. The rows for the KL-risk and MSE display the models that minimize the estimates of the KL-risk and MSE.</p>
              </fn>
            </table-wrap-foot></table-wrap>
        </sec>
        <sec id="s2c2">
          <title>Selection of state transition model</title>
          <p>In addition to validating the inclusion of the order of spike interactions, we examine state models (Eq. 8) with different conditions for the hyper-parameters by the AIC, using as an example the same spike train data of 3 neurons with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e406" xlink:type="simple"/></inline-formula> trials (displayed in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4A</xref>). The tested state models are (i) a time-independent model in which the hyper-parameters are fixed as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e407" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e408" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e409" xlink:type="simple"/></inline-formula> is an identity matrix; (ii) a random walk model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e410" xlink:type="simple"/></inline-formula>), in which only the covariance matrix, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e411" xlink:type="simple"/></inline-formula>, is optimized via the EM algorithm; and (iii) a 1st-order autoregressive model, in which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e412" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e413" xlink:type="simple"/></inline-formula> are both optimized. With these settings, the state-space log-linear model of case (i) becomes a stationary log-linear model, which has been frequently employed in spike data analyses, often in the form of a maximum entropy model <xref ref-type="bibr" rid="pcbi.1002385-Schneidman2">[55]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Tang1">[57]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Shlens2">[82]</xref>. In contrast, the state-space models of cases (ii) and (iii) are nonstationary because the joint distribution of the spike pattern changes in time as a result of the time-varying log-linear parameters. The interaction parameters themselves are assumed to be nonstationary in the state model in case (ii), and can be either stationary or nonstationary in the state model in case (iii). To see this, let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e414" xlink:type="simple"/></inline-formula> be the eigenvalues of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e415" xlink:type="simple"/></inline-formula>, i.e., the solutions for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e416" xlink:type="simple"/></inline-formula>. For a stationary process, the eigenvalues have to satisfy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e417" xlink:type="simple"/></inline-formula>, otherwise the process is nonstationary. This excludes the case <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e418" xlink:type="simple"/></inline-formula>.</p>
          <p>The AICs of the full model with the various state-equations become progressively smaller for increasingly complex state-space models (38525 for case (i), 36263 for case (ii), and 36231 for case (iii)). The fact that conditions (ii) and (iii) are better fitted to the data than condition (i) confirms that the proposed method of time-varying spike correlation analysis performs better than an analysis based on a stationary log-linear model for this data. In addition, the fact that condition (iii) better fits the data than condition (ii) supports the use of autoregressive models (note: The estimation in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4B</xref> is done with state model (iii)). We find that the fitted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e419" xlink:type="simple"/></inline-formula> (to the data in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4A</xref>) yields an eigenvalue larger than 1, indicating that the underlying state process (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e420" xlink:type="simple"/></inline-formula> bins) is modeled as a nonstationary process. We consider that the nonstationary state model is selected because of the relatively short observation period, during which a nonstationary trend for the parameters can appear even if the state process is stationary in the long run.</p>
        </sec>
      </sec>
      <sec id="s2d">
        <title>Test for presence of spike correlation in nonstationary spike sequences</title>
        <p>One of the goals of a time resolved analysis of spike correlation is to discover dynamical changes in the correlated activities of neurons that reflect the behavior of an animal. This implies the necessity of dealing with the within-trial nonstationarity that is typically present in the data from awake behaving animals. However, we know from other correlation analysis approaches that, if not well corrected for, nonstationary spike data bear the potential danger of generating false outcomes <xref ref-type="bibr" rid="pcbi.1002385-Grn1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Louis1">[83]</xref>. Here we deal with the within-trial nonstationarity of the data by using the state-space log-linear model while assuming identical dynamic spiking statistics across trials (across-trial stationarity). In order to correctly detect the time-varying correlation structure within trials, we apply to the state-space log-linear model a Bayesian model comparison method based on the Bayes factor (BF) <xref ref-type="bibr" rid="pcbi.1002385-Jeffreys1">[74]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Kass2">[76]</xref>, and combine it with a surrogate approach. The BF is a likelihood ratio for two different hypothetical models of latent signals, e.g., in our application, different underlying spike correlation structures. Using the BF, we determine which of the two spike correlation models the spike data supports. By computing the BF for a particular task period in a behavioral experiment, we can test whether the assumed correlation structure appears in association with the timing of the animal's behavior. In the following, we denote a specific task period of interest by the time period <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e421" xlink:type="simple"/></inline-formula>.</p>
        <p>In this study, the BF, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e422" xlink:type="simple"/></inline-formula>, is defined as the ratio of the marginal likelihoods of the observed spike patterns, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e423" xlink:type="simple"/></inline-formula>, in the time period <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e424" xlink:type="simple"/></inline-formula> under different models, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e425" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e426" xlink:type="simple"/></inline-formula>, assumed for the hidden state parameters,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e427" xlink:type="simple"/><label>(12)</label></disp-formula>By successively conditioning the past, the BF is computed by the multiplication of the bin-by-bin one-step BF given at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e428" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e429" xlink:type="simple"/></inline-formula>. Here, the bin-by-bin BF at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e430" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e431" xlink:type="simple"/></inline-formula>, can be calculated as (see the <xref ref-type="sec" rid="s4">Methods</xref> subsection, ‘Bayesian model comparison method for detecting spike correlation’),<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e432" xlink:type="simple"/><label>(13)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e433" xlink:type="simple"/></inline-formula> is the space of the interaction parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e434" xlink:type="simple"/></inline-formula>, for the model, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e435" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e436" xlink:type="simple"/></inline-formula>). In Eq. 13, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e437" xlink:type="simple"/></inline-formula> is the filter density and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e438" xlink:type="simple"/></inline-formula> is called the one-step prediction density, both of which are obtained in the Bayesian recursive filtering algorithm developed in the <xref ref-type="sec" rid="s4">Methods</xref> section (cf. Eqs. 25, 26 and Eqs. 31, 32). Therefore, the bin-by-bin BF at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e439" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e440" xlink:type="simple"/></inline-formula>, is the ratio of the odds (of opposing models) found by observing the spike train data up to time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e441" xlink:type="simple"/></inline-formula> (filter odds, the numerator in Eq. 13) to the odds predicted from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e442" xlink:type="simple"/></inline-formula> without observing the data at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e443" xlink:type="simple"/></inline-formula> (prediction odds, the denominator in Eq. 13). Thus, an unexpected synchronous spike pattern that significantly updates the filter odds for the interaction parameters from their predicted odds gives rise to a large absolute value for the BF. Because the posterior densities are approximated as a multivariate normal distribution in our filtering algorithm, the BF at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e444" xlink:type="simple"/></inline-formula> can be easily computed by using normal distribution functions. Please see the subsection, ‘Bayesian model comparison method for detecting spike correlation’, in the <xref ref-type="sec" rid="s4">Methods</xref> section for the derivation of Eq. 13 and detailed analysis of the BF.</p>
        <p>The BF becomes larger than 1 if the data, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e445" xlink:type="simple"/></inline-formula>, support model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e446" xlink:type="simple"/></inline-formula> as opposed to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e447" xlink:type="simple"/></inline-formula> as an underlying spike correlation structure and becomes smaller than 1 if the data support model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e448" xlink:type="simple"/></inline-formula> as opposed to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e449" xlink:type="simple"/></inline-formula>. Alternatively, it is possible to use the logarithm of the BF, known as the ‘weight of evidence’ <xref ref-type="bibr" rid="pcbi.1002385-Good1">[75]</xref> which becomes positive if the data support model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e450" xlink:type="simple"/></inline-formula> as opposed to model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e451" xlink:type="simple"/></inline-formula> and negative in the opposite situation. Below, we display the results for the BF in bit units (logarithm of the BF to base 2), i.e., the weight of evidence. By sequentially computing the bin-by-bin BF, we can obtain the weight of evidence in a period <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e452" xlink:type="simple"/></inline-formula> as the summation of the local weight of evidence: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e453" xlink:type="simple"/></inline-formula>.</p>
        <p>An intuitive interpretation of the BF values is provided in the literature <xref ref-type="bibr" rid="pcbi.1002385-Jeffreys1">[74]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Kass2">[76]</xref>. For example, in <xref ref-type="bibr" rid="pcbi.1002385-Kass2">[76]</xref>, a BF (weight of evidence) from 1.6 to 4.3 bit was interpreted as ‘positive’ evidence in favor of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e454" xlink:type="simple"/></inline-formula> against <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e455" xlink:type="simple"/></inline-formula>. Similarly, a BF from 4.3 to 7.2 bit was interpreted as ‘strong’ evidence, and a BF larger than 7.2 bit was found to be ‘very strong’ evidence in favor of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e456" xlink:type="simple"/></inline-formula> against <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e457" xlink:type="simple"/></inline-formula>. While the classical guidelines are useful in practical situations, they are defined subjectively. Thus, in this study, in order to objectively analyze the observed value of the BF, we combine the Bayesian model comparison method with a surrogate approach. In this surrogate method, we test the significance of the observed BF for the tested spike interactions by comparing it with the surrogate BFs computed from the null-data generated by destroying only the target spike interactions while the other structures such as the time-varying spike-rates and lower-order spike interactions are kept intact.</p>
        <p>The BF in a behaviorally relevant sub-interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e458" xlink:type="simple"/></inline-formula> can be computed from the optimized state-space log-linear model fitted to the entire spike train data in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e459" xlink:type="simple"/></inline-formula>. Here, for the purpose of testing spike correlation in the sub-interval, we recommend to use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e460" xlink:type="simple"/></inline-formula> in the state model because the autoregressive parameters are optimized for entire spike train data, which are not necessarily optimal for the sub-interval. Similarly, a typical trial-based experiment is characterized by discrete behavioral or behaviorally relevant events, e.g. movement onset after a go signal or a cue signal for trial start, etc. Thus, on top of the expected smooth time-varying change in the spike-rate and spike-correlation, sudden transitions may be expected in their temporal trajectories. Because we use time-independent smoothing parameters (i.e., hyper parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e461" xlink:type="simple"/></inline-formula> in Eq. 8) that were optimized to entire data (see the EM algorithm in the <xref ref-type="sec" rid="s4">Methods</xref> section), such abrupt changes may not be captured very well. This may cause a false detection or failure in the detection of the spike correlation at the edge of a task period. For such data, we suggest applying the Bayesian model comparison method to state-space models which are independently fitted to each of the task periods (or relatively smooth sub-intervals within each task period).</p>
        <sec id="s2d1">
          <title>Detecting triple-wise spike correlation in simulated nonstationary spike sequences</title>
          <p>In this subsection, we examine a method to test for the presence of a higher-order (triple-wise) spike correlation using simulated spike train data with known spike interaction dynamics. In this context, we again use the simulated spike data of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e462" xlink:type="simple"/></inline-formula> neurons (of length 500 bins with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e463" xlink:type="simple"/></inline-formula> trials) shown in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4A</xref>, which was generated by the time-varying model, as shown in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref> (dashed lines). In the following, we assume for this data an underlying experimental protocol that can be segmented into behaviorally-relevant time periods, I–IV, as indicated in <xref ref-type="fig" rid="pcbi-1002385-g005">Figure 5A</xref>, as for example a period before the trial starts, a preparatory period, a movement period, etc. (e.g., see <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Kilavik1">[19]</xref> for a typical experimental protocol).</p>
          <fig id="pcbi-1002385-g005" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.g005</object-id>
            <label>Figure 5</label>
            <caption>
              <title>Detection of spike correlations and their relation to pseudo experimental protocol (simulation study).</title>
              <p>(A) Sketch of an assumed experimental time course composed of four epochs (I–IV), e.g., of different behavioral task conditions. Epochs I–III have a duration of 100 bins, period IV has a duration of 200 bins. (B) Time-varying triple-wise spike interaction parameter of the underlying model (cf. <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e464" xlink:type="simple"/></inline-formula>) used for the simulation of spike data (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e465" xlink:type="simple"/></inline-formula> neurons, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e466" xlink:type="simple"/></inline-formula> trials) during the time course outlined in A. The gray areas indicate the time intervals in which the triple-wise interaction is positive: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e467" xlink:type="simple"/></inline-formula>. (C) Hypothesis testing for a triple-wise spike correlation based on surrogates. In each time period (I–IV), we perform a test on the Bayes factor (BF) resulting from the original data. The observed BF (Eq. 12), marked by a red line and triangle, is computed as evidence of a positive triple-wise interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e468" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e469" xlink:type="simple"/></inline-formula>, as opposed to a zero or negative triple-wise interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e470" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e471" xlink:type="simple"/></inline-formula>. We then compare the ‘observed BF’ with cumulative distribution functions (CDFs, solid lines) for the BFs derived from surrogate data sets generated from a model containing only up to pairwise interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e472" xlink:type="simple"/></inline-formula>). In all of the CDFs, the gray area indicates the 95% confidence interval of the distribution. If the observed BF falls into the lower tail of the distribution (blue area), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e473" xlink:type="simple"/></inline-formula> is supported; if it falls into the upper tail (red marked area), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e474" xlink:type="simple"/></inline-formula> is supported. (D) Time courses of the underlying pair-interaction parameters of a pairwise log-linear model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e475" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e476" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e477" xlink:type="simple"/></inline-formula>). These underlying parameters are obtained by projecting the full underlying model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e478" xlink:type="simple"/></inline-formula>) in <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4</xref> to the pairwise model space, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e479" xlink:type="simple"/></inline-formula>. The gray areas indicate the time periods in which all of the pairwise interactions are positive. (E) Similar tests as in C, but for the BF computed as evidence for the presence of simultaneous positive pairwise interactions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e480" xlink:type="simple"/></inline-formula>, as opposed to the absence of such an assembly, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e481" xlink:type="simple"/></inline-formula>. (F) Compact visualization of the test results from C and E. The colored bars show which hypotheses are supported in the different time segments (red and blue) and where the null hypothesis cannot be rejected.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.g005" xlink:type="simple"/>
          </fig>
          <p>In each of the time periods, we compare opposing models for the hidden log-linear parameters of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e482" xlink:type="simple"/></inline-formula> neurons, using a full model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e483" xlink:type="simple"/></inline-formula>). In one hypothetical model, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e484" xlink:type="simple"/></inline-formula>, we assume that the triple-wise interaction term is positive, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e485" xlink:type="simple"/></inline-formula>. The time (bin) index <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e486" xlink:type="simple"/></inline-formula> expresses that the BF is computed under the same models for all of the time steps, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e487" xlink:type="simple"/></inline-formula>, in the respective time period. In the other model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e488" xlink:type="simple"/></inline-formula>, we assume that the triple-wise interaction term is smaller than or equal to zero, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e489" xlink:type="simple"/></inline-formula>. Neither model makes specific assumptions about the first and second order log-linear parameters; thus, they are allowed to be real numbers. These parameters are integrated out in Eq. 13. In this simulation study, we independently applied a state-space log-linear model to each of the four periods and computed the respective BFs. <xref ref-type="fig" rid="pcbi-1002385-g005">Figure 5B</xref> displays the ground truth of the time-dependent triple-wise interaction parameter, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e490" xlink:type="simple"/></inline-formula>, of the full log-linear model. The gray areas indicate periods where the triple-wise spike interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e491" xlink:type="simple"/></inline-formula>, is positive: Model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e492" xlink:type="simple"/></inline-formula> is true in this period. In the remaining periods (white), the model of a negative triple-wise spike interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e493" xlink:type="simple"/></inline-formula>, is true.</p>
          <p>We compare the observed BF for the tested correlation models to the BFs computed from surrogate data sets resampled under a null hypothesis of no tested order of spike interaction. Specifically, to test the existence of a triple-wise spike correlation, the surrogate BFs are computed from resampled spikes generated from a model containing no triple-wise spike interaction. For this, we first apply a pairwise state-space log-linear model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e494" xlink:type="simple"/></inline-formula>) to the observed spike data to derive estimates of the time-varying spike rates and dynamic pair-interactions. Then we generate 1000 surrogate samples of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e495" xlink:type="simple"/></inline-formula> parallel spike sequences, where each sample is composed of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e496" xlink:type="simple"/></inline-formula> trials, using the fitted pairwise state-space log-linear model. Thus, the resampled spike sequences exhibit the same time-varying spike rates and pairwise correlations as the original data, but the triplet coincidences occur on a chance level, as expected by the individual spike rates and pairwise correlations among the neurons. The surrogate BFs of a triple-wise spike correlation (using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e497" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e498" xlink:type="simple"/></inline-formula>) are computed for each surrogate data set by applying the full model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e499" xlink:type="simple"/></inline-formula>).</p>
          <p><xref ref-type="fig" rid="pcbi-1002385-g005">Figure 5C</xref> shows the observed BF (red vertical line and red triangle) and the cumulative distribution function (CDF) of the surrogate BFs (solid black lines) for each of the four time periods, I–IV. In each of the graphs, the gray area indicates the 95% confidence interval derived from the distribution of 1000 respective surrogate BFs. If the observed BF falls outside the confidence interval, the null hypothesis that no tested order of spike interaction exists is rejected. Further, by the two-tailed test, if the observed BF falls outside the confidence interval into the red area of the distribution on the right (i.e., significantly positive BF values), the data supports model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e500" xlink:type="simple"/></inline-formula> as an underlying correlation structure, whereas if it falls into the blue area on the left, we conclude that it is a significantly negative BF, i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e501" xlink:type="simple"/></inline-formula> is supported. If the observed BF falls into the 95% confidence interval, the null hypothesis that no tested order of spike correlation exists is not rejected. We first look at the results for periods II and IV in <xref ref-type="fig" rid="pcbi-1002385-g005">Figure 5C</xref>. In these periods, the null hypothesis of no triple-wise spike correlation is rejected, and the observed BF correctly suggests a positive triple-wise correlation model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e502" xlink:type="simple"/></inline-formula>), reflecting the fact that the underlying triple-wise interaction term is positive throughout the two periods (see periods II and IV in <xref ref-type="fig" rid="pcbi-1002385-g005">Figure 5B</xref>). In contrast, in periods I and III, where a negative triple-wise correlation model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e503" xlink:type="simple"/></inline-formula>) is true, the null hypothesis of no triple-wise correlation cannot be rejected.</p>
          <p>It is possible that the synchronous spike events observed among multiple neurons are detected as simultaneous increases in pair interaction terms using the log-linear model of the second order (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e504" xlink:type="simple"/></inline-formula>), without having to take higher-order spike interactions into consideration. Paradoxically, this issue becomes relevant when a triple-wise spike correlation is a dominant factor in the generation of synchronous spike events because the projection of a full model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e505" xlink:type="simple"/></inline-formula>) that contains a positive triple-wise interaction term to a pairwise model induces simultaneous increases in the pair interaction terms in that projected model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e506" xlink:type="simple"/></inline-formula>). In such a case, an analysis of the higher-order spike correlations might just add redundant information about an animal's behavior to lower-order analyses. Thus, we repeat an analysis similar to the one above under this alternative hypothesis, using a model that contains up to pairwise interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e507" xlink:type="simple"/></inline-formula>). In this test, the BF (Eq. 12) is computed using the following assumed models on the hidden log-linear parameters: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e508" xlink:type="simple"/></inline-formula>, all three neurons simultaneously exhibit positive pairwise interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e509" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e510" xlink:type="simple"/></inline-formula>); and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e511" xlink:type="simple"/></inline-formula>, at least one of the pairwise interactions is not positive (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e512" xlink:type="simple"/></inline-formula> for at least one <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e513" xlink:type="simple"/></inline-formula>). The first order log-linear parameters are again assumed to be real values. Surrogate data sets are obtained by resampling spike sequences from the first order state-space log-linear model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e514" xlink:type="simple"/></inline-formula>) fitted to the data. The surrogate BFs for the model of simultaneously positive pairwise interactions, as opposed to its complementary model, are computed for each of the surrogate data sets by applying a pairwise model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e515" xlink:type="simple"/></inline-formula>). <xref ref-type="fig" rid="pcbi-1002385-g005">Figure 5D</xref> displays the ground truth of the dynamics of the pairwise interaction terms, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e516" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e517" xlink:type="simple"/></inline-formula>), of the pairwise log-linear model. These are obtained by projecting the full underlying model (<xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref> dashed lines) to the probability space of the second-order model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e518" xlink:type="simple"/></inline-formula>). Note that in period II, the pair-interaction terms simultaneously increase because the effect of the triple-wise interaction in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e519" xlink:type="simple"/></inline-formula> is projected to this sub-space model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e520" xlink:type="simple"/></inline-formula>) (see <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4C</xref>, middle panel, for comparison, and observe that there is no such increase in the pair-interaction terms of the full log-linear model). The gray areas indicate the period where model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e521" xlink:type="simple"/></inline-formula> (simultaneously positive pairwise interactions) is true. <xref ref-type="fig" rid="pcbi-1002385-g005">Figure 5E</xref> displays the results for testing the simultaneous increases in the pair interactions. We again look at periods II and IV. In period II, the null hypothesis of independent spike sequences is rejected, and model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e522" xlink:type="simple"/></inline-formula> is supported, reflecting the fact that the projected pairwise interactions are positive for most of this time period. In contrast, the same null hypothesis cannot be rejected in period IV because neither model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e523" xlink:type="simple"/></inline-formula> nor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e524" xlink:type="simple"/></inline-formula> alone can support the data in this period: Models <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e525" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e526" xlink:type="simple"/></inline-formula> are true in the first and second halves of period IV, respectively (see <xref ref-type="fig" rid="pcbi-1002385-g005">Figure 5D</xref>).</p>
          <p><xref ref-type="fig" rid="pcbi-1002385-g005">Figure 5F</xref> summarizes the results for periods I–IV using bars in corresponding colors. The results of our tests reflect the dynamics of the underlying parameters in <xref ref-type="fig" rid="pcbi-1002385-g005">Figures 5B and D</xref>, and we find that in period IV, only the test for a triple-wise spike correlation detected the presence of interactions among all three neurons in the data. This is because, in this time period, the dynamics of the underlying triple-wise interaction correlate well with the assumed behavioral time table, whereas the dynamics of the simultaneous pairwise interactions do not. In summary, it is possible that the higher-order analysis allows us to discover the correlated activities of multiple neurons associated with behavioral events, which may not be revealed by pairwise analyses.</p>
        </sec>
        <sec id="s2d2">
          <title>Detecting triple-wise spike correlation in neural spike data from behaving monkey</title>
          <p>Finally, we demonstrate the application of our method on simultaneous spike recordings from the primary motor cortex (MI) of an awake, behaving monkey. The data were recorded by Alexa Riehle and her colleagues <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref> to test the hypothesis that neuronal cooperativity is involved in the planning of motor actions. Therefore, Riehle et al. designed a behavioral task in which different durations of preparation intervals were provided to the monkeys before they had to perform an arm movement and touch a target on a screen. The detailed time table of the task is as follows (cf. <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6A</xref>). A trial started by a signal indicating to the monkey that he may initiate the task by pressing a button. After initiating the trial, the monkey had to wait for 1000 ms until a preparatory signal (PS) was delivered, indicating to the monkey that now the preparation interval started. After appearance of a response signal (RS) at 600, 900, 1200, or 1500 ms (randomly selected with equal probability), the monkey had to move his arm and touch the target position. The reaction times of the monkey showed a dependence on the duration of the preparatory period (PP): The longer the PPs the shorter the reaction times <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Kilavik1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Riehle2">[84]</xref>. The conditional probability for the occurrence of the RS increases during the longer PP, in particular at the times when the RS may occur. The hypothesis for the underlying network activity realizing reduced reaction times with longer PPs was that the system is better prepared for the requested movement by increasingly enhancing the synchrony in the relevant network to facilitate the response. Indeed, Riehle et al. showed that cortical neurons modulate the degree of excess synchronous spiking activities independently from their individual firing rates in conjunction with the occurrence of the expected RSs <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Kilavik1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Riehle2">[84]</xref>. An open question that could not be conclusively answered in that study was if larger groups of neurons than pairs coordinate their activity in relation to the expected events. Here, we approach this question by applying our newly developed method and will indeed demonstrate the existence of higher-order (triple-wise) spike interaction in relation to the behavioral task.</p>
          <fig id="pcbi-1002385-g006" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.g006</object-id>
            <label>Figure 6</label>
            <caption>
              <title>Analysis of experimental spike data using the state-space log-linear model.</title>
              <p>(A) Experimental time table of delayed-response hand movement task. The experiments were designed and conducted by Riehle and her colleagues <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Riehle2">[84]</xref>. During the preparatory period (PP, 1500 ms) that starts with the preparatory signal (PS), the presentation of the response signal (RS) was expected at three distinct moments at 600, 900, and 1200 ms (expected signals, ESs). Here the RS occurs finally after the longest possible delay of 1500 ms. After the RS, the requested movement was executed (reaction and movement time, RT-MT). See <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Riehle2">[84]</xref> and the text for the detailed experimental protocol. (B) Dot displays of the spike sequences (duration: 2 s, sampling resolution 1 ms) of three neurons simultaneously recorded from the primary motor cortex (MI). The spike sequences are aligned at the onset of the PS (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e527" xlink:type="simple"/></inline-formula> trials). The synchronous spike events across the 3 neurons detected in individual trials (detection in bins of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e528" xlink:type="simple"/></inline-formula> width) are marked by blue circles. (C) Observed rates of joint spike events, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e529" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e530" xlink:type="simple"/></inline-formula>). All of the events are detected in bins with a width of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e531" xlink:type="simple"/></inline-formula>. (Top) Observed rates of the spike occurrence of the individual neurons (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e532" xlink:type="simple"/></inline-formula>). (Middle) Observed rates of the synchronous spike events between two neurons specified by index <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e533" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e534" xlink:type="simple"/></inline-formula>). (Bottom) Observed rate of the synchronous spike events of all 3 neurons, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e535" xlink:type="simple"/></inline-formula>. (D) Estimation of the time-varying log-linear parameters of 3 neurons, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e536" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e537" xlink:type="simple"/></inline-formula>), from the binary data shown in C, according to the method summarized in <xref ref-type="table" rid="pcbi-1002385-t001">Table 1</xref>. The panels depict the MAP estimates of the log-linear interaction parameters (solid lines; from top to bottom, the first and second order log-linear parameters and a triple-wise spike interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e538" xlink:type="simple"/></inline-formula>). The gray bands indicate the 95% credible interval. In this analysis, we used an identity matrix as an autoregressive parameter, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e539" xlink:type="simple"/></inline-formula>, in the state model. The covariance matrix of the initial parameter was fixed to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e540" xlink:type="simple"/></inline-formula>. (E) The smoothed estimate of a triple-wise spike interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e541" xlink:type="simple"/></inline-formula>, is computed from binary data constructed using a bin-width of 2 ms (Top) and a bin-width of 5 ms (Bottom). The top of each panel shows the timing of the synchronous spike events of all three neurons.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.g006" xlink:type="simple"/>
          </fig>
          <p>To that end, we analyze data which were in part analyzed by the Unitary Events analysis method (neuron id 2 and 3; shown in <xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2</xref> in <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>). <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6B</xref> shows this particular data set that consists of three simultaneously recorded neurons (neuron id 2, 3, and 5; Here we denote them as neuron 1, 2, and 3) observed during trials (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e542" xlink:type="simple"/></inline-formula>) of the longest preparatory period of 1500 ms. As in Riehle et al. (<xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2</xref> in <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>) we align the trials at the PS, and analyze the data for the interaction parameters as a function of time from 200 ms before the PS and 1800 ms after the PS. This time segment is composed of three behavioral epochs: an interval before the PS (200 ms), the PP with three expected signals (ESs, at 600, 900 and 1200 ms), and a period after the RS at 1500 ms including the reaction time and partly the movement (reaction and movement time, RT-MT) (see <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6A</xref>). The average firing rates of the neurons during the PP are 29.4, 12.9, and 41.9 Hz for neurons 1, 2, and 3 (neuron id 2, 3, and 5) respectively. We constructed binary sequences, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e543" xlink:type="simple"/></inline-formula>, from the spike times of the neurons by binning the data using a bin-width of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e544" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6C</xref> displays the occurrence rates for the individual spiking activities (upper panel) and the pair and triple synchronous spike events (middle and bottom panels) detected in the bins with a width of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e545" xlink:type="simple"/></inline-formula>.</p>
          <p>We apply a full log-linear model of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e546" xlink:type="simple"/></inline-formula> neurons with up to a triple-wise interaction term to the binary spike data shown in <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6C</xref>. <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6D</xref> displays the estimated dynamics of the interaction parameters in the log-linear model by using the method summarized in <xref ref-type="table" rid="pcbi-1002385-t001">Table 1</xref>. The thick bold lines indicate the MAP estimates, i.e., the most probable paths, of the interaction parameters. The gray bands and thin solid lines mark the 95% credible interval (the Bayesian analogue of the confidence interval) computed from a marginal posterior density. The last parameter of the log-linear model, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e547" xlink:type="simple"/></inline-formula>, indicates the triple-wise interaction among the three neurons in the MI. Strong positive (or negative) value of this term indicates that the three neurons are triple-wise correlated, i.e. dependent in a manner that cannot be explained by pair correlations of the neurons. Specifically, a positive triple-wise interaction value means that the occurrence of the synchronous events among the three neurons is more frequent than the chance level expected from the observed individual rates and pairwise spike correlations among them.</p>
          <p>The analysis of the MI neurons using the state-space log-linear model reveals that the triple-wise interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e548" xlink:type="simple"/></inline-formula>, during the PP gradually increases, with additional local peaks at the ESs that also increase in heights towards the end of the PP (<xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6D</xref>, bottom panel). This result is consistent with the results found by Riehle and collaborators for a subset of the neurons of the same data set (<xref ref-type="fig" rid="pcbi-1002385-g002">Figure 2</xref> in <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>). In this previous study neuron 1 and 2 (neuron id 2, 3) were analyzed for excess spike synchrony using the Unitary Events analysis <xref ref-type="bibr" rid="pcbi.1002385-Grn3">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Grn4">[33]</xref>. The analysis revealed that the two neurons exhibit a modulation of significant excess spike synchrony, with peaks at the ESs (despite the first) and at the RS.<xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Grn3">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Riehle2">[84]</xref>. That observation was interpreted as evidence that the neurons cooperate to prepare for motor action and facilitate the efficiency for movement execution <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Riehle2">[84]</xref>. Similarly, occurrences of synchronous spike events of the three neurons roughly coincide with the expected events (ESs) (<xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6C</xref>, bottom panel); accordingly, our result shows that the triple-wise interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e549" xlink:type="simple"/></inline-formula>, is also locked to the ESs, however decreases at RS. Note that the triple-wise interaction is not only determined by the frequency of synchronous spike events of all three neurons but is also determined by frequencies of other observed spike patterns across trials. However, for typical neural spike train data with low spike rates and low rates of synchronous spiking of pairs of neurons, the occurrence of synchronous spike events of three neurons can significantly increase the triple-wise interaction. In the subsection ‘Bayesian model comparison method for detecting spike correlation’ in the <xref ref-type="sec" rid="s4">Methods</xref> section we explore the contribution of different spike patterns in different spiking scenarios to the evidence of a triple-wise spike correlation in simulated data. <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6E</xref> displays modulation of the interaction term, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e550" xlink:type="simple"/></inline-formula>, using the binary data constructed with bins of smaller (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e551" xlink:type="simple"/></inline-formula> ms, upper panel) and larger (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e552" xlink:type="simple"/></inline-formula>, lower panel) widths. The top of each panel shows the timing of the synchronous spike events of all three neurons. The sample sizes for synchronous spike events across all three neurons for the 2 ms bin-width are greatly reduced from those observed for a bin-width of 3 ms. Thus estimated dynamics is much less structured: The data prevents us from detecting existence of a triple-wise spike correlation using the proposed statistical test (see below for the application of the test method). With larger bins of a width of 5 ms, the precise locking of the synchronous spike events across the three neurons to ESs is no longer apparent. However, the state-space log-linear model reveals a gradual increase in the strength of the triple-wise interaction until the end of the PP.</p>
          <p>To strengthen the findings that a triple-wise interaction term increases during the PP, we test for the presence of a triple-wise spike correlation in the PP using the Bayes factor (marginal likelihood ratio, Eq. 12). We compute the BF for the opposing models using a full model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e553" xlink:type="simple"/></inline-formula>) of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e554" xlink:type="simple"/></inline-formula> neurons for the hidden log-linear parameters. In one hypothetical model, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e555" xlink:type="simple"/></inline-formula>, we assume that the triple-wise interaction term is positive, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e556" xlink:type="simple"/></inline-formula>, in the other model, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e557" xlink:type="simple"/></inline-formula> we assume that the triple-wise interaction term is smaller than or equal to zero, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e558" xlink:type="simple"/></inline-formula>. A large positive value of the BF indicates that the spike data in that period supports model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e559" xlink:type="simple"/></inline-formula> as opposed to model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e560" xlink:type="simple"/></inline-formula>, i.e., the existence of excess synchronous spike events among the three neurons in comparison with the chance rate given by spike rates and pairwise correlations. A large negative value of the BF shows support of model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e561" xlink:type="simple"/></inline-formula> as opposed to model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e562" xlink:type="simple"/></inline-formula>, i.e., a paucity of synchronous spikes for the three neurons. <xref ref-type="fig" rid="pcbi-1002385-g007">Figure 7A</xref> shows the BF computed bin-by-bin (Eq. 13) in bit units. In the bottom panel of <xref ref-type="fig" rid="pcbi-1002385-g007">Figure 7A</xref>, we indicate the behavioral periods for which we test for the presence of triple-wise spike correlation (the PP and RT to MT; in later analysis we divide the PP into early and late stages). The evidence for model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e563" xlink:type="simple"/></inline-formula>, as opposed to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e564" xlink:type="simple"/></inline-formula>, in the behaviorally relevant time periods is obtained by summing the log of the bin-by-bin BF in that period (cf. Eqs. 12 and 13). The BF in the PP is found to be 18.08 bit, which is interpreted as ‘very strong’ evidence for presence of a positive triple-wise spike correlation by the classical guideline <xref ref-type="bibr" rid="pcbi.1002385-Kass2">[76]</xref>.</p>
          <fig id="pcbi-1002385-g007" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.g007</object-id>
            <label>Figure 7</label>
            <caption>
              <title>Detection of triple-wise spike correlation of MI neurons.</title>
              <p>(A) (Top) The bin-by-bin Bayes factor (BF) for a model of triple-wise spike interaction computed locally in time in bit units, Eq. 13. The bin-by-bin BF is computed from Eq. 13, using the state-space log-linear model fitted to the spike data (a total of 36 trials, 2 s binned using 3 ms bin-width; cf. <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6C</xref>). The BF computes evidence of a positive triple-wise spike interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e565" xlink:type="simple"/></inline-formula>, as opposed to a zero or negative triple-wise interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e566" xlink:type="simple"/></inline-formula>. The evidence for model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e567" xlink:type="simple"/></inline-formula> as opposed to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e568" xlink:type="simple"/></inline-formula> in a behaviorally relevant time period is obtained by summing the log of the bin-by-bin BF in that period (cf. Eq. 12). (Bottom) Two behavioral periods (preparatory period, PP, and reaction and movement time, RT-MT) tested for presence of a triple-wise spike correlation. In addition, to examine the evolution of the triple-wise spike correlation in the PP, the PP is divided into early and late stages at the middle of the PP. (B) (Left) The observed BF for an entire PP (marked by a red line and triangle) computed using Eq. 12 (bin-width: 3 ms). We then test the ‘observed BF’ using a distribution function (solid line) of null BFs derived from surrogate data sets generated from a fitted model containing only up to pairwise interaction terms (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e569" xlink:type="simple"/></inline-formula>). The gray area indicates the 95% confidence interval of the distribution. Vertical dashed lines indicate the 90% confidence interval. If the observed BF falls into the lower tail of the distribution (blue area), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e570" xlink:type="simple"/></inline-formula> is supported, if it falls into the upper tail (red marked area), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e571" xlink:type="simple"/></inline-formula> is supported. (Right) The same analysis in the left panel, but with binary data constructed using larger (5 ms, upper panel) and smaller (2 ms, lower panel) bin-widths. (C) (Top) Test of observed BFs (bin-width 3 ms) computed in distinct periods: early PP (0–750 ms), late PP (750–1500 ms), and RT-MT (1500–1800 ms). (Bottom) The same test as in the top panel, except that binary data using a bin-width of 5 ms were used. (D) Test of observed BFs (bin-width: 3 ms) in each period using spike data from only the last half of the 36 trials (trials 19–36).</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.g007" xlink:type="simple"/>
          </fig>
          <p>Next, we test the observed value of the BF in the PP (18.08 bit) by comparing it with surrogate BFs. These are computed from null data that contain no triple-wise spike interactions, while keeping the time-varying structure of the pairwise correlations and the individual spike rates the same as those observed in the original spike train data. The construction of the null data follows the same procedure as in the simulation study shown before: We apply a pairwise state-space log-linear model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e572" xlink:type="simple"/></inline-formula>) to the spike data and then generate 1000 surrogate samples (each with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e573" xlink:type="simple"/></inline-formula> trials) of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e574" xlink:type="simple"/></inline-formula> parallel spike sequences using the fitted pairwise state-space log-linear model. <xref ref-type="fig" rid="pcbi-1002385-g007">Figure 7B</xref> (left panel) displays the surrogate distribution along with the observed BF in the PP. The observed positive BF falls out of the 95% confidence interval, suggesting the presence of a positive triple-wise interaction as an underlying model for the spike train data in this period. In the right panels of <xref ref-type="fig" rid="pcbi-1002385-g007">Figure 7B</xref>, we display the results of the same analysis, but using spike train data binned by a larger (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e575" xlink:type="simple"/></inline-formula>, top panel) and a smaller (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e576" xlink:type="simple"/></inline-formula>, bottom panel) bin-width. We obtained almost the same results as in the analysis with a bin-width of 3 ms as for the analysis with the larger bin-width (5 ms). However, we could not reach the same results for the smaller bin width (2 ms) because the small count of synchronous spike events made it impossible to reject the null hypothesis.</p>
          <p>If the higher-order dependency among the three neurons is related to motion preparation, the evidence for the triple-wise spike correlation should be stronger in the late stage of the PP than before. To test this idea, we divided the PP into earlier and later stages of the PP (each with a 750 ms duration, see the bottom of <xref ref-type="fig" rid="pcbi-1002385-g007">Figure 7A</xref>), and investigate whether the three MI neurons exhibit a triple-wise spike correlation in these periods. In addition, we select a duration of 300 ms after the onset of the RS, during which the animal starts to initiate the motor action (reaction and movement time, RT-MT). The upper panels of <xref ref-type="fig" rid="pcbi-1002385-g007">Figure 7C</xref> display the results obtained with bins of width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e577" xlink:type="simple"/></inline-formula> ms. The weights of evidence for the triple-wise spike correlation models are 7.16, 11.2, and 0.98 bit in the early PP, late PP, and RT-MT periods respectively: i.e., ‘very strong’ evidence is found at the late stage of the PP. The null hypothesis is rejected in this late period of the PP whereas the same null hypothesis is not rejected in the earlier period of PP or the period after the RS. In the late PP, the significantly large positive BF indicates the existence of a positive triple-wise spike correlation. The bottom panels of <xref ref-type="fig" rid="pcbi-1002385-g007">Figure 7C</xref> display the same analyses, but with a larger (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e578" xlink:type="simple"/></inline-formula>) bin-width. We obtain the same results as in the analysis with a bin-width of 3 ms. When we analyze the data using a smaller bin-width (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e579" xlink:type="simple"/></inline-formula>), the BFs are not significant in any of the periods (not shown here) because of the small samples of synchronous spikes. In addition, as in the simulation study in the previous subsection, we tested whether the observed synchronous spiking activities are explained merely by simultaneous increases in the pairwise interaction terms of the second order log-linear model. We did not find any evidence for such simultaneous increases in the pairwise interactions from the data for all three periods (bin-width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e580" xlink:type="simple"/></inline-formula>) (not shown here). Thus only by the application of the higher-order analysis we were able to detect the task-dependent changes in the joint interactions of all three neurons.</p>
          <p>The critical assumptions made in this study are independence and identical sampling across the trials (across-trial stationarity). However, in the spike sequences of neuron 2 (neuron id 3) shown in <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6B</xref>, we notice an increase in the firing rates across trials. Higher firing rates yield a higher chance rate for synchronous spiking events. Thus, underestimation of the spike rate caused by averaging across the entire trials might induce spurious estimation of higher-order spike interaction. Indeed, synchronous spike events of the three neurons are mostly observed in later trials (e.g., trials 19–36, see blue dots in <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6B</xref>) when the firing rates were higher than in the earlier trials. Hence, we repeat the same analysis by using only the latter half of the trials (trials 19–36). <xref ref-type="fig" rid="pcbi-1002385-g007">Figure 7D</xref> displays the results. We still observe a significantly positive BF in the late PP. We note that the estimated dynamics of the log-linear parameters using only the latter half of the trials are not changed much from those using all trials, i.e., <xref ref-type="fig" rid="pcbi-1002385-g006">Figure 6D</xref>. In the analysis using the first half of the trials (1–19, not shown), the BF is not significant during the late PP. Kilavik et al. <xref ref-type="bibr" rid="pcbi.1002385-Kilavik1">[19]</xref> reported that “during practice, the temporal structure of synchrony was shaped, with synchrony becoming stronger and more localized in time during late experimental sessions”. We observe similar effects in our triple-wise spike correlation analysis.</p>
        </sec>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>In this study, we introduced a novel method for estimating dynamic spike interactions in multiple parallel spike sequences by means of a state-space analysis (see <xref ref-type="sec" rid="s4">Methods</xref> for details). By applying this method to nonstationary spike train data using the pairwise log-linear model, we can extend the stationary analysis of the spike train data by the Ising/spin-glass model to within-trial nonstationary analysis (<xref ref-type="fig" rid="pcbi-1002385-g003">Figure 3</xref>). In addition, our approach is not limited to a pairwise analysis, but can perform analyses of time-varying higher-order spike interactions (<xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4</xref>). It has been discussed whether higher-order spike correlations are important to characterize neuronal population spiking activities, assuming stationarity in the spike data <xref ref-type="bibr" rid="pcbi.1002385-Roudi1">[54]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Yu1">[59]</xref>. Based on the state-space model optimized by our algorithm, we developed two methods to validate and test its latent spike interaction parameters, in particular the higher-order interaction parameters, which may dynamically change within an experimental trial. In the first method, we selected the proper order for the spike interactions incorporated in the model under the model selection framework using the approximate formula of the AIC for this state-space model (In <xref ref-type="sec" rid="s4">Methods</xref>, ‘Selection of state-space model by information criteria’). This method selects the model that best fits the data overall across the entire observation period. The selected model can then be used to visualize the dynamic spike interactions or for a performance comparison with other statistical models of neuronal spike data. However, more importantly, the detailed structure of the transient higher-order spike interactions needs to be tested locally in time, particularly in conjunction with the behavioral paradigm. To meet this goal, we combined the Bayesian model comparison method (the Bayes factor) with a surrogate method (In <xref ref-type="sec" rid="s4">Methods</xref>, ‘Bayesian model comparison method for detecting spike correlation’). The method allows us to test for the presence of higher-order spike correlations and examine its relations to experimentally relevant events. We demonstrated the utility of the method using neural spike train data simultaneously recorded from primary motor cortex of an awake monkey. The result is consistent with, and further extended the findings in the previous report <xref ref-type="bibr" rid="pcbi.1002385-Riehle1">[8]</xref>: We detected an increase in triple-wise spike interaction among three neurons in the motor cortex during the preparatory period in a delayed motor task, which was also tightly locked to the expected signals. Although the analysis was done for a limited number of neurons, smaller than the expected size of an assembly, it demonstrates that the nonstationary analysis of the higher-order activities is useful to reveal cooperative activities of the neurons that are organized in relation to behavioral demand. Of course, further analysis is required to strengthen the findings made above including a meta-analysis of many different sets of multiple neurons recorded under the same conditions.</p>
      <p>In this study, we adopted the log-linear model to describe the higher-order correlations among the spiking activities of neurons. There are, however, other definitions for ‘higher-order spike correlation’. An important alternative concept is the definition based on cumulants. Using the cumulants of an observed count distribution from a spike train pooled across neurons, Staude et al. developed an iterative test method that can detect the existence of a high amplitude in the jump size distribution of the assumed compound Poisson point process (CPP) model for the pooled spike train <xref ref-type="bibr" rid="pcbi.1002385-Staude1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Staude2">[35]</xref>. This method can detect an assembly from a few occurrences of synchronous spike events to which many neurons belong to, typically by using the lower-order cumulants of the observed spike counts. In contrast, the information geometry measure for the higher-order spike correlation used in this study aims to represent the correlated state that cannot be explained by lower-order interactions. Consequently, the information geometry measure extracts the relative strength of the higher-order dependency to the lower-order correlated state. Therefore, the presence of positive higher-order spike correlations does not necessarily indicate that many neurons spike synchronously whenever they spike because such activities can be induced by positive pairwise spike correlations alone <xref ref-type="bibr" rid="pcbi.1002385-Amari6">[65]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Bohte1">[85]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Staude3">[86]</xref> (see also <xref ref-type="fig" rid="pcbi-1002385-g008">Figure 8A and B</xref> in the <xref ref-type="sec" rid="s4">Methods</xref> section). In contrast, the cumulant-based correlation method by Staude et al. <xref ref-type="bibr" rid="pcbi.1002385-Staude1">[34]</xref> infers the presence of ‘higher-order correlation’ for such data by determining the presence of high amplitudes in the jump size distribution of the assumed CPP model. Yet another important tool for analyzing higher-order dependency among multiple neurons is the copula function, a standardized cumulative distribution function used to model the dependence structure of multiple random variables (see <xref ref-type="bibr" rid="pcbi.1002385-Jenison1">[87]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Onken1">[89]</xref> for an analysis of neurophysiological data using the copula, including an analysis for higher-order dependency <xref ref-type="bibr" rid="pcbi.1002385-Onken1">[89]</xref>). In summary, it should be remembered that the analysis method used for the higher-order dependency among neuronal spikes inherits its goal from the assumed model for spike generation as well as a parametric measure defined for the ‘higher-order’ spike correlation <xref ref-type="bibr" rid="pcbi.1002385-Staude1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Martignon2">[62]</xref>.</p>
      <fig id="pcbi-1002385-g008" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002385.g008</object-id>
        <label>Figure 8</label>
        <caption>
          <title>Analysis of stationary spike correlations of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e581" xlink:type="simple"/></inline-formula> simulated neurons using Bayes factor.</title>
          <p>(A) Sketch of different time periods and the underlying models used for the generation of parallel spike sequences: (I) Model of independent spiking (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e582" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e583" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e584" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e585" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e586" xlink:type="simple"/></inline-formula>); (II) Model of simultaneously positive pairwise interactions, without a triple-wise interaction (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e587" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e588" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e589" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e590" xlink:type="simple"/></inline-formula>); (III) Model of triple-wise interaction, with negative pair interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e591" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e592" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e593" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e594" xlink:type="simple"/></inline-formula>). (B) Raster display of three parallel spike sequences, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e595" xlink:type="simple"/></inline-formula>, within one example trial. Each spike is colored according to the spike pattern in which it appears: Spikes occurring in triplets are shown in red, spikes within doublets (all types) are marked in blue, and spikes not involved in any synchrony pattern are shown in black. (C) The bar plots demonstrate the Bayes factors (BFs), Eq. 48, for each of the time periods I–III in bit units. The upper panel shows the average BF when testing simultaneously positive pairwise interactions (Test 1), averaged across 200 realizations (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e596" xlink:type="simple"/></inline-formula>). A positive value for the log of the BF supports the model for the presence of simultaneously positive pairwise interactions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e597" xlink:type="simple"/></inline-formula>, while a negative value supports the absence of such an assembly, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e598" xlink:type="simple"/></inline-formula>. The BFs per sample and time period are computed by applying a pairwise state-space log-linear model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e599" xlink:type="simple"/></inline-formula>) independently to the three periods. We use a state model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e600" xlink:type="simple"/></inline-formula>. The lower panel shows the BF for the positive triple-wise spike interaction (Test 2), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e601" xlink:type="simple"/></inline-formula>, as opposed to a zero or negative triple-wise spike interaction, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e602" xlink:type="simple"/></inline-formula>, in each of the three periods. The BFs are computed from a full state-space log-linear model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e603" xlink:type="simple"/></inline-formula>). (D) Bar plot of the bin-by-bin BFs (Eq. 52) sorted by the different spike patterns in the three periods (from top to bottom). The contributions to the BFs (shown in C) from the different spike patterns are sorted and displayed using the indicated spike patterns (000, 100, 110 and 111) as representative examples. The gray bars indicate the average BFs of simultaneously positive pairwise interactions, with the average computed for the spike patterns observed in 200 realizations in the respective periods, while the dark gray bars indicate the average BFs for the triple-wise spike correlation.</p>
        </caption>
        <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.g008" xlink:type="simple"/>
      </fig>
      <p>Although we face a high-dimensional optimization problem in our settings, we are able to successfully obtain MAP estimates of the underlying parameters because of the simplicity of the formulation of the state-space model: The use of the log-concave exponential family distributions <xref ref-type="bibr" rid="pcbi.1002385-Amari4">[50]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Paninski1">[90]</xref> in both the state and observation models guarantees that the MAP estimates can be obtained using a convex optimization program. At each bin, the method numerically solves a nonlinear filter equation to obtain the mode of the posterior state density (the MAP estimates, see Eqs. 28, 29, and 30 in <xref ref-type="sec" rid="s4">Methods</xref>). With only a few (3–8) Newton-Raphson iterations, the solution reaches a plateau (the increments of all the elements of the updated state space vector are smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e604" xlink:type="simple"/></inline-formula>). The entire optimization procedure can be performed in a reasonable amount of time: On a contemporary standard laptop computer it takes no longer than 30 seconds to obtain smooth estimates of a full log-linear model for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e605" xlink:type="simple"/></inline-formula> neurons (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e606" xlink:type="simple"/></inline-formula> bins, <xref ref-type="fig" rid="pcbi-1002385-g004">Figure 4</xref>), which includes 100 EM iterations. The method is even faster when approximating the posterior mode using the update formula Eq. 30 without any iterations, using the one-step prediction mean as an initial value. This fast approximation method suggested in <xref ref-type="bibr" rid="pcbi.1002385-Eden1">[69]</xref> could even be utilized in a real-time, on-line application of our filter (the filtering method applied to a single trial, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e607" xlink:type="simple"/></inline-formula>, using predetermined hyper-parameters) at the cost of estimation accuracy.</p>
      <p>The pairwise analysis can be applied up to about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e608" xlink:type="simple"/></inline-formula> neurons simultaneously to derive time-dependent pair interactions. However, the current version of the algorithm does not scale to a larger number of neurons because the number of spike patterns that need to be considered suffers from a combinatorial explosion. The major difficulty arises from the coordinate transformation from the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e609" xlink:type="simple"/></inline-formula>-coordinates to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e610" xlink:type="simple"/></inline-formula>-coordinates that appear in the non-linear filter equation (Eq. 31 in <xref ref-type="sec" rid="s4">Methods</xref>). The coordinate transformation is required in this equation to calculate the innovation signal, i.e., the difference between the observed synchrony rates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e611" xlink:type="simple"/></inline-formula>, and the expected synchrony rates (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e612" xlink:type="simple"/></inline-formula>-coordinates) based on the model. We numerically derived the exact <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e613" xlink:type="simple"/></inline-formula>-coordinates by marginalizing the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e614" xlink:type="simple"/></inline-formula> dimensional joint probability mass function computed from the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e615" xlink:type="simple"/></inline-formula>-coordinates. Thereby, a full knowledge of the probability mass function is required even if the model considers only the lower-order interactions. Because this is a common problem in the learning of artificial neural networks <xref ref-type="bibr" rid="pcbi.1002385-Ackley1">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari2">[47]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari7">[91]</xref>, sampling algorithms such as the Markov chain Monte Carlo method have been developed to approximate the expectation parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e616" xlink:type="simple"/></inline-formula>, without having to compute the partition function <xref ref-type="bibr" rid="pcbi.1002385-Murray1">[92]</xref>. The inclusion of such methods allows us to analyze the time-varying low order spike interactions from a larger number of parallel spike sequences. Recent progress <xref ref-type="bibr" rid="pcbi.1002385-Schaub1">[93]</xref>, e.g., in the mean field approach and/or the minimum probability flow learning algorithm for an Ising model, may allow us to further increase the number of neurons that can be treated in this nonstationary pairwise analysis. Nonetheless, the method presented here, which aims at a detailed analysis of the dynamics in higher-order spike interactions, may not easily scale to massively parallel spike sequences that can be analyzed by other methods such as those based on the statistics pooled across neurons. Thus, we consider it to be important to combine the detailed analysis method proposed in this study with other state-of-the-art analysis techniques in practical applications. For example, test methods based on population measures such as the Unitary Event method and cumulant-based inference method <xref ref-type="bibr" rid="pcbi.1002385-Staude1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Staude2">[35]</xref> allow us to detect the existence of statistically dependent neurons in massively parallel spike sequences. If the null-hypothesis of independence among those neurons is not rejected in these methods, we can exclude those neurons from any further detailed analysis of their dynamics using the methods proposed in this study.</p>
      <p>Several critical assumptions made in the current framework need to be addressed. First, it was assumed in constructing the likelihood (Eq. 7) that no spike history effect exists in the generation of a population spike pattern. Second, we assumed the use of identically and independently distributed samples across trials when constructing the likelihood (Eq. 7). The first assumption may appear to be strong constraint given the fact that individual neurons exhibit non-Poisson spiking activities <xref ref-type="bibr" rid="pcbi.1002385-Shinomoto1">[94]</xref>. However, as in the case of the estimation of the firing rate of a single neuron, the pooled spike train across the (independent) trials is assumed to obey a Poisson point process because of the general limit theorem for point processes <xref ref-type="bibr" rid="pcbi.1002385-Shimazaki1">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Shimazaki2">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Daley1">[95]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Kass3">[96]</xref>. This is because most of the spikes in the pooled data come from independent different trials. They are thus nearly statistically independent from each other, even if the individual processes are non-Poisson. Similarly, in our analysis, we used statistics from a pooled binary spike train, assuming independence across trials: The occurrences of joint spikes in the binary data pooled across trials are mostly independent of each other across bins. Because these joint spike occurrences are sparse (i.e., they rarely happen closely to each other in the same trial), it is even more feasible to assume their statistical independence across bins. Third, however, while pooling independent and identical trials (the second assumption) may validate the first assumption of the independence of the samples across bins, that assumption of independently and identically distributed samples across trials has itself been challenged <xref ref-type="bibr" rid="pcbi.1002385-Brody1">[97]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Czanner1">[98]</xref> and is known to be violated in some cases, e.g., by drifting attention, ongoing brain activity, adaptation, etc. It is possible that the trial-by-trial jitter/variation in the spike data causes spurious higher-order spike correlation. Thus, as discussed in the section on the application of our methods to real neuronal data, it is important to examine the stationarity of the spike train data across trials. Note that, not only the firing rates, but also the spike synchrony can be shaped on a longer time scale by repeatedly practicing a task <xref ref-type="bibr" rid="pcbi.1002385-Kilavik1">[19]</xref>. In fact, the current analysis method can be used to examine the long-term evolution of pairwise and higher-order spike interactions across trial sessions by replacing the role of a bin with a trial, assuming within-trial stationarity. It will be a challenge to construct a state-space log-linear model that additionally applies a smoothing method across trials (see <xref ref-type="bibr" rid="pcbi.1002385-Czanner1">[98]</xref> for such a method for a point process model).</p>
      <p>The present method is left with one free parameter, namely the bin-width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e617" xlink:type="simple"/></inline-formula>. The bin-width determines the permissible temporal precision of synchronous spike events. Very large bin-widths result in binary data that are highly synchronized across sequences, while very small bin-widths result in asynchronous multiple spike sequences. In the latter case, we might overlook the existing dependency between multiple neural spike sequences due to disjunct binning <xref ref-type="bibr" rid="pcbi.1002385-Grn5">[99]</xref> (but see <xref ref-type="bibr" rid="pcbi.1002385-Tang1">[57]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Marre1">[100]</xref> that aim to overcome such a problem by modeling the spike interactions across different consecutive time bins). Within our proposed modeling framework, which focuses on instantaneous higher-order spike correlations, it is important to catch the innate temporal precision of the neuronal population under investigation using the appropriate bin-width. Thus, the choice may be guided by the biophysical properties of the neurons. However, it may be of advantage to derive the bin-width in a data-driven manner. For example, in the context of an encoding problem, the proper bin-width can be chosen based on the goodness-of-fit test for single neuron spiking activities <xref ref-type="bibr" rid="pcbi.1002385-Brown3">[101]</xref>, conditional on the spiking activities of the other neurons <xref ref-type="bibr" rid="pcbi.1002385-Pillow1">[40]</xref>. For questions about the relation of coincident spiking to stimulus/behavior, the bin-width may be selected based, for example, on the predictive ability of an external signal. For this goal, it is important to search the optimal bin-width using elaborate methods such as those developed in the context of the Unitary Event analysis method <xref ref-type="bibr" rid="pcbi.1002385-Grn5">[99]</xref> (see <xref ref-type="bibr" rid="pcbi.1002385-Grn1">[25]</xref> for a review of related methods).</p>
      <p>A substantial number of studies have demonstrated that stimulus and behavioral signals can be decoded simply based on the firing rates of individual neurons. At the same time, it has been discussed whether spike correlations, particularly higher-order spike correlations, are necessary to characterize neuronal population spiking activities <xref ref-type="bibr" rid="pcbi.1002385-Roudi1">[54]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Santos1">[58]</xref> or to encode or decode information related to stimuli <xref ref-type="bibr" rid="pcbi.1002385-Montani1">[53]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Ohiorhenuan1">[60]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Oizumi1">[102]</xref>. At this point in time, a smaller number of dedicated experiments have supported the conceptual framework of information processing using neuronal assemblies formed by neurons momentarily engaged in coordinated activities, as expressed by temporally precise spike correlations (see <xref ref-type="bibr" rid="pcbi.1002385-Gerstein1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Fujii1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Sakurai1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Harris1">[10]</xref> for reviews of these experiments). Nevertheless, it is possible that the current perspective on this subject has been partly formed by a lack of proper analysis approaches for simultaneously tracing time-varying individual pairwise spike interactions, and/or their higher-order interactions. Indeed, we demonstrated by the time-resolved higher-order analysis that three cortical neurons coordinated their spiking activities in accordance with behaviorally relevant points in time. Thus our suggested analysis methods are expected to be useful to reveal the dynamics of assembly activities and their neuronal composition, as well as for testing their behavioral relevance. We hope that these methods help shed more light on the cooperative mechanisms of neurons underlying information processing.</p>
    </sec>
    <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <sec id="s4a">
        <title>Mathematical properties of log-linear model</title>
        <p>In this subsection, we review the known mathematical properties of a log-linear model for binary random variables. These properties are used in constructing recursive filtering/smoothing formulas in the next section. Using the multi-index, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e618" xlink:type="simple"/></inline-formula> (see the <xref ref-type="sec" rid="s2">Results</xref> subsection ‘Log-linear model of multiple neural spike sequences’), the probability mass function (Eq. 1), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e619" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e620" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e621" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e622" xlink:type="simple"/></inline-formula>), and the expectation parameters (Eq. 2) are compactly written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e623" xlink:type="simple"/><label>(14)</label></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e624" xlink:type="simple"/><label>(15)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e625" xlink:type="simple"/></inline-formula> is a feature function, here representing an interaction among the neurons indicated by the multi-index, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e626" xlink:type="simple"/></inline-formula> (Eq. 3).</p>
        <p>The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e627" xlink:type="simple"/></inline-formula>- and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e628" xlink:type="simple"/></inline-formula>-coordinates are dually flat coordinates in the exponential family probability space <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari4">[50]</xref>, and the coordinate transformation from one to the other is given by the Legendre transformation <xref ref-type="bibr" rid="pcbi.1002385-Pillow1">[40]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari4">[50]</xref>. From Eq. 14, the log normalization function, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e629" xlink:type="simple"/></inline-formula>, is written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e630" xlink:type="simple"/><label>(16)</label></disp-formula>The first derivative of the log normalization function, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e631" xlink:type="simple"/></inline-formula>, with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e632" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e633" xlink:type="simple"/></inline-formula>), provides the expectation parameter, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e634" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e635" xlink:type="simple"/><label>(17)</label></disp-formula>Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e636" xlink:type="simple"/></inline-formula> be the negative entropy of the distribution:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e637" xlink:type="simple"/><label>(18)</label></disp-formula>Eqs. 17 and 18 complete the Legendre transformation from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e638" xlink:type="simple"/></inline-formula>-coordinates to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e639" xlink:type="simple"/></inline-formula>-coordinates <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari4">[50]</xref>. The Legendre transformation transfers the functional relationship of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e640" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e641" xlink:type="simple"/></inline-formula> to the equivalent relation in the dual coordinates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e642" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e643" xlink:type="simple"/></inline-formula>. The inverse transformation is given by Eq. 18 and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e644" xlink:type="simple"/></inline-formula>.</p>
        <p>Using the log normalization function, we can obtain the multivariate cumulants of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e645" xlink:type="simple"/></inline-formula> with respect to the random variables, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e646" xlink:type="simple"/></inline-formula>. The cumulant generating function of the exponential family distribution is given as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e647" xlink:type="simple"/></inline-formula>. Let us compactly write the partial derivative with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e648" xlink:type="simple"/></inline-formula> (i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e649" xlink:type="simple"/></inline-formula>) as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e650" xlink:type="simple"/></inline-formula>. Then, the first order cumulant is given as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e651" xlink:type="simple"/></inline-formula>, as shown in Eq. 17. In general, the cumulants of the exponential family distribution are given by the derivatives of the log normalization function. Thus, the second derivative of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e652" xlink:type="simple"/></inline-formula> yields the second-order cumulant, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e653" xlink:type="simple"/></inline-formula> (by the cup, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e654" xlink:type="simple"/></inline-formula>, we mean the multi-index representation of an union of the elements of the two multi-indices, e.g., if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e655" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e656" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e657" xlink:type="simple"/></inline-formula>):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e658" xlink:type="simple"/><label>(19)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e659" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e660" xlink:type="simple"/></inline-formula> is known as the Fisher metric with respect to the natural parameters. Eqs. 17 and 19 are important relations used in this study to construct a non-linear filtering equation for a dynamic estimate of the natural parameters because we approximate the log-linear model (Eq. 14) with a precision of up to a (log) quadratic function (cf. Eqs. 28 and 29). Similarly, the higher-order derivatives yield higher-order multivariate cumulants. For example, the third-order derivative yields the third order cumulant, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e661" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e662" xlink:type="simple"/></inline-formula>.</p>
        <p>The pseudo distance between two different distributions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e663" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e664" xlink:type="simple"/></inline-formula> is defined using the Kullback-Leibler (KL) divergence<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e665" xlink:type="simple"/><label>(20)</label></disp-formula>We represent distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e666" xlink:type="simple"/></inline-formula> by using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e667" xlink:type="simple"/></inline-formula>-coordinates as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e668" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e669" xlink:type="simple"/></inline-formula> by using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e670" xlink:type="simple"/></inline-formula>-coordinates as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e671" xlink:type="simple"/></inline-formula>. Here, we used <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e672" xlink:type="simple"/></inline-formula> for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e673" xlink:type="simple"/></inline-formula>-parameters of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e674" xlink:type="simple"/></inline-formula> (and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e675" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e676" xlink:type="simple"/></inline-formula>-parameters of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e677" xlink:type="simple"/></inline-formula>) in order to differentiate it from the representation of distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e678" xlink:type="simple"/></inline-formula> in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e679" xlink:type="simple"/></inline-formula>-coordinates (and the representation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e680" xlink:type="simple"/></inline-formula> in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e681" xlink:type="simple"/></inline-formula>-coordinates). Then, the KL-divergence between the two distributions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e682" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e683" xlink:type="simple"/></inline-formula>, is computed as <xref ref-type="bibr" rid="pcbi.1002385-Amari1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari4">[50]</xref><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e684" xlink:type="simple"/><label>(21)</label></disp-formula></p>
      </sec>
      <sec id="s4b">
        <title>Optimized estimation of dynamic spike interactions</title>
        <p>We develop a non-linear recursive Bayesian filtering/smoothing algorithm and its optimization method in order to trace dynamically changing spike interactions from parallel spike sequences. To reach this goal, we use the expectation-maximization (EM) algorithm <xref ref-type="bibr" rid="pcbi.1002385-Smith1">[68]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Akaike1">[73]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Shumway1">[103]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Smith2">[104]</xref>, which is known to efficiently combine the construction of the posterior density of a state (the natural parameters) and the optimization of the hyper-parameters. This method maximizes the lower bound of the log marginal likelihood, Eq. 10. Using Jensen's inequality and nominal hyper-parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e685" xlink:type="simple"/></inline-formula>, the lower bound of the log marginal likelihood with hyper-parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e686" xlink:type="simple"/></inline-formula> is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e687" xlink:type="simple"/><label>(22)</label></disp-formula>Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e688" xlink:type="simple"/></inline-formula> represents a negative entropy. The maximization of the lower bound with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e689" xlink:type="simple"/></inline-formula> is equivalent to maximizing the expected complete data log-likelihood in Eq. 22, known as the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e690" xlink:type="simple"/></inline-formula>-function:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e691" xlink:type="simple"/><label>(23)</label></disp-formula>The expectation in the above equation is read as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e692" xlink:type="simple"/></inline-formula>. We maximize the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e693" xlink:type="simple"/></inline-formula>-function by alternating the expectation (E) and maximization (M) steps. In the E-step, we obtain the expected values with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e694" xlink:type="simple"/></inline-formula> in Eq. 23 using a fixed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e695" xlink:type="simple"/></inline-formula>. In the M-step, we obtain the hyper-parameter, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e696" xlink:type="simple"/></inline-formula>, that maximizes Eq. 23. The resulting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e697" xlink:type="simple"/></inline-formula> is then used in the next E-step. The details of each step are now given as follows.</p>
        <sec id="s4b1">
          <title>E-step: Bayesian recursive filter/smoother</title>
          <p>The E-step is composed of filtering and smoothing algorithms conducted by forward and backward recursions, respectively. The forward algorithm sequentially constructs a posterior density of the state at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e698" xlink:type="simple"/></inline-formula> given the spike data up to and including time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e699" xlink:type="simple"/></inline-formula>, whereas the backward algorithm constructs a posterior density at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e700" xlink:type="simple"/></inline-formula> given the entire data. The posterior density allows us to compute the maximum a posteriori (MAP) estimate or Bayes estimator and provides uncertainty for the estimate. In the following, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e701" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e702" xlink:type="simple"/></inline-formula> denote the conditional mean, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e703" xlink:type="simple"/></inline-formula>, and covariance, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e704" xlink:type="simple"/></inline-formula>. The filter mean and covariance are denoted as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e705" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e706" xlink:type="simple"/></inline-formula>, respectively. The mean and covariance of a smooth posterior density are denoted as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e707" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e708" xlink:type="simple"/></inline-formula>, respectively.</p>
          <p>We first compute the one-step prediction density, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e709" xlink:type="simple"/></inline-formula>. This is the conditional density of the state at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e710" xlink:type="simple"/></inline-formula> given the observation of parallel spike sequences up to time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e711" xlink:type="simple"/></inline-formula>. The one-step prediction density is written using the Chapman-Kolmogorov equation as <xref ref-type="bibr" rid="pcbi.1002385-Brown2">[37]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Eden1">[69]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Kitagawa1">[105]</xref><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e712" xlink:type="simple"/><label>(24)</label></disp-formula>Here the transition probability, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e713" xlink:type="simple"/></inline-formula>, is a multivariate normal distribution with mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e714" xlink:type="simple"/></inline-formula> and covariance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e715" xlink:type="simple"/></inline-formula>, as defined in the state equation, Eq. 8. For an initial prior, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e716" xlink:type="simple"/></inline-formula>, we use a normal distribution with mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e717" xlink:type="simple"/></inline-formula> and covariance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e718" xlink:type="simple"/></inline-formula>. The other distribution, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e719" xlink:type="simple"/></inline-formula>, in Eq. 24 is the filter density at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e720" xlink:type="simple"/></inline-formula>. In the next paragraph, the filter density will be obtained by approximating it with a normal distribution whose mean and covariance are denoted as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e721" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e722" xlink:type="simple"/></inline-formula>. Under this condition, the one-step prediction density (Eq. 24) again becomes a normal distribution whose mean, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e723" xlink:type="simple"/></inline-formula>, and covariance, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e724" xlink:type="simple"/></inline-formula>, are given as <xref ref-type="bibr" rid="pcbi.1002385-Brown2">[37]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Smith1">[68]</xref><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e725" xlink:type="simple"/><label>(25)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e726" xlink:type="simple"/><label>(26)</label></disp-formula></p>
          <p>The filter density, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e727" xlink:type="simple"/></inline-formula>, is the conditional distribution of the state given the observation of parallel spike sequences up to time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e728" xlink:type="simple"/></inline-formula>. Using the likelihood function and one-step prediction density, the filter density is given by Bayes' theorem as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e729" xlink:type="simple"/><label>(27)</label></disp-formula>This posterior density is a complicated function with respect to the natural parameter, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e730" xlink:type="simple"/></inline-formula>. Here, we apply a Gaussian approximation to the posterior density using the Laplace method <xref ref-type="bibr" rid="pcbi.1002385-Brown2">[37]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Smith2">[104]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Fahrmeir1">[106]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Koyama1">[107]</xref>: The filter mean, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e731" xlink:type="simple"/></inline-formula>, is identified with a mode of the posterior density as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e732" xlink:type="simple"/></inline-formula>, and the filter covariance, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e733" xlink:type="simple"/></inline-formula>, is determined from the Hessian of the log posterior at the mode as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e734" xlink:type="simple"/></inline-formula>. The approximate posterior mode is obtained using the iterative procedure of a gradient ascent method or the Newton-Raphson method using the gradient and Hessian matrix. The gradient and Hessian of the log of the posterior density at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e735" xlink:type="simple"/></inline-formula> is calculated as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e736" xlink:type="simple"/><label>(28)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e737" xlink:type="simple"/><label>(29)</label></disp-formula>Note that, as in Eqs. 17 and 19, the first derivative of the log normalization function, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e738" xlink:type="simple"/></inline-formula>, with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e739" xlink:type="simple"/></inline-formula> provides the dual coordinates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e740" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e741" xlink:type="simple"/></inline-formula>. Furthermore, the second derivative yields the Fisher metric: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e742" xlink:type="simple"/></inline-formula>. In this study, we adopt the Newton-Raphson method:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e743" xlink:type="simple"/><label>(30)</label></disp-formula>The gradient and Hessian, Eqs.28 and 29, are evaluated using an old value, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e744" xlink:type="simple"/></inline-formula>. Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e745" xlink:type="simple"/></inline-formula> is a learning coefficient that was introduced in the context of ‘natural’ gradient search algorithm <xref ref-type="bibr" rid="pcbi.1002385-Amari7">[91]</xref>. For the small population size analyzed in this study, we used <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e746" xlink:type="simple"/></inline-formula>. However, it is recommended that a smaller positive value be selected for the analysis of a larger system to avoid numerical instability. Because both the likelihood function and prior density are logarithmically concave functions, the posterior is also log-concave. Thus, this optimization problem is convex, which guarantees a unique solution for the filter estimate <xref ref-type="bibr" rid="pcbi.1002385-Paninski1">[90]</xref>. The optimized natural parameter is selected as the filter mean, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e747" xlink:type="simple"/></inline-formula>. The filter covariance is approximated as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e748" xlink:type="simple"/></inline-formula> by using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e749" xlink:type="simple"/></inline-formula>. It is also possible to use a simple gradient ascent method to obtain the mode, and then compute the Hessian matrix at the mode.</p>
          <p>The above method is equivalent to solving the following nonlinear recursive filter formulas:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e750" xlink:type="simple"/><label>(31)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e751" xlink:type="simple"/><label>(32)</label></disp-formula>Eq. 31 was obtained from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e752" xlink:type="simple"/></inline-formula>. Eqs. 31 and 32 are recursively computed in combination with the one-step prediction equations, Eqs. 25 and 26, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e753" xlink:type="simple"/></inline-formula>. Because <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e754" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e755" xlink:type="simple"/></inline-formula> are dual representations of the same probability distribution, Eq. 31 is a nonlinear equation and needs to be solved as suggested above (Eqs. 28, 29, 30). As pointed out for a point process adaptive filter <xref ref-type="bibr" rid="pcbi.1002385-Brown2">[37]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Eden1">[69]</xref>, the residual, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e756" xlink:type="simple"/></inline-formula>, in Eq. 31 acts similarly to an innovation vector of a standard Kalman filter. The same error signal between the observed synchrony rates and expected synchrony rates is utilized in training the Boltzmann machine <xref ref-type="bibr" rid="pcbi.1002385-Ackley1">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari2">[47]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Amari7">[91]</xref>. The innovation term corrects the one-step prediction mean, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e757" xlink:type="simple"/></inline-formula>, i.e., an expected state by the prior distribution. The degree of the correction is determined by the number of repeated trials, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e758" xlink:type="simple"/></inline-formula>, and uncertainty of the predicted state, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e759" xlink:type="simple"/></inline-formula>. The hyper-parameters of the prior density significantly affect the latter gain (see Eq. 26), and thereby the smoothness of the estimated processes. The filter covariance equation, Eq. 32, describes the reduction of the prediction uncertainty, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e760" xlink:type="simple"/></inline-formula>, by observing the parallel spike sequences at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e761" xlink:type="simple"/></inline-formula>, with the amount determined by the number of repeated trials, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e762" xlink:type="simple"/></inline-formula>, and the Fisher information, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e763" xlink:type="simple"/></inline-formula>. Please see <xref ref-type="fig" rid="pcbi-1002385-g001">Figure 1</xref> for a geometric view of the recursive Bayesian filter.</p>
          <p>Finally, we compute the smooth posterior density using the backward recursive algorithm <xref ref-type="bibr" rid="pcbi.1002385-Smith1">[68]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Kitagawa1">[105]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Koyama1">[107]</xref>,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e764" xlink:type="simple"/><label>(33)</label></disp-formula>Because the density functions in the recursive formula were approximated as a normal distribution, we follow the fixed-interval smoothing algorithm <xref ref-type="bibr" rid="pcbi.1002385-Brown2">[37]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Smith1">[68]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Kitagawa1">[105]</xref> established for a Gaussian state and observation equation. Starting from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e765" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e766" xlink:type="simple"/></inline-formula>, which are obtained from the filtering algorithm, we obtain the smoothed mean and covariance,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e767" xlink:type="simple"/><label>(34)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e768" xlink:type="simple"/><label>(35)</label></disp-formula>with<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e769" xlink:type="simple"/><label>(36)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e770" xlink:type="simple"/></inline-formula>. The lag-one covariance smoother, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e771" xlink:type="simple"/></inline-formula>, which appears in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e772" xlink:type="simple"/></inline-formula>-function, is obtained using the method of De Jong and Mackinnon <xref ref-type="bibr" rid="pcbi.1002385-DeJong1">[108]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e773" xlink:type="simple"/><label>(37)</label></disp-formula></p>
        </sec>
        <sec id="s4b2">
          <title>M-step: Optimization of hyper-parameters</title>
          <p>At the M-step, we optimize hyper-parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e774" xlink:type="simple"/></inline-formula> given the posterior density under the principle of maximizing the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e775" xlink:type="simple"/></inline-formula>-function. From <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e776" xlink:type="simple"/></inline-formula>, the update rule of the covariance matrix, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e777" xlink:type="simple"/></inline-formula>, is obtained as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e778" xlink:type="simple"/><label>(38)</label></disp-formula>Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e779" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e780" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e781" xlink:type="simple"/></inline-formula> are the smoother mean and covariance, and the lag-one covariance matrix given by Eqs. 34, 35, and 37, respectively. Similarly, from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e782" xlink:type="simple"/></inline-formula>, the auto-regressive parameter, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e783" xlink:type="simple"/></inline-formula>, is updated according to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e784" xlink:type="simple"/><label>(39)</label></disp-formula>The mean of the initial distribution is updated with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e785" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e786" xlink:type="simple"/></inline-formula>. The covariance matrix, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e787" xlink:type="simple"/></inline-formula>, is not updated; instead, we use a fixed matrix, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e788" xlink:type="simple"/></inline-formula>. Alternatively, the covariance matrix of the initial distribution can be updated according to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e789" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e790" xlink:type="simple"/></inline-formula>, while the mean, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e791" xlink:type="simple"/></inline-formula>, is fixed. Both methods work well with appropriate choices for the fixed parameters. In this study, we updated the mean vector, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e792" xlink:type="simple"/></inline-formula>, of the initial normal distribution, and used a fixed diagonal matrix for its covariance matrix, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e793" xlink:type="simple"/></inline-formula>. It was also suggested to use a stationary mean and covariance of an unconstrained state process (Eq. 8) as parameters of the initial prior distribution <xref ref-type="bibr" rid="pcbi.1002385-Smith1">[68]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Harvey1">[109]</xref>. The equilibrium condition from Eq. 8 yields <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e794" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e795" xlink:type="simple"/></inline-formula>. The solutions are obtained as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e796" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e797" xlink:type="simple"/></inline-formula> (p. 121 and p. 426 in <xref ref-type="bibr" rid="pcbi.1002385-Harvey1">[109]</xref>, p. 112 in <xref ref-type="bibr" rid="pcbi.1002385-Durbin1">[110]</xref>). In the latter, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e798" xlink:type="simple"/></inline-formula> denotes the Kronecker product (tensor product) and the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e799" xlink:type="simple"/></inline-formula> operator creates a single column vector from a matrix by stacking its column vectors. However, the stationary condition is not always satisfied. As we found that the fitted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e800" xlink:type="simple"/></inline-formula> sometimes violates the stationary assumption, we did not adopt this approach in the current study.</p>
        </sec>
      </sec>
      <sec id="s4c">
        <title>Selection of state-space model by information criteria</title>
        <p>The method developed in the previous subsection is applicable to a full log-linear model, as well as a model that considers an arbitrary order of interactions. In order to select the most predictive model among the hierarchical models in accordance with the observed spike data, we select the state-space model that minimizes the Akaike information criterion (AIC) for a model with latent variables <xref ref-type="bibr" rid="pcbi.1002385-Akaike1">[73]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Kitagawa1">[105]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e801" xlink:type="simple"/><label>(40)</label></disp-formula>Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e802" xlink:type="simple"/></inline-formula> is the log marginal likelihood (Eq. 10) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e803" xlink:type="simple"/></inline-formula> is the number of free hyper-parameters in the prior distribution. For the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e804" xlink:type="simple"/></inline-formula>th order model, the number of natural parameters is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e805" xlink:type="simple"/></inline-formula>. The number of free parameters in the prior distribution is computed as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e806" xlink:type="simple"/></inline-formula>, where each term corresponds to the number of free parameters in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e807" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e808" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e809" xlink:type="simple"/></inline-formula>. Note that the AIC applied to the state-space model is sometimes referred to as the Akaike Bayesian information criterion (ABIC) <xref ref-type="bibr" rid="pcbi.1002385-Akaike1">[73]</xref>. In the following, we derive the approximation method to evaluate the AIC for the state-space log-linear model.</p>
        <p>The log marginal likelihood, Eq. 10, can be written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e810" xlink:type="simple"/><label>(41)</label></disp-formula>We make a log quadratic approximation to evaluate the integral. To accomplish this, we denote<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e811" xlink:type="simple"/><label>(42)</label></disp-formula>with<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e812" xlink:type="simple"/><label>(43)</label></disp-formula>The Laplace approximation of the integral in Eq. 42 is given as <xref ref-type="bibr" rid="pcbi.1002385-Rissanen1">[80]</xref><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e813" xlink:type="simple"/><label>(44)</label></disp-formula>By applying Eqs. 42, 43 and 44 to Eq. 41, the log marginal likelihood is approximated as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e814" xlink:type="simple"/><label>(45)</label></disp-formula>We confirmed that the log-quadratic approximation provided a better estimate of the marginal likelihood than the first order approximation used in <xref ref-type="bibr" rid="pcbi.1002385-Shimazaki3">[77]</xref> by comparing them with a Monte Carlo approximation of the integral in Eq. 42. We select the state-space log-linear model that minimizes the AIC (Eq. 40), where the log marginal likelihood is approximated using Eq. 45.</p>
        <p>For comparison with the AIC, we compute two other information criteria that employ different forms of the penalization term. The Bayesian information criterion <xref ref-type="bibr" rid="pcbi.1002385-Schwarz1">[79]</xref>, <xref ref-type="bibr" rid="pcbi.1002385-Rissanen1">[80]</xref> (also known as Schwartz's criterion) are obtained by replacing the penalization term of Eq. 40, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e815" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e816" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e817" xlink:type="simple"/><label>(46)</label></disp-formula>Shimodaira's predictive divergence for indirect observation models (PDIO) <xref ref-type="bibr" rid="pcbi.1002385-Shimodaira1">[81]</xref> is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e818" xlink:type="simple"/><label>(47)</label></disp-formula>Here, we redefine <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e819" xlink:type="simple"/></inline-formula> as a one-dimensional vector of free hyper-parameters, while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e820" xlink:type="simple"/></inline-formula> denotes the one-step operator of EM iteration. To obtain the Jacobian matrix for the EM operator, we follow the algorithm described in Meng and Rubin <xref ref-type="bibr" rid="pcbi.1002385-Meng1">[111]</xref>. In this method, the Jacobian matrix was approximated using a numerical differentiation of the EM operator. By perturbing one hyper-parameter and then computing a one-step EM iteration, numerical differentiations of the hyper-parameters with respect to the perturbed hyper-parameter were obtained. An entire Jacobian matrix was approximated by repeating the process while changing the hyper-parameter to be perturbed.</p>
      </sec>
      <sec id="s4d">
        <title>Bayesian model comparison method for detecting spike correlation</title>
        <p>In this subsection, we formulate a method for detecting the hidden structure of spike interaction by means of a Bayesian model comparison based on the Bayes factor (BF) <xref ref-type="bibr" rid="pcbi.1002385-Jeffreys1">[74]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Kass2">[76]</xref>. The BF is a ratio of likelihoods for the observed data, based on two different assumptions about the hidden states (model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e821" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e822" xlink:type="simple"/></inline-formula>). Here we reiterate the definition of the BF for model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e823" xlink:type="simple"/></inline-formula> as opposed to model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e824" xlink:type="simple"/></inline-formula> used in this paper (cf. Eq. 12):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e825" xlink:type="simple"/><label>(48)</label></disp-formula>The BF becomes larger than 1 if the data, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e826" xlink:type="simple"/></inline-formula> in a time period <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e827" xlink:type="simple"/></inline-formula>, supports model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e828" xlink:type="simple"/></inline-formula> as opposed to model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e829" xlink:type="simple"/></inline-formula>, and becomes smaller than 1 if the data supports model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e830" xlink:type="simple"/></inline-formula> as opposed to model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e831" xlink:type="simple"/></inline-formula>. The BF can be computed from the one-step prediction and filter density obtained in the method developed in the preceding subsection. From Eq. 48, the BF can be rewritten as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e832" xlink:type="simple"/><label>(49)</label></disp-formula>Let us define the bin-by-bin BF for the spike data at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e833" xlink:type="simple"/></inline-formula> as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e834" xlink:type="simple"/><label>(50)</label></disp-formula>Using Bayes' theorem, we obtain <xref ref-type="bibr" rid="pcbi.1002385-Jeffreys1">[74]</xref>–<xref ref-type="bibr" rid="pcbi.1002385-Kass2">[76]</xref><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e835" xlink:type="simple"/><label>(51)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e836" xlink:type="simple"/></inline-formula>. Using Eq. 51, we can rewrite the bin-by-bin BF as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e837" xlink:type="simple"/><label>(52)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e838" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e839" xlink:type="simple"/></inline-formula> denote spaces that the natural parameters occupy, supported by models <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e840" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e841" xlink:type="simple"/></inline-formula>, respectively. Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e842" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e843" xlink:type="simple"/></inline-formula> are the filter density and one-step prediction density, respectively. By sequentially computing Eq. 52, we can obtain the BF with respect to the sub-interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e844" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e845" xlink:type="simple"/></inline-formula>.</p>
        <p>A test with the following models in the sub-interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e846" xlink:type="simple"/></inline-formula> allows us to detect a momentarily active cell assembly of more than two neurons by the presence of simultaneously positive <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e847" xlink:type="simple"/></inline-formula>th-order spike interactions. In the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e848" xlink:type="simple"/></inline-formula>th-order log-linear model of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e849" xlink:type="simple"/></inline-formula> neurons, the natural parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e850" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e851" xlink:type="simple"/></inline-formula>), represent the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e852" xlink:type="simple"/></inline-formula> th-order spike interactions among neurons denoted in index <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e853" xlink:type="simple"/></inline-formula>. We examine whether a subset of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e854" xlink:type="simple"/></inline-formula> neurons among the total <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e855" xlink:type="simple"/></inline-formula> neurons simultaneously exhibit positive <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e856" xlink:type="simple"/></inline-formula> th-order interactions. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e857" xlink:type="simple"/></inline-formula> be the subset of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e858" xlink:type="simple"/></inline-formula> neurons from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e859" xlink:type="simple"/></inline-formula> neurons, e.g., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e860" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e861" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e862" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e863" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e864" xlink:type="simple"/></inline-formula> be an <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e865" xlink:type="simple"/></inline-formula>-subset from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e866" xlink:type="simple"/></inline-formula>, e.g. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e867" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e868" xlink:type="simple"/></inline-formula>. Then, the model where the subset neurons simultaneously exhibit positive <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e869" xlink:type="simple"/></inline-formula>th-order interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e870" xlink:type="simple"/></inline-formula>) and its complementary hypothesis (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e871" xlink:type="simple"/></inline-formula>) are represented as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e872" xlink:type="simple"/><label>(53)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e873" xlink:type="simple"/><label>(54)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e874" xlink:type="simple"/></inline-formula>. The remaining parameters are real: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e875" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e876" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e877" xlink:type="simple"/></inline-formula>. excluding <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e878" xlink:type="simple"/></inline-formula>). These parameters are integrated out in Eq. 52. The above definition of the assembly is a clique <xref ref-type="bibr" rid="pcbi.1002385-Berger1">[12]</xref>, a subset in which each neuron is connected to every other neuron through the positive <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e879" xlink:type="simple"/></inline-formula>th-order interactions. Depending on the assembly structure one wishes to uncover, other models can be tested such as one in which neurons bounded in non-exclusive manner.</p>
        <sec id="s4d1">
          <title>Analysis of Bayesian model comparison method using simulated stationary spike sequences</title>
          <p>In this subsection, we analyze the Bayesian model comparison method by using simulated stationary spike sequences. <xref ref-type="fig" rid="pcbi-1002385-g008">Figure 8</xref> illustrates an analysis where the BF is applied to stationary spike sequences of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e880" xlink:type="simple"/></inline-formula> simulated neurons. To demonstrate the kind of correlation scenarios that is distinguished by the BF, we generate stationary spike sequences using log-linear models of different spike correlation structures in three distinct time periods (I–III, <xref ref-type="fig" rid="pcbi-1002385-g008">Figure 8A</xref>). These are: (I) an independent model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e881" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e882" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e883" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e884" xlink:type="simple"/></inline-formula> at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e885" xlink:type="simple"/></inline-formula>), (II) a model containing simultaneously positive pairwise interaction terms, without a triple-wise interaction (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e886" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e887" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e888" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e889" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e890" xlink:type="simple"/></inline-formula> at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e891" xlink:type="simple"/></inline-formula>), and (III) a model containing a positive triple-wise interaction, with negative pairwise interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e892" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e893" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e894" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e895" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e896" xlink:type="simple"/></inline-formula> at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e897" xlink:type="simple"/></inline-formula>). A sample of the spike sequences from a single trial (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e898" xlink:type="simple"/></inline-formula>) is shown in <xref ref-type="fig" rid="pcbi-1002385-g008">Figure 8B</xref>. In all of the models, the first order log-linear parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e899" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e900" xlink:type="simple"/></inline-formula>), are adjusted such that the spike rates of the individual neurons are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e901" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e902" xlink:type="simple"/></inline-formula>). Therefore, the time segments cannot be distinguished on the basis of the firing rates. In addition, the model in period III is designed such that the projection to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e903" xlink:type="simple"/></inline-formula> yields zero pairwise interactions, i.e., the projection yields an independent model. In this model, the second-order joint synchrony rates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e904" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e905" xlink:type="simple"/></inline-formula>), are at the chance level expected from the individual spike rates, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e906" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e907" xlink:type="simple"/></inline-formula>). However, the model expresses excess joint spike synchrony between all three neurons, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e908" xlink:type="simple"/></inline-formula>, which is larger than the expected rate (0.001). The presence of a positive triple-wise correlation, combined with the absence of marginal pairwise correlations, leads to a very sparse number of excess synchronous spike triplets, as illustrated by the dot displays in period III in <xref ref-type="fig" rid="pcbi-1002385-g008">Figure 8B</xref>. In contrast, a period containing only positive pairwise correlations without a triple-wise interaction (see <xref ref-type="fig" rid="pcbi-1002385-g008">Figure 8B</xref>, period II) contains a relatively large number of triplets, which are, however, the mere expression of excess pairwise correlations.</p>
          <p>We calculate the BFs to test for the presence of the two different correlation structures, i.e., the same tests discussed in the <xref ref-type="sec" rid="s2">Results</xref> section: Test 1 checks for the presence of simultaneously positive pairwise interactions and Test 2 checks for the presence of a triple-wise spike correlation. In one test (Test 1) we ask whether the three neurons simultaneously exhibit positive pairwise interactions by applying a model that contains up to pairwise interactions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e909" xlink:type="simple"/></inline-formula>) to each of the three time periods. In that case, the BF (Eq. 48) is computed using a model which assumes that all of the pairwise terms are positive: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e910" xlink:type="simple"/></inline-formula>, specified as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e911" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e912" xlink:type="simple"/></inline-formula>, as opposed to a model where at least one of the pairwise interactions is not positive: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e913" xlink:type="simple"/></inline-formula>, specified as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e914" xlink:type="simple"/></inline-formula> for at least one <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e915" xlink:type="simple"/></inline-formula>. Time (bin) index, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e916" xlink:type="simple"/></inline-formula>, expresses that the BF is computed under the same models for all time steps <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e917" xlink:type="simple"/></inline-formula> in the respective time period. In both models, we do not make specific assumptions for the first order log-linear parameters; thus, they are allowed to be real numbers. In the other test (Test 2), we ask whether the neurons exhibit excess triple-wise synchrony by applying a full model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e918" xlink:type="simple"/></inline-formula>) to each of the periods. Here, the BF is computed with the opposing models: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e919" xlink:type="simple"/></inline-formula>, specified as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e920" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e921" xlink:type="simple"/></inline-formula>, specified as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e922" xlink:type="simple"/></inline-formula>. The lower-order log-linear parameters have again real values.</p>
          <p><xref ref-type="fig" rid="pcbi-1002385-g008">Figure 8C</xref> displays the average BFs (in units of bits) computed from 200 samples (each sample contains <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e923" xlink:type="simple"/></inline-formula> trial) within each of the periods I–III. In addition, we show the standard deviations of the BFs (shown as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e924" xlink:type="simple"/></inline-formula>) derived from the BFs of the 200 realizations. The upper panel shows the result of Test 1, expressing the weight of evidence for the presence of excess synchrony realized by simultaneously positive pairwise interactions. We find substantial evidence for the simultaneously positive pairwise interactions in period II, but not in the other two periods. The lower panel displays the evidence for the presence of a positive triple-wise correlation as evaluated by Test 2. The existing positive triple-wise interaction present in period III is well detected by the large BF, and the very low BFs in period I and II correctly detect the absence of triple-wise correlation.</p>
          <p>In <xref ref-type="fig" rid="pcbi-1002385-g008">Figure 8D</xref>, we examine how much each individual spike pattern contributes to the calculation of the BFs discussed above. The weight of evidence (log of the BF) in an observation period <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e925" xlink:type="simple"/></inline-formula> is obtained by summing the pieces of evidence computed locally at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e926" xlink:type="simple"/></inline-formula> using Eq. 52, as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e927" xlink:type="simple"/></inline-formula>. Here we elucidate the contributions of each individual spike pattern to the BF by sorting the bin-by-bin evidence, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e928" xlink:type="simple"/></inline-formula>, with each spike pattern. <xref ref-type="fig" rid="pcbi-1002385-g008">Figure 8D</xref> displays the average BFs for each spike pattern in the three periods in bit unit. The degree of the contribution by a specific spike pattern to the evidence for the tested spike interaction model varies depending on the context in which the spike pattern is observed. For example, the magnitudes of the BFs for a triple-wise correlation (Test 2) found by observing a spike triplet (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e929" xlink:type="simple"/></inline-formula>) vary greatly across the three periods (see dark gray bars at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e930" xlink:type="simple"/></inline-formula> in periods I, II, and III). In period III, where pair-synchronous spikes are rarely observed because of the existence of negative pairwise interaction terms, the observation of triplet spikes provides substantial evidence of a triple-wise correlation. In contrast, in period II, where pair-synchronous spikes frequently occur because of the existence of positive pairwise interactions, the chance triplet spikes do not provide substantial evidence of a triple-wise correlation. These results come from the fact that an unexpected synchronous spike pattern that significantly alters and updates the filter density from its one-step prediction density gives rise to a large absolute BF value (Eq. 52). By the same logic, the BFs for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e931" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e932" xlink:type="simple"/></inline-formula> patterns (and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e933" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e934" xlink:type="simple"/></inline-formula>, not shown) are small because they do not substantially change the posterior densities. However, they should not be neglected because these patterns are abundant as a result of the low firing rates. For example, in period I in <xref ref-type="fig" rid="pcbi-1002385-g008">Figure 8C</xref>, the accumulation of the small weight of evidence from the abundant spike patterns (such as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e935" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e936" xlink:type="simple"/></inline-formula>) offsets the large weight of evidence induced by a few chance coincidences such as triplet spikes (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002385.e937" xlink:type="simple"/></inline-formula>), thus producing virtually zero weight of evidence for this period.</p>
        </sec>
      </sec>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank B. Staude, S. Koyama, Z. Chen, D. Ba, K. Sadeghi, and T. Toyoizumi for the valuable discussions, and the Diesmann Laboratory for providing the computing environment. We also thank Prof. Alexa Riehle for kindly allowing the use of her data in this study.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002385-Hebb1">
        <label>1</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hebb</surname><given-names>DO</given-names></name></person-group>             <year>1949</year>             <source>The Organization of Behavior: A Neuropsychological Theory</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Wiley</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Abeles1">
        <label>2</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Abeles</surname><given-names>M</given-names></name></person-group>             <year>1991</year>             <source>Corticonics: Neural Circuits of the Cerebral Cortex</source>             <publisher-loc>Cambridge; New York</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Diesmann1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Diesmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Gewaltig</surname><given-names>M</given-names></name><name name-style="western"><surname>Aertsen</surname><given-names>A</given-names></name></person-group>             <year>1999</year>             <article-title>Stable propagation of synchronous spiking in cortical neural networks.</article-title>             <source>Nature</source>             <volume>402</volume>             <fpage>529</fpage>             <lpage>533</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Kumar1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kumar</surname><given-names>A</given-names></name><name name-style="western"><surname>Rotter</surname><given-names>S</given-names></name><name name-style="western"><surname>Aertsen</surname><given-names>A</given-names></name></person-group>             <year>2010</year>             <article-title>Spiking activity propagation in neuronal networks: reconciling different perspectives on neural coding.</article-title>             <source>Nat Rev Neurosci</source>             <volume>11</volume>             <fpage>615</fpage>             <lpage>627</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Kuhn1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kuhn</surname><given-names>A</given-names></name><name name-style="western"><surname>Aertsen</surname><given-names>A</given-names></name><name name-style="western"><surname>Rotter</surname><given-names>S</given-names></name></person-group>             <year>2003</year>             <article-title>Higher-order statistics of input ensembles and the response of simple model neurons.</article-title>             <source>Neural Comput</source>             <volume>15</volume>             <fpage>67</fpage>             <lpage>101</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Gerstein1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gerstein</surname><given-names>GL</given-names></name><name name-style="western"><surname>Bedenbaugh</surname><given-names>P</given-names></name><name name-style="western"><surname>Aertsen</surname><given-names>MH</given-names></name></person-group>             <year>1989</year>             <article-title>Neuronal assemblies.</article-title>             <source>IEEE Trans Biomed Eng</source>             <volume>36</volume>             <fpage>4</fpage>             <lpage>14</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Fujii1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fujii</surname><given-names>H</given-names></name><name name-style="western"><surname>Ito</surname><given-names>H</given-names></name><name name-style="western"><surname>Aihara</surname><given-names>K</given-names></name><name name-style="western"><surname>Ichinose</surname><given-names>N</given-names></name><name name-style="western"><surname>Tsukada</surname><given-names>M</given-names></name></person-group>             <year>1996</year>             <article-title>Dynamical cell assembly hypothesis - theoretical possibility of spatio-temporal coding in the cortex.</article-title>             <source>Neural Netw</source>             <volume>9</volume>             <fpage>1303</fpage>             <lpage>1350</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Riehle1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Riehle</surname><given-names>A</given-names></name><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name><name name-style="western"><surname>Diesmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Aertsen</surname><given-names>A</given-names></name></person-group>             <year>1997</year>             <article-title>Spike synchronization and rate modulation differentially involved in motor cortical function.</article-title>             <source>Science</source>             <volume>278</volume>             <fpage>1950</fpage>             <lpage>1953</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Sakurai1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sakurai</surname><given-names>Y</given-names></name></person-group>             <year>1996</year>             <article-title>Population coding by cell assemblies–what it really is in the brain.</article-title>             <source>Neurosci Res</source>             <volume>26</volume>             <fpage>1</fpage>             <lpage>16</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Harris1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Harris</surname><given-names>KD</given-names></name></person-group>             <year>2005</year>             <article-title>Neural signatures of cell assembly organization.</article-title>             <source>Nat Rev Neurosci</source>             <volume>6</volume>             <fpage>399</fpage>             <lpage>407</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Aertsen1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Aertsen</surname><given-names>AM</given-names></name><name name-style="western"><surname>Gerstein</surname><given-names>GL</given-names></name><name name-style="western"><surname>Habib</surname><given-names>MK</given-names></name><name name-style="western"><surname>Palm</surname><given-names>G</given-names></name></person-group>             <year>1989</year>             <article-title>Dynamics of neuronal firing correlation: modulation of “effective connectivity”.</article-title>             <source>J Neurophysiol</source>             <volume>61</volume>             <fpage>900</fpage>             <lpage>917</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Berger1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Berger</surname><given-names>D</given-names></name><name name-style="western"><surname>Warren</surname><given-names>D</given-names></name><name name-style="western"><surname>Normann</surname><given-names>R</given-names></name><name name-style="western"><surname>Arieli</surname><given-names>A</given-names></name><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name></person-group>             <year>2007</year>             <article-title>Spatially organized spike correlation in cat visual cortex.</article-title>             <source>Neurocomputing</source>             <volume>70</volume>             <fpage>2112</fpage>             <lpage>2116</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Maldonado1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Maldonado</surname><given-names>P</given-names></name><name name-style="western"><surname>Babul</surname><given-names>C</given-names></name><name name-style="western"><surname>Singer</surname><given-names>W</given-names></name><name name-style="western"><surname>Rodriguez</surname><given-names>E</given-names></name><name name-style="western"><surname>Berger</surname><given-names>D</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Synchronization of neuronal responses in primary visual cortex of monkeys viewing natural images.</article-title>             <source>J Neurophysiol</source>             <volume>100</volume>             <fpage>1523</fpage>             <lpage>1532</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Ito1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ito</surname><given-names>H</given-names></name><name name-style="western"><surname>Maldonado</surname><given-names>PE</given-names></name><name name-style="western"><surname>Gray</surname><given-names>CM</given-names></name></person-group>             <year>2010</year>             <article-title>Dynamics of stimulus-evoked spike timing correlations in the cat lateral geniculate nucleus.</article-title>             <source>J Neurophysiol</source>             <volume>104</volume>             <fpage>3276</fpage>             <lpage>3292</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Ahissar1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ahissar</surname><given-names>E</given-names></name><name name-style="western"><surname>Vaadia</surname><given-names>E</given-names></name><name name-style="western"><surname>Ahissar</surname><given-names>M</given-names></name><name name-style="western"><surname>Bergman</surname><given-names>H</given-names></name><name name-style="western"><surname>Arieli</surname><given-names>A</given-names></name><etal/></person-group>             <year>1992</year>             <article-title>Dependence of cortical plasticity on correlated activity of single neurons and on behavioral context.</article-title>             <source>Science</source>             <volume>257</volume>             <fpage>1412</fpage>             <lpage>1415</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Vaadia1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Vaadia</surname><given-names>E</given-names></name><name name-style="western"><surname>Haalman</surname><given-names>I</given-names></name><name name-style="western"><surname>Abeles</surname><given-names>M</given-names></name><name name-style="western"><surname>Bergman</surname><given-names>H</given-names></name><name name-style="western"><surname>Prut</surname><given-names>Y</given-names></name><etal/></person-group>             <year>1995</year>             <article-title>Dynamics of neuronal interactions in monkey cortex in relation to behavioral events.</article-title>             <source>Nature</source>             <volume>373</volume>             <fpage>515</fpage>             <lpage>518</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Ishikane1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ishikane</surname><given-names>H</given-names></name><name name-style="western"><surname>Gangi</surname><given-names>M</given-names></name><name name-style="western"><surname>Honda</surname><given-names>S</given-names></name><name name-style="western"><surname>Tachibana</surname><given-names>M</given-names></name></person-group>             <year>2005</year>             <article-title>Synchronized retinal oscillations encode essential information for escape behavior in frogs.</article-title>             <source>Nat Neurosci</source>             <volume>8</volume>             <fpage>1087</fpage>             <lpage>1095</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Fujisawa1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fujisawa</surname><given-names>S</given-names></name><name name-style="western"><surname>Amarasingham</surname><given-names>A</given-names></name><name name-style="western"><surname>Harrison</surname><given-names>MT</given-names></name><name name-style="western"><surname>Buzsáki</surname><given-names>G</given-names></name></person-group>             <year>2008</year>             <article-title>Behavior-dependent short-term assembly dynamics in the medial prefrontal cortex.</article-title>             <source>Nat Neurosci</source>             <volume>11</volume>             <fpage>823</fpage>             <lpage>833</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Kilavik1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kilavik</surname><given-names>BE</given-names></name><name name-style="western"><surname>Roux</surname><given-names>S</given-names></name><name name-style="western"><surname>Ponce-Alvarez</surname><given-names>A</given-names></name><name name-style="western"><surname>Confais</surname><given-names>J</given-names></name><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Long-term modi–cations in motor cortical dynamics induced by intensive practice.</article-title>             <source>J Neurosci</source>             <volume>29</volume>             <fpage>12653</fpage>             <lpage>12663</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Sakurai2">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sakurai</surname><given-names>Y</given-names></name></person-group>             <year>1996</year>             <article-title>Hippocampal and neocortical cell assemblies encode memory processes for different types of stimuli in the rat.</article-title>             <source>J Neurosci</source>             <volume>16</volume>             <fpage>2809</fpage>             <lpage>2819</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Steinmetz1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Steinmetz</surname><given-names>PN</given-names></name><name name-style="western"><surname>Roy</surname><given-names>A</given-names></name><name name-style="western"><surname>Fitzgerald</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Hsiao</surname><given-names>SS</given-names></name><name name-style="western"><surname>Johnson</surname><given-names>KO</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>Attention modulates synchronized neuronal firing in primate somatosensory cortex.</article-title>             <source>Nature</source>             <volume>404</volume>             <fpage>187</fpage>             <lpage>190</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Sakurai3">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sakurai</surname><given-names>Y</given-names></name><name name-style="western"><surname>Takahashi</surname><given-names>S</given-names></name></person-group>             <year>2006</year>             <article-title>Dynamic synchrony of firing in the monkey prefrontal cortex during working-memory tasks.</article-title>             <source>J Neurosci</source>             <volume>26</volume>             <fpage>10141</fpage>             <lpage>10153</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Takahashi1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Takahashi</surname><given-names>S</given-names></name><name name-style="western"><surname>Sakurai</surname><given-names>Y</given-names></name></person-group>             <year>2009</year>             <article-title>Sub-millisecond firing synchrony of closely neighboring pyramidal neurons in hippocampal CA1 of rats during delayed non-matching to sample task.</article-title>             <source>Front Neural Circuits</source>             <volume>3</volume>             <fpage>9</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Brown1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name><name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name><name name-style="western"><surname>Mitra</surname><given-names>PP</given-names></name></person-group>             <year>2004</year>             <article-title>Multiple neural spike train data analysis: state-of-the-art and future challenges.</article-title>             <source>Nat Neurosci</source>             <volume>7</volume>             <fpage>456</fpage>             <lpage>461</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Grn1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name></person-group>             <year>2009</year>             <article-title>Data-driven significance estimation for precise spike correlation.</article-title>             <source>J Neurophysiol</source>             <volume>101</volume>             <fpage>1126</fpage>             <lpage>1140</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Grn2">
        <label>26</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="editor"><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name><name name-style="western"><surname>Rotter</surname><given-names>S</given-names></name></person-group>             <year>2010</year>             <source>Analysis of Parallel Spike Trains</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Perkel1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Perkel</surname><given-names>DH</given-names></name><name name-style="western"><surname>Gerstein</surname><given-names>GL</given-names></name><name name-style="western"><surname>Moore</surname><given-names>GP</given-names></name></person-group>             <year>1967</year>             <article-title>Neuronal spike trains and stochastic point processes. II. simultaneous spike trains.</article-title>             <source>Biophys J</source>             <volume>7</volume>             <fpage>419</fpage>             <lpage>440</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Gerstein2">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gerstein</surname><given-names>GL</given-names></name><name name-style="western"><surname>Perkel</surname><given-names>DH</given-names></name></person-group>             <year>1969</year>             <article-title>Simultaneously recorded trains of action potentials - analysis and functional interpretation.</article-title>             <source>Science</source>             <volume>164</volume>             <fpage>828</fpage>             <lpage>830</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Gerstein3">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gerstein</surname><given-names>GL</given-names></name><name name-style="western"><surname>Kiang</surname><given-names>NYS</given-names></name></person-group>             <year>1960</year>             <article-title>An approach to the quantitative analysis of electrophysiological data from single neurons.</article-title>             <source>Biophys J</source>             <volume>1</volume>             <fpage>15</fpage>             <lpage>28</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Shimazaki1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shimazaki</surname><given-names>H</given-names></name><name name-style="western"><surname>Shinomoto</surname><given-names>S</given-names></name></person-group>             <year>2007</year>             <article-title>A method for selecting the bin size of a time histogram.</article-title>             <source>Neural Comput</source>             <volume>19</volume>             <fpage>1503</fpage>             <lpage>1527</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Shimazaki2">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shimazaki</surname><given-names>H</given-names></name><name name-style="western"><surname>Shinomoto</surname><given-names>S</given-names></name></person-group>             <year>2010</year>             <article-title>Kernel bandwidth optimization in spike rate estimation.</article-title>             <source>J Comput Neurosci</source>             <volume>29</volume>             <fpage>171</fpage>             <lpage>182</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Grn3">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name><name name-style="western"><surname>Diesmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Aertsen</surname><given-names>A</given-names></name></person-group>             <year>2002</year>             <article-title>Unitary events in multiple single-neuron spiking activity: I. detection and significance.</article-title>             <source>Neural Comput</source>             <volume>14</volume>             <fpage>43</fpage>             <lpage>80</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Grn4">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name><name name-style="western"><surname>Diesmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Aertsen</surname><given-names>A</given-names></name></person-group>             <year>2002</year>             <article-title>Unitary events in multiple single-neuron spiking activity: II. nonstationary data.</article-title>             <source>Neural Comput</source>             <volume>14</volume>             <fpage>81</fpage>             <lpage>119</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Staude1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Staude</surname><given-names>B</given-names></name><name name-style="western"><surname>Rotter</surname><given-names>S</given-names></name><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name></person-group>             <year>2010</year>             <article-title>Cubic: cumulant based inference of higher-order correlations in massively parallel spike trains.</article-title>             <source>J Comput Neurosci</source>             <volume>29</volume>             <fpage>327</fpage>             <lpage>350</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Staude2">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Staude</surname><given-names>B</given-names></name><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name><name name-style="western"><surname>Rotter</surname><given-names>S</given-names></name></person-group>             <year>2010</year>             <article-title>Higher-order correlations in non-stationary parallel spike trains: statistical modeling and inference.</article-title>             <source>Front Comput Neurosci</source>             <volume>4</volume>             <fpage>16</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Chornoboy1">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chornoboy</surname><given-names>ES</given-names></name><name name-style="western"><surname>Schramm</surname><given-names>LP</given-names></name><name name-style="western"><surname>Karr</surname><given-names>AF</given-names></name></person-group>             <year>1988</year>             <article-title>Maximum likelihood identification of neural point process systems.</article-title>             <source>Biol Cybern</source>             <volume>59</volume>             <fpage>265</fpage>             <lpage>275</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Brown2">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name><name name-style="western"><surname>Frank</surname><given-names>LM</given-names></name><name name-style="western"><surname>Tang</surname><given-names>D</given-names></name><name name-style="western"><surname>Quirk</surname><given-names>MC</given-names></name><name name-style="western"><surname>Wilson</surname><given-names>MA</given-names></name></person-group>             <year>1998</year>             <article-title>A statistical paradigm for neural spike train decoding applied to position prediction from ensemble firing patterns of rat hippocampal place cells.</article-title>             <source>J Neurosci</source>             <volume>18</volume>             <fpage>7411</fpage>             <lpage>7425</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Truccolo1">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Truccolo</surname><given-names>W</given-names></name><name name-style="western"><surname>Eden</surname><given-names>UT</given-names></name><name name-style="western"><surname>Fellows</surname><given-names>MR</given-names></name><name name-style="western"><surname>Donoghue</surname><given-names>JP</given-names></name><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name></person-group>             <year>2005</year>             <article-title>A point process framework for relating neural spiking activity to spiking history, neural ensemble, and extrinsic covariate effects.</article-title>             <source>J Neurophysiol</source>             <volume>93</volume>             <fpage>1074</fpage>             <lpage>1089</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Okatan1">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Okatan</surname><given-names>M</given-names></name><name name-style="western"><surname>Wilson</surname><given-names>MA</given-names></name><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name></person-group>             <year>2005</year>             <article-title>Analyzing functional connectivity using a network likelihood model of ensemble neural spiking activity.</article-title>             <source>Neural Comput</source>             <volume>17</volume>             <fpage>1927</fpage>             <lpage>1961</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Pillow1">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pillow</surname><given-names>JW</given-names></name><name name-style="western"><surname>Shlens</surname><given-names>J</given-names></name><name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name><name name-style="western"><surname>Sher</surname><given-names>A</given-names></name><name name-style="western"><surname>Litke</surname><given-names>AM</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population.</article-title>             <source>Nature</source>             <volume>454</volume>             <fpage>995</fpage>             <lpage>999</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Kim1">
        <label>41</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>S</given-names></name><name name-style="western"><surname>Putrino</surname><given-names>D</given-names></name><name name-style="western"><surname>Ghosh</surname><given-names>S</given-names></name><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name></person-group>             <year>2011</year>             <article-title>A granger causality measure for point process models of ensemble neural spiking activity.</article-title>             <source>PLoS Comput Biol</source>             <volume>7</volume>             <fpage>e1001110</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Kulkarni1">
        <label>42</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kulkarni</surname><given-names>JE</given-names></name><name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name></person-group>             <year>2007</year>             <article-title>Common-input models for multiple neural spike-train data.</article-title>             <source>Network: Comp Neural Sys</source>             <volume>18</volume>             <fpage>375</fpage>             <lpage>407</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Vidne1">
        <label>43</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Vidne</surname><given-names>M</given-names></name><name name-style="western"><surname>Ahmadian</surname><given-names>Y</given-names></name><name name-style="western"><surname>Shlens</surname><given-names>J</given-names></name><name name-style="western"><surname>Pillow</surname><given-names>JW</given-names></name><name name-style="western"><surname>Kulkarni</surname><given-names>J</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Modeling the impact of common noise inputs on the network activity of retinal ganglion cells.</article-title>             <source>J Comput Neurosci</source>             <comment>In press. DOI: 101007/s10827-011-0376-2</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Amari1">
        <label>44</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Amari</surname><given-names>SI</given-names></name></person-group>             <year>2001</year>             <article-title>Information geometry on hierarchy of probability distributions.</article-title>             <source>IEEE T Inform Theory</source>             <volume>47</volume>             <fpage>1701</fpage>             <lpage>1711</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Nakahara1">
        <label>45</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nakahara</surname><given-names>H</given-names></name><name name-style="western"><surname>Amari</surname><given-names>SI</given-names></name></person-group>             <year>2002</year>             <article-title>Information-geometric measure for neural spikes.</article-title>             <source>Neural Comput</source>             <volume>14</volume>             <fpage>2269</fpage>             <lpage>2316</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Ackley1">
        <label>46</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ackley</surname><given-names>D</given-names></name><name name-style="western"><surname>Hinton</surname><given-names>G</given-names></name><name name-style="western"><surname>Sejnowski</surname><given-names>T</given-names></name></person-group>             <year>1985</year>             <article-title>A learning algorithm for boltzmann machines.</article-title>             <source>Cognitive Sci</source>             <volume>9</volume>             <fpage>147</fpage>             <lpage>169</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Amari2">
        <label>47</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Amari</surname><given-names>S</given-names></name><name name-style="western"><surname>Kurata</surname><given-names>K</given-names></name><name name-style="western"><surname>Nagaoka</surname><given-names>H</given-names></name></person-group>             <year>1992</year>             <article-title>Information geometry of boltzmann machines.</article-title>             <source>IEEE T Neural Networ</source>             <volume>3</volume>             <fpage>260</fpage>             <lpage>271</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Amari3">
        <label>48</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Amari</surname><given-names>S</given-names></name></person-group>             <year>1972</year>             <article-title>Learning patterns and pattern sequences by self-organizing nets of threshold elements.</article-title>             <source>IEEE Trans Comput</source>             <volume>21</volume>             <fpage>1197</fpage>             <lpage>1206</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Hopfield1">
        <label>49</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hopfield</surname><given-names>J</given-names></name></person-group>             <year>1982</year>             <article-title>Neural networks and physical systems with emergent collective computational abilities.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>79</volume>             <fpage>2554</fpage>             <lpage>2558</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Amari4">
        <label>50</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Amari</surname><given-names>S</given-names></name><name name-style="western"><surname>Nagaoka</surname><given-names>H</given-names></name></person-group>             <year>2000</year>             <source>Methods of Information Geometry</source>             <publisher-loc>Providence</publisher-loc>             <publisher-name>American Mathematical Society</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Amari5">
        <label>51</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Amari</surname><given-names>S</given-names></name></person-group>             <year>2009</year>             <article-title>Measure of correlation orthogonal to change in firing rate.</article-title>             <source>Neural Comput</source>             <volume>21</volume>             <fpage>960</fpage>             <lpage>972</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Schneidman1">
        <label>52</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name><name name-style="western"><surname>Still</surname><given-names>S</given-names></name><name name-style="western"><surname>Berry</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name></person-group>             <year>2003</year>             <article-title>Network information and connected correlations.</article-title>             <source>Phys Rev Lett</source>             <volume>91</volume>             <fpage>238701</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Montani1">
        <label>53</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Montani</surname><given-names>F</given-names></name><name name-style="western"><surname>Ince</surname><given-names>RAA</given-names></name><name name-style="western"><surname>Senatore</surname><given-names>R</given-names></name><name name-style="western"><surname>Arabzadeh</surname><given-names>E</given-names></name><name name-style="western"><surname>Diamond</surname><given-names>ME</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>The impact of high-order interactions on the rate of synchronous discharge and information transmission in somatosensory cortex.</article-title>             <source>Philos Transact A Math Phys Eng Sci</source>             <volume>367</volume>             <fpage>3297</fpage>             <lpage>3310</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Roudi1">
        <label>54</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Roudi</surname><given-names>Y</given-names></name><name name-style="western"><surname>Nirenberg</surname><given-names>S</given-names></name><name name-style="western"><surname>Latham</surname><given-names>PE</given-names></name></person-group>             <year>2009</year>             <article-title>Pairwise maximum entropy models for studying large biological systems: when they can work and when they can't.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000380</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Schneidman2">
        <label>55</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name><name name-style="western"><surname>Berry</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Segev</surname><given-names>R</given-names></name><name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name></person-group>             <year>2006</year>             <article-title>Weak pairwise correlations imply strongly correlated network states in a neural population.</article-title>             <source>Nature</source>             <volume>440</volume>             <fpage>1007</fpage>             <lpage>1012</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Shlens1">
        <label>56</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shlens</surname><given-names>J</given-names></name><name name-style="western"><surname>Field</surname><given-names>GD</given-names></name><name name-style="western"><surname>Gauthier</surname><given-names>JL</given-names></name><name name-style="western"><surname>Grivich</surname><given-names>MI</given-names></name><name name-style="western"><surname>Petrusca</surname><given-names>D</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>The structure of multineuron firing patterns in primate retina.</article-title>             <source>J Neurosci</source>             <volume>26</volume>             <fpage>8254</fpage>             <lpage>8266</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Tang1">
        <label>57</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tang</surname><given-names>A</given-names></name><name name-style="western"><surname>Jackson</surname><given-names>D</given-names></name><name name-style="western"><surname>Hobbs</surname><given-names>J</given-names></name><name name-style="western"><surname>Chen</surname><given-names>W</given-names></name><name name-style="western"><surname>Smith</surname><given-names>JL</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>A maximum entropy model applied to spatial and temporal correlations from cortical networks in vitro.</article-title>             <source>J Neurosci</source>             <volume>28</volume>             <fpage>505</fpage>             <lpage>518</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Santos1">
        <label>58</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Santos</surname><given-names>GS</given-names></name><name name-style="western"><surname>Gireesh</surname><given-names>ED</given-names></name><name name-style="western"><surname>Plenz</surname><given-names>D</given-names></name><name name-style="western"><surname>Nakahara</surname><given-names>H</given-names></name></person-group>             <year>2010</year>             <article-title>Hierarchical interaction structure of neural activities in cortical slice cultures.</article-title>             <source>J Neurosci</source>             <volume>30</volume>             <fpage>8720</fpage>             <lpage>8733</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Yu1">
        <label>59</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>S</given-names></name><name name-style="western"><surname>Yang</surname><given-names>H</given-names></name><name name-style="western"><surname>Nakahara</surname><given-names>H</given-names></name><name name-style="western"><surname>Santos</surname><given-names>GS</given-names></name><name name-style="western"><surname>Nikolic</surname><given-names>D</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Higher-order interactions characterized in cortical activity.</article-title>             <source>J Neurosci</source>             <volume>31</volume>             <fpage>17514</fpage>             <lpage>17526</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Ohiorhenuan1">
        <label>60</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ohiorhenuan</surname><given-names>IE</given-names></name><name name-style="western"><surname>Mechler</surname><given-names>F</given-names></name><name name-style="western"><surname>Purpura</surname><given-names>KP</given-names></name><name name-style="western"><surname>Schmid</surname><given-names>AM</given-names></name><name name-style="western"><surname>Hu</surname><given-names>Q</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Sparse coding and high-order correlations in fine-scale cortical networks.</article-title>             <source>Nature</source>             <volume>466</volume>             <fpage>617</fpage>             <lpage>621</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Martignon1">
        <label>61</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Martignon</surname><given-names>L</given-names></name><name name-style="western"><surname>Hasseln</surname><given-names>HV</given-names></name><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name><name name-style="western"><surname>Aertsen</surname><given-names>A</given-names></name><name name-style="western"><surname>Palm</surname><given-names>G</given-names></name></person-group>             <year>1995</year>             <article-title>Detecting higher-order interactions among the spiking events in a group of neurons.</article-title>             <source>Biol Cybern</source>             <volume>73</volume>             <fpage>69</fpage>             <lpage>81</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Martignon2">
        <label>62</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Martignon</surname><given-names>L</given-names></name><name name-style="western"><surname>Deco</surname><given-names>G</given-names></name><name name-style="western"><surname>Laskey</surname><given-names>K</given-names></name><name name-style="western"><surname>Diamond</surname><given-names>M</given-names></name><name name-style="western"><surname>Freiwald</surname><given-names>W</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>Neural coding: higherorder temporal patterns in the neurostatistics of cell assemblies.</article-title>             <source>Neural Comput</source>             <volume>12</volume>             <fpage>2621</fpage>             <lpage>2653</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Macke1">
        <label>63</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Macke</surname><given-names>JH</given-names></name><name name-style="western"><surname>Opper</surname><given-names>M</given-names></name><name name-style="western"><surname>Bethge</surname><given-names>M</given-names></name></person-group>             <year>2011</year>             <article-title>Common input explains higher-order correlations and entropy in a simple model of neural population activity.</article-title>             <source>Phys Rev Lett</source>             <volume>106</volume>             <fpage>208102</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Gtig1">
        <label>64</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gütig</surname><given-names>R</given-names></name><name name-style="western"><surname>Aertsen</surname><given-names>A</given-names></name><name name-style="western"><surname>Rotter</surname><given-names>S</given-names></name></person-group>             <year>2003</year>             <article-title>Analysis of higher-order neuronal interactions based on conditional inference.</article-title>             <source>Biol Cybern</source>             <volume>88</volume>             <fpage>352</fpage>             <lpage>359</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Amari6">
        <label>65</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Amari</surname><given-names>SI</given-names></name><name name-style="western"><surname>Nakahara</surname><given-names>H</given-names></name><name name-style="western"><surname>Wu</surname><given-names>S</given-names></name><name name-style="western"><surname>Sakai</surname><given-names>Y</given-names></name></person-group>             <year>2003</year>             <article-title>Synchronous firing and higher-order interactions in neuron pool.</article-title>             <source>Neural Comput</source>             <volume>15</volume>             <fpage>127</fpage>             <lpage>142</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Long1">
        <label>66</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Long</surname><given-names>J</given-names><suffix>II</suffix></name><name name-style="western"><surname>Carmena</surname><given-names>J</given-names></name></person-group>             <year>2011</year>             <article-title>A statistical description of neural ensemble dynamics.</article-title>             <source>Front Comput Neurosci</source>             <volume>5</volume>             <fpage>52</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Kass1">
        <label>67</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name><name name-style="western"><surname>Kelly</surname><given-names>RC</given-names></name><name name-style="western"><surname>Loh</surname><given-names>WL</given-names></name></person-group>             <year>2011</year>             <article-title>Assessment of synchrony in multiple neural spike trains using loglinear point process models.</article-title>             <source>Ann Appl Stat</source>             <volume>5</volume>             <fpage>1262</fpage>             <lpage>1292</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Smith1">
        <label>68</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>AC</given-names></name><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name></person-group>             <year>2003</year>             <article-title>Estimating a state-space model from point process observations.</article-title>             <source>Neural Comput</source>             <volume>15</volume>             <fpage>965</fpage>             <lpage>991</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Eden1">
        <label>69</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eden</surname><given-names>UT</given-names></name><name name-style="western"><surname>Frank</surname><given-names>LM</given-names></name><name name-style="western"><surname>Barbieri</surname><given-names>R</given-names></name><name name-style="western"><surname>Solo</surname><given-names>V</given-names></name><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name></person-group>             <year>2004</year>             <article-title>Dynamic analysis of neural encoding by point process adaptive filtering.</article-title>             <source>Neural Comput</source>             <volume>16</volume>             <fpage>971</fpage>             <lpage>998</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Stevenson1">
        <label>70</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stevenson</surname><given-names>IH</given-names></name><name name-style="western"><surname>Rebesco</surname><given-names>JM</given-names></name><name name-style="western"><surname>Hatsopoulos</surname><given-names>NG</given-names></name><name name-style="western"><surname>Haga</surname><given-names>Z</given-names></name><name name-style="western"><surname>Miller</surname><given-names>LE</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Bayesian inference of functional connectivity and network structure from spikes.</article-title>             <source>IEEE Trans Neural Syst Rehabil Eng</source>             <volume>17</volume>             <fpage>203</fpage>             <lpage>213</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Truccolo2">
        <label>71</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Truccolo</surname><given-names>W</given-names></name><name name-style="western"><surname>Hochberg</surname><given-names>LR</given-names></name><name name-style="western"><surname>Donoghue</surname><given-names>JP</given-names></name></person-group>             <year>2010</year>             <article-title>Collective dynamics in human and monkey sensorimotor cortex: predicting single neuron spikes.</article-title>             <source>Nat Neurosci</source>             <volume>13</volume>             <fpage>105</fpage>             <lpage>111</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Chen1">
        <label>72</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>Z</given-names></name><name name-style="western"><surname>Barbieri</surname><given-names>R</given-names></name><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name></person-group>             <year>2010</year>             <article-title>State-space modeling of neural spike train and behavioral data.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Oweiss</surname><given-names>KG</given-names></name></person-group>             <source>Statistical Signal Processing for Neuroscience and Neurotechnology</source>             <publisher-loc>Burlington</publisher-loc>             <publisher-name>Elsevier Science</publisher-name>             <fpage>175</fpage>             <lpage>218</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Akaike1">
        <label>73</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Akaike</surname><given-names>H</given-names></name></person-group>             <year>1980</year>             <article-title>Likelihood and the bayes procedure.</article-title>             <source>Trabajos de Estadística y de Investigación Operativa</source>             <volume>31</volume>             <fpage>143</fpage>             <lpage>166</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Jeffreys1">
        <label>74</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jeffreys</surname><given-names>H</given-names></name></person-group>             <year>1961</year>             <source>Theory of Probability</source>             <publisher-loc>Oxford</publisher-loc>             <publisher-name>Clarendon Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Good1">
        <label>75</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Good</surname><given-names>IJ</given-names></name></person-group>             <year>1985</year>             <article-title>Weight of Evidence: A brief survey.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Bernardo</surname><given-names>JM</given-names></name><name name-style="western"><surname>De Groot</surname><given-names>MH</given-names></name><name name-style="western"><surname>Lindley</surname><given-names>DV</given-names></name><name name-style="western"><surname>Smith</surname><given-names>AFM</given-names></name></person-group>             <source>Bayesian statistics 2</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>North Holland</publisher-name>             <fpage>249</fpage>             <lpage>269</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Kass2">
        <label>76</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name><name name-style="western"><surname>Raftery</surname><given-names>AE</given-names></name></person-group>             <year>1995</year>             <article-title>Bayes factors.</article-title>             <source>J Am Stat Assoc</source>             <volume>90</volume>             <fpage>773</fpage>             <lpage>795</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Shimazaki3">
        <label>77</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shimazaki</surname><given-names>H</given-names></name><name name-style="western"><surname>Amari</surname><given-names>SI</given-names></name><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name></person-group>             <year>2009</year>             <article-title>State-space analysis on time-varying correlations in parallel spike sequences.</article-title>             <source>Proceedings of IEEE International Conference on Acoustics, Speech, and Signal Processing, 2009</source>             <fpage>3501</fpage>             <lpage>3504</lpage>             <comment>ICASSP-2009</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Dempster1">
        <label>78</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dempster</surname><given-names>AP</given-names></name><name name-style="western"><surname>Laird</surname><given-names>NM</given-names></name><name name-style="western"><surname>Rubin</surname><given-names>DB</given-names></name></person-group>             <year>1977</year>             <article-title>Maximum likelihood from incomplete data via the EM algorithm.</article-title>             <source>J Roy Stat Soc B Met</source>             <volume>39</volume>             <fpage>1</fpage>             <lpage>38</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Schwarz1">
        <label>79</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schwarz</surname><given-names>G</given-names></name></person-group>             <year>1978</year>             <article-title>Estimating the dimension of a model.</article-title>             <source>Ann Stat</source>             <volume>6</volume>             <fpage>461</fpage>             <lpage>464</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Rissanen1">
        <label>80</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rissanen</surname><given-names>J</given-names></name></person-group>             <year>2009</year>             <source>Information and Complexity in Statistical Modeling</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Shimodaira1">
        <label>81</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shimodaira</surname><given-names>H</given-names></name></person-group>             <year>1994</year>             <article-title>A new criterion for selecting models from partially observed data.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Cheeseman</surname><given-names>P</given-names></name><name name-style="western"><surname>Oldford</surname><given-names>RW</given-names></name></person-group>             <source>Selecting models from data - artificial intelligence and statistics IV</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>             <fpage>21</fpage>             <lpage>30</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Shlens2">
        <label>82</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shlens</surname><given-names>J</given-names></name><name name-style="western"><surname>Field</surname><given-names>GD</given-names></name><name name-style="western"><surname>Gauthier</surname><given-names>JL</given-names></name><name name-style="western"><surname>Greschner</surname><given-names>M</given-names></name><name name-style="western"><surname>Sher</surname><given-names>A</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>The structure of large-scale synchronized –ring in primate retina.</article-title>             <source>J Neurosci</source>             <volume>29</volume>             <fpage>5022</fpage>             <lpage>5031</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Louis1">
        <label>83</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Louis</surname><given-names>S</given-names></name><name name-style="western"><surname>Gerstein</surname><given-names>G</given-names></name><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name><name name-style="western"><surname>Diesmann</surname><given-names>M</given-names></name></person-group>             <year>2010</year>             <article-title>Surrogate spike train generation through dithering in operational time.</article-title>             <source>Front Comput Neurosci</source>             <volume>4</volume>             <fpage>127</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Riehle2">
        <label>84</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Riehle</surname><given-names>A</given-names></name><name name-style="western"><surname>Grammont</surname><given-names>F</given-names></name><name name-style="western"><surname>Diesmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name></person-group>             <year>2000</year>             <article-title>Dynamical changes and temporal precision of synchronized spiking activity in monkey motor cortex during movement preparation.</article-title>             <source>J Physiol Paris</source>             <volume>94</volume>             <fpage>569</fpage>             <lpage>582</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Bohte1">
        <label>85</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bohte</surname><given-names>SM</given-names></name><name name-style="western"><surname>Spekreijse</surname><given-names>H</given-names></name><name name-style="western"><surname>Roelfsema</surname><given-names>PR</given-names></name></person-group>             <year>2000</year>             <article-title>The effects of pair-wise and higher order correlations on the firing rate of a post-synaptic neuron.</article-title>             <source>Neural Comput</source>             <volume>12</volume>             <fpage>153</fpage>             <lpage>179</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Staude3">
        <label>86</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Staude</surname><given-names>B</given-names></name><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name><name name-style="western"><surname>Rotter</surname><given-names>S</given-names></name></person-group>             <year>2010</year>             <article-title>Higher order correlations and cumulants.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Grün</surname></name><name name-style="western"><surname>Rotter</surname></name></person-group>             <source>Analysis of parallel spike trains</source>             <publisher-name>Springer New York</publisher-name>             <fpage>253</fpage>             <lpage>280</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Jenison1">
        <label>87</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jenison</surname><given-names>RL</given-names></name><name name-style="western"><surname>Reale</surname><given-names>RA</given-names></name></person-group>             <year>2004</year>             <article-title>The shape of neural dependence.</article-title>             <source>Neural Comput</source>             <volume>16</volume>             <fpage>665</fpage>             <lpage>672</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Berkes1">
        <label>88</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Berkes</surname><given-names>P</given-names></name><name name-style="western"><surname>Wood</surname><given-names>F</given-names></name><name name-style="western"><surname>Pillow</surname><given-names>J</given-names></name></person-group>             <year>2009</year>             <article-title>Characterizing neural dependencies with copula models.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Koller</surname><given-names>D</given-names></name><name name-style="western"><surname>Schuurmans</surname><given-names>D</given-names></name><name name-style="western"><surname>Bengio</surname><given-names>Y</given-names></name><name name-style="western"><surname>Bottou</surname><given-names>L</given-names></name></person-group>             <source>Advances in NIPS 21</source>             <fpage>129</fpage>             <lpage>136</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Onken1">
        <label>89</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Onken</surname><given-names>A</given-names></name><name name-style="western"><surname>Grünewälder</surname><given-names>S</given-names></name><name name-style="western"><surname>Munk</surname><given-names>MHJ</given-names></name><name name-style="western"><surname>Obermayer</surname><given-names>K</given-names></name></person-group>             <year>2009</year>             <article-title>Analyzing short-term noise dependencies of spike-counts in macaque prefrontal cortex using copulas and the flashlight transformation.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000577</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Paninski1">
        <label>90</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name></person-group>             <year>2005</year>             <article-title>Log-concavity results on gaussian process methods for supervised and unsupervised learning.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Saul</surname><given-names>LK</given-names></name><name name-style="western"><surname>Weiss</surname><given-names>Y</given-names></name><name name-style="western"><surname>Bottou</surname><given-names>L</given-names></name></person-group>             <source>Advances in NIPS 17</source>             <fpage>1025</fpage>             <lpage>1032</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Amari7">
        <label>91</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Amari</surname><given-names>S</given-names></name></person-group>             <year>1998</year>             <article-title>Natural gradient works efficiently in learning.</article-title>             <source>Neural Comput</source>             <volume>10</volume>             <fpage>251</fpage>             <lpage>276</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Murray1">
        <label>92</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Murray</surname><given-names>I</given-names></name><name name-style="western"><surname>Ghahramani</surname><given-names>Z</given-names></name></person-group>             <year>2004</year>             <article-title>Bayesian learning in undirected graphical models: approximate MCMC algorithms.</article-title>             <source>Proceedings of the 20th Annual Conference on Uncertainty in Artificial Intelligence. UAI-2004</source>             <publisher-loc>Arlington</publisher-loc>             <publisher-name>AUAI Press</publisher-name>             <fpage>392</fpage>             <lpage>399</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Schaub1">
        <label>93</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schaub</surname><given-names>MT</given-names></name><name name-style="western"><surname>Schultz</surname><given-names>SR</given-names></name></person-group>             <year>2011</year>             <article-title>The Ising decoder: reading out the activity of large neural ensembles.</article-title>             <source>J Comput Neurosci</source>             <volume>32</volume>             <fpage>101</fpage>             <lpage>118</lpage>             <comment>101007/s10827-011-0342-z</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Shinomoto1">
        <label>94</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shinomoto</surname><given-names>S</given-names></name><name name-style="western"><surname>Kim</surname><given-names>H</given-names></name><name name-style="western"><surname>Shimokawa</surname><given-names>T</given-names></name><name name-style="western"><surname>Matsuno</surname><given-names>N</given-names></name><name name-style="western"><surname>Funahashi</surname><given-names>S</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Relating neuronal firing patterns to functional differentiation of cerebral cortex.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000433</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Daley1">
        <label>95</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Daley</surname><given-names>D</given-names></name><name name-style="western"><surname>Vere-Jones</surname><given-names>D</given-names></name></person-group>             <year>1988</year>             <source>An Introduction to the Theory of Point Processes</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Kass3">
        <label>96</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name><name name-style="western"><surname>Ventura</surname><given-names>V</given-names></name><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name></person-group>             <year>2005</year>             <article-title>Statistical issues in the analysis of neuronal data.</article-title>             <source>J Neurophysiol</source>             <volume>94</volume>             <fpage>8</fpage>             <lpage>25</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Brody1">
        <label>97</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brody</surname><given-names>CD</given-names></name></person-group>             <year>1999</year>             <article-title>Correlations without synchrony.</article-title>             <source>Neural Comput</source>             <volume>11</volume>             <fpage>1537</fpage>             <lpage>1551</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Czanner1">
        <label>98</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Czanner</surname><given-names>G</given-names></name><name name-style="western"><surname>Eden</surname><given-names>UT</given-names></name><name name-style="western"><surname>Wirth</surname><given-names>S</given-names></name><name name-style="western"><surname>Yanike</surname><given-names>M</given-names></name><name name-style="western"><surname>Suzuki</surname><given-names>WA</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Analysis of between-trial and within-trial neural spiking dynamics.</article-title>             <source>J Neurophysiol</source>             <volume>99</volume>             <fpage>2672</fpage>             <lpage>2693</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Grn5">
        <label>99</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Grün</surname><given-names>S</given-names></name><name name-style="western"><surname>Diesmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Grammont</surname><given-names>F</given-names></name><name name-style="western"><surname>Riehle</surname><given-names>A</given-names></name><name name-style="western"><surname>Aertsen</surname><given-names>A</given-names></name></person-group>             <year>1999</year>             <article-title>Detecting unitary events without discretization of time.</article-title>             <source>J Neurosci Methods</source>             <volume>94</volume>             <fpage>67</fpage>             <lpage>79</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Marre1">
        <label>100</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Marre</surname><given-names>O</given-names></name><name name-style="western"><surname>Boustani</surname><given-names>SE</given-names></name><name name-style="western"><surname>Frégnac</surname><given-names>Y</given-names></name><name name-style="western"><surname>Destexhe</surname><given-names>A</given-names></name></person-group>             <year>2009</year>             <article-title>Prediction of spatiotemporal patterns of neural activity from pairwise correlations.</article-title>             <source>Phys Rev Lett</source>             <volume>102</volume>             <fpage>138101</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Brown3">
        <label>101</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name><name name-style="western"><surname>Barbieri</surname><given-names>R</given-names></name><name name-style="western"><surname>Ventura</surname><given-names>V</given-names></name><name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name><name name-style="western"><surname>Frank</surname><given-names>LM</given-names></name></person-group>             <year>2001</year>             <article-title>The time-rescaling theorem and its application to neural spike train data analysis.</article-title>             <source>Neural Comput</source>             <volume>14</volume>             <fpage>325</fpage>             <lpage>346</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Oizumi1">
        <label>102</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Oizumi</surname><given-names>M</given-names></name><name name-style="western"><surname>Ishii</surname><given-names>T</given-names></name><name name-style="western"><surname>Ishibashi</surname><given-names>K</given-names></name><name name-style="western"><surname>Hosoya</surname><given-names>T</given-names></name><name name-style="western"><surname>Okada</surname><given-names>M</given-names></name></person-group>             <year>2010</year>             <article-title>Mismatched decoding in the brain.</article-title>             <source>J Neurosci</source>             <volume>30</volume>             <fpage>4815</fpage>             <lpage>4826</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Shumway1">
        <label>103</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shumway</surname><given-names>R</given-names></name><name name-style="western"><surname>Stoffer</surname><given-names>D</given-names></name></person-group>             <year>1982</year>             <article-title>An approach to time series smoothing and forecasting using the em algorithm.</article-title>             <source>J Time Ser Anal</source>             <volume>3</volume>             <fpage>253</fpage>             <lpage>264</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Smith2">
        <label>104</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>AC</given-names></name><name name-style="western"><surname>Frank</surname><given-names>LM</given-names></name><name name-style="western"><surname>Wirth</surname><given-names>S</given-names></name><name name-style="western"><surname>Yanike</surname><given-names>M</given-names></name><name name-style="western"><surname>Hu</surname><given-names>D</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Dynamic analysis of learning in behavioral experiments.</article-title>             <source>J Neurosci</source>             <volume>24</volume>             <fpage>447</fpage>             <lpage>461</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Kitagawa1">
        <label>105</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kitagawa</surname><given-names>G</given-names></name></person-group>             <year>1987</year>             <article-title>Non-Gaussian state-space modeling of nonstationary time series.</article-title>             <source>J Am Stat Assoc</source>             <volume>82</volume>             <fpage>1032</fpage>             <lpage>1041</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Fahrmeir1">
        <label>106</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fahrmeir</surname><given-names>L</given-names></name></person-group>             <year>1992</year>             <article-title>Posterior mode estimation by extended kalman filtering for multivariate dynamic generalized linear models.</article-title>             <source>J Am Stat Assoc</source>             <volume>87</volume>             <fpage>501</fpage>             <lpage>509</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Koyama1">
        <label>107</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Koyama</surname><given-names>S</given-names></name><name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name></person-group>             <year>2010</year>             <article-title>Efficient computation of the maximum a posteriori path and parameter estimation in integrate-and-fire and more general state-space models.</article-title>             <source>J Comput Neurosci</source>             <volume>89–105</volume>             <fpage>1</fpage>             <lpage>2</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-DeJong1">
        <label>108</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>De Jong</surname><given-names>P</given-names></name><name name-style="western"><surname>Mackinnon</surname><given-names>MJ</given-names></name></person-group>             <year>1988</year>             <article-title>Covariances for smoothed estimates in state space models.</article-title>             <source>Biometrika</source>             <volume>75</volume>             <fpage>601</fpage>             <lpage>602</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Harvey1">
        <label>109</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Harvey</surname><given-names>AC</given-names></name></person-group>             <year>1989</year>             <source>Forecasting Structural Time Series Models and the Kalman Filter</source>             <publisher-loc>Cambridge; New York</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Durbin1">
        <label>110</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>J</given-names></name><name name-style="western"><surname>Koopman</surname><given-names>SJ</given-names></name></person-group>             <year>2001</year>             <source>Time Series Analysis by State Space Methods</source>             <publisher-loc>Oxford; New York</publisher-loc>             <publisher-name>Oxford University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002385-Meng1">
        <label>111</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Meng</surname><given-names>X</given-names></name><name name-style="western"><surname>Rubin</surname><given-names>D</given-names></name></person-group>             <year>1991</year>             <article-title>Using EM to obtain asymptotic variance-covariance matrices: the SEM algorithm.</article-title>             <source>J Am Stat Assoc</source>             <volume>86</volume>             <fpage>899</fpage>             <lpage>909</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>