<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0212999</article-id>
<article-id pub-id-type="publisher-id">PONE-D-17-41055</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pharmacology</subject><subj-group><subject>Drugs</subject><subj-group><subject>Analgesics</subject><subj-group><subject>NSAIDs</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pain management</subject><subj-group><subject>Analgesics</subject><subj-group><subject>NSAIDs</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pharmacology</subject><subj-group><subject>Drugs</subject><subj-group><subject>Analgesics</subject><subj-group><subject>COX-2 inhibitors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pain management</subject><subj-group><subject>Analgesics</subject><subj-group><subject>COX-2 inhibitors</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Hemorrhage</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Hemorrhage</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Vascular medicine</subject><subj-group><subject>Hemorrhage</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pharmacology</subject><subj-group><subject>Drug research and development</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Health informatics</subject><subj-group><subject>Electronic medical records</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Statistical hypothesis testing</subject><subj-group><subject>Chi square tests</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Statistical hypothesis testing</subject><subj-group><subject>Chi square tests</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Instrumental variable analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Instrumental variable analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Research design</subject><subj-group><subject>Clinical research design</subject><subj-group><subject>Comparative effectiveness research</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Generating and evaluating a propensity model using textual features from electronic medical records</article-title>
<alt-title alt-title-type="running-head">Generating a propensity model using textual features</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3289-7217</contrib-id>
<name name-style="western">
<surname>Afzal</surname>
<given-names>Zubair</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Masclee</surname>
<given-names>Gwen M. C.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Sturkenboom</surname>
<given-names>Miriam C. J. M.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kors</surname>
<given-names>Jan A.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Schuemie</surname>
<given-names>Martijn J.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Medical Informatics, Erasmus University Medical Center, CA Rotterdam, Netherlands</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Janssen Research and Development LLC, Titusville, NJ, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ramagopalan</surname>
<given-names>Sreeram V.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Oxford, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>This study was supported by the VICI project 91896632 of the Netherlands Organization for Health Research and Development ZonMw. Janssen Research and Development provided support in the form of salaries for author M.J.S. This does not alter our adherence to PLOS ONE policies on sharing data and materials.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">m.afzal@erasmusmc.nl</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>4</day>
<month>3</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<year>2019</year>
</pub-date>
<volume>14</volume>
<issue>3</issue>
<elocation-id>e0212999</elocation-id>
<history>
<date date-type="received">
<day>21</day>
<month>11</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>2</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Afzal et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0212999"/>
<abstract>
<sec id="sec001">
<title>Background</title>
<p>Propensity score (PS) methods are commonly used to control for confounding in comparative effectiveness studies. Electronic health records (EHRs) contain much unstructured data that could be used as proxies for potential confounding factors. The goal of this study was to assess whether the unstructured information can also be used to construct PS models that would allow to properly deal with confounding. We used an example of coxibs (Cox-2 inhibitors) vs. traditional NSAIDs and the risk of upper gastro-intestinal bleeding as example, since this association is often confounded due to channeling of coxibs to patients at higher risk of upper gastro-intestinal bleeding.</p>
</sec>
<sec id="sec002">
<title>Methods</title>
<p>In a cohort study of new users of nonsteroidal anti-inflammatory drugs (NSAIDs) from the Dutch Integrated Primary Care Information (IPCI) database, we identified all patients who experienced an upper gastrointestinal bleeding (UGIB). We used a large-scale regularized regression to fit two PS models using all structured and unstructured information in the EHR. We calculated hazard ratios (HRs) to estimate the risk of UGIB among selective cyclo-oxygenase-2 (COX-2) inhibitor users compared to nonselective NSAID (nsNSAID) users.</p>
</sec>
<sec id="sec003">
<title>Results</title>
<p>The crude hazard ratio of UGIB for COX-2 inhibitors compared to nsNSAIDs was 0.50 (95% confidence interval 0.18–1.36). Matching only on age resulted in an HR of 0.36 (0.11–1.16), and of 0.35 (0.11–1.11) when further adjusted for sex. Matching on PS only, the first model yielded an HR of 0.42 (0.13–1.38), which reduced to 0.35 (0.96–1.25) when adjusted for age and sex. The second model resulted in an HR of 0.42 (0.13–1.39), which dropped to 0.31 (0.09–1.08) after adjustment for age and sex.</p>
</sec>
<sec id="sec004">
<title>Conclusions</title>
<p>PS models can be created using unstructured information in EHRs. An incremental benefit was observed by matching on PS over traditional matching and adjustment for covariates.</p>
</sec>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Netherlands Organization for Health Research and Development ZonMw</institution>
</funding-source>
<award-id>91896632</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Sturkenboom</surname>
<given-names>Miriam C. J. M.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This study was supported by the VICI project 91896632 of the Netherlands Organization for Health Research and Development ZonMw. Janssen Research and Development provided support in the form of salaries for author MJ.S., but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are articulated in the ‘author contributions’ section.</funding-statement>
</funding-group>
<counts>
<fig-count count="2"/>
<table-count count="3"/>
<page-count count="12"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The authors used data from IPCI, a population based general practice EHR database. It contains routine care data from real practices. The textual free text records may contain sensitive patient information and hence may not be available publicly. A request to access the data can be made to the Department of Medical Informatics, Erasmus MC, The Netherlands at <email xlink:type="simple">mi@erasmusmc.nl</email> and/or <email xlink:type="simple">j.kors@erasmusmc.nl</email>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec005" sec-type="intro">
<title>Introduction</title>
<p>Electronic health records (EHRs) are primarily used for routine medical care, but secondary use of EHR data for observational research is becoming increasingly popular especially in studying of drug effects postmarketing [<xref ref-type="bibr" rid="pone.0212999.ref001">1</xref>]. In this era data is used to generate information on drug safety and effectiveness in a cost-efficient way and by exploiting actual care patterns, which differ largely from experimental settings [<xref ref-type="bibr" rid="pone.0212999.ref002">2</xref>–<xref ref-type="bibr" rid="pone.0212999.ref005">5</xref>]. In an experimental setting such as in randomized clinical trials, the choice for a treatment is randomized, which would take care of potential confounding by indication [<xref ref-type="bibr" rid="pone.0212999.ref006">6</xref>]. In actual care the treatment decision is usually influenced by measurable patient characteristics such as medical history, concomitant drug intake but also by personal prescriber preferences, which cannot be measured easily. This phenomenon of preferential prescribing is also known as channeling and may lead to confounding by indication [<xref ref-type="bibr" rid="pone.0212999.ref007">7</xref>,<xref ref-type="bibr" rid="pone.0212999.ref008">8</xref>]. A well-known example of channeling is the preference of doctors to prescribe selective cyclo-oxygenase-2 inhibitors (COX-2 inhibitors) over nonselective (ns) non-steroidal anti-inflammatory drugs (NSAIDs) to patients at risk of developing upper gastrointestinal bleeding (UGIB) [<xref ref-type="bibr" rid="pone.0212999.ref009">9</xref>,<xref ref-type="bibr" rid="pone.0212999.ref010">10</xref>], as the COX-2 inhibitors were developed on purpose to mitigate the GI effects of NSAIDs. Although clinical trials showed that COX-2 inhibitors are ‘safer’ than nsNSAIDs in relation to UGIB [<xref ref-type="bibr" rid="pone.0212999.ref011">11</xref>], observational studies showed no large differences between the rate of UGIB between COX-2 inhibitor and nsNSAIDs, possibly due to residual confounding by indications arising from channeling [<xref ref-type="bibr" rid="pone.0212999.ref012">12</xref>]. In order to obtain unbiased estimates in observational studies this confounding must be dealt with adequately. However, it is challenging to capture all relevant channeling factors in the EHR databases because information is not primarily recorded for research purposes. Moreover, relevant information may also be recorded in EHRs in an unstructured way [<xref ref-type="bibr" rid="pone.0212999.ref013">13</xref>,<xref ref-type="bibr" rid="pone.0212999.ref014">14</xref>].</p>
<p>Attempts to construct methods that deal with confounding have resulted in the propensity score method, the propensity score is an estimated conditional probability of receiving one particular treatment over another given a set of measured covariates [<xref ref-type="bibr" rid="pone.0212999.ref015">15</xref>], it can be regarded as a comprehensive way to look at channeling. Propensity score methods can be used to control for the unbalance between the treatment groups in order to estimate the comparative effectiveness of treatments [<xref ref-type="bibr" rid="pone.0212999.ref015">15</xref>]. Four different methods of using the propensity to reduce confounding have been described [<xref ref-type="bibr" rid="pone.0212999.ref016">16</xref>]: 1) matching on propensity score; 2) stratification on the propensity score; 3) inverse probability of treatment weighting using the propensity score; 4) and covariate adjustment using the propensity score. Typically, all variables related to either the outcome and/or exposure, are included in the propensity score model [<xref ref-type="bibr" rid="pone.0212999.ref017">17</xref>,<xref ref-type="bibr" rid="pone.0212999.ref018">18</xref>], sometimes these variables are not the exact confounding factors but proxies thereof [<xref ref-type="bibr" rid="pone.0212999.ref019">19</xref>]. Yet, identifying appropriate proxies in large EHRs is challenging. Schneeweiss <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0212999.ref020">20</xref>] proposed a high-dimensional propensity score (hd-PS) algorithm to empirically identify a large number of relevant covariates, with high prevalence, to control for confounding. In a case study on coxibs and NSAIDs using claims data in the USA, application of the hd-PS algorithm to control for confounding was found to produce an effect estimate for the risk of upper GI complications between coxibs vs. NSAIDs that was comparable to the one found in randomized trials [<xref ref-type="bibr" rid="pone.0212999.ref021">21</xref>]. The hd-PS model is constructed by using many covariates of which some could serve as proxies for unobserved factors that otherwise may not be considered. Typically, only structured information such as diagnostic or procedure codes that is available in the claims databases, are included in the model. Rassen et al. [<xref ref-type="bibr" rid="pone.0212999.ref022">22</xref>] evaluated whether adding two-word phrases, present in patients’ unstructured free-text data, to the propensity score model could improve validity of pharmacoepidemiology studies. Adjusting for two-word phrases resulted in an improvement in confounding adjustment. Electronic health records comprise much unstructured data and we propose that this information could also be used as proxies for potential confounding factors.</p>
<p>The aim of this study was therefore to assess whether unstructured text in EHRs can be used to construct a propensity score model that would allow to properly deal with confounding. We assessed the performance of propensity score models in addressing confounding by indication using as an example the association between selective COX-2 inhibitors and nonselective NSAIDs in relation to upper gastrointestinal bleeding.</p>
</sec>
<sec id="sec006" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec007">
<title>Data source</title>
<p>We used data from the Dutch Integrated Primary Care Information database (IPCI) [<xref ref-type="bibr" rid="pone.0212999.ref023">23</xref>], a population-based general practice EHR database. This database contains prospectively collected routine care data representing real-life practice. In the Netherlands, all citizens are registered with a general practitioner (GP), who acts as a gatekeeper to secondary and tertiary medical care. IPCI contains information on more than 1.8 million patients from 340 GP practices. For each individual person, all relevant medical information from primary and secondary care is documented in the medical record. Apart from patient demographics, the recorded information in the EHRs contain medical notes (including symptoms, physical examination, assessments and diagnoses), drug prescriptions, laboratory results, referrals for hospitalization or specialist care, and hospital discharge summaries. In the IPCI database, drug prescriptions are recoded according to the Anatomical Therapeutical Chemical (ATC) classification for research purposes [<xref ref-type="bibr" rid="pone.0212999.ref024">24</xref>]. Diagnoses are coded according to the International Classification for Primary Care (ICPC) [<xref ref-type="bibr" rid="pone.0212999.ref025">25</xref>]. Almost 60% of the medical record are clinical narratives, which do not contain coded information, but contain important information such as patient-reported symptoms and notes from the GP.</p>
</sec>
<sec id="sec008">
<title>Selection of NSAID cohort</title>
<p>We created a cohort of all new adult (≥18 years) users of NSAIDs between 1996 and 2013. Patients had to be enrolled for at least one year in the database in order to be eligible for cohort entry. ATC codes used for NSAID exposure are presented in <xref ref-type="supplementary-material" rid="pone.0212999.s001">S1 Table</xref>. Within the NSAID cohort we created episodes of ‘new’ NSAID use according to the following criteria: (a) at least six months of data available before NSAID exposure, (b) no prescription of any nonselective NSAID or selective COX-2 inhibitor in the previous six months (c) no mentioning of drug names, in the free-text, corresponding with NSAID-related ATC codes in the previous six months. The duration of a prescription was calculated by dividing the prescribed quantity by daily dose regimen. An NSAID episode continued when consecutive NSAID prescriptions started before or within 30 days of the end of the duration of the previous prescription. The end of the episode was defined as the end of the last NSAID prescription (see <xref ref-type="fig" rid="pone.0212999.g001">Fig 1</xref>). Episodes were classified as an nsNSAID or COX-2 inhibitor episode based on the first prescription in that episode being an nsNSAID or a COX-2 inhibitor, respectively. If a patient switched between exposure (from COX-2 inhibitor to nsNSAID or vice versa), the duration of the NSAID episode was ended at the switch of the exposure. A patient could have multiple NSAID episodes, but only if the above-mentioned criteria were met.</p>
<fig id="pone.0212999.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0212999.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Episode selection.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0212999.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Selection of upper gastrointestinal bleeding patients</title>
<p>Within the cohort of new NSAID users we identified all potential subjects who experienced an upper gastrointestinal bleeding (UGIB) via an automated search [<xref ref-type="bibr" rid="pone.0212999.ref026">26</xref>]. UGIB was defined as all forms of ulcer complications such as bleeding, perforation, or obstruction. The entire medical record of all potential UGIB patients was extensively reviewed to ensure the diagnosis and the date of onset. Any other cause of UGIB (such as variceal bleeding or Mallory Weiss bleeding) was excluded. The date of UGIB was determined as the date of first mentioning of symptoms leading to the UGIB diagnosis or if this date was unknown, the date of diagnosis.</p>
</sec>
<sec id="sec010">
<title>Propensity score model</title>
<p>A propensity model was fitted using all information (structured and unstructured) in the EHR. To reduce the number of potential variables we first converted all text to lowercase after which we removed special characters, words not starting with a letter or a digit, stop words (such as <italic>de</italic>, <italic>het–</italic>the article <italic>the</italic> in English), and punctuation. All unique words (also known as unigrams) in the 6 months prior to cohort entry were extracted and used as textual features (potential covariates). This approach is commonly known as bag-of-words (BoW) model. We tested two methods to limit the number of covariates that would be included in the regression. The first method generated models using covariates of which the frequency in the cohort was above a certain threshold, e.g., 1000 without any further selection. In the second method, we generated a model using covariates that were associated with the outcome. The chi-square test was used to select covariates that were statistically significantly associated with the outcome (p-value less than 0.05). Another propensity model (method 3) was added for comparison, where only the established confounders (i.e. age, sex, and the exposure to low-dose aspirin) were included in the propensity score model. We used patients’ prescription information to calculate exposure to low-dose aspirin.</p>
<p>The selected features were subsequently used in a large-scale regularized regression using a LaPlace prior [<xref ref-type="bibr" rid="pone.0212999.ref027">27</xref>] with the hyper-parameter of 0.01 to construct a propensity model for each method. We experimented with several hyper-parameters and results of each are presented in the <xref ref-type="supplementary-material" rid="pone.0212999.s004">S4 Table</xref>. The advantage of using a regularized regression is that it can handle high-dimensional data. A flowchart depicting the process of propensity score model generation (for methods 1 and 2) is presented in <xref ref-type="fig" rid="pone.0212999.g002">Fig 2</xref>.</p>
<fig id="pone.0212999.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0212999.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Flowchart showing the process of generating a propensity score model from unstructured free-text.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0212999.g002" xlink:type="simple"/>
</fig>
<p>We used three-fold cross-validation [<xref ref-type="bibr" rid="pone.0212999.ref028">28</xref>] to evaluate the predictive accuracy of the models. The data set was randomly divided in three equally-sized subsets or folds. In three cross-validation runs, each time, the model was successively trained on two folds and tested on the third fold. For each cross-validation run, an area under the receiver operating characteristic curve (AUC) was calculated. The averaged AUC was used as the overall performance measure.</p>
<sec id="sec011">
<title>One-to-many propensity score matching</title>
<p>The propensity score that was generated in each of the two models was used to account for the preferential prescribing of COX-2 inhibitors to patients at high-risk of developing an UGIB [<xref ref-type="bibr" rid="pone.0212999.ref012">12</xref>]. In this study, we used the greedy one-to-many matching as described by Rassen et al. [<xref ref-type="bibr" rid="pone.0212999.ref029">29</xref>]:</p>
<list list-type="order">
<list-item><p>For each COX-2 inhibitor cohort member the difference in PS with each nsNSAID users was computed</p></list-item>
<list-item><p>Starting with the lowest difference, each COX-2 inhibitor cohort member was matched with one nsNSAID cohort member. Once an nsNSAID user was matched, he or she was precluded from further matching. A caliper of 0.01 was used, meaning no matches were made if the difference in PS was greater than 0.01.</p></list-item>
<list-item><p>After all COX-2 inhibitor cohort members were matched with one nsNSAID cohort member, the process was repeated until all nsNSAID users were matched or there was no match possible.</p></list-item>
</list>
<p>The algorithm ensured that all COX-2 inhibitor cohort members were matched with at least one nsNSAID cohort member if such a match was available within the caliper.</p>
</sec>
</sec>
<sec id="sec012">
<title>Statistical analysis</title>
<p>To estimate the risk of UGIB among COX-2 inhibitor users compared to nsNSAID users we calculated hazard ratios with their corresponding 95% confidence intervals (CIs) using Cox proportional hazard regression. We conducted the analysis for four datasets: 1) a crude comparison (unmatched, no propensity score); 2) matched on age (± 2 years) and adjusted for sex and exposure to low-dose aspirin, no propensity score; 3) matched on PS with covariate frequency above 1000 and then adjusted for age, sex, and exposure to low-dose aspirin; and 4) matched on PS with covariates having an association with the outcome and then adjustment for age, sex, and exposure to low-dose aspirin.</p>
</sec>
</sec>
<sec id="sec013" sec-type="results">
<title>Results</title>
<sec id="sec014">
<title>NSAID cohort</title>
<p>From the source population of more than 1.8 million patients we identified 518,768 new users of NSAIDs based on ATC codes. We then processed the unstructured free-text in the entries of the new users to identify mentioning of drug names corresponding with NSAID-related ATC codes. In total, 36,188 new users were removed because either an nsNSAID or COX-2 inhibitor drug was mentioned in the free-text in the six months preceding first NSAID exposure. This resulted in 482,580 new NSAID users in the study cohort. Out of these, 459,701 (95%) were nsNSAID users and 22,879 (5%) were COX-2 inhibitor users.</p>
<p>Within the NSAID cohort we retrieved 11,994 potential UGIB patients. After reviewing the medical records we retained 1,048 UGIBs.</p>
<p>The average duration of episodes for initiators of COX-2 inhibitors was 94 days and 66 days for initiators of nsNSAIDs. Baseline characteristics of initiators of COX-2 inhibitors and nsNSAIDs are shown in <xref ref-type="table" rid="pone.0212999.t001">Table 1</xref>. Most of the episodes of COX-2 inhibitors and nsNSAIDs were started after the year 2004.</p>
<table-wrap id="pone.0212999.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0212999.t001</object-id>
<label>Table 1</label> <caption><title>Baseline characteristics of initiators of selective COX-2 inhibitors or nsNSAIDs.</title></caption>
<alternatives>
<graphic id="pone.0212999.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0212999.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Characteristics</th>
<th align="center" colspan="2">%</th>
</tr>
<tr>
<th align="left"/>
<th align="center">COX-2 initiators<break/>(n = 22,879)</th>
<th align="center">nsNSAID initiators<break/>(n = 459,701)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Age (mean)</td>
<td align="center">57.7</td>
<td align="center">47.9</td>
</tr>
<tr>
<td align="left">Male</td>
<td align="center">36.5</td>
<td align="center">43.2</td>
</tr>
<tr>
<td align="left">Female</td>
<td align="center">63.5</td>
<td align="center">56.8</td>
</tr>
<tr>
<td align="left">Exposure to low-dose aspirin</td>
<td align="center">2.8</td>
<td align="center">1.1</td>
</tr>
<tr>
<td align="left">Age (years)</td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="left">    &lt; = 30</td>
<td align="center">6.5</td>
<td align="center">17.3</td>
</tr>
<tr>
<td align="left">    31–40</td>
<td align="center">8.4</td>
<td align="center">16.1</td>
</tr>
<tr>
<td align="left">    41–50</td>
<td align="center">17.7</td>
<td align="center">22.4</td>
</tr>
<tr>
<td align="left">    51–60</td>
<td align="center">22.4</td>
<td align="center">19.7</td>
</tr>
<tr>
<td align="left">    61–70</td>
<td align="center">20.8</td>
<td align="center">13.8</td>
</tr>
<tr>
<td align="left">    71–80</td>
<td align="center">15.9</td>
<td align="center">7.7</td>
</tr>
<tr>
<td align="left">    &gt; 80</td>
<td align="center">8.3</td>
<td align="center">3.0</td>
</tr>
<tr>
<td align="left">Calendar year of treatment initiation</td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="left">    before 2003</td>
<td align="center">0.1</td>
<td align="center">10.8</td>
</tr>
<tr>
<td align="left">    2003</td>
<td align="center">1.4</td>
<td align="center">2.0</td>
</tr>
<tr>
<td align="left">    2004</td>
<td align="center">3.1</td>
<td align="center">1.9</td>
</tr>
<tr>
<td align="left">    2005</td>
<td align="center">1.6</td>
<td align="center">1.9</td>
</tr>
<tr>
<td align="left">    2006</td>
<td align="center">1.5</td>
<td align="center">1.3</td>
</tr>
<tr>
<td align="left">    2007</td>
<td align="center">2.6</td>
<td align="center">2.3</td>
</tr>
<tr>
<td align="left">    2008</td>
<td align="center">7.3</td>
<td align="center">6.7</td>
</tr>
<tr>
<td align="left">    2009</td>
<td align="center">11.5</td>
<td align="center">12.3</td>
</tr>
<tr>
<td align="left">    2010</td>
<td align="center">15.6</td>
<td align="center">16.4</td>
</tr>
<tr>
<td align="left">    2011</td>
<td align="center">22.7</td>
<td align="center">20.6</td>
</tr>
<tr>
<td align="left">    2012</td>
<td align="center">30.7</td>
<td align="center">22.7</td>
</tr>
<tr>
<td align="left">    2013</td>
<td align="center">1.9</td>
<td align="center">1.1</td>
</tr>
<tr>
<td align="left">UGI risk factors</td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="left">    Use of antiplatelets</td>
<td align="center">6.3</td>
<td align="center">3.2</td>
</tr>
<tr>
<td align="left">    Use of anticoagulants</td>
<td align="center">3.2</td>
<td align="center">1.3</td>
</tr>
<tr>
<td align="left">    Use of gastroprotective agents</td>
<td align="center">23.4</td>
<td align="center">11.8</td>
</tr>
<tr>
<td align="left">Other comorbidities</td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="left">    Dyspepsia</td>
<td align="center">0.2</td>
<td align="center">0.2</td>
</tr>
<tr>
<td align="left">    Smoking</td>
<td align="center">0.5</td>
<td align="center">0.5</td>
</tr>
<tr>
<td align="left">    Heart failure</td>
<td align="center">0.4</td>
<td align="center">0.2</td>
</tr>
<tr>
<td align="left">    Diabetes mellitus</td>
<td align="center">0.5</td>
<td align="center">0.3</td>
</tr>
<tr>
<td align="left">Concomitant use of other medication</td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="left">    SSRIs</td>
<td align="center">4.4</td>
<td align="center">3.3</td>
</tr>
<tr>
<td align="left">    Spironolactone</td>
<td align="center">0.7</td>
<td align="center">0.3</td>
</tr>
<tr>
<td align="left">    Calcium channel blockers</td>
<td align="center">7.2</td>
<td align="center">3.7</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec015">
<title>Propensity model</title>
<p>In total, we extracted 2,762,326 covariates (i.e., unique words, out of almost 96 million words) from approximately 2.4 million entries in the 6 months prior to NSAID episodes from the medical records of 482,580 new NSAID users.</p>
<p><xref ref-type="table" rid="pone.0212999.t002">Table 2</xref> shows the performance of the propensity models built using different covariates selection methods. The first model used all covariates with a frequency of 100 or more in the cohort, which resulted in 95,078 unique covariates entered into the model. Increasing the frequency to 1,000 resulted in a reduction of the number of covariates to 27,619. The number of covariates further reduced when frequency was increased to 5,000. The performance of the models in terms of their predictive accuracy was comparable. The predictive performance of the propensity model that was built using 3,650 covariates that had an association with the outcome according to the chi-square test. This resulted in an AUC of 70.59. The performance of the propensity model that included only the established confounders resulted in an AUC of 66.27. The number of covariates in the models however were only 111.</p>
<table-wrap id="pone.0212999.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0212999.t002</object-id>
<label>Table 2</label> <caption><title>Predictive performance of different propensity models.</title></caption>
<alternatives>
<graphic id="pone.0212999.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0212999.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"><bold>PS Model</bold></th>
<th align="left"/>
<th align="center"><bold>Number of covariates</bold></th>
<th align="center"><bold>AUC</bold><xref ref-type="table-fn" rid="t002fn001">*</xref></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"/>
<td align="left">Covariate filtered on frequency ≥ 100</td>
<td align="center">95,078</td>
<td align="center">72.27</td>
</tr>
<tr>
<td align="left">Method 1</td>
<td align="left">Covariate filtered on frequency ≥ 1,000</td>
<td align="center">27,619</td>
<td align="center">72.32</td>
</tr>
<tr>
<td align="left" rowspan="2">Method 2</td>
<td align="left">Covariate filtered on frequency ≥ 5,000</td>
<td align="center">11,699</td>
<td align="center">72.17</td>
</tr>
<tr>
<td align="left">Covariates filtered using Chi-square test (independent of frequency)</td>
<td align="center">3,650</td>
<td align="center">70.59</td>
</tr>
<tr>
<td align="left">Method 3</td>
<td align="left">Only established confounders (age, sex, and exposure to low-dose aspirin)</td>
<td align="center">111</td>
<td align="center">66.27</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p>* AUC, area under the receiver operating characteristic curve</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec016">
<title>Risk of upper gastrointestinal bleeding</title>
<p>The crude hazard ratio of UGIB for COX-2 inhibitors compared to nsNSAIDs was 0.50 (95% 0.18–1.36) (<xref ref-type="table" rid="pone.0212999.t003">Table 3</xref>). When matched on age, the hazard ratio of COX-2 inhibitor use compared to nsNSAID use was 0.36 (95% CI: 0.11–1.16). Further adjusting for sex and exposure to low-dose aspirin resulted in HR of 0.35 and 0.36 respectively. Matching on PS only, using one-to-many matching with a covariate frequency above 1,000, reduced the hazard ratio to 0.42 (95% CI: 0.13–1.38). Subsequent adjustment for age resulted in a hazard ratio of 0.36 (95% CI: 0.10–1.22). Matching on PS limiting to covariates that were associated to the outcome also provided a hazard ratio of 0.42 (95% CI: 0.13–1.39). Adjusting for age reduced the hazard ratio to 0.32 (95%: 0.09–1.09).</p>
<table-wrap id="pone.0212999.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0212999.t003</object-id>
<label>Table 3</label> <caption><title>Hazard ratios with 95% confidence intervals (CI) comparing COX-2 inhibitors with nsNSAIDs for different matching strategies and adjustments.</title></caption>
<alternatives>
<graphic id="pone.0212999.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0212999.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"><bold>Matching</bold></th>
<th align="center"><bold>Adjustment</bold></th>
<th align="center"><bold>Hazard ratio</bold></th>
<th align="center"><bold>95% CI</bold></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>Unmatched</bold></td>
<td align="left">None</td>
<td align="center">0.50</td>
<td align="center">0.18–1.36</td>
</tr>
<tr>
<td align="left"><bold>Age</bold></td>
<td align="left">None</td>
<td align="center">0.36</td>
<td align="center">0.11–1.16</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Sex</td>
<td align="center">0.35</td>
<td align="center">0.11–1.18</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Sex, Aspirin</td>
<td align="center">0.36</td>
<td align="center">0.11–1.18</td>
</tr>
<tr>
<td align="left" rowspan="5"><bold>Propensity Score (covariate frequencies &gt; = 1000)</bold></td>
<td align="left">None</td>
<td align="center">0.42</td>
<td align="center">0.13–1.38</td>
</tr>
<tr>
<td align="left">Age</td>
<td align="center">0.36</td>
<td align="center">0.10–1.22</td>
</tr>
<tr>
<td align="left">Sex</td>
<td align="center">0.39</td>
<td align="center">0.12–1.30</td>
</tr>
<tr>
<td align="left">Age, Sex</td>
<td align="center">0.35</td>
<td align="center">0.16–1.25</td>
</tr>
<tr>
<td align="left">Sex, Aspirin</td>
<td align="center">0.39</td>
<td align="center">0.12–1.32</td>
</tr>
<tr>
<td align="left" rowspan="5"><break/><bold>Propensity Score</bold><break/><bold>(covariates based on</bold><break/><bold>association test)</bold></td>
<td align="left">None</td>
<td align="center">0.42</td>
<td align="center">0.13–1.39</td>
</tr>
<tr>
<td align="left">Age</td>
<td align="center">0.32</td>
<td align="center">0.09–1.09</td>
</tr>
<tr>
<td align="left">Sex</td>
<td align="center">0.43</td>
<td align="center">0.13–1.42</td>
</tr>
<tr>
<td align="left">Age, Sex</td>
<td align="center">0.31</td>
<td align="center">0.09–1.08</td>
</tr>
<tr>
<td align="left">Sex, Aspirin</td>
<td align="center">0.43</td>
<td align="center">0.13–1.42</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Age, Sex, Aspirin</td>
<td align="center">0.31</td>
<td align="center">0.09–1.10</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The top-25 covariates, in terms of their weights (beta values), from both propensity score models are presented in the <xref ref-type="supplementary-material" rid="pone.0212999.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pone.0212999.s003">S3</xref> Tables.</p>
</sec>
</sec>
<sec id="sec017" sec-type="conclusions">
<title>Discussion</title>
<p>In this study, we generated a propensity model using unstructured information from EHRs. We tested different methods to construct this and demonstrated the feasibility to do so as well as its performance. Since electronic health records are now widely available for secondary use, we need to develop methods and test performance of these methods for use in epidemiological evaluations such as drug effects.</p>
<p>Our method to generate a propensity score model is substantially different from the high-dimensional propensity score (hd-PS) approach proposed by Schneeweiss et al [<xref ref-type="bibr" rid="pone.0212999.ref020">20</xref>]. The hd-PS algorithm that was developed for claims data uses structured information such as diagnostic codes, in-patient procedure codes, and drugs dispensed. In each identified data dimension, the highest ranked codes are selected to enter in the hd-PS model. The use of two-word free-text phrases in addition to the structured information has also been positively evaluated in the context of hd-PS models [<xref ref-type="bibr" rid="pone.0212999.ref022">22</xref>]. Our method is different since we used as the basis all unstructured text to generate propensity models, using a large-scale regularized regression, without pre-identified data dimensions. Several methods other than logistic regression such as data-adaptive and classification trees have been proposed for fitting a propensity model [<xref ref-type="bibr" rid="pone.0212999.ref030">30</xref>]. To reduce the number of ‘meaningless’ features, we needed various textual data cleaning steps. We subsequently extracted all unigrams from the cleaned free-text, which served as potential covariates. Here we applied different approaches, to look at the impact of our choices. In the first method, the most-frequent covariates in the cohort were selected to enter the propensity score model. Since the covariates were selected merely on the basis of their frequency in the cohort, this method is prone to include covariates that may actually be instrumental variables. Instrumental variables have an association with the exposure but not with the outcome except through their effect on exposure. If covariates are included that are not true confounders, the variance increases and sometimes a small amount of bias may be introduced [<xref ref-type="bibr" rid="pone.0212999.ref031">31</xref>–<xref ref-type="bibr" rid="pone.0212999.ref034">34</xref>]. In order to mitigate the potential to include covariates that are instrumental variables we included covariates with a significant association with the outcome to the propensity score model in the second method we applied [<xref ref-type="bibr" rid="pone.0212999.ref031">31</xref>].</p>
<p>We used three-fold cross-validation to evaluate the predictive performance of exposure to nsNSAID or Coxib for each generated PS model. In the first method where covariates were selected based on their frequency, increasing the frequency threshold for covariate selection reduced the number of covariates that entered into the propensity score model but the performance of the models was still comparable. This suggests that the performance of the models was mostly based on a few covariates with high occurrence in the text. Reducing the number of covariates reduced the computation time needed to fit the model. By selecting covariates with an association with the outcome, we significantly reduced the total number of covariates without greatly affecting the performance. The propensity models generated using covariates with only high frequency in the cohort performed better than the one where association with the outcome was verified. This may be due to the presence of some instrumental variables which can result in an increase in predictive performance [<xref ref-type="bibr" rid="pone.0212999.ref030">30</xref>]. We used another propensity model for the comparison purposes where only the established confounders age, sex, and exposure to low-dose aspirin were included. The predictive performance of this model was lower than the other two models which were generated from the free-text covariates. The second method, where covariate association with the outcome was verified, showed large decrease in the hazard ratios after further adjustments. Whereas previous studies have constructed the hd-PS with structured information, such as ICD and READ codes across different data dimensions in different sources [<xref ref-type="bibr" rid="pone.0212999.ref019">19</xref>–<xref ref-type="bibr" rid="pone.0212999.ref021">21</xref>,<xref ref-type="bibr" rid="pone.0212999.ref035">35</xref>], large proportions of information may be unstructured. We showed that this unstructured free-text can be used to construct propensity models. Initially, the new user cohort was created based on the prescription tables containing ATC codes. A high number of removals (7%) from the cohort based on the drug mentioned in the free-text indicates the importance of processing unstructured free-text instead of only relying on the structured information.</p>
<p>Our study also has several limitations. First, by including covariates based on their frequencies we might have selected covariates that are not necessarily related to the outcome or the exposure, which could introduce bias [<xref ref-type="bibr" rid="pone.0212999.ref018">18</xref>,<xref ref-type="bibr" rid="pone.0212999.ref036">36</xref>]. Second, since we only used unigrams, covariates like ‘<italic>congestive heart failure’</italic> cannot be recognized as such. Instead it will be recognized as individual words ‘<italic>congestive’</italic>, <italic>‘heart’</italic>, and ‘<italic>failure’</italic>, which might lead to over- and underestimation of some covariates. Like previous studies using hd-PS methods, we also used the known association between NSAIDs and UGIB as an example. It is unclear whether our findings regarding the PS generated from unstructured free-text apply to other treatment-outcome pairs. Since the PS algorithm in general relies on the information present in the cohort, a similar approach using a different data set might have different results even when using known example of NSAID-UGIB.</p>
<p>The majority of COX-2 inhibitor episodes started after the year 2004, the period after the withdrawal of rofecoxib from the market because of cardiovascular risks [<xref ref-type="bibr" rid="pone.0212999.ref037">37</xref>]. This may explain the strong protective effect of COX-2 inhibitors in the crude analysis which we would expect, but is different from previous observational studies that were done more closely to the introduction of coxibs [<xref ref-type="bibr" rid="pone.0212999.ref019">19</xref>–<xref ref-type="bibr" rid="pone.0212999.ref021">21</xref>,<xref ref-type="bibr" rid="pone.0212999.ref035">35</xref>]. Since most of our patients started after the contra-indications were introduced, channeling towards high risk patients was less of an issue [<xref ref-type="bibr" rid="pone.0212999.ref038">38</xref>].</p>
<p>In conclusion, our study showed that PS models can be created using unstructured information in electronic healthcare records. We also showed that the PS model where covariates were filtered on their association with the outcome provide an improvement in adjustment for confounding. This is useful for database studies using a large amount of unstructured free-text as in EHRs. Better methods for extracting meaningful covariates from the free-text may be required for effective proxy adjustment via propensity scores.</p>
</sec>
<sec id="sec018">
<title>Supporting information</title>
<supplementary-material id="pone.0212999.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0212999.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>List of ATC codes used for NSAID exposure assessment.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0212999.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0212999.s002" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Top 25 covariates by their weights selected by the regression model (covariates frequency &gt; 1000).</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0212999.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0212999.s003" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Top 25 covariates by their weights selected by the regression model (chi-square test).</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0212999.s004" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0212999.s004" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>All tested hyper-parameters with AUCs for training and test sets.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pone.0212999.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Strom</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Carson</surname> <given-names>J</given-names></name>. <article-title>Automated databases used for pharmacoepidemiology research</article-title>. <source>Clin Pharmacol Ther</source>. <year>1989</year>;<volume>46</volume>: <fpage>390</fpage>–<lpage>394</lpage>. <object-id pub-id-type="pmid">2535648</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Linder</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Haas</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Iyer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Labuzetta</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Ibara</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Celeste</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Secondary use of electronic health record data: spontaneous triggered adverse drug event reporting</article-title>. <source>Pharmacoepidemiol Drug Saf</source>. <year>2010</year>;<volume>19</volume>: <fpage>1211</fpage>–<lpage>1215</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/pds.2027" xlink:type="simple">10.1002/pds.2027</ext-link></comment> <object-id pub-id-type="pmid">21155192</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Allen-Dicker</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Klompas</surname> <given-names>M</given-names></name>. <article-title>Comparison of electronic laboratory reports, administrative claims, and electronic health record data for acute viral hepatitis surveillance</article-title>. <source>J Public Health Manag Pract</source>. <year>2012</year>;<volume>18</volume>: <fpage>209</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1097/PHH.0b013e31821f2d73" xlink:type="simple">10.1097/PHH.0b013e31821f2d73</ext-link></comment> <object-id pub-id-type="pmid">22473112</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schneeweiss</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Avorn</surname> <given-names>J</given-names></name>. <article-title>A review of uses of health care utilization databases for epidemiologic research on therapeutics</article-title>. <source>J Clin Epidemiol</source>. <year>2005</year>;<volume>58</volume>: <fpage>323</fpage>–<lpage>337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jclinepi.2004.10.012" xlink:type="simple">10.1016/j.jclinepi.2004.10.012</ext-link></comment> <object-id pub-id-type="pmid">15862718</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Suissa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Garbe</surname> <given-names>E</given-names></name>. <article-title>Primer: administrative health databases in observational studies of drug effects—advantages and disadvantages</article-title>. <source>Nat Clin Pract Rheumatol</source>. <year>2007</year>;<volume>3</volume>: <fpage>725</fpage>–<lpage>732</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncprheum0652" xlink:type="simple">10.1038/ncprheum0652</ext-link></comment> <object-id pub-id-type="pmid">18037932</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salas</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hofman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stricker</surname> <given-names>BH</given-names></name>. <article-title>Confounding by Indication: An Example of Variation in the Use of Epidemiologic Terminology</article-title>. <source>Am J Epidemiol</source>. <year>1999</year>;<volume>149</volume>: <fpage>981</fpage>–<lpage>983</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/oxfordjournals.aje.a009758" xlink:type="simple">10.1093/oxfordjournals.aje.a009758</ext-link></comment> <object-id pub-id-type="pmid">10355372</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref007"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Walker AM. Confounding by indication. Epidemiology. 1996;7: 335–336. Available: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/8793355" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/8793355</ext-link></mixed-citation></ref>
<ref id="pone.0212999.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mosis</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Stijnen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Castellsague</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dieleman</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>van der Lei</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stricker</surname> <given-names>BHC</given-names></name>, <etal>et al</etal>. <article-title>Channeling and prevalence of cardiovascular contraindications in users of cyclooxygenase 2 selective nonsteroidal antiinflammatory drugs</article-title>. <source>Arthritis Rheum</source>. <year>2006</year>;<volume>55</volume>: <fpage>537</fpage>–<lpage>542</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/art.22096" xlink:type="simple">10.1002/art.22096</ext-link></comment> <object-id pub-id-type="pmid">16874797</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Masclee</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Valkhoff</surname> <given-names>VE</given-names></name>, <name name-style="western"><surname>Coloma</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>de Ridder</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Romio</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schuemie</surname> <given-names>MJ</given-names></name>, <etal>et al</etal>. <article-title>Risk for Upper Gastrointestinal Bleeding from Different Drug Combinations</article-title>. <source>Gastroenterology</source>. <year>2014</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1053/j.gastro.2014.06.007" xlink:type="simple">10.1053/j.gastro.2014.06.007</ext-link></comment> <object-id pub-id-type="pmid">24937265</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moride</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ducruet</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Boivin</surname> <given-names>J-F</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Perreault</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>S</given-names></name>. <article-title>Prescription channeling of COX-2 inhibitors and traditional nonselective nonsteroidal anti-inflammatory drugs: a population-based case-control study</article-title>. <source>Arthritis Res Ther</source>. <year>2005</year>;<volume>7</volume>: <fpage>R333</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/ar1488" xlink:type="simple">10.1186/ar1488</ext-link></comment> <object-id pub-id-type="pmid">15743481</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bhala</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Emberson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Merhi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Abramson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Arber</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Baron</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Vascular and upper gastrointestinal effects of non-steroidal anti-inflammatory drugs: meta-analyses of individual participant data from randomised trials</article-title>. <source>Lancet</source>. <year>2013</year>;<volume>382</volume>: <fpage>769</fpage>–<lpage>779</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0140-6736(13)60900-9" xlink:type="simple">10.1016/S0140-6736(13)60900-9</ext-link></comment> <object-id pub-id-type="pmid">23726390</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van Soest</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Valkhoff</surname> <given-names>VE</given-names></name>, <name name-style="western"><surname>Mazzaglia</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Schade</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Molokhia</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goldstein</surname> <given-names>JL</given-names></name>, <etal>et al</etal>. <article-title>Suboptimal gastroprotective coverage of NSAID use and the risk of upper gastrointestinal bleeding and ulcers: an observational study using three European databases</article-title>. <source>Gut</source>. <year>2011</year>;<volume>60</volume>: <fpage>1650</fpage>–<lpage>1659</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1136/gut.2011.239848" xlink:type="simple">10.1136/gut.2011.239848</ext-link></comment> <object-id pub-id-type="pmid">21636644</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ford</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Carroll</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>HE</given-names></name>, <name name-style="western"><surname>Scott</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Cassell</surname> <given-names>JA</given-names></name>. <article-title>Extracting information from the text of electronic medical records to improve case detection: a systematic review</article-title>. <source>J Am Med Informatics Assoc</source>. <year>2016</year>; ocv180. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/jamia/ocv180" xlink:type="simple">10.1093/jamia/ocv180</ext-link></comment> <object-id pub-id-type="pmid">26911811</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yadav</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Steinbach</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kumar</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Simon</surname> <given-names>G</given-names></name>. <article-title>Mining Electronic Health Records: A Survey</article-title>. <source>ACM Comput Surv</source>. <year>2016</year>;<volume>1</volume>: <fpage>1</fpage>–<lpage>41</lpage>. doi: 1539-9087/2016/04-ART1</mixed-citation></ref>
<ref id="pone.0212999.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rosenbaum</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>D</given-names></name>. <article-title>The central role of the propensity score in observational studies for causal effects</article-title>. <source>Biometrika</source>. <year>1983</year>;<volume>70</volume>: <fpage>41</fpage>–<lpage>55</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://biomet.oxfordjournals.org/content/70/1/41.short" xlink:type="simple">http://biomet.oxfordjournals.org/content/70/1/41.short</ext-link></mixed-citation></ref>
<ref id="pone.0212999.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Austin</surname> <given-names>PC</given-names></name>. <article-title>An Introduction to Propensity Score Methods for Reducing the Effects of Confounding in Observational Studies</article-title>. <source>Multivariate Behav Res</source>. <year>2011</year>;<volume>46</volume>: <fpage>399</fpage>–<lpage>424</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/00273171.2011.568786" xlink:type="simple">10.1080/00273171.2011.568786</ext-link></comment> <object-id pub-id-type="pmid">21818162</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <article-title>Estimating causal effects from large data sets using propensity scores</article-title>. <source>Ann Intern Med</source>. <year>1997</year>;<volume>127</volume>: <fpage>757</fpage>–<lpage>763</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/sim.3554" xlink:type="simple">10.1002/sim.3554</ext-link></comment> <object-id pub-id-type="pmid">9382394</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brookhart</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Schneeweiss</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rothman</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Glynn</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Avorn</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stürmer</surname> <given-names>T</given-names></name>. <article-title>Variable selection for propensity score models</article-title>. <source>Am J Epidemiol</source>. <year>2006</year>;<volume>163</volume>: <fpage>1149</fpage>–<lpage>1156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/aje/kwj149" xlink:type="simple">10.1093/aje/kwj149</ext-link></comment> <object-id pub-id-type="pmid">16624967</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Toh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Hernan</surname> <given-names>MA</given-names></name>. <article-title>Confounding adjustment via a semi‐automated high‐dimensional propensity score algorithm: an application to electronic medical records</article-title>. <source>Pharmacoepidemiol Drug Saf</source>. <year>2011</year>;<volume>20</volume>: <fpage>849</fpage>–<lpage>857</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/pds.2152" xlink:type="simple">10.1002/pds.2152</ext-link></comment> <object-id pub-id-type="pmid">21717528</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schneeweiss</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rassen</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Glynn</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Avorn</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mogun</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Brookhart</surname> <given-names>MA</given-names></name>. <article-title>High-dimensional propensity score adjustment in studies of treatment effects using health care claims data</article-title>. <source>Epidemiology</source>. <year>2009</year>;<volume>20</volume>: <fpage>512</fpage>–<lpage>522</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1097/EDE.0b013e3181a663cc" xlink:type="simple">10.1097/EDE.0b013e3181a663cc</ext-link></comment> <object-id pub-id-type="pmid">19487948</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Garbe</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kloss</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Suling</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pigeot</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Schneeweiss</surname> <given-names>S</given-names></name>. <article-title>High-dimensional versus conventional propensity scores in a comparative effectiveness study of coxibs and reduced upper gastrointestinal complications</article-title>. <source>Eur J Clin Pharmacol</source>. <year>2013</year>;<volume>69</volume>: <fpage>549</fpage>–<lpage>557</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00228-012-1334-2" xlink:type="simple">10.1007/s00228-012-1334-2</ext-link></comment> <object-id pub-id-type="pmid">22763756</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref022"><label>22</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Rassen</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Wahl</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Angelino</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Seltzer</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Rosenman</surname> <given-names>MD</given-names></name>. <chapter-title>Automated Use of Electronic Health Record Text Data To Improve Validity in Pharmacoepidemiology Studies</chapter-title>. <source>PHARMACOEPIDEMIOLOGY AND DRUG SAFETY</source>. <publisher-loc>NJ USA</publisher-loc>: <publisher-name>WILEY-BLACKWELL</publisher-name>; <year>2013</year>. p. <fpage>376</fpage>.</mixed-citation></ref>
<ref id="pone.0212999.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vlug</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>van der Lei</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mosseveld</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>van Wijk</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>van der Linden</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>MC</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Postmarketing surveillance based on electronic patient records: the IPCI project</article-title>. <source>Methods Inf Med</source>. <year>1999</year>;<volume>38</volume>: <fpage>339</fpage>–<lpage>344</lpage>. <object-id pub-id-type="pmid">10805025</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref024"><label>24</label><mixed-citation publication-type="other" xlink:type="simple">WHO Collaborating Centre for Drug Statistics Methodology. Guidelines for ATC classification and DDD assignment [Internet]. Available: <ext-link ext-link-type="uri" xlink:href="http://www.whocc.no/atcddd/" xlink:type="simple">http://www.whocc.no/atcddd/</ext-link></mixed-citation></ref>
<ref id="pone.0212999.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lamberts</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wood</surname> <given-names>M</given-names></name>. <article-title>ICPC: International Classification of Primary Care</article-title>. <name name-style="western"><surname>Lamberts</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wood</surname> <given-names>M</given-names></name>, editors. <source>Scand J Prim Health Care</source>. Oxford University Press; <year>1987</year>. p. <fpage>204</fpage>.</mixed-citation></ref>
<ref id="pone.0212999.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Afzal</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Schuemie</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>van Blijderveen</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Sen</surname> <given-names>EF</given-names></name>, <article-title>Sturkenboom MCJM, Kors J a. Improving sensitivity of machine learning methods for automated case identification from free-text electronic medical records</article-title>. <source>BMC Med Inform Decis Mak</source>. BMC Medical Informatics and Decision Making; <year>2013</year>;<volume>13</volume>: <fpage>30</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1472-6947-13-30" xlink:type="simple">10.1186/1472-6947-13-30</ext-link></comment> <object-id pub-id-type="pmid">23452306</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Genkin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>DD</given-names></name>, <name name-style="western"><surname>Madigan</surname> <given-names>D</given-names></name>. <article-title>Large-Scale Bayesian Logistic Regression for Text Categorization</article-title>. <source>Technometrics</source>. <year>2007</year>;<volume>49</volume>: <fpage>291</fpage>–<lpage>304</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1198/004017007000000245" xlink:type="simple">10.1198/004017007000000245</ext-link></comment></mixed-citation></ref>
<ref id="pone.0212999.ref028"><label>28</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Mosteller</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Tukey</surname> <given-names>JW</given-names></name>. <chapter-title>Data Analysis, Including Statistics</chapter-title>. In: <name name-style="western"><surname>Lindzey</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Aronson</surname> <given-names>E</given-names></name>, editors. <source>The handbook of social psychology: Vol 2 Research methods</source>. <publisher-loc>Reading, MA</publisher-loc>: <publisher-name>Addison-Wesley</publisher-name>; <year>1968</year>. pp. <fpage>80</fpage>–<lpage>203</lpage>.</mixed-citation></ref>
<ref id="pone.0212999.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rassen</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Shelat</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Glynn</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Rothman</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Schneeweiss</surname> <given-names>S</given-names></name>. <article-title>One-to-many propensity score matching in cohort studies</article-title>. <year>2012</year>;<volume>21</volume>: <fpage>69</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/pds.3263" xlink:type="simple">10.1002/pds.3263</ext-link></comment> <object-id pub-id-type="pmid">22552982</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pirracchio</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>van der Laan</surname> <given-names>M</given-names></name>. <article-title>Improving Propensity Score Estimators’ Robustness to Model Misspecification Using Super Learner</article-title>. <source>Am J Epidemiol</source>. <year>2015</year>;<volume>181</volume>: <fpage>108</fpage>–<lpage>119</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/aje/kwu253" xlink:type="simple">10.1093/aje/kwu253</ext-link></comment> <object-id pub-id-type="pmid">25515168</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Myers</surname> <given-names>J a</given-names></name>., <name name-style="western"><surname>Rassen</surname> <given-names>J a</given-names></name>., <name name-style="western"><surname>Gagne</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Huybrechts</surname> <given-names>KF</given-names></name>, <name name-style="western"><surname>Schneeweiss</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rothman</surname> <given-names>KJ</given-names></name>, <etal>et al</etal>. <article-title>Effects of adjusting for instrumental variables on bias and precision of effect estimates</article-title>. <source>Am J Epidemiol</source>. <year>2011</year>;<volume>174</volume>: <fpage>1213</fpage>–<lpage>1222</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/aje/kwr364" xlink:type="simple">10.1093/aje/kwr364</ext-link></comment> <object-id pub-id-type="pmid">22025356</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brookhart</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Stürmer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Glynn</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Rassen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schneeweiss</surname> <given-names>S</given-names></name>. <article-title>Confounding control in healthcare database research: challenges and potential approaches</article-title>. <source>Med Care</source>. <year>2010</year>;<volume>48</volume>: <fpage>S114</fpage>–<lpage>S120</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1097/MLR.0b013e3181dbebe3" xlink:type="simple">10.1097/MLR.0b013e3181dbebe3</ext-link></comment> <object-id pub-id-type="pmid">20473199</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rassen</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Schneeweiss</surname> <given-names>S</given-names></name>. <article-title>Using high-dimensional propensity scores to automate confounding control in a distributed medical product safety surveillance system</article-title>. <source>Pharmacoepidemiol Drug Saf</source>. <year>2012</year>;<volume>21</volume>: <fpage>41</fpage>–<lpage>49</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/pds.2328" xlink:type="simple">10.1002/pds.2328</ext-link></comment> <object-id pub-id-type="pmid">22262592</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Franklin</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Eddings</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Glynn</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Schneeweiss</surname> <given-names>S</given-names></name>. <article-title>Regularized Regression Versus the High-Dimensional Propensity Score for Confounding Adjustment in Secondary Database Analyses</article-title>. <source>Am J Epidemiol</source>. <year>2015</year>;<volume>182</volume>: <fpage>651</fpage>–<lpage>659</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/aje/kwv108" xlink:type="simple">10.1093/aje/kwv108</ext-link></comment> <object-id pub-id-type="pmid">26233956</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Le H</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Poole</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Brookhart</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Schoenbach</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Beach</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Layton</surname> <given-names>JB</given-names></name>, <etal>et al</etal>. <article-title>Effects of aggregation of drug and diagnostic codes on the performance of the high-dimensional propensity score algorithm: an empirical example</article-title>. <source>BMC Med Res Methodol</source>. <year>2013</year>;<volume>13</volume>: <fpage>142</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2288-13-142" xlink:type="simple">10.1186/1471-2288-13-142</ext-link></comment> <object-id pub-id-type="pmid">24245772</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hernan</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Hernandez-Diaz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Robins</surname> <given-names>JM</given-names></name>. <article-title>A structural approach to selection bias</article-title>. <source>Epidemiology</source>. <year>2004</year>;<volume>15</volume>: <fpage>615</fpage>–<lpage>625</lpage>. <object-id pub-id-type="pmid">15308962</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bombardier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Laine</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Reicin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shapiro</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Burgos-Vargas</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Comparison of upper gastrointestinal toxicity of rofecoxib and naproxen in patients with rheumatoid arthritis</article-title>. <collab>VIGOR Study Group</collab>. <source>The New England journal of medicine</source>. <year>2000</year>. doi: 11087881 <object-id pub-id-type="pmid">11087881</object-id></mixed-citation></ref>
<ref id="pone.0212999.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname> <given-names>SX</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>KY</given-names></name>, <name name-style="western"><surname>Bertram</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Goldstein</surname> <given-names>JL</given-names></name>. <article-title>Withdrawal of COX-2 selective inhibitors rofecoxib and valdecoxib: impact on NSAID and gastroprotective drug prescribing and utilization</article-title>. <source>Curr Med Res Opin</source>. <year>2007</year>;<volume>23</volume>: <fpage>1859</fpage>–<lpage>1866</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1185/030079907X210561" xlink:type="simple">10.1185/030079907X210561</ext-link></comment> <object-id pub-id-type="pmid">17605893</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>