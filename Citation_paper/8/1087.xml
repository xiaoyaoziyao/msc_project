<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0175383</article-id>
<article-id pub-id-type="publisher-id">PONE-D-16-32379</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Machine learning algorithms</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Machine learning algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Machine learning</subject><subj-group><subject>Machine learning algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Machine learning</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Artificial neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Artificial neural networks</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Artificial neural networks</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Alcohols</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Organic chemistry</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Alcohols</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>People and places</subject><subj-group><subject>Population groupings</subject><subj-group><subject>Ethnicities</subject><subj-group><subject>Hispanic people</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Addiction</subject><subj-group><subject>Alcoholism</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Addiction</subject><subj-group><subject>Alcoholism</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Mental health and psychiatry</subject><subj-group><subject>Substance-related disorders</subject><subj-group><subject>Alcoholism</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Public and occupational health</subject><subj-group><subject>Substance-related disorders</subject><subj-group><subject>Alcoholism</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Use of a machine learning framework to predict substance use disorder treatment success</article-title>
<alt-title alt-title-type="running-head">Machine learning for SUD treatment success prediction</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5213-6012</contrib-id>
<name name-style="western">
<surname>Acion</surname>
<given-names>Laura</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kelmansky</surname>
<given-names>Diana</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>van der Laan</surname>
<given-names>Mark</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Sahker</surname>
<given-names>Ethan</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Jones</surname>
<given-names>DeShauna</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Arndt</surname>
<given-names>Stephan</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Instituto de Cálculo, Facultad de Ciencias Exactas y Naturales, Universidad de Buenos Aires, CONICET, Buenos Aires, Argentina</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Iowa Consortium for Substance Abuse Research and Evaluation, University of Iowa, Iowa City, Iowa, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Division of Biostatistics, University of California, Berkeley, California, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Counseling Psychology Program, Department of Psychological and Quantitative Foundations, College of Education, University of Iowa, Iowa City, Iowa, United States of America</addr-line></aff>
<aff id="aff005"><label>5</label> <addr-line>Department of Psychiatry, Roy J and Lucille A Carver College of Medicine, University of Iowa, Iowa City, Iowa, United States of America</addr-line></aff>
<aff id="aff006"><label>6</label> <addr-line>Department of Biostatistics, College of Public Health, University of Iowa, Iowa City, Iowa, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Niaura</surname>
<given-names>Raymond</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Legacy, Schroeder Institute for Tobacco Research and Policy Studies, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"> <list-item>
<p><bold>Conceptualization:</bold> LA DK MvdL ES DSJ SA.</p></list-item> <list-item>
<p><bold>Data curation:</bold> LA ES SA.</p></list-item> <list-item>
<p><bold>Formal analysis:</bold> LA DK MvdL SA.</p></list-item> <list-item>
<p><bold>Funding acquisition:</bold> LA DK.</p></list-item> <list-item>
<p><bold>Investigation:</bold> LA ES DSJ SA.</p></list-item> <list-item>
<p><bold>Methodology:</bold> LA DK MvdL ES DSJ SA.</p></list-item> <list-item>
<p><bold>Software:</bold> LA.</p></list-item> <list-item>
<p><bold>Supervision:</bold> DK SA.</p></list-item> <list-item>
<p><bold>Validation:</bold> DK.</p></list-item> <list-item>
<p><bold>Visualization:</bold> LA SA.</p></list-item> <list-item>
<p><bold>Writing – original draft:</bold> LA.</p></list-item> <list-item>
<p><bold>Writing – review &amp; editing:</bold> LA DK MvdL ES DSJ SA.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">laura.acion@ic.fcen.uba.ar</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>10</day>
<month>4</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<year>2017</year>
</pub-date>
<volume>12</volume>
<issue>4</issue>
<elocation-id>e0175383</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>8</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>3</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Acion et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0175383"/>
<abstract>
<p>There are several methods for building prediction models. The wealth of currently available modeling techniques usually forces the researcher to judge, a priori, what will likely be the best method. Super learning (SL) is a methodology that facilitates this decision by combining all identified prediction algorithms pertinent for a particular prediction problem. SL generates a final model that is at least as good as any of the other models considered for predicting the outcome. The overarching aim of this work is to introduce SL to analysts and practitioners. This work compares the performance of logistic regression, penalized regression, random forests, deep learning neural networks, and SL to predict successful substance use disorders (SUD) treatment. A nationwide database including 99,013 SUD treatment patients was used. All algorithms were evaluated using the area under the receiver operating characteristic curve (AUC) in a test sample that was not included in the training sample used to fit the prediction models. AUC for the models ranged between 0.793 and 0.820. SL was superior to all but one of the algorithms compared. An explanation of SL steps is provided. SL is the first step in targeted learning, an analytic framework that yields double robust effect estimation and inference with fewer assumptions than the usual parametric methods. Different aspects of SL depending on the context, its function within the targeted learning framework, and the benefits of this methodology in the addiction field are discussed.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002923</institution-id>
<institution>Consejo Nacional de Investigaciones Científicas y Técnicas</institution>
</institution-wrap>
</funding-source>
<award-id>Postdoctoral Fellowship 2651/2014</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5213-6012</contrib-id>
<name name-style="western">
<surname>Acion</surname>
<given-names>Laura</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was funded by Consejo de Investigaciones Científicas y Técnicas Postdoctoral Fellowship 2651/2014 awarded to LA.</funding-statement>
</funding-group>
<counts>
<fig-count count="2"/>
<table-count count="2"/>
<page-count count="14"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All data are available at <ext-link ext-link-type="uri" xlink:href="https://www.icpsr.umich.edu/icpsrweb/ICPSR/studies/30122" xlink:type="simple">https://www.icpsr.umich.edu/icpsrweb/ICPSR/studies/30122</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>There are several methods for building prediction models. Prediction models are often generated using some form of linear or logistic regression—e.g. [<xref ref-type="bibr" rid="pone.0175383.ref001">1</xref>–<xref ref-type="bibr" rid="pone.0175383.ref004">4</xref>]. More recently, other learning algorithms such as random forests (RF) or artificial neural networks (ANN) are being used for prediction in the health sciences—e.g. [<xref ref-type="bibr" rid="pone.0175383.ref005">5</xref>–<xref ref-type="bibr" rid="pone.0175383.ref007">7</xref>]. These new techniques may be able to enhance prediction, thus improving the chances of matching patients to the most effective treatments.</p>
<p>The wealth of currently available modeling techniques usually forces the researcher to judge, a priori, what will likely be the best prediction method. Super learning (SL) [<xref ref-type="bibr" rid="pone.0175383.ref008">8</xref>] is a methodology that facilitates this decision by combining all identified prediction algorithms pertinent for a particular prediction problem. SL generates a final model that is at least as good as any of the other models considered for predicting the outcome. This property of SL is both theoretically [<xref ref-type="bibr" rid="pone.0175383.ref008">8</xref>] and empirically supported [<xref ref-type="bibr" rid="pone.0175383.ref009">9</xref>]. The goal of this paper is to introduce various prediction methods, some of which are novel to the field of substance use disorders (SUD) treatment.</p>
<p>Accounting for individual patient characteristics to maximize positive outcomes is at the heart of precision medicine. SUD treatment is one of the many areas that can greatly benefit from optimizing patients’ pathways to the best possible treatment outcome. For example, United States estimates indicate only 19.8% of cases in need of alcohol use disorders treatment were ever treated [<xref ref-type="bibr" rid="pone.0175383.ref010">10</xref>]. Identifying key predictors of successful treatment can serve to discover disparities, strengths and weaknesses in service delivery, eventually increasing treatment success and reducing unmet treatment needs [<xref ref-type="bibr" rid="pone.0175383.ref011">11</xref>–<xref ref-type="bibr" rid="pone.0175383.ref013">13</xref>].</p>
<p>The first step in identifying key characteristics for matching patients to the most effective treatments is to predict who will succeed at a given treatment. The importance of this topic is reflected by the rich literature aiming to identify patients’ characteristics increasing the efficacy of SUD treatment (e.g. [<xref ref-type="bibr" rid="pone.0175383.ref004">4</xref>, <xref ref-type="bibr" rid="pone.0175383.ref014">14</xref>–<xref ref-type="bibr" rid="pone.0175383.ref016">16</xref>]). The methodological focus of this paper leaves a substantive literature review regarding SUD treatment success out of its scope.</p>
<p>Some of the literature predicting successful SUD treatment takes advantage of large publicly available datasets such as the Substance Abuse and Mental Health Services Administration Treatment Episode Data Set—Discharges (TEDS-D) [<xref ref-type="bibr" rid="pone.0175383.ref017">17</xref>]. The main advantage of datasets such as TEDS-D is the large number of records available including important patient characteristics and treatment features. Due to the computer power required when large data sets with numerous predictors are used, the advantage of working with large datasets or big data used to be also the greatest disadvantage for applying sophisticated prediction algorithms such as SL or other sophisticated machine learning methods. Computer power is currently less of a problem thanks to technological advances and an active open source software developer community. For instance, the open source community has optimized SL and other machine learning algorithms for the analysis of big data using open source software [<xref ref-type="bibr" rid="pone.0175383.ref018">18</xref>].</p>
<p>Most of the methods featured in this paper were not used to analyze TEDS-D before. The aim is to evaluate what method works best at predicting successful treatment using a real life large database. Rather than a dataset tailored to showcase the methods properties, we use a dataset commonly used in the SUD field. We hypothesized that SL will generate the best prediction model as measured by the area under the receiver operating characteristic curve (AUC) evaluated in a test sample not included in the training sample used to fit all prediction models.</p>
<p>The use of SL as a prediction tool of success in SUD treatment may contribute to the literature by bettering the ability to identify treatment outcome disparities that, when addressed, may lead to improve patients’ treatment outcomes.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec003">
<title>Data</title>
<p>To illustrate different prediction analytic approaches, we focused in SUD outpatient treatment for Hispanics during adulthood using publicly available TEDS-D 2006–2011 data [<xref ref-type="bibr" rid="pone.0175383.ref017">17</xref>]. TEDS-D is an excellent example of a large administrative dataset that may be of interest to addiction researchers in real life. This dataset allows us to illustrate the use of the methodologies introduced in this work within a realistic setting.</p>
<sec id="sec004">
<title>Outcome</title>
<p>Treatment completed was considered a successful treatment discharge status, all other treatment discharge reasons (e.g., left against professional advice, incarcerated, other) were considered as indicators of non-successful treatment. Treatment completion is a standard process outcome measure because it predicts longer-term outcomes such as less future criminal involvement, fewer readmissions, employment and income one year after treatment [<xref ref-type="bibr" rid="pone.0175383.ref019">19</xref>–<xref ref-type="bibr" rid="pone.0175383.ref022">22</xref>].</p>
</sec>
<sec id="sec005">
<title>Predictors</title>
<p>Twenty eight predictors recorded by TEDS-D were included in the analysis. Predictors include 10 patient characteristics (i.e., age, gender, race–e.g., White, Black—, ethnicity–indicating patient’s specific Hispanic origin, marital status, education, employment status, pregnant at time of admission, veteran status, and living arrangement), 3 treatment characteristics (i.e., intensity, medication-assisted opioid therapy, and length of stay), principal source of referral, summary of type of problematic substance (with categories “alcohol only”, “other drugs only”, or “alcohol and drugs”), and mental health problem. TEDS-D records thorough information about substances of misuse. This includes the following 12 predictors: primary, secondary, and tertiary substance problem, usual route of administration, frequency of use, and age at first use. The substances include: alcohol, cocaine/crack, marijuana/hashish, prescription opiates/synthetics, and methamphetamine use. Several other drug use categories were collapsed for analysis because of low percentages.</p>
</sec>
<sec id="sec006">
<title>Inclusion criteria</title>
<p>TEDS-D includes all admissions/discharges rather than individuals. Consequently, only records that indicate the individual had no prior SUD treatment were included in the analyses. Part of our previous work focuses on racial and ethnic minorities [<xref ref-type="bibr" rid="pone.0175383.ref011">11</xref>, <xref ref-type="bibr" rid="pone.0175383.ref012">12</xref>, <xref ref-type="bibr" rid="pone.0175383.ref023">23</xref>, <xref ref-type="bibr" rid="pone.0175383.ref024">24</xref>]. It is known that racial and ethnic minorities vary in their treatment access and success levels [<xref ref-type="bibr" rid="pone.0175383.ref025">25</xref>–<xref ref-type="bibr" rid="pone.0175383.ref027">27</xref>]. Thus, we restricted our analysis only to cases indicating a Hispanic/Latino ethnicity, 18 years old or older, and treatment in outpatient service settings. We focused on outpatient service settings because criteria for treatment completion/success (i.e., the outcome of interest) and duration for other types of services (e.g., 24-hour inpatient, detoxification-only) and outpatient services are often very different. This is a sample arbitrarily chosen to exemplify the different analytical approaches. The choice is based on our previous knowledge in this field and not on the results obtained after using the methods described in the following paragraphs.</p>
</sec>
<sec id="sec007">
<title>Exclusion criteria</title>
<p>Records with missing data in any of the predictors, the outcome, or characteristics used for determining inclusion in the study were excluded from the analysis. Since not all states collect the same information for their patients, from a total of 9,829,536 records, 4,385,825 (45%) had all required data complete.</p>
<p>These inclusion and exclusion criteria did not affect the performance of SL when compared to the rest of the analytical strategies used. A total of 99,013 records representing unique individuals were selected according to the inclusion and exclusion criteria and were used in the analysis. This sample was separated in a training set with 80% of the sample (n = 79,210) and a test set with the remaining 20% (n = 19,802).</p>
<p>Because these data represent public information and there is no subject identification, the University of Iowa Human Subjects Office Institutional Review Board exempted this study from review.</p>
</sec>
</sec>
<sec id="sec008">
<title>Statistical analysis</title>
<p>The goal of the analysis was to compare results of classical analytical strategies that are commonly used to address prediction of treatment success (e.g., logistic regression) alongside results of newer methods for prediction (e.g., ANN). We also compared SL results. SL is an ensemble machine learning methodology that encompasses all other methodologies in its library and has demonstrated (both theoretical and empirical) superiority for prediction [<xref ref-type="bibr" rid="pone.0175383.ref008">8</xref>, <xref ref-type="bibr" rid="pone.0175383.ref009">9</xref>].</p>
<p>Formally, the analysis is as follows. Let <italic>W = {W</italic><sub><italic>1</italic></sub>, <italic>…</italic>, <italic>W</italic><sub><italic>k</italic></sub><italic>}</italic> denote the predictors of interest and <italic>Y</italic> represent the binary outcome treatment success (Yes/No). Let <italic>O = (W</italic>, <italic>Y)</italic> be a random variable such that <italic>O~P</italic><sub><italic>0</italic></sub> (i.e., the true probability distribution of <italic>O</italic> is <italic>P</italic><sub><italic>0</italic></sub>). Since only records that indicate the individual had no prior treatment in a drug or alcohol program were included in the analyses, we assumed that the individuals observed can be represented as independent and identically distributed observations of the random variable <italic>O</italic>. For each individual <italic>i</italic>, <italic>Y</italic><sub><italic>i</italic></sub> and <italic>W</italic><sub><italic>i</italic></sub> are observed. We sought to estimate <inline-formula id="pone.0175383.e001"><alternatives><graphic id="pone.0175383.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175383.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>Y</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>—i.e., the probability of succeeding in treatment given the predictors of interest. <inline-formula id="pone.0175383.e002"><alternatives><graphic id="pone.0175383.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175383.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is unknown. Hence, we aimed to find the best estimator of <inline-formula id="pone.0175383.e003"><alternatives><graphic id="pone.0175383.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175383.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. This was achieved by maximizing the AUC. We did this using logistic regression, 3 types of penalized regression, RF, ANN, and the corresponding SL that includes these algorithms in its library. SL also maximized the AUC.</p>
<p>We used 2 mechanisms to avoid overfitting. The analysis used 2-fold cross-validation (CV) using 80% of the data set (n = 79,210) and the final model was validated using 19,802 randomly selected individuals that were only included in the test set (<xref ref-type="fig" rid="pone.0175383.g001">Fig 1</xref>). All analytic approaches explored were compared using the AUC in the test set. The best analytic strategy for predicting treatment success was identified as the model maximizing AUC. The AUC is a convenient measure of prediction success that can be interpreted as the probability that any of the algorithms ranks a randomly chosen successful patient higher than a randomly chosen unsuccessful patient [<xref ref-type="bibr" rid="pone.0175383.ref028">28</xref>]. AUC ranges from 0 to 1, AUC = 1 means perfect prediction and AUC = 0.5 suggests chance levels of prediction.</p>
<fig id="pone.0175383.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175383.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Analytic work flow.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175383.g001" xlink:type="simple"/>
</fig>
<p>We used at least 2 different configurations for each analytic strategy compared. The first approach included all 28 predictors available. Since it can be useful to reduce the number of predictors considered and simplify the final prediction formula, we also selected a subset of the 10 predictors with highest variable importance in a RF model. In decreasing order of importance, these predictors were: length of stay, age, principal source of referral, primary problematic substance, its age of first use, and its frequency of use, employment level, SUD type (i.e., only alcohol, only drugs, or both alcohol and drugs), education level, and patient’s specific Hispanic origin (e.g., Puerto Rican, Mexican, Cuban).</p>
<p>For each set of predictors, the following algorithms were compared: logistic regression, least absolute shrinkage and selection operator (lasso), ridge, and elastic net penalized regressions [<xref ref-type="bibr" rid="pone.0175383.ref029">29</xref>], RF [<xref ref-type="bibr" rid="pone.0175383.ref030">30</xref>], ANN [<xref ref-type="bibr" rid="pone.0175383.ref029">29</xref>, <xref ref-type="bibr" rid="pone.0175383.ref031">31</xref>], and SL [<xref ref-type="bibr" rid="pone.0175383.ref008">8</xref>]. Since none of the aforementioned regression models considered interaction effects in the predictive model, an additional model including terms for all predictors and selected 2-way interactions was also added to the SL library for each type of regression. Two-way interactions were initially screened using all possible logistic regression models of 2 predictors at a time and their 2-way interaction. All interactions with p-values&lt;0.0001 were included along with all predictors in the regression models of the SL library. We compared 17 algorithms/algorithm configurations.</p>
<p>There is a multitude of other analytic strategies that could be chosen [<xref ref-type="bibr" rid="pone.0175383.ref029">29</xref>]; however, to illustrate SL use for predicting treatment success when compared to other methods, we consider the chosen algorithms are adequate. In this context, where the data generating model is unknown, SL will be superior to the rest of the methodologies, regardless of the set of algorithms initially chosen. Some characteristics of the chosen algorithms are presented subsequently.</p>
<sec id="sec009">
<title>Logistic regression</title>
<p>Logistic parametric regression is the most commonly used algorithm for prediction in the SUD treatment outcomes field. Logistic regression is easily implemented and interpreted. However, logistic regression assumptions are strong and, since the true data generating model is unknown, these assumptions are usually violated. For example, including many predictors, their interactions, and/or other higher order terms in a logistic regression model does not guarantee that it is the best model, due, for example, to collinearity between the predictors included (which increases variability) or model misspecification (which introduces bias).</p>
</sec>
<sec id="sec010">
<title>Penalized regression</title>
<p>Penalized regression (such as lasso, ridge regression, or elastic nets) offers an alternative to parametric regression models. The 3 types of penalized regression applied in this work vary in their variance/bias tradeoffs depending on the characteristics of the predictor set. For example, lasso will select only one term from a set of correlated predictors. This may not be appropriate. In fact, when the number of predictors is small compared to the number of independent observations, ridge regression outperforms lasso when variables are highly correlated. Additionally, if the true data generating model has only a few predictors but the candidate models have a large number of predictors; lasso may eliminate predictors that were not in the data generating model. On the other hand, ridge regression will keep all terms in the final model. The elastic net penalized regression provides some balance between lasso and the ridge regressions.</p>
<p>In the example presented here, there are 28 categorical predictors that correspond to 135 terms when the model is parametrized using dummy variables. The screening step for the most relevant 2-way interactions of these 135 terms, preselected 257 2-way interaction terms. Thus, the regression models including all predictors and selected interactions had 393 terms including the intercept. While logistic regression estimated 393 parameters for this model, lasso estimated parameters only for terms uncorrelated with each other and zeroed-out the rest; ridge regression kept all 393 but down weighted each term. In this way, penalized regression allows for tuning large models adapting them to the information provided by the data.</p>
</sec>
<sec id="sec011">
<title>Random forests</title>
<p>RF is a recursive partitioning method popular in many fields with high-dimensional data (e.g., genomics). RF can evaluate a number of predictor variables even in the presence of complex interactions, including those that are not possible to model using regression. RF is an ensemble of classification and regression trees constructed on bootstrap samples. Unlike individual trees, RF is more protective against overfitting.</p>
</sec>
<sec id="sec012">
<title>Artificial neural networks</title>
<p>An ANN uses interconnected nodes within various layers to explain an outcome given a set of predictors. The relationships between the nodes are defined by weights calculated using a given rule. The initial weights are preassigned by the analyst. The ANN algorithm iterates adjusting the weights. At the end of each iteration, the performance at outcome prediction is evaluated. ANNs efficiently generate non-linear classification rules but can be prone to overfitting. More recently, some types of ANN are referred to as deep learning [<xref ref-type="bibr" rid="pone.0175383.ref031">31</xref>]. Deep learning allows modeling multiple levels of non-linearity in the data and is scalable to large datasets and big data in general. We used deep learning ANN with hidden layer sizes of 200.</p>
</sec>
<sec id="sec013">
<title>Super learning</title>
<p>SL is a generalization of the stacking algorithm [<xref ref-type="bibr" rid="pone.0175383.ref032">32</xref>], an ensemble machine learning method that takes a weighted average of all other algorithms considered for prediction and produces a single prediction function (PF) with optimal tradeoff between variance and bias. SL is very flexible for learning from the data as it combines the strengths of all methodologies considered (including different configurations of the same algorithm) while minimizing modelling flaws. Another advantage of SL is that it eliminates the need to select a priori a single or a few methodologies for the analysis. SL allows analyzing the data using simultaneously all the methodologies the researcher considers suitable.</p>
<p><xref ref-type="fig" rid="pone.0175383.g001">Fig 1</xref> depicts the work flow used to analyze the data and details all the steps necessary for running SL. The input of the analysis consists of the training and test data sets together with the algorithmic library. Since we used 2-fold CV to obtain each algorithm PF, as well as, the SL PF, the training set was initially partitioned in 2 blocks. Each algorithm in the library was fitted using each block independently. We used the data block excluded from the model fitting to calculate the CV AUC for each algorithm in the library. We averaged both CV AUCs, resulting in a single training set CV AUC for each algorithm. Up to this step, model fitting follows a regular 2-fold CV modelling path. The PF of discrete SL, a simpler version of SL, is the PF of the algorithm with the minimum CV AUC.</p>
<p>However, SL performs better when a weighted combination of the algorithms’ PFs is used. Thus, the next step for obtaining SL PF is to calculate a weight for each algorithm PF. This is done regressing <italic>Y</italic> on the values of <italic>Y</italic> predicted by each algorithm in the library. Next, each algorithm is fitted using the whole training set and the SL PF is obtained by applying the estimated weights to the algorithm predictions for each observation.</p>
<p>It can be demonstrated that using 2-fold CV, the procedure can end here and the AUCs of fitting each algorithm and SL to the whole training dataset would suffice for SL to outperform the rest of the algorithms without overfitting. However, we included an additional validation step: all the PFs obtained with the training set, where used to predict SUD treatment success in the test data set. We calculated AUCs compared to evaluate all models adjusted using the test dataset.</p>
<p>A thorough description of all the algorithms used in this work is out of the scope of this manuscript. The interested reader will find further details about SL in van der Laan and Rose [<xref ref-type="bibr" rid="pone.0175383.ref033">33</xref>] and about the rest of the aforementioned methodologies in Friedman et al [<xref ref-type="bibr" rid="pone.0175383.ref029">29</xref>] and Bengio [<xref ref-type="bibr" rid="pone.0175383.ref031">31</xref>].</p>
<p>Models were fitted using the open source R programming language [<xref ref-type="bibr" rid="pone.0175383.ref034">34</xref>] and the H2O R interface version 3.8.2.2 [<xref ref-type="bibr" rid="pone.0175383.ref035">35</xref>] that optimizes all the analytical methods used for large datasets. The h2oEnsemble package version 0.1.8 [<xref ref-type="bibr" rid="pone.0175383.ref036">36</xref>] was used to fit the SL model. We set all tuning parameters for each algorithm in the SL library (e.g., the ANN implementation used in this manuscript has over 20 parameters) to their default values. The analysis took about 2.5 hours to run in a Windows 7 Professional desktop computer with 8-core i7-3770 3.40 Ghz CPU and 8 Gb RAM. Most of the analytic time was used to fit the four regression models including 2-way interaction terms. The other 13 algorithms, including SL, required only about 6 minutes of the 2.5 hours. AUC confidence intervals and variances were estimated using the Delong and colleagues methodology [<xref ref-type="bibr" rid="pone.0175383.ref037">37</xref>] as implemented in the R package pROC [<xref ref-type="bibr" rid="pone.0175383.ref038">38</xref>]. Briefly, Delong et al [<xref ref-type="bibr" rid="pone.0175383.ref037">37</xref>] used the equality between AUC and the Mann-Whitney U statistic and asymptotic normality to analytically derive variance and confidence interval estimators for AUC.</p>
</sec>
</sec>
</sec>
<sec id="sec014" sec-type="results">
<title>Results</title>
<p>Treatment success rate and characteristics for the patients included in the analyses are shown in <xref ref-type="table" rid="pone.0175383.t001">Table 1</xref>. For brevity, only gender and the top 10 most important predictors as identified by RF were included in the table.</p>
<table-wrap id="pone.0175383.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175383.t001</object-id>
<label>Table 1</label> <caption><title>Sample characteristics (N = 99,013).</title></caption>
<alternatives>
<graphic id="pone.0175383.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175383.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left"/>
<th align="center">Total N (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>SUD Treatment Success</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">Yes</td>
<td align="center">44,748 (45.2%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">No</td>
<td align="center">54,265 (54.8%)</td>
</tr>
<tr>
<td align="left"><bold>Gender</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">Male</td>
<td align="center">77,123 (77.9%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Female</td>
<td align="center">21,890 (22.1%)</td>
</tr>
<tr>
<td align="left"><bold>Ethnicity</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">Puerto Rican</td>
<td align="center">31,047 (31.4%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Mexican</td>
<td align="center">25,190 (25.4%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Cuban</td>
<td align="center">2,683 (2.7%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Other/Unspecified</td>
<td align="center">40,093 (40.5%)</td>
</tr>
<tr>
<td align="left"><bold>Age (years)</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">18–20</td>
<td align="center">11,479 (11.6%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">21–24</td>
<td align="center">16,886 (17.1%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">25–29</td>
<td align="center">19,625 (19.8%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">30–34</td>
<td align="center">15,121 (15.3%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">35–39</td>
<td align="center">11,725 (11.8%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">40–44</td>
<td align="center">9,436 (9.5%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">45–49</td>
<td align="center">6,988 (7.1%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">50–54</td>
<td align="center">4,172 (4.2%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">55+</td>
<td align="center">3,581 (3.6%)</td>
</tr>
<tr>
<td align="left"><bold>Education (years)</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">&lt;9</td>
<td align="center">17,170 (17.3%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">9–11</td>
<td align="center">31,507 (31.8%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">12</td>
<td align="center">34,329 (34.7%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">13–15</td>
<td align="center">13,062 (13.2%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">16+</td>
<td align="center">2,945 (3.0%)</td>
</tr>
<tr>
<td align="left"><bold>Employment</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">Full Time</td>
<td align="center">34,586 (34.9%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Part Time</td>
<td align="center">10,392 (10.5%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Unemployed</td>
<td align="center">29,635 (29.9%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Not in Labor Force</td>
<td align="center">24,400 (24.6%)</td>
</tr>
<tr>
<td align="left"><bold>Primary Substance</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">Alcohol</td>
<td align="center">50,782 (51.3%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Marijuana</td>
<td align="center">26,269 (26.5%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Cocaine</td>
<td align="center">8,554 (8.6%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Non-Prescription Opiates</td>
<td align="center">7,791 (7.9%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Methamphetamine</td>
<td align="center">2,312 (2.3%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Prescription Opiates and Synthetics</td>
<td align="center">2,145 (2.2%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Hallucinogens</td>
<td align="center">293 (0.3%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Other Sedatives</td>
<td align="center">320 (0.3%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Other Stimulants</td>
<td align="center">234 (0.2%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Other</td>
<td align="center">313 (0.3%)</td>
</tr>
<tr>
<td align="left"><bold>Frequency of Primary Substance Use</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">Not in the past month</td>
<td align="center">41,529 (41.9%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">1–3 times past month</td>
<td align="center">20,766 (21.0%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">1–2 times past week</td>
<td align="center">11,770 (11.9%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">3–6 times past week</td>
<td align="center">8,272 (8.4%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Daily</td>
<td align="center">16,676 (16.8%)</td>
</tr>
<tr>
<td align="left"><bold>Age of First Primary Substance Use (years)</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">&lt;10</td>
<td align="center">4,825 (4.9%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">12–14</td>
<td align="center">17,577 (17.8%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">15–17</td>
<td align="center">31,306 (31.6%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">18–20</td>
<td align="center">22,949 (23.2%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">21–24</td>
<td align="center">10,895 (11.0%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">25–29</td>
<td align="center">5,768 (5.8%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">30–34</td>
<td align="center">2,535 (2.6%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">35–39</td>
<td align="center">1,573 (1.6%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">40–44</td>
<td align="center">816 (0.8%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">45–49</td>
<td align="center">435 (0.4%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">50–54</td>
<td align="center">211 (0.2%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">55+</td>
<td align="center">123 (0.1%)</td>
</tr>
<tr>
<td align="left"><bold>Substance Abuse Type</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">Alcohol Only</td>
<td align="center">34,827 (35.2%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Other Drugs Only</td>
<td align="center">29,887 (30.2%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Alcohol and Drugs</td>
<td align="center">34,299 (34.6%)</td>
</tr>
<tr>
<td align="left"><bold>Source of Referral</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">Self</td>
<td align="center">16,910 (17.1%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Alcohol/Drug Abuse Care Provider</td>
<td align="center">3,655 (3.7%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Other Health Care Provider</td>
<td align="center">4,013 (4.1%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">School</td>
<td align="center">341 (0.3%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Employer</td>
<td align="center">1,350 (1.4%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Other Community Referral</td>
<td align="center">15,503 (15.7%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Criminal Justice Referral</td>
<td align="center">57,241 (57.8%)</td>
</tr>
<tr>
<td align="left"><bold>Length of Stay (days)</bold></td>
<td align="left"/>
<td align="center"/>
</tr>
<tr>
<td align="left"/>
<td align="left">1–30</td>
<td align="center">19,942 (20.1%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">31–60</td>
<td align="center">15,296 (15.4%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">61–90</td>
<td align="center">12,476 (12.6%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">91–120</td>
<td align="center">12,397 (12.5%)</td>
</tr>
<tr>
<td align="left"/>
<td align="left">121 or longer</td>
<td align="center">38,902 (39.3%)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p><xref ref-type="table" rid="pone.0175383.t002">Table 2</xref> shows the AUC in the test set (N = 19,802) for the 17 algorithms/algorithm configurations compared. All AUC are between 0.793 and 0.820. This indicates that, for this set of models, the probability that any of the algorithms will rank a randomly chosen successful patient higher than a randomly chosen unsuccessful patient is between 0.793 and 0.820. This is usually considered a good performance for prediction models.</p>
<table-wrap id="pone.0175383.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175383.t002</object-id>
<label>Table 2</label> <caption><title>AUC in the test set (N = 19,802) for each algorithm and algorithm parametrization used.</title></caption>
<alternatives>
<graphic id="pone.0175383.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175383.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Model</th>
<th align="center">AUC</th>
<th align="justify"><inline-formula id="pone.0175383.e004"><alternatives><graphic id="pone.0175383.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175383.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Super Learning</td>
<td align="center">0.820</td>
<td align="center">0.165</td>
</tr>
<tr>
<td align="left">Random Forests All Predictors</td>
<td align="center">0.816</td>
<td align="center">0.173</td>
</tr>
<tr>
<td align="left">Lasso All Predictors + 2-Way Interactions</td>
<td align="center">0.805</td>
<td align="center">0.185</td>
</tr>
<tr>
<td align="left">Lasso All Predictors</td>
<td align="center">0.805</td>
<td align="center">0.185</td>
</tr>
<tr>
<td align="left">Elastic Net All Predictors</td>
<td align="center">0.805</td>
<td align="center">0.185</td>
</tr>
<tr>
<td align="left">Logistic Regression All Predictors</td>
<td align="center">0.805</td>
<td align="center">0.185</td>
</tr>
<tr>
<td align="left">Ridge Regression All Predictors</td>
<td align="center">0.805</td>
<td align="center">0.185</td>
</tr>
<tr>
<td align="left">ANN Top 10 Predictors</td>
<td align="center">0.805</td>
<td align="center">0.185</td>
</tr>
<tr>
<td align="left">Elastic Net All Predictors + 2-Way Interactions</td>
<td align="center">0.804</td>
<td align="center">0.186</td>
</tr>
<tr>
<td align="left">ANN All Predictors</td>
<td align="center">0.803</td>
<td align="center">0.186</td>
</tr>
<tr>
<td align="left">Lasso Top 10 Predictors</td>
<td align="center">0.801</td>
<td align="center">0.189</td>
</tr>
<tr>
<td align="left">Elastic Net Top 10 Predictors</td>
<td align="center">0.801</td>
<td align="center">0.189</td>
</tr>
<tr>
<td align="left">Ridge Regression Top 10 Predictors</td>
<td align="center">0.801</td>
<td align="center">0.189</td>
</tr>
<tr>
<td align="left">Logistic Regression Top 10 Predictors</td>
<td align="center">0.801</td>
<td align="center">0.189</td>
</tr>
<tr>
<td align="left">Random Forests Top 10 Predictors</td>
<td align="center">0.797</td>
<td align="center">0.191</td>
</tr>
<tr>
<td align="left">Ridge Regr. All Predictors + 2-Way Interactions</td>
<td align="center">0.793</td>
<td align="center">0.197</td>
</tr>
<tr>
<td align="left">Logistic Regr. All Predictors + 2-Way Interactions</td>
<td align="center">0.793</td>
<td align="center">0.197</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>As hypothesized, SL shows the largest AUC. SL performance is very closely followed by RF including all predictors. For this particular example, the algorithm with the worst performance is logistic regression including all predictors and selected 2-way interactions. The relative improvement in AUC of SL is 3.3% when compared to the worst prediction method. Also, the AUC for SL has the smallest estimated variance. The rest of the models considered have estimated AUC variances up to 19% higher than SL. As revealed by <xref ref-type="fig" rid="pone.0175383.g002">Fig 2</xref>, SL AUC is higher than AUC for all other models, with the exception of the RF model including all predictors.</p>
<fig id="pone.0175383.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175383.g002</object-id>
<label>Fig 2</label>
<caption>
<title>95% confidence intervals for AUC of each model compared.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175383.g002" xlink:type="simple"/>
</fig>
<p>Also, in most cases, the models including all predictors performed slightly better (but not statistically so) than the models including only the top 10 predictors selected in the initial screening step to simplify the prediction model. All parametric regression models both penalized and non-penalized approaches performed almost identically with respect to AUC for models not including interactions. This behavior could have been anticipated since a model with only 28 predictors can be considered too small for a data set this size. However, for models including all predictors and selected 2-way interactions, lasso outperformed the other 3 regression models. AUC for lasso was higher than for ridge and logistic regressions.</p>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Discussion</title>
<p>This work compared 17 models for predicting successful completion of SUD treatment. Both traditional and newer analytic strategies were equated in a nationwide large dataset. Particularly, super learning, an ensemble machine learning algorithm, was introduced for the first time to the study of SUD treatment success using large datasets. As expected, SL showed the best predictive performance.</p>
<p>In this particular example, SL superiority was meager when compared to more traditional models such as logistic regression. This result was not at all evident before analyzing these data. We understand this may dampen the interest in this work. However, we think that the finding that there are no major differences in the solutions of all methods is important in itself and worth discussing. Unlike what happens with other predictive models, the lack of substantive difference between SL and the rest of the models used means that: a) any of these methods could be used for these data and b) there are no major problems in the assumptions of the different models used. These findings are never evident before or after analyzing a dataset when analysis is performed using a traditional analytical approach. Sensitivity analysis is one approach used to address this limitation of traditional methods. In this sense, SL serves as a tool to streamlining and improving sensitivity analysis for prediction. SL does not require that a model is chosen a priori, at the end of the analysis results in the best model, and, if there are no substantial differences with the rest of the models, SL provides a solid justification for the use of any of the models. SL is a valuable, but underutilized, tool for obtaining robust prediction results as required, for example, by the National Institutes of Health [<xref ref-type="bibr" rid="pone.0175383.ref039">39</xref>].</p>
<p>In addition, even small improvements in prediction can have a high impact depending on each particular problem. In this case, a small prediction improvement could significantly impact patients’ outcomes and/or treatment costs. In other cases, small prediction improvements could save lives. Since SL is theoretically proven to perform as well or better than the best model included in its library, the results presented here are relevant to illustrate the use of SL in the SUD treatment outcome prediction field.</p>
<p>In other applications, SL has shown 44% and 12% increase in performance when compared to ANN and RF, respectively [<xref ref-type="bibr" rid="pone.0175383.ref040">40</xref>]. Also, SL has shown as good or significantly better predictive performance than linear regression and other methods when used in 13 real datasets—see Fig 3.4 in [<xref ref-type="bibr" rid="pone.0175383.ref040">40</xref>]. In fact, stacking algorithms similar to SL are usually among the type of algorithms that win prediction contests such as the Heritage Provider Network Health Prize [<xref ref-type="bibr" rid="pone.0175383.ref041">41</xref>]. The Heritage Provider Network Health Prize was a competition to develop a predictive algorithm helping identify patients most likely to be admitted to healthcare providers.</p>
<p>The results of this work should be interpreted as an illustration of the presented statistical methods in a realistic setting. The practical conclusions should be seen in light of the data limitations. Analysis was restricted to Hispanics and very few features describing the type of treatment and how treatment was administered were included. There may be considerable reservation with using treatment completion as an indicator of treatment success. While post-treatment follow-up outcome measures of abstinence or reduced use would be best, such nation-wide data collection efforts were out of the scope of this project. While these are important limitations to inform treatment success prediction, these issues do not affect the main goal of this work.</p>
<p>Traditional analytical approaches for prediction may not only consider the prediction performance of a model, but also its ecological validity for a given research area. That is one of the reasons logistic regression could be preferred over SL for predicting SUD treatment success. While the model proposed by SL is designed to excel at prediction, it is not meant to be interpreted or to be used for effect estimation. If the true or close to true data generating model is included in the SL library, SL will likely have a low gain in predictive performance and its lack of interpretability could discourage its use. However, most of the time, researchers are uncertain about the model that generated the data. When ecological validity is important in a prediction context, SL could be used as a simpler model validator if an interpretable model in its library is close to SL in predictive performance. In the example presented here, SL has significantly better predictive performance than logistic regression; thus, it would be difficult to defend any of the logistic regression models used in this application in lieu of SL. On the other hand, these data show that, if the ecologically validity of RF models could be easily assessed, the use of the RF model with all the predictors could be used instead of the SL model.</p>
<p>When the goal of the research is to interpret the effect of different predictors in the outcome, SL can be used in the context of the targeted learning framework [<xref ref-type="bibr" rid="pone.0175383.ref033">33</xref>]. SL is the first stage for obtaining doubly-robust effect estimates using targeted maximum loss-based estimation (TMLE) [<xref ref-type="bibr" rid="pone.0175383.ref042">42</xref>]. TMLE is an estimation technique that allows for double robust estimation of effects with fewer untestable assumptions than the usual parametric methods used for estimation. TMLE can be applied either in a causality framework or in a merely associative framework (additional details about TMLE is out of the scope of this work, we recommend [<xref ref-type="bibr" rid="pone.0175383.ref033">33</xref>] for further information). Using the prediction model suggested by SL and TMLE, one could answer questions such as “What is the treatment success rate difference between Hispanics with comorbid psychiatric disorders and those without comorbid disorders?” and “Is this difference different from zero?” In contrast, statistical inference is not possible in machine learning methodologies such as RF or deep learning. This important limitation of machine learning algorithms is overcome by targeted learning, the first analytical framework that provides estimates and hypothesis testing while using machine learning [<xref ref-type="bibr" rid="pone.0175383.ref043">43</xref>]. Future directions of this work include determining the benefits of applying targeted learning for different effect estimations and inference in the addiction field.</p>
</sec>
</body>
<back>
<ack>
<p>This work was partially funded by postdoctoral fellowship 2651/2014 awarded to Dr. Acion by CONICET. The authors thank all open source software developers that made the analysis possible.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0175383.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Acion</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ramirez</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Jorge</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Arndt</surname> <given-names>S</given-names></name>. <article-title>Increased risk of alcohol and drug use among children from deployed military families</article-title>. <source>Addiction</source>. <year>2013</year>;<volume>108</volume>(<issue>8</issue>):<fpage>1418</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/add.12161" xlink:type="simple">10.1111/add.12161</ext-link></comment> <object-id pub-id-type="pmid">23441867</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alang</surname> <given-names>SM</given-names></name>. <article-title>Sociodemographic Disparities Associated With Perceived Causes of Unmet Need for Mental Health Care</article-title>. <source>Psychiatr Rehabil J</source>. <year>2015</year>;<volume>38</volume>(<issue>4</issue>):<fpage>293</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/prj0000113" xlink:type="simple">10.1037/prj0000113</ext-link></comment> <object-id pub-id-type="pmid">25664758</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Glasheen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pemberton</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Lipari</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Copello</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Mattson</surname> <given-names>ME</given-names></name>. <article-title>Binge drinking and the risk of suicidal thoughts, plans, and attempts</article-title>. <source>Addictive Behaviors</source>. <year>2015</year>;<volume>43</volume>:<fpage>42</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.addbeh.2014.12.005" xlink:type="simple">10.1016/j.addbeh.2014.12.005</ext-link></comment> <object-id pub-id-type="pmid">25553510</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sahker</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Acion</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Arndt</surname> <given-names>S</given-names></name>. <article-title>National Analysis of Differences Among Substance Abuse Treatment Outcomes: College Student and Nonstudent Emerging Adults</article-title>. <source>Journal of American College Health</source>. <year>2015</year>;<volume>63</volume>(<issue>2</issue>):<fpage>118</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/07448481.2014.990970" xlink:type="simple">10.1080/07448481.2014.990970</ext-link></comment> <object-id pub-id-type="pmid">25470217</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gowin</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Ball</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Wittmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tapert</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Paulus</surname> <given-names>MP</given-names></name>. <article-title>Individualized relapse prediction: Personality measures and striatal and insular activity during reward-processing robustly predict relapse</article-title>. <source>Drug and alcohol dependence</source>. <year>2015</year>;<volume>152</volume>:<fpage>93</fpage>–<lpage>101</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.drugalcdep.2015.04.018" xlink:type="simple">10.1016/j.drugalcdep.2015.04.018</ext-link></comment> <object-id pub-id-type="pmid">25977206</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Launay</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rivière</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kabeshova</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Beauchet</surname> <given-names>O</given-names></name>. <article-title>Predicting prolonged length of hospital stay in older emergency department users: use of a novel analysis method, the Artificial Neural Network</article-title>. <source>European journal of internal medicine</source>. <year>2015</year>;<volume>26</volume>(<issue>7</issue>):<fpage>478</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ejim.2015.06.002" xlink:type="simple">10.1016/j.ejim.2015.06.002</ext-link></comment> <object-id pub-id-type="pmid">26142183</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pflueger</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Franke</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Graf</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hachtel</surname> <given-names>H</given-names></name>. <article-title>Predicting general criminal recidivism in mentally disordered offenders using a random forest approach</article-title>. <source>BMC psychiatry</source>. <year>2015</year>;<volume>15</volume>(<issue>1</issue>):<fpage>1</fpage>.</mixed-citation></ref>
<ref id="pone.0175383.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van der Laan</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Polley</surname> <given-names>EC</given-names></name>, <name name-style="western"><surname>Hubbard</surname> <given-names>AE</given-names></name>. <article-title>Super learner</article-title>. <source>Statistical applications in genetics and molecular biology</source>. <year>2007</year>;<volume>6</volume>(<issue>1</issue>).</mixed-citation></ref>
<ref id="pone.0175383.ref009"><label>9</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Polley</surname> <given-names>EC</given-names></name>, <name name-style="western"><surname>Rose</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>van der Laan</surname> <given-names>MJ</given-names></name>. <source>Super learning. Targeted Learning</source>: <publisher-name>Springer</publisher-name>; <year>2011</year>. p. <fpage>43</fpage>–<lpage>66</lpage>.</mixed-citation></ref>
<ref id="pone.0175383.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grant</surname> <given-names>BF</given-names></name>, <name name-style="western"><surname>Goldstein</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Saha</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Chou</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Jung</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Epidemiology of DSM-5 alcohol use disorder: results from the National Epidemiologic Survey on Alcohol and Related Conditions III</article-title>. <source>JAMA psychiatry</source>. <year>2015</year>;<volume>72</volume>(<issue>8</issue>):<fpage>757</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1001/jamapsychiatry.2015.0584" xlink:type="simple">10.1001/jamapsychiatry.2015.0584</ext-link></comment> <object-id pub-id-type="pmid">26039070</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arndt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Acion</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>K</given-names></name>. <article-title>How the states stack up: Disparities in substance abuse outpatient treatment completion rates for minorities</article-title>. <source>Drug and alcohol dependence</source>. <year>2013</year>;<volume>132</volume>(<issue>3</issue>):<fpage>547</fpage>–<lpage>54</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.drugalcdep.2013.03.015" xlink:type="simple">10.1016/j.drugalcdep.2013.03.015</ext-link></comment> <object-id pub-id-type="pmid">23664124</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sahker</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Toussaint</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Ramirez</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ali</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Arndt</surname> <given-names>S</given-names></name>. <article-title>Evaluating racial disparity in referral source and successful completion of substance abuse treatment</article-title>. <source>Addictive behaviors</source>. <year>2015</year>;<volume>48</volume>:<fpage>25</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.addbeh.2015.04.006" xlink:type="simple">10.1016/j.addbeh.2015.04.006</ext-link></comment> <object-id pub-id-type="pmid">25935719</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wells</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Klap</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Koike</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sherbourne</surname> <given-names>C</given-names></name>. <article-title>Ethnic disparities in unmet need for alcoholism, drug abuse, and mental health care</article-title>. <source>American Journal of Psychiatry</source>. <year>2001</year>;<volume>158</volume>(<issue>12</issue>):<fpage>2027</fpage>–<lpage>2032</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1176/appi.ajp.158.12.2027" xlink:type="simple">10.1176/appi.ajp.158.12.2027</ext-link></comment> <object-id pub-id-type="pmid">11729020</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Compton</surname> <given-names>WM</given-names> <suffix>III</suffix></name>, <name name-style="western"><surname>Cottler</surname> <given-names>LB</given-names></name>, <name name-style="western"><surname>Jacobs</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Ben-Abdallah</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Spitznagel</surname> <given-names>EL</given-names></name>. <article-title>The Role of Psychiatric Disorders in Predicting Drug Dependence Treatment Outcomes</article-title>. <source>American Journal of Psychiatry</source>. <year>2003</year>;<volume>160</volume>(<issue>5</issue>):<fpage>890</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1176/appi.ajp.160.5.890" xlink:type="simple">10.1176/appi.ajp.160.5.890</ext-link></comment> <object-id pub-id-type="pmid">12727692</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sahker</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>McCabe</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Arndt</surname> <given-names>S</given-names></name>. <article-title>Differences in successful treatment completion among pregnant and non-pregnant American women</article-title>. <source>Archives of Women's Mental Health</source>. <year>2015</year>;<volume>19</volume>(<issue>1</issue>):<fpage>79</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00737-015-0520-5" xlink:type="simple">10.1007/s00737-015-0520-5</ext-link></comment> <object-id pub-id-type="pmid">25824855</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simpson</surname> <given-names>DD</given-names></name>, <name name-style="western"><surname>Joe</surname> <given-names>GW</given-names></name>. <article-title>Motivation as a predictor of early dropout from drug abuse treatment</article-title>. <source>Psychotherapy: Theory, research, practice, training</source>. <year>1993</year>;<volume>30</volume>(<issue>2</issue>):<fpage>357</fpage>.</mixed-citation></ref>
<ref id="pone.0175383.ref017"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">United States Department of Health and Human Services. Substance Abuse and Mental Health Services Administration. Office of Applied Statistics. Treatment Episode Data Set—Discharges (TEDS-D)—Concatenated, 2006 to 2011. Inter-university Consortium for Political and Social Research (ICPSR) [distributor]; 2014.</mixed-citation></ref>
<ref id="pone.0175383.ref018"><label>18</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>LeDell</surname> <given-names>EE</given-names></name>. <source>Scalable Ensemble Learning and Computationally Efficient Variance Estimation</source>: <publisher-name>University of California</publisher-name>, <publisher-loc>Berkeley</publisher-loc>; <year>2015</year>.</mixed-citation></ref>
<ref id="pone.0175383.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zarkin</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Dunlap</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Bray</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Wechsberg</surname> <given-names>WM</given-names></name>. <article-title>The effect of treatment completion and length of stay on employment and crime in outpatient drug-free treatment</article-title>. <source>Journal of Substance Abuse Treatment</source>. <year>2002</year>;<volume>23</volume>(<issue>4</issue>):<fpage>261</fpage>–<lpage>71</lpage>. <object-id pub-id-type="pmid">12495788</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Garnick</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Horgan</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Acevedo</surname> <given-names>A</given-names></name>, <collab>Workgroup WCPS</collab>. <article-title>Adapting Washington Circle performance measures for public sector substance abuse treatment systems</article-title>. <source>Journal of Substance Abuse Treatment</source>. <year>2009</year>;<volume>36</volume>(<issue>3</issue>):<fpage>265</fpage>–<lpage>77</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jsat.2008.06.008" xlink:type="simple">10.1016/j.jsat.2008.06.008</ext-link></comment> <object-id pub-id-type="pmid">18722075</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Evans</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hser</surname> <given-names>Y-I</given-names></name>. <article-title>Client and program factors associated with dropout from court mandated drug treatment</article-title>. <source>Evaluation and program planning</source>. <year>2009</year>;<volume>32</volume>(<issue>3</issue>):<fpage>204</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.evalprogplan.2008.12.003" xlink:type="simple">10.1016/j.evalprogplan.2008.12.003</ext-link></comment> <object-id pub-id-type="pmid">19150133</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><collab>TOPPS-II Interstate Cooperative Study Group</collab>. <article-title>Drug treatment completion and post-discharge employment in the TOPPS-II Interstate Cooperative Study</article-title>. <source>Journal of Substance Abuse Treatment</source>. <year>2003</year>;<volume>25</volume>(<issue>1</issue>):<fpage>9</fpage>–<lpage>18</lpage>. <object-id pub-id-type="pmid">14512103</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sahker</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yeung</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Loh</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Arndt</surname> <given-names>S</given-names></name>. <article-title>Asian American and Pacific Islander Substance Use Treatment Admission Trends</article-title>. <source>Drug and alcohol dependence</source>. <year>2017</year>;<volume>171</volume>:<fpage>1</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.drugalcdep.2016.11.022" xlink:type="simple">10.1016/j.drugalcdep.2016.11.022</ext-link></comment> <object-id pub-id-type="pmid">27988403</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marzell</surname> <given-names>MS E</given-names></name>.; <name name-style="western"><surname>Pro</surname> <given-names>G.</given-names></name>; <name name-style="western"><surname>Arndt</surname> <given-names>S.</given-names></name> <article-title>A brief report on Hispanic youth marijuana use: Trends in substance abuse treatment admissions in the United States</article-title>. <source>Journal of ethnicity and substance abuse</source>. <year>2016</year>:<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation></ref>
<ref id="pone.0175383.ref025"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Substance Abuse and Mental Health Services Administration. The NSDUH Report: Need for and Receipt of Substance Use Treatment among Hispanics. Rockville, MD: 2012.</mixed-citation></ref>
<ref id="pone.0175383.ref026"><label>26</label><mixed-citation publication-type="other" xlink:type="simple">Substance Abuse and Mental Health Services Administration. The NSDUH Report: Need for and Receipt of Substance Use Treatment among American Indians or Alaska Natives. Rockville, MD: 2012.</mixed-citation></ref>
<ref id="pone.0175383.ref027"><label>27</label><mixed-citation publication-type="other" xlink:type="simple">Substance Abuse and Mental Health Services Administration. Need for and Receipt of Substance Use Treatment among Blacks. 2013.</mixed-citation></ref>
<ref id="pone.0175383.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Acion</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Temple</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Arndt</surname> <given-names>S</given-names></name>. <article-title>Probabilistic index: An intuitive non‐parametric approach to measuring the size of treatment effects</article-title>. <source>Statistics in medicine</source>. <year>2006</year>;<volume>25</volume>(<issue>4</issue>):<fpage>591</fpage>–<lpage>602</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/sim.2256" xlink:type="simple">10.1002/sim.2256</ext-link></comment> <object-id pub-id-type="pmid">16143965</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref029"><label>29</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>. <source>The elements of statistical learning: Springer series in statistics</source> <publisher-name>Springer</publisher-name>, <publisher-loc>Berlin</publisher-loc>; <year>2001</year>.</mixed-citation></ref>
<ref id="pone.0175383.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Breiman</surname> <given-names>L</given-names></name>. <article-title>Random Forests</article-title>. <source>Machine Learning</source>. <year>2001</year>;<volume>45</volume>(<issue>1</issue>):<fpage>5</fpage>–<lpage>32</lpage>.</mixed-citation></ref>
<ref id="pone.0175383.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>. <article-title>Learning deep architectures for AI</article-title>. <source>Foundations and trends® in Machine Learning</source>. <year>2009</year>;<volume>2</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>127</lpage>.</mixed-citation></ref>
<ref id="pone.0175383.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wolpert</surname> <given-names>DH</given-names></name>. <article-title>Stacked generalization</article-title>. <source>Neural networks</source>. <year>1992</year>;<volume>5</volume>(<issue>2</issue>):<fpage>241</fpage>–<lpage>59</lpage>.</mixed-citation></ref>
<ref id="pone.0175383.ref033"><label>33</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Van der Laan</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Rose</surname> <given-names>S</given-names></name>. <source>Targeted learning: causal inference for observational and experimental data</source>: <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2011</year>.</mixed-citation></ref>
<ref id="pone.0175383.ref034"><label>34</label><mixed-citation publication-type="book" xlink:type="simple"><collab>R Core Team</collab>. <source>R: A language and environment for statistical computing</source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna, Austria</publisher-loc>. <year>2016</year>.</mixed-citation></ref>
<ref id="pone.0175383.ref035"><label>35</label><mixed-citation publication-type="other" xlink:type="simple">Aiello SK, Tom; Maj, Petr; with contributions from the H2O.ai team. h2o: R Interface for H2O. R package version 3.8.2.2. 2015.</mixed-citation></ref>
<ref id="pone.0175383.ref036"><label>36</label><mixed-citation publication-type="other" xlink:type="simple">LeDell EE. h2oEnsemble: H2O Ensemble Learning. R package version 0.1.8. 2016.</mixed-citation></ref>
<ref id="pone.0175383.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>DeLong</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>DeLong</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Clarke-Pearson</surname> <given-names>DL</given-names></name>. <article-title>Comparing the areas under two or more correlated receiver operating characteristic curves: a nonparametric approach</article-title>. <source>Biometrics</source>. <year>1988</year>:<fpage>837</fpage>–<lpage>45</lpage>. <object-id pub-id-type="pmid">3203132</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robin</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Turck</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hainard</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tiberti</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Lisacek</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sanchez</surname> <given-names>J-C</given-names></name>, <etal>et al</etal>. <article-title>pROC: an open-source package for R and S+ to analyze and compare ROC curves</article-title>. <source>BMC bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1</fpage>.</mixed-citation></ref>
<ref id="pone.0175383.ref039"><label>39</label><mixed-citation publication-type="other" xlink:type="simple">National Institutes of Health. Research instructions for NIH and other PHS agencies 2016 [cited 2017 01/24/2017]. Available from: <ext-link ext-link-type="uri" xlink:href="https://grants.nih.gov/grants/how-to-apply-application-guide/forms-d/research-forms-d.pdf" xlink:type="simple">https://grants.nih.gov/grants/how-to-apply-application-guide/forms-d/research-forms-d.pdf</ext-link>.</mixed-citation></ref>
<ref id="pone.0175383.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rose</surname> <given-names>S</given-names></name>. <article-title>Mortality risk score prediction in an elderly population using machine learning</article-title>. <source>American journal of epidemiology</source>. <year>2013</year>;<volume>177</volume>(<issue>5</issue>):<fpage>443</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/aje/kws241" xlink:type="simple">10.1093/aje/kws241</ext-link></comment> <object-id pub-id-type="pmid">23364879</object-id></mixed-citation></ref>
<ref id="pone.0175383.ref041"><label>41</label><mixed-citation publication-type="other" xlink:type="simple">Brierley P, Vogel D, Axelrod R. Heritage Provider Network Health Prize Round 1 Milestone Prize: How we did it–Team ‘Market Makers’. 2011.</mixed-citation></ref>
<ref id="pone.0175383.ref042"><label>42</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Rose</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>van der Laan</surname> <given-names>MJ</given-names></name>. <source>Why TMLE? Targeted Learning</source>: <publisher-name>Springer</publisher-name>; <year>2011</year>. p. <fpage>101</fpage>–<lpage>18</lpage>.</mixed-citation></ref>
<ref id="pone.0175383.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rose</surname> <given-names>S</given-names></name>. <article-title>Targeted Learning for Variable Importance</article-title>. <source>Handbook of Big Data</source>. <year>2016</year>:<volume>411</volume>.</mixed-citation></ref>
</ref-list>
</back>
</article>