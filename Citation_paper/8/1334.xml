<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-01928</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003176</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group><subj-group><subject>Evolutionary modeling</subject><subject>Sequence analysis</subject></subj-group></subj-group><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject><subj-group><subject>Coevolution</subject></subj-group></subj-group><subj-group><subject>Forms of evolution</subject><subj-group><subject>Coevolution</subject></subj-group></subj-group></subj-group><subj-group><subject>Proteomics</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physics</subject><subj-group><subject>Statistical mechanics</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>From Principal Component to Direct Coupling Analysis of Coevolution in Proteins: Low-Eigenvalue Modes are Needed for Structure Prediction</article-title>
<alt-title alt-title-type="running-head">Principal Component and Direct Coupling Analysis</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Cocco</surname><given-names>Simona</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Monasson</surname><given-names>Remi</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Weigt</surname><given-names>Martin</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Laboratoire de Physique Statistique de l'Ecole Normale Supérieure - UMR 8550, associé au CNRS et à l'Université Pierre et Marie Curie, Paris, France</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Laboratoire de Physique Théorique de l'Ecole Normale Supérieure - UMR 8549, associé au CNRS et à l'Université Pierre et Marie Curie, Paris, France</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Université Pierre et Marie Curie, UMR 7238 - Laboratoire de Génomique des Microorganismes, Paris, France</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Human Genetics Foundation, Torino, Italy</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Wallner</surname><given-names>Björn</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Linköping University, Sweden</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">martin.weigt@upmc.fr</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: SC RM MW. Performed the experiments: SC RM MW. Analyzed the data: SC RM MW. Contributed reagents/materials/analysis tools: SC RM MW. Wrote the paper: SC RM MW.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>8</month><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>22</day><month>8</month><year>2013</year></pub-date>
<volume>9</volume>
<issue>8</issue>
<elocation-id>e1003176</elocation-id>
<history>
<date date-type="received"><day>7</day><month>12</month><year>2012</year></date>
<date date-type="accepted"><day>24</day><month>6</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Cocco et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Various approaches have explored the covariation of residues in multiple-sequence alignments of homologous proteins to extract functional and structural information. Among those are principal component analysis (PCA), which identifies the most correlated groups of residues, and direct coupling analysis (DCA), a global inference method based on the maximum entropy principle, which aims at predicting residue-residue contacts. In this paper, inspired by the statistical physics of disordered systems, we introduce the Hopfield-Potts model to naturally interpolate between these two approaches. The Hopfield-Potts model allows us to identify relevant ‘patterns’ of residues from the knowledge of the eigenmodes and eigenvalues of the residue-residue correlation matrix. We show how the computation of such statistical patterns makes it possible to accurately predict residue-residue contacts with a much smaller number of parameters than DCA. This dimensional reduction allows us to avoid overfitting and to extract contact information from multiple-sequence alignments of reduced size. In addition, we show that low-eigenvalue correlation modes, discarded by PCA, are important to recover structural information: the corresponding patterns are highly localized, that is, they are concentrated in few sites, which we find to be in close contact in the three-dimensional protein fold.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Extracting functional and structural information about protein families from the covariation of residues in multiple sequence alignments is an important challenge in computational biology. Here we propose a statistical-physics inspired framework to analyze those covariations, which naturally unifies existing methods in the literature. Our approach allows us to identify statistically relevant ‘patterns’ of residues, specific to a protein family. We show that many patterns correspond to a small number of sites on the protein sequence, in close contact on the 3D fold. Hence, those patterns allow us to make accurate predictions about the contact map from sequence data only. Further more, we show that the dimensional reduction, which is achieved by considering only the statistically most significant patterns, avoids overfitting in small sequence alignments, and improves our capacity of extracting residue contacts in this case.</p>
</abstract>
<funding-group><funding-statement>This work benefited from the European Community FP7/2007–2013/grant agreement n°290038 (Netadis). The work was also facilitated by the Initiative for the Theoretical Sciences at the Graduate Center of the City University of New York, supported by the Burroughs-Wellcome Fund. SC and RM acknowledge the hospitality and the financial support of the Simons Center for Systems Biology, Institute for Advanced Studies, Princeton, where an initial part of this work was done. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="17"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Thanks to the constant progresses in DNA sequencing techniques, by now more than 4,400 full genomes are sequenced <xref ref-type="bibr" rid="pcbi.1003176-Pagani1">[1]</xref>, resulting in more than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e001" xlink:type="simple"/></inline-formula> known protein sequences <xref ref-type="bibr" rid="pcbi.1003176-The1">[2]</xref>, which are classified into more than 14,000 protein domain families <xref ref-type="bibr" rid="pcbi.1003176-Punta1">[3]</xref>, many of them containing in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e002" xlink:type="simple"/></inline-formula> homologous (<italic>i.e.</italic> evolutionarily related) amino-acid sequences. These huge numbers are contrasted by only about 92,000 experimentally resolved X-ray or NMR structures <xref ref-type="bibr" rid="pcbi.1003176-Berman1">[4]</xref>, many of them describing the same proteins. It is therefore tempting to use sequence data alone to extract information about the functional and the structural constraints acting on the evolution of those proteins. Analysis of single-residue conservation offers a first hint about those constraints: Highly conserved positions (easily detectable in multiple sequence alignments corresponding to one protein family) identify residues whose mutations are likely to disrupt the protein function, <italic>e.g.</italic> by the loss of its enzymatic properties. However, not all constraints result in strong single-site conservation. As is well-known, compensatory mutations can happen and preserve the integrity of a protein even if single site mutations have deleterious effects <xref ref-type="bibr" rid="pcbi.1003176-Gbel1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Lockless1">[6]</xref>. A natural idea is therefore to analyze covariations between residues, that is, whether their variations across sequences are correlated or not <xref ref-type="bibr" rid="pcbi.1003176-deJuan1">[7]</xref>. In this context, one introduces a matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e003" xlink:type="simple"/></inline-formula> of residue-residue correlations expressing how much the presence of amino-acid ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e004" xlink:type="simple"/></inline-formula>’ in position ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e005" xlink:type="simple"/></inline-formula>’ on the protein is correlated across the sequence data with the presence of another amino-acid ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e006" xlink:type="simple"/></inline-formula>’ in another position ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e007" xlink:type="simple"/></inline-formula>’. Extracting information from this matrix has been the subject of numerous studies over the past two decades, see <italic>e.g.</italic> <xref ref-type="bibr" rid="pcbi.1003176-Gbel1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Lockless1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Casari1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1003176-Jones1">[21]</xref> and <xref ref-type="bibr" rid="pcbi.1003176-deJuan1">[7]</xref> for a recent up-to-date review of the field. In difference to these correlation-based approaches, Yeang <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003176-Yeang1">[22]</xref>, proposed a simple evolutionary model which measures coevolution in terms of deviation from independent-site evolution. However, a full dynamical model for residue coevolution is still outstanding.</p>
<p>The direct use of correlations for discovering structural constraints such as residue-residue contacts in a protein fold has, unfortunately, remained of limited accuracy <xref ref-type="bibr" rid="pcbi.1003176-Gbel1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Lockless1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Ortiz1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Ortiz2">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Fodor1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Dunn1">[16]</xref>. More sophisticated approaches to exploit the information included in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e008" xlink:type="simple"/></inline-formula> are based on a <italic>Maximum Entropy</italic> (MaxEnt) <xref ref-type="bibr" rid="pcbi.1003176-Jaynes1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Jaynes2">[24]</xref> modeling. The underlying idea is to look for the simplest statistical model of protein sequences capable of reproducing empirically observed correlations. MaxEnt has been used to analyze many types of biological data, ranging from multi-electrode recording of neural activities <xref ref-type="bibr" rid="pcbi.1003176-Schneidman1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Cocco1">[26]</xref>, gene concentrations in genetic networks <xref ref-type="bibr" rid="pcbi.1003176-Lezon1">[27]</xref>, bird flocking <xref ref-type="bibr" rid="pcbi.1003176-Bialek1">[28]</xref> etc. MaxEnt to model covariation in protein sequences was first proposed in a purely theoretical setting by Lapedes <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003176-Lapedes2">[29]</xref>, and applied to protein sequences in an unpublished preprint by Lapedes <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003176-Lapedes1">[12]</xref>. It was used – even if not explicitly stated – by Ranganathan and coworkers to generate random protein sequences through Monte Carlo simulations, as a part of an approach called Statistical Coupling Analysis (SCA) <xref ref-type="bibr" rid="pcbi.1003176-Russ1">[15]</xref>. Remarkably, many of those artificial proteins folded into a native-like state, demonstrating that MaxEnt modeling was able to statistically capture essential features of the protein family. Recently, one of us proposed, in a series of collaborations, two analytical approaches based on mean-field type approximations of statistical physics, called <italic>Direct Coupling Analysis</italic> (DCA), to efficiently compute and exploit this MaxEnt distribution (<xref ref-type="bibr" rid="pcbi.1003176-Weigt1">[17]</xref> uses message passing <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>, a computationally more efficient naive mean-field approximation), related approaches developed partially in parallel are <xref ref-type="bibr" rid="pcbi.1003176-Burger1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Balakrishnan1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Jones1">[21]</xref>. Informally speaking, DCA allows for disentangling direct contributions to correlations (resulting from native contacts) from indirect contributions (mediated through chains of native contacts). Hence, DCA offers a much more accurate image of the contact map than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e009" xlink:type="simple"/></inline-formula> itself. The full potential of maximum-entropy modeling for accurate structural prediction was first recognized in <xref ref-type="bibr" rid="pcbi.1003176-Schug1">[30]</xref> (quaternary structure prediction) and in <xref ref-type="bibr" rid="pcbi.1003176-Marks1">[31]</xref> (tertiary structure prediction), and further applied by <xref ref-type="bibr" rid="pcbi.1003176-Sadowski1">[32]</xref>–<xref ref-type="bibr" rid="pcbi.1003176-Taylor1">[38]</xref>. It became obvious that the extracted information is sufficient to predict folds of relatively long proteins and transmembrane domains. In <xref ref-type="bibr" rid="pcbi.1003176-Dago1">[36]</xref> it was used to rationally design mutagenesis experiments to repair a non-functional hybrid protein, and thus to confirm the predicted structure.</p>
<p>Despite its success, MaxEnt modeling raises several concerns. The number of ‘direct coupling’ parameters necessary to define the MaxEnt model over the set of protein sequences, is of the order of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e010" xlink:type="simple"/></inline-formula>. Here, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e011" xlink:type="simple"/></inline-formula> is the protein length, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e012" xlink:type="simple"/></inline-formula> is the number of amino acids (including the gap). So, for realistic protein lengths of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e013" xlink:type="simple"/></inline-formula>, we end up with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e014" xlink:type="simple"/></inline-formula> parameters, which have to be inferred from alignments of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e015" xlink:type="simple"/></inline-formula> proteins. Overfitting the sequence data is therefore a major risk.</p>
<p>Another mathematically simpler way to extract information from the correlation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e016" xlink:type="simple"/></inline-formula> is Principal Component Analysis (PCA) <xref ref-type="bibr" rid="pcbi.1003176-Pearson1">[39]</xref>. PCA looks for the eigenmodes of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e017" xlink:type="simple"/></inline-formula> associated to the largest eigenvalues. These modes are the ones contributing most to the covariation in the protein family. Combined with clustering approaches, PCA was applied to identify functional residues in <xref ref-type="bibr" rid="pcbi.1003176-Casari1">[8]</xref>. More recently PCA was applied to the SCA correlation matrix, a variant of the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e018" xlink:type="simple"/></inline-formula> expressing correlations between sites only (and not explicitly the amino-acids they carry) and allowed for identifying groups of correlated (coevolving) residues – termed sectors – each controlling a specific function <xref ref-type="bibr" rid="pcbi.1003176-Halabi1">[40]</xref>. A fundamental issue with PCA is the determination of the number of relevant eigenmodes. This is usually done by comparing the spectrum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e019" xlink:type="simple"/></inline-formula> with a null model, the Marcenko-Pastur (MP) distribution, describing the spectral properties of the sample covariance matrix of a set of independent variables <xref ref-type="bibr" rid="pcbi.1003176-Bai1">[41]</xref>. Eigenvalues larger than the top edge of the MP distribution cannot be explained from sampling noise and are selected, while lower eigenvalues – inside the bulk of the MP spectrum, or even lower – are rejected.</p>
<p>In this article we show that there exists a deep connection between DCA and PCA. To do so we consider the Hopfield-Potts model, an extension of the Hopfield model introduced three decades ago in computational neuroscience <xref ref-type="bibr" rid="pcbi.1003176-Hopfield1">[42]</xref>, to the case of variables taking <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e020" xlink:type="simple"/></inline-formula> values. The Hopfield-Potts model is based on the concept of patterns, that is, of special directions in sequence space. These patterns show some similarities with sequence motifs or position-specific scoring matrices, but instead of encoding independent-site amino-acid preferences, they include statistical couplings between sequence positions. Some of these patterns are ‘attractive’, defining ‘ideal’ sequence motifs which real sequences in the protein family try to mimic. In distinction to the original Hopfield model <xref ref-type="bibr" rid="pcbi.1003176-Hopfield1">[42]</xref>, we also find ‘repulsive’ patterns, which define regions in the sequence space deprived of real sequences. The statistical mechanics of the inverse Hopfield model, studied in <xref ref-type="bibr" rid="pcbi.1003176-Cocco2">[43]</xref> for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e021" xlink:type="simple"/></inline-formula> case and extended here to the generic <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e022" xlink:type="simple"/></inline-formula> Potts case, shows that it naturally interpolates between PCA and DCA, and allows us to study the statistical issues raised by those approaches exposed above. We show that, in contradistinction with PCA, low eigenvalues and eigenmodes are important to recover structural information about the proteins, and should not be discarded. In addition, we propose a maximum likelihood criterion for pattern selection, not based on the comparison with the MP spectrum. We study the nature of the statistically most significant eigenmodes, and show that they exhibit remarkable features in term of localization: most repulsive patterns are strongly localized on a few sites, generally found to be in close contact on the three-dimensional structure of the proteins. As for DCA, we show that the dimensionality of the MaxEnt model can be very efficiently reduced with essentially no loss of predictive power for the contact map in the case of large multiple-sequence alignments, and with an improved accuracy in the case of small alignments containing too few sequences for standard mean-field DCA to work. These conclusions are established both from theoretical arguments, and from the direct application of the Hopfield-Potts model to a number of sample protein families.</p>
<sec id="s1a">
<title>A short reminder of covariation analysis</title>
<p>Data are given in form of a <italic>multiple sequence alignment</italic> (MSA), in which each row contains the amino-acid sequence of one protein, and each column one residue position in these proteins, which is aligned based on amino-acid similarity. We denote the MSA by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e023" xlink:type="simple"/></inline-formula> with index <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e024" xlink:type="simple"/></inline-formula> running over the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e025" xlink:type="simple"/></inline-formula> columns of the alignment (residue positions/sites), and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e026" xlink:type="simple"/></inline-formula> over the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e027" xlink:type="simple"/></inline-formula> sequences, which constitute the rows of the MSA. The amino-acids <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e028" xlink:type="simple"/></inline-formula> are assumed to be represented by natural numbers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e029" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e030" xlink:type="simple"/></inline-formula>, where we include the 20 standard amino acids and the alignment gap ‘-’.</p>
<p>In our approach, we do not use the data directly, but we summarize them by the amino-acid occupancies in single columns and pairs of columns of the MSA (cf. <xref ref-type="sec" rid="s4">Methods</xref> for data preprocessing),<disp-formula id="pcbi.1003176.e031"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e031" xlink:type="simple"/><label>(1)</label></disp-formula><disp-formula id="pcbi.1003176.e032"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e032" xlink:type="simple"/><label>(2)</label></disp-formula>with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e033" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e034" xlink:type="simple"/></inline-formula>. The Kronecker symbol <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e035" xlink:type="simple"/></inline-formula> equals one for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e036" xlink:type="simple"/></inline-formula>, and zero else. Since frequencies sum up to one, we can discard one amino-acid value (<italic>e.g.</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e037" xlink:type="simple"/></inline-formula>) for each position without losing any information about the sequence statistics. We define the empirical covariance matrix through<disp-formula id="pcbi.1003176.e038"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e038" xlink:type="simple"/><label>(3)</label></disp-formula>with the position index <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e039" xlink:type="simple"/></inline-formula> running from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e040" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e041" xlink:type="simple"/></inline-formula>, and the amino-acid index from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e042" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e043" xlink:type="simple"/></inline-formula>. The covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e044" xlink:type="simple"/></inline-formula> can therefore be interpreted as a square matrix with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e045" xlink:type="simple"/></inline-formula> rows and columns. We will adopt this interpretation throughout the paper, since the methods proposed become easier in terms of the linear algebra of this matrix.</p>
<sec id="s1a1">
<title>Maximum entropy modeling and direct couplings</title>
<p>Non-zero covariance between two sites does not necessarily imply the sites to directly interact for functional or structural purposes <xref ref-type="bibr" rid="pcbi.1003176-Fodor1">[13]</xref>. The reason is the following <xref ref-type="bibr" rid="pcbi.1003176-Weigt1">[17]</xref>: When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e046" xlink:type="simple"/></inline-formula> interacts with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e047" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e048" xlink:type="simple"/></inline-formula> interacts with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e049" xlink:type="simple"/></inline-formula>, also <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e050" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e051" xlink:type="simple"/></inline-formula> will show correlations even it they do not interact. It is thus important to distinguish between <italic>direct</italic> and <italic>indirect</italic> correlations, and to infer <italic>networks of direct couplings</italic>, which generate the empirically observed covariances. This can be done by constructing a (protein-family specific) statistical model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e052" xlink:type="simple"/></inline-formula>, which describes the probability of observing a particular amino-acid sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e053" xlink:type="simple"/></inline-formula>. Due to the limited amount of available data, we require this model to reproduce empirical frequency counts for single MSA columns and column pairs,<disp-formula id="pcbi.1003176.e054"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e054" xlink:type="simple"/><label>(4)</label></disp-formula><disp-formula id="pcbi.1003176.e055"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e055" xlink:type="simple"/><label>(5)</label></disp-formula><italic>i.e.</italic> marginal distributions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e056" xlink:type="simple"/></inline-formula> are required to coincide with the empirical counts up to the level of position pairs. Beyond this coherence, we aim at the <italic>least constrained</italic> statistical description. The <italic>maximum-entropy principle</italic> <xref ref-type="bibr" rid="pcbi.1003176-Jaynes1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Jaynes2">[24]</xref> stipulates that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e057" xlink:type="simple"/></inline-formula> is found by maximizing the entropy<disp-formula id="pcbi.1003176.e058"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e058" xlink:type="simple"/><label>(6)</label></disp-formula>subject to the constraints <xref ref-type="disp-formula" rid="pcbi.1003176.e054">Eqs. (4)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003176.e055">(5)</xref>. We readily find the analytical form<disp-formula id="pcbi.1003176.e059"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e059" xlink:type="simple"/><label>(7)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e060" xlink:type="simple"/></inline-formula> is a normalization constant. The MaxEnt model thus takes the form of a (generalized) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e061" xlink:type="simple"/></inline-formula>-states Potts model, a celebrated model in statistical physics <xref ref-type="bibr" rid="pcbi.1003176-Wu1">[44]</xref>, or a Markov random field in a more mathematical language. The parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e062" xlink:type="simple"/></inline-formula> are the direct couplings between MSA columns, and the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e063" xlink:type="simple"/></inline-formula> represent the local fields (position-weight matrices) acting on single sites. Their values have to be determined such that <xref ref-type="disp-formula" rid="pcbi.1003176.e054">Eqs. (4)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003176.e055">(5)</xref> are satisfied. Note that, without the coupling terms <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e064" xlink:type="simple"/></inline-formula>, the model would reduce to a standard position-specific scoring matrix. It would describe independent sites, and thus it would be intrinsically unable to capture residue covariation.</p>
<p>From a computational point of view, however, it is not possible to solve <xref ref-type="disp-formula" rid="pcbi.1003176.e054">Eqs. (4)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003176.e055">(5)</xref> exactly. The reason is that the calculations of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e065" xlink:type="simple"/></inline-formula> and of the marginals require summations over all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e066" xlink:type="simple"/></inline-formula> possible amino-acid sequences of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e067" xlink:type="simple"/></inline-formula>. With <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e068" xlink:type="simple"/></inline-formula> and typical protein lengths of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e069" xlink:type="simple"/></inline-formula>, the numbers of configurations are enormous, of the order of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e070" xlink:type="simple"/></inline-formula>. The way out is an approximate determination of the model parameters. The computationally most efficient way found so far is an approximation, called mean field in statistical physics, leading to the approach known as <italic>direct coupling analysis</italic> <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>. Within this mean-field approximation, the values for the direct couplings are simply equal to<disp-formula id="pcbi.1003176.e071"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e071" xlink:type="simple"/><label>(8)</label></disp-formula>and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e072" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e073" xlink:type="simple"/></inline-formula> Note that the couplings can be approximated with this formula in a time of the order of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e074" xlink:type="simple"/></inline-formula>, instead of the exponential time complexity, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e075" xlink:type="simple"/></inline-formula>, of the exact calculation. On a single desktop PC, this can be achieved in a few seconds to minutes, depending on the length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e076" xlink:type="simple"/></inline-formula> of the protein sequences.</p>
<p>The problem can be formulated equivalently in terms of maximum-likelihood (ML) inference. Assuming <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e077" xlink:type="simple"/></inline-formula> to be a pairwise model of the form of <xref ref-type="disp-formula" rid="pcbi.1003176.e059">Eq. (7)</xref>, we aim at maximizing the log-likelihood<disp-formula id="pcbi.1003176.e078"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e078" xlink:type="simple"/><label>(9)</label></disp-formula>of the model parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e079" xlink:type="simple"/></inline-formula> given the MSA <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e080" xlink:type="simple"/></inline-formula>. This maximization implies that <xref ref-type="disp-formula" rid="pcbi.1003176.e054">Eqs. (4)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003176.e055">(5)</xref> hold. In the rest of the paper, we will adopt the point of view of ML inference, cf. the details given in <xref ref-type="sec" rid="s4">Methods</xref>. Note that, without restrictions on the couplings <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e081" xlink:type="simple"/></inline-formula> ML and MaxEnt inference are equivalent, but under the specific form for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e082" xlink:type="simple"/></inline-formula> assumed in the Hopfield-Potts model, this equivalence will break down. More precisely, the ML model will fit <xref ref-type="disp-formula" rid="pcbi.1003176.e054">Eqs. (4)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003176.e055">(5)</xref> only approximately</p>
<p>Once the direct couplings <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e083" xlink:type="simple"/></inline-formula> have been calculated, they can be used to make predictions about the contacts between residues, details can be found in the <xref ref-type="sec" rid="s4">Methods</xref> Section. In <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>, it was shown that the predictions for the residue-residue contacts in proteins are very accurate. In other words, DCA allows to find a very good estimate of a partial contact map from sequence data only. Subsequent works have shown that this contact map can be completed by embedding it into three dimensions <xref ref-type="bibr" rid="pcbi.1003176-Marks1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Sulkowska1">[33]</xref>.</p>
</sec><sec id="s1a2">
<title>Pearson correlation matrix and principal component analysis</title>
<p>Another way to extract information about groups of correlated residues is the following. From the covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e084" xlink:type="simple"/></inline-formula> given in <xref ref-type="disp-formula" rid="pcbi.1003176.e038">Eq. (3)</xref>, we construct the Pearson correlation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e085" xlink:type="simple"/></inline-formula> through the relationship<disp-formula id="pcbi.1003176.e086"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e086" xlink:type="simple"/><label>(10)</label></disp-formula>where the matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e087" xlink:type="simple"/></inline-formula> are the square roots of the single-site correlation matrices, <italic>i.e.</italic><disp-formula id="pcbi.1003176.e088"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e088" xlink:type="simple"/><label>(11)</label></disp-formula>This particular form of the Pearson correlation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e089" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003176.e086">Eq. (10)</xref> results from the fact that we have projected the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e090" xlink:type="simple"/></inline-formula>-dimensional space defined by the amino-acids <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e091" xlink:type="simple"/></inline-formula> onto the subspace spanned by the first <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e092" xlink:type="simple"/></inline-formula> dimensions. Alternative projections lead to modified but equivalent expressions of the Pearson matrix, cf. <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref> (Sec. S1.3). Informally speaking, the correlation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e093" xlink:type="simple"/></inline-formula> is a measure of comparison of the empirical covariance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e094" xlink:type="simple"/></inline-formula> with the single-site fluctuations taken independently. Hence, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e095" xlink:type="simple"/></inline-formula> is normalized and coincides with the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e096" xlink:type="simple"/></inline-formula> identity matrix on each site: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e097" xlink:type="simple"/></inline-formula>.</p>
<p>We further introduce the eigenvalues and eigenvectors (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e098" xlink:type="simple"/></inline-formula>)<disp-formula id="pcbi.1003176.e099"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e099" xlink:type="simple"/><label>(12)</label></disp-formula>where the eigenvalues are ordered in decreasing order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e100" xlink:type="simple"/></inline-formula>. The eigenvectors are chosen to form an ortho-normal basis,<disp-formula id="pcbi.1003176.e101"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e101" xlink:type="simple"/><label>(13)</label></disp-formula>for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e102" xlink:type="simple"/></inline-formula>. Principal component analysis consists in a partial eigendecomposition of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e103" xlink:type="simple"/></inline-formula>, keeping only the eigenmodes contributing most to the correlations, <italic>i.e.</italic> with the largest eigenvalues. All the other eigenvectors are discarded. In this way, the directions of maximum covariation of the residues are identified.</p>
<p>PCA was used by Casari <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003176-Casari1">[8]</xref> in the context of residue covariation to identify functional sites specific to subfamilies of a protein family given by a large MSA. To do so, the authors diagonalized the comparison matrix, whose elements <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e104" xlink:type="simple"/></inline-formula> count the number of identical residues for each pair of sequences (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e105" xlink:type="simple"/></inline-formula>). Projection of sequences onto the top eigenvectors of the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e106" xlink:type="simple"/></inline-formula> allows to identify groups of subfamily-specific co-conserved residues responsible for subfamily-specific functional properties, called specificity-determining positions (SDP). Up to date, PCA (or the closely related multiple correspondence analysis) is used in one of the most efficient tools, called S3det, to detect SDPs <xref ref-type="bibr" rid="pcbi.1003176-Rausell1">[45]</xref>. PCA was also used in an approach introduced by Ranganathan and coworkers <xref ref-type="bibr" rid="pcbi.1003176-Lockless1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Halabi1">[40]</xref>, called statistical coupling analysis (SCA). In this approach a modified residue covariance matrix, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e107" xlink:type="simple"/></inline-formula>, is introduced :<disp-formula id="pcbi.1003176.e108"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e108" xlink:type="simple"/><label>(14)</label></disp-formula>where the weights <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e109" xlink:type="simple"/></inline-formula> favor positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e110" xlink:type="simple"/></inline-formula> and residues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e111" xlink:type="simple"/></inline-formula> of high conservation. Amino-acid indices are contracted to define the effective covariance matrix,<disp-formula id="pcbi.1003176.e112"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e112" xlink:type="simple"/><label>(15)</label></disp-formula>The entries of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e113" xlink:type="simple"/></inline-formula> depend on the residue positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e114" xlink:type="simple"/></inline-formula> only. In a variant of SCA the amino-acid information is directly contracted at the level of the sequence data. A binary variable is associated to each site: it is equal to one in sequences carrying the consensus amino-acid, to zero otherwise <xref ref-type="bibr" rid="pcbi.1003176-Halabi1">[40]</xref>. Principal component analysis can then be applied to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e115" xlink:type="simple"/></inline-formula>-dimensional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e116" xlink:type="simple"/></inline-formula> matrix, and used to define so-called sectors, <italic>i.e.</italic> clusters of evolutionarily correlated sites.</p>
</sec></sec></sec><sec id="s2">
<title>Results</title>
<p>To bridge these two approaches – DCA and PCA – we introduce the Hopfield-Potts model for the maximum likelihood modeling of the sequence distribution, given the residue frequencies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e117" xlink:type="simple"/></inline-formula> and their pairwise correlations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e118" xlink:type="simple"/></inline-formula>. From a mathematical point of view, the model corresponds to a specific class of Potts models, in which the coupling matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e119" xlink:type="simple"/></inline-formula> is of low rank <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e120" xlink:type="simple"/></inline-formula> compared to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e121" xlink:type="simple"/></inline-formula>. It therefore offers a natural way to reduce the number of parameters far below what is required in the mean-field approximation of <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>. In addition, the solution of the Hopfield-Potts inverse problem, <italic>i.e.</italic> the determination of the low rank coupling matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e122" xlink:type="simple"/></inline-formula>, allows us to establish a direct connection with the spectral properties of the Pearson correlation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e123" xlink:type="simple"/></inline-formula> and thus with PCA.</p>
<p>Here, we first give an overview over the most important theoretical results for Hopfield-Potts model inference, increasing levels of detail about the algorithm and its derivation are provided in <xref ref-type="sec" rid="s4">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>. Subsequently we discuss in detail the features of the Hopfield-Potts patterns found in three different protein families, and finally assess our capacity to detect residue contacts using sequence information alone in a larger test set of protein families.</p>
<sec id="s2a">
<title>Inference with the Hopfield-Potts model</title>
<p>The main idea of this work is that, though the space of sequences is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e124" xlink:type="simple"/></inline-formula>–dimensional, the number of spatial directions being relevant for covariation is much smaller. Such a relevant direction is called <italic>pattern</italic> in the following, and given by a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e125" xlink:type="simple"/></inline-formula> matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e126" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e127" xlink:type="simple"/></inline-formula> being the site indices, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e128" xlink:type="simple"/></inline-formula> the amino acids. The <italic>log-score</italic> of a sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e129" xlink:type="simple"/></inline-formula> for one pattern <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e130" xlink:type="simple"/></inline-formula> is defined as<disp-formula id="pcbi.1003176.e131"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e131" xlink:type="simple"/><label>(16)</label></disp-formula>This expression bears a strong similarity with, but also a crucial difference to a position-specific scoring matrix (PSSM): As in a PSSM, the log-score depends on a sum over position and amino-acid specific contributions, but its non-linearity (the square in <xref ref-type="disp-formula" rid="pcbi.1003176.e131">Eq. (16)</xref>) introduces residue-residue couplings, and thus is essential to take covariation into account.</p>
<p>In the Hopfield-Potts model, the probability of an amino-acid sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e132" xlink:type="simple"/></inline-formula> depends on the combined log-scores along a number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e133" xlink:type="simple"/></inline-formula> of patterns through<disp-formula id="pcbi.1003176.e134"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e134" xlink:type="simple"/><label>(17)</label></disp-formula>Patterns denoted with a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e135" xlink:type="simple"/></inline-formula>-superscript, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e136" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e137" xlink:type="simple"/></inline-formula>, are said to be <italic>attractive</italic>, while the patterns labeled with a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e138" xlink:type="simple"/></inline-formula>-superscript, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e139" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e140" xlink:type="simple"/></inline-formula>, are called <italic>repulsive</italic>. For the probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e141" xlink:type="simple"/></inline-formula> to be large, the log-scores <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e142" xlink:type="simple"/></inline-formula> for attractive patterns must be large, whereas the log-scores for repulsive patterns must be small (close to zero). As we will see in the following, the inclusion of such repulsive patterns is important: Compared to the mixed model (17), a model with only attractive patterns achieves a much smaller likelihood (at each given total number of parameters) and a strongly reduced predictivity of residue-residue contacts.</p>
<p>It is easy to see that <xref ref-type="disp-formula" rid="pcbi.1003176.e134">Eq. (17)</xref> corresponds to a specific choice of the couplings <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e143" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003176.e059">Eq. (7)</xref>, namely<disp-formula id="pcbi.1003176.e144"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e144" xlink:type="simple"/><label>(18)</label></disp-formula>where, without loss of generality, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e145" xlink:type="simple"/></inline-formula> component of the patterns is set to zero, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e146" xlink:type="simple"/></inline-formula>, for compatibility with the mean-field approach exposed above. Note that the coupling matrix, for linearly independent patterns, has rank <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e147" xlink:type="simple"/></inline-formula>, and is defined from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e148" xlink:type="simple"/></inline-formula> pattern components only, instead of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e149" xlink:type="simple"/></inline-formula> parameters for the most general case of coupling matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e150" xlink:type="simple"/></inline-formula>. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e151" xlink:type="simple"/></inline-formula>, <italic>i.e.</italic> when all the patterns are taken into account, the coupling matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e152" xlink:type="simple"/></inline-formula> has full rank, and the Hopfield-Potts model is identical to the Potts model used to infer the couplings in DCA in <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>. All results of mean-field DCA are thus recovered in this limiting case.</p>
<p>The patterns are to be determined by ML inference, cf. <xref ref-type="sec" rid="s4">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref> for details. In mean-field approximation, they can be expressed in terms of the eigenvalues and eigenvectors of the Pearson correlation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e153" xlink:type="simple"/></inline-formula>, which were defined in <xref ref-type="disp-formula" rid="pcbi.1003176.e099">Eq. (12)</xref>. We find that attractive patterns correspond to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e154" xlink:type="simple"/></inline-formula> largest eigenvalues (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e155" xlink:type="simple"/></inline-formula>),<disp-formula id="pcbi.1003176.e156"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e156" xlink:type="simple"/><label>(19)</label></disp-formula>and repulsive patterns to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e157" xlink:type="simple"/></inline-formula> smallest eigenvalues (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e158" xlink:type="simple"/></inline-formula>),<disp-formula id="pcbi.1003176.e159"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e159" xlink:type="simple"/><label>(20)</label></disp-formula>where, for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e160" xlink:type="simple"/></inline-formula>,<disp-formula id="pcbi.1003176.e161"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e161" xlink:type="simple"/><label>(21)</label></disp-formula>The prefactor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e162" xlink:type="simple"/></inline-formula> vanishes for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e163" xlink:type="simple"/></inline-formula>. It is not surprising that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e164" xlink:type="simple"/></inline-formula> plays a special role, as it coincides with the mean of the eigenvalues:<disp-formula id="pcbi.1003176.e165"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e165" xlink:type="simple"/><label>(22)</label></disp-formula>In the absence of any covariation between the residues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e166" xlink:type="simple"/></inline-formula> becomes the identity matrix, and all eigenvalues are unity. Hence all patterns vanish, and so does the coupling matrix (18). The Potts model (17) depends only on the local bias parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e167" xlink:type="simple"/></inline-formula>, and it reduces to a PSSM describing independent sites.</p>
<p>The eigenvectors of the correlation matrix with large eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e168" xlink:type="simple"/></inline-formula> contribute most to the covariation observed in the MSA (i.e. to the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e169" xlink:type="simple"/></inline-formula>), but they do not contribute most to the coupling matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e170" xlink:type="simple"/></inline-formula>. In the expression (18) for this matrix, each pattern carries a prefactor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e171" xlink:type="simple"/></inline-formula>: Whereas this prefactor remains smaller than one for attractive patterns (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e172" xlink:type="simple"/></inline-formula>), it can become very large for repulsive patterns (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e173" xlink:type="simple"/></inline-formula>), see <xref ref-type="fig" rid="pcbi-1003176-g001">Fig. 1</xref> (right panel). Thus, the contribution of a repulsive pattern to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e174" xlink:type="simple"/></inline-formula> matrix may be much larger than the contribution of any attractive pattern.</p>
<fig id="pcbi-1003176-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003176.g001</object-id><label>Figure 1</label><caption>
<title>Pattern selection by maximum likelihood and pattern prefactors.</title>
<p><italic>(Left panel)</italic> Contribution of patterns to the log-likelihood (full red line) as a function of the corresponding eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e175" xlink:type="simple"/></inline-formula> of the Pearson correlation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e176" xlink:type="simple"/></inline-formula>. To select <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e177" xlink:type="simple"/></inline-formula> patterns, a log-likelihood threshold <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e178" xlink:type="simple"/></inline-formula> (dashed black line) has to be chosen such that there are exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e179" xlink:type="simple"/></inline-formula> patterns with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e180" xlink:type="simple"/></inline-formula>. This corresponds to eigenvalues in the left and right tail of the spectrum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e181" xlink:type="simple"/></inline-formula>. <italic>(right panel)</italic> Pattern prefactors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e182" xlink:type="simple"/></inline-formula> (full red line) as a function of the eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e183" xlink:type="simple"/></inline-formula>. Patterns corresponding to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e184" xlink:type="simple"/></inline-formula> have essentially vanishing prefactors; patterns associated to large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e185" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e186" xlink:type="simple"/></inline-formula>) have prefactors smaller than 1 (dashed black line), while patterns corresponding to small <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e187" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e188" xlink:type="simple"/></inline-formula>) have unbounded prefactors.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003176.g001" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="disp-formula" rid="pcbi.1003176.e156">Eqs. (19)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003176.e159">(20)</xref> <italic>a priori</italic> define <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e189" xlink:type="simple"/></inline-formula> different patterns, therefore we need a rule for selecting the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e190" xlink:type="simple"/></inline-formula> ‘best’, i.e. most likely patterns. We show in <xref ref-type="sec" rid="s4">Methods</xref> that the contribution of a pattern to the model's log-likelihood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e191" xlink:type="simple"/></inline-formula> defined in <xref ref-type="disp-formula" rid="pcbi.1003176.e078">Eq. (9)</xref> is a function of the associated eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e192" xlink:type="simple"/></inline-formula> only,<disp-formula id="pcbi.1003176.e193"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e193" xlink:type="simple"/><label>(23)</label></disp-formula>As is shown in <xref ref-type="fig" rid="pcbi-1003176-g001">Fig. 1</xref> (left panel), large contributions arrive from both the largest and the smallest eigenvalues, whereas eigenvalues close to unity contribute little. According to ML inference, we have to select the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e194" xlink:type="simple"/></inline-formula> eigenvalues with largest contributions. To this end, we define a threshold value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e195" xlink:type="simple"/></inline-formula> such that there are exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e196" xlink:type="simple"/></inline-formula> patterns with larger contributions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e197" xlink:type="simple"/></inline-formula> to the log-likelihood; the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e198" xlink:type="simple"/></inline-formula> patterns with smaller <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e199" xlink:type="simple"/></inline-formula> are omitted in the expression for the couplings <xref ref-type="disp-formula" rid="pcbi.1003176.e144">Eq. (18)</xref>. In accordance with <xref ref-type="fig" rid="pcbi-1003176-g001">Fig. 1</xref>, we determine thus the two positive real roots <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e200" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e201" xlink:type="simple"/></inline-formula>) of the equation<disp-formula id="pcbi.1003176.e202"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e202" xlink:type="simple"/><label>(24)</label></disp-formula>and include all repulsive patterns with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e203" xlink:type="simple"/></inline-formula>, calling their number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e204" xlink:type="simple"/></inline-formula>, and all attractive patterns with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e205" xlink:type="simple"/></inline-formula>, denoting their number by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e206" xlink:type="simple"/></inline-formula>. The total number of selected patterns is thus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e207" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2b">
<title>Features of the Hopfield-Potts patterns</title>
<p>We have tested the above inference framework in great detail using three protein families, with variable values of protein length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e208" xlink:type="simple"/></inline-formula> and sequence number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e209" xlink:type="simple"/></inline-formula>:</p>
<list list-type="bullet"><list-item>
<p>The <italic>Kunitz/Bovine pancreatic trypsin inhibitor</italic> domain (PFAM ID PF00014) is a relatively short (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e210" xlink:type="simple"/></inline-formula>) and not very frequent (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e211" xlink:type="simple"/></inline-formula>) domain, after reweighting the effective number of diverged sequences is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e212" xlink:type="simple"/></inline-formula> (cf. <xref ref-type="disp-formula" rid="pcbi.1003176.e411">Eq. (28)</xref> in <xref ref-type="sec" rid="s4">Methods</xref> for the definition). Results are compared to the exemplary X-ray crystal structure with PDB ID 5pti <xref ref-type="bibr" rid="pcbi.1003176-Wlodawer1">[46]</xref>.</p>
</list-item><list-item>
<p>The bacterial <italic>Response regulator</italic> domain (PF00072) is of medium length (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e213" xlink:type="simple"/></inline-formula>) and very frequent (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e214" xlink:type="simple"/></inline-formula>). The effective sequence number is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e215" xlink:type="simple"/></inline-formula>. The PDB structure used for verification has ID 1nxw <xref ref-type="bibr" rid="pcbi.1003176-Bent1">[47]</xref>.</p>
</list-item><list-item>
<p>The eukaryotic signaling domain <italic>Ras</italic> (PF00071) is the longest (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e216" xlink:type="simple"/></inline-formula>) and has an intermediate size MSA (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e217" xlink:type="simple"/></inline-formula>), leading to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e218" xlink:type="simple"/></inline-formula>. Results are compared to PDB entry 5p21 <xref ref-type="bibr" rid="pcbi.1003176-Pai1">[48]</xref>.</p>
</list-item></list>
<p>In a second step, we have used the 15 protein families studied in <xref ref-type="bibr" rid="pcbi.1003176-Sulkowska1">[33]</xref> to verify that our findings are not specific to the three above families, but generalize to other families. A list of the 15 proteins together with the considered PDB structures is provided in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>, Section 4.</p>
<p>To interpret the Hopfield patterns in terms of amino-acid sequences, we first report some empirical observations made for the patterns corresponding to the largest and smallest eigenvalues, <italic>i.e.</italic> to the most likely attractive and repulsive patterns. We concentrate our discussion in the main text on one protein family, the Trypsin inhibitor (PF00014). Analogous properties in the other two protein families are reported in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>.</p>
<p>The upper panel of <xref ref-type="fig" rid="pcbi-1003176-g002">Fig. 2</xref> shows the spectral density. It is characterized by a pronounced peak around eigenvalue 1. The smallest eigenvalue is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e219" xlink:type="simple"/></inline-formula>, the largest is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e220" xlink:type="simple"/></inline-formula>. Large eigenvalues are isolated from the bulk of the spectrum, small eigenvalues are not.</p>
<fig id="pcbi-1003176-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003176.g002</object-id><label>Figure 2</label><caption>
<title>Eigenvalues, localization and contributions to couplings for PF00014.</title>
<p>(From top to bottom): <italic>(top panel)</italic> Spectral density as a function of the eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e221" xlink:type="simple"/></inline-formula>, note the existence of few very large eigenvalues, and a pronounced peak in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e222" xlink:type="simple"/></inline-formula>. <italic>(middle panel)</italic> Inverse participation ratio of the Hopfield patterns as a function of the corresponding eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e223" xlink:type="simple"/></inline-formula>. Large IPR characterizes the concentration of a pattern to few positions and amino acids. <italic>(bottom panel)</italic> Typical contribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e224" xlink:type="simple"/></inline-formula> to couplings due to each Hopfield pattern, defined in <xref ref-type="disp-formula" rid="pcbi.1003176.e240">Eq. (26)</xref>, as a function of the corresponding eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e225" xlink:type="simple"/></inline-formula>. Large contributions are mostly found for small eigenvalues, while patterns corresponding to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e226" xlink:type="simple"/></inline-formula> do not contribute to couplings.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003176.g002" position="float" xlink:type="simple"/></fig>
<p>To characterize the statistical properties of the patterns we define, inspired by localization theory in condensed matter physics, the inverse participation ratio (IPR) of a pattern <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e227" xlink:type="simple"/></inline-formula> as<disp-formula id="pcbi.1003176.e228"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e228" xlink:type="simple"/><label>(25)</label></disp-formula>Possible IPR values range from one for perfectly localized patterns (only one single non-zero component) to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e229" xlink:type="simple"/></inline-formula> for a completely distributed pattern with uniform entries. IPR is therefore used as a localization measure for the patterns: Its inverse <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e230" xlink:type="simple"/></inline-formula> is an estimate of the effective number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e231" xlink:type="simple"/></inline-formula> of pairs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e232" xlink:type="simple"/></inline-formula>, on which the pattern has sizable entries <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e233" xlink:type="simple"/></inline-formula>. The middle panel of <xref ref-type="fig" rid="pcbi-1003176-g002">Fig. 2</xref> shows the presence of strong localization for repulsive patterns (small eigenvalues) and for irrelevant patterns (around eigenvalue 1). A much smaller increase in the IPR is also observed for part of the large eigenvalues.</p>
<p>What is the typical contribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e234" xlink:type="simple"/></inline-formula> of a pattern <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e235" xlink:type="simple"/></inline-formula> to the couplings? Pattern <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e236" xlink:type="simple"/></inline-formula> contributes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e237" xlink:type="simple"/></inline-formula> to each coupling. Many contributions can be small, and others may be larger. An estimate of the magnitude of those relevant contributions can be obtained from the sum of the squared contributions normalized by the effective number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e238" xlink:type="simple"/></inline-formula> of pairs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e239" xlink:type="simple"/></inline-formula> on which the patterns has large entries:<disp-formula id="pcbi.1003176.e240"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e240" xlink:type="simple"/><label>(26)</label></disp-formula>The lower panel of <xref ref-type="fig" rid="pcbi-1003176-g002">Fig. 2</xref> shows the typical contribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e241" xlink:type="simple"/></inline-formula> of a pattern as a function of its corresponding eigenvalue. Patterns with eigenvalues close to 1 have very small norms; they essentially do not contribute to the couplings. Highly localized patterns of large norm result in few and large contributions to the couplings (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e242" xlink:type="simple"/></inline-formula>). Patterns associated to large eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e243" xlink:type="simple"/></inline-formula> produce many weak contributions to the couplings.</p>
<sec id="s2b1">
<title>Repulsive patterns</title>
<p>In the upper row of <xref ref-type="fig" rid="pcbi-1003176-g003">Fig. 3</xref> we display the three most localized repulsive patterns (smallest, 3rd and 4th smallest eigenvalues) for the trypsin inhibitor protein (PF00014). All three patterns have two very pronounced peaks, corresponding to, say, amino-acid <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e244" xlink:type="simple"/></inline-formula> in position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e245" xlink:type="simple"/></inline-formula> and amino-acid <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e246" xlink:type="simple"/></inline-formula> in position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e247" xlink:type="simple"/></inline-formula>, and some smaller minor peaks, resulting in IPR values above 0.3. For each pattern, the two major peaks are of opposite sign: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e248" xlink:type="simple"/></inline-formula>. As a consequence, amino-acid sequences carrying amino-acid <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e249" xlink:type="simple"/></inline-formula> in position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e250" xlink:type="simple"/></inline-formula>, but not <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e251" xlink:type="simple"/></inline-formula> in position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e252" xlink:type="simple"/></inline-formula> (as well as sequences carrying <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e253" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e254" xlink:type="simple"/></inline-formula> but not <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e255" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e256" xlink:type="simple"/></inline-formula>) show large log-scores <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e257" xlink:type="simple"/></inline-formula>, cf. <xref ref-type="disp-formula" rid="pcbi.1003176.e131">Eq. (16)</xref>. Their probability in the Hopfield-Potts model, given by (17), will be strongly reduced as compared to the probability of sequences carrying either both amino-acids <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e258" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e259" xlink:type="simple"/></inline-formula> in, respectively, positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e260" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e261" xlink:type="simple"/></inline-formula>, or none of the two (scores <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e262" xlink:type="simple"/></inline-formula> close to zero). Hence, we see that repulsive patterns do define repulsive directions in the sequence space, which tend to be avoided by sequences. A more thorough discussion of the meaning of repulsive patterns will be given in the <xref ref-type="sec" rid="s3">Discussion</xref> Section.</p>
<fig id="pcbi-1003176-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003176.g003</object-id><label>Figure 3</label><caption>
<title>Attractive and repulsive patterns for PF00014.</title>
<p><italic>(Upper panels)</italic> The most localized repulsive patterns (corresponding to the first, third and fourth smallest eigenvalues and inverse participation ratios <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e263" xlink:type="simple"/></inline-formula> respectively) are strongly concentrated in pairs of positions. <italic>(lower panels)</italic> The most attractive patterns (corresponding to the three largest eigenvalues); the top pattern is extended, with inverse participation ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e264" xlink:type="simple"/></inline-formula>, while the second and third patterns,with inverse participation ratios <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e265" xlink:type="simple"/></inline-formula> respectively, have essentially non-zero components over the gap symbols only which accumulate on the edges of the sequence. Note the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e266" xlink:type="simple"/></inline-formula>-coordinates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e267" xlink:type="simple"/></inline-formula>; its integer part is the site index, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e268" xlink:type="simple"/></inline-formula>, and the fractional part multiplied by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e269" xlink:type="simple"/></inline-formula> is the residue value, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e270" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003176.g003" position="float" xlink:type="simple"/></fig>
<p>In all three panels of <xref ref-type="fig" rid="pcbi-1003176-g003">Fig. 3</xref>, the two large peaks have highest value for the amino acid cysteine. Actually, for all of them, the pairs of peaks identify disulfide bonds, <italic>i.e.</italic> covariant bonds between two cysteines. They are very important for a protein's stability and therefore highly conserved. The corresponding repulsive patterns forbid amino-acid configurations with a single cysteine in only one out of the two positions. Both residues are co-conserved. Note also that the trypsin inhibitor has only three disulfide bonds, <italic>i.e.</italic> all of them are seen by the most localized repulsive patterns. The second eigenvalues, which has a slightly smaller IPR, is actually found to be a mixture of two of these bonds, <italic>i.e.</italic> it is localized over four positions.</p>
<p>The observation of disulfide bonds is specific to the trypsin inhibitor. In other proteins, also the ones studied in this paper, we find similarly strong localization of the most repulsive patterns, but in different amino acid combinations. As an example, the most localized pattern in the response regulator domain connects a position with an Asp residue (negatively charged), with another position carrying either Lys or Arg (both positively charged), their interaction is thus coherent with electrostatics. In all observed cases, the consequence is a strong statistical coupling of these positions, which are typically found in direct contact.</p>
</sec><sec id="s2b2">
<title>Attractive patterns</title>
<p>The strongest attractive pattern, <italic>i.e.</italic> the one corresponding to the largest eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e271" xlink:type="simple"/></inline-formula>, is shown in the leftmost panel of the lower row of <xref ref-type="fig" rid="pcbi-1003176-g003">Fig. 3</xref>. Its IPR is small (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e272" xlink:type="simple"/></inline-formula>), implying that it is extended over most of the protein (a pattern of constant entries would have IPR <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e273" xlink:type="simple"/></inline-formula>). As is shown in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>, strongest entries in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e274" xlink:type="simple"/></inline-formula> correspond to conserved residues and these, even if they are distributed along the primary sequence, tend to form spatially connected and functionally important regions in the folded protein (<italic>e.g.</italic> a binding pocket), cf. left panel of <xref ref-type="fig" rid="pcbi-1003176-g004">Fig. 4</xref>. Clearly this observation is reminiscent of the protein sectors observed in <xref ref-type="bibr" rid="pcbi.1003176-Halabi1">[40]</xref>, which are found by PCA applied to the before-mentioned modified covariance matrix. Note, however, that sectors are extracted from more than one principal component.</p>
<fig id="pcbi-1003176-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003176.g004</object-id><label>Figure 4</label><caption>
<title>The principal component and predicted contacts visualized on the 3D structure of the trypsin inhibitor protein domain PF00014.</title>
<p><italic>(A)</italic> The 10 positions (residue ID 5,12,14,22,23,30,35,40,51,55) of largest entries in the most attractive Hopfield pattern (largest eigenvalue of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e275" xlink:type="simple"/></inline-formula>, corresponding to the principal component) are shown in blue, they correspond also to very conserved sites. Note that, while they are distant along the protein backbone, they cluster into spatially connected components in the folded protein. <italic>(B)</italic> The 50 residue pairs with strongest couplings (ranked according to the Frobenius norms <xref ref-type="disp-formula" rid="pcbi.1003176.e463">Eq. (40)</xref>, with at least 5 positions separation along the backbone, are connected by lines. Only two out of these pairs are not in contact (blue links), all other 48 are thus true-positive contact predictions (red links). Many contacts link pairs of not conserved positions. Note that links are drawn between C-alpha atoms, whereas contacts are defined via minimal all-atom distances, making some red lines to appear rather long even if corresponding to native contacts.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003176.g004" position="float" xlink:type="simple"/></fig>
<p>More characteristic patterns are found for the second and third eigenvalues. As is shown in <xref ref-type="fig" rid="pcbi-1003176-g003">Fig. 3</xref>, they show strong peaks at the extremities of the sequence, which become higher when approaching the first resp. last sequence position. The peaks are, for all relevant positions, concentrated on the gap symbol. These patterns are actually artifacts of the multiple-sequence alignment: Many sequences start or end with a stretch of gaps, which may have one out of at least three reasons: (1) The protein under consideration does not match the full domain definition of PFAM; (2) the local nature of PFAM alignments has initial and final gaps as algorithmic artifacts, a correction would however render the search tools less efficient; (3) in sequence alignment algorithms, the extension of an existing gap is less expensive than opening a new gap. The attractive nature of these two patterns, and the equal sign of the peaks, imply that gaps in equilibrium configurations of the Hopfield-Potts model frequently come in stretches, and not as isolated symbols. The finding that there are two patterns with this characteristic can be traced back to the fact that each sequence has two ends, and these behave independently with respect to alignment gaps.</p>
</sec><sec id="s2b3">
<title>Theoretical results for localization in the limit case of strong conservation</title>
<p>The main features of the empirically observed spectral and localization properties of <xref ref-type="fig" rid="pcbi-1003176-g002">Fig. 2</xref> can be found back in the limiting case of completely conserved sequences, which is amenable to an exact mathematical treatment. To this end, we consider <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e276" xlink:type="simple"/></inline-formula> perfectly conserved sites, <italic>i.e.</italic> a MSA made from the repetition of a unique sequence. As is shown in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>, Section 2, the corresponding Pearson correlation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e277" xlink:type="simple"/></inline-formula> has only three different eigenvalues:</p>
<list list-type="bullet"><list-item>
<p>a large and non-degenerate eigenvalue, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e278" xlink:type="simple"/></inline-formula>, which is a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e279" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e280" xlink:type="simple"/></inline-formula> (and of the pseudocount used to treat the data, see <xref ref-type="sec" rid="s4">Methods</xref>), whose corresponding eigenvector is extended;</p>
</list-item><list-item>
<p>a small and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e281" xlink:type="simple"/></inline-formula>-fold degenerate eigenvalue, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e282" xlink:type="simple"/></inline-formula>. The corresponding eigenspace is spanned by vectors which are perfectly localized in pairs of sites, with components of opposite signs;</p>
</list-item><list-item>
<p>the eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e283" xlink:type="simple"/></inline-formula>, which is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e284" xlink:type="simple"/></inline-formula>-fold degenerate. The eigenspace is spanned by vectors, which are localized over single sites.</p>
</list-item></list>
<p>For a realistic MSA, <italic>i.e.</italic> without perfect conservation, degeneracies will disappear, but the features found above remain qualitatively correct. In particular, we find in real data a pronounced peak of eigenvalues around 1, corresponding to localized eigenmodes (<xref ref-type="fig" rid="pcbi-1003176-g002">Fig. 2</xref>). In addition, low-eigenvalue modes are found to be strongly localized, and the the order of magnitude of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e285" xlink:type="simple"/></inline-formula> is in good agreement with the smallest eigenvalues, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e286" xlink:type="simple"/></inline-formula>, reported for the three analyzed domain families. Finally, the largest eigenmodes are largely extended, as found in the limit case above. Note that the eigenvalues found in the protein spectra, <italic>e.g.</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e287" xlink:type="simple"/></inline-formula> for PF00014, are however smaller than in the limit case, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e288" xlink:type="simple"/></inline-formula>, due to only partial conservation in the real MSA.</p>
</sec></sec><sec id="s2c">
<title>Residue-residue contact prediction with the Hopfield-Potts model</title>
<p>The most important feature of DCA is its ability to predict pairs of residues, which are distantly positioned in the sequence, but which form native contacts in the protein's tertiary structure, cf. the right panel of <xref ref-type="fig" rid="pcbi-1003176-g004">Fig. 4</xref>. Here, our contact prediction is based on the sampling-corrected Frobenius norm of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e289" xlink:type="simple"/></inline-formula>–dimensional statistical coupling matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e290" xlink:type="simple"/></inline-formula>, cf. <xref ref-type="sec" rid="s4">Methods</xref>, which in <xref ref-type="bibr" rid="pcbi.1003176-Ekeberg1">[49]</xref> has been shown to outperform the direct-information measure used in <xref ref-type="bibr" rid="pcbi.1003176-Weigt1">[17]</xref>. This measure assigns a single scalar value for the strength of the direct coupling between two residue positions.</p>
<p>The contact map predicted from the 50 strongest direct couplings for the PF00014 family is compared to the native contact map in <xref ref-type="fig" rid="pcbi-1003176-g005">Fig. 5</xref>. In accordance with <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>, a residue pairs is considered to be a true positive prediction if its minimal atom distance is below 8 Å in the before mentioned exemplary protein crystal structures. This relatively large cutoff was chosen since DCA was found to extract a bimodal signal with pairs in the range below 5 Å (turquoise in <xref ref-type="fig" rid="pcbi-1003176-g005">Fig. 5</xref>) and others with 7–8 Å (grey in <xref ref-type="fig" rid="pcbi-1003176-g005">Fig. 5</xref>); both peaks contain valuable information if compared to typical distances above 20 Å for randomly chosen residue pairs. To include only non-trivial contacts, we require also a minimum separation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e291" xlink:type="simple"/></inline-formula> of at least 5 residues along the protein sequence. Remarkably the quality of the predicted contact map with the Hopfield-Potts model with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e292" xlink:type="simple"/></inline-formula> patterns is essentially the same as with DCA, corresponding to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e293" xlink:type="simple"/></inline-formula> patterns. In both cases predicted contacts spread rather uniformly over the native contact map, and 96% of the predicted contacts are true positives. This result is corroborated by the lower panels of <xref ref-type="fig" rid="pcbi-1003176-g006">Fig. 6</xref>, which show, for various values of the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e294" xlink:type="simple"/></inline-formula> of patterns, the performance in terms of contact predictions for the three families studied here. The plots show the fraction of true-positives (TP), <italic>i.e.</italic> of native distances below 8 Å, in between the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e295" xlink:type="simple"/></inline-formula> pairs of highest couplings, as a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e296" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>.</p>
<fig id="pcbi-1003176-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003176.g005</object-id><label>Figure 5</label><caption>
<title>Contact map for the PF00014 family.</title>
<p>Filled squares represent the native contact map on the 3D fold (PDB 5pti, with turquoise squares signaling all-atom distances below 5 Å, and grey ones distances between 5 Å and 8 Å). The 50 top predicted contacts with minimal separation of 5 positions along the sequence (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e297" xlink:type="simple"/></inline-formula>) are shown with empty squares: true-positive predictions (distance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e298" xlink:type="simple"/></inline-formula>Å) are colored in red, and false-positive predictions in blue. Predictions are made with the Hopfield-Potts model with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e299" xlink:type="simple"/></inline-formula> patterns (bottom right corner) and with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e300" xlink:type="simple"/></inline-formula> patterns (DCA, top left corner). For both values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e301" xlink:type="simple"/></inline-formula> there are 48 true-positive and 2 false-positive predictions.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003176.g005" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003176-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003176.g006</object-id><label>Figure 6</label><caption>
<title>Contact predictions for the three considered protein families.</title>
<p>The upper panels show the fraction of the interaction-based contribution to the log-likelihood of the model given the MSA, defined as the ratio of the log-likelihood with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e302" xlink:type="simple"/></inline-formula> selected patterns over the maximal log-likelihood obtained by including all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e303" xlink:type="simple"/></inline-formula> patterns, as a function of the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e304" xlink:type="simple"/></inline-formula> of selected patterns, it reaches one for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e305" xlink:type="simple"/></inline-formula> corresponding to the Potts model used in DCA. The lower panels show the TP rates as a function of the predicted residue contacts, for various numbers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e306" xlink:type="simple"/></inline-formula> of selected patterns, where selection was done using the maximum-likelihood criterion. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e307" xlink:type="simple"/></inline-formula> gives the contact predictions obtained by DCA approach. Only non-trivial contacts between sites <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e308" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e309" xlink:type="simple"/></inline-formula> are considered in the calculation of the TP rate.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003176.g006" position="float" xlink:type="simple"/></fig>
<p>The three upper panels in <xref ref-type="fig" rid="pcbi-1003176-g006">Fig. 6</xref> show the ratio between the selected pattern contributions to the log-likelihood, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e310" xlink:type="simple"/></inline-formula>, and its maximal value obtained by including all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e311" xlink:type="simple"/></inline-formula> patterns, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e312" xlink:type="simple"/></inline-formula>. A large fraction of patterns can be omitted without any substantial loss in log-likelihood, but with a substantially smaller number of parameters. It is worth noting that, in <xref ref-type="fig" rid="pcbi-1003176-g006">Fig. 6</xref>, we do not find any systematic benefit of excluding patterns for the contact prediction, but the predictive power decreases initially only very slowly with decreasing pattern numbers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e313" xlink:type="simple"/></inline-formula>. For all three proteins, even with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e314" xlink:type="simple"/></inline-formula> patterns, very good contact predictions can be achieved, which are comparable to the ones with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e315" xlink:type="simple"/></inline-formula> patterns using the full DCA inference scheme of <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>. Almost perfect performance is reached, when the contribution of selected patterns to the log-likelihood is only at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e316" xlink:type="simple"/></inline-formula> of its maximal value. This could be expected from the fact that patterns corresponding to eigenvalues close to unity hardly contribute to the couplings, cf. lower panel in <xref ref-type="fig" rid="pcbi-1003176-g002">Fig. 2</xref>.</p>
<p>These findings are not restricted to the three test proteins, as is confirmed by the left panel of <xref ref-type="fig" rid="pcbi-1003176-g007">Fig. 7</xref>. In this figure, we average the TP rates for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e317" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e318" xlink:type="simple"/></inline-formula> (<italic>i.e.</italic> full mean-field DCA) for the 15 proteins studied in <xref ref-type="bibr" rid="pcbi.1003176-Sulkowska1">[33]</xref>, which had been selected for their diversity in protein length and fold type. Further more, the discussion of the localization properties of repulsive patterns is corroborated by the results reported in <xref ref-type="fig" rid="pcbi-1003176-g007">Fig. 7</xref>, right panel. It compares the performance of the Hopfield-Potts model to predict residue-residue contacts, for the three cases where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e319" xlink:type="simple"/></inline-formula> patterns are selected either according to the maximum likelihood criterion (patterns for eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e320" xlink:type="simple"/></inline-formula> and for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e321" xlink:type="simple"/></inline-formula>), or where only the strongest attractive (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e322" xlink:type="simple"/></inline-formula>) or only the strongest repulsive (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e323" xlink:type="simple"/></inline-formula>) patterns are taken into account. It becomes evident that repulsive patterns provide more accurate contact information, TP rates are almost unchanged between the curve of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e324" xlink:type="simple"/></inline-formula> most likely patterns, and the smaller subset of repulsive patterns. On the contrary, TP rates for contact prediction are strongly reduced when considering only attractive patterns, <italic>i.e.</italic> in the case corresponding most closely to PCA. This finding illustrates one of the most significative differences between DCA and PCA: Contact information is provided by the eigenvectors of the Pearson correlation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e325" xlink:type="simple"/></inline-formula> in the lower tail of the spectrum.</p>
<fig id="pcbi-1003176-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003176.g007</object-id><label>Figure 7</label><caption>
<title>Contact predictions across 15 protein families.</title>
<p><italic>(Left panel)</italic> TP rates for the contact prediction with variable numbers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e326" xlink:type="simple"/></inline-formula> of Hopfield-Potts patterns, averaged over 15 distinct protein families. <italic>(right panel)</italic> TP rates for the contact prediction using only the repulsive (green line) resp. attractive (red line) patterns, which are contained in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e327" xlink:type="simple"/></inline-formula> most likely patterns (black line), averaged over 15 protein families. It becomes obvious that the contact prediction remains almost unchanged when only the subset of repulsive patterns is used, whereas it drops substantially by keeping only attractive patterns.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003176.g007" position="float" xlink:type="simple"/></fig>
<p>As is discussed in the previous section, patterns with the largest contribution to the log-likelihood are dominated by (and localized in) conserved sites. Attractive patterns favor these sites to jointly assume their conserved values, whereas repulsive patterns avoid configurations where, in pairs of co-conserved sites, only one variable assumes its conserved value, but not the other one. However, we have also seen that an accurate contact prediction requires at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e328" xlink:type="simple"/></inline-formula> patterns, <italic>i.e.</italic> it goes well beyond the patterns given by strongly conserved sites. In <xref ref-type="fig" rid="pcbi-1003176-g004">Fig. 4</xref> we show, for the exemplary case of the Trypsin inhibitor, both the 10 sites of highest entry in the most attractive pattern <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e329" xlink:type="simple"/></inline-formula> (corresponding to conserved sites), and the first 50 predicted intra-protein contacts using the full mean-field DCA scheme (results for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e330" xlink:type="simple"/></inline-formula> are almost identical). It appears that many of the correctly predicted contacts are not included in the set of the most conserved sites. From a mathematical point of view, this is understandable - only variable sites may show covariation. From a biological point of view, this is very interesting, since it shows that highly variable residue in proteins are not necessarily functionally unimportant in a protein family, but they may undergo strong coevolution with other sites, and thus be very important for the structural stability of the protein, cf. also the Fig. S5 in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref> where the degree of conservation <xref ref-type="bibr" rid="pcbi.1003176-Ashkenazy1">[50]</xref> is depicted for the highest-ranking DCA predicted contacts. In this figure we show that residues included in predicted contacts are found for all levels of conservation. It has, however, to be mentioned that in the considered MSA, there are no 100% conserved residues, the latter would not show any covariation. A small level of variability is therefore crucial for our approach.</p>
<p>A remark is necessary concerning the right panel of <xref ref-type="fig" rid="pcbi-1003176-g004">Fig. 4</xref>: Whereas conserved sites (which carry also the largest entries of the pattern with maximum eigenvalue) are collected in one or two spatially connected regions in the studied proteins, this is not necessarily true for all proteins. In particular complex domains with multiple functions and/or multiple conformations may show much more involved patterns. It is, however, beyond the scope of this paper to shed light onto the details of the biological interpretation of the principal components of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e331" xlink:type="simple"/></inline-formula>.</p>
<p>In which cases does the dimensional reduction achieved by selecting only a relatively small number of patterns provide an actual advantage over the standard mean-field DCA approach with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e332" xlink:type="simple"/></inline-formula> patterns? We have seen that for relatively large MSAs, where DCA gives very accurate results, the approach presented here achieves a strong dimensional reduction almost without loss in predictive power, but it did not improve the contact map prediction, cf. <xref ref-type="fig" rid="pcbi-1003176-g005">Figs. 5</xref> and <xref ref-type="fig" rid="pcbi-1003176-g006">6</xref>. However, when we reduce the number of sequences in the MSA, DCA undergoes a strong reduction in accuracy of prediction, see the full lines in <xref ref-type="fig" rid="pcbi-1003176-g008">Fig. 8</xref> where DCA is applied to sub-alignments of the PF00014 domain family. Repeating the same experiment with a finite number of patterns (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e333" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1003176-g008">Fig. 8</xref>), the MSA-size dependence is strongly reduced. For very small alignments of only 10–30 sequences, the Hopfield-Potts model is still able to extract contacts with an astonishing TP rate of 70–80%, whereas DCA produces almost random results (TP rate ca. 30%). The success of the Hopfield-Potts approach for small MSA is not specific to the PF00014 domain, and holds for other protein families, see Fig. S15 in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>. Hopfield-Potts patterns are therefore an efficient means to reduce overfitting effects found in DCA, and to improve the signal-to-noise ratio.</p>
<fig id="pcbi-1003176-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003176.g008</object-id><label>Figure 8</label><caption>
<title>Noise reduction due to pattern selection in reduced data sets.</title>
<p><italic>(Full lines)</italic> TP rates of mean-field DCA for sub-MSAs of family PF00014 with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e334" xlink:type="simple"/></inline-formula> sequences; each curve is averaged over 200 randomly selected sub-alignments. Whereas for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e335" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e336" xlink:type="simple"/></inline-formula> the accuracy of the first predictions is close to one, mean-field DCA does not extract any reasonable signal for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e337" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e338" xlink:type="simple"/></inline-formula>. <italic>(dashed lines)</italic> The same sub-MSA are analyzed with the Hopfield-Potts model using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e339" xlink:type="simple"/></inline-formula> patterns (maximum-likelihood selection). Whereas this selection reduces the accuracy for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e340" xlink:type="simple"/></inline-formula>, it results in increased TP rates for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e341" xlink:type="simple"/></inline-formula>. Dimensional reduction by pattern selection has lead to an efficient noise reduction.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003176.g008" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s3">
<title>Discussion</title>
<p>In this paper we have proposed a method to analyze the correlation matrix of residue occurrences across multiple-sequence alignments of homologous proteins, based on the inverse Hopfield-Potts model. Our approach offers a natural interpolation between the spectral analysis of the correlation matrix, carried out in principal component analysis (PCA), and maximum entropy approaches which aim at reproducing those correlations within a global statistical model (<italic>e.g.</italic> DCA). The inverse Hopfield-Potts model requires to infer “directions” of particular importance in the sequence space, called patterns: The distribution of sequences belonging to a protein family tends to accumulate along attractive patterns (related to eigenmodes of the correlation matrix with large eigenvalues) and to get depleted around repulsive patterns (related to the low-eigenvalue modes). These patterns have some similarity with position-specific scoring matrices frequently used in the statistical modeling of sequences, but in contrast to the independence of different positions in PSSM, Hopfield-Potts patterns account for inter-position couplings, as needed for coevolutionary analysis.</p>
<p>Contrary to principal component analysis, which discards low-eigenvalue modes, we have shown that repulsive patterns are essential to characterize the sequence distribution, and in particular to detect structural properties (residue-residue contacts) of proteins from sequence data. In addition, we have shown how to infer not only the values of the patterns but also their statistical relevance from the sequence data. To do so, we have calculated the contribution of each pattern to the total likelihood of the Hopfield-Potts model given the data, establishing thus a clear criterion for pattern selection. The results of the application of the inverse Hopfield-Potts model to real sequence data confirm that most eigenmodes (with eigenvalues close to unity) can be discarded without affecting considerably the contact prediction (see <xref ref-type="fig" rid="pcbi-1003176-g005">Fig. 5</xref> and <xref ref-type="fig" rid="pcbi-1003176-g006">Fig. 6</xref>). This makes our approach much less parameter-intensive that the full direct coupling analysis DCA. We have found empirically that it is sufficient to take into account the patterns contributing to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e342" xlink:type="simple"/></inline-formula> of the log-likelihood to achieve a very good contact map prediction in the case of large multiple-sequence alignments. In the case of reduced MSA size, we found that the dimensional reduction due selecting only the most likely patterns improves the signal-to-noise ratio of the inferred model, and therefore reaches a better contact prediction than mean-field DCA, down to very small numbers of sequences, see <xref ref-type="fig" rid="pcbi-1003176-g008">Fig. 8</xref> and Fig. S15 in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>. Moreover the Hopfield-Potts approach can be very advantageous in terms of computational time. While DCA requires the inversion of the correlation matrix, which takes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e343" xlink:type="simple"/></inline-formula> time, computing the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e344" xlink:type="simple"/></inline-formula> patterns (corresponding to the largest and smallest eigenvalues) can be done in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e345" xlink:type="simple"/></inline-formula> time only. The reduction in computational time can thus be very important for large proteins.</p>
<p>We have also studied the position-specific nature of patterns, taking inspiration from localization theory in condensed matter physics and random matrix theory (<xref ref-type="fig" rid="pcbi-1003176-g003">Fig. 3</xref> and Figs. S8 and S12 in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>). Briefly speaking, a pattern is said to be localized if it is concentrated on a few sites of the sequence, and extended (over the sequence) otherwise. We have found that the principal attractive pattern (corresponding to the largest eigenvalue) is extended, with entries of largest absolute value in the most conserved sites (Figs. S3, S4, S9 &amp; S13 in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>). Other strongly attractive patterns can be explained from the presence of extended gaps in the alignment, mostly found at the beginning or at the end of sequences. The other patterns of large likelihood contributions are repulsive, <italic>i.e.</italic> they correspond to small eigenvalues, usually discarded by principal component analysis. Interestingly, these patterns appear to be strongly localized, that is, strongly concentrated in very few positions, which despite their separation along the sequence are found in close contact in the 3D protein structure. To give an example, in the Trypsin inhibitor protein, they are localized in position pairs carrying Cysteine, and being linked by disulfide bonds. Other amino-acid combinations were also found in the other protein families studied here, e.g. patterns connecting residues of opposite electrical charge. Taking into account only a number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e346" xlink:type="simple"/></inline-formula> of such repulsive patterns results in a predicted contact map of comparable quality to the one using maximum-likelihood selection, whereas the same number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e347" xlink:type="simple"/></inline-formula> of attractive patterns performs substantially worse (<xref ref-type="fig" rid="pcbi-1003176-g007">Fig. 7</xref> and Fig. S7 &amp; S11in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>). The dimensional reduction of the Hopfield-Potts model compared to the Potts model (used in standard DCA) is thus even more increased as many relevant patterns are localized and contain only a few (substantially) non-zero components. As a consequence the couplings found with the Hopfield-Potts model are sparser than their DCA counterparts (Fig. S6 in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>).</p>
<p>It is important to stress that also distinct patterns, whether attractive or repulsive, can have large components on the same sites and residues. A general finding, supported by a theoretical analysis in the Results section, is that the more repulsive patterns are, the stronger they are localized, and the more conserved are the residues supporting them. Highly conserved sites therefore appear both in the most attractive pattern and, when covarying with other residues, in a few localized and repulsive patterns reflecting those covariations. As the number of patterns to be included to reach an accurate contact prediction is a few hundreds for the protein families considered here, the largest components of the weakly repulsive patterns, <italic>i.e.</italic> with the eigenvalues smaller than, but close to the threshold <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e348" xlink:type="simple"/></inline-formula>, correspond to weakly conserved residues. In consequence many predicted contacts connect low-conservation residues. This statement is apparent from <xref ref-type="fig" rid="pcbi-1003176-g004">Fig. 4</xref> and Figs. S10 and S14 in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>, which compare the sets of conserved sites and the pairs of residues predicted to be in contact by our analysis.</p>
<p>Why are repulsive patterns so successful in identifying contacts, in difference to attractive patterns? To answer this question, consider the simple case of a pattern <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e349" xlink:type="simple"/></inline-formula> localized in two residues only, say it should prefer the co-occurrence of amino-acid <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e350" xlink:type="simple"/></inline-formula> in position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e351" xlink:type="simple"/></inline-formula>, and of amino acid <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e352" xlink:type="simple"/></inline-formula> in position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e353" xlink:type="simple"/></inline-formula>. We further assume that the two non-zero components <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e354" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e355" xlink:type="simple"/></inline-formula> have the same amplitude and differ only by sign, <italic>i.e.</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e356" xlink:type="simple"/></inline-formula>. Now we consider a sequence of amino-acids <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e357" xlink:type="simple"/></inline-formula> and ask whether it will have a large log-score <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e358" xlink:type="simple"/></inline-formula> for pattern <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e359" xlink:type="simple"/></inline-formula>, see <xref ref-type="disp-formula" rid="pcbi.1003176.e131">Eq. (16)</xref>. The outcome is given in the third column of <xref ref-type="table" rid="pcbi-1003176-t001">Table 1</xref>. The log-score therefore corresponds to a XOR (exclusive or) between the presence of the two amino-acids <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e360" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e361" xlink:type="simple"/></inline-formula> on their respective positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e362" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e363" xlink:type="simple"/></inline-formula> in the sequence. If the pattern were attractive (cf. fourth column), it would favor sequences where exactly one of the two specified amino-acids is present. For a repulsive pattern (cf. fifth column), low log-score sequences are favored, <italic>i.e.</italic> either both <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e364" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e365" xlink:type="simple"/></inline-formula> are present in positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e366" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e367" xlink:type="simple"/></inline-formula>, or none of the two.</p>
<table-wrap id="pcbi-1003176-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003176.t001</object-id><label>Table 1</label><caption>
<title>Effect of a pattern with two non-zero and opposite components <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e368" xlink:type="simple"/></inline-formula>.</title>
</caption><alternatives><graphic id="pcbi-1003176-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003176.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e369" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e370" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e371" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Favored by attractive pattern?</td>
<td align="left" rowspan="1" colspan="1">Favored by repulsive pattern?</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">YES</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">NO</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">NO</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">YES</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>In case we assumed equal sign components, <italic>i.e.</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e372" xlink:type="simple"/></inline-formula>, we would have found <xref ref-type="table" rid="pcbi-1003176-t002">Table 2</xref>. This choice is poor in terms of enforcing covariation in the sequence: An attractive (resp. repulsive) pattern strongly favors (resp. disfavors) the simultaneous presence of amino acids <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e373" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e374" xlink:type="simple"/></inline-formula> in positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e375" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e376" xlink:type="simple"/></inline-formula>, but the likelihood is monotonous in the number of correctly present amino acids.</p>
<table-wrap id="pcbi-1003176-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003176.t002</object-id><label>Table 2</label><caption>
<title>Effect of a pattern with two non-zero and equal components <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e377" xlink:type="simple"/></inline-formula>.</title>
</caption><alternatives><graphic id="pcbi-1003176-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003176.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e378" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e379" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e380" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Favored by attractive pattern?</td>
<td align="left" rowspan="1" colspan="1">Favored by repulsive pattern?</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">YES</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">YES</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">NO</td>
<td align="left" rowspan="1" colspan="1">YES</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">YES</td>
<td align="left" rowspan="1" colspan="1">NO</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>As a conclusion, we find that strong covariation can be efficiently enforced only by a repulsive pattern with opposite components (fifth column in <xref ref-type="table" rid="pcbi-1003176-t001">Table 1</xref>). The acceptance of the (NO,NO) configuration is desirable, too: It signals the possibility of compensatory mutations, <italic>i.e.</italic> favorable double mutations changing both <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e381" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e382" xlink:type="simple"/></inline-formula> in positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e383" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e384" xlink:type="simple"/></inline-formula> to alternative amino acids. It is easy to generalize the above patterns to patterns having more than one favored amino-acid combination, <italic>e.g.</italic> favored pairings <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e385" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e386" xlink:type="simple"/></inline-formula> can be enforced by a repulsive pattern with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e387" xlink:type="simple"/></inline-formula>. This theoretical argument explains why localized repulsive patterns critically encode for covariation. Remarkably the condition that the few, large components of repulsive patterns should sum up to zero agrees well with our findings in real MSAs, cf <xref ref-type="fig" rid="pcbi-1003176-g003">Fig. 3</xref> and Figs. S8 and S12 in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>. Furthermore, it would be interesting to better understand the relationship between such localized patterns and specificity-determining positions <xref ref-type="bibr" rid="pcbi.1003176-Casari1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Rausell1">[45]</xref>: SDP are co-conserved in subfamilies of the full MSA, but vary from one family to another. The most repulsive patterns are localized in residues, which are strongly conserved throughout the full alignment. We have also used S3det <xref ref-type="bibr" rid="pcbi.1003176-Rausell1">[45]</xref> to predict SDPs and to compare them to our 30 highest-scoring contact predictions, and we have not observed any particular signal. It would be interesting to extend the Hopfield-Potts approach to subfamilies and to investigate, if SDPs correspond to repulsive patterns in these subfamilies.</p>
<p>Last but not least, let us emphasize the importance of the prefactor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e388" xlink:type="simple"/></inline-formula> of the pattern, cf. <xref ref-type="disp-formula" rid="pcbi.1003176.e156">Eqs. (19)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003176.e159">(20)</xref>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e389" xlink:type="simple"/></inline-formula> is the eigenvalue corresponding to the pattern. While this factor is at most equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e390" xlink:type="simple"/></inline-formula> for attractive patterns, it can take arbitrarily large values for repulsive patterns (<xref ref-type="fig" rid="pcbi-1003176-g001">Fig. 1</xref>, right panel). Moreover, repulsive patterns can be highly localized: they strongly contribute to a few couplings <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e391" xlink:type="simple"/></inline-formula>, <italic>e.g.</italic> to one coupling between a single pair of positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e392" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e393" xlink:type="simple"/></inline-formula> for patterns perfectly localized in two sites only (cf. <xref ref-type="fig" rid="pcbi-1003176-g002">Fig. 2</xref>, lower panel, and <xref ref-type="fig" rid="pcbi-1003176-g003">Fig. 3</xref>). Consequently those contributions are of particular importance in the ranking of couplings, which our contact prediction is based on. On the contrary, attractive patterns, even with sizeable norms, produce many weaker contributions to the couplings (cf. <xref ref-type="fig" rid="pcbi-1003176-g002">Fig. 2</xref>, lower panel), and do not alter their relative rankings a much as repulsive patterns do. This explains why contact prediction based on repulsive patterns only is much more efficient than when based on attractive patterns only (cf. <xref ref-type="fig" rid="pcbi-1003176-g007">Fig. 7</xref>).</p>
<p>Some aspects of the approach presented in this paper deserve further studies, and may actually lead to substantial improvements of our ability to detect residue contacts from statistical sequence analysis. The probably most important question is the capability of our approach to suppress noise in small MSAs, and to extract contact information in cases where mean-field DCA fails. This question is closely related to the determination of an optimal value for the pattern number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e394" xlink:type="simple"/></inline-formula> using sequence information alone. Second, the non-independence of sequences in the alignment, <italic>e.g.</italic> due to phylogenetic correlations, should be taken into account in a more accurate way than done currently by sequence reweighting. Third, the precise role of the – heuristically determined – large pseudo-count used to calculate the Pearson correlation matrix should also be elucidated. Fourth, while the use of the Frobenius norm for the coupling <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e395" xlink:type="simple"/></inline-formula> (with the average-product correction, see <xref ref-type="sec" rid="s4">Methods</xref>) has proven to be an efficient criterion for contact prediction, it remains unclear if there exist other contact estimators with better performance. In this context it would also be interesting to find a threshold for these contact scores, which separates a signal-rich from a noise-dominated region. And last but not least, it would be interesting to integrate prior knowledge about proteins, like <italic>e.g.</italic> amino-acid properties or predicted secondary structure, into the purely statistical inference approach presented here.</p>
<p>The MATLAB program necessary for the analysis of the data, the computation of the patterns, and the contact prediction is available as part of the Supporting Information. Users of the program are kindly requested to cite the present work.</p>
</sec><sec id="s4" sec-type="methods">
<title>Methods</title>
<sec id="s4a">
<title>Data preprocessing</title>
<p>Following the discussion of <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>, we introduce two modifications into the definition <xref ref-type="disp-formula" rid="pcbi.1003176.e032">Eq. (2)</xref> of the frequency counts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e396" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e397" xlink:type="simple"/></inline-formula>:</p>
<list list-type="bullet"><list-item>
<p><italic>Pseudocount regularization</italic>: Some amino-acid combinations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e398" xlink:type="simple"/></inline-formula> do not exist in column pairs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e399" xlink:type="simple"/></inline-formula>, even if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e400" xlink:type="simple"/></inline-formula> is found in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e401" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e402" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e403" xlink:type="simple"/></inline-formula>. This would formally lead to infinitely large coupling constants, and the covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e404" xlink:type="simple"/></inline-formula> becomes non invertible. This divergence can be avoided by introducing a pseudocount <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e405" xlink:type="simple"/></inline-formula>, which adds to the occurrence counts of each amino acid in each column of the MSA.</p>
</list-item><list-item>
<p><italic>Reweighting</italic>: The sampling of biological sequences is far from being identically and independently distributed (i.i.d.), it is biased by the phylogenetic history of the proteins and by the human selection of sequenced species. This bias will introduce global correlations. To reduce this effect, we decrease the statistical weight of sequences having many similar ones in the MSA. More precisely, the weight of each sequence is defined as the inverse number of sequences within Hamming distance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e406" xlink:type="simple"/></inline-formula>, with an arbitrary but fixed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e407" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003176.e408"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e408" xlink:type="simple"/><label>(27)</label></disp-formula>for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e409" xlink:type="simple"/></inline-formula>. The weight equals one for isolated sequences, and becomes smaller the denser the sampling around a sequence is. Note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e410" xlink:type="simple"/></inline-formula> would account to removing double counts from the MSA. The total weight<disp-formula id="pcbi.1003176.e411"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e411" xlink:type="simple"/><label>(28)</label></disp-formula>can be interpreted as the effective number of independent sequences.</p>
</list-item></list>
<p>With these two modifications, frequency counts become<disp-formula id="pcbi.1003176.e412"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e412" xlink:type="simple"/><label>(29)</label></disp-formula><disp-formula id="pcbi.1003176.e413"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e413" xlink:type="simple"/><label>(30)</label></disp-formula>Values <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e414" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e415" xlink:type="simple"/></inline-formula> were found to work optimally across many protein families <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>, we use these values. Besides these modifications, the Hopfield-Potts-model learning is performed as explained before.</p>
</sec><sec id="s4b">
<title>The number of independent model parameters</title>
<p>Amino-acid frequencies are not independent numbers. For instance, on each site <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e416" xlink:type="simple"/></inline-formula>, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e417" xlink:type="simple"/></inline-formula> amino-acid frequencies add up to one,<disp-formula id="pcbi.1003176.e418"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e418" xlink:type="simple"/><label>(31)</label></disp-formula>and two-site distributions have single-site distributions as marginals,<disp-formula id="pcbi.1003176.e419"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e419" xlink:type="simple"/><label>(32)</label></disp-formula>As a consequence, not all of the constraints (4) and (5) are independent, and the Potts model as given in <xref ref-type="disp-formula" rid="pcbi.1003176.e059">Eq. (7)</xref> has more free parameters than needed to fulfill the constraints. Families of distinct parameter values result in the same model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e420" xlink:type="simple"/></inline-formula> (in physics language, this corresponds to a gauge invariance: any function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e421" xlink:type="simple"/></inline-formula> can be added to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e422" xlink:type="simple"/></inline-formula> and, simultaneously, be subtracted from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e423" xlink:type="simple"/></inline-formula>, without changing the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e424" xlink:type="simple"/></inline-formula>). As in <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>, we remove this freedom by setting<disp-formula id="pcbi.1003176.e425"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e425" xlink:type="simple"/><label>(33)</label></disp-formula>for all positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e426" xlink:type="simple"/></inline-formula> and all amino acids <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e427" xlink:type="simple"/></inline-formula>. Within this setting, each choice for the parameter values corresponds to a different outcome for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e428" xlink:type="simple"/></inline-formula>. The parameters to be computed are therefore the couplings <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e429" xlink:type="simple"/></inline-formula> and the fields <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e430" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e431" xlink:type="simple"/></inline-formula> only.</p>
<p>An different choice for the gauge is proposed in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>, Section 3, and leads to quantitatively equivalent predictions for the pattern structures and the contact map.</p>
</sec><sec id="s4c">
<title>Mean-field theory for determining the Hopfield-Potts patterns</title>
<p>The MaxEnt approach underlying DCA can be rephrased in a Bayesian framework. Assume the model to be given by <xref ref-type="disp-formula" rid="pcbi.1003176.e059">Eq. (7)</xref>, and assume the sequences in the MSA to be independently and identically sampled from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e432" xlink:type="simple"/></inline-formula>. The probability of the alignment for given model parameters (couplings and fields) is then given by<disp-formula id="pcbi.1003176.e433"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e433" xlink:type="simple"/><label>(34)</label></disp-formula>Plugging in <xref ref-type="disp-formula" rid="pcbi.1003176.e059">Eq. (7)</xref> and defining the log-likelihood of the model parameters given the MSA <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e434" xlink:type="simple"/></inline-formula>, we find<disp-formula id="pcbi.1003176.e435"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e435" xlink:type="simple"/><label>(35)</label></disp-formula>One can readily see that the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e436" xlink:type="simple"/></inline-formula> maximizing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e437" xlink:type="simple"/></inline-formula> are solutions of <xref ref-type="disp-formula" rid="pcbi.1003176.e054">Eqs. (4)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003176.e055">(5)</xref>. The corresponding value for the maximum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e438" xlink:type="simple"/></inline-formula> coincides with the opposite of the entropy, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e439" xlink:type="simple"/></inline-formula>, for the MaxEnt distribution given by <xref ref-type="disp-formula" rid="pcbi.1003176.e059">Eq. (7)</xref>.</p>
<p>Following the study of the Ising model case (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e440" xlink:type="simple"/></inline-formula>) in <xref ref-type="bibr" rid="pcbi.1003176-Cocco2">[43]</xref>, mean-field theory can be used to derive an approximate expression for the log-likelihood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e441" xlink:type="simple"/></inline-formula> (35) when the couplings are chosen to obey Hopfield's prescription, <xref ref-type="disp-formula" rid="pcbi.1003176.e144">Eq. (18)</xref>. Calculations are presented in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>, Section 1. After optimization over the fields, we are left with the log-likelihood for the patterns only,<disp-formula id="pcbi.1003176.e442"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e442" xlink:type="simple"/><label>(36)</label></disp-formula></p>
<p>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e443" xlink:type="simple"/></inline-formula>. So we find the trivial result that, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e444" xlink:type="simple"/></inline-formula> (no couplings), the log-likelihood is the negative of the sum of all single-column entropies, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e445" xlink:type="simple"/></inline-formula>. The optimal patterns, <italic>i.e.</italic> those optimizing the log-likelihood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e446" xlink:type="simple"/></inline-formula> are given by <xref ref-type="disp-formula" rid="pcbi.1003176.e156">Eqs. (19)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003176.e159">(20)</xref>. The total log-likelihood corresponding to this selection reads:<disp-formula id="pcbi.1003176.e447"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e447" xlink:type="simple"/><label>(37)</label></disp-formula>where function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e448" xlink:type="simple"/></inline-formula> is defined in <xref ref-type="disp-formula" rid="pcbi.1003176.e193">Eq. (23)</xref>, and the bounds <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e449" xlink:type="simple"/></inline-formula> are defined in the Results Section.</p>
<p>The solution given in <xref ref-type="disp-formula" rid="pcbi.1003176.e156">Eqs. (19)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003176.e159">(20)</xref> is defined up to a rotation in the pattern space, <italic>i.e.</italic> up to multiplication of all patterns with an indefinite orthogonal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e450" xlink:type="simple"/></inline-formula>–matrix, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e451" xlink:type="simple"/></inline-formula>, in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e452" xlink:type="simple"/></inline-formula>. Indeed, the patterns <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e453" xlink:type="simple"/></inline-formula> and their rotated counterparts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e454" xlink:type="simple"/></inline-formula> define the same set of couplings <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e455" xlink:type="simple"/></inline-formula> through <xref ref-type="disp-formula" rid="pcbi.1003176.e144">Eq. (18)</xref>. Note that this invariance is specific to the Hopfield model, and should not be mistaken for the gauge invariance of the Potts model discussed in the Results Sections. We eliminate this arbitrariness according to the following procedure, detailed in <xref ref-type="supplementary-material" rid="pcbi.1003176.s001">Text S1</xref>: Our selection corresponds to the case where patterns are added one after the other, starting with the best possible single pattern, followed by the second best (orthogonal to the first one when single-site correlations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e456" xlink:type="simple"/></inline-formula> are factored out) etc.</p>
</sec><sec id="s4d">
<title>Contact prediction from couplings</title>
<p>Intuitively, residue position pairs with strong direct couplings are our best predictions for native contacts in the protein structure. To measure ‘coupling strength’, we need, however, to map the inferred <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e457" xlink:type="simple"/></inline-formula> coupling matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e458" xlink:type="simple"/></inline-formula> onto a scalar parameter, for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e459" xlink:type="simple"/></inline-formula>. Whereas previous works on DCA have mainly used the so-called direct information <xref ref-type="bibr" rid="pcbi.1003176-Weigt1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003176-Morcos1">[19]</xref>, it was recently observed that a different score actually improves the contact prediction starting from the same model parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e460" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003176-Ekeberg1">[49]</xref>. To this end, we introduce the Frobenius norm<disp-formula id="pcbi.1003176.e461"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e461" xlink:type="simple"/><label>(38)</label></disp-formula>of the linearly transformed coupling matrices<disp-formula id="pcbi.1003176.e462"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e462" xlink:type="simple"/><label>(39)</label></disp-formula>where ‘⋅’ denotes average over all amino acids and the gap in the concerned position. According to the above discussion, this corresponds to another gauge of the Hopfield-Potts model, more precisely to the gauge minimizing the Frobenius norm of each coupling matrix <xref ref-type="bibr" rid="pcbi.1003176-Weigt1">[17]</xref>. Further more, the norm is adjusted by an <italic>average product correction</italic> (APC) term, introduced in <xref ref-type="bibr" rid="pcbi.1003176-Dunn1">[16]</xref> to suppress effects from phylogenetic bias and insufficient sampling. Incorporating also this correction, we get our final scalar score:<disp-formula id="pcbi.1003176.e463"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003176.e463" xlink:type="simple"/><label>(40)</label></disp-formula>where the ‘⋅’ now indicates a position average.</p>
<p>Sorting column pairs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e464" xlink:type="simple"/></inline-formula> by decreasing values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e465" xlink:type="simple"/></inline-formula> calculated using standard mean-field DCA was shown to give accurate predictions for residue contacts in various proteins, <italic>i.e.</italic> in the case where all possible patterns are included (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e466" xlink:type="simple"/></inline-formula>) in <xref ref-type="disp-formula" rid="pcbi.1003176.e144">Eq. (18)</xref>. The Results Section shows how the performance in contact prediction varies when the number of patterns is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003176.e467" xlink:type="simple"/></inline-formula>.</p>
<p>Note that this criterion gives a coupling score to each pair of residue positions. The method itself does not provide a cutoff value for this score, below which predictions should not considered any more. Results are therefore typically provided as parametric plots depending on the number of predicted contacts as a free parameter.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003176.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003176.s001" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p>Supporting Information for From principal component to direct coupling analysis of coevolution in proteins: Low–eigenvalue modes are needed for structure prediction.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003176.s002" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1003176.s002" position="float" xlink:type="simple"><label>Code S1</label><caption>
<p>Matlab code for the Hopfield-Potts inference.</p>
<p>(ZIP)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We are grateful to R. Ranganathan and O. Rivoire for discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003176-Pagani1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pagani</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Liolios</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Jansson</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Smirnova</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The Genomes OnLine Database (GOLD) v.4: status of genomic and metagenomic projects and their associated metadata</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>D571</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-The1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><collab xlink:type="simple">The Uniprot Consortium</collab> (<year>2012</year>) <article-title>Reorganizing the protein space at the Universal Protein Resource (UniProt)</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>D71</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Punta1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Punta</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Coggill</surname><given-names>PC</given-names></name>, <name name-style="western"><surname>Eberhardt</surname><given-names>RY</given-names></name>, <name name-style="western"><surname>Mistry</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Tate</surname><given-names>JG</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>D290</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Berman1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berman</surname><given-names>HM</given-names></name>, <name name-style="western"><surname>Kleywegt</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Nakamura</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Markley</surname><given-names>JL</given-names></name> (<year>2012</year>) <article-title>The protein data bank at 40: Reflecting on the past to prepare for the future</article-title>. <source>Structure</source> <volume>20</volume>: <fpage>391</fpage>–<lpage>396</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Gbel1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Göbel</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Schneider</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name> (<year>1994</year>) <article-title>Correlated mutations and residue contacts in proteins</article-title>. <source>Proteins: Struct, Funct, Genet</source> <volume>18</volume>: <fpage>309</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Lockless1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lockless</surname><given-names>SW</given-names></name>, <name name-style="western"><surname>Ranganathan</surname><given-names>R</given-names></name> (<year>1999</year>) <article-title>Evolutionarily conserved pathways of energetic connectivity in protein families</article-title>. <source>Science</source> <volume>286</volume>: <fpage>295</fpage>–<lpage>299</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-deJuan1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>de Juan</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pazos</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name> (<year>2013</year>) <article-title>Emerging methods in protein co-evolution</article-title>. <source>Nature Reviews Genetics</source> <volume>14</volume>: <fpage>249</fpage>–<lpage>261</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Casari1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Casari</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name> (<year>1995</year>) <article-title>A method to predict functional residues in proteins</article-title>. <source>Nature Structural Biology</source> <volume>2</volume>: <fpage>171</fpage>–<lpage>178</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Ortiz1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ortiz</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hu</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Kolinski</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Skolnick</surname><given-names>J</given-names></name> (<year>1997</year>) <article-title>Method for low resolution prediction of small protein tertiary structure</article-title>. <source>Pac Symp Biocomput</source> <fpage>316</fpage>–<lpage>327</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Pazos1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pazos</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Helmer-Citterich</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Ausiello</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name> (<year>1997</year>) <article-title>Correlated mutations contain information about protein- protein interaction</article-title>. <source>J Mol Biol</source> <volume>271</volume>: <fpage>511</fpage>–<lpage>523</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Ortiz2"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ortiz</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kolinski</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Rotkiewicz</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Ilkowski</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Skolnick</surname><given-names>J</given-names></name> (<year>1999</year>) <article-title>Ab initio folding of proteins using restraints derived from evolutionary information</article-title>. <source>PROTEINS: Structure, Function, and Genetics</source> <volume>3</volume>: <fpage>177</fpage>–<lpage>185</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Lapedes1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lapedes</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Giraud</surname><given-names>BG</given-names></name>, <name name-style="western"><surname>Jarzynski</surname><given-names>C</given-names></name> (<year>2002</year>) <article-title>Using sequence alignments to predict protein structure and stability with high accuracy</article-title>. <source>LANL preprint</source> Available: <ext-link ext-link-type="uri" xlink:href="http://library.lanl.gov/cgi-bin/getfile?01038177.pdf" xlink:type="simple">http://library.lanl.gov/cgi-bin/getfile?01038177.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Fodor1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fodor</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>Aldrich</surname><given-names>RW</given-names></name> (<year>2004</year>) <article-title>Influence of conservation on calculations of amino acid covariance in multiple sequence alignments</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source> <volume>56</volume>: <fpage>211</fpage>–<lpage>221</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Socolich1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Socolich</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lockless</surname><given-names>SW</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>HL</given-names></name>, <name name-style="western"><surname>Gardner</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Ranganathan</surname><given-names>R</given-names></name> (<year>2005</year>) <article-title>Evolutionary Information for Specifying a Protein Fold</article-title>. <source>Nature</source> <volume>437</volume>: <fpage>512</fpage>–<lpage>518</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Russ1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Russ</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Lowery</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Mishra</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Yaffe</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ranganathan</surname><given-names>R</given-names></name> (<year>2005</year>) <article-title>Natural-like Function in Artificial WW Domains</article-title>. <source>Nature</source> <volume>437</volume>: <fpage>579</fpage>–<lpage>583</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Dunn1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dunn</surname><given-names>SD</given-names></name>, <name name-style="western"><surname>Wahl</surname><given-names>LM</given-names></name>, <name name-style="western"><surname>Gloor</surname><given-names>GB</given-names></name> (<year>2008</year>) <article-title>Mutual information without the influence of phylogeny or entropy dramatically improves residue contact prediction</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>333</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Weigt1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>White</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Szurmant</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Hoch</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name> (<year>2009</year>) <article-title>Identification of direct residue contacts in protein-protein interaction by message passing</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>106</volume>: <fpage>67</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Burger1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burger</surname><given-names>L</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname><given-names>E</given-names></name> (<year>2010</year>) <article-title>Disentangling Direct from Indirect Co-Evolution of Residues in Protein Alignments</article-title>. <source>PLoS Comput Biol</source> <volume>6</volume>: <fpage>E1000633</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Morcos1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morcos</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Pagnani</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lunt</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Bertolino</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Marks</surname><given-names>DS</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>E1293</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Balakrishnan1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balakrishnan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Kamisetty</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Carbonell</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>SI</given-names></name>, <name name-style="western"><surname>Langmead</surname><given-names>CJ</given-names></name> (<year>2011</year>) <article-title>Learning generative models for protein fold families</article-title>. <source>Proteins: Struct, Funct, Bioinf</source> <volume>79</volume>: <fpage>1061</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Jones1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname><given-names>DT</given-names></name>, <name name-style="western"><surname>Buchan</surname><given-names>DWA</given-names></name>, <name name-style="western"><surname>Cozzetto</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pontil</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>PSICOV: precise structural contact prediction using sparse inverse covariance estimation on large multiple sequence alignments</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>184</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Yeang1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yeang</surname><given-names>C</given-names></name> (<year>2007</year>) <collab xlink:type="simple">Haussler</collab> (<year>2007</year>) <article-title>Detecting coevolution in and among protein domains</article-title>. <source>Plos Comput Biol</source> <volume>31</volume><supplement>(11)</supplement>: <fpage>e211</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Jaynes1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jaynes</surname><given-names>ET</given-names></name> (<year>1957</year>) <article-title>Information Theory and Statistical Mechanics</article-title>. <source>Physical Review Series II</source> <volume>106</volume>: <fpage>620630</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Jaynes2"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jaynes</surname><given-names>ET</given-names></name> (<year>1957</year>) <article-title>Information Theory and Statistical Mechanics II</article-title>. <source>Physical Review Series II</source> <volume>108</volume>: <fpage>171190</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Schneidman1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Berry</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Segev</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name> (<year>2006</year>) <article-title>Weak pairwise correlations imply strongly correlated network states in a neural population</article-title>. <source>Nature</source> <volume>440</volume>: <fpage>1007</fpage>–<lpage>1012</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Cocco1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cocco</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Monasson</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Neuronal couplings between retinal ganglion cells inferred by efficient inverse statistical physics methods</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>106</volume>: <fpage>14058</fpage>–<lpage>62</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Lezon1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lezon</surname><given-names>TR</given-names></name>, <name name-style="western"><surname>Banavar</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Cieplak</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Maritan</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Fedoroff</surname><given-names>NV</given-names></name> (<year>2006</year>) <article-title>Using the principle of entropy maximization to infer genetic interaction networks from gene expression patterns</article-title>. <source>Proc Nat Acad Sci</source> <volume>103</volume>: <fpage>19033</fpage>–<lpage>19038</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Bialek1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Cavagna</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Giardina</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Mora</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Silvestri</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Statistical mechanics for natural flocks of birds</article-title>. <source>Proc Nat Acad Sci</source> <comment>[epub ahead of print] doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1118633109" xlink:type="simple"> 10.1073/pnas.1118633109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003176-Lapedes2"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lapedes</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Giraud</surname><given-names>BG</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>1999</year>) <article-title>Correlated mutations in models of protein sequences: Phylogenetic and structural effects</article-title>. <source>Lecture Notes-Monograph Series: Statistics in Molecular Biology and Genetics</source> <volume>33</volume>: <fpage>236</fpage>–<lpage>256</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Schug1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schug</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Onuchic</surname><given-names>JN</given-names></name>, <name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Szurmant</surname><given-names>H</given-names></name> (<year>2009</year>) <article-title>High-resolution protein complexes from integrating genomic information with molecular simulation</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>106</volume>: <fpage>22124</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Marks1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marks</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Colwell</surname><given-names>LJ</given-names></name>, <name name-style="western"><surname>Sheridan</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Hopf</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Pagnani</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Protein 3D Structure Computed from Evolutionary Sequence Variation</article-title>. <source>PLoS ONE</source> <volume>6</volume>: <fpage>e28766</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Sadowski1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sadowski</surname><given-names>MI</given-names></name>, <name name-style="western"><surname>Maksimiak</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Taylor</surname><given-names>WR</given-names></name> (<year>2011</year>) <article-title>Direct correlation analysis improves fold recognition</article-title>. <source>Computational Biology and Chemistry</source> <volume>35</volume>: <fpage>323</fpage>–<lpage>332</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Sulkowska1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sulkowska</surname><given-names>JI</given-names></name>, <name name-style="western"><surname>F Morcos</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Onuchic</surname><given-names>JN</given-names></name> (<year>2012</year>) <article-title>Genomics-aided structure prediction</article-title>. <source>Proc Natl Acad Sci</source> <volume>109</volume>: <fpage>10340</fpage>–<lpage>10345</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Nugent1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nugent</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>DT</given-names></name> (<year>2012</year>) <article-title>Accurate de novo structure prediction of large transmembrane protein domains using fragment-assembly and correlated mutation analysis</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>109</volume>: <fpage>E1540</fpage>–<lpage>E1547</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Hopf1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hopf</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Colwell</surname><given-names>LJ</given-names></name>, <name name-style="western"><surname>Sheridan</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Rost</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Three-dimensional structures of membrane proteins from genomic sequencing</article-title>. <source>Cell</source> <volume>149</volume>: <fpage>1607</fpage>–<lpage>1621</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Dago1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dago</surname><given-names>AE</given-names></name>, <name name-style="western"><surname>Schug</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Procaccini</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hoch</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Structural basis of histidine kinase autophosphorylation deduced by integrating genomics, molecular dynamics, and mutagenesis</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>109</volume>: <fpage>10148</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Marks2"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marks</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Hopf</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>Protein Structure Prediction from Sequence Variation</article-title>. <source>Nature Biotechnology</source> <volume>30</volume>: <fpage>1072</fpage>–<lpage>1080</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Taylor1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Taylor</surname><given-names>WR</given-names></name>, <name name-style="western"><surname>Hamilton</surname><given-names>RS</given-names></name>, <name name-style="western"><surname>Sadowski</surname><given-names>MI</given-names></name> (<year>2013</year>) <article-title>Prediction of contacts from correlated sequence substitutions</article-title>. <source>Current Opinion in Structural Biology</source> <volume>23</volume>: <fpage>473</fpage>–<lpage>479</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Pearson1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pearson</surname><given-names>K</given-names></name> (<year>1901</year>) <article-title>On lines and planes of closest fit to systems of points in space</article-title>. <source>Philosophical Magazine</source> <volume>2</volume>: <fpage>559</fpage>–<lpage>572</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Halabi1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Halabi</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Rivoire</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ranganathan</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Protein Sectors: Evolutionary Units of Three-Dimensional Structure</article-title>. <source>Cell</source> <volume>138</volume>: <fpage>774</fpage>–<lpage>786</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Bai1"><label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Bai Z, Silverstein JW (2009) Spectral analysis of large dimensional random matrices. London: Springer.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Hopfield1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hopfield</surname><given-names>JJ</given-names></name> (<year>1982</year>) <article-title>Neural networks and physical systems with emergent collective computational abilities</article-title>. <source>Proc Natl Acad Sci</source> <volume>79</volume>: <fpage>25542558</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Cocco2"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cocco</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Monasson</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Sessak</surname><given-names>V</given-names></name> (<year>2011</year>) <article-title>High-Dimensional Inference with the generalized Hopfield Model: Principal Component Analysis and Corrections</article-title>. <source>Physical Review E</source> <volume>83</volume>: <fpage>051123</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Wu1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>FY</given-names></name> (<year>1982</year>) <article-title>The Potts Model</article-title>. <source>Rev Mod Phys</source> <volume>54</volume>: <fpage>235</fpage>–<lpage>268</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Rausell1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rausell</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Juan</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pazos</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name> (<year>2010</year>) <article-title>Protein interactions and ligand binding: From protein subfamilies to functional specificity</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>107</volume>: <fpage>1995</fpage>–<lpage>2000</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Wlodawer1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wlodawer</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Walter</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Sjolin</surname><given-names>L</given-names></name> (<year>1984</year>) <article-title>Structure of bovine pancreatic trypsin inhibitor: Results of joint neutron and x-ray refinement of crystal form ii</article-title>. <source>Journal of Molecular Biology</source> <volume>180</volume>: <fpage>301</fpage>–<lpage>329</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Bent1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bent</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Isaacs</surname><given-names>NW</given-names></name>, <name name-style="western"><surname>Mitchell</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Riboldi-Tunnicliffe</surname><given-names>A</given-names></name> (<year>2004</year>) <article-title>Crystal Structure of the Response Regulator 02 Receiver Domain, the Essential YycF Two-Component System of Streptococcus pneumoniae in both Complexed and Native States</article-title>. <source>J Bacteriol</source> <volume>186</volume>: <fpage>2872</fpage>–<lpage>2879</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Pai1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pai</surname><given-names>EF</given-names></name>, <name name-style="western"><surname>Krengel</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Petsko</surname><given-names>GA</given-names></name>, <name name-style="western"><surname>Goody</surname><given-names>RS</given-names></name>, <name name-style="western"><surname>Kabsch</surname><given-names>W</given-names></name>, <etal>et al</etal>. (<year>1990</year>) <article-title>Refined crystal structure of the triphosphate conformation of h-Ras p21 at 1.35 a resolution: implications for the mechanism of gtp hydrolysis</article-title>. <source>EMBO J</source> <volume>9</volume>: <fpage>2351</fpage>–<lpage>2359</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Ekeberg1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ekeberg</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lövkvist</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lan</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>E</surname><given-names>A</given-names></name> (<year>2013</year>) <article-title>Improved contact prediction in proteins: Using pseudolikelihoods to infer Potts models</article-title>. <source>Phys Rev E</source> <volume>87</volume>: <fpage>012707</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003176-Ashkenazy1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ashkenazy</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Erez</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Martz</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Pupko</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Ben-Tal</surname><given-names>N</given-names></name> (<year>2010</year>) <article-title>ConSurf 2010: calculating evolutionary conservation in sequence and structure of proteins and nucleic acids</article-title>. <source>Nucleic Acids Research</source> <volume>38</volume>: <fpage>W529</fpage>–<lpage>33</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>