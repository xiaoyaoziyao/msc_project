<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-00846</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003339</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories>
<title-group>
<article-title>Genetic Architecture Promotes the Evolution and Maintenance of Cooperation</article-title>
<alt-title alt-title-type="running-head">Genetic Architecture Promotes Cooperation</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Frénoy</surname><given-names>Antoine</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Taddei</surname><given-names>François</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Misevic</surname><given-names>Dusan</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
</contrib-group>
<aff id="aff1"><addr-line>INSERM U1001, Université Paris Descartes, Sorbonne Paris Cité, Faculté de Médecine Paris Descartes, Paris, France</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Wilke</surname><given-names>Claus O.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Texas at Austin, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">frenoy@gmx.com</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: AF DM FT. Performed the experiments: AF. Analyzed the data: AF DM. Contributed reagents/materials/analysis tools: AF DM. Wrote the paper: AF DM.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>11</month><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>21</day><month>11</month><year>2013</year></pub-date>
<volume>9</volume>
<issue>11</issue>
<elocation-id>e1003339</elocation-id>
<history>
<date date-type="received"><day>16</day><month>5</month><year>2013</year></date>
<date date-type="accepted"><day>30</day><month>9</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Frénoy et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/3.0/" xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>When cooperation has a direct cost and an indirect benefit, a selfish behavior is more likely to be selected for than an altruistic one. Kin and group selection do provide evolutionary explanations for the stability of cooperation in nature, but we still lack the full understanding of the genomic mechanisms that can prevent cheater invasion. In our study we used Aevol, an agent-based, <italic>in silico</italic> genomic platform to evolve populations of digital organisms that compete, reproduce, and cooperate by secreting a public good for tens of thousands of generations. We found that cooperating individuals may share a phenotype, defined as the amount of public good produced, but have very different abilities to resist cheater invasion. To understand the underlying genetic differences between cooperator types, we performed bio-inspired genomics analyses of our digital organisms by recording and comparing the locations of metabolic and secretion genes, as well as the relevant promoters and terminators. Association between metabolic and secretion genes (promoter sharing, overlap via frame shift or sense-antisense encoding) was characteristic for populations with robust cooperation and was more likely to evolve when secretion was costly. In mutational analysis experiments, we demonstrated the potential evolutionary consequences of the genetic association by performing a large number of mutations and measuring their phenotypic and fitness effects. The non-cooperating mutants arising from the individuals with genetic association were more likely to have metabolic deleterious mutations that eventually lead to selection eliminating such mutants from the population due to the accompanying fitness decrease. Effectively, cooperation evolved to be protected and robust to mutations through entangled genetic architecture. Our results confirm the importance of second-order selection on evolutionary outcomes, uncover an important genetic mechanism for the evolution and maintenance of cooperation, and suggest promising methods for preventing gene loss in synthetically engineered organisms.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Cooperation is a much studied and debated phenomena in the microbial world marked by a key question: Given the survival of the fittest evolutionary paradigm, why do individuals act in seemingly altruistic ways, paying a cost to help others? Kin selection and group selection, together with mathematical tools from areas such as economics and game theory, have provided some answers. However, they largely ignored the underlying genetic and genomic mechanisms that drive the evolution of cooperation. In this study, we show that the architecture of the genomes has a major role in shaping the fate of cooperating populations. Specifically, we use an <italic>in silico</italic> evolution platform and discover that genes for cooperative traits are “hiding” behind metabolic ones by overlapping their sequences or sharing operons. In conditions where cheaters may outcompete the cooperators, this entangled architecture evolves spontaneously and effectively protects cooperation from invasion by cheater mutants. We describe a novel genetic mechanism for the evolution and maintenance of cooperation and, by taking into account the second order selection pressures on the genomes, highlight the need for going beyond simple game theory models in its study.</p>
</abstract>
<funding-group><funding-statement>This work was funded by the French “Agence Nationale de la Recherche” (<ext-link ext-link-type="uri" xlink:href="http://www.agence-nationale-recherche.fr/" xlink:type="simple">http://www.agence-nationale-recherche.fr/</ext-link>) via the project grant “COOPINFO” (ANR-10-BLAN-1724). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>The evolution of cooperation in microbial populations is a fascinating, rich and controversial evolutionary problem <xref ref-type="bibr" rid="pcbi.1003339-Hamilton1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1003339-West1">[6]</xref>. The theoretical understanding of cooperation has been gradually advancing for decades, and recently those insights have also been applied to practical, medical problems, such as the treatment of infections triggered by cooperating, pathogenic bacteria <xref ref-type="bibr" rid="pcbi.1003339-Brown1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Inglis1">[8]</xref>. Most evolutionary explanations of cooperation rely on kin selection and group selection theories and are constantly being improved and refined by a host of mathematical tools <xref ref-type="bibr" rid="pcbi.1003339-Grafen1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Lehmann1">[10]</xref>. Among them, the game theory and meta-population models have proved to be especially useful in the analysis of long term versus short term, as well as the individual versus population benefit of cooperation <xref ref-type="bibr" rid="pcbi.1003339-Axelrod2">[11]</xref>–<xref ref-type="bibr" rid="pcbi.1003339-Antal1">[14]</xref>. However, those methods tell us practically nothing about the evolutionary pressure on the structure of genomes that encode the cooperative traits. They typically do not distinguish between genotypes and phenotypes and consider only a finite set of possible behaviors (often only two: cooperate or not) with a constant extrinsic probability of switching between them. Although some recent papers do go further than evolving classical binary behavior by considering more complex stochastic strategies that take into account past interactions <xref ref-type="bibr" rid="pcbi.1003339-Iliopoulos1">[15]</xref>, they also remain “one locus = one parameter” models, unable to consider genetic architecture of cooperation genes. Several experimental studies have shown the need to go beyond these limitations to understand cooperation in microbial systems. Specifically, Foster <italic>et al.</italic> demonstrated that the pleiotropic effect of a <italic>Dictyostelium discoideum</italic> gene involved in a cooperative behavior (differentiation into prestalk cells) causes the mutations inducing cheating behavior to be associated with a direct fitness cost to the individual <xref ref-type="bibr" rid="pcbi.1003339-Foster1">[16]</xref>. Similarly, cheating mutations induce a cost in <italic>Pseudomonas aeruginosa</italic> because of co-regulation of public and “private” goods via the same quorum-sensing mechanism <xref ref-type="bibr" rid="pcbi.1003339-Dandekar1">[17]</xref>.</p>
<p>We postulate that genomic architecture of metabolic and secretion genes – achieved by sense-antisense coding or frameshifts – can provide a mechanism for the evolution and maintenance of cooperation that is similar but more basic than ones relying on genetic pleiotropy or co-regulation. Here we investigate how two specific types of genomic architecture of cooperation genes may affect the evolutionary fate of cooperation itself. The first type relies on the concept of operons, already well described and investigated in the context of co-regulation or co-transfer of genes in the same operon <xref ref-type="bibr" rid="pcbi.1003339-Jacob1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Lawrence1">[19]</xref>. We specifically consider metabolic and secretion genes that have the same promoter and terminator sequence, thus sharing an operon. The second architecture type is the overlap, base-pair sharing between metabolic and secretion genes due to being in different reading frames or on different DNA strands. Although more rare in bacterial context, gene overlaps may be caused by the strong constraints on maximum genome size and have similar evolutionary explanations and properties as operons <xref ref-type="bibr" rid="pcbi.1003339-Normark1">[20]</xref>. We describe and quantify the role of both these genetic architecture types and show that physical association of cooperation and metabolic genes, via operon and overlap, introduces an evolutionary constraint, pleiotropy in the broad sense, which prevents non-cooperating, cheater individuals from prospering and protects cooperation. Even though the same DNA coding for multiple proteins can, in a broad sense, be viewed as pleiotropy at the sequence level, as far as we know, its importance has never been described in the context of cooperation.</p>
<p>In all our experiments we use the Aevol platform <xref ref-type="bibr" rid="pcbi.1003339-Knibbe1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Knibbe2">[22]</xref>, an <italic>in silico</italic> experimental evolution system. While similar to existing individual-based, genetic-algorithm simulations, Aevol embodies a number of features inspired by microbial genetics that make it especially well suited for our study. For example, the phenotype of an Aevol digital organism is a continuous function comprised of a potentially unlimited number of biological processes and their performance level, which in turn allows for a continuous cooperating phenotype instead of the classical binary one. When it evolves, the cooperation among individuals is based on a public good molecule that diffuses and degrades in the environment. Individuals live in a spatially structured world, suitable for the evolution of cooperation <xref ref-type="bibr" rid="pcbi.1003339-Nowak1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Oliphant1">[24]</xref> and more similar to natural microbial populations than classical meta-population models. The public good is costly to secrete but may benefit any neighboring organisms. Both indirectly selected secretion genes and metabolic genes contributing to fitness directly are encoded in the double-stranded genomes strings of zeros and ones. A set of rules for transcription, translation and protein synthesis governs the complex genotype to phenotype to fitness mapping. Phenotypically similar or even identical individuals can have different genotypes, thus also having different evolvability, robustness, and evolutionary fate <xref ref-type="bibr" rid="pcbi.1003339-Frnoy1">[25]</xref>. All these properties of Aevol set the stage for evolutionary experiments where genetic architecture constraints of cooperation can be both observed and described. We first demonstrate the existence of differences in the resistance to cheater invasion among several phenotypically equivalent populations. We then correlate the maintenance of cooperation genes with the abundance of promoter sharing or overlapping between metabolic and secretion genes. We hypothesize that such non-random encoding of the secretion is indirectly selected for in situations when cooperation is favored. Indeed, when evolving populations start from a naive, non-secreting ancestor, the cooperators employed this protective encoding, and more so when the cooperation cost was high. Mutational analysis confirmed that the constrained genetic architecture resulted in cooperation-destroying mutations also having a direct negative fitness effect. Overall, our results highlight the need for considering appropriately detailed and realistic computational systems and generally show the importance of second-order selection pressures and genetic architecture in the study and understanding of the evolution and maintenance of cooperation.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Creating a bank of cooperators: General properties</title>
<p>In our modified version of Aevol dedicated to the study of cooperation, the phenotype is divided into two groups of traits: metabolism (biological processes allowing the individual to live and reproduce) and secretion (processes relating to the costly secretion of a diffusible public good molecule). Starting from an ancestor with a single, metabolic gene, we independently evolved <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e001" xlink:type="simple"/></inline-formula> populations for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e002" xlink:type="simple"/></inline-formula> generations. We effectively put cooperation under direct selection by using a particular fitness calculation in which secretion genes were treated the same as the metabolic ones during evolution. At the end of this phase, we chose the fittest individual from each replicate and, by simply reassigning half of the phenotype from metabolism to secretion, obtained <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e003" xlink:type="simple"/></inline-formula> cooperators with high secretion levels. Specifically, their average secretion was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e004" xlink:type="simple"/></inline-formula>% of the maximal secretion in Aevol, and the standard deviation in secretion was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e005" xlink:type="simple"/></inline-formula>% of the mean. These individuals had generally comparable metabolic and secretion part of their phenotype with on average <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e006" xlink:type="simple"/></inline-formula> genes in each.</p>
</sec><sec id="s2b">
<title>Cheater invasion dynamics differs between populations</title>
<p>Using the cooperators from previous experiments, we started with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e007" xlink:type="simple"/></inline-formula> clonal populations that we then let evolve for an additional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e008" xlink:type="simple"/></inline-formula> generations with a possibility of secreting at a moderately high cost (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e009" xlink:type="simple"/></inline-formula>, see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for the effect of public good cost and fitness calculation details). Each of these populations was replicated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e010" xlink:type="simple"/></inline-formula> times, for a total of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e011" xlink:type="simple"/></inline-formula> experiments. In all cases the amount of secretion greatly decreased, but not by the same amount or at the same rate (<xref ref-type="fig" rid="pcbi-1003339-g001">Fig. 1</xref>). To quantify these differences, we performed a one-way ANOVA on the average secretion between generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e012" xlink:type="simple"/></inline-formula> and generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e013" xlink:type="simple"/></inline-formula>, the visually chosen time interval during which cooperation is stabilizing to a new level after a quick and strong decay. We found a highly significant between groups effect (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e014" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e015" xlink:type="simple"/></inline-formula>), each group consisting of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e016" xlink:type="simple"/></inline-formula> populations that share a common ancestor, confirming that some cooperators are intrinsically more resistant to cheater invasion than others, even though they initially had very similar phenotypes. Moreover, there was no significant correlation between the ancestral cooperation level and the final one (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e017" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e018" xlink:type="simple"/></inline-formula>), eliminating the possibility of our results being driven by an initial difference in the population cooperation level.</p>
<fig id="pcbi-1003339-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003339.g001</object-id><label>Figure 1</label><caption>
<title>Cheater invasion dynamics in phenotypically similar starting populations.</title>
<p>In the main figure each line represents the average secretion, over time, of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e019" xlink:type="simple"/></inline-formula> replicate populations started from the same ancestor. For clarity, we did not include the standard error of each group of replicate populations. The insert figure shows all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e020" xlink:type="simple"/></inline-formula> replicate populations for the two most extreme population groups, zoomed in on the time period of interest for our analyses. Specifically, of all the population groups sharing a common ancestor, the blue populations had the highest and red the lowest average secretion between generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e021" xlink:type="simple"/></inline-formula> and generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e022" xlink:type="simple"/></inline-formula>. Note that average secretion in the inset represents the average secretion within each population, whilst in the main figure it is the average of the secretion of all the individuals from the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e023" xlink:type="simple"/></inline-formula> replicate populations that share the same ancestor.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003339.g001" position="float" xlink:type="simple"/></fig>
<p>When visually inspecting the phenotype of a randomly chosen cooperator and its descendants from the previous experiment, we also noticed that it was the same secretion genes that survived cheater invasion between several independent replicates of evolution. One such example, where the phenomenon was especially striking, is presented in <xref ref-type="fig" rid="pcbi-1003339-g002">Fig. 2</xref>. While we did not perform any statistical analysis because of the computational difficulty of tracking every protein for several thousands of generations, this observation motivated further experiments: it supports the idea that our <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e024" xlink:type="simple"/></inline-formula> populations are different (in their resistance to cheater invasion) because their secretion genes are somehow different.</p>
<fig id="pcbi-1003339-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003339.g002</object-id><label>Figure 2</label><caption>
<title>Example of the preferential maintenance of certain secretion genes of a single cooperator from our bank.</title>
<p>The bottom row of the graph (ancestor) shows the location on the phenotypic axis of the genes coding for secretion proteins in one cooperator organism from our bank. Above, the secretion genes from the best individual after <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e025" xlink:type="simple"/></inline-formula> generations of evolution in each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e026" xlink:type="simple"/></inline-formula> replicate populations descending from this ancestor are shown. Colors represent the height of the proteins encoded by the genes (see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for detailed explanation of protein properties in Aevol).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003339.g002" position="float" xlink:type="simple"/></fig></sec><sec id="s2c">
<title>Genetic architecture and resistance to cheater invasion</title>
<p>To quantify the genetic architecture of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e027" xlink:type="simple"/></inline-formula> ancestral organisms we measured the percentage of secretion genes that (1) share an operon with at least one metabolic gene, (2) overlap with at least one metabolic gene, (3) satisfy at least one of (1) and (2), or (4) satisfy both (1) and (2) (see Material and Methods for more details). We then compared the genetic architecture measures with the resistance to cheater invasion, expressed as the average remaining secretion between generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e028" xlink:type="simple"/></inline-formula> and generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e029" xlink:type="simple"/></inline-formula>, as before (<xref ref-type="fig" rid="pcbi-1003339-g003">Fig. 3</xref>). We found that all four genetic architecture properties strongly correlate with the remaining secretion amount (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e030" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e031" xlink:type="simple"/></inline-formula> for operon sharing, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e032" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e033" xlink:type="simple"/></inline-formula> for overlapping, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e034" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e035" xlink:type="simple"/></inline-formula> for at least one of them, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e036" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e037" xlink:type="simple"/></inline-formula> for both of them), supporting our hypothesis that physical linkage between secretion and metabolic genes confers resistance to cheater invasions.</p>
<fig id="pcbi-1003339-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003339.g003</object-id><label>Figure 3</label><caption>
<title>Correlation between the genetic architecture of cooperation genes and the resistance to cheater invasion.</title>
<p>Resistance is measured by the amount of secretion surviving cheater invasion. The four types of associations between secretion and metabolic genes shown here are: sharing an operon (A, dark blue), overlapping (B, green), having at least one of the previous two properties (C, red), and having both of them (D, light blue).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003339.g003" position="float" xlink:type="simple"/></fig></sec><sec id="s2d">
<title>Mutation effects and resistance to cheater invasion</title>
<p>In order to confirm the effect of genetic architecture on cheater resistance, rather than examining the exact locations and interactions between genes and using them to infer population's evolutionary fate, we directly quantified the effect of mutations on secretion and fitness. We constructed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e038" xlink:type="simple"/></inline-formula> mutants of each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e039" xlink:type="simple"/></inline-formula> ancestors, and calculated the mutational effect as the percentage of mutations that decrease the amount secreted without decreasing metabolic fitness, weighted by their negative effect on secretion. We found significant correlations between the mutation effect and both the robustness to cheater invasion (calculated as before, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e040" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e041" xlink:type="simple"/></inline-formula>) and the genetic architecture (here defined as the percentage of secretion genes sharing an operon or overlapping with at least one metabolic gene, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e042" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e043" xlink:type="simple"/></inline-formula>). Simply put, the individuals with genetic architecture that groups together metabolism and secretion genes exhibit higher resistance to cheaters, because they are subject to fewer mutations that would convert cooperators into cheaters without any direct fitness loss.</p>
<p>We thus have two measures that predict well the resistance to cheater invasion: genetic architecture and accessibility of mutations. Since the generation range used to quantify cheater resistance was chosen <italic>ad hoc</italic>, we also examined the effect of different ranges on the correlations. Interestingly, we found that genetic architecture is better correlated with cheater resistance when it is measured between generations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e044" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e045" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e046" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e047" xlink:type="simple"/></inline-formula>) than between generations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e048" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e049" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e050" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e051" xlink:type="simple"/></inline-formula>). Conversely, mutational effects are better correlated with cheater resistance measured in the early (generations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e052" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e053" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e054" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e055" xlink:type="simple"/></inline-formula>) than late interval (generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e056" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e057" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e058" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e059" xlink:type="simple"/></inline-formula>). Overall, both genetic architecture and mutation effects are good predictors of how easily cooperators may be invaded by cheaters, but genetic architecture is better at predicting long-term effects, while mutational effects are more strongly correlated with short-term ones. Mutations may affect long-term maintenance of cooperation in many ways and genetic architecture captures but one of them. As we elaborate in the <xref ref-type="sec" rid="s3">Discussion</xref> section below, these results indicate that while all mutational constraints play a role, it is the overlap and operon ones that have the strongest long-term evolutionary consequences.</p>
</sec><sec id="s2e">
<title>Preferential maintenance of secretion genes based on genetic architecture</title>
<p>We tested the importance of gene overlap and operon sharing in maintenance of cooperation by examining the extent of genomic connections between secretion and metabolism before and after the increase in secretion cost and the accompanying decrease in cooperation. After <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e060" xlink:type="simple"/></inline-formula> generations of evolution at a higher cost, the secretion genes still present are over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e061" xlink:type="simple"/></inline-formula> times more likely to overlap or share an operon with metabolic genes than the secretion genes a the start of the experiment (<xref ref-type="fig" rid="pcbi-1003339-g004">Fig. 4</xref>), with the difference being highly significant (Welch's t test, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e062" xlink:type="simple"/></inline-formula>). The proportion of all four categories of association between metabolic and secretion genes (share an operon, overlap, do at least one of them, do both) has increased, and all increases were significant (Welch's t test, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e063" xlink:type="simple"/></inline-formula> for operon sharing, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e064" xlink:type="simple"/></inline-formula> for overlapping, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e065" xlink:type="simple"/></inline-formula> for doing at least one of them, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e066" xlink:type="simple"/></inline-formula> for doing both). Note that these categories do not exactly correspond to the partitioning done on <xref ref-type="fig" rid="pcbi-1003339-g004">Fig. 4</xref> (see Material and Methods for detailed explanation), but capture the same general properties of genetic architecture.</p>
<fig id="pcbi-1003339-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003339.g004</object-id><label>Figure 4</label><caption>
<title>Secretion genes at generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e067" xlink:type="simple"/></inline-formula> and at generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e068" xlink:type="simple"/></inline-formula> partitioned between four categories:</title>
<p>(a) sharing a promoter (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e069" xlink:type="simple"/></inline-formula> being on the same operon) without overlapping with a metabolic gene (dark blue), (b) overlapping and sharing an operon with a metabolic gene (light blue), (c) overlapping without sharing an operon with a metabolic gene (green), (d) neither sharing an operon nor overlapping with a metabolic gene (red). Error bars represent one standard error of the mean (fifty original cooperators). The color of the error bars corresponds to the genetic architecture category which they relate to.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003339.g004" position="float" xlink:type="simple"/></fig></sec><sec id="s2f">
<title>Evolution of genetic links between metabolic and cooperation genes</title>
<p>In the previous experiments we worked with already evolved cooperators, measured their resistance to cheater invasion and genetic architecture. We now turn to <italic>de novo</italic> evolution of cooperation, in order to show that gene overlap and operon sharing will evolve, via indirect selection pressures, in conditions moderately favorable for cooperation. Naive ancestors evolved for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e070" xlink:type="simple"/></inline-formula> generations with cooperation cost of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e071" xlink:type="simple"/></inline-formula>. In the final populations, individuals on average had <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e072" xlink:type="simple"/></inline-formula> metabolic genes and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e073" xlink:type="simple"/></inline-formula> secretion genes. While the number of secretion genes is low, by pooling data of all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e074" xlink:type="simple"/></inline-formula> individuals from each population we obtained a large number of genes that we could analyze. We compare the shared operons and gene overlap for metabolic and secretion genes with the same measures applied only within metabolic genes, as a control. The genetic architecture links between metabolic and secretion genes are on average <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e075" xlink:type="simple"/></inline-formula> times stronger than within metabolic genes alone, the difference being highly significant (<xref ref-type="fig" rid="pcbi-1003339-g005">Fig. 5a</xref>, comparing the sum of the three bottom categories – dark blue, light blue and green –, Welch's t test, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e076" xlink:type="simple"/></inline-formula>). The proportion of all four genetic architecture categories differed between the two gene groupings, and all differences were significant (Welch's t test, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e077" xlink:type="simple"/></inline-formula> for operon sharing, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e078" xlink:type="simple"/></inline-formula> for overlapping, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e079" xlink:type="simple"/></inline-formula> for at least one of them, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e080" xlink:type="simple"/></inline-formula> for both). We repeated the analysis for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e081" xlink:type="simple"/></inline-formula> more populations that evolved under a lower secretion cost (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e082" xlink:type="simple"/></inline-formula>) and we observed no difference in genetic association between metabolic and secretion genes compared to associations with metabolic genes alone (<xref ref-type="fig" rid="pcbi-1003339-g005">Fig. 5b</xref>, Welch's t test, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e083" xlink:type="simple"/></inline-formula>). Comparison of the two sets of experiments performed at different secretion costs shows that the preferential association between secretion and metabolic genes evolves only when the cost of cooperation is relatively high.</p>
<fig id="pcbi-1003339-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003339.g005</object-id><label>Figure 5</label><caption>
<title>Genetic architecture associations after <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e084" xlink:type="simple"/></inline-formula> generation of <italic>de novo</italic> evolution of cooperation, at (A) high, c = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e085" xlink:type="simple"/></inline-formula> and (B) low, c = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e086" xlink:type="simple"/></inline-formula> secretion cost.</title>
<p>In both cases, we quantified the presence of operons or overlaps between secretion genes and metabolic genes (S vs M) as well as between metabolic genes and other metabolic genes (M vs M). Genes were partitioned in four categories, labeled as in the <xref ref-type="fig" rid="pcbi-1003339-g004">Fig. 4</xref>: sharing a promoter (an operon) without overlapping with a metabolic gene (dark blue), overlapping and sharing an operon with a metabolic gene (light blue), overlapping without sharing an operon with a metabolic gene (green), not sharing an operon nor overlapping with any metabolic gene (red). Error bars represent plus and minus one standard error of the mean for the fifty replicate populations and their color corresponds to the genetic architecture category they relate to.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003339.g005" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s3">
<title>Discussion</title>
<p>Our research was motivated by two simple observations: (1) phenotypically near-identical populations have different evolutionary fates (<xref ref-type="fig" rid="pcbi-1003339-g001">Fig. 1</xref>), and (2) for a given cooperator, the secretion genes that survive cheater invasion seem to be always the same between several replicates (<xref ref-type="fig" rid="pcbi-1003339-g002">Fig. 2</xref>); and by two straightforward questions: what were the differences between theses populations, and what were the differences between these genes? In our initial experiments we found that when populations cooperating at near-maximal level suddenly faced a direct, high cost of public good secretion, the cheaters were quick to invade. However, the invasion dynamic was qualitatively different across populations, with some ancestors predictably evolving into populations without any cooperation, while others kept low but non-zero levels of secretion (<xref ref-type="fig" rid="pcbi-1003339-g001">Fig. 1</xref>).</p>
<p>We propose that these diverging evolutionary fates for otherwise phenotypically similar populations are due to differences in the ancestral genetic architecture of cooperative traits. In a previous paper we showed that the accessibility of mutations impacting secretion may lead to different future secretion dynamics for phenotypically similar individuals <xref ref-type="bibr" rid="pcbi.1003339-Frnoy1">[25]</xref>. Here we show that in the case of cooperation decay, beyond the simple effect triggered by the accessibility of mutations impacting secretion, the way secretion genes “share” the genome with metabolic genes also has an effect on the selection of these mutations. More precisely, we suggest that secretion genes that are physically connected with a metabolic gene, for example belonging to the same operon, or physically overlapping, are more robust to cheater invasion: a deleterious mutation in one of these genes is more likely to also deleteriously affect a metabolic gene, and thus is less likely to be selected for. Similar mechanisms, coupling cooperative traits with metabolic, individualistic traits have been described before <xref ref-type="bibr" rid="pcbi.1003339-Foster1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Dandekar1">[17]</xref>, but instead of relying on gene coregulation or genes with multiple effect, we report a more basic genetic mechanism of entanglement for genes with singular effects. Additionally, these studies remain two isolated data-points and are thus not enough to show the existence of second order selection pressures leading to such architecture. Bio-informatics methods could provide much more information to support or deny this hypothesis, however there have been very few relevant studies of the genes involved in cooperative behavior, the primary reason being the difficulty of identifying such genes. There is one notable exception <xref ref-type="bibr" rid="pcbi.1003339-Nogueira1">[26]</xref>, where the authors use the prediction of cellular localization: outer membrane and excreted proteins are more likely to be related to cooperative traits than cytoplasmic, inner membrane and periplasmic proteins. Their main result is about the role of horizontal transfer in the evolution of cooperation, however they also show that genes coding for outer membrane and excreted proteins are more likely than others to be “genome neighbors” of addictive systems (e.g. toxin-antitoxin). As the experimental data is suggestive but overall still insufficient, the use of an appropriate individual based model dedicated to the study of evolutionary processes and selection pressures acting on the genome, such as Aevol, is a way to fill the void. Of course, each model has biases and limitations, however, the strong point of Aevol is that we implement only simple, easy to understand, small-scale rules inspired by bacterial genomics, and all other properties and processes are emergent. For example, in Aevol there is no parameter like “probability that two neighboring genes overlap”. Thus, the outcomes we describe here are not directly driven by the model and are not something we necessarily expected to evolve.</p>
<p>Using Aevol we were able to directly test our hypothesis about the effects of genetic architecture on the evolution and maintenance of cooperation we generated and analyzed a total of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e087" xlink:type="simple"/></inline-formula> mutant organisms. About half of the mutants are phenotypically perfectly similar to the original individual (no mutations or only neutral mutations happened). The calculated probability of having no mutations for typical organism with genome length of 10,000 is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e088" xlink:type="simple"/></inline-formula>. The calculated probability of having exactly one mutation is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e089" xlink:type="simple"/></inline-formula>, and the one of having strictly more than one mutation is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e090" xlink:type="simple"/></inline-formula>. We emphasize that a large part of the analyzed mutations are neutral but of course focus on the ones that change organisms fitness and secretion. We recorded the effect of all mutations, specifically searching among “cheating” mutations, the ones that would decrease the amount of secretion, for mutations that do not simultaneously decrease metabolic fitness, and may thus be selected for, or at least not immediately purged by selection. We find that the proportion of these mutations, weighted by their negative effect on secretion, directly and significantly correlates with the population's vulnerability to cheater invasion, which supports our hypothesis. Interestingly, when we measured the remaining cooperation later in time it correlated more strongly with amount of genetic architecture linkage between secretion and metabolism than the measured effect of the introduced mutations. The higher durability of genetic architecture constraints, compared to immediate mutation effects, may be due to the higher durability of the genetic architecture itself. As we saw from the comparison between different gene association categories at generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e091" xlink:type="simple"/></inline-formula> and generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e092" xlink:type="simple"/></inline-formula>, it is exactly the secretion genes that do overlap or share an operon with metabolic genes that may be preserved (<xref ref-type="fig" rid="pcbi-1003339-g004">Fig. 4</xref>). On the other hand, our mutational analysis explored only a small, nearby portion of the immense fitness landscape. As organisms evolve, and move around that landscape, the particular mutants we constructed and analyzed may become less accessible via mutations and thus also less relevant for the evolutionary dynamics. Finally, the enrichment of genotypically connected metabolic and secretion genes among all secretion genes present in the individuals strongly suggests that this type or architecture may generally be created and maintained via indirect selection in cooperative systems.</p>
<p>We should note that in our first set of experiments we used individuals that evolved under an altered fitness calculation regime that enabled us to directly select for future cooperators of similar phenotype but different genotype. We could have as well designed these individuals by hand, directly writing the zeros and ones in their genomes. However, this would have likely generated fragile and generally poorly adapted individuals, as evolution is typically better in organism design than us humans. The change between the alternative fitness calculation and the regular one may appear somewhat artificial or arbitrary, but it can also be seen as a transition from producing a private, non-secreted good, to a public, secreted one. Still, while these results show the effect that architecture may have on cooperation, they do not by themselves prove the existence of second order selection pressure that would be sufficient to create operon and overlap type constraints during the evolution and maintenance of cooperation. We thus turn to our second set of experiments, in which secretion evolves <italic>de novo</italic>, without ever being directly selected for.</p>
<p>The results of this second set of evolution experiments strongly support the hypothesis that when costly cooperation does evolve and persist, there is a selection pressure grouping secretion genes with metabolic genes to protect them from removal. Such selection pressure is necessarily indirect, since cooperation via public good secretion does not directly increase the fitness of the cooperating organisms. Additionally, it would not prevent any “cheaters” from appearing but would reduce their likelihood of having a greater fitness than cooperators and spreading, making overall conditions more favorable for cooperation by reducing the effective mutation rate for switching from being a cooperator to being a potentially invading cheater. Previous work has already established this “mutation rate” (in a binary, game theory vocabulary) is one of the very important parameters controlling the dynamics of cooperation in spatially structured populations <xref ref-type="bibr" rid="pcbi.1003339-Michod1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Allen1">[28]</xref>. Here we extend these results by showing a specific genetic mechanisms that would allow evolution to modulate the rate of switching between potentially invading cheaters and cooperators. The total rate of production of cheaters may not be different between populations, but because of the genetic entanglement of cooperation and metabolism, a large proportion of cheaters is unable to invade and thus such cheater mutants are evolutionary dead-ends.</p>
<p>The role of constraints introduced by second-order selection, such as the one we exemplified here, in assuring the best long-term outcomes has been proposed before in a more general and abstract context <xref ref-type="bibr" rid="pcbi.1003339-Altenberg1">[29]</xref>. Specifically, our results may provide a set of new potential explanations for the evolution of operons and overlaps, important building blocks of life. While in the past operon and overlap existence has been linked to co-regulation and co-transfer of genes working together and belonging to the same sets of biological processes <xref ref-type="bibr" rid="pcbi.1003339-Lawrence1">[19]</xref>, here we highlight their role as an evolutionary constraint. Specifically, operons and overlaps may protect genes that are at risk of removal because of a short-term cost and in spite of the long-term benefit they may provide. Of course, the particular combination of short-term cost and long-term benefit is not unique to cooperation and it underlies other biological processes, most notably sex and recombination, which also continue to be intensely studied <xref ref-type="bibr" rid="pcbi.1003339-Rice1">[30]</xref>. In terms of cooperation itself, genetic architecture constraints may be highly relevant in understanding the much studied siderophore-mediated cooperation in <italic>P. aeruginosa</italic>, where cooperative as well as essential metabolic traits are under the control of a quorum sensing mechanism <xref ref-type="bibr" rid="pcbi.1003339-Dandekar1">[17]</xref>. However, our idea also has large implications outside of the field of cooperation: going beyond explaining evolutionary outcomes, the genetic architecture coupling mechanism we describe here could be actively used to prevent mutations from removing of genes introduced into bio-engineering organisms, one of the major problems in the field of synthetic biology <xref ref-type="bibr" rid="pcbi.1003339-Sleight1">[31]</xref>.</p>
<sec id="s3a">
<title>Conclusion</title>
<p>The study of the evolution and maintenance of cooperation is rich in theories, majority of which rely on higher level properties of individuals, such as relatedness, fitness, or group structure. Our experiments investigate basic, genome-level properties and show that the presence of genetic associations between metabolism and secretion genes aids the maintenance of cooperation across thousands of generations. Operon sharing and gene overlap are selected for when cooperation is costly and directly change populations' evolutionary fate. Second order selection is known to play a major role in the rapid evolution of microbial populations <xref ref-type="bibr" rid="pcbi.1003339-Tenaillon1">[32]</xref> and here we contribute to understanding the specific and much studied case of cooperation via public good secretion. We used an <italic>in silico</italic> experimental platform, Aevol, which has enabled us to collect and analyze genetic architecture and evolutionary dynamics data in detail previously unattainable with either mathematical or experimental systems. The role of second-order selection and genetic constraints in evolution will undoubtedly continue to motivate experimental and theoretical research but in our case it also has the potential to inform bio-engineering and synthetic biology applications.</p>
</sec></sec><sec id="s4" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Aevol digital evolution system</title>
<p>In this study we use the Aevol platform, an individual-based model of evolution, especially well suited for the study of selection pressures on genomic architecture <xref ref-type="bibr" rid="pcbi.1003339-Knibbe1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Knibbe2">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Frnoy1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Parsons1">[33]</xref>. It is free and open-source software and is downloadable from <ext-link ext-link-type="uri" xlink:href="http://www.aevol.fr/download" xlink:type="simple">http://www.aevol.fr/download</ext-link>. The specific version of the platform we used in this study, including analysis routines, parameter files, other minor modifications, is available on request. Aevol has already been used in several peer-reviewed publications including some that studied cooperation, so we invite the reader to refer to <xref ref-type="bibr" rid="pcbi.1003339-Misevic1">[34]</xref> for more information on how cooperation has been implemented and for characterization of the related parameters, and to <xref ref-type="bibr" rid="pcbi.1003339-Knibbe2">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1003339-Knibbe3">[35]</xref> for more general details about the original version of Aevol that did not incorporate cooperation.</p>
<p>In Aevol, the individuals are living on a toroidal, two-dimensional square grid, with each location being occupied by exactly one individual. In our experiments the grid contains <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e093" xlink:type="simple"/></inline-formula> positions, for a total of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e094" xlink:type="simple"/></inline-formula> individuals. Selection and reproduction are performed locally in a synchronous way: at each generation, for each position in the grid, we compete the nine individuals in the neighborhood to determine which one's descendant in going to occupy this position in the next generation.</p>
<p>The phenotype of an individual is represented by a two-dimensional curve describing the level of performance for each point of a continuous set of abstract biological processes. This is a very general way of encoding a phenotype without any restriction on the type of biological processes that can be represented. The genotype is a string of zeros and ones, which is transcribed and translated according to a bacterial genomics-inspired process: promoters and terminators are identified to allow transcription, then the transcribed sequences are searched for ribosomal binding site and start codon, followed by what will be a gene and then by an in-frame stop codon, to allow translation.</p>
<p>Our genetic code is an abstract mathematical function transforming the gene, i.e. the binary sequence between the start and stop codons, into three numbers, interpreted as a triangle on the axis of biological processes. These three numbers are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e095" xlink:type="simple"/></inline-formula> (mean position of the triangle on the phenotypic axis), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e096" xlink:type="simple"/></inline-formula> (half-width of the triangle), and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e097" xlink:type="simple"/></inline-formula> (height of the triangle). Base-pairs are read three by three, and our amino-acid space has eight symbols: START and STOP, M0 and M1 which are used to specify <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e098" xlink:type="simple"/></inline-formula>, W0 and W1 which are used to specify <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e099" xlink:type="simple"/></inline-formula>, H0 and H1 which are used to specify <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e100" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1003339-g006">Fig. 6</xref>). Each of these eight amino-acids is assigned to exactly one of the eight (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e101" xlink:type="simple"/></inline-formula>) possible triplets. There is no redundancy in the codon–amino-acid mapping, however there is still a large redundancy in the gene–protein mapping because codons inside genes can be reordered without impacting phenotype. Specifically, what matters is the order of codons specifying the same triangle property (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e102" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e103" xlink:type="simple"/></inline-formula>, or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e104" xlink:type="simple"/></inline-formula>), while the relative order of codons for different properties can be altered freely. Once a coding sequence has been detected using the rules explained above and transformed into an amino-acid sequence, we extract from there three binary words (for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e105" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e106" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e107" xlink:type="simple"/></inline-formula>) according to the following process: amino acid X0 adds a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e108" xlink:type="simple"/></inline-formula> to the binary word of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e109" xlink:type="simple"/></inline-formula> and X1 adds a 1 to the binary word of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e110" xlink:type="simple"/></inline-formula>, where X is any of M, W, or H. We obtain an integer value for each of the three binary words by interpreting them using Gray code. Gray code is an alternative binary encoding in which two successive integers are encoded by binary numbers differing in only one digit. The integer values are then normalized by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e111" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e112" xlink:type="simple"/></inline-formula> is the number of codons used, and scaled to a [<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e113" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e114" xlink:type="simple"/></inline-formula>] interval for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e115" xlink:type="simple"/></inline-formula>, [<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e116" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e117" xlink:type="simple"/></inline-formula>] for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e118" xlink:type="simple"/></inline-formula>, and [<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e119" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e120" xlink:type="simple"/></inline-formula>] for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e121" xlink:type="simple"/></inline-formula>. Finally the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e122" xlink:type="simple"/></inline-formula> value is multiplied by the transcription efficiency – a property of the promoter explained below. The mean position specifies the primary trait the protein affects, and as it is a real number, it allows for an infinite number of different traits. The height specifies protein's performance level for the primary trait, while the width determines all the traits a protein affects. Individual's phenotype is computed by summing up all the triangles encoded in its genome. There is no genetic regulation via transcription factors in this version of Aevol, however there are protein-protein interactions (two proteins contributing to the same biological processes) and transcription efficiency is regulated by the strength of the promoter (defined as the distance to a consensus sequence). As in natural systems such as bacteria or phages, this genomics allows two genes to cluster on the same mRNA (operon) or to physically use the same DNA basis in different reading frames or different senses (overlap). Examples of these different configurations are represented on <xref ref-type="fig" rid="pcbi-1003339-g007">Fig. 7</xref>.</p>
<fig id="pcbi-1003339-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003339.g006</object-id><label>Figure 6</label><caption>
<title>Aevol genetic code.</title>
<p>Here we use an example of a functioning gene from an Aevol individual to explain the transcription and the translation processes. The gene is flanked by a promoter and terminator regions and preceded by a ribosome binding site (RBS). The codons for mean position, the width, and the height of the protein are identified, transformed into Gray code using the Genetic code table (box on the right), and finally scaled and normalized, as we summarize in the box on the left and describe in more detail in the Methods. Note that a gene with re-shuffled codons, for example H1 H1 M1 M1 M0 W1 W0 W1, would encode exactly the same protein. START codon may occasionally be found inside a gene, in which case it is interpreted as H0. The promoter differs from the consensus sequence by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e123" xlink:type="simple"/></inline-formula> base out of the maximal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e124" xlink:type="simple"/></inline-formula> differences allowed, giving it a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e125" xlink:type="simple"/></inline-formula> efficiency.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003339.g006" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003339-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003339.g007</object-id><label>Figure 7</label><caption>
<title>Examples of constrained genetic architecture in Aevol.</title>
<p>(A) As is often the case in natural systems, here the two digital genes belong to the same operon. They share a promoter and a terminator sequence and are thus being expressed at the same level. These hypothetical genes would belong to the “operon only” category from <xref ref-type="fig" rid="pcbi-1003339-g004">Fig. 4</xref> and <xref ref-type="fig" rid="pcbi-1003339-g005">Fig. 5</xref>. (B) These two genes also share the same operon but additionally their sequences overlap, putting them in the “operon and overlap” category. In this case, the genes are in different reading frames and do not share a STOP codon, although such configuration is also possible. As the black gene boxes indicate, the left STOP codon corresponds to the left START codon, while the right STOP codon corresponds to the right START codon. (C, D) Two examples of genes from the “overlap only” category which are encoded on different strands. This is not an exhaustive list of possible genetic constraints, as a gene may, for example, share an operon with a gene on the same strand while simultaneously overlapping with a gene on an opposite strand.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003339.g007" position="float" xlink:type="simple"/></fig>
<p>The environment is represented by a two-dimensional curve indicating what is, for every possible biological process, the optimal level of performance in the given environment. The fitness of an individual is a decreasing function of the distance between the individual's phenotype and the optimal phenotype. Individuals are locally selected according to their rank in the neighborhood, with a probability of reproduction exponentially decreasing with the rank. The chosen individual will undergo reproduction with mutations (insertion, deletion or substitution of a small number of basis and duplication, inversion, translocation or deletion of a larger portion of the genome). The rates of different mutation types are parameters of the model and have been set to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e126" xlink:type="simple"/></inline-formula> per basis for small mutations, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e127" xlink:type="simple"/></inline-formula> for large mutations. Ancestral genome is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e128" xlink:type="simple"/></inline-formula> bases long and contains a single gene, while the typical genome length after several thousands of generations of evolution is around <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e129" xlink:type="simple"/></inline-formula> basis. Aevol is a stochastic simulation, the variability coming from the randomness of mutations and the probabilistic selection. One of the parameter is the random seed used to initialize the random number generator. We can replicate an experiment by running it several times with the same exact parameters, but different random seeds.</p>
<p>In our experiments, we distinguish two categories of biological processes: the “metabolic” ones (all traits positioned before <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e130" xlink:type="simple"/></inline-formula> on the axis of the biological processes), that allow an individual performing them to live and reproduce, and the “secretion” ones (position after <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e131" xlink:type="simple"/></inline-formula> on the axis), that determine the level of the production of the public good. We note that under our setup, while genes are generally pleiotropic, simultaneously influencing multiple traits, it is not possible for a gene to affect both metabolic and secretion traits. The public good is costly to secrete, but diffuses in the environment and is beneficial to every individual that comes in contact with it. The cost for the production of one unit of public good varies in our experiments, but is always equal to the cost coefficient (parameter we set) multiplied by the amount of the public good produced. The fitness of an individual is given by this equation:<disp-formula id="pcbi.1003339.e132"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003339.e132" xlink:type="simple"/></disp-formula>Where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e133" xlink:type="simple"/></inline-formula> is metabolic fitness (calculated as explained before but only considering the left part of the axis), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e134" xlink:type="simple"/></inline-formula> is the amount of public good present in the environment at the location the individual inhabits, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e135" xlink:type="simple"/></inline-formula> is the per-unit cost of the public good production, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e136" xlink:type="simple"/></inline-formula> is the amount of pubic good produced by the individual (computed similarly to metabolic fitness but considering the right part of the axis). <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e137" xlink:type="simple"/></inline-formula> is a constant chosen based on previous experiments <xref ref-type="bibr" rid="pcbi.1003339-Frnoy1">[25]</xref>.</p>
<p>The diffusion parameter is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e138" xlink:type="simple"/></inline-formula> per generation, meaning that five percent of the public good present at one position will diffuse in each of the eight neighboring positions during one generation. The degradation rate is set to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e139" xlink:type="simple"/></inline-formula> per generation, meaning that ten percent of the public good at each location will degrade during one generation. This degradation can be thought of as replacing any explicit consumption of the public good, but also as specifying the public good durability. Overall, in all our experiments, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e140" xlink:type="simple"/></inline-formula>% of the public good present at generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e141" xlink:type="simple"/></inline-formula> at some position will remain at this position at generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e142" xlink:type="simple"/></inline-formula>. In the Supporting <xref ref-type="supplementary-material" rid="pcbi.1003339.s004">Text S1</xref>, we experimentally show that the secretion mechanism implemented in Aevol, as described above, leads to the usual cooperation dilemma.</p>
</sec><sec id="s4b">
<title>Evolving a bank of cooperators</title>
<p>To evolve a large number of strong cooperators, we assigned biological processes that were usually in the secretion part of the phenotype to the metabolic part of the phenotype, allowing a strong direct selection on them. After <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e143" xlink:type="simple"/></inline-formula> generations of evolution under these conditions, the whole phenotype of the individuals closely matches the target phenotype. Thus, when picking the best individual and re-assigning half of the trait axis back to secretion, we get a “near-perfect” cooperator, one that secretes close to the maximal possible amount of the public good. Evolving cooperators in this way makes secretion genes evolve in the same way as the metabolic ones, to a high level, increasing the potential signal in further experiments. We repeated this experiment <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e144" xlink:type="simple"/></inline-formula> times, extracted the fittest individual from each population, and obtained a bank of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e145" xlink:type="simple"/></inline-formula> independently evolved cooperators.</p>
</sec><sec id="s4c">
<title>Analysis of the genomic architecture</title>
<p>For each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e146" xlink:type="simple"/></inline-formula> cooperators we evolved in the first set of experiments, we analyzed the architecture of all its secretion genes and classified them in four different categories: (1) genes that share an operon with at least one metabolic gene without overlapping with a metabolic gene, (2) genes that overlap with at least one metabolic gene without sharing an operon with a metabolic gene (this is possible because our digital DNA is double stranded and thus allows for two reading senses, in addition to three reading frames for each sense), (3) genes that overlap with at least one metabolic gene and share an operon with at least one metabolic gene (not necessarily the same one), and (4) genes that share neither operon nor overlap with a metabolic gene. There are multiple ways one could classify the different genes, for example, by distinguishing the number of metabolic genes a secretion gene overlaps or shares an operon with. The four categories we chose have the benefit of intuitive simplicity in addition to including all secretion genes in exactly one category, and we have used them in <xref ref-type="fig" rid="pcbi-1003339-g004">Fig. 4</xref> and <xref ref-type="fig" rid="pcbi-1003339-g005">Fig. 5</xref>. The number of genes in each category is always shown as a percentage of all the secretion genes and standardized by the genes' phenotypic area. Here, the phenotypic area refers to the area of the protein (triangle) the gene encodes for, and allows us to give more weight to the genes that have a strong impact on secretion as well as enable comparison between replicate experiments that may have different secretion levels.</p>
<p>However, when performing the statistical analyses to determine the correlation between the presence of overlap and the resistance to cheater invasion, it does not makes sense to, for example, exclude the secretion genes that also share an operon (in addition to overlapping) with a metabolic gene. So we use slightly different, larger, categories for secretion genes: share an operon with at least one metabolic gene (which is exactly the addition of categories 1 and 3 of our previously explained partitioning), overlap with at least one metabolic gene (addition of categories 2 and 3), do at least one of them (addition of categories 1, 2 and 3), do both of them (same than category 3), do none of them (same than category 4). The difference is that these categories are no longer exclusive: one gene can be in more than one of the new categories at the same time. The genes are standardized by their phenotypic area, as before. These regrouped categories are used in the statistical analyses throughout the paper, and can easily be visually inferred from the categories of the bar graphs in <xref ref-type="fig" rid="pcbi-1003339-g004">Fig. 4</xref> and <xref ref-type="fig" rid="pcbi-1003339-g005">Fig. 5</xref>.</p>
</sec><sec id="s4d">
<title><italic>De novo</italic> evolution of cooperation</title>
<p>In these experiments, each population starts from a randomly constructed organism with a 5,000 base pair genome. As random sequences of 0's and 1's are generated, they are screened for the presence of open reading frames with genes. Thousands of sequences are tested and the first one that has exactly one metabolic gene with a positive effect on fitness is selected. This genome is then cloned to fill the population grid and form the starting population. Reason for starting with a single, valid gene rather than an organism with effectively empty genome is that in both cases all the genes except the first one have a very high probability of evolving from duplication followed by divergence of one already existing gene. Indeed, promoters and ribosome binding sites are hard to evolve from scratch. Starting from purely random sequence would only greatly slow down the evolution process (genomes could evolve for thousands of generation before the first gene appears <xref ref-type="bibr" rid="pcbi.1003339-Knibbe2">[22]</xref>) without qualitatively changing the understanding of the evolutionary process in our system. After <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e147" xlink:type="simple"/></inline-formula> generations of <italic>de novo</italic> evolution, we pooled the proteins from all the individuals in each replicate to obtain a measure of average genetic architecture within a population. As before, rather than using just a protein count, we standardized the contribution of each protein by its phenotypic area.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003339.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003339.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Individuals are tempted to stop cooperating.</bold> For each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e148" xlink:type="simple"/></inline-formula> populations, we plot the average fitness increase an individual would experience if it would individually stop cooperating, <italic>i.e.</italic> the temptation to defect, against the average amount secreted by an individual in the population. Except in the populations where no cooperation has evolved (red points), the temptation is always greater than zero.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003339.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003339.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>Groups of cooperators do better than groups of defectors.</bold> For each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e149" xlink:type="simple"/></inline-formula> populations, we plot the benefit of cooperation, <italic>i.e.</italic> the average fitness drop individuals would experience if cooperation was disabled, against the average amount secreted by an individual in the population. Except in the populations where no cooperation has evolved (red points), the benefit is always greater than zero.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003339.s003" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003339.s003" position="float" xlink:type="simple"><label>Figusre S3</label><caption>
<p><bold>Individuals that cooperate more are the ones that benefit more from secretion.</bold> For each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e150" xlink:type="simple"/></inline-formula> populations, we plot the correlation between how much individuals secrete, and how much they benefit from secretion (<italic>i.e.</italic> the average fitness drop individuals would experience if cooperation was disabled), against the average amount secreted by an individual in the population. Except in the populations where no cooperation has evolved (red points), the correlation is significant and positive for all but <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003339.e151" xlink:type="simple"/></inline-formula> populations.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003339.s004" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003339.s004" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Secretion of a public good in Aevol satisfies the two usual requirements for a social dilemma.</bold> The fitness of an individual would always increase if it would stop cooperating (Supporting <xref ref-type="supplementary-material" rid="pcbi.1003339.s001">Figure S1</xref>), and in a group of cooperators the individuals have a higher fitness than in a group of cheater (Supporting <xref ref-type="supplementary-material" rid="pcbi.1003339.s002">Figure S2</xref>).</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank Tatiana Dimitriu, Julien Benard-Capelle and Ariel B. Lindner for useful discussions and comments on this study and David Parsons, Carole Knibbe and Guillaume Beslon for their help with the Aevol platform. We are grateful to the Center for the Study of Evolution in Action (BEACON, Michigan State University) and the CC-IN2P3 (Computation Center of the French National Institute for Nuclear and Particle Physics) for providing the computational resources needed by this study.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003339-Hamilton1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hamilton</surname><given-names>WD</given-names></name> (<year>1964</year>) <article-title>The genetical evolution of social behavior I+II</article-title>. <source>Journal of Theoretical Biology</source> <volume>7</volume>: <fpage>1</fpage>–<lpage>52</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Axelrod1"><label>2</label>
<mixed-citation publication-type="other" xlink:type="simple">Axelrod R (1984) The Evolution of Cooperation. Basic Books, New York, NY.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Buckling1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buckling</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Harrison</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Vos</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Brockhurst</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gardner</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Siderophore-mediated cooperation and virulence in <italic>Pseudomonas aeruginosa</italic></article-title>. <source>FEMS Microbiology Ecology</source> <volume>62</volume>: <fpage>135</fpage>–<lpage>141</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Griffin1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Griffin</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>West</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Buckling</surname><given-names>A</given-names></name> (<year>2004</year>) <article-title>Cooperation and competition in pathogenic bacteria</article-title>. <source>Nature</source> <volume>430</volume>: <fpage>1024</fpage>–<lpage>1027</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Damore1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Damore</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Gore</surname><given-names>J</given-names></name> (<year>2012</year>) <article-title>Understanding microbial cooperation</article-title>. <source>Journal of Theoretical Biology</source> <volume>299</volume>: <fpage>31</fpage>–<lpage>41</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-West1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>West</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Diggle</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Buckling</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Gardner</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Griffin</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>The social lives of microbes</article-title>. <source>Annual Review of Ecology, Evolution, and Systematics</source> <volume>38</volume>: <fpage>53</fpage>–<lpage>77</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Brown1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname><given-names>S</given-names></name>, <name name-style="western"><surname>West</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Diggle</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Griffin</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Social evolution in micro-organisms and a trojan horse approach to medical intervention strategies</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>364</volume>: <fpage>3157</fpage>–<lpage>3168</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Inglis1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Inglis</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Buckling</surname><given-names>A</given-names></name> (<year>2012</year>) <article-title>Spite versus cheats: competition among social strategies shapes virulence in <italic>Pseudomonas aeruginosa</italic></article-title>. <source>Evolution</source> <volume>66</volume>: <fpage>3472</fpage>–<lpage>3484</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Grafen1"><label>9</label>
<mixed-citation publication-type="book" xlink:type="simple">Grafen A (1984) Natural selection, kin selection and group selection. In: Krebs J, Davies N, editors, Behavioural Ecology: An Evolutionary Approach, Oxford, UK: Blackwell Scientific Publications. pp. 62–84.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Lehmann1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lehmann</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Keller</surname><given-names>L</given-names></name>, <name name-style="western"><surname>West</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Roze</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>Group selection and kin selection: Two concepts but one process</article-title>. <source>Proceeding of the National Academy of Sciences USA</source> <volume>104</volume>: <fpage>6736</fpage>–<lpage>6739</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Axelrod2"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Axelrod</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Hamilton</surname><given-names>W</given-names></name> (<year>1981</year>) <article-title>The evolution of cooperation</article-title>. <source>Science</source> <volume>211</volume>: <fpage>1390</fpage>–<lpage>1393</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Kerr1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kerr</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Godfrey-Smith</surname><given-names>P</given-names></name> (<year>2002</year>) <article-title>Individualist and multi-level perspectives on selection in structured populations</article-title>. <source>Biology and Philosophy</source> <volume>17</volume>: <fpage>477</fpage>–<lpage>517</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Doebeli1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Doebeli</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hauert</surname><given-names>C</given-names></name> (<year>2005</year>) <article-title>Models of cooperation based on the prisoner's dilemma and the snowdrift game</article-title>. <source>Ecology Letters</source> <volume>8</volume>: <fpage>748</fpage>–<lpage>766</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Antal1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Antal</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Traulsen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ohtsuki</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Tarnita</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Nowak</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Mutation–selection equilibrium in games with multiple strategies</article-title>. <source>Journal of Theoretical Biology</source> <volume>258</volume>: <fpage>614</fpage>–<lpage>362</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Iliopoulos1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Iliopoulos</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Hintze</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Adami</surname><given-names>C</given-names></name> (<year>2010</year>) <article-title>Critical dynamics in the evolution of stochastic strategies for the iterated prisoner's dilemma</article-title>. <source>PLoS Computational Biology</source> <volume>6</volume>: <fpage>e1000948</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Foster1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Foster</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Shaulsky</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Strassmann</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Queller</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Thompson</surname><given-names>C</given-names></name> (<year>2004</year>) <article-title>Pleiotropy as a mechanism to stabilize cooperation</article-title>. <source>Nature</source> <volume>431</volume>: <fpage>693</fpage>–<lpage>696</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Dandekar1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dandekar</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Chugani</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Greenberg</surname><given-names>E</given-names></name> (<year>2012</year>) <article-title>Bacterial quorum sensing and metabolic incentives to cooperate</article-title>. <source>Science</source> <volume>338</volume>: <fpage>264</fpage>–<lpage>266</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Jacob1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jacob</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Monod</surname><given-names>J</given-names></name> (<year>1961</year>) <article-title>Genetic regulatory mechanisms in the synthesis of proteins</article-title>. <source>Journal of Molecular Biology</source> <volume>3</volume>: <fpage>318</fpage>–<lpage>356</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Lawrence1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lawrence</surname><given-names>J</given-names></name> (<year>1999</year>) <article-title>Selfish operons: the evolutionary impact of gene clustering in prokaryotes and eukaryotes</article-title>. <source>Current Opinion in Genetics and Development</source> <volume>9</volume>: <fpage>642</fpage>–<lpage>648</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Normark1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Normark</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Bergstrom</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Edlund</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Grundstrom</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Jaurin</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>1983</year>) <article-title>Overlapping genes</article-title>. <source>Annual Review of Genetics</source> <volume>17</volume>: <fpage>499</fpage>–<lpage>525</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Knibbe1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Knibbe</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Mazet</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Chaudrier</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Fayard</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Beslon</surname><given-names>G</given-names></name> (<year>2007</year>) <article-title>Evolutionary coupling between the deleteriousness of gene mutations and the amount of non-coding sequences</article-title>. <source>Journal of Theoretical Biology</source> <volume>244</volume>: <fpage>621</fpage>–<lpage>630</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Knibbe2"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Knibbe</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Coulon</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Mazet</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Fayard</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Beslon</surname><given-names>G</given-names></name> (<year>2007</year>) <article-title>A long-term evolutionary pressure on the amount of noncoding DNA</article-title>. <source>Molecular Biology and Evolution</source> <volume>24</volume>: <fpage>2344</fpage>–<lpage>2353</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Nowak1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nowak</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bonhoeffer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>May</surname><given-names>R</given-names></name> (<year>1994</year>) <article-title>Spatial games and the maintenance of cooperation</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>91</volume>: <fpage>4877</fpage>–<lpage>4881</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Oliphant1"><label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Oliphant M (1994) Evolving cooperation in the non-iterated prisoner's dilemma: The importance of spatial organization. In: Brooks R, P M, editors, Proceedings of the Fourth Artificial Life Workshop. pp. 349–352. URL <ext-link ext-link-type="uri" xlink:href="http://mitpress.mit.edu/books/artificial-life-iv" xlink:type="simple">http://mitpress.mit.edu/books/artificial-life-iv</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Frnoy1"><label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Frénoy A, Taddei F, Misevic D (2012) Robustness and evolvability of cooperation. In: Adami C, Bryson D, Ofria C, RT P, editors, Artificial Life XIII: Proceedings of the Thirteenth International Conference on the Simulation and Synthesis of Living Systems. pp. 53–58. doi:10.7551/978-0-262-31050-5-ch008.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Nogueira1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nogueira</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Rankin</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Touchon</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Taddei</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>SP</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Horizontal gene transfer of the secretome drives the evolution of bacterial cooperation and virulence</article-title>. <source>Current Biology</source> <volume>19</volume>: <fpage>1683</fpage>–<lpage>1691</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Michod1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Michod</surname><given-names>R</given-names></name> (<year>1996</year>) <article-title>Cooperation and conflict in the evolution of individuality. II. Conflict mediation</article-title>. <source>Proceedings of the Royal Society of London Series B: Biological Sciences</source> <volume>263</volume>: <fpage>813</fpage>–<lpage>822</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Allen1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Allen</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Traulsen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Tarnita</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Nowak</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>How mutation affects evolutionary games on graphs</article-title>. <source>Journal of Theoretical Biology</source> <volume>299</volume>: <fpage>97</fpage>–<lpage>105</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Altenberg1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altenberg</surname><given-names>L</given-names></name> (<year>2005</year>) <article-title>Evolvability suppression to stabilize far-sighted adaptations</article-title>. <source>Artificial Life</source> <volume>11</volume>: <fpage>427</fpage>–<lpage>443</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Rice1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rice</surname><given-names>W</given-names></name> (<year>2002</year>) <article-title>Experimental tests of the adaptive significance of sexual recombination</article-title>. <source>Nature Reviews Genetics</source> <volume>3</volume>: <fpage>241</fpage>–<lpage>251</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Sleight1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sleight</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Bartley</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Lieviant</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Sauro</surname><given-names>H</given-names></name> (<year>2010</year>) <article-title>Designing and engineering evolutionary robust genetic circuits</article-title>. <source>Journal of Biological Engineering</source> <volume>4</volume>: <fpage>12</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Tenaillon1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tenaillon</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Taddei</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Radman</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Matic</surname><given-names>I</given-names></name> (<year>2001</year>) <article-title>Second-order selection in bacterial evolution: selection acting on mutation and recombination rates in the course of adaptation</article-title>. <source>Research in Microbiology</source> <volume>152</volume>: <fpage>11</fpage>–<lpage>16</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Parsons1"><label>33</label>
<mixed-citation publication-type="other" xlink:type="simple">Parsons DP, Knibbe C, Beslon G (2010) Importance of the rearrangement rates on the organization of transcription. In: Fellermann H, Dörr M, Hanczyc M, Laursen L, Maurer S, <etal>et al</etal>., editors, Artificial Life XII: Proceedings of the Twelfth International Conference on the Synthesis and Simulation of Living Systems. pp. 479–486. URL <ext-link ext-link-type="uri" xlink:href="http://mitpress.mit.edu/sites/default/files/titles/alife/0262290758chap92.pdf" xlink:type="simple">http://mitpress.mit.edu/sites/default/files/titles/alife/0262290758chap92.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Misevic1"><label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Misevic D, Frénoy A, Parsons D, Taddei F (2012) Effects of public good properties on the evolution of cooperation. In: Adami C, Bryson D, Ofria C, RT P, editors, Artificial Life XIII: Proceedings of the Thirteenth International Conference on the Simulation and Synthesis of Living Systems. pp. 218–225. doi:10.7551/978-0-262-31050-5-ch030.</mixed-citation>
</ref>
<ref id="pcbi.1003339-Knibbe3"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Knibbe</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Fayard</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Beslon</surname><given-names>G</given-names></name> (<year>2008</year>) <article-title>The topology of the protein network influences the dynamics of gene order: From systems biology to a systemic understanding of evolution</article-title>. <source>Artificial Life</source> <volume>14</volume>: <fpage>149</fpage>–<lpage>156</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>