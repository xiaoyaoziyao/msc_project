<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-13-51859</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0099015</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>DNA</subject><subject>Nucleic acids</subject></subj-group></subj-group><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysics theory</subject></subj-group></subj-group><subj-group><subject>Cell biology</subject><subj-group><subject>Signal transduction</subject><subj-group><subject>Cell signaling</subject><subj-group><subject>Transcriptional signaling</subject></subj-group></subj-group></subj-group><subj-group><subject>Molecular cell biology</subject></subj-group></subj-group><subj-group><subject>Computational biology</subject></subj-group><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject><subj-group><subject>DNA transcription</subject></subj-group></subj-group></subj-group><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group><subject>Theoretical biology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Statistical mechanics</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>A General Pairwise Interaction Model Provides an Accurate Description of <italic>In Vivo</italic> Transcription Factor Binding Sites</article-title>
<alt-title alt-title-type="running-head">A General Pairwise Interaction Model</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Santolini</surname><given-names>Marc</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mora</surname><given-names>Thierry</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hakim</surname><given-names>Vincent</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><addr-line>Laboratoire de Physique Statistique, CNRS, Université P. et M. Curie, Université D. Diderot, École Normale Supérieure, Paris, France</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Ranganathan</surname><given-names>Shoba</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Macquarie University, Australia</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">hakim@lps.ens.fr</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: MS TM VH. Performed the experiments: MS TM VH. Analyzed the data: MS TM VH. Contributed reagents/materials/analysis tools: MS TM VH. Wrote the paper: MS TM VH.</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>13</day><month>6</month><year>2014</year></pub-date>
<volume>9</volume>
<issue>6</issue>
<elocation-id>e99015</elocation-id>
<history>
<date date-type="received"><day>10</day><month>12</month><year>2013</year></date>
<date date-type="accepted"><day>9</day><month>5</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Santolini et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>The identification of transcription factor binding sites (TFBSs) on genomic DNA is of crucial importance for understanding and predicting regulatory elements in gene networks. TFBS motifs are commonly described by Position Weight Matrices (PWMs), in which each DNA base pair contributes independently to the transcription factor (TF) binding. However, this description ignores correlations between nucleotides at different positions, and is generally inaccurate: analysing fly and mouse <italic>in vivo</italic> ChIPseq data, we show that in most cases the PWM model fails to reproduce the observed statistics of TFBSs. To overcome this issue, we introduce the pairwise interaction model (PIM), a generalization of the PWM model. The model is based on the principle of maximum entropy and explicitly describes pairwise correlations between nucleotides at different positions, while being otherwise as unconstrained as possible. It is mathematically equivalent to considering a TF-DNA binding energy that depends additively on each nucleotide identity at all positions in the TFBS, like the PWM model, but also additively on pairs of nucleotides. We find that the PIM significantly improves over the PWM model, and even provides an optimal description of TFBS statistics within statistical noise. The PIM generalizes previous approaches to interdependent positions: it accounts for co-variation of two or more base pairs, and predicts secondary motifs, while outperforming multiple-motif models consisting of mixtures of PWMs. We analyse the structure of pairwise interactions between nucleotides, and find that they are sparse and dominantly located between consecutive base pairs in the flanking region of TFBS. Nonetheless, interactions between pairs of non-consecutive nucleotides are found to play a significant role in the obtained accurate description of TFBS statistics. The PIM is computationally tractable, and provides a general framework that should be useful for describing and predicting TFBSs beyond PWMs.</p>
</abstract>
<funding-group><funding-statement>This study was funded by CNRS institutional funds. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="21"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Gene regulatory networks are at the basis of our understanding of cell states and of the dynamics of their response to environmental cues. Central effectors of this regulation are Transcription Factors (TFs), which bind on short DNA regulatory sequences and interact with the transcription apparatus or with histone-modifying proteins to alter target gene expressions <xref ref-type="bibr" rid="pone.0099015-Spitz1">[1]</xref>. The determination of Transcription Factor Binding Sites (TFBSs) on a genome-wide scale is thus of central importance, and is the focus of many current experiments <xref ref-type="bibr" rid="pone.0099015-Stamatoyannopoulos1">[2]</xref>. In eukaryotes the TF binding specificity is only moderate, meaning that a given TF may bind to a variety of different sequences <italic>in vivo</italic> <xref ref-type="bibr" rid="pone.0099015-Wasserman1">[3]</xref>. The collection of such binding sequences is typically described by a Position Weight Matrix (PWM) which simply gives the probability that a particular base pair stands at a given position in the TFBS. The PWM provides a full statistical description of the TFBS collection when there are no correlations between the occurrences of nucleotides at different positions. In addition, the PWM description has a simple biophysical interpretation: it is exact in the special case where base-pairs of the TFBS contribute additively to the TF-DNA binding free energy at thermodynamic equilibrium, provided that the TF concentration is far from saturation <xref ref-type="bibr" rid="pone.0099015-Berg1">[4]</xref>–<xref ref-type="bibr" rid="pone.0099015-Djordjevic1">[6]</xref>.</p>
<p>Despite the widespread use and success of PWMs, there is mounting evidence that its central hypothesis of independence between positions is not always justified. Several works have reported cases of correlations between nucleotides at different positions in TFBSs <xref ref-type="bibr" rid="pone.0099015-Man1">[7]</xref>–<xref ref-type="bibr" rid="pone.0099015-Jolma1">[11]</xref>. A systematic <italic>in vitro</italic> study of 104 TFs using DNA microarrays has revealed a rich picture of binding patterns <xref ref-type="bibr" rid="pone.0099015-Badis1">[10]</xref>, including the existence of multiple motifs, strong nucleotide position interdependence, and variable spacers between determining subregions, none of which can be described by PWMs. Recently, the <italic>in vitro</italic> specificity of several hundred human and mouse DNA-binding domains was investigated using high-throughput SELEX. Correlations between nucleotides were found to be widespread among TFBSs and predominantly located between adjacent flanking bases in the TFBS <xref ref-type="bibr" rid="pone.0099015-Jolma1">[11]</xref>. However, TFBSs <italic>in vivo</italic> are certainly determined in multiple ways besides <italic>in vitro</italic> measured TF binding affinities and the extent of correlations between their nucleotide positions remains to be fully assessed.</p>
<p>On the computational side, a number of probabilistic models have been proposed to describe nucleotide correlations in TFBSs, generally based on specific simplifying assumptions, such as mutually exclusive groups of co-varying nucleotide positions <xref ref-type="bibr" rid="pone.0099015-Benos1">[8]</xref>, <xref ref-type="bibr" rid="pone.0099015-Zhou1">[12]</xref>–<xref ref-type="bibr" rid="pone.0099015-Siddhartan1">[14]</xref> or the computationally-friendly probabilistic structures of Bayesian networks or Markov chains <xref ref-type="bibr" rid="pone.0099015-Jolma1">[11]</xref>, <xref ref-type="bibr" rid="pone.0099015-Barash1">[15]</xref>–<xref ref-type="bibr" rid="pone.0099015-Mathelier1">[17]</xref>. A systematic and general framework is yet to be applied to account for and to analyze the rich landscape of observed TF binding behaviours. The recent breakthrough in the experimental acquisition of precise, genome-wide TF-bound DNA regions with the ChIPseq technology offers the opportunity to address these two important issues.</p>
<p>Here, using a variety of ChIPseq experiments coming both from fly and mouse, we first show that the PWM model generally does not reproduce the observed <italic>in vivo</italic> TFBS statistics for a majority of TFs. This calls for a refinement of the PWM description that includes interdependence between nucleotide positions.</p>
<p>To this purpose, we propose the general Pairwise Interaction model (PIM), which generalizes the PWM model by accurately reproducing pairwise correlations between nucleotides in addition to position-dependent nucleotide usage. The model derives from the principle of maximum entropy, which has been recently applied with success to a variety of biological problems where correlations play an important role, from the correlated activity of neurons <xref ref-type="bibr" rid="pone.0099015-Schneidman1">[18]</xref>–<xref ref-type="bibr" rid="pone.0099015-Roxin1">[21]</xref> to the statistics of protein families <xref ref-type="bibr" rid="pone.0099015-Weigt1">[22]</xref>–<xref ref-type="bibr" rid="pone.0099015-Rivoire1">[26]</xref> to the alignment of large animal flocks <xref ref-type="bibr" rid="pone.0099015-Bialek1">[27]</xref>–<xref ref-type="bibr" rid="pone.0099015-Cavagna1">[29]</xref>. In a thermodynamical model of TF-DNA interaction, the PIM amounts to including general effective pairwise interactions between nucleotides <xref ref-type="bibr" rid="pone.0099015-Zhao1">[30]</xref>. The PIM offers a systematic and general computational framework allowing one to determine and analyze the landscape of TF binding <italic>in vivo</italic>.</p>
<p>We find that the <italic>in vivo</italic> TFBS statistics and predictability are significantly improved in this refined model. We consider, for comparison, a model that describes the statistics of TFBSs as a statistical mixture of PWMs <xref ref-type="bibr" rid="pone.0099015-Barash1">[15]</xref>, <xref ref-type="bibr" rid="pone.0099015-Heinz1">[31]</xref>. This alternative model can directly capture some higher-order correlations between nucleotides, but is found to be outperformed by the PIM for all considered TFs. Further, the PIM can recapitulate the multiplicity of motifs predicted by the PWM mixture model: by studying the landscape of the PIM and its structure of local energy minima, or probability peaks, we show that each basin of attraction or valley around a local energy minimum is generally dominantly described by one PWM in the mixture model.</p>
<p>The difference between the PIM and the PWM model lies in the pairwise interaction between nucleotides. Surprisingly, despite significant differences in prediction accuracy between the two models, these interactions are fairly weak, sparse and found dominantly between consecutive nucleotides, in general qualitative agreement with <italic>in vitro</italic> binding results <xref ref-type="bibr" rid="pone.0099015-Jolma1">[11]</xref>. Comparison with a model restricted to interactions between consecutive nucleotides show that interactions between pairs of nucleotides that are farther apart nonetheless play a significant role in the prediction improvement.</p>
<p>The PIM only requires a modest computational effort, and the refined description of TFBS that it affords should generally prove useful when enough data is available.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>The PWM model does not reproduce the TFBS statistics</title>
<p>We first tested how well the usual PWM model reproduced the observed TFBS statistics. Specifically, we asked how well the frequencies of different TFBSs were predicted using only single nucleotide frequencies. For this purpose, we used a collection of ChIPseq data available from the literature <xref ref-type="bibr" rid="pone.0099015-Zinzen1">[32]</xref>–<xref ref-type="bibr" rid="pone.0099015-Dunham1">[34]</xref>, both from <italic>D. Melanogaster</italic> and from mouse embryonic stem cells (ESC) and a myogenic cell line (C2C12). For a given TF, the ChIPseq data consist of an ensemble of DNA sequences, the ChIPseq fragments, each a few hundred nucleotides long. The exact positions of the TFBSs are unknown on each of these sequences. They are determined as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e001" xlink:type="simple"/></inline-formula>-mers (we take here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e002" xlink:type="simple"/></inline-formula>) that have a score for the PWM above a given threshold score (here we chose to adjust the threshold score so that 50% of the ChIPseq fragments have at least one L-mer above the threshold score -typically, there are one or two L-mers above the threshold score on these ChIP fragments). This set of high-scoring L-mers provides a collection of putative BS s for the TF considered. From these, a PWM can be buil t in the usual way by counting the frequencies of the 4 possible nucleotide s at each position 1,…,L. However, this PWM does not coincide in general with the one that served to determine the set of putative TFBS s. To determine self-consistently the collection of binding sites for a given TF from a collection of ChIPseq fragments, we thus iteratively refined the PWM together with the set of putative TFBSs in the ChIPseq data (see <xref ref-type="fig" rid="pone-0099015-g001">Figure 1</xref> and <italic>Methods</italic> for a detailed description). This process ensured that the frequency of different nucleotides at a given position in the considered set of binding sites (the high-scoring L-mers) was exactly accounted for by the PWM.</p>
<fig id="pone-0099015-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.g001</object-id><label>Figure 1</label><caption>
<title>Workflow.</title>
<p>An initial Position Weight Matrix (PWM) is used to find a set of binding sites on ChIPseq data. Models are then learned using single-point frequencies (PWM), two-point correlations (PIM) or a mixture of PWM models learned on sites clustered by K-Means with increasing complexity, <italic>i.e.</italic> increasing number of features in the model. Finally the models with best Bayesian Information Criteria (BIC) are used to predict new binding sites until convergence to a stable set of TFBSs.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.g001" position="float" xlink:type="simple"/></fig>
<p>We then enquired whether the frequencies of the different binding sites in the set agreed with that predicted by the PWM, as would be the case if the probabilities of observing nucleotides at different positions were independent. <xref ref-type="fig" rid="pone-0099015-g002">Figure 2</xref> shows the results for three different TFs, one from each of the three considered categories: Twist (Drosophila), Esrrb (mammals, ESC), and MyoD (mammals, C2C12). The independent PWM model strongly underestimates the probabilities of the most frequent sequences. Moreover, the PWM model does not correctly predict the frequency order of the sequences and attributes comparable probabilities to these different sequences, in disagreement with their observed frequencies.</p>
<fig id="pone-0099015-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.g002</object-id><label>Figure 2</label><caption>
<title>Observed TFBS frequencies are poorly predicted by a PWM model.</title>
<p>Given a set of TFBSs predicted by the PWM model on ChIP fragments, we computed the TFBS frequencies (how many times a given sequence appears in the set, gray bars), and compared them to the PWM predicted frequencies (blue bars) computed using single nucleotide frequencies alone. We show the results for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e003" xlink:type="simple"/></inline-formula> most frequent sequences for the TFs Twist (A), Esrrb (B) and MyoD (C). We can see that the use of single nucleotide frequencies alone does not allow one to reproduce the statistics of the most observed binding sites. (D) Kullback-Leibler Divergence (DKL) between the observed probability distribution and the PWM model distribution (blue). As a control we show the mean (cyan bars) along with two standard deviations of the DKL between the PWM model and a finite sample drawn from it (see Methods). A significant discrepancy between the observed and predicted sequence probabilities is reported for 22 out of 28 factors.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.g002" position="float" xlink:type="simple"/></fig>
<p>To get a full measure of the discrepancy between the observed distribution of TFBSs and the PWM prediction, we calculated the relative entropy, or Kullback-Leibler divergence (DKL), between the two distributions <xref ref-type="bibr" rid="pone.0099015-Cover1">[35]</xref> (see <italic>Methods</italic>). The DKL is zero i f the two distributions are identical and is positive otherwise. We found that for most TFs (22 out of 28), the DKL divergence was significantly larger than expected just from finite-sampling error noise (see <xref ref-type="fig" rid="pone-0099015-g002">Figure 2D</xref>). In the following, we focus on the 22 factors, for which the PWM description of the TFBSs needs to be refined. Note that the 6 factors that are satisfactorily described by the PWM model are predominantly those for which the smallest number of ChIP sequences was available (see <xref ref-type="table" rid="pone-0099015-t001">Table 1</xref> and Figure S1 in <xref ref-type="supplementary-material" rid="pone.0099015.s001">File S1</xref>, blue names).</p>
<table-wrap id="pone-0099015-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.t001</object-id><label>Table 1</label><caption>
<title>Information about the TFs.</title>
</caption><alternatives><graphic id="pone-0099015-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Name</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e004" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e005" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e006" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e007" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e008" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e009" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e010" xlink:type="simple"/></inline-formula></td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Bap</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e011" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e012" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e013" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e014" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e015" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e016" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e017" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Bin</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e018" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e019" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e020" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e021" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e022" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e023" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e024" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mef2</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e025" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e026" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e027" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e028" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e029" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e030" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e031" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Tin</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e032" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e033" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e034" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e035" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e036" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e037" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e038" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Twi</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e039" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e040" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e041" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e042" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e043" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e044" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e045" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">c-Myc</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e046" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e047" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e048" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e049" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e050" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e051" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e052" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">E2f1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e053" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e054" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e055" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e056" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e057" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e058" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e059" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Esrrb</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e060" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e061" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e062" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e063" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e064" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e065" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e066" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Klf4</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e067" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e068" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e069" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e070" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e071" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e072" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e073" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Nanog</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e074" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e075" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e076" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e077" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e078" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e079" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e080" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">N-Myc</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e081" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e082" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e083" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e084" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e085" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e086" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e087" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Oct4</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e088" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e089" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e090" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e091" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e092" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e093" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e094" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Smad1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e095" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e096" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e097" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e098" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e099" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e100" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e101" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Sox2</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e102" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e103" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e104" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e105" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e106" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e107" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e108" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">STAT3</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e109" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e110" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e111" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e112" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e113" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e114" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e115" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Tcfcp2l1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e116" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e117" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e118" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e119" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e120" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e121" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e122" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Zfx</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e123" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e124" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e125" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e126" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e127" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e128" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e129" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">C/EBP-beta</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e130" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e131" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e132" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e133" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e134" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e135" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e136" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">CTCF</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e137" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e138" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e139" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e140" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e141" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e142" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e143" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">E2f4</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e144" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e145" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e146" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e147" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e148" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e149" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e150" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Fosl1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e151" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e152" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e153" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e154" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e155" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e156" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e157" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Max</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e158" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e159" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e160" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e161" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e162" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e163" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e164" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MyoD</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e165" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e166" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e167" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e168" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e169" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e170" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e171" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Myog</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e172" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e173" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e174" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e175" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e176" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e177" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e178" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">NRSF</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e179" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e180" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e181" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e182" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e183" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e184" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e185" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">SRF</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e186" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e187" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e188" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e189" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e190" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e191" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e192" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">TCF3</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e193" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e194" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e195" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e196" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e197" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e198" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e199" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">USF1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e200" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e201" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e202" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e203" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e204" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e205" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e206" xlink:type="simple"/></inline-formula></td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>For each TF, we show the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e207" xlink:type="simple"/></inline-formula> of ChIP sequences retrieved, the numbers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e208" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e209" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e210" xlink:type="simple"/></inline-formula> of different ChIP sequences used for training between either two models, and the numbers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e211" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e212" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e213" xlink:type="simple"/></inline-formula> of TFBSs used to learn each model.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2b">
<title>Pairwise interactions in the binding energy improve the TFBS description</title>
<p>The discrepancy between the observed statistics of TFBSs and that predicted by the PWM model calls for a re-evaluation of the model's main hypothesis, namely the independence of bound nucleotides. To account for the correlative structure of TFBS statistics, we wish to construct a model that assigns a frequency to each of the possible <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e214" xlink:type="simple"/></inline-formula> L-mers such that, given a data of observed L-nucleotide long binding sequences, the model reproduces:</p>
<list list-type="roman-lower"><list-item>
<p>the frequency counts of the 4 nucleotides at each position in the sequence data, (e.g. 40% of nucleotides at the third position are C and 60% at the fifth position are T), as the PWM does,</p>
</list-item><list-item>
<p>the frequency counts of each pair of nucleotides in the sequence data (e.g. 40% of pairs of nucleotides at the third and fifth position are (C,T); that is a C at the third position is always associated to a T at the fifth position and not only in 60% of the cases as would be expected for independently bound nucleotides).</p>
</list-item></list>
<p>There are many models that can achieve these two requirements. In order to precisely specify a single one, we ask that the model probability distribution exactly reproduces the frequency counts of single nucleotides and pairs of nucleotides in the sequence data but is otherwise as unconstrained as possible. This is the principle of maximum entropy. This provides a natural generalization of the PWM model since the PWM model is the maximum entropy model that reproduces the frequencies of single nucleotides (condition i) above). Specifically, call <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e215" xlink:type="simple"/></inline-formula> the model probability of a given TFBS sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e216" xlink:type="simple"/></inline-formula>. One can show (see <italic>Methods</italic>) that the model distribution has the following form, referred to as the Pairwise Interaction model (PIM) hereafter:<disp-formula id="pone.0099015.e217"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e217" xlink:type="simple"/><label>(1)</label></disp-formula></p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e218" xlink:type="simple"/></inline-formula> is a normalization constant that ensures that the sum of probabilities of the different sequences is one. As an example, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e219" xlink:type="simple"/></inline-formula> means that the model predicts that 9% of the sequences in the sequence data are the nucleotide sequence <named-content content-type="gene" xlink:type="simple">TACATATGTATA</named-content>. As written under the form (1), the quantity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e220" xlink:type="simple"/></inline-formula> can be interpreted as the binding “energy” (in suitable units) of the considered TF for the nucleotide sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e221" xlink:type="simple"/></inline-formula>. Note that with the sign convention used, the more frequent the sequence, the lower or more negative its binding energy is and the stronger its binding to the TF.</p>
<p>The PIM binding energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e222" xlink:type="simple"/></inline-formula> is made of two kinds of terms:<disp-formula id="pone.0099015.e223"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e223" xlink:type="simple"/><label>(2)</label></disp-formula></p>
<p>The first sum comprises the binding energies of the individual nucleotides, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e224" xlink:type="simple"/></inline-formula> the contribution to the binding energy of nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e225" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e226" xlink:type="simple"/></inline-formula>. The second sum comprises the ‘pairwise interactions’, a modification of the binding energy that take s into account pairs of nucleotides in the sequence. Namely, for a sequence with a C a t the third position and a T at the fifth, the contribution of these two bases to the binding energy is not only the sum <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e227" xlink:type="simple"/></inline-formula> of the independent contributions but it also includes a pairwise term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e228" xlink:type="simple"/></inline-formula>.</p>
<p>This is an example of an inverse problem, where energies are devised from observed frequencies. As mentioned in the introduction, such problems have recently been studied in a variety of biological contexts <xref ref-type="bibr" rid="pone.0099015-Schneidman1">[18]</xref>–<xref ref-type="bibr" rid="pone.0099015-Weigt1">[22]</xref>, <xref ref-type="bibr" rid="pone.0099015-Mora1">[24]</xref>, <xref ref-type="bibr" rid="pone.0099015-Bialek1">[27]</xref>–<xref ref-type="bibr" rid="pone.0099015-Cavagna1">[29]</xref>. In principle, the number of energy parameters in the PIM (the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e229" xlink:type="simple"/></inline-formula>s and the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e230" xlink:type="simple"/></inline-formula> s) is sufficient to reproduce the observed values of all single nucleotide frequency counts (requirement i) above) and the frequencies of all pair s of nucleotides (requirement ii) above), that is all pairwise correlations between nucleotides at different positions (see <italic>Methods</italic>). However, trying to fit each of these frequencies would carry the risk of over-fitting the data with an unrealistically large number of parameters. To avoid this, we instead maximized the likelihood of the data under the model, but with a penalty proportional to the numbers of parameters involved, as provided by the Bayesian Information Criterion (BIC) <xref ref-type="bibr" rid="pone.0099015-Bishop1">[36]</xref> (see <italic>Methods</italic>). In addition, just as in the procedure described previously for the PWM model, the PIM and the collection of TFBSs for a given factor were iteratively refined together, as schematized in <xref ref-type="fig" rid="pone-0099015-g001">Figure 1</xref>. This is an important step to ensure that the sequence s selected by the model are identical to the sequences that serve to determine the parameters of the model.</p>
<p><xref ref-type="fig" rid="pone-0099015-g003">Figure 3</xref> shows that the PIM greatly improves the description of TFBS statistics for the three factors chosen for illustrative purposes. Where the PWM model failed at reproducing the strong amplitude and non-linear decrease in the frequencies of the most over-represented TFBSs, the PIM provides a substantial improvement in reproducing the observed statistics. The improvement is most apparent when comparing the frequencies of the ten most observed TFBSs between the model and the ChIPseq data (<xref ref-type="fig" rid="pone-0099015-g003">Figure 3</xref> A, C, E), and is further illustrated by the statistics of the full collection of TFBSs (<xref ref-type="fig" rid="pone-0099015-g003">Figure 3</xref> B, D, F).</p>
<fig id="pone-0099015-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.g003</object-id><label>Figure 3</label><caption>
<title>Models with correlations improve TFBS statistics prediction.</title>
<p>Similarly to <xref ref-type="fig" rid="pone-0099015-g002">Figure 2</xref>, we show the observed frequencies (gray bars) of the most represented TFBSs for Twist (A), Esrrb (B) and MyoD (C) TFs, together with the probabilities of these sequences predicted by the PWM model (blue bars), the PIM taking into account interactions between nucleotides (red bars), and the PWM-mixture model (green bars). (B,D,F) show the comparison between frequencies for all binding sequences and predicted sequence probabilities for the three models (same color code). The predicted probabilities of the PIM and to a lesser extent of the mixture model are in much better agreement with the observed frequencies than those of the PWM model.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.g003" position="float" xlink:type="simple"/></fig></sec><sec id="s2c">
<title>The PIM ranks binding sites differently from the PWM model</title>
<p>Precise predictions of TFBSs are one important output of ChIPseq data. They condition further validation experiments such as gel mobility shift assays or mutageneses. Therefore, we assessed the difference in TFBS predictions between pairwise (PIM) and independent (PWM) models.</p>
<p>First, we compared the set of ChIP sequences retrieved by the two models at the cutoff of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e231" xlink:type="simple"/></inline-formula> TPR (True Positive Rate) used in the learning scheme, as shown in <xref ref-type="fig" rid="pone-0099015-g004">Figure 4A</xref>. The fraction of ChIPseq sequences picked by one model but not by the other ranged from a few percent for Esrrb, up to about 15% for Twist. Thus, even when stemming from the same ChIPseq data, the two models could predict significantly distinct sets of TFBSs.</p>
<fig id="pone-0099015-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.g004</object-id><label>Figure 4</label><caption>
<title>Overlap between predicted TFBSs.</title>
<p>(A) Venn diagrams showing the overlap between the ChIP predicted by the PWM model(blue) and PIM (red). (B) Difference (one minus the proportion of shared binding sites) between the best binding sites predicted by the PIM and PWM model on ChIPseq peaks (light red), and the same quantity when including the next best predicted binding sites on each peak (dark red). In several cases (<italic>e.g.</italic> Fosl1, Max, N-Myc, Srf, STAT3, Usf1), the difference between predicted binding sites is much smaller when the two best binding sites are considered, indicating that the PIM and the PWM model rank differently the two best binding sites in ChIP peaks with multiple bound sites.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.g004" position="float" xlink:type="simple"/></fig>
<p>Second, using the set of ChIPseq peaks on which the PIM was learned, we looked for the best predicted binding sites on each ChIPseq bound fragment using both the PWM model and the PIM (<xref ref-type="fig" rid="pone-0099015-g004">Figure 4B</xref> and <xref ref-type="table" rid="pone-0099015-t001">Table 1</xref>). The overlap was found to be about <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e232" xlink:type="simple"/></inline-formula> on average. We also computed the overlap between the sets comprising the two best TFBSs of each ChIPseq. When the selected fragments typically contained more than one TFBS, this resulted in an increase in overlap (<italic>e.g</italic> for Fosl1, Max, N-Myc, USF1). Conversely, the overlap between the models was decreased when the fragments typically contained one or less TFBS (<italic>e.g</italic> CTCF, Esrrb).</p>
<p>In conclusion, we found that the TFBS predictions made by the two models could differ significantly both in the rank of ChIPseq fragments and in the rank of binding sites on these fragments.</p>
</sec><sec id="s2d">
<title>Comparison with a PWM-mixture model</title>
<p>An underlying assumption of the PWM model is that there exists a preferred consensus sequence, of which other sequences are close variants. Some authors have instead analyzed the binding specificity of transcription factors by introducing multiple preferred sequences <xref ref-type="bibr" rid="pone.0099015-Heinz1">[31]</xref>. This naturally leads to a model consisting of a mixture of PWMs <xref ref-type="bibr" rid="pone.0099015-Barash1">[15]</xref>. Such a description is a straightforward generalization of the PWM model, but potentially captures higher-order correlations than just pairwise correlations. To be able to compare with the PIM, we learned PWM-mixture models from the same ChIPseq data as previously. A mixture of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e233" xlink:type="simple"/></inline-formula> PWMs was generated by grouping TFBSs into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e234" xlink:type="simple"/></inline-formula> clusters. As with the PIM, the number of clusters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e235" xlink:type="simple"/></inline-formula> was constrained to avoid over-fitting by penalizing the model likelihood using the BIC. For a given TF, the PWM mixture and the collection of TFBSs in the ChIPseq data were refined iteratively until convergence, usually reached after <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e236" xlink:type="simple"/></inline-formula> iterations (see <italic>Methods</italic> for details). The results are shown in <xref ref-type="fig" rid="pone-0099015-g005">Figure 5A</xref> for the three representative factors: Twist, Esrrb and MyoD.</p>
<fig id="pone-0099015-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.g005</object-id><label>Figure 5</label><caption>
<title>Model selection.</title>
<p>(A) Minimisation of the Bayesian information criterion (BIC, see <italic>Methods</italic>) is used to select the optimal number of model parameters and avoid over-fitting the training set. The evolution of the BIC is shown for the PIM (red crosses) and the PWM-mixture model (green lines) as a function of the number of model parameters. Shades from light to dark indicate the iteration number (main loop in <xref ref-type="fig" rid="pone-0099015-g001">Figure 1</xref>), the darkest shade being assigned to the final model. (B) Kullback-Leibler divergences (DKL) between the PWM, PWM-mixture and PIM distributions and the observed distribution for the different TFs, for the BIC optimal parameters. In all cases the PIM outcompetes both the PWM and PWM-mixture models. The DKL between the PIM and a finite-size distribution of sequences drawn from it is also displayed (pink, see <italic>Methods</italic>) to assess the DKL magnitude simply due to the finite number of TFBS in the dataset. The result show that the PIM generally fits the available dataset as well as possible given its finite size. Error bars represent two standard deviations.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.g005" position="float" xlink:type="simple"/></fig>
<p>The best description of Twi ChIPseq data is, for instance, provided by a mixture of 5 PWMs, which corresponds to 184 independent parameters. The mixture model yields a significant improvement compared to the single-PWM model, and milder ones for Essrb and MyoD. In the three cases however, it does perform as well as the PIM.</p>
<p><xref ref-type="fig" rid="pone-0099015-g005">Figure 5B</xref> shows the performances of the different models for all studied TFs using the Kullback-Leibler Divergence or DKL between the observed distribution and the model distribution. The mixture model improves over the single-PWM model for 12 out of 28 TFs. The improvement is particularly good in the cases where the binding site has a palindromic structure (eg Twi, MyoD, Myog, Max, USF1). This may be explained by the fact that the TF binds DNA as a dimer, which could give some concreteness to the mixture model: the recruitment of different partners by bHLH factors like MyoD or Myog could have in fact led a mixture of TFs to bind to the set of considered binding sites. In all studied cases however, the PIM clearly outperforms the other models.</p>
<p>As in the PWM case, the finite size of the datasets leads us to expect fluctuations in the estimation of the DKL. In order to assess the magnitude of these finite-size fluctuations, we computed the average DKL between the best-fitting PIM and a finite-size artificial sample drawn from its own distribution, as shown in <xref ref-type="fig" rid="pone-0099015-g005">Figure 5B</xref>. Values of this DKL that are larger than the one obtained with the real dataset are indicative of overfitting, while the opposite case would suggest that the model is incomplete. In all cases, however, the DKL obtained with this control procedure was within error bars of the value computed with respect to the observed sample, with the exception of NRSF, MyoD, and Myog, as seen in <xref ref-type="fig" rid="pone-0099015-g005">Figure 5B</xref>. We thus conclude that the PIM is generally the best possible model given the available dataset.</p>
</sec><sec id="s2e">
<title>Multi-peaked structure of the model</title>
<p>The connection between the PIM and the PWM-mixture model can be further explored by considering the binding energies of all possible L-mers. This can be viewed as the “ energy landscape” of the PIM in the space of all possible binding nucleotide sequences. The “energy” of a sequence is defined in term of its probability (i.e. how frequently it appears in a set of binding sites) by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e237" xlink:type="simple"/></inline-formula> (Eq. 2) so that sequences that have a lower energy are more probable. Peaks of the probability distribution in the space of all possible L-mers therefore correspond to sequences that have a lower energy than neighboring ones. By contrast with the simple, single-minimum energy well of the PWM model corresponding to the consensus sequence, the PIM may have multiple local energy minima or probability peaks. This a general feature of of this type of models in which the parameters, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e238" xlink:type="simple"/></inline-formula>s and the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e239" xlink:type="simple"/></inline-formula> in Eq. (2), vary with position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e240" xlink:type="simple"/></inline-formula>, the so-called “disordered systems” <xref ref-type="bibr" rid="pone.0099015-Mzard1">[37]</xref>. Starting from any given sequence, and iteratively lowering the energy by single-nucleotide changes, one necessarily ends up in a sequence which is a local minimum. The collection of sequences falling into a particular local minimum defines its basin of attraction (see <italic>Methods</italic> for details). For each local minimum, we constructed a PWM model from the sequences in its basin of attraction, and associated a weight proportional to its size. We compared these PWMs to those of the mixture model, by calculating their DKL. This gave an effective distance which allowed us to associate each local minimum to the nearest PWM of the mixture model.</p>
<p>Using this procedure, we computed the set of PWMs and weights corresponding to the PIM inferred from the 22 TFs for which the PWM did not offer a satisfying description. Examples are shown in <xref ref-type="fig" rid="pone-0099015-g006">Figure 6</xref>. In the case of Twist, the PWMs corresponding to different local minima, can be clearly associated to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e241" xlink:type="simple"/></inline-formula> PWMs of the mixture model. For MyoD, three of the 5 PWMs based on local minima can be clearly assigned to PWMs of the mixture model. The other two have a more spread out representation. The case of Esrrb is similar: while one local minimum has a clear correspondence with a PWM of the mixture model, the other does not. The correspondence between the two models is shown in Figure S3 in <xref ref-type="supplementary-material" rid="pone.0099015.s001">File S1</xref> for the other TFs.</p>
<fig id="pone-0099015-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.g006</object-id><label>Figure 6</label><caption>
<title>PWMs corresponding to the different basins of attraction of the PIM.</title>
<p>The DNA sequence variety described by each model is illustrated using the software WebLogo <xref ref-type="bibr" rid="pone.0099015-Crooks1">[52]</xref>. Shown are PWMs built from all TFBS, from the PWM-mixture model, and from the basins of attraction of the PIM for Twist (A), Esrrb (B), and MyoD (C). The attractor PWMs are grouped under the mixture PWMs with smallest distance (measured by DKL, in bits). Heatmaps showing the DKLs between attractor PWMs and mixture PWMs are displayed on the right for each factor (minimal DKLs are in black). The proportions of binding sites used for each logo are also indicated and serve to denote the corresponding PWM.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.g006" position="float" xlink:type="simple"/></fig>
<p>This representation allows one to identify interesting features captured by the PIM. For example, in the case of Twist, most of the correlations are coming from the two nucleotides at the center of the motif, which take mainly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e242" xlink:type="simple"/></inline-formula> values among the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e243" xlink:type="simple"/></inline-formula> possible: CA,TG and TA. In the case of MyoD, the representation makes apparent the interdependencies between the two nucleotides following the core E-Box motif, and the restriction to the three main cases of CT, TC and TT.</p>
</sec><sec id="s2f">
<title>Properties of the pairwise interactions</title>
<p>The inference of the PIM yields explicit values for the interaction parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e244" xlink:type="simple"/></inline-formula>, allowing for an analysis of their properties. In particular, we wondered how strong these interactions were, and how their strength depended on the distance and positions of the interacting nucleotides.</p>
<p>To estimate the strength of interaction between two positions, we used the tool of Direct Information, originally introduced to predict contacts between residues from large-scale correlation data of protein families <xref ref-type="bibr" rid="pone.0099015-Weigt2">[38]</xref>. More specifically, we built the Normalized Direct Information (NDI), a quantity ranging from 0 for non-existing interactions, to 1 when interactions are maximum (see <italic>Methods</italic>). Heatmaps displaying the results for the representative Twist, Esrrb and MyoD factors are shown in <xref ref-type="fig" rid="pone-0099015-g007">Figure 7A</xref>, and in Figure S4 in <xref ref-type="supplementary-material" rid="pone.0099015.s001">File S1</xref> for the other factors. The direct information between different nucleotides is rather weak—usually smaller than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e245" xlink:type="simple"/></inline-formula>—but substantially larger than the direct interaction between nucleotides in the surrounding background (1–3%, see Figure S5 in <xref ref-type="supplementary-material" rid="pone.0099015.s001">File S1</xref>). Interestingly, such weak pairwise interactions give rise to a substantial improvement in the description of TFBS statistics, similarly to what was previously found in the neural context <xref ref-type="bibr" rid="pone.0099015-Schneidman1">[18]</xref>. The pairwise interactions are concentrated on a small subset of all possible interactions. This can be made quantitative by computing the Participation Ratio of the interaction weights, an indicator of the fraction of pairwise interactions that accounts for the observed Direct Information (see <italic>Methods</italic>). This analysis yielded typical values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e246" xlink:type="simple"/></inline-formula> for the Participation Ratio (<xref ref-type="fig" rid="pone-0099015-g007">Figure 7A</xref> and <xref ref-type="table" rid="pone-0099015-t002">Table 2</xref>), meaning that interactions tend to concentrate on a few nucleotide pairs. We quantified in a similar way the extent of correlations between nucleotides, using the mutual information between different positions in the TFBSs for a given factor (see <italic>Methods</italic>). As seen in <xref ref-type="table" rid="pone-0099015-t002">Table 2</xref>, the pairwise interactions are found to be more sparse than the correlations, consistent with the intuition that correlations between pairs of positions in the sequences can arise indirectly from a ‘path’ of interactions, even when there is no direct interaction between nucleotides at the two positions.</p>
<fig id="pone-0099015-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.g007</object-id><label>Figure 7</label><caption>
<title>Location and strength of the nucleotide pairwise interactions.</title>
<p>(A) Heat maps showing the values of the Normalized Direct Information between pairs of nucleotides. The matrix is symmetric by definition. PWMs are shown on the side for better visualization of the interacting nucleotides. The participation ratio R is indicated below each heat map. (B) Distances between interacting nucleotides. The box plots show the relative importance of the Normalized Direct Information as a function of the distance between interacting nucleotides. Red dots denote average values. (C) Sum of normalized direct informations in the TFBSs at a given position, averaged over all considered factors (blue line). The average site information content relative to background as a function of position is also shown (red line). In both quantities, the average over the two TFBS orientations has been taken.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.g007" position="float" xlink:type="simple"/></fig><table-wrap id="pone-0099015-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.t002</object-id><label>Table 2</label><caption>
<title>Participation Ratios.</title>
</caption><alternatives><graphic id="pone-0099015-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Name</td>
<td align="left" rowspan="1" colspan="1">Part. Ratio DInorm</td>
<td align="left" rowspan="1" colspan="1">Part. Ratio MInorm</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Bin</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e247" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e248" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mef2</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e249" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e250" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Twi</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e251" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e252" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">E2f1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e253" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e254" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Esrrb</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e255" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e256" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Klf4</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e257" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e258" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Nanog</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e259" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e260" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">N-Myc</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e261" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e262" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Oct4</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e263" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e264" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Sox2</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e265" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e266" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Tcfcp2l1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e267" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e268" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Zfx</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e269" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e270" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">C/EBP-beta</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e271" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e272" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">CTCF</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e273" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e274" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">E2f4</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e275" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e276" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Fosl1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e277" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e278" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Max</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e279" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e280" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MyoD</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e281" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e282" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Myog</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e283" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e284" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">NRSF</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e285" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e286" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">TCF3</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e287" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e288" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">USF1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e289" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e290" xlink:type="simple"/></inline-formula></td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>For each TF, we show the Participation Ratios computed for the Normalized Direct Information and Normalized Mutual Information matrices (see <italic>Methods</italic>). Interactions are generally more localized than correlations.</p></fn></table-wrap-foot></table-wrap>
<p>The interaction strength can also be used to measure the typical distance between interacting nucleotides. To that purpose, we computed the relative weight of the Direct Information as a function of the distance between nucleotides (see <italic>Methods</italic>). <xref ref-type="fig" rid="pone-0099015-g007">Figure 7B</xref> shows box plots summarizing the results for the considered TFs. Both plots show a clear bias towards nearest-neighbor interactions with a strong peak for nearest neighbors, and a rapid decrease for distances greater than one.</p>
<p>Finally, we asked how the interaction strength depended on the position along the sequence. We found that interactions were strongest in the flanking regions of the binding site, in clear anti-correlation with the information content, which concentrates in the central region (<xref ref-type="fig" rid="pone-0099015-g007">Figure 7C</xref>). These observations for TF binding <italic>in vivo</italic> agree with similar ones made from a large recent analysis of TF binding <italic>in vitro</italic> <xref ref-type="bibr" rid="pone.0099015-Jolma1">[11]</xref>. One way to rationalize them is that nucleotide diversity is required for pairwise correlations to be important.</p>
<p>The fact that nearest-neighbor interactions are found to be predominant in our unbiased analysis may suggest that they are in fact sufficient to reproduce the statistics of TFBS. This appears interesting to test since PIM s restricted to nearest-neighbor interactions are equivalent to first-order Markov models which are computationally more tractable and in widespread use. In order to assess this possibility, we therefore followed the same iterative procedure as fo the PIM but only allowing the addition of nearest-neighbor interactions. The results for the resulting Nearest-Neighbor Model (NNM) are shown in <xref ref-type="fig" rid="pone-0099015-g008">Figure 8</xref>. Detailed results as a function of the number of pairwise interactions are shown for Twi, Esrrb and MyoD in <xref ref-type="fig" rid="pone-0099015-g008">Figure 8A</xref>. In the three cases, the PIM allows one to introduce more interactions than the NMM without overfitting the data, as measured by the BIC, and fits the data significantly better than the NNM (<xref ref-type="fig" rid="pone-0099015-g008">Figure 8B</xref>). Even when one restricts it self to the optimal number of interactions for the NMM, the PIM does better than the NMM.</p>
<fig id="pone-0099015-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.g008</object-id><label>Figure 8</label><caption>
<title>Comparison with the Nearest-Neighbor Model (NNM).</title>
<p>We study the effect of restricting the PIM to nearest-neighbor interactions, resulting in the NNM. (A) The BIC is shown for the PIM (red crosses) and NNM (cyan dots) as a function of the number of interactions added. Shade from light to dark indicates the iteration, similarly to <xref ref-type="fig" rid="pone-0099015-g005">Figure 5</xref>. The NNM performs less well than the PIM, which provides a quantitative ground for the addition of non-neighbor interactions. (B) Comparison between the observed and predicted frequencies of TFBS according to the PWM, NNM, and PIM. We show the number of added interactions for the PIM and NNM in the legend of each plot. (C) DKLs between the NNM or PIM predicted distributions, and the observed distribution, with the number of parameters that is optimal for the NNM (first two bars) and with the number of parameters that is optimal for the PIM (last bar). The improvement yielded by the PIM is clearly seen for factors like Klf4, CTCF, E2f4 or MyoD. (D) Cumulative distribution of nearest-neighbor (red) and non nearest-neighbor (black) interactions added as a function of the number of interactions added (ranked by strength).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.g008" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pone-0099015-g008">Figure 8C</xref> more generally summarizes the results for the 22 factors, the TFBS statistics of which is not accurately described by the PWM model. While for some factors the PIM only mildly improves over the NNM in terms of DKL (e.g USF1, Sox2, N-Myc, Zfx), for many others there is a significant improvement, sometimes leading to a more than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e291" xlink:type="simple"/></inline-formula> decrease of the DKL (e.g Twi, Klf4, CTCF, MyoD), when comparison is made between the two models with their optimal number of interactions (mean improvement of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e292" xlink:type="simple"/></inline-formula>, see “PIM at PIM optimum” <xref ref-type="fig" rid="pone-0099015-g008">Figure 8C</xref>). The improvement is smaller but exists for several factors even when one considers the PIM with only the small number of interactions (mean improvement of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e293" xlink:type="simple"/></inline-formula>) allowed to prevent overfitting for the NMM (“PIM at NMM optimum” <xref ref-type="fig" rid="pone-0099015-g008">Figure 8C</xref>). To see how this better performance of the PIM arises together with a prevalence of pairwise interactions between consecutive nucleotides, we ranked the pairwise interactions in order of decreasing strength (the absolute value of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e294" xlink:type="simple"/></inline-formula>) and monitored the number of interactions between consecutive nucleotides as a function of interaction strength for Twi, Esrrb and MyoD (<xref ref-type="fig" rid="pone-0099015-g008">Figure 8D</xref>). The majority of interactions between consecutive nucleotides lie among the strong pairwise interactions. Among the strong interactions, we observe a prevalence of interactions between consecutive nucleotides, especially in the case of Esrrb and MyoD. This is all the more striking that there are many more possible non nearest-neighbor interactions than nearest-neighbor ones. Yet, a number of longer range interaction are also among the strongest ones. These play a significant role, as evidenced by the better performance of the PIM over the NMM for a number of factors, even when the number of parameters in the PIM is restricted to number of interactions that is optimal for the NMM. Past the 10 to 20 strongest nearest-neighbor interactions, the number of nearest-neighbor interactions saturates and weaker interactions between distant nucleotides start to appear predominantly (<xref ref-type="fig" rid="pone-0099015-g008">Figure 8D</xref>). Although weaker, these are more numerous than the nearest-neighbor couplings and, for a number of TFs, play a significant role in improving the description of TFBS statistics (<xref ref-type="fig" rid="pone-0099015-g008">Figure 8C</xref>).</p>
</sec><sec id="s2g">
<title>Alternative representation of pairwise interactions by Hopfield patterns</title>
<p>We also analysed the interaction matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e295" xlink:type="simple"/></inline-formula> in terms of sequence-wide modes of co-variation, by diagonalizing it in an orthonormal basis of eigenvectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e296" xlink:type="simple"/></inline-formula>, with corresponding real eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e297" xlink:type="simple"/></inline-formula>. In this decomposition, the energy (Eq. (2)) can be rewritten as (see <italic>Methods</italic>):<disp-formula id="pone.0099015.e298"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e298" xlink:type="simple"/><label>(3)</label></disp-formula></p>
<p>This form is reminiscent of the Hopfield model <xref ref-type="bibr" rid="pone.0099015-Hopfield1">[39]</xref>, which was introduced to describe neural memories as attractor patterns of the neural dynamics, arising from pairwise interactions between idealized binary neurons. Here, the role of the Hopfield patterns is played by the eigenvectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e299" xlink:type="simple"/></inline-formula>. They offer an alternative way to analyze the correlative structure of the pairwise interactions, as already proposed in a mean-field context in <xref ref-type="bibr" rid="pone.0099015-Cocco2">[40]</xref>, even though in this case the presence of the local binding energies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e300" xlink:type="simple"/></inline-formula>, prevents the pattern sequences <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e301" xlink:type="simple"/></inline-formula> from being local energy minima in sequence space. This spectral decomposition of the interaction matrix is also similar in spirit to a principal component analysis.</p>
<p>We wondered how many patterns were necessary to approximate the full interaction matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e302" xlink:type="simple"/></inline-formula> accurately. To address this question, we rank ed the eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e303" xlink:type="simple"/></inline-formula> in order of decreasing moduli and noted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e304" xlink:type="simple"/></inline-formula> the restriction of the interaction matrix generated by the first <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e305" xlink:type="simple"/></inline-formula> eigenvalues and their associated patterns. The full interaction matrix naturally corresponds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e306" xlink:type="simple"/></inline-formula>. Approximate Normalized Direct Information matrices obtained by keeping increasing numbers of dominant patterns are shown in <xref ref-type="fig" rid="pone-0099015-g009">Figure 9</xref> for the three considered representative factors. Pairs of successive patterns appear to provide the main interaction domains in this representation, as is particularly clear in the case of MyoD. One can see in <xref ref-type="fig" rid="pone-0099015-g009">Figure 9</xref> that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e307" xlink:type="simple"/></inline-formula> already closely approximates the full interaction matrix, a consequence of the fact that the important interactions are concentrated on a few links between pairs of nucleotides. In the eigenvalue spectrum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e308" xlink:type="simple"/></inline-formula>, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e309" xlink:type="simple"/></inline-formula> eigenvalues of highest moduli corresponding to these dominant patterns show up as ‘outliers’ as compared to the bulk of the other eigenvalues (<xref ref-type="fig" rid="pone-0099015-g009">Figure 9</xref>, red bars in the eigenvalues histograms). Theoretical analyses in the context of protein structure prediction have similarly found that large contributions to the interactions come from localized patterns with the largest eigenvalues <xref ref-type="bibr" rid="pone.0099015-Cocco1">[25]</xref>, <xref ref-type="bibr" rid="pone.0099015-Rivoire1">[26]</xref>.</p>
<fig id="pone-0099015-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0099015.g009</object-id><label>Figure 9</label><caption>
<title>Representation of interactions by Hopfield patterns.</title>
<p>The full interaction matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e310" xlink:type="simple"/></inline-formula> is approximated by a matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e311" xlink:type="simple"/></inline-formula> built from the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e312" xlink:type="simple"/></inline-formula> Hopfield patterns with highest eigenvalue moduli. We show the Normalized Direct Information matrices computed from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e313" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e314" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e315" xlink:type="simple"/></inline-formula> and the full matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e316" xlink:type="simple"/></inline-formula>. For MyoD, the correspondence between successive pairs of patterns and distinct interaction domains (middle, upper left and bottom right) is particularly clear. In all cases the full Direct Information matrix is already well approximated by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e317" xlink:type="simple"/></inline-formula>. The bottom plots show histograms of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e318" xlink:type="simple"/></inline-formula> eigenvalues of highest moduli (red) and of the other ones (blue). The high eigenvalues lie on both sides of a core of smaller eigenvalues centered around <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e319" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0099015.g009" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s3">
<title>Discussion</title>
<p>The availability of ChIPseq data for many TFs is an opportunity to revisit the question of nucleotide correlations in TFBSs, and to propose alternative descriptions of TFBS ensembles beyond the PWM <xref ref-type="bibr" rid="pone.0099015-Mathelier1">[17]</xref>. To allow for a fair and consistent comparison between different models, we have developed a workflow in which the TFBS collection and the model describing them are simultaneously obtained and refined together. In addition, data overfitting is a concern when comparing models with many parameters, which we addressed using the BIC to penalize complex models. We found that when enough data were available, the PWM description, which assumes independence between nucleotides, failed to reproduce the observed statistics of TFBSs. The concomitant presence of correlations agrees with previous reports <xref ref-type="bibr" rid="pone.0099015-Man1">[7]</xref>, <xref ref-type="bibr" rid="pone.0099015-Bulyk1">[9]</xref>, <xref ref-type="bibr" rid="pone.0099015-Cao1">[41]</xref> and with the conclusions of large scale <italic>in vitro</italic> TF binding studies <xref ref-type="bibr" rid="pone.0099015-Badis1">[10]</xref>, <xref ref-type="bibr" rid="pone.0099015-Jolma1">[11]</xref>.</p>
<p>To refine the PWM description, we have proposed and analyzed a model with general pairwise interactions (the PIM), as well as a model using a mixture of PWMs. While the mixture model somewhat improves over the PWM description, the PIM achieves a much more significant and general improvement, and can even be shown to be optimal given the amount of available data. The PIM could account for higher-order correlations than pairwise, superseding explicit descriptions in terms of multiple motifs such the one provided by the PWM-mixture model.</p>
<p>Several other approaches have previously been proposed to describe nucleotides correlations in TFBS, usually based on computationally-friendly approaches such as a Markov models or Bayesian networks <xref ref-type="bibr" rid="pone.0099015-Jolma1">[11]</xref>, <xref ref-type="bibr" rid="pone.0099015-Barash1">[15]</xref>, <xref ref-type="bibr" rid="pone.0099015-Mathelier1">[17]</xref> or focusing on strongly correlated nucleotides pairs <xref ref-type="bibr" rid="pone.0099015-Zhou1">[12]</xref>–<xref ref-type="bibr" rid="pone.0099015-Siddhartan1">[14]</xref>. The PIM distinguishes itself from these previous approaches by using on the contrary a ‘brute-force’ computer approach to compute the nucleotide correlations arising from the model, with the full enumeration and computation of the binding energy of all possible L-mers, without any approximation besides the limitation to pairwise interactions. This limits its application to moderate L values. The value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e320" xlink:type="simple"/></inline-formula> has been chosen in the present study but it could be slightly increased with more computer power or perhaps refined algorithms. With this restriction, the PIM allows one to assess the impact of simplifying assumptions. Comparison between the PIM and the NNM shows that taking into account interactions between consecutive nucleotides, as in first-order Markov models, is not sufficient to provide a good account of TFBS statistics. Similarly, we have shown that multiple weak interactions play a comparable role to the few strong correlated dinucleotides pairs <xref ref-type="bibr" rid="pone.0099015-Zhou1">[12]</xref>–<xref ref-type="bibr" rid="pone.0099015-Siddhartan1">[14]</xref> in improving TFBS description. Using the BIC also provides a principled way to limit the number of interactions and avoid overfitting instead of fixing a somewhat arbitrary cut-off. A study <xref ref-type="bibr" rid="pone.0099015-Sharon1">[16]</xref> proposed to improve the PWM by adding interactions describing various ‘features’ of TFBS statistics. However, this interesting proposal was only implemented in computationally simple cases (i.e for tree-like interaction structures) and it is not clear to us how it could be applied besides these. Recently a Hidden Markov Model (HMM) approach was applied to ChIPseq data, in the same spirit as was done in the present paper with the PIM <xref ref-type="bibr" rid="pone.0099015-Mathelier1">[17]</xref>. The HMM approach inherits the limitations of the Markov models pointed out above, but it has the advantage that via its hidden state it can explicitly account for TFBS motifs that comprise a spacer sequence of variable length. The PIM was shown to account for higher-order correlations than pairwise, superseding explicit descriptions in terms of multiple motifs such the one provided by the PWM-mixture model. This makes it able to also account for variable length spacers, at least partially. For instance, in the case of Essrb, local probability peaks arising from nearest-neighbor interactions exhibited a triplet of flanking nucleotides with a variable spacer from the core motif (Figure S6 in <xref ref-type="supplementary-material" rid="pone.0099015.s001">File S1</xref>), possibly reflecting the inherent half-site structure of nuclear receptor binding sites. Nonetheless, extending the PIM to explicitly include the possibility of a variable length spacer within the binding motif, appears a worthy pursuit for future investigations. It would allow us to bring the full power of the PIM description to motifs for which its limit to L-mers of moderate size is really a limitation as well as to improve over the Markov model limitation of the HMM approach <xref ref-type="bibr" rid="pone.0099015-Mathelier1">[17]</xref>.</p>
<p>The PIM derives from the principle of maximum entropy, with the constraint that pairwise correlations are accurately described by the model. This approach has already been applied in a variety of biological contexts. The determination of amino acid interactions in protein structures <xref ref-type="bibr" rid="pone.0099015-Weigt1">[22]</xref>, <xref ref-type="bibr" rid="pone.0099015-Morcos1">[23]</xref>, <xref ref-type="bibr" rid="pone.0099015-Cocco1">[25]</xref>, <xref ref-type="bibr" rid="pone.0099015-Rivoire1">[26]</xref> is the closest to ours. The application differs however from ours on a technical level since the diversity of amino acids is much greater than the one of nucleotides and the lengths of proteins greatly exceed as well that of TFBSs. This renders an enumeration of possible sequences fully out of reach in the protein case. Various approximations are required to compute the model correlations and apply the maximum entropy formalism, in contrast to the present application to TFBSs. Other applications range from populations of spiking neurons <xref ref-type="bibr" rid="pone.0099015-Schneidman1">[18]</xref>, <xref ref-type="bibr" rid="pone.0099015-Shlens1">[19]</xref> to bird flocks <xref ref-type="bibr" rid="pone.0099015-Bialek1">[27]</xref>. As in our case, these models often have a multi-peaked probability landscape, leading to speculations about the functional interpretation of the local maxima <xref ref-type="bibr" rid="pone.0099015-Mora1">[24]</xref>, <xref ref-type="bibr" rid="pone.0099015-Tkacik1">[42]</xref>. In the present case of TFBSs, local maxima may simply reflect the multiplicity of binding solutions.</p>
<p>The inferred parameters of the PIM provide insight into the location and strength of the effective interactions between nucleotides without potential biases coming from model simplifying assumptions. The dominant pairwise interactions are found mainly between consecutive nucleotides in the TFBS flanking regions, in agreement with <italic>in vitro</italic> TF binding data from extensive high-throughput SELEX experiments <xref ref-type="bibr" rid="pone.0099015-Jolma1">[11]</xref>. Our analysis also shows that nominal pairwise interactions are generally weak (at most only about 10% of the PWM weights), although they combine to yield a significant improvement in the description of the TFBS statistics through their collective effect. This is reminiscent of similar results obtained in the completely different context of correlated neuron activity <xref ref-type="bibr" rid="pone.0099015-Schneidman1">[18]</xref>.</p>
<p>However, the physical interpretation of the effective interactions is not clear, since these may combine real physical interactions with genomic correlations. This is similar to the case of protein families, where structural and functional contraints are hard to distinguish from phylogenic correlations or other observational biases <xref ref-type="bibr" rid="pone.0099015-Weigt1">[22]</xref>. Comparison between <italic>in vitro</italic> <xref ref-type="bibr" rid="pone.0099015-Badis1">[10]</xref>, <xref ref-type="bibr" rid="pone.0099015-Jolma1">[11]</xref> and <italic>in vivo</italic> binding data may help to disentangle the different possible origins of the found correlations, and seems worth pursuing. It appears similarly interesting to study how much of the found pairwise correlations can be explained on the basis of structural data. Finally, the role of nucleotide interactions in TFBS evolution <xref ref-type="bibr" rid="pone.0099015-Lassig1">[43]</xref> should be considered and could improve the reconstruction of TFBSs from multi-species comparison <xref ref-type="bibr" rid="pone.0099015-Moses1">[44]</xref>–<xref ref-type="bibr" rid="pone.0099015-Rouault1">[46]</xref>.</p>
<p>Independently of these future prospects, we have found that the TFBSs predicted from ChIPseq data depended significantly on the model used to extract them. Since the PIM and the developed workflow significantly improve TFBS description and require a modest computational effort, they should prove worthy tools in future data analyses.</p>
</sec><sec id="s4" sec-type="methods">
<title>Methods</title>
<sec id="s4a">
<title>Genome-wide data retrieval</title>
<p>We use both ChIP-on-chip data from <italic>Drosophila Melanogaster</italic> and ChIPseq data from <italic>Mus Musculus</italic>. Data was retrieved from the literature <xref ref-type="bibr" rid="pone.0099015-Zinzen1">[32]</xref>, <xref ref-type="bibr" rid="pone.0099015-Chen1">[33]</xref> and from ENCODE data accessible through the UCSC website <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/mm9/encodeDCC/wgEncodeCaltechTfbs/" xlink:type="simple">http://hgdownload.cse.ucsc.edu/goldenPath/mm9/encodeDCC/wgEncodeCaltechTfbs/</ext-link>, for a total of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e321" xlink:type="simple"/></inline-formula> TFs. Among them, there are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e322" xlink:type="simple"/></inline-formula> developmental Drosophilae TFs: Bap, Bin, Mef2, Tin and Twi, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e323" xlink:type="simple"/></inline-formula> mammalian stem cells TFs: c-Myc, E2f1, Esrrb, Klf4, Nanog, N-Myc, Oct4, Sox2, STAT3, Tcfcp2l1, Zfx, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e324" xlink:type="simple"/></inline-formula> factors involved in mammalian myogenesis: C/EBP-beta, E2f4, Fosl1, Max, MyoD, Myog, NRSF, Smad1, SRF, Tcf3, Usf1. Overall, there are between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e325" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e326" xlink:type="simple"/></inline-formula> ChIP peaks, with average size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e327" xlink:type="simple"/></inline-formula>bp (see <xref ref-type="table" rid="pone-0099015-t001">Table 1</xref>). DNA sequences were masked for repeats using RepeatMasker <xref ref-type="bibr" rid="pone.0099015-Bao1">[47]</xref>.</p>
</sec><sec id="s4b">
<title>Background models</title>
<p>It is important to discriminate the statistics of the motifs proper from that of the background DNA on which motifs are found. Besides particular nucleotides frequencies, the background DNA can exhibit significant nucleotide correlations, for instance arising from CpG depletion in mammalian genomes (Figure S5 in <xref ref-type="supplementary-material" rid="pone.0099015.s001">File S1</xref>). For each ChIPseq data, we used, as background, all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e328" xlink:type="simple"/></inline-formula>-mers sequences from both strands of the ChIP peaks. This served to learn background PWM models and background PIMs which were used as reference models to score the corresponding TFBS models. The position information content in all plotted PWM logos is measured with respect to the nucleotide background frequencies (<italic>i.e.</italic> the PWM background model).</p>
</sec><sec id="s4c">
<title>Initial PWM refinement</title>
<p>Along with the ChIPseq data for the different factors, we also retrieved corresponding PWMs from the literature <xref ref-type="bibr" rid="pone.0099015-Zinzen1">[32]</xref>, from JASPAR database <xref ref-type="bibr" rid="pone.0099015-PortalesCasamar1">[48]</xref>, or from TRANSFAC database version <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e329" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pone.0099015-Wingender1">[49]</xref>. These initial PWMs were refined according to the following protocol.</p>
<p>First, because we restricted ourselves to binding sites of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e330" xlink:type="simple"/></inline-formula> throughout this study, we sometimes had to modify the initial length of the PWMs. In those cases, we first computed the center of mass of the initial PWM column information content and used it as the new PWM center. Then we added <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e331" xlink:type="simple"/></inline-formula> columns to the left of this center column and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e332" xlink:type="simple"/></inline-formula> columns to the right, filling in with the initial PWM probabilities if they existed or with the background nucleotide frequencies computed on the TF ChIPseq peaks. In most cases the information content of the final PWM was close to the information content of the full length PWM (see Table S1 in <xref ref-type="supplementary-material" rid="pone.0099015.s001">File S1</xref>). Given ChIPseq data (bound regions) for a given TF and an initial PWM of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e333" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e334" xlink:type="simple"/></inline-formula> was taken for all computations in the present paper), we scanned both strands of each bound region and attributed to all observed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e335" xlink:type="simple"/></inline-formula>-mers a score defined as the ratio between the PWM and background models probabilities. A cutoff was set such that half of the bound regions had at least one predicted TFBS with a score above the cutoff, setting a True Positive Rate (TPR) of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e336" xlink:type="simple"/></inline-formula>. This heuristic criterion overcame the problem of False Positives among the ChIPseq peaks that might have polluted the data. This defined a training set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e337" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e338" xlink:type="simple"/></inline-formula>-mers with probability higher than the cutoff, on which a PWM was learned. The position of the center of mass of the PWM column information content was then computed. A new PWM of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e339" xlink:type="simple"/></inline-formula> was defined centered around this position, by keeping the columns of the previous PWM that fell inside the newly defined window. The centered PWM was extended with columns of background frequencies when necessary. This ensured that the core of the motif would be found at the center, while flanking nucleotides from both sides would be represented, a feature that could be lacking from the initial PWM. Bound sites were again predicted using the same cutoff. This procedure was repeated until stabilization of the predicted sites to a fixed subset. This resulted in a refined PWM with its associated set of bound sites.</p>
</sec><sec id="s4d">
<title>PWM model evaluation</title>
<p>The PWM model consist of a matrix of single nucleotide probabilities of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e340" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e341" xlink:type="simple"/></inline-formula> is the width of the binding site. In a first approximation, the parameters appearing in the matrix can be estimated from a set of binding sites by computing the observed frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e342" xlink:type="simple"/></inline-formula> of nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e343" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e344" xlink:type="simple"/></inline-formula>. However, this frequency fluctuates around the “true” probability due to finite sample size, and for example unobserved nucleotides could actually have a low probability of being observed provided that the number of observations be high enough. It is usual to correct for this effect by using the Bayesian pseudo-count approach stemming from Laplace's rule of succession <xref ref-type="bibr" rid="pone.0099015-Wasserman1">[3]</xref>. The probability to observe nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e345" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e346" xlink:type="simple"/></inline-formula> is given by:<disp-formula id="pone.0099015.e347"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e347" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e348" xlink:type="simple"/></inline-formula> is the number of observed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e349" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e350" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e351" xlink:type="simple"/></inline-formula> is the total number of TFBS s, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e352" xlink:type="simple"/></inline-formula>'s are the pseudo-counts, or prior probabilities to observe nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e353" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e354" xlink:type="simple"/></inline-formula>. The pseudo-counts were all set to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e355" xlink:type="simple"/></inline-formula>, however no significant effect was noted when changing this value, as expected from the large number of observations.</p>
</sec><sec id="s4e">
<title>Kullback-Leibler divergence</title>
<p>The Kullback-Leibler divergence is a measure of distance between two probability distributions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e356" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e357" xlink:type="simple"/></inline-formula> of a variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e358" xlink:type="simple"/></inline-formula>, and is defined as:<disp-formula id="pone.0099015.e359"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e359" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p>Throughout this paper, when a DKL is calculated between a finite sample and a model distribution, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e360" xlink:type="simple"/></inline-formula> corresponds to the TFBS frequencies in the sample, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e361" xlink:type="simple"/></inline-formula> to the model distribution. When the DKL is calculated between a PWM of a basin of attraction of an attractor state and a PWM from the mixture model, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e362" xlink:type="simple"/></inline-formula> is used for the former, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e363" xlink:type="simple"/></inline-formula> for the latter.</p>
</sec><sec id="s4f">
<title>Estimation of the fluctuations due to finite sampling: DKL <italic>vs</italic> self</title>
<p>To estimate whether the description of the data by a model (<italic>e.g.</italic> PWM or PIM) could be improved or was consistent with the finite number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e364" xlink:type="simple"/></inline-formula> of observed sequences, we computed the ‘self’ DKL between the distribution of a set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e365" xlink:type="simple"/></inline-formula> sequences drawn from the model distribution and the model distribution itself. This procedure was repeated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e366" xlink:type="simple"/></inline-formula> times. TFs for which the PWM model DKL was smaller than or within two standard deviations of the self DKL were discarded for later analysis.</p>
</sec><sec id="s4g">
<title>Derivation of the Pairwise Interaction Model (PIM)</title>
<p>Information theory offers a principled way to determine the probabilities of a set of states given some measurable constraints. It consists in maximizing a functional known as the entropy<xref ref-type="bibr" rid="pone.0099015-Jaynes1">[50]</xref>, <xref ref-type="bibr" rid="pone.0099015-Shannon1">[51]</xref> over the set of possible probability distributions given the imposed constraints. Here, we wish to determine the probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e367" xlink:type="simple"/></inline-formula> of a DNA sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e368" xlink:type="simple"/></inline-formula> of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e369" xlink:type="simple"/></inline-formula>, in the set of TFBSs for a transcription factor, given the constraints that the probability distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e370" xlink:type="simple"/></inline-formula> retrieves the one- and two-point correlations observed in a set of bound DNA sequences. We denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e371" xlink:type="simple"/></inline-formula> the alphabet of possible nucleotides, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e372" xlink:type="simple"/></inline-formula> and by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e373" xlink:type="simple"/></inline-formula> the nucleotide at position i in the sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e374" xlink:type="simple"/></inline-formula> so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e375" xlink:type="simple"/></inline-formula>. With these notations, the entropy with the considered constraints translates into the following functional:<disp-formula id="pone.0099015.e376"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e376" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e377" xlink:type="simple"/></inline-formula> (resp. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e378" xlink:type="simple"/></inline-formula>) is the probability of having nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e379" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e380" xlink:type="simple"/></inline-formula> (resp. nucleotides <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e381" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e382" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e383" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e384" xlink:type="simple"/></inline-formula>) in the TFBS data set. In the evaluation of probabilities from data, pseudo-counts were set to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e385" xlink:type="simple"/></inline-formula> for single-point frequencies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e386" xlink:type="simple"/></inline-formula> (see previous section <italic>PWM model evaluation</italic>) and to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e387" xlink:type="simple"/></inline-formula> for pairwise frequencies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e388" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e389" xlink:type="simple"/></inline-formula> is the DNA alphabet size. The function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e390" xlink:type="simple"/></inline-formula> denotes the Kronecker <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e391" xlink:type="simple"/></inline-formula>function defined by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e392" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e393" xlink:type="simple"/></inline-formula>,and 0 otherwise. The first term in Eq. (6) is the entropy of the probability distribution to be found and the other terms are the given constraints along with their Lagrangian multipliers. Maximization of the functional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e394" xlink:type="simple"/></inline-formula> is performed in a usual way by setting the functional derivative with respect to the probability distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e395" xlink:type="simple"/></inline-formula> to zero:<disp-formula id="pone.0099015.e396"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e396" xlink:type="simple"/><label>(7)</label></disp-formula></p>
<p>Finally, using the constraint <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e397" xlink:type="simple"/></inline-formula>, one finds the probability distribution that maximizes entropy given the constraints that it reproduces the observed one- and two-point correlations:<disp-formula id="pone.0099015.e398"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e398" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e399" xlink:type="simple"/></inline-formula> is given by,<disp-formula id="pone.0099015.e400"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e400" xlink:type="simple"/><label>(9)</label></disp-formula></p>
<p>The normalization constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e401" xlink:type="simple"/></inline-formula> is the partition function,<disp-formula id="pone.0099015.e402"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e402" xlink:type="simple"/><label>(10)</label></disp-formula></p>
</sec><sec id="s4h">
<title>Unique determination of the PIM</title>
<p>The split of the energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e403" xlink:type="simple"/></inline-formula> between local binding energy term and pairwise interactions is not unique and the origin of the energy scale is itself not uniquely defined. This non-uniqueness of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e404" xlink:type="simple"/></inline-formula> arises from the invariance of the probability distribution of sequences, as given by Eqs. (8, 9), under shifts of the local binding energies, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e405" xlink:type="simple"/></inline-formula> and under mutual transformations between the pairwise interaction terms <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e406" xlink:type="simple"/></inline-formula> and the local binding energies. In order to uniquely determine <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e407" xlink:type="simple"/></inline-formula>, this arbitrariness needs to be taken care of by adding further conditions that uniquely fix its different energy parameters <xref ref-type="bibr" rid="pone.0099015-Weigt1">[22]</xref>, a process that we detail below (this is called ‘gauge fixation’ in <xref ref-type="bibr" rid="pone.0099015-Weigt1">[22]</xref>)</p>
<p><bold>Local binding energies.</bold> The probability is invariant with respect to the following global shift of the local binding energies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e408" xlink:type="simple"/></inline-formula>, which amounts to a change of the reference energy that is cancelled by the normalization,<disp-formula id="pone.0099015.e409"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e409" xlink:type="simple"/><label>(11)</label></disp-formula></p>
<p>To uniquely prescribe the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e410" xlink:type="simple"/></inline-formula>, we choose to fix this invariance by minimizing the square norm <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e411" xlink:type="simple"/></inline-formula> of local energy terms The corresponding condition reads<disp-formula id="pone.0099015.e412"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e412" xlink:type="simple"/><label>(12)</label></disp-formula></p>
<p>This condition can be imposed on any set of energies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e413" xlink:type="simple"/></inline-formula> by using the tranformation (11) and redefining the energies as follows,<disp-formula id="pone.0099015.e414"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e414" xlink:type="simple"/><label>(13)</label></disp-formula></p>
<p><bold>Pairwise interactions.</bold> Another invariance stems from the fact that contributions can be shifted between local binding energies and pairwise interactions. Namely, the following change of variables does not affect the probability:<disp-formula id="pone.0099015.e415"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e415" xlink:type="simple"/><label>(14)</label></disp-formula>since the local energy term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e416" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e417" xlink:type="simple"/></inline-formula> can be redistributed in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e418" xlink:type="simple"/></inline-formula> and the constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e419" xlink:type="simple"/></inline-formula> gives an energy reference for the interacting nucleotides that is cancelled by the normalization process. A unique set of pairwise interactions can be obtained by minimizing the square norm <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e420" xlink:type="simple"/></inline-formula> This yields the conditions:<disp-formula id="pone.0099015.e421"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e421" xlink:type="simple"/><label>(15)</label></disp-formula></p>
<p>These can be imposed on any set of pairwise interactions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e422" xlink:type="simple"/></inline-formula> by redefining them as follows:<disp-formula id="pone.0099015.e423"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e423" xlink:type="simple"/><label>(16)</label></disp-formula></p>
</sec><sec id="s4i">
<title>Determination of the PIM from the data</title>
<p>The parameters of the model in Eq. (9), giving the energy of an observed sequence of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e424" xlink:type="simple"/></inline-formula>, must be computed from the data. The parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e425" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e426" xlink:type="simple"/></inline-formula> represent the energy contributions respectively coming from individual nucleotides and from their interactions. The PWM model is the particular case where all the pairwise interactions vanish: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e427" xlink:type="simple"/></inline-formula>.</p>
<p>To build the model, we start from the PWM description, characterized by the set of initial <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e428" xlink:type="simple"/></inline-formula> and the pairwise interactions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e429" xlink:type="simple"/></inline-formula>'s set to zero. We add one pairwise interaction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e430" xlink:type="simple"/></inline-formula> at a time, corresponding to the pair of nucleotides whose pairwise distribution predicted by the model differs most from data, as estimated by a binomial <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e431" xlink:type="simple"/></inline-formula>-value. We then fit the augmented model to data, use this model to select a new set binding sites from the reads, and repeat the whole procedure. In each of these steps, fitting is performed by a gradient descent algorithm:<disp-formula id="pone.0099015.e432"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e432" xlink:type="simple"/><label>(17)</label></disp-formula><disp-formula id="pone.0099015.e433"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e433" xlink:type="simple"/><label>(18)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e434" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e435" xlink:type="simple"/></inline-formula> are matrices of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e436" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e437" xlink:type="simple"/></inline-formula> respectively corresponding to the single- and two-point frequencies, and superscripts denote whether the matrices are computed from the data or from the model distribution. This algorithm converges to the set of parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e438" xlink:type="simple"/></inline-formula> that match all single marginals and the pairwise marginals of interest. The number of pairwise interactions that are being added is controlled by the Bayesian Information Criterion, or BIC (<xref ref-type="fig" rid="pone-0099015-g005">Figure 5</xref> in main text). The BIC computes the opposite log-likelihood and adds a penalty proportional to the number of parameters involved. This adverts the over-fitting of a finite dataset with an extravagant number of parameters. The procedure is iterated until minimization of the BIC, yielding the best PIM with the full set of parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e439" xlink:type="simple"/></inline-formula>. As in the case of the PWM model, we score each sequence using the ratio between the TF and background pairwise models and impose a score cutoff so as to select a set of bound sites yielding <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e440" xlink:type="simple"/></inline-formula> TPR, on which a new pairwise model is learned. This process is iterated until convergence to a stable set of bound sites.</p>
</sec><sec id="s4j">
<title>BIC computation</title>
<p>Consider a sample <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e441" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e442" xlink:type="simple"/></inline-formula> TFBSs drawn from an unknown distribution function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e443" xlink:type="simple"/></inline-formula> we wish to estimate. To this extent, several models <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e444" xlink:type="simple"/></inline-formula> are proposed, each model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e445" xlink:type="simple"/></inline-formula> having a density <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e446" xlink:type="simple"/></inline-formula> with parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e447" xlink:type="simple"/></inline-formula> of dimension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e448" xlink:type="simple"/></inline-formula>. It is straightforward to see that, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e449" xlink:type="simple"/></inline-formula> increases, the fit to the observed sample as measured by the likelihood function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e450" xlink:type="simple"/></inline-formula> increases as well, the limiting case being when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e451" xlink:type="simple"/></inline-formula> is estimated as the sample distribution. However, such an estimator is inappropriate to account for new, yet unobserved TFBSs, <italic>i.e.</italic> it is not predictive. Such a case where the number of parameters used to estimate a distribution becomes of the order of the size of the sample is known as overfitting. The BIC allows to overcome overfitting by penalizing high dimension parameters. Using Bayes Rule, and a uniform a priori distribution on the models, we have<disp-formula id="pone.0099015.e452"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e452" xlink:type="simple"/><label>(19)</label></disp-formula></p>
<p>That is, the probability of the model given the data can be inferred from the probability that the data is generated by the model. The latter is obtained by marginalizing the joint distribution of the data and the parameters over the space of parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e453" xlink:type="simple"/></inline-formula>:<disp-formula id="pone.0099015.e454"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e454" xlink:type="simple"/><label>(20)</label></disp-formula></p>
<p>For a unidimensional parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e455" xlink:type="simple"/></inline-formula>, the likelihood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e456" xlink:type="simple"/></inline-formula> is maximized at some particular <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e457" xlink:type="simple"/></inline-formula> with an uncertainty (or width) proportional to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e458" xlink:type="simple"/></inline-formula> in the limit of large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e459" xlink:type="simple"/></inline-formula>. Assuming a broad prior, then for large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e460" xlink:type="simple"/></inline-formula> the integral is dominated by the likelihood which is concentrated around its maximum. One can then approximate the integral by the area of the region of height the maximum likelihood and of width <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e461" xlink:type="simple"/></inline-formula>, that is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e462" xlink:type="simple"/></inline-formula>. This result can be retrieved analytically using the method of steepest descent. For a number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e463" xlink:type="simple"/></inline-formula> of parameters, one gets a total volume <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e464" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pone.0099015-Bishop1">[36]</xref>. Taking the logarithm yields the BIC condition:<disp-formula id="pone.0099015.e465"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e465" xlink:type="simple"/><label>(21)</label></disp-formula></p>
<p>In the present case, the sample <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e466" xlink:type="simple"/></inline-formula> is the set of observed TFBSs and the model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e467" xlink:type="simple"/></inline-formula> determines the probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e468" xlink:type="simple"/></inline-formula> of belonging to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e469" xlink:type="simple"/></inline-formula>,<disp-formula id="pone.0099015.e470"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e470" xlink:type="simple"/><label>(22)</label></disp-formula></p>
<p>The interpretation of Eq. (21) is clear: adding new parameters improves the fit, but also adds new sources of uncertainty about these parameters due to the finite size of the data. This uncertainty disappears as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e471" xlink:type="simple"/></inline-formula>, since the log-likelihood scales with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e472" xlink:type="simple"/></inline-formula> while the correction scales with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e473" xlink:type="simple"/></inline-formula>.</p>
<p>Finally, Eq. (21) is a functional over models, the chosen model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e474" xlink:type="simple"/></inline-formula> is the one that minimizes it,<disp-formula id="pone.0099015.e475"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e475" xlink:type="simple"/><label>(23)</label></disp-formula></p>
</sec><sec id="s4k">
<title>PWM mixture model</title>
<p>We investigated an approach based on a mixture of PWMs. For that purpose, we used a comparable setup as for the PIM. However, instead of adding correlations to a given PWM, new PWMs were added to a mixture model. More precisely, a mixture of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e476" xlink:type="simple"/></inline-formula> PWMs, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e477" xlink:type="simple"/></inline-formula>, was generated by using a K-means algorithm with a Hamming distance metrics on the initial set of bound sites. This resulted in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e478" xlink:type="simple"/></inline-formula> clusters, each comprising <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e479" xlink:type="simple"/></inline-formula> TFBSs among the initial <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e480" xlink:type="simple"/></inline-formula> TFBSs. A PWM was generated on each of these clusters, with probability distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e481" xlink:type="simple"/></inline-formula>. The mixture model of order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e482" xlink:type="simple"/></inline-formula> was then defined as <xref ref-type="bibr" rid="pone.0099015-Bishop1">[36]</xref>:<disp-formula id="pone.0099015.e483"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e483" xlink:type="simple"/><label>(24)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e484" xlink:type="simple"/></inline-formula> is the cluster weight. Because a PWM has <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e485" xlink:type="simple"/></inline-formula> degrees of freedom (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e486" xlink:type="simple"/></inline-formula> of them being constrained by the summation of nucleotide probabilities to one) and there are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e487" xlink:type="simple"/></inline-formula> free weight parameters, the number of parameters corresponding to a mixture of order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e488" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e489" xlink:type="simple"/></inline-formula>. As previously, the model showing minimal BIC score was used for TFBS detection, a new set of PWMs and weights <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e490" xlink:type="simple"/></inline-formula> was generated by clustering the set of detected TFBS and the procedure was iterated until convergence to a stable set of TFBS.</p>
</sec><sec id="s4l">
<title>Local minima of the PIM and their basins of attraction</title>
<p>We defined the basins of attraction of a PIM energy landscape, in the following fashion. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e491" xlink:type="simple"/></inline-formula> be a L-mer with energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e492" xlink:type="simple"/></inline-formula>. We looked for the nucleotides that could be changed to minimize <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e493" xlink:type="simple"/></inline-formula>. If such nucleotides existed, one of them was chosen at random, and its value was updated. One nucleotide sequence corresponding to a local energy minimum of the energy landscape, was reached when no nucleotide could be changed. The basin of attraction of a local-energy-minimum sequence was then defined as the ensemble of L-mers that fell onto this sequence when their energy was minimized. The randomness in the choice of the changed nucleotide, could in principle lead different local-energy-minimum sequences to be reached starting from the same initial sequence. However, we observed that this was rarely the case, and that results were highly similar for different runs of this procedure or when we used a deterministic method consisting in iteratively choosing the nucleotide leading to the strongest decrease in energy (Figure S2 in <xref ref-type="supplementary-material" rid="pone.0099015.s001">File S1</xref>).</p>
<p>We computed local-energy-minimum sequences and their basins of attraction for the final set of bound sites obtained with the best PIM. A PWM was learned on each basin of attraction, leading to a set of representative PWMs, with different weights representing different proportions of bound sites in their basins.</p>
</sec><sec id="s4m">
<title>Computation of the Direct Information</title>
<p>We wanted to build a quantity based solely on direct interactions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e494" xlink:type="simple"/></inline-formula> between nucleotides, discarding indirect interactions. To this end, we used the interaction parameters obtained from the PIM to build the direct dinucleotide probability function:<disp-formula id="pone.0099015.e495"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e495" xlink:type="simple"/><label>(25)</label></disp-formula>where<disp-formula id="pone.0099015.e496"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e496" xlink:type="simple"/></disp-formula></p>
<p>The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e497" xlink:type="simple"/></inline-formula> single nucleotide energies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e498" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e499" xlink:type="simple"/></inline-formula> were fully determined by the constraints that the direct probability function matched the observed one-point frequencies:<disp-formula id="pone.0099015.e500"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e500" xlink:type="simple"/><label>(26)</label></disp-formula></p>
<p>The normalization of the probabilities <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e501" xlink:type="simple"/></inline-formula>, served to reduce this system to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e502" xlink:type="simple"/></inline-formula> equations. The energies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e503" xlink:type="simple"/></inline-formula>, which are determined up to a constant, were fixed by the condition that they vanished for the nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e504" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e505" xlink:type="simple"/></inline-formula>. The system was solved using the Levenberg-Marquadt algorithm with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e506" xlink:type="simple"/></inline-formula>. While the interaction energies (the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e507" xlink:type="simple"/></inline-formula>s are chosen to be those of the PIM, the single nucleotide energies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e508" xlink:type="simple"/></inline-formula> are different from the corresponding ones (the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e509" xlink:type="simple"/></inline-formula>) in the PIM since they originate from a different set of constraint and effectively take into account the pairwise interaction with -and between- other nucleotides.</p>
<p>The Direct Information <xref ref-type="bibr" rid="pone.0099015-Morcos1">[23]</xref> was then defined as:<disp-formula id="pone.0099015.e510"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e510" xlink:type="simple"/><label>(27)</label></disp-formula></p>
<p>As there is no upper bound for this direct information, we built a normalized version of the direct information:<disp-formula id="pone.0099015.e511"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e511" xlink:type="simple"/><label>(28)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e512" xlink:type="simple"/></inline-formula> denotes the entropy at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e513" xlink:type="simple"/></inline-formula>. Note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e514" xlink:type="simple"/></inline-formula> so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e515" xlink:type="simple"/></inline-formula> for this maximally correlated case. On the contrary, independent nucleotides give <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e516" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4n">
<title>Computation of the Mutual Information</title>
<p>The Mutual Information was defined as:<disp-formula id="pone.0099015.e517"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e517" xlink:type="simple"/><label>(29)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e518" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e519" xlink:type="simple"/></inline-formula> are defined in Eq. 17 and 18. As for the case of the direct information, we built a normalized version of the mutual information:<disp-formula id="pone.0099015.e520"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e520" xlink:type="simple"/><label>(30)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e521" xlink:type="simple"/></inline-formula> denotes the entropy at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e522" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4o">
<title>Participation Ratio</title>
<p>For each TF, an interaction weight was defined for each pair of nucleotides as<disp-formula id="pone.0099015.e523"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e523" xlink:type="simple"/><label>(31)</label></disp-formula></p>
<p>Similarly, a ‘correlation weight’ can be defined by replacing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e524" xlink:type="simple"/></inline-formula> in the previous equation by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e525" xlink:type="simple"/></inline-formula>. Self-interactions have no meaning here and were attributed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e526" xlink:type="simple"/></inline-formula>. Let us note <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e527" xlink:type="simple"/></inline-formula> the number of possible interactions, counting both <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e528" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e529" xlink:type="simple"/></inline-formula> terms. Using our weight, one writes the Participation Ratio as:<disp-formula id="pone.0099015.e530"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e530" xlink:type="simple"/><label>(32)</label></disp-formula></p>
<p>The interpretation is simple: if all weights are equal, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e531" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e532" xlink:type="simple"/></inline-formula>, <italic>i.e.</italic> all possible interactions are represented. Conversely, if only one interaction accounts in the distribution budget, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e533" xlink:type="simple"/></inline-formula>, meaning that only one of all possible interactions is represented.</p>
</sec><sec id="s4p">
<title>Distance between interactions</title>
<p>The previously defined interaction weights were averaged over all possible pairs of nucleotides at a given distance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e534" xlink:type="simple"/></inline-formula> of one another, yielding the distance distribution:<disp-formula id="pone.0099015.e535"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e535" xlink:type="simple"/><label>(33)</label></disp-formula></p>
<p>where<disp-formula id="pone.0099015.e536"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e536" xlink:type="simple"/><label>(34)</label></disp-formula>is a normalization factor. Note that we introduced a correction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e537" xlink:type="simple"/></inline-formula> to account for finite-size effects, namely the fact that randomly distributed interactions will lead to an overrepresentation of nearest neighbors interactions just because these are more numerous.</p>
</sec><sec id="s4q">
<title>Interaction matrix and Hopfield patterns</title>
<p>In the PIM energy, shown in Eq. (1) from the main text, only <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e538" xlink:type="simple"/></inline-formula> terms appear in the interaction budget: indeed, we forbid self-interactions (already accounted for by the local energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e539" xlink:type="simple"/></inline-formula>) and do not count the pairwise interactions twice. However, we can straightforwardly extend the interaction matrix to a full symmetric matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e540" xlink:type="simple"/></inline-formula> of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e541" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e542" xlink:type="simple"/></inline-formula>-valued indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e543" xlink:type="simple"/></inline-formula>. The matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e544" xlink:type="simple"/></inline-formula> is such that for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e545" xlink:type="simple"/></inline-formula> with furthermore <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e546" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e547" xlink:type="simple"/></inline-formula>. The energy of a sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e548" xlink:type="simple"/></inline-formula> can then be written with these notations<disp-formula id="pone.0099015.e549"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e549" xlink:type="simple"/><label>(35)</label></disp-formula>where in the last equality the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e550" xlink:type="simple"/></inline-formula> sign denotes vector transposition and we have introduced the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e551" xlink:type="simple"/></inline-formula> vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e552" xlink:type="simple"/></inline-formula> associated to sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e553" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e554" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e555" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e556" xlink:type="simple"/></inline-formula> otherwise.</p>
<p>Since the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e557" xlink:type="simple"/></inline-formula> is symmetric, it can be diagonalized in an orthonormal basis of eigenvectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e558" xlink:type="simple"/></inline-formula> with real eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e559" xlink:type="simple"/></inline-formula>,<disp-formula id="pone.0099015.e560"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e560" xlink:type="simple"/><label>(36)</label></disp-formula></p>
<p>Denoting by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e561" xlink:type="simple"/></inline-formula> the coordinates of the k-th eigenvector then, one can rewrite Eq. (35) as<disp-formula id="pone.0099015.e562"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e562" xlink:type="simple"/><label>(37)</label></disp-formula></p>
<p>Finally, the full PIM energy is given by:<disp-formula id="pone.0099015.e563"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0099015.e563" xlink:type="simple"/><label>(38)</label></disp-formula></p>
</sec><sec id="s4r">
<title>Code availability</title>
<p>The source code used in the present paper is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/msantolini/PIM" xlink:type="simple">https://github.com/msantolini/PIM</ext-link>. It allows one to build the different models given sequence data (ChIP-chip or ChIPseq for example) and an initial PWM. Data files used for Twist in the present study are also provided as test examples.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pone.0099015.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0099015.s001" position="float" xlink:type="simple"><label>File S1</label><caption>
<p><bold>Supporting figures and tables. Figure S1. Dependence of the fit on the number of ChIP sequences.</bold> For each TF, the number of available ChIP sequences is plotted <italic>vs.</italic> the improvement in the description of its TFBS statistics, provided by the he PIM as compared to the PWM model. The latter is quantified by the ratio of DKL between the respective model probability distributions and the experimental ones provided by the ChIP data, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e564" xlink:type="simple"/></inline-formula>. The improvement afforded by the PIM is clearly seen to be correlated to the number of ChIP sequences available.TFs for which the PWM description appears satisfactory (see <xref ref-type="fig" rid="pone-0099015-g002">Figure 2</xref> of the main text) are shown in blue. <bold>Figure S2. Comparison of the different methods to define the basins of attraction.</bold> We compare two methods that allow to define the basins of attraction of the PIM model. Given an initial sequence, the attractor is found by changing iteratively either the nucleotide providing the strongest decrease in energy (deterministic method) or a random nucleotide providing a strict decrease of energy (random method). We show for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e565" xlink:type="simple"/></inline-formula> factors studied in the main text the proportion of sites falling in each of the basins of attraction using the deterministic method or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e566" xlink:type="simple"/></inline-formula> trials of the random method. For these factors we observed that the number of basins of attraction was not changing, and that the proportion of sites falling in each basin was well conserved. <bold>Figure S3.</bold> Same as <xref ref-type="fig" rid="pone-0099015-g006">Figure 6</xref> of the main text for all considered factors described by a mixture model with two or more PWMs. <bold>Figure S4.</bold> Same as <xref ref-type="fig" rid="pone-0099015-g007">Figure 7A</xref> of the main text for the other considered factors. <bold>Figure S5. Background correlations.</bold> (A,B,C) Heat maps showing the correlations between nucleotides in the ChIP data of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e567" xlink:type="simple"/></inline-formula> factors from the main text. Because of translation invariance, we only show the correlations between a nucleotide (rows) and the next nearest (first four columns) to farthest (last four columns) nucleotides, using the binding site length of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e568" xlink:type="simple"/></inline-formula>. We see in the Drosophila data the appreciable presence of repeated sequences (of type AA, TT, CC, and GG). In the mammalian data sets, we observe the known CpG depletion. (A′,B′,C′) Corresponding heat maps showing the values of the Normalized Direct Information between pairs of nucleotides. <bold>Figure S6. Variable spacer length.</bold> We learned a PIM for Esrrb including the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e569" xlink:type="simple"/></inline-formula> flanking nucleotides on the left of the main motif. (A) The metastable states of this model show a feature not captured in the main text where binding sites are defined symmetrically around the center of mass of the information content: namely a ‘CAG’ trinucleotide with variable spacer length from the main motif. This feature is apparent in the first <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e570" xlink:type="simple"/></inline-formula> logos shown here. (B) The contribution of this trinucleotidic interaction to the Direct Information is captured through strong direct links between the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e571" xlink:type="simple"/></inline-formula> flanking nucleotides, showing that the PIM is implicitly able to capture higher order correlations. Logos from the PWM model are surrounding the heatmap for clarity. <bold>Table S1. Comparison between initial PWMs and </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0099015.e572" xlink:type="simple"/></inline-formula><bold> PWMs.</bold> Bottom rows correspond to the 6 factors that are satisfactorily described by the PWM model. Information content is in bits.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We wish to thank PY Bourguignon and I Grosse for stimulating discussions at a preliminary stage of this work.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0099015-Spitz1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spitz</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Furlong</surname><given-names>EE</given-names></name> (<year>2012</year>) <article-title>Transcription factors: from enhancer binding to developmental control</article-title>. <source>Nat Rev Genet</source> <volume>13</volume>: <fpage>613</fpage>–<lpage>626</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Stamatoyannopoulos1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stamatoyannopoulos</surname><given-names>JA</given-names></name> (<year>2012</year>) <article-title>What does our genome encode?</article-title> <source>Genome Res</source> <volume>22</volume>: <fpage>1602</fpage>–<lpage>1611</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Wasserman1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name>, <name name-style="western"><surname>Sandelin</surname><given-names>A</given-names></name> (<year>2004</year>) <article-title>Applied bioinformatics for the identification of regulatory elements</article-title>. <source>Nat Rev Genet</source> <volume>5</volume>: <fpage>276</fpage>–<lpage>287</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Berg1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berg</surname><given-names>OG</given-names></name>, <name name-style="western"><surname>von Hippel</surname><given-names>PH</given-names></name> (<year>1987</year>) <article-title>Selection of DNA binding sites by regulatory proteins. Statistical mechanical theory and application to operators and promoters</article-title>. <source>J Mol Biol</source> <volume>193</volume>: <fpage>723</fpage>–<lpage>50</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Stormo1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Fields</surname><given-names>DS</given-names></name> (<year>1998</year>) <article-title>Specificity, free energy and information content in protein-DNA interactions</article-title>. <source>Trends Biochem Sci</source> <volume>23</volume>: <fpage>109</fpage>–<lpage>13</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Djordjevic1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Djordjevic</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sengupta</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Shraiman</surname><given-names>BI</given-names></name> (<year>2003</year>) <article-title>A biophysical approach to transcription factor binding site discovery</article-title>. <source>Genome Res</source> <volume>13</volume>: <fpage>2381</fpage>–<lpage>2390</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Man1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Man</surname><given-names>TK</given-names></name>, <name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>2001</year>) <article-title>Non-independence of Mnt repressor-operator interaction determined by a new quantitative multiple fluorescence relative affinity (QuMFRA) assay</article-title>. <source>Nucleic Acids Res</source> <volume>29</volume>: <fpage>2471</fpage>–<lpage>8</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Benos1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benos</surname><given-names>PV</given-names></name>, <name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>2002</year>) <article-title>Additivity in protein-DNA interactions: how good an approximation is it?</article-title> <source>Nucleic Acids Res</source> <volume>30</volume>: <fpage>4442</fpage>–<lpage>51</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Bulyk1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>PLF</given-names></name>, <name name-style="western"><surname>Church</surname><given-names>GM</given-names></name> (<year>2002</year>) <article-title>Nucleotides of transcription factor binding sites exert interdependent effects on the binding affinities of transcription factors</article-title>. <source>Nucleic Acids Res</source> <volume>30</volume>: <fpage>1255</fpage>–<lpage>61</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Badis1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Badis</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name>, <name name-style="western"><surname>Philippakis</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>Talukder</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gehrke</surname><given-names>AR</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Diversity and complexity in DNA recognition by transcription factors</article-title>. <source>Science</source> <volume>324</volume>: <fpage>1720</fpage>–<lpage>3</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Jolma1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jolma</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Yan</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Whitington</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Toivonen</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Nitta</surname><given-names>KR</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>DNA-Binding Specificities of Human Transcription Factors</article-title>. <source>Cell</source> <volume>152</volume>: <fpage>327</fpage>–<lpage>339</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Zhou1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhou</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name> (<year>2004</year>) <article-title>Modeling within-motif dependence for transcription factor binding site predictions</article-title>. <source>Bioinformatics</source> <volume>20</volume>: <fpage>909</fpage>–<lpage>16</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Hu1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Taylor</surname><given-names>JMG</given-names></name>, <name name-style="western"><surname>Chinnaiyan</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Qin</surname><given-names>ZS</given-names></name> (<year>2010</year>) <article-title>On the detection and refinement of transcription factor binding sites using ChIP-Seq data</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>: <fpage>2154</fpage>–<lpage>67</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Siddhartan1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Siddhartan</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Dinucleotide Weight Matrices for Predicting Transcription Factor Binding Sites: Generalizing the Position Weight Matrix</article-title>. <source>PLoS ONE</source> <volume>5</volume>: <fpage>e9722</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Barash1"><label>15</label>
<mixed-citation publication-type="other" xlink:type="simple">Barash Y, Elidan G, Friedman N, Kaplan T (2003) Modeling dependencies in protein-DNA binding sites. In: Proceedings of the seventh annual international conference on Research in computational molecular biology. ACM, pp. 28–37.</mixed-citation>
</ref>
<ref id="pone.0099015-Sharon1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sharon</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Lubliner</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Segal</surname><given-names>E</given-names></name> (<year>2008</year>) <article-title>A feature-based approach to modeling protein-DNA interactions</article-title>. <source>PLoS Comput Biol</source> <volume>4</volume>: <fpage>e1000154</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Mathelier1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mathelier</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name> (<year>2013</year>) <article-title>The next generation of transcription factor binding site prediction</article-title>. <source>PLoS Comput Biol</source> <volume>9</volume>: <fpage>e1003214</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Schneidman1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Berry</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Segev</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name> (<year>2006</year>) <article-title>Weak pairwise correlations imply strongly correlated network states in a neural population</article-title>. <source>Nature</source> <volume>440</volume>: <fpage>1007</fpage>–<lpage>12</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Shlens1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shlens</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Field</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Gauthier</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Grivich</surname><given-names>MI</given-names></name>, <name name-style="western"><surname>Petrusca</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>The structure of multineuron firing patterns in primate retina</article-title>. <source>J Neurosci</source> <volume>26</volume>: <fpage>8254</fpage>–<lpage>66</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Ikegaya1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ikegaya</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Aaron</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Cossart</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Aronov</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Lampl</surname><given-names>I</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Synfire chains and cortical songs: temporal modules of cortical activity</article-title>. <source>Science</source> <volume>304</volume>: <fpage>559</fpage>–<lpage>564</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Roxin1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roxin</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hakim</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name> (<year>2008</year>) <article-title>The statistics of repeating patterns of cortical activity can be reproduced by a model network of stochastic binary neurons</article-title>. <source>J Neurosci</source> <volume>28</volume>: <fpage>10734</fpage>–<lpage>10745</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Weigt1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>White</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Szurmant</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Hoch</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name> (<year>2009</year>) <article-title>Identification of direct residue contacts in protein-protein interaction by message passing</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>106</volume>: <fpage>67</fpage>–<lpage>72</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Morcos1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morcos</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Pagnani</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lunt</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Bertolino</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Marks</surname><given-names>DS</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>108</volume>: <fpage>E1293</fpage>–<lpage>301</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Mora1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mora</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Walczak</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Callan</surname><given-names>CG</given-names></name> (<year>2010</year>) <article-title>Maximum entropy models for antibody diversity</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>107</volume>: <fpage>5405</fpage>–<lpage>10</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Cocco1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cocco</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Monasson</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name> (<year>2013</year>) <article-title>From principal component to direct coupling analysis of coevolution in proteins: low-eigenvalue modes are needed for structure prediction</article-title>. <source>PLoS Comput Biol</source> <volume>9</volume>: <fpage>e1003176</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Rivoire1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rivoire</surname><given-names>O</given-names></name> (<year>2013</year>) <article-title>Elements of coevolution in biological sequences</article-title>. <source>Phys Rev Lett</source> <volume>110</volume>: <fpage>178102</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Bialek1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Cavagna</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Giardina</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Mora</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Silvestri</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Statistical mechanics for natural flocks of birds</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>109</volume>: <fpage>4786</fpage>–<lpage>91</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Bialek2"><label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Bialek W, Cavagna A, Giardina I, Mora T, Pohl O, <etal>et al</etal>.. (2013) Social interactions dominate speed control in driving natural flocks toward criticality. arXiv physics.bio-ph.</mixed-citation>
</ref>
<ref id="pone.0099015-Cavagna1"><label>29</label>
<mixed-citation publication-type="other" xlink:type="simple">Cavagna A, Giardina I, Ginelli F, Mora T, Piovani D, <etal>et al</etal>.. (2013) Dynamical maximum entropy approach to flocking. arXiv cond-mat.stat-mech.</mixed-citation>
</ref>
<ref id="pone.0099015-Zhao1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Ruan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Pandey</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>2012</year>) <article-title>Improved models for transcription factor binding site identification using nonindependent interactions</article-title>. <source>Genetics</source> <volume>191</volume>: <fpage>781</fpage>–<lpage>790</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Heinz1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heinz</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Benner</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Spann</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Bertolino</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>YC</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Simple combinations of lineage determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>. <source>Mol Cell</source> <volume>38</volume>: <fpage>576</fpage>–<lpage>89</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Zinzen1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zinzen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Girardot</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Gagneur</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Braun</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Furlong</surname><given-names>E</given-names></name> (<year>2009</year>) <article-title>Combinatorial binding predicts spatio-temporal cis-regulatory activity</article-title>. <source>Nature</source> <volume>462</volume>: <fpage>65</fpage>–<lpage>70</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Chen1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Xu</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Yuan</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Fang</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Huss</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Integration of external signaling pathways with the core transcriptional network in embryonic stem cells</article-title>. <source>Cell</source> <volume>133</volume>: <fpage>1106</fpage>–<lpage>17</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Dunham1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dunham</surname><given-names>I</given-names></name> (<year>2012</year>) <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source> <volume>489</volume>: <fpage>57</fpage>–<lpage>74</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Cover1"><label>35</label>
<mixed-citation publication-type="other" xlink:type="simple">Cover T, Thomas J (2006) Elements of information theory. Wiley-interscience.</mixed-citation>
</ref>
<ref id="pone.0099015-Bishop1"><label>36</label>
<mixed-citation publication-type="other" xlink:type="simple">Bishop C (2006) Pattern recognition and machine learning. Springer New York.</mixed-citation>
</ref>
<ref id="pone.0099015-Mzard1"><label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Mézard M, Parisi G, Virasoro MA (1987) Spin Glass Theory and Beyond. Singapore: World Scientific.</mixed-citation>
</ref>
<ref id="pone.0099015-Weigt2"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>White</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Szurmant</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Hoch</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name> (<year>2009</year>) <article-title>Identification of direct residue contacts in protein-protein interaction by message passing</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>106</volume>: <fpage>67</fpage>–<lpage>72</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Hopfield1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hopfield</surname><given-names>JJ</given-names></name> (<year>1982</year>) <article-title>Neural networks and physical systems with emergent collective computational abilities</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>79</volume>: <fpage>2554</fpage>–<lpage>2558</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Cocco2"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cocco</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Monasson</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Sessak</surname><given-names>V</given-names></name> (<year>2011</year>) <article-title>High-dimensional inference with the generalized Hopfield model: principal component analysis and corrections</article-title>. <source>Phys Rev E Stat Nonlin Soft Matter Phys</source> <volume>83</volume>: <fpage>051123</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Cao1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Yao</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Sarkar</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Lawrence</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sanchez</surname><given-names>GJ</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Genome-wide MyoD binding in skeletal muscle cells: a potential for broad cellular reprogramming</article-title>. <source>Dev Cell</source> <volume>18</volume>: <fpage>662</fpage>–<lpage>74</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Tkacik1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tkacik</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Marre</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Amodei</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Searching for collective behavior in a large network of sensory neurons</article-title>. <source>PLoS Comput Biol</source> <volume>10</volume>: <fpage>e1003408</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Lassig1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lassig</surname><given-names>M</given-names></name> (<year>2007</year>) <article-title>From biophysics to evolutionary genetics: statistical aspects of gene regulation</article-title>. <source>BMC Bioinformatics</source> <volume>8</volume> Suppl 6<fpage>S7</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Moses1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moses</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Chiang</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pollard</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Iyer</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Eisen</surname><given-names>M</given-names></name> (<year>2004</year>) <article-title>MONKEY: identifying conserved transcription-factor binding sites in multiple alignments using a binding site-specific evolutionary model</article-title>. <source>Genome biology</source> <volume>5</volume>: <fpage>R98</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Siddharthan1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Siddharthan</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Siggia</surname><given-names>E</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname><given-names>E</given-names></name> (<year>2005</year>) <article-title>PhyloGibbs: a Gibbs sampling motif finder that incorporates phylogeny</article-title>. <source>PLoS Comput Biol</source> <volume>1</volume>: <fpage>e67</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Rouault1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rouault</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Mazouni</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Couturier</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Hakim</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Schweisguth</surname><given-names>F</given-names></name> (<year>2010</year>) <article-title>Genome-wide identification of cis-regulatory motifs and modules underlying gene coregulation using statistics and phylogeny</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>107</volume>: <fpage>14615</fpage>–<lpage>20</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Bao1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bao</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name> (<year>2002</year>) <article-title>Automated de novo identification of repeat sequence families in sequenced genomes</article-title>. <source>Genome Res</source> <volume>12</volume>: <fpage>1269</fpage>–<lpage>76</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-PortalesCasamar1"><label>48</label>
<mixed-citation publication-type="other" xlink:type="simple">Portales-Casamar E, Thongjuea S, Kwon AT, Arenillas D, Zhao X, <etal>et al</etal>.. (2010) JASPAR 2010: the greatly expanded open-access database of transcription factor binding profiles. Nucleic Acids Res. 38(Database issue):105–110.</mixed-citation>
</ref>
<ref id="pone.0099015-Wingender1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wingender</surname><given-names>E</given-names></name> (<year>2008</year>) <article-title>The transfac project as an example of framework technology that supports the analysis of genomic regulation</article-title>. <source>Brief Bioinform</source> <volume>9</volume>: <fpage>326</fpage>–<lpage>32</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Jaynes1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jaynes</surname><given-names>E</given-names></name> (<year>1957</year>) <article-title>Information theory and statistical mechanics</article-title>. <source>Physical review</source> <volume>108</volume>: <fpage>171</fpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Shannon1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shannon</surname><given-names>C</given-names></name> (<year>1948</year>) <article-title>A mathematical theory of communication</article-title>. <source>Bell Syst Tech J</source> <volume>27</volume>: <fpage>623</fpage>–<lpage>656</lpage>.</mixed-citation>
</ref>
<ref id="pone.0099015-Crooks1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Crooks</surname><given-names>GE</given-names></name>, <name name-style="western"><surname>Hon</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Chandonia</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name> (<year>2004</year>) <article-title>WebLogo: a sequence logo generator</article-title>. <source>Genome Res</source> <volume>14</volume>: <fpage>1188</fpage>–<lpage>90</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>