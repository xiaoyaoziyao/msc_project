<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-15-40591</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0152597</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Signal filtering</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Acoustics</subject><subj-group><subject>Sound pressure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical noise</subject><subj-group><subject>Gaussian noise</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Equipment</subject><subj-group><subject>Optical equipment</subject><subj-group><subject>Lasers</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Fourier analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Signal to noise ratio</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Comparison of Deconvolution Filters for Photoacoustic Tomography</article-title>
<alt-title alt-title-type="running-head">Comparison of Deconvolution Filters</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Van de Sompel</surname> <given-names>Dominique</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Sasportas</surname> <given-names>Laura S.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Jokerst</surname> <given-names>Jesse V.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Gambhir</surname> <given-names>Sanjiv S.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Molecular Imaging Program at Stanford (MIPS), Stanford University School of Medicine, Stanford University, Stanford, CA 94305, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of NanoEngineering, UC San Diego, La Jolla, CA 92093, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Zhang</surname> <given-names>Heye</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Shenzhen institutes of advanced technology, CHINA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>Dr. Sanjiv Sam Gambhir serves on the board of Endra Inc., is a founding member, and has stock options. This does not alter the authors’ adherence to PLOS ONE policies on sharing data and materials.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: DVDS LSS JVJ SSG. Performed the experiments: DVDS LSS JVJ. Analyzed the data: DVDS LSS JVJ. Contributed reagents/materials/analysis tools: DVDS LSS JVJ. Wrote the paper: DVDS LSS JVJ.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">sgambhir@stanford.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>31</day>
<month>3</month>
<year>2016</year>
</pub-date>
<volume>11</volume>
<issue>3</issue>
<elocation-id>e0152597</elocation-id>
<history>
<date date-type="received">
<day>11</day>
<month>10</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>16</day>
<month>3</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Van de Sompel et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0152597"/>
<abstract>
<p>In this work, we compare the merits of three temporal data deconvolution methods for use in the filtered backprojection algorithm for photoacoustic tomography (PAT). We evaluate the standard Fourier division technique, the Wiener deconvolution filter, and a Tikhonov L-2 norm regularized matrix inversion method. Our experiments were carried out on subjects of various appearances, namely a pencil lead, two man-made phantoms, an <italic>in vivo</italic> subcutaneous mouse tumor model, and a perfused and excised mouse brain. All subjects were scanned using an imaging system with a rotatable hemispherical bowl, into which 128 ultrasound transducer elements were embedded in a spiral pattern. We characterized the frequency response of each deconvolution method, compared the final image quality achieved by each deconvolution technique, and evaluated each method’s robustness to noise. The frequency response was quantified by measuring the accuracy with which each filter recovered the ideal flat frequency spectrum of an experimentally measured impulse response. Image quality under the various scenarios was quantified by computing noise versus resolution curves for a point source phantom, as well as the full width at half maximum (FWHM) and contrast-to-noise ratio (CNR) of selected image features such as dots and linear structures in additional imaging subjects. It was found that the Tikhonov filter yielded the most accurate balance of lower and higher frequency content (as measured by comparing the spectra of deconvolved impulse response signals to the ideal flat frequency spectrum), achieved a competitive image resolution and contrast-to-noise ratio, and yielded the greatest robustness to noise. While the Wiener filter achieved a similar image resolution, it tended to underrepresent the lower frequency content of the deconvolved signals, and hence of the reconstructed images after backprojection. In addition, its robustness to noise was poorer than that of the Tikhonov filter. The performance of the Fourier filter was found to be the poorest of all three methods, based on the reconstructed images’ lowest resolution (blurriest appearance), generally lowest contrast-to-noise ratio, and lowest robustness to noise. Overall, the Tikhonov filter was deemed to produce the most desirable image reconstructions.</p>
</abstract>
<funding-group>
<funding-statement>Dr. Van de Sompel was supported by a Susan G. Komen postdoctoral fellowship, as well as the Molecular Imaging Program at Stanford (MIPS). Dr. Jokerst is grateful for fellowship support from the Stanford Molecular Imaging Scholars Program SMIS R25-T CA118681, and acknowledges the NIH Loan Repayment Program. This work is also funded in part by the National Cancer Institute CCNE U54 CA119367 (S.S.G.) and In Vivo Cancer Molecular Imaging Center ICMIC P50 CA114747 (S.S.G.). Lastly, the authors would like to acknowledge funding for the Gambhir laboratory from NCI ICMIC P50CA114747, NCI CCNE-T U54 U54CA151459, the Doris Duke Foundation, Canary Foundation, Ben and Catherine Ivy Foundation, and the Sir Peter Michael Foundation.</funding-statement>
</funding-group>
<counts>
<fig-count count="14"/>
<table-count count="0"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant scan data are available from the Harvard Dataverse at <ext-link ext-link-type="uri" xlink:href="https://dataverse.harvard.edu/dataverse/dominiqu" xlink:type="simple">https://dataverse.harvard.edu/dataverse/dominiqu</ext-link>, under the headings "Replication Data for: Comparison of Deconvolution Filters for Photoacoustic Tomography".</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Photoacoustic tomography (PAT) is a hybrid optical and ultrasound imaging technique that combines the high spatial resolution of ultrasound with the high optical contrast of diffuse optical imaging. It is a highly promising modality that has received increasing attention from the biomedical imaging community due to its ability to image in three dimensions, up to 5 cm deep into living tissue. PAT is based on the illumination of an object with brief pulses of laser light. As the light diffuses into the tissue, it is absorbed differentially by the various regions of the tissue. The light absorption causes brief localized heating and an increase in pressure proportional to the amount of light energy absorbed. This leads to the generation of pressure waves that travel out of the tissue and can be measured by ultrasonic transducers. The detected signals are then reconstructed into an image of optical absorption using a computer algorithm.</p>
<p>The field of photoacoustic tomography for biomedical imaging has seen an explosion of novel system geometries and reconstruction algorithms. Common system geometries include circular [<xref ref-type="bibr" rid="pone.0152597.ref001">1</xref>–<xref ref-type="bibr" rid="pone.0152597.ref003">3</xref>], semi-cylindrical or curved [<xref ref-type="bibr" rid="pone.0152597.ref003">3</xref>–<xref ref-type="bibr" rid="pone.0152597.ref005">5</xref>], linear [<xref ref-type="bibr" rid="pone.0152597.ref006">6</xref>–<xref ref-type="bibr" rid="pone.0152597.ref008">8</xref>], planar [<xref ref-type="bibr" rid="pone.0152597.ref009">9</xref>–<xref ref-type="bibr" rid="pone.0152597.ref013">13</xref>], hemispherical [<xref ref-type="bibr" rid="pone.0152597.ref014">14</xref>, <xref ref-type="bibr" rid="pone.0152597.ref015">15</xref>] and spherical [<xref ref-type="bibr" rid="pone.0152597.ref016">16</xref>] measurement apertures, each with various numbers of ultrasound transducer elements. The system used in this study features a hemispherical bowl with 128 transducer elements (see <xref ref-type="sec" rid="sec002">Methods</xref> section). In parallel, an equally diverse range of reconstruction methodologies has been proposed. The main paradigms are one-step analytical backprojection algorithms [<xref ref-type="bibr" rid="pone.0152597.ref017">17</xref>–<xref ref-type="bibr" rid="pone.0152597.ref020">20</xref>], time reversal algorithms [<xref ref-type="bibr" rid="pone.0152597.ref021">21</xref>–<xref ref-type="bibr" rid="pone.0152597.ref025">25</xref>], and iterative model-based reconstruction methods [<xref ref-type="bibr" rid="pone.0152597.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0152597.ref026">26</xref>–<xref ref-type="bibr" rid="pone.0152597.ref032">32</xref>]. An overview of photoacoustic reconstruction methods and further references are given in [<xref ref-type="bibr" rid="pone.0152597.ref024">24</xref>], [<xref ref-type="bibr" rid="pone.0152597.ref033">33</xref>], [<xref ref-type="bibr" rid="pone.0152597.ref034">34</xref>] and [<xref ref-type="bibr" rid="pone.0152597.ref035">35</xref>]. Of these methods, time reversal and iterative methods generally offer superior image and system modeling capabilities. However, one-step analytical backprojection methods have been popular because of their speed and relative ease of implementation.</p>
<p>A key step in most backprojection algorithms is the deconvolution of the recorded pressure signals by the transducer impulse response, prior to backprojection into the reconstructed volume. The deconvolution operation is notoriously ill-posed, and differences in its implementation can have a large impact on the final quality of the reconstructed image, as demonstrated in this paper. The optimization of this operation is therefore of critical importance, and is the subject of this study. We compare the performance of three different deconvolution methods prior to filtered backprojection: division by the impulse response in the Fourier domain, the Wiener deconvolution filter, and a Tikhonov L-2 norm regularized matrix deconvolution scheme. These three techniques were chosen because they are widely known and used deconvolution methods that have proven successful in many signal processing applications. Since they are well-understood and easily implemented, we believe that the results of this study will be useful to any research groups looking to optimize the deconvolution step of PAT reconstruction algorithms. While division in the Fourier space [<xref ref-type="bibr" rid="pone.0152597.ref015">15</xref>, <xref ref-type="bibr" rid="pone.0152597.ref036">36</xref>, <xref ref-type="bibr" rid="pone.0152597.ref037">37</xref>] and Wiener filtering [<xref ref-type="bibr" rid="pone.0152597.ref005">5</xref>, <xref ref-type="bibr" rid="pone.0152597.ref038">38</xref>] has been used in many previous studies, we believe that our study is the first to use Tikhonov L-2 norm regularized matrix deconvolution to deconvolve the pressure data in a filtered backprojection algorithm for photoacoustic tomography. To the best of our knowledge, this study is also the first to provide side-by-side comparisons of these three deconvolution techniques for 3D PAT.</p>
<p>Note that regularized matrix methods have been used previously in iterative reconstruction algorithms for PAT to achieve image smoothness or to implement compressed sensing. In those cases, however, regularization has been applied directly to the image domain, rather than the data domain. A notable exception was the data restoration technique proposed by Wang et al. [<xref ref-type="bibr" rid="pone.0152597.ref039">39</xref>], which used an L-1 norm penalty to sparsify a curvelet representation of the sinogram in 2D PAT. However, this method differs considerably from the signal-by-signal Tikhonov L-2 norm regularized matrix deconvolution explored in this paper. Wang et al.’s method is also less general in that it assumes that the pressure data can be arranged in a data space where small features trace out smooth sinusoidal paths. This may not be true for sparse sampling geometries.</p>
<p>The remainder of this paper is structured as follows. The Methods section explains the photoacoustic signal model, the three deconvolution methods, filtered backprojection, the scanner geometry, and the imaging subjects used. We also explain the performance metrics used to quantify image quality, and mention that we monitored the water temperature to obtain accurate values for the speed of sound. The Results section optimizes the parameters of the Wiener and Tikhonov filters, assesses the image quality afforded by each of the three deconvolution methods, and examines the robustness of each method to changes in noise levels. All photoacoustic data was acquired on the Nexus 128 scanner manufactured by Endra Life Sciences (Ann Arbor, MI, USA). Lastly, the Conclusions section summarizes the findings of our work, and the Further Work section gives recommendations for future work.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Photoacoustic waves and recorded pressure signal model</title>
<p>Photoacoustic pressure wave propagation can be described by the general wave equation
<disp-formula id="pone.0152597.e001"><alternatives><graphic id="pone.0152597.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mo>∇</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msubsup><mml:mi>v</mml:mi> <mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mfrac><mml:msup><mml:mi>∂</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mfenced> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi> <mml:mo>′</mml:mo> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mi>β</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mfrac> <mml:mfrac><mml:mi>∂</mml:mi> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>′</mml:mo> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>r</italic>′ represents the coordinates anywhere in 3D space, <italic>t</italic> is time, <italic>C</italic><sub><italic>p</italic></sub> is the specific heat at constant pressure, <italic>v</italic><sub><italic>s</italic></sub> is the local speed of sound, <italic>β</italic> is the isobaric volume expansion coefficient, and <italic>H</italic> is the heat source function. Using this model, and assuming that <italic>v</italic><sub><italic>s</italic></sub> is constant everywhere, Wang et al. [<xref ref-type="bibr" rid="pone.0152597.ref037">37</xref>] showed that the pressure signal <italic>p</italic><sub><italic>d</italic></sub>(<italic>r</italic>, <italic>t</italic>) recorded by a point transducer located at a particular position <italic>r</italic> is given by
<disp-formula id="pone.0152597.e002"><alternatives><graphic id="pone.0152597.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>β</mml:mi> <mml:msub><mml:mi>r</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mn>4</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mi>k</mml:mi></mml:mrow></mml:mfrac> <mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>t</mml:mi></mml:mfrac> <mml:mo>∫</mml:mo> <mml:msub><mml:mo>∫</mml:mo> <mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mo>′</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>=</mml:mo></mml:mrow> <mml:msub><mml:mi>v</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>′</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>S</mml:mi></mml:mfenced> <mml:mo>*</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>A</italic>(<italic>r</italic>′) is the absorbed optical energy distribution, <italic>r</italic><sub><italic>p</italic></sub> is the distance between the transducer and the point source, and <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) is the pressure recorded by the transducer after illuminating a point source, with a delay time of −<italic>r</italic><sub><italic>p</italic></sub> <italic>v</italic><sub><italic>s</italic></sub>. As described by Wang et al. [<xref ref-type="bibr" rid="pone.0152597.ref037">37</xref>], <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) = <italic>p</italic><sub>0</sub>(<italic>t</italic>)*<italic>h</italic><sub><italic>t</italic></sub>(<italic>t</italic>), where <italic>p</italic><sub>0</sub>(<italic>t</italic>) is the true pressure signal from the point source arriving at the transducer (again with a delay time of −<italic>r</italic><sub><italic>p</italic></sub> <italic>v</italic><sub><italic>s</italic></sub>), and <italic>h</italic><sub><italic>t</italic></sub>(<italic>t</italic>) is the impulse response of the transducer. The constant <italic>k</italic> is defined by <inline-formula id="pone.0152597.e003"><alternatives><graphic id="pone.0152597.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>r</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>I</mml:mi> <mml:mo>′</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>I</italic>(<italic>t</italic>) is the temporal illumination function, and <inline-formula id="pone.0152597.e004"><alternatives><graphic id="pone.0152597.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mi>I</mml:mi> <mml:mo>′</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. From here on, we refer to the signals <italic>h</italic><sub><italic>t</italic></sub>(<italic>t</italic>) and <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) = <italic>p</italic><sub>0</sub>(<italic>t</italic>)*<italic>h</italic><sub><italic>t</italic></sub>(<italic>t</italic>) as the transducer impulse response and the <italic>overall</italic> scanner impulse response, respectively. Finally, note that point detectors are an idealization not achievable in practice. However, the assumption of point detectors is commonly made in the literature on photoacoustic tomography and has been used with great success, including in the paper by [<xref ref-type="bibr" rid="pone.0152597.ref037">37</xref>].</p>
</sec>
<sec id="sec004">
<title>Deconvolution methods</title>
<p>The absorbed optical energy distribution <italic>A</italic>(<italic>r</italic>′) can be reconstructed in two steps. First, we recover the spherical projections by deconvolving <xref ref-type="disp-formula" rid="pone.0152597.e002">Eq 2</xref>. Note that these deconvolutions represent <italic>temporal</italic> deconvolutions, i.e. deconvolutions of the recorded pressure signals. Second, we backproject the projections using a filtered backprojection (FBP) method. In this section, we discuss the three deconvolution schemes compared in this paper. The FBP method is explained in the next section.</p>
<sec id="sec005">
<title>Fourier division deconvolution</title>
<p>The simplest method for deconvolving <xref ref-type="disp-formula" rid="pone.0152597.e002">Eq 2</xref> is to divide out the overall scanner impulse response <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) in the Fourier domain [<xref ref-type="bibr" rid="pone.0152597.ref037">37</xref>]. This operation can be written as
<disp-formula id="pone.0152597.e005"><alternatives><graphic id="pone.0152597.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∫</mml:mo> <mml:msub><mml:mo>∫</mml:mo> <mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mo>′</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>=</mml:mo></mml:mrow> <mml:msub><mml:mi>v</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>′</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>4</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>P</mml:mi></mml:msub> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mi>β</mml:mi> <mml:msub><mml:mi>r</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:mrow><mml:mi mathvariant="script">F</mml:mi> <mml:mo>[</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mi>W</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ω</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi mathvariant="script">F</mml:mi> <mml:mo>[</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>The operators ℱ and ℱ<sup>−1</sup> represent the Fourier transform and inverse Fourier transform, respectively. Note that these represent Fourier transforms of temporal signals (recorded pressure signals). The window function <italic>W</italic>(<italic>ω</italic>) band-limits the recorded pressure signals in order to prevent unwanted high frequency amplification by the division by ℱ[<italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>)]. We used a standard sine window, given by <inline-formula id="pone.0152597.e006"><alternatives><graphic id="pone.0152597.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi>W</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ω</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>|</mml:mo> <mml:mo form="prefix">sin</mml:mo> <mml:mo>(</mml:mo> <mml:mi>π</mml:mi> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0152597.e007"><alternatives><graphic id="pone.0152597.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>ω</mml:mi> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec006">
<title>Wiener deconvolution</title>
<p>The window function <italic>W</italic>(<italic>ω</italic>) is only a heuristic method for countering the sensitivity of Fourier division to high frequency noise. Wiener deconvolution represents a more rigorous approach for improving robustness to noise. It explicitly models the power densities of the noise and deconvolved signal, and solves for a deconvolved signal that minimizes the expected mean square error [<xref ref-type="bibr" rid="pone.0152597.ref040">40</xref>]. To simplify our notation, let us rewrite the signal model as
<disp-formula id="pone.0152597.e008"><alternatives><graphic id="pone.0152597.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>*</mml:mo> <mml:mi>h</mml:mi> <mml:mo>′</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <italic>y</italic>(<italic>t</italic>) is the observed signal, <italic>x</italic>(<italic>t</italic>) is the unknown input signal, * denotes convolution, <italic>h</italic>′(<italic>t</italic>) is the impulse response function, and <italic>v</italic>(<italic>t</italic>) is some unknown additive noise, independent of <italic>x</italic>(<italic>t</italic>). In our case, <italic>y</italic>(<italic>t</italic>) = <italic>p</italic><sub><italic>d</italic></sub>(<italic>r</italic>, <italic>t</italic>), <italic>h</italic>′(<italic>t</italic>) = <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>), and <inline-formula id="pone.0152597.e009"><alternatives><graphic id="pone.0152597.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>β</mml:mi> <mml:msub><mml:mi>r</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mn>4</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>P</mml:mi></mml:msub> <mml:mi>k</mml:mi></mml:mrow></mml:mfrac> <mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>t</mml:mi></mml:mfrac> <mml:mo>∫</mml:mo> <mml:msub><mml:mo>∫</mml:mo> <mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mo>′</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>=</mml:mo></mml:mrow> <mml:msub><mml:mi>v</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>′</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The Wiener deconvolution method computes the input signal estimator <inline-formula id="pone.0152597.e010"><alternatives><graphic id="pone.0152597.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> given by
<disp-formula id="pone.0152597.e011"><alternatives><graphic id="pone.0152597.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>Y</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <inline-formula id="pone.0152597.e012"><alternatives><graphic id="pone.0152597.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <italic>Y</italic>(<italic>f</italic>) are the Fourier transforms of the input signal estimator <inline-formula id="pone.0152597.e013"><alternatives><graphic id="pone.0152597.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the observed signal <italic>y</italic>(<italic>t</italic>), respectively, and the filter <italic>G</italic>(<italic>f</italic>) is given by
<disp-formula id="pone.0152597.e014"><alternatives><graphic id="pone.0152597.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>H</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mrow><mml:mo>|</mml:mo> <mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula></p>
<p>The superscript * in <xref ref-type="disp-formula" rid="pone.0152597.e014">Eq 6</xref> denotes complex conjugation, |.| denotes the magnitude of a complex number, and <italic>H</italic>(<italic>f</italic>) is the Fourier transform of <italic>h</italic>′(<italic>t</italic>). Next, <italic>S</italic>(<italic>f</italic>) is a model for the mean power spectral density (PSD) of the input signal <italic>x</italic>(<italic>t</italic>), and <italic>N</italic>(<italic>f</italic>) is the mean power spectral density of the noise <italic>v</italic>(<italic>t</italic>). The estimator <inline-formula id="pone.0152597.e015"><alternatives><graphic id="pone.0152597.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is recovered by computing the inverse Fourier transform of <inline-formula id="pone.0152597.e016"><alternatives><graphic id="pone.0152597.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We assume that the scanner impulse response <italic>h</italic>′(<italic>t</italic>) = <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) is the same for all transducers. Next, we estimate <italic>N</italic>(<italic>f</italic>) from the average frequency spectrum of the leading parts of the pressure signals, corresponding to time points before any photoacoustic waves can travel from the imaged object to the transducer elements.</p>
<p>Lastly, we assume a Gaussian profile for <italic>S</italic>(<italic>f</italic>), and set the area under the curve of <italic>S</italic>(<italic>f</italic>) = <italic>G</italic>(<italic>f</italic>;<italic>μ</italic>, <italic>σ</italic>) over the frequency range <italic>f</italic> = 0 MHz to <italic>f</italic><sub><italic>Nyquist</italic></sub> = 10 MHz to be equal to the corresponding area under the power spectral density of a standard Fourier deconvolution given by <italic>Y</italic>(<italic>f</italic>)/<italic>H</italic>(<italic>f</italic>), where <italic>Y</italic>(<italic>f</italic>) and <italic>H</italic>(<italic>f</italic>) are again the Fourier transforms of the measured signal and the scanner impulse response <italic>h</italic>′(<italic>t</italic>) = <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>), respectively. We let <italic>μ</italic> = 0. The value of <italic>σ</italic> that optimizes the reconstructed image quality is determined in the Results section. The rationale for using a Gaussian PSD is based on the well-known fact that most of the spectral power in natural images is concentrated towards the lower spatial frequencies. More precisely, natural images’ power spectra fall as the spatial frequency increases, and are relatively isotropic [<xref ref-type="bibr" rid="pone.0152597.ref041">41</xref>]. In this paper, we decided to apply the Gaussian model to the representation of the PSD of the deconvolved signals, which are essentially spherical projections of the reconstructed images, and hence should have frequency contents similar to the frequency content of the original 3D image. To support this last claim, consider the following argument. If the projections were planar and parallel, the 1D Fourier transform of the projections would sample 1D lines through the original image’s 3D Fourier space perpendicular to the projection planes, as described by the Fourier Slice Theorem for the classical Radon transform [<xref ref-type="bibr" rid="pone.0152597.ref042">42</xref>]. Since the reconstructed image volume is small compared to the radius of the imaging bowl, we expect the spherical surfaces to be near-parallel within the confines of the reconstruction volume, and the predictions by the Fourier Slice Theorem to be approximately valid (this approximation is also known as the ‘far field approximation’ [<xref ref-type="bibr" rid="pone.0152597.ref042">42</xref>]). In other words, if the PSD of the 3D Fourier representation of the imaging subject can be modeled by a Gaussian distribution, 1D lines through that space will be adequately modeled by Gaussian distributions as well, which in turn justifies our choice of a Gaussian profile for the deconvolved signals’ mean power spectral density <italic>S</italic>(<italic>f</italic>).</p>
</sec>
<sec id="sec007">
<title>Tikhonov L-2 norm deconvolution</title>
<p>A powerful alternative to Fourier-formulated deconvolution methods is given by matrix deconvolution methods. Continuing the notation used above, we represent the measured signal <italic>y</italic>(<italic>t</italic>) by a column vector <italic>y</italic>, and the unknown input signal <italic>x</italic>(<italic>t</italic>) by a column vector <italic>x</italic>. We then declare a non-circular convolution matrix <italic>C</italic> that contains increasingly shifted copies of the scanner impulse response <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) along its columns. Hence, for each signal, the deconvolution problem takes the form
<disp-formula id="pone.0152597.e017"><alternatives><graphic id="pone.0152597.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mi>C</mml:mi> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
which can be solved for the input signal <italic>x</italic>. To regularize the matrix inversion, we use the standard Tikhonov technique [<xref ref-type="bibr" rid="pone.0152597.ref043">43</xref>], minimizing a cost function of the form
<disp-formula id="pone.0152597.e018"><alternatives><graphic id="pone.0152597.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi>C</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mi>y</mml:mi> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mo>Γ</mml:mo> <mml:mi>x</mml:mi> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where Γ is a matrix that determines the nature of the regularization. We choose to minimize the L-2 norm of the solution, primarily because it is the most convenient form of regularization. This is done by setting Γ = <italic>βI</italic>, where <italic>β</italic> is a parameter setting the strength of the regularization, and <italic>I</italic> is the identity matrix. The value of <italic>β</italic> that optimizes the reconstructed image quality is determined in the Results section. Lastly, note that other forms of regularization such as L-1 norm regularization are possible as well, and will be investigated in future work (see Further Work section). The solution to <xref ref-type="disp-formula" rid="pone.0152597.e018">Eq 8</xref> is given by
<disp-formula id="pone.0152597.e019"><alternatives><graphic id="pone.0152597.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>C</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mi>C</mml:mi> <mml:mo>+</mml:mo> <mml:msup><mml:mo>Γ</mml:mo> <mml:mi>T</mml:mi></mml:msup> <mml:mo>Γ</mml:mo></mml:mfenced> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mi>C</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mi>y</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <inline-formula id="pone.0152597.e020"><alternatives><graphic id="pone.0152597.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> represents the regularized estimate of the deconvolved pressure data. In this work, the size of the non-circular convolution matrix <italic>C</italic> was 512 × 512. Its rank was 502, confirming the ill-posedness of the inversion problem. By comparison, the rank of the circular implementation of <italic>C</italic> (also of size 512 × 512) was 512. Results for both circular and non-circular implementations of <italic>C</italic> are shown in the Image domain section of the Results section. As explained above, the ill-posedness problem was addressed using the Tikhonov L2 norm regularization. Finally, <xref ref-type="disp-formula" rid="pone.0152597.e019">Eq 9</xref> was solved analytically using the backslash operator in Matlab.</p>
</sec>
</sec>
<sec id="sec008">
<title>Filtered backprojection</title>
<p>After deconvolving the pressure signals, the 3D photoacoustic image can be reconstructed using a filtered backprojection algorithm. As the name suggests, this method first filters the data and then backprojects it into the reconstruction volume. To prevent excessive noise amplification, it is common to use a filter with a high-frequency roll-off, rather than the standard ramp filter. We used the common sinc filter, given by
<disp-formula id="pone.0152597.e021"><alternatives><graphic id="pone.0152597.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="|" open="|" separators=""><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>a</mml:mi></mml:mfrac> <mml:mo form="prefix">sin</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mi>a</mml:mi> <mml:mi>π</mml:mi> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mfenced></mml:mfenced> <mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mo form="prefix">sin</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mi>a</mml:mi> <mml:mi>π</mml:mi> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mfenced></mml:mrow> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>π</mml:mi> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mfenced> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <inline-formula id="pone.0152597.e022"><alternatives><graphic id="pone.0152597.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>ω</mml:mi> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>ω</italic> is the spatial frequency of the signal to be backprojected. By changing the value of <italic>a</italic>, one can tune the filter to obtain various degrees of high frequency roll-off. We empirically found that a value of <italic>a</italic> = 0.38 gave desirable results, based on a visual appreciation of the images. The filter for this value is shown in <xref ref-type="fig" rid="pone.0152597.g001">Fig 1</xref>. Further optimization of this value is deferred to future work. Here we focus on the comparison between the three deconvolution methods while keeping the sinc filter constant. The backprojection operation was implemented on a GeForce GTX 590 GPU using the Accelereyes Jacket package in Matlab, reconstructing a 200 × 200 × 200 volume from 120 views in approximately 60 seconds.</p>
<fig id="pone.0152597.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Sinc filter for filtered backprojection algorithm.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Photoacoustic scanner</title>
<p>The photoacoustic scans for this study were acquired using the Nexus 128 scanner, manufactured by Endra Life Sciences (Ann Arbor, MI, USA). <xref ref-type="fig" rid="pone.0152597.g002">Fig 2</xref> illustrates the system. The detection geometry consists of 128 unfocused transducers arranged on a hemispherical bowl. The radius of the bowl is 101.3 mm. A plastic tray is placed on top of the bowl for animal positioning. The tray is covered by a lid that must be closed while scanning (an interlock prevents scanning while the lid is open) as a protective measure to rule out the possibility of eye damage from the laser to the user. A webcam inside the lid allows users to monitor the mouse during a scan. The bowl is filled with water to provide acoustic coupling. A water heating system maintains the water temperature at 38°C between scans to enable small animal imaging. The readings of the water heating system’s thermometer can be accessed in a log file. The water heating pump is switched off during scans to eliminate the risk of bubble formation. The blue dots in <xref ref-type="fig" rid="pone.0152597.g002">Fig 2(d)</xref> indicate the transducer positions, and the green box indicates the spatial support of a standard reconstructed volume (200 × 200 × 200 with an isotropic resolution of 0.1 mm centered on the focal center of the hemispherical bowl). The maximum field of view supported by the system is currently a sphere of radius 3.8 cm, again centered on the focal center of the hemispherical bowl. Each transducer has a circular detection surface with a diameter of 3 mm and records at a sampling rate of 20 MHz. The center frequency of the transducers is 5 MHz with a bandwidth of approximately 70%. Note that if the bandwidth were lower, the transducers would detect fewer sound frequencies in the lower and higher ranges. In the image space, this would translate into fewer low and high spatial frequencies, i.e. lower contrast for larger masses and blurrier edges for small details, respectively. The scanner impulse response <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) was measured by the scanner’s manufacturer by imaging a hair-like mylar thread, approximately 75 <italic>μm</italic> in diameter, which was placed directly in the water at the isocenter of the detector bowl. The signal <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) was measured without the standard diverging lens of the scanner to obtain a higher than normal laser power (43 mJ per pulse) and hence to ensure a high signal-to-noise measurement. The scanner impulse response <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) was assumed equal for all transducers, and is shown in <xref ref-type="fig" rid="pone.0152597.g003">Fig 3</xref>, along with its frequency content. To increase geometric sampling of the detection surface, the bowl is rotated in steps through multiple positions during a single scan. Usually, approximately 120 to 180 bowl positions, distributed uniformly over 360 degrees, suffice to obtain a high quality reconstructed image. Each such bowl position will be referred to as a ‘view’ in the remainder of this paper. Due to the small angular steps and light weight of the bowl, no significant shaking of the transducers nor bubble formation was observed as the stepper motor rotated the bowl.</p>
<fig id="pone.0152597.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Nexus 128 scanner.</title>
<p>(a-c) are reproduced with permission from <ext-link ext-link-type="uri" xlink:href="http://www.endrainc.com" xlink:type="simple">http://www.endrainc.com</ext-link>. The green box in (d) delineates the spatial support of a representative reconstructed field of view. The dimensions of this reconstructed volume are typically set to 2 × 2 × 2 cm, and the isotropic reconstruction resolution typically to 0.2 mm. The blue dots show the locations of the 128 transducers in the bowl.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g002" xlink:type="simple"/>
</fig>
<fig id="pone.0152597.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g003</object-id>
<label>Fig 3</label>
<caption>
<title>(a) Overall scanner impulse response <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) = <italic>p</italic><sub>0</sub>(<italic>t</italic>)*<italic>h</italic><sub><italic>t</italic></sub>(<italic>t</italic>), and (b) its frequency spectrum.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g003" xlink:type="simple"/>
</fig>
<p>The scanner uses a tunable, near-infrared Nd:YAG laser that produces 7 ns pulses at up to 25 mJ per pulse. The typical laser power during our scans was 5 mJ per pulse. The wavelength can be tuned within a wavelength range of 680–980 nm. The repetition rate of the laser is 20 Hz. To reduce the effect of laser pulse power variations, and to increase the SNR of the recorded pressure signals, we average signals over a predetermined number of pulses (typically 100). At the laser repetition rate of 20 Hz, a standard scan using 180 bowl positions therefore takes 15 minutes per excitation wavelength. Note that the scanner allows faster frame rates and hence lower total scan times by using fewer laser pulses per bowl position. However, this would come at the expense of reduced signal averaging to lower signal to noise ratios, and hence poorer final image qualities.</p>
</sec>
<sec id="sec010">
<title>Dependence of speed of sound on water temperature</title>
<p>The speed of sound was corrected for changes in the water temperature during each scan. The importance of doing so was demonstrated by [<xref ref-type="bibr" rid="pone.0152597.ref044">44</xref>]. As mentioned, the water heating system of the scanner is switched off while scanning to minimize the risk of air bubble formation. This causes the water temperature to drop gradually during each scan, on the order of 1.5°C during a 15 minute, 180 view scan. To compensate for this effect, we continuously measured and recorded the temperature of the water coupling medium. To deduce the speed of sound from these temperature measurements, we used the nine-term Mackenzie equation [<xref ref-type="bibr" rid="pone.0152597.ref045">45</xref>], given by
<disp-formula id="pone.0152597.e023"><alternatives><graphic id="pone.0152597.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi> <mml:msup><mml:mi>T</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:msup><mml:mi>T</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>+</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>g</mml:mi> <mml:mi>D</mml:mi> <mml:mo>+</mml:mo> <mml:mi>h</mml:mi> <mml:msup><mml:mi>D</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>i</mml:mi> <mml:mi>T</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>+</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>j</mml:mi> <mml:mi>T</mml:mi> <mml:msup><mml:mi>D</mml:mi> <mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
where <italic>v</italic> is the speed of sound in meters per second, <italic>T</italic> is the water temperature in degrees Celsius, <italic>S</italic> is the salinity in parts per thousand and <italic>D</italic> is the depth in meters. The coefficients of <xref ref-type="disp-formula" rid="pone.0152597.e023">Eq 11</xref> can be found in [<xref ref-type="bibr" rid="pone.0152597.ref045">45</xref>] or [<xref ref-type="bibr" rid="pone.0152597.ref044">44</xref>]. The salinity <italic>S</italic> and depth <italic>D</italic> were both set to 0.</p>
</sec>
<sec id="sec011">
<title>Imaging subjects</title>
<p>In this study, the imaging subjects used were an approximately spherical pencil lead point (0.3 mm in diameter), two physical phantoms, an <italic>in vivo</italic> subcutaneous mouse tumor model and a perfused and excised mouse brain. All animal work was conducted in accordance with the guidelines of and approved by the Administrative Panel on Laboratory Animal Care at Stanford University. Tumors were allowed to grow up to 1000 mm<sup>3</sup>. Animals were euthanized if they showed hunched posture, unkempt coat, or change in body weight more than 20% of baseline. No animals died during any point of the scanning procedures. Animals were given access to standard water and diet ad libitum and housed no more than 5 per cage. Animals were housed in a negative pressure vivarium with standard 12 hour light/dark cycles. The phantoms were produced by printing a digital design onto a transparent overhead projector film using a standard black and white laser printer (Xerox Phaser 3600 PS). The print resolution was 600 × 600 dpi, and the ink used was from a standard Xerox Phaser 3600 PS black and white toner cartridge. The thickness and material of the transparency were 0.1 mm and cellulose acetate, respectively. The designs are shown in <xref ref-type="fig" rid="pone.0152597.g004">Fig 4(a) and 4(b)</xref>, where the white straws used to lower the phantoms into the water are also shown. The dots were 0.6 mm in diameter. The maximum width of the vessel phantom was 0.4 mm. The digital design of the vessel phantom was obtained from the k-Wave Toolbox for Matlab [<xref ref-type="bibr" rid="pone.0152597.ref046">46</xref>].</p>
<fig id="pone.0152597.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Imaging subjects.</title>
<p>(a, b) Dot and vessel phantoms printed onto transparent overhead projector film using a standard black and white laser printer. (c) Perfused and excised mouse brain. Left side: front of the brain. Right side: rear of the brain (cerebellum). (d) <italic>In vivo</italic> subcutaneous mouse tumor model. Notice the dimple at the bottom of the plastic tray (indicated by the black arrow), which contains a small amount of coupling fluid (water), and is used to help position the subcutaneous tumor. The diameter of the dimple is 15 mm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g004" xlink:type="simple"/>
</fig>
<p>The <italic>in vivo</italic> subcutaneous mouse tumor model was generated as follows. MDA-435S cells were acquired from ATCC and grown in DMEM and passaged when they reached 80% confluence. Female nu/nu mice age 6–16 weeks were used. Prior to imaging, the mice were anesthetized with 2% isofluorane in house oxygen at 2 L/min and confirmed with tail pinch. For xenograft tumors, we created a cell pellet containing 106 cells in 50% growth factor reduced matrigel (Becton Dickinson) in media and implanted the pellet subcutaneously on the hind limb of a nude mouse. The tumors were imaged when they reached approximately 10 mm in diameter. A picture of the mouse positioned in the plastic tray of the scanner is shown in <xref ref-type="fig" rid="pone.0152597.g004">Fig 4(d)</xref>. Note that the tray contains a dimple to immobilize the tumor, and to position it in the center of the laser beam. As seen in the Results section, the tumor used in this study was selected for its particularly tortuous and pervasive vasculature.</p>
<p>Lastly, the mouse brain perfusion and excision was performed as follows. After placing the mouse under deep anesthesia, the animal’s chest and abdomen were exposed by making a surgical cut along the midline. The frontal rib cage was cut, exposing the pericardium. A large gauge needle (18 gauge) connected to a syringe by a long PE tube was inserted into the left ventricle of the heart. The inferior vena cava was severed with scissors to allow the blood, saline and fixative to leave the body during perfusion. Using a syringe pump, the mouse was perfused with 20 mL of saline for 5–10 min followed by 20 mL of 10% formalin fixative solution. After perfusion, a craniotomy was performed and the brain was excised carefully and stored in 10% formalin. The perfused and excised mouse brain is shown in <xref ref-type="fig" rid="pone.0152597.g004">Fig 4(c)</xref>. A collection of representative slices through the mouse brain, obtained after the photoacoustic scan, is shown in <xref ref-type="fig" rid="pone.0152597.g005">Fig 5</xref>.</p>
<fig id="pone.0152597.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Representative slices through the perfused and excised mouse brain.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Simulation of noise in scan data</title>
<p>To assess each deconvolution method’s robustness to noise, we simulated noise onto high quality scan data. This data was obtained by scanning with a high number of averaging pulses (so as to achieve a low level of noise in the recorded pressure signals) and a geometric sampling density high enough to eliminate streak artifacts. These requirements were met by choosing 100 averaging pulses and 180 bowl positions. Higher levels of noise were then simulated by adding zero-mean Gaussian noise to the recorded pressured data. Gaussian noise was chosen because it adequately describes the noise variations that were observed around averaged signals in experimental measurements. We decided to simulate noise, rather than experimentally acquire repeated scans with successively lower pulse numbers, to ensure consistency and comparability between the reconstruction results. By simulating, we prevented confounding effects such as motion artifacts, laser power drift and inter-scan changes in water temperature (i.e. speed of sound) from biasing our results.</p>
</sec>
<sec id="sec013">
<title>Deconvolution filter parameter optimization</title>
<p>The Wiener and Tikhonov methods require the setting of tunable parameters, namely <italic>σ</italic> and <italic>β</italic>. To optimize these values, one could simply use trial and error based on a visual assessment of the reconstructed images. In this work, however, we use a more systematic approach by assessing the effect of changing parameter values in both the pressure data (projection) and image domains.</p>
<p>For the pressure data domain, we assess the ability of each filter to recover the ideal flat frequency spectrum of a deconvolved impulse signal as a function of the respective parameter value. Our metric for this assessment is the normalized correlation coefficient (NCC) between the ideal flat spectrum and the actual recovered spectrum, given by
<disp-formula id="pone.0152597.e024"><alternatives><graphic id="pone.0152597.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>&lt;</mml:mo> <mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo> <mml:mo>&gt;</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mo>.</mml:mo> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi>I</mml:mi> <mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where <italic>S</italic>(<italic>f</italic>) is the spectrum of the deconvolved impulse signal, <italic>f</italic> denotes frequency, <italic>I</italic>(<italic>f</italic>) is the ideal flat spectrum, and &lt;.,.&gt; denotes the dot product. The spectra are treated as column vectors, whose norm is denoted by ||.||. In this experiment, impulse signals were measured by scanning a piece of pencil lead measuring 0.3 mm in diameter. Since we used 128 bowl positions with 128 transducer positions each, the scan yielded 16,384 signals. To arrive at a single spectrum <italic>S</italic>(<italic>f</italic>) for any parameter value, we computed the mean spectrum of all 16,384 deconvolved signals. The value of <italic>C</italic> ranges between −1 and 1; a perfect correlation is indicated by 1. Hence, we regard the optimal filter setting as the one that corresponds to the highest value of <italic>C</italic> (i.e. closest to 1). The results of this optimization experiment are presented in the Projection domain section of the Results section.</p>
<p>For the image domain, we compute noise versus resolution trade-off curves, as generated by varying the filters’ parameter values. This is achieved by plotting the full width at half maximum (FWHM) of a 1D Gaussian fit to the reconstructed pencil point versus the sum of squared differences between neighboring pixels in a background patch, normalized by the sum of the squares of the intensities in that patch. FWHM is a common metric for quantifying image resolution. The sum of squared differences between neighboring pixels is commonly used in the computed tomography literature as a metric for describing image noise, where it is usually exploited to regularize against such noise (i.e. to reduce it) [<xref ref-type="bibr" rid="pone.0152597.ref047">47</xref>]. The results of the noise versus resolution trade-off analysis are shown in the Image domain section of the Results section. We also combine the results from the Projection domain and Image domain sections, and identify the optimal parameter values.</p>
</sec>
<sec id="sec014">
<title>Image quality metrics</title>
<p>After tuning the parameters of the deconvolution filters, we reconstructed each of the remaining imaging subjects presented in the Imaging Subjects section using each deconvolution method, and compared the resulting image qualities both visually and quantitatively. The quantitative metrics used were the full width at half maximum (FWHM), as well as the contrast-to-noise ratio (CNR) of selected point and linear image features. Similar to before, the FWHM and CNR were computed by fitting Gaussian functions to 1D intensity profiles through selected point and line features. The FWHM was given by the width of the Gaussian at half maximum, and the CNR was given by
<disp-formula id="pone.0152597.e025"><alternatives><graphic id="pone.0152597.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>CNR</mml:mtext> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>A</mml:mi> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
where <italic>A</italic> is the amplitude of the fitted Gaussian, and <italic>σ</italic><sub><italic>b</italic></sub> is the standard deviation of the intensities in a selected background region. For the line profiles, of which several examples are shown in the Results section, this background region was chosen to be the part of the line profile more than three standard deviations away from the mean of the fitted Gaussian. An example Gaussian fit is shown in <xref ref-type="fig" rid="pone.0152597.g006">Fig 6</xref>. For the mouse brain reconstruction shown in the Results section, the examined linear feature was not as spatially isolated as the dots and linear features in the other imaging subjects. Hence we estimated the CNR of this feature by dividing its average peak-to-trough difference by the standard deviation of the area outside of the brain slice.</p>
<fig id="pone.0152597.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Example Gaussian fit to a 1D intensity profile in order to estimate the FWHM and CNR of point-like or linear features.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g006" xlink:type="simple"/>
</fig>
<p>For the robustness to noise experiments, we used a global CNR metric, computed over the entire image. This was done because the Gaussian fitting to 1D line profiles became unstable at high noise levels. The metric used was the overall contrast-to-noise ratio (CNR<sub><italic>o</italic></sub>), defined by
<disp-formula id="pone.0152597.e026"><alternatives><graphic id="pone.0152597.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mi>N</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mi>o</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>B</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
where
<disp-formula id="pone.0152597.e027"><alternatives><graphic id="pone.0152597.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>R</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>R</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
and where <italic>x</italic><sub><italic>j</italic></sub> is the <italic>j</italic><sup><italic>th</italic></sup> voxel of the reconstructed image, containing a total of <italic>N</italic> voxels, and where <italic>R</italic><sub><italic>j</italic></sub> is the <italic>j</italic><sup><italic>th</italic></sup> voxel of a normalized reference image. In this work, the normalized reference image <italic>R</italic> is the highest quality reconstruction of each object (i.e. with no added noise), whose intensities were scaled to the 0 to 1 range. In other words, <italic>R</italic> acts as a soft mask for the overall CNR computation. The variable <inline-formula id="pone.0152597.e028"><alternatives><graphic id="pone.0152597.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, then, represents a weighted average of the reconstructed image, estimating the average of the images’ foreground. To compute the average background value, we similarly define
<disp-formula id="pone.0152597.e029"><alternatives><graphic id="pone.0152597.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where the weights (1 − <italic>R</italic><sub><italic>j</italic></sub>) weight in favor of the background regions. Lastly, we use the weighted standard deviation
<disp-formula id="pone.0152597.e030"><alternatives><graphic id="pone.0152597.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msqrt><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula></p>
<p>Note that Eqs <xref ref-type="disp-formula" rid="pone.0152597.e027">15</xref>, <xref ref-type="disp-formula" rid="pone.0152597.e029">16</xref> and <xref ref-type="disp-formula" rid="pone.0152597.e030">17</xref> are simply weighted extensions of the standard definitions for the mean (<inline-formula id="pone.0152597.e031"><alternatives><graphic id="pone.0152597.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) and standard deviation (<inline-formula id="pone.0152597.e032"><alternatives><graphic id="pone.0152597.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0152597.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mi>σ</mml:mi> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>). For purely binary (’hard’) masks <italic>R</italic>, where the intensity values are either 0 or 1, the definitions revert to their standard forms [<xref ref-type="bibr" rid="pone.0152597.ref048">48</xref>]. Lastly, for the sake of consistency, we used the same mask for all reconstructions of a particular object, regardless of noise level or deconvolution method. This mask was obtained for each subject by computing the mean of the normalized reference images obtained by using each of the deconvolution methods.</p>
</sec>
</sec>
<sec id="sec015" sec-type="results">
<title>Results</title>
<p>In the following sections, we optimize the Wiener and Tikhonov filters’ parameters and compare the performance of all three deconvolution methods. At this point, we note that the computational expense was comparable for each of the three deconvolution methods. The times to deconvolve pressure data from 180 views were 1.6, 3.2 and 1.9 seconds for the Fourier division, Wiener and Tikhonov approaches, respectively. The longer computation time for the Wiener filter stems from the fact that it uses a preliminary Fourier division deconvolution to estimate the total power in the signal power density function <italic>S</italic>(<italic>f</italic>).</p>
<sec id="sec016">
<title>Filter parameter optimization</title>
<p>In this section, we characterize the performance of the deconvolution filters under changing parameter values in both the projection domain and the image domain. In the former, we characterize the frequency response of the deconvolution of recorded ultrasound data; in the latter, we perform an analysis of noise versus resolution in the image domain after backprojection.</p>
<sec id="sec017">
<title>Projection domain</title>
<sec id="sec018">
<title>Fourier filter</title>
<p>For the sake of comparison with the Wiener and Tikhonov filters, we began by examining the Fourier filter’s performance when deconvolving pressure signals from a pencil point source. Note though that our Fourier filter design in <xref ref-type="disp-formula" rid="pone.0152597.e005">Eq 3</xref> did not contain any scalable parameters. <xref ref-type="fig" rid="pone.0152597.g007">Fig 7(a) and 7(b)</xref> shows the average frequency spectrum of the Fourier deconvolved pencil point signals, as well as a maximum intensity projection of the reconstructed pencil lead. The normalized correlation coefficient obtained for the Fourier deconvolution filter was <italic>C</italic> = 0.6620.</p>
<fig id="pone.0152597.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Frequency spectra of deconvolved pencil point signals, filter parameter optimization, and maximum intensity projections (MIP).</title>
<p>(a-b) Average Fourier spectrum of the deconvolved pencil point signals, and MIP, using Fourier filter. The normalized correlation coefficient (NCC) <italic>C</italic> is equal to 0.6620. (c-e) Wiener filter example spectra and normalized correlation coefficients. ‘Orig’ stands for the average frequency spectrum before deconvolution. The maximum NCC value was achieved as <italic>σ</italic> tended to infinity (uniform distribution), with <italic>C</italic> tending to 0.733. Note that convergence was already reached for values of <italic>σ</italic> ≈ 20MHz and above. (f-h) Tikhonov filter example spectra and normalized correlation coefficients. Maximum NCC achieved at <italic>β</italic> = 125 and <italic>C</italic> = 0.7914. The image intensities of the reconstructions are normalized (black: 0, white: 1), and the dimensions of the MIP images are 10 × 10 mm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec019">
<title>Wiener: optimization of the parameter <italic>σ</italic></title>
<p>
<xref ref-type="fig" rid="pone.0152597.g007">Fig 7(c)–7(e)</xref> show the results of the normalized correlation coefficient analysis for the Wiener filter, namely example frequency spectra, the normalized correlation coefficient (NCC) curve as a function of <italic>σ</italic> (where <italic>σ</italic> is as defined in the Methods section), and a maximum intensity projection of the pencil lead reconstruction at <italic>σ</italic> = 10,000 MHz. In <xref ref-type="fig" rid="pone.0152597.g007">Fig 7(c)</xref>, we observe that the curves expand from left to right as <italic>σ</italic> increases, and that the curves converge around <italic>σ</italic> = 20MHz and above. The values of <italic>σ</italic> in <xref ref-type="fig" rid="pone.0152597.g007">Fig 7(c)</xref> were chosen to illustrate this trend with roughly equally spaced curves. All curves for <italic>σ</italic> = 20MHz or above converged onto the cyan curve shown in the plot. As shown in <xref ref-type="fig" rid="pone.0152597.g007">Fig 7(d)</xref>, the NCC curve converges to an optimal value of C = 0.733 for <italic>σ</italic>’s greater than ∼20 MHz. We decided to use a value of 10,000 MHz in all of our further reconstructions, but note that we could have also used any other value above the convergence point of the NCC curve, such as 100MHz as 1,000 MHz; the image quality was insensitive to the value of <italic>σ</italic> as soon as it surpassed 20MHz. Figure A in <xref ref-type="supplementary-material" rid="pone.0152597.s001">S1 File</xref> (supporting information to this paper) confirms that this optimal value holds for the other imaging subjects as well, by showing image reconstructions as a function of <italic>σ</italic>. Note that as <italic>σ</italic> tends to infinity, <italic>S</italic>(<italic>f</italic>) tends towards a uniform distribution. As explained in the Methods section, the area under the Gaussian curve between the frequency range <italic>f</italic> = 0 MHz and <italic>f</italic><sub><italic>Nyquist</italic></sub> = 10 MHz is scaled to one before further scaling by the total expected power. This prevents the area under the Gaussian curve between <italic>f</italic> = 0 MHz and <italic>f</italic><sub><italic>Nyquist</italic></sub> = 10 MHz from tending to zero as <italic>σ</italic> tends to infinity.</p>
</sec>
<sec id="sec020">
<title>Tikhonov: optimization of the parameter <italic>β</italic></title>
<p>Mirroring the section above, <xref ref-type="fig" rid="pone.0152597.g007">Fig 7(f)–7(h)</xref> show example spectra as well as the resulting normalized correlation coefficients for the Tikhonov filter as a function of <italic>β</italic>. The optimal value was determined to occur at <italic>β</italic> = 125, yielding <italic>C</italic> = 0.7914. Figure B in <xref ref-type="supplementary-material" rid="pone.0152597.s001">S1 File</xref> confirms that this optimal value holds for the other imaging subjects as well, by showing image reconstructions as a function of <italic>β</italic>.</p>
</sec>
</sec>
<sec id="sec021">
<title>Image domain</title>
<p>Next, we computed noise versus resolution curves by analyzing reconstructions of the pencil point phantom when using the various filters and parameter values. The curves are shown in <xref ref-type="fig" rid="pone.0152597.g008">Fig 8</xref>. Note that <xref ref-type="fig" rid="pone.0152597.g008">Fig 8</xref> also shows results for the Tikhonov filter with a circular convolution matrix (i.e. the scanner impulse response <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) is assumed to wrap around the edges of the recorded signals). This allows us to assess whether the differences between the Tikhonov (matrix) approach and Fourier/Wiener approaches are mainly due to the different regularization of the deconvolved signals, or simply due to the difference between the non-periodic (non-circular) and periodic (circular) boundary conditions of the matrix and Fourier/Wiener methods. The noise was measured by computing the sum of squared differences between neighboring pixels in a background patch, normalized by the sum of the squares of the intensities in that patch. The background patch was defined as any image region at least 2 mm away from the center of the pencil point. As explained in the Deconvolution filter parameter optimization section, the resolution was measured by fitting 1D Gaussians to line profiles through the reconstructed pencil point, and determining the full width at half maximum (FWHM).</p>
<fig id="pone.0152597.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Noise (measured by NSSD) versus resolution (measured by FWHM) curves for various filter choices and parameter settings.</title>
<p>The parameter <italic>σ</italic> is expressed in MHz; the parameter <italic>β</italic> is unitless.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g008" xlink:type="simple"/>
</fig>
<p>The curves reveal the expected trade-off between noise and resolution: the more smoothing is applied by a deconvolution method, the lower the noise in the reconstructed image, but also the lower the image resolution. The Wiener and Tikhonov methods achieve similar resolutions (FWHMs), but the Tikhonov methods display superior noise suppression. Hence we can consider the Tikhonov methods (with both circular and non-circular convolution models) to outperform the Wiener filter. The Fourier filter produces the poorest FWHM and therefore the blurriest image reconstructions, albeit with the benefit of achieving the lowest image noise levels. In summary, the Tikhonov filter gave the best performance, followed by the Wiener filter and then the Fourier filter. As for the importance of the circular versus non-circular convolution model in the Tikhonov filter, its choice does not appear to substantially impact the filters’ performance. Hence, the difference between the Tikhonov versus Fourier and Wiener filters appears to be the result of the difference in regularization, rather than the difference in their circular versus non-circular convolution models. Finally, note that both the Wiener and Tikhonov curves converge onto a single point as <italic>σ</italic> and <italic>β</italic> increase to infinity, hence limiting their best case FWHM and worst case noise amplification.</p>
</sec>
<sec id="sec022">
<title>Parameter optimization summary</title>
<p>The Tikhonov method was found to achieve the most faithful balance of lower and higher frequencies of all three methods, as measured by the highest normalized correlation coefficient of <italic>C</italic> = 0.7914 at <italic>β</italic> = 125 (see Projection domain section). It also achieved a desirable noise versus resolution performance in the image domain (see <xref ref-type="fig" rid="pone.0152597.g008">Fig 8</xref>). Following these results, we decided to use <italic>β</italic> = 125 for all Tikhonov image reconstructions shown below. For the Wiener filter, the most faithful balance of lower and higher frequencies was achieved for <italic>σ</italic>’s greater than 100 MHz. Combining the results of the Projection domain section and <xref ref-type="fig" rid="pone.0152597.g008">Fig 8</xref>, we decided to use <italic>σ</italic> = 10,000 MHz for all reconstructions shown below. This value yielded a desirable NCC metric of <italic>C</italic> = 0.733 and an image resolution close to the highest observed. This choice does compromise on noise amplification, but this was found not to be problematic in any of our Wiener image reconstructions under standard scanning conditions. In other words, the optimal frequency balance and high image resolution was prioritized over noise suppression. Lastly, the Fourier filter performed poorest in both the projection and image domains.</p>
</sec>
</sec>
<sec id="sec023">
<title>Comparison of image reconstructions</title>
<p>In this section, we compare the image quality obtained by each deconvolution method for each of the four imaging subjects, using the optimal parameter values selected above. All imaging subjects were scanned using 180 views and 100 pulses per view. These settings provided a desirable trade-off between (a) reduced streak artifacts (due to higher geometric sampling density) as well as better signal to noise ratios (due to greater signal averaging) and (b) longer scan times, where more views and pulses per view require longer scan times given the fixed rate at which the laser fires its pulses (20 times per second). At 180 views and 100 pulses per view, scan times were approximately 15 minutes. For most of our imaging subjects, increasing the settings beyond 180 views and 100 pulses did not yield noticeable improvements in image quality. The one exception was the mouse brain scan, which was performed with 400 pulses per view. This was done to maintain a high signal to noise ratio despite the fact that the brain’s photoacoustic signal was relatively weak due to the absence of blood.</p>
<p>All reconstructions are shown in <xref ref-type="fig" rid="pone.0152597.g009">Fig 9</xref>. The first and second rows show maximum intensity projections (MIP) of the dot and vessel phantoms. The third row shows MIP images of the reconstructed mouse tumor. The highly vascularized nature of the subcutaneous tumor, as well as the tortuous nature of the blood vessels, is clearly discernable. The drop-off in intensity near the edges of the dot phantom, vessel phantom and tumor vasculature is due to the non-uniform illumination by the laser light, and the absence of light fluence compensation in the backprojection algorithm. Next, the fourth row shows a slice through the mouse brain as reconstructed with each deconvolution method. We opted to show slices rather than MIP images for this particular scan because the slices better visualized the fine structures present in the brain. The right-most column of <xref ref-type="fig" rid="pone.0152597.g009">Fig 9</xref> shows intensity profiles through selected features in each of the reconstructions. The locations of the intensity profiles are indicated by red lines in the images. The intensity profiles were used to estimate the full width at half maximum (FWHM) and contrast-to-noise ratio (CNR) of the features. For the brain, we computed the FWM and CNR for the third linear structure from the left that crosses the intensity profile. This structure is indicated by red arrows in the Wiener reconstructed image as well as the brain’s intensity profile plot, and was located approximately 2.5 mm below the surface of the brain.</p>
<fig id="pone.0152597.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Reconstructions by each deconvolution method.</title>
<p>First row: dot phantom. Second row: vessel phantom. Third row: subcutaneous mouse tumor. Fourth row: mouse brain. First column: Fourier filter. Second column: Wiener filter. Third column: Tikhonov method. Fourth column: illustrative line profiles. The image intensities of the reconstructions are normalized (black: 0, white: 1), and the dimensions of the MIP images are 20 × 20 mm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g009" xlink:type="simple"/>
</fig>
<p>Qualitatively, the image reconstructions by the Fourier method appear slightly blurrier than those by the Wiener and Tikhonov methods. This can be appreciated in the images as well as the intensity profiles, and is confirmed by the FWHM estimates in <xref ref-type="fig" rid="pone.0152597.g010">Fig 10(a)</xref>. The blurrier appearance of the Fourier reconstructions is due to the underrepresentation of low frequencies in the scanner impulse response <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) (due to the band-pass nature of the transducer and hence underrepresentation of low frequencies in the transducer impulse response <italic>h</italic><sub><italic>t</italic></sub>(<italic>t</italic>)—see <xref ref-type="fig" rid="pone.0152597.g003">Fig 3</xref>). As a result, the Fourier division technique disproportionately boosts lower frequencies in the data space, and consequently in the image space after backprojection. Stated differently, any small and poorly measured magnitudes in the low frequencies of the transducer response end up magnifying the equally poorly measured low frequencies in the recorded signal. As a result, the amplified lower frequencies lead to blurrier image appearances. Note that the higher frequencies in the deconvolved signals tend to be overly amplified as well, due to a similar underrepresentation of higher frequencies in the scanner impulse response <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>). However, this effect is mitigated by the standard practice of applying a high-frequency suppressing filter (see <xref ref-type="sec" rid="sec002">Methods</xref> section) after the Fourier division. While a similar regularization could be applied at lower frequencies, such measures would lead us further away from applying a standard Fourier division deconvolution. Our purpose is to compare the performance of the standard Fourier division deconvolution to alternative methods, namely the Wiener and Tikhonov deconvolution methods. Next, we observe that the difference between the three deconvolution methods is most pronounced for the mouse brain. This is likely due to the fact that the spherical projections of the brain possess more lower frequency content than those of the other imaging subjects. This enables a more obvious demonstration of the difference in the frequency balancing by the various methods. Note in particular that the Tikhonov filter appears to achieve a superior balance between high and low spatial frequencies compared to the Fourier and (admittedly similar) Wiener filters. This observation agrees with the prediction made in the “Tikhonov: optimization of the parameter <italic>β</italic>” section.</p>
<fig id="pone.0152597.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g010</object-id>
<label>Fig 10</label>
<caption>
<title>FHWM and CNR of various linear features by the three deconvolution methods.</title>
<p>The ground truth FWHM is known only for the artificial phantoms.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g010" xlink:type="simple"/>
</fig>
<p>For a more quantitative assessment of the reconstructions, we computed the FWHM and CNR of the features shown in the intensity profiles in the right column of <xref ref-type="fig" rid="pone.0152597.g009">Fig 9</xref>. <xref ref-type="fig" rid="pone.0152597.g010">Fig 10(a) and 10(b)</xref> show the FWHM and CNR values, respectively. For the FWHM results, we observe that the Wiener filter consistently gave the lowest FWHM, which were also closest to the ground truth when known. This indicates that the Wiener filter yielded the highest image resolution, which agrees with our results from the Image domain section and choice of <italic>σ</italic> in the Parameter optimization summary section. It also agrees with the qualitative impression in <xref ref-type="fig" rid="pone.0152597.g009">Fig 9</xref> that the Wiener filter emphasizes the higher frequency content more than the other two methods (in particular, the Wiener filter’s brain reconstruction arguably appears like a high-pass filtered version of the other two reconstructions). The second lowest FWHM values were produced by the Tikhonov filter. This was again to be expected from our choice of <italic>β</italic>, which trades off a faithful balance of frequencies with a slight loss in resolution (see Parameter optimization summary section). The Fourier filter produced the largest estimates, again agreeing with our previous observation that the Fourier filter yields blurrier reconstructions.</p>
<p>Next, the observed trends in the CNR values were not as consistent as those for the FWHM values. The Fourier filter gave the highest CNR for the dot phantom, yet the lowest for the other imaging subjects. However, the Fourier filter’s large CNR value for the dot phantom was caused by a much lower standard deviation of the background, not by a significantly higher contrast (peak-to-trough) value. Since the low standard deviation was due to the blurring effect of the Fourier method, the higher CNR by the Fourier filter did not necessarily correspond to a more desirable image. As for the performance of the other methods on the dot phantom, the Wiener method gave the lowest CNR due to some residual reconstruction artifacts between the dots. Given its high CNR and competitive FWHM, the Tikhonov reconstruction was judged to perform the best for this phantom. For the vessel phantom, the Tikhonov method provided the highest CNR, followed by the Wiener and then Fourier method. For the mouse tumor, the Fourier method’s CNR was again lowest, and the Tikhonov and Wiener method produced a nearly identical CNR. The combination of these results again favors the general use of the Tikhonov filter. Lastly, for the mouse brain reconstructions, the highest CNR was achieved by the Wiener filter, followed by the Tikhonov filter as a close second, and then the Fourier filter. The Wiener filter’s higher CNR was a direct result of a greater feature amplitude in the intensity profile. However, this was due solely to the choice of <italic>σ</italic> in the Wiener filter, favoring higher image resolutions (see Parameter optimization summary section). Hence the Tikhonov filter may still be preferable for its more accurate balancing of lower frequency contrast and higher frequency detail (higher NCC value in the “Tikhonov: optimization of the parameter <italic>β</italic>” section), despite its slightly lower CNR for this particular linear feature.</p>
<p>In summary, while the Wiener method produced slightly sharper images than the Tikhonov method, it did so at the cost of a poorer balance between lower and higher frequency content. In particular, it appeared to underrepresent the lower frequency content of the signals, and by consequence of the reconstructed images. In other words, the Tikhonov filter was deemed to give a better trade-off between image resolution and balancing of low and high frequency content. Note also that the frequency balancing by the Wiener filter could be improved by post-reconstruction low frequency boosting filtering (where frequency filtering is an acceptable and commonly used post-processing technique to improve the interpretability of images). However, we contend that the Tikhonov filter is preferable due to its more faithful frequency balancing <italic>before</italic> any post-processing steps.</p>
</sec>
<sec id="sec024">
<title>Sensitivity to noise</title>
<p>In this section, we measure the robustness to noise of each method by adding increasing levels of zero-mean Gaussian noise to the pressure signals. The standard deviation of the noise is expressed as a percentage of the maximum signal amplitude of the original pressure data. Figs <xref ref-type="fig" rid="pone.0152597.g011">11</xref>, <xref ref-type="fig" rid="pone.0152597.g012">12</xref>, <xref ref-type="fig" rid="pone.0152597.g013">13</xref> and <xref ref-type="fig" rid="pone.0152597.g014">14</xref> show reconstructions obtained with the three deconvolution methods for different levels of noise. The most obvious effect of the increasing noise levels is to gradually erode the fainter structures in the image; only the brightest features remain visible at the highest noise levels. Figs <xref ref-type="fig" rid="pone.0152597.g011">11</xref>, <xref ref-type="fig" rid="pone.0152597.g012">12</xref>, <xref ref-type="fig" rid="pone.0152597.g013">13</xref> and <xref ref-type="fig" rid="pone.0152597.g014">14</xref> also show that the overall CNR of the reconstructions degrades with increasing noise levels. Qualitatively, it can be appreciated that the Tikhonov filter appears to be most robust to the increasing noise levels for all objects. In particular, it visually performs similarly to the Wiener filter for the dot and vessel phantoms, clearly outperforms the Fourier and Wiener filters for the subcutaneous tumor, and arguably performs best for the mouse brain. The performance of the Wiener and Fourier filters, on the other hand, is more variable: the Wiener filter is more robust than the Fourier filter for the dot and vessel phantoms, but the Fourier filter is more robust than the Wiener filter for the subcutaneous tumor and mouse brain scans.</p>
<fig id="pone.0152597.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Robustness to noise of each deconvolution filter, as illustrated for the dot phantom.</title>
<p><italic>σ</italic> denotes the standard deviation of the zero-mean Gaussian noise added to the pressure signals, expressed as a percentage of the maximum pressure signal value. Each filter is used at its optimal setting, as determined in the Filter parameter optimization section. The line profiles in the right hand side column have been normalized. The image intensities of the reconstructions are normalized as well (black: 0, white: 1), and the dimensions of the MIP images are 20 × 20 mm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g011" xlink:type="simple"/>
</fig>
<fig id="pone.0152597.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Robustness to noise of each deconvolution filter, as illustrated for the vessel phantom.</title>
<p><italic>σ</italic> denotes the standard deviation of the zero-mean Gaussian noise added to the pressure signals, expressed as a percentage of the maximum pressure signal value. Each filter is used at its optimal setting, as determined in the Filter parameter optimization section. The image intensities of the reconstructions are normalized (black: 0, white: 1), and the dimensions of the MIP images are 20 × 20 mm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g012" xlink:type="simple"/>
</fig>
<fig id="pone.0152597.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Robustness to noise of each deconvolution filter, as illustrated for the vascularized subcutaneous mouse tumor.</title>
<p><italic>σ</italic> denotes the standard deviation of the zero-mean Gaussian noise added to the pressure signals, expressed as a percentage of the maximum pressure signal value. Each filter is used at its optimal setting, as determined in the Filter parameter optimization section. The image intensities of the reconstructions are normalized (black: 0, white: 1), and the dimensions of the MIP images are 20 × 20 mm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g013" xlink:type="simple"/>
</fig>
<fig id="pone.0152597.g014" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0152597.g014</object-id>
<label>Fig 14</label>
<caption>
<title>Robustness to noise of each deconvolution filter, as illustrated for the perfused and excised mouse brain.</title>
<p><italic>σ</italic> denotes the standard deviation of the zero-mean Gaussian noise added to the pressure signals, expressed as a percentage of the maximum pressure signal value. Each filter is used at its optimal setting, as determined in the Filter parameter optimization section. The image intensities of the reconstructions are normalized (black: 0, white: 1), and the dimensions of the MIP images are 20 × 20 mm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.g014" xlink:type="simple"/>
</fig>
<p>To obtain a more quantitative assessment of performance, we also estimated the overall CNR of the reconstructed images. As explained in the Simulation of noise in scan data section, we opted for a global CNR metric as it proved more robust than one computed from narrow intensity profiles at higher noise levels. Incidentally, note that the line profiles shown in Figs <xref ref-type="fig" rid="pone.0152597.g011">11</xref>, <xref ref-type="fig" rid="pone.0152597.g012">12</xref>, <xref ref-type="fig" rid="pone.0152597.g013">13</xref> and <xref ref-type="fig" rid="pone.0152597.g014">14</xref> are shown merely to enable qualitative assessment—they were not used as the basis for the CNR curves shown in panel (a) of each of the respective figures. As expected, the CNR degraded with increasing noise levels for all objects and all methods. For the dot phantom, the CNR by the Wiener filter was marginally higher than that by the Tikhonov filter at lower noise levels. However, the Tikhonov filter proved slightly more robust, showing a slower degradation in CNR as the noise level increased. The Tikhonov method also succeeded in rendering more dots than the Wiener method, as can be seen particularly in the bottom row of dots in the 8% noise reconstruction. The Fourier method clearly performed poorest at all noise levels, both visually and in terms of its CNR curve. For the vessel phantom, the Tikhonov and Wiener methods performed similarly, although the Tikhonov method’s CNR curve showed a slight advantage at lower noise levels. The Fourier method again showed the poorest robustness to the added noise. For the vascularized subcutaneous tumor, the Tikhonov filter was most robust in terms of both overall CNR and the qualitative image appearances, followed by the Fourier method in second place, and the Wiener filter in third.</p>
<p>Lastly, for the mouse brain, the soft mask approach for the overall CNR determination was arguably less meaningful than for the other subjects, since the distinction between foreground and background was less clear. Nonetheless, the trends seen in the CNR curves appear to agree with a qualitative assessment of the reconstructed images. The Tikhonov filter yielded the highest CNR at low noise levels, doing so to a noise level of about 6%, after which the Fourier filter took over. However, the higher CNR of the Fourier reconstructions was the result of noise suppression by excessive blurring. Hence the Tikhonov reconstructions were arguably preferable across the entire range of noise intensities. The Wiener filter clearly displayed the poorest noise amplification of the three methods.</p>
<p>In summary, the Tikhonov L-2 norm filter yielded the highest overall robustness to noise in the recorded pressure signals, as determined by both qualitative assessment of the images and the computed CNR curves.</p>
</sec>
</sec>
<sec id="sec025">
<title>Conclusions and Further Work</title>
<sec id="sec026">
<title>Conclusions</title>
<p>In this study, we compared the merits of three methods for deconvolving the pressure data prior to filtered backprojection in photoacoustic tomography. The methods were the classic Fourier division technique, the Wiener filter, and a Tikhonov L-2 norm regularized matrix inversion technique. We compared the final image quality achieved by each deconvolution technique, and evaluated each method’s robustness to noise. Using both qualitative and quantitative assessments, it was found that the Tikhonov filter achieved the most accurate balance of frequencies, a competitive image resolution and contrast-to-noise ratio, as well as the greatest robustness to noise. While the Wiener filter achieved a similar resolution, it tended to underrepresent the lower frequency content of the deconvolved signals. It was also less robust to noise in the recorded pressure signals. The performance of the Fourier filter was deemed to be the poorest, based on the reconstructed images’ lowest resolution (blurriest appearance), generally lowest contrast-to-noise ratio, as well as lowest robustness to noise. These trends were observed across imaging subjects of various appearances. Overall, the Tikhonov filter was deemed to produce the most desirable image reconstructions. Lastly, the results presented in this work demonstrate that the final photoacoustic image quality is highly dependent on the particular method used for signal deconvolution, as well as its proper optimization.</p>
</sec>
<sec id="sec027">
<title>Further work</title>
<p>In future work, we aim to examine whether post-reconstruction boosting of lower frequency content could optimize the lower frequency content versus image resolution trade-off of the Wiener deconvolution filter. We also aim to investigate additional deconvolution methods such as Kalman filters, L-1 norm regularized deconvolution, and non-negativity constrained matrix deconvolution. We also note that the deconvolution operation is an integral part of reconstruction algorithms other than filtered backprojection as well, for example iterative reconstruction methods. Hence, we aim to examine the effect of different deconvolution schemes (such as the Fourier, Tikhonov, Wiener, and Kalman filters) on the performance of such alternative reconstruction algorithms as well.</p>
</sec>
</sec>
<sec id="sec028">
<title>Supporting Information</title>
<supplementary-material id="pone.0152597.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0152597.s001" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Filter parameter optimization.</title>
<p><bold>Figure A, Image reconstructions with Wiener deconvolution for different values of <italic>σ</italic></bold>. Note that the brain slice appears shrunken without signal deconvolution. This is because the deconvolution also corrects for a slight time delay between the true arrival of the pressure waves at the detector surface and the actual pressure signal recorded by the scanner. This delay was present in all scans equally, including the scan in which the scanner impulse response function <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) was measured. Without the deconvolution’s correction for this time delay, the backprojected signals are slightly shifted and misaligned in space. This misalignment in turn results in the shrunken appearance of the reconstructed brain slice. The spatial location of the brain slice within the reconstructed volume is identical for all reconstructions shown. The image intensities of the reconstructions are normalized (black: 0, white: 1), and the dimensions of the MIP images are 20 × 20 mm. <bold>Figure B, Image reconstructions with Tikhonov deconvolution for different values of <italic>β</italic></bold>. Note that the brain slice appears shrunken without signal deconvolution. This is because the deconvolution also corrects for a slight time delay between the true arrival of the pressure waves at the detector surface and the actual pressure signal recorded by the scanner. This delay was present in all scans equally, including the scan in which the scanner impulse response function <italic>p</italic><sub><italic>d</italic>0</sub>(<italic>t</italic>) was measured. Without the deconvolution’s correction for this time delay, the backprojected signals are slightly shifted and misaligned in space. This misalignment in turn results in the shrunken appearance of the reconstructed brain slice. The spatial location of the brain slice within the reconstructed volume is identical for all reconstructions shown. The image intensities of the reconstructions are normalized (black: 0, white: 1), and the dimensions of the MIP images are 20 × 20 mm.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Dr. Van de Sompel was supported by a Susan G. Komen postdoctoral fellowship, as well as the Molecular Imaging Program at Stanford (MIPS). Dr. Jokerst is grateful for fellowship support from the Stanford Molecular Imaging Scholars Program SMIS R25-T CA118681, and acknowledges the NIH Loan Repayment Program. This work is also funded in part by the National Cancer Institute CCNE U54 CA119367 (S.S.G.) and In Vivo Cancer Molecular Imaging Center ICMIC P50 CA114747 (S.S.G.). Lastly, we would like to acknowledge funding for the Gambhir laboratory from NCI ICMIC P50CA114747, NCI CCNE-T U54 U54CA151459, the Doris Duke Foundation, Canary Foundation, Ben and Catherine Ivy Foundation, and the Sir Peter Michael Foundation.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0152597.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yokoo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fry</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>. <article-title>Photoacoustic tomography of biological tissues with high cross-section resolution: Reconstruction and experiment</article-title>. <source>Medical physics</source>. <year>2002</year>;<volume>29</volume>:<fpage>2799</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1118/1.1521720" xlink:type="simple">10.1118/1.1521720</ext-link></comment> <object-id pub-id-type="pmid">12512713</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ku</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Stoica</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>. <article-title>Imaging of tumor angiogenesis in rat brains in vivo by photoacoustic tomography</article-title>. <source>Applied optics</source>. <year>2005</year>;<volume>44</volume>(<issue>5</issue>):<fpage>770</fpage>–<lpage>775</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1364/AO.44.000770" xlink:type="simple">10.1364/AO.44.000770</ext-link></comment> <object-id pub-id-type="pmid">15751858</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ermilov</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Brecht</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Oraevsky</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Anastasio</surname> <given-names>MA</given-names></name>. <article-title>An Imaging Model Incorporating Ultrasonic Transducer Properties for Three-Dimensional Optoacoustic Tomography</article-title>. <source>Medical Imaging, IEEE Transactions on</source>. <year>2011</year>;(<issue>2</issue>):<fpage>203</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TMI.2010.2072514" xlink:type="simple">10.1109/TMI.2010.2072514</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Razansky</surname> <given-names>D</given-names></name>. <article-title>Multi-Spectral Optoacoustic Tomography?? Volumetric Color Hearing in Real Time</article-title>. <source>Selected Topics in Quantum Electronics, IEEE Journal of</source>. <year>2011</year>;(<issue>99</issue>):<fpage>1</fpage>–<lpage>1</lpage>.</mixed-citation>
</ref>
<ref id="pone.0152597.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gamelin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Aguirre</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Maurudis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Castillo</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>, <etal>et al</etal>. <article-title>Curved array photoacoustic tomographic system for small animal imaging</article-title>. <source>Journal of biomedical optics</source>. <year>2008</year>;<volume>13</volume>:<fpage>024007</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1117/1.2907157" xlink:type="simple">10.1117/1.2907157</ext-link></comment> <object-id pub-id-type="pmid">18465970</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yin</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>Q</given-names></name>. <article-title>Fast photoacoustic imaging system based on 320-element linear transducer array</article-title>. <source>Physics in medicine and biology</source>. <year>2004</year>;<volume>49</volume>:<fpage>1339</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0031-9155/49/7/019" xlink:type="simple">10.1088/0031-9155/49/7/019</ext-link></comment> <object-id pub-id-type="pmid">15128209</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kruger</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Kiser</surname> <given-names>WL</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Reinecke</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Kruger</surname> <given-names>GA</given-names></name>. <article-title>Thermoacoustic computed tomography using a conventional linear transducer array</article-title>. <source>Medical physics</source>. <year>2003</year>;<volume>30</volume>:<fpage>856</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1118/1.1565340" xlink:type="simple">10.1118/1.1565340</ext-link></comment> <object-id pub-id-type="pmid">12772993</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Xiang</surname> <given-names>LZ</given-names></name>. <article-title>Fast full-view photoacoustic imaging by combined scanning with a linear transducer array</article-title>. <source>Optics Express</source>. <year>2007</year>;<volume>15</volume>(<issue>23</issue>):<fpage>15566</fpage>–<lpage>15575</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1364/OE.15.015566" xlink:type="simple">10.1364/OE.15.015566</ext-link></comment> <object-id pub-id-type="pmid">19550843</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kruger</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Appledorn</surname> <given-names>CR</given-names></name>. <article-title>Photoacoustic ultrasound (PAUS)reconstruction tomography</article-title>. <source>Medical physics</source>. <year>1995</year>;<volume>22</volume>:<fpage>1605</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1118/1.597429" xlink:type="simple">10.1118/1.597429</ext-link></comment> <object-id pub-id-type="pmid">8551984</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hoelen</surname> <given-names>CGA</given-names></name>, <name name-style="western"><surname>de Mul</surname> <given-names>FFM</given-names></name>. <article-title>Image reconstruction for photoacoustic scanning of tissue structures</article-title>. <source>Applied Optics</source>. <year>2000</year>;<volume>39</volume>(<issue>31</issue>):<fpage>5872</fpage>–<lpage>5883</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1364/AO.39.005872" xlink:type="simple">10.1364/AO.39.005872</ext-link></comment> <object-id pub-id-type="pmid">18354591</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Laufer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Beard</surname> <given-names>P</given-names></name>. <article-title>Backward-mode multiwavelength photoacoustic scanner using a planar Fabry-Perot polymer film ultrasound sensor for high-resolution three-dimensional imaging of biological tissues</article-title>. <source>Applied optics</source>. <year>2008</year>;<volume>47</volume>(<issue>4</issue>):<fpage>561</fpage>–<lpage>577</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1364/AO.47.000561" xlink:type="simple">10.1364/AO.47.000561</ext-link></comment> <object-id pub-id-type="pmid">18239717</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vaithilingam</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Furukawa</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wygant</surname> <given-names>IO</given-names></name>, <name name-style="western"><surname>Xuefeng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>De La Zerda</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Three-dimensional photoacoustic imaging using a two-dimensional CMUT array</article-title>. <source>Ultrasonics, Ferroelectrics and Frequency Control, IEEE Transactions on</source>. <year>2009</year>;<volume>56</volume>(<issue>11</issue>):<fpage>2411</fpage>–<lpage>2419</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TUFFc.2009.1329" xlink:type="simple">10.1109/TUFFc.2009.1329</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Manohar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kharine</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>van Hespen</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Steenbergen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>van Leeuwen</surname> <given-names>TG</given-names></name>. <article-title>The Twente Photoacoustic Mammoscope: system overview and performance</article-title>. <source>Physics in medicine and biology</source>. <year>2005</year>;<volume>50</volume>(<issue>11</issue>):<fpage>2543</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0031-9155/50/11/007" xlink:type="simple">10.1088/0031-9155/50/11/007</ext-link></comment> <object-id pub-id-type="pmid">15901953</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kruger</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Reynolds</surname> <given-names>HE</given-names></name>, <name name-style="western"><surname>Kiser</surname> <given-names>WL</given-names></name>, <name name-style="western"><surname>Reinecke</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Kruger</surname> <given-names>GA</given-names></name>. <article-title>Breast Cancer in Vivo: Contrast Enhancement with Thermoacoustic CT at 434 MHzFeasibility Study</article-title>. <source>Radiology</source>. <year>2000</year>;<volume>216</volume>(<issue>1</issue>):<fpage>279</fpage>–<lpage>283</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1148/radiology.216.1.r00jl30279" xlink:type="simple">10.1148/radiology.216.1.r00jl30279</ext-link></comment> <object-id pub-id-type="pmid">10887262</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kruger</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Lam</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Reinecke</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Del Rio</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Doyle</surname> <given-names>RP</given-names></name>. <article-title>Photoacoustic angiography of the breast</article-title>. <source>Med Phys</source>. <year>2010</year>;<volume>37</volume>(<issue>11</issue>):<fpage>6096</fpage>–<lpage>6100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1118/1.3497677" xlink:type="simple">10.1118/1.3497677</ext-link></comment> <object-id pub-id-type="pmid">21158321</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brecht</surname> <given-names>HP</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Fronheiser</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ermilov</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Conjusteau</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Oraevsky</surname> <given-names>AA</given-names></name>. <article-title>Whole-body three-dimensional optoacoustic tomography system for small animals</article-title>. <source>Journal of biomedical optics</source>. <year>2009</year>;<volume>14</volume>(<issue>6</issue>):<fpage>064007</fpage>–<lpage>064007</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1117/1.3259361" xlink:type="simple">10.1117/1.3259361</ext-link></comment> <object-id pub-id-type="pmid">20059245</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Finch</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Patch</surname> <given-names>S</given-names></name>. <article-title>Determining a function from its mean values over a family of spheres</article-title>. <source>SIAM J Math Anal</source>. <year>2004</year>;<volume>35</volume>(<issue>5</issue>):<fpage>1213</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/S0036141002417814" xlink:type="simple">10.1137/S0036141002417814</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kunyansky</surname> <given-names>LA</given-names></name>. <article-title>Explicit inversion formulae for the spherical mean Radon transform</article-title>. <source>Inverse Problems</source>. <year>2007</year>;<volume>23</volume>:<fpage>373</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0266-5611/23/1/021" xlink:type="simple">10.1088/0266-5611/23/1/021</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>. <article-title>Universal back-projection algorithm for photoacoustic computed tomography</article-title>. <source>Physical Review E</source>. <year>2005</year>;<volume>71</volume>(<issue>1</issue>):<fpage>016706</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.71.016706" xlink:type="simple">10.1103/PhysRevE.71.016706</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>. <article-title>Photoacoustic imaging in biomedicine</article-title>. <source>Review of scientific instruments</source>. <year>2006</year>;<volume>77</volume>:<fpage>041101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.2195024" xlink:type="simple">10.1063/1.2195024</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>. <article-title>Time reversal and its application to tomography with diffracting sources</article-title>. <source>Physical review letters</source>. <year>2004</year>;<volume>92</volume>(<issue>3</issue>):<fpage>33902</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.92.033902" xlink:type="simple">10.1103/PhysRevLett.92.033902</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hristova</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kuchment</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>L</given-names></name>. <article-title>Reconstruction and time reversal in thermoacoustic tomography in acoustically homogeneous and inhomogeneous media</article-title>. <source>Inverse Problems</source>. <year>2008</year>;<volume>24</volume>:<fpage>055006</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0266-5611/24/5/055006" xlink:type="simple">10.1088/0266-5611/24/5/055006</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Treeby</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>EZ</given-names></name>, <name name-style="western"><surname>Cox</surname> <given-names>B</given-names></name>. <article-title>Photoacoustic tomography in absorbing acoustic media using time reversal</article-title>. <source>Inverse Problems</source>. <year>2010</year>;<volume>26</volume>:<fpage>115003</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0266-5611/26/11/115003" xlink:type="simple">10.1088/0266-5611/26/11/115003</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Beard</surname> <given-names>P</given-names></name>. <article-title>Biomedical photoacoustic imaging</article-title>. <source>Interface Focus</source>. <year>2011</year>;<volume>1</volume>(<issue>4</issue>):<fpage>602</fpage>–<lpage>631</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsfs.2011.0028" xlink:type="simple">10.1098/rsfs.2011.0028</ext-link></comment> <object-id pub-id-type="pmid">22866233</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref025">
<label>25</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Burgholzer</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Berer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Grün</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Nuster</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Paltauf</surname> <given-names>G</given-names></name>. <chapter-title>Spatial resolution and sensitivity in photoacoustic tomography taking noise into account: from point-like detectors to large integrating detectors</chapter-title>. In: <source>Proceedings of SPIE</source>. <volume>vol. 8223</volume>; <year>2012</year>. p. <fpage>822321</fpage>.</mixed-citation>
</ref>
<ref id="pone.0152597.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Paltauf</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Viator</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Prahl</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jacques</surname> <given-names>S</given-names></name>. <article-title>Iterative reconstruction algorithm for optoacoustic imaging</article-title>. <source>The Journal of the Acoustical Society of America</source>. <year>2002</year>;<volume>112</volume>:<fpage>1536</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1121/1.1501898" xlink:type="simple">10.1121/1.1501898</ext-link></comment> <object-id pub-id-type="pmid">12398460</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jetzfellner</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Razansky</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rosenthal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schulz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Englmeier</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Ntziachristos</surname> <given-names>V</given-names></name>. <article-title>Performance of iterative optoacoustic tomography with experimental data</article-title>. <source>Applied Physics Letters</source>. <year>2009</year>;<volume>95</volume>:<fpage>013703</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.3167280" xlink:type="simple">10.1063/1.3167280</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Anastasio</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>La Rivière</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>. <article-title>Effects of Different Imaging Models on Least-Squares Image Reconstruction Accuracy in Photoacoustic Tomography</article-title>. <source>Medical Imaging, IEEE Transactions on</source>. <year>2009</year>;<volume>28</volume>(<issue>11</issue>):<fpage>1781</fpage>–<lpage>1790</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TMI.2009.2024082" xlink:type="simple">10.1109/TMI.2009.2024082</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosenthal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Razansky</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ntziachristos</surname> <given-names>V</given-names></name>. <article-title>Fast semi-analytical model-based acoustic inversion for quantitative optoacoustic tomography</article-title>. <source>Medical Imaging, IEEE Transactions on</source>. <year>2010</year>;<volume>29</volume>(<issue>6</issue>):<fpage>1275</fpage>–<lpage>1285</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TMI.2010.2044584" xlink:type="simple">10.1109/TMI.2010.2044584</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Provost</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lesage</surname> <given-names>F</given-names></name>. <article-title>The application of compressed sensing for photo-acoustic tomography</article-title>. <source>Medical Imaging, IEEE Transactions on</source>. <year>2009</year>;<volume>28</volume>(<issue>4</issue>):<fpage>585</fpage>–<lpage>594</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TMI.2008.2007825" xlink:type="simple">10.1109/TMI.2008.2007825</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Guo</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>. <article-title>Compressed sensing in photoacoustic tomography in vivo</article-title>. <source>Journal of biomedical optics</source>. <year>2010</year>;<volume>15</volume>:<fpage>021311</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1117/1.3381187" xlink:type="simple">10.1117/1.3381187</ext-link></comment> <object-id pub-id-type="pmid">20459233</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref032">
<label>32</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Oraevsky</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Anastasio</surname> <given-names>MA</given-names></name>. <chapter-title>Investigation of iterative image reconstruction in optoacoustic tomography</chapter-title>. In: <source>Proceedings of SPIE</source>. <volume>vol. 8223</volume>; <year>2012</year>. p. <fpage>82231Y</fpage>.</mixed-citation>
</ref>
<ref id="pone.0152597.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>. <article-title>Photoacoustic tomography and sensing in biomedicine</article-title>. <source>Physics in medicine and biology</source>. <year>2009</year>;<volume>54</volume>(<issue>19</issue>):<fpage>R59</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0031-9155/54/19/R01" xlink:type="simple">10.1088/0031-9155/54/19/R01</ext-link></comment> <object-id pub-id-type="pmid">19724102</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zerda</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Galanzha</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Gambhir</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Zharov</surname> <given-names>VP</given-names></name>. <article-title>Advanced contrast nanoagents for photoacoustic molecular imaging, cytometry, blood test and photothermal theranostics</article-title>. <source>Contrast Media &amp; Molecular Imaging</source>. <year>2011</year>;<volume>6</volume>(<issue>5</issue>):<fpage>346</fpage>–<lpage>369</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/cmmi.455" xlink:type="simple">10.1002/cmmi.455</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>S</given-names></name>. <article-title>Photoacoustic tomography: in vivo imaging from organelles to organs</article-title>. <source>science</source>. <year>2012</year>;<volume>335</volume>(<issue>6075</issue>):<fpage>1458</fpage>–<lpage>1462</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1216210" xlink:type="simple">10.1126/science.1216210</ext-link></comment> <object-id pub-id-type="pmid">22442475</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>. <article-title>Fast and robust deconvolution-based image reconstruction for photoacoustic tomography in circular geometry: experimental validation</article-title>. <source>Photonics Journal, IEEE</source>. <year>2010</year>;<volume>2</volume>(<issue>1</issue>):<fpage>57</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/JPHOT.2010.2042801" xlink:type="simple">10.1109/JPHOT.2010.2042801</ext-link></comment> <object-id pub-id-type="pmid">20953277</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>Q</given-names></name>. <article-title>Photoacoustic imaging with deconvolution algorithm</article-title>. <source>Physics in medicine and biology</source>. <year>2004</year>;<volume>49</volume>:<fpage>3117</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0031-9155/49/14/006" xlink:type="simple">10.1088/0031-9155/49/14/006</ext-link></comment> <object-id pub-id-type="pmid">15357185</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gamelin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Maurudis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Aguirre</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LV</given-names></name>, <etal>et al</etal>. <article-title>A real-time photoacoustic tomography system for small animals</article-title>. <source>Optics express</source>. <year>2009</year>;<volume>17</volume>(<issue>13</issue>):<fpage>10489</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1364/OE.17.010489" xlink:type="simple">10.1364/OE.17.010489</ext-link></comment> <object-id pub-id-type="pmid">19550444</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref039">
<label>39</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Oraevsky</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Anastasio</surname> <given-names>MA</given-names></name>. <chapter-title>Sparsity regularized data-space restoration in optoacoustic tomography</chapter-title>. In: <source>Proceedings of SPIE</source>. <volume>vol. 8223</volume>; <year>2012</year>. p. <fpage>822322</fpage>.</mixed-citation>
</ref>
<ref id="pone.0152597.ref040">
<label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Wiener</surname> <given-names>N</given-names></name>. <source>The interpolation, extrapolation and smoothing of stationary time series</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>J Wiley</publisher-name>. <year>1949</year>;.</mixed-citation>
</ref>
<ref id="pone.0152597.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Balboa</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Grzywacz</surname> <given-names>NM</given-names></name>. <article-title>Power spectra and distribution of contrasts of natural images from different habitats</article-title>. <source>Vision research</source>. <year>2003</year>;<volume>43</volume>(<issue>24</issue>):<fpage>2527</fpage>–<lpage>2537</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0042-6989(03)00471-1" xlink:type="simple">10.1016/S0042-6989(03)00471-1</ext-link></comment> <object-id pub-id-type="pmid">13129540</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Burgholzer</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Matt</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Haltmeier</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Paltauf</surname> <given-names>G</given-names></name>. <article-title>Exact and approximative imaging methods for photoacoustic tomography using an arbitrary detection surface</article-title>. <source>Physical Review E</source>. <year>2007</year>;<volume>75</volume>(<issue>4</issue>):<fpage>046706</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.75.046706" xlink:type="simple">10.1103/PhysRevE.75.046706</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref043">
<label>43</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Tikhonov</surname> <given-names>AN</given-names></name>. <chapter-title>On the stability of inverse problems</chapter-title>. In: <source>Dokl. Akad. Nauk SSSR</source>. <volume>vol. 39</volume>; <year>1943</year>. p. <fpage>195</fpage>–<lpage>198</lpage>.</mixed-citation>
</ref>
<ref id="pone.0152597.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Van de Sompel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sasportas</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Dragulescu-Andrasi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bohndiek</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gambhir</surname> <given-names>SS</given-names></name>. <article-title>Improving image quality by accounting for changes in water temperature during a photoacoustic tomography scan</article-title>. <source>PloS ONE</source>. <year>2012</year>;<volume>7</volume>(<issue>10</issue>):<fpage>e45337</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0045337" xlink:type="simple">10.1371/journal.pone.0045337</ext-link></comment> <object-id pub-id-type="pmid">23071512</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mackenzie</surname> <given-names>KV</given-names></name>. <article-title>Nine-term equation for sound speed in the oceans</article-title>. <source>J Acoust Soc Am</source>. <year>1981</year>;<volume>70</volume>(<issue>3</issue>):<fpage>807</fpage>–<lpage>812</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1121/1.386920" xlink:type="simple">10.1121/1.386920</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Treeby</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Cox</surname> <given-names>BT</given-names></name>. <article-title>k-Wave: MATLAB toolbox for the simulation and reconstruction of photoacoustic wave fields</article-title>. <source>Journal of biomedical optics</source>. <year>2010</year>;<volume>15</volume>:<fpage>021314</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1117/1.3360308" xlink:type="simple">10.1117/1.3360308</ext-link></comment> <object-id pub-id-type="pmid">20459236</object-id></mixed-citation>
</ref>
<ref id="pone.0152597.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Geman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Geman</surname> <given-names>D</given-names></name>. <article-title>Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images</article-title>. <source>Pattern Analysis and Machine Intelligence, IEEE Transactions on</source>. <year>1984</year>;(<issue>6</issue>):<fpage>721</fpage>–<lpage>741</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TPAMI.1984.4767596" xlink:type="simple">10.1109/TPAMI.1984.4767596</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0152597.ref048">
<label>48</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ghahramani</surname> <given-names>S</given-names></name>. <source>Fundamentals of Probability</source> (<edition>2nd edition</edition>). <publisher-name>Prentice Hall</publisher-name>: <publisher-loc>New Jersey</publisher-loc>. <year>2000</year>;.</mixed-citation>
</ref>
</ref-list>
</back>
</article>