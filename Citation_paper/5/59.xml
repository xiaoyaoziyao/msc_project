<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0179106</article-id>
<article-id pub-id-type="publisher-id">PONE-D-17-12449</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Heredity</subject><subj-group><subject>Genetic mapping</subject><subj-group><subject>Variant genotypes</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Genotyping</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Genotyping</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Human genetics</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Genetic fingerprinting and footprinting</subject><subj-group><subject>Genetic fingerprinting</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Genetic fingerprinting and footprinting</subject><subj-group><subject>Genetic fingerprinting</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Developmental biology</subject><subj-group><subject>Twins</subject><subj-group><subject>Monozygotic twins</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject><subj-group><subject>Normal distribution</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Quickly identifying identical and closely related subjects in large databases using genotype data</article-title>
<alt-title alt-title-type="running-head">Quickly identifying closely related subjects using genotype data</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2499-8760</contrib-id>
<name name-style="western">
<surname>Jin</surname>
<given-names>Yumi</given-names>
</name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Schäffer</surname>
<given-names>Alejandro A.</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7982-076X</contrib-id>
<name name-style="western">
<surname>Sherry</surname>
<given-names>Stephen T.</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1650-5156</contrib-id>
<name name-style="western">
<surname>Feolo</surname>
<given-names>Michael</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>National Center for Biotechnology Information, National Library of Medicine, National Institutes of Health, Bethesda, Maryland, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Calafell</surname>
<given-names>Francesc</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Universitat Pompeu Fabra, SPAIN</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"> <list-item>
<p><bold>Conceptualization:</bold> YJ STS MF.</p></list-item> <list-item>
<p><bold>Data curation:</bold> YJ MF.</p></list-item> <list-item>
<p><bold>Formal analysis:</bold> YJ AAS.</p></list-item> <list-item>
<p><bold>Methodology:</bold> YJ.</p></list-item> <list-item>
<p><bold>Project administration:</bold> STS MF.</p></list-item> <list-item>
<p><bold>Software:</bold> YJ.</p></list-item> <list-item>
<p><bold>Supervision:</bold> STS MF.</p></list-item> <list-item>
<p><bold>Validation:</bold> YJ AAS STS MF.</p></list-item> <list-item>
<p><bold>Visualization:</bold> YJ STS.</p></list-item> <list-item>
<p><bold>Writing – original draft:</bold> YJ.</p></list-item> <list-item>
<p><bold>Writing – review &amp; editing:</bold> YJ AAS STS MF.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">jinyu@ncbi.nlm.nih.gov</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>13</day>
<month>6</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<year>2017</year>
</pub-date>
<volume>12</volume>
<issue>6</issue>
<elocation-id>e0179106</elocation-id>
<history>
<date date-type="received">
<day>3</day>
<month>4</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>10</day>
<month>5</month>
<year>2017</year>
</date>
</history>
<permissions>
<license xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">
<license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">Creative Commons CC0</ext-link> public domain dedication.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0179106"/>
<abstract>
<p>Genome-wide association studies (GWAS) usually rely on the assumption that different samples are not from closely related individuals. Detection of duplicates and close relatives becomes more difficult both statistically and computationally when one wants to combine datasets that may have been genotyped on different platforms. The dbGaP repository at the National Center of Biotechnology Information (NCBI) contains datasets from hundreds of studies with over one million samples. There are many duplicates and closely related individuals both within and across studies from different submitters. Relationships between studies cannot always be identified by the submitters of individual datasets. To aid in curation of dbGaP, we developed a rapid statistical method called Genetic Relationship and Fingerprinting (GRAF) to detect duplicates and closely related samples, even when the sets of genotyped markers differ and the DNA strand orientations are unknown. GRAF extracts genotypes of 10,000 informative and independent SNPs from genotype datasets obtained using different methods, and implements quick algorithms that enable it to find all of the duplicate pairs from more than 880,000 samples within and across dbGaP studies in less than two hours. In addition, GRAF uses two statistical metrics called All Genotype Mismatch Rate (AGMR) and Homozygous Genotype Mismatch Rate (HGMR) to determine subject relationships directly from the observed genotypes, without estimating probabilities of identity by descent (IBD), or kinship coefficients, and compares the predicted relationships with those reported in the pedigree files. We implemented GRAF in a freely available C++ program of the same name. In this paper, we describe the methods in GRAF and validate the usage of GRAF on samples from the dbGaP repository. Other scientists can use GRAF on their own samples and in combination with samples downloaded from dbGaP.</p>
</abstract>
<funding-group>
<funding-statement>This research was supported by the Intramural Research Program of the National Institutes of Health, National Library of Medicine.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="9"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Accession numbers to access data: phs000168.v2.p2 phs000397.v1.p1 phs000462.v2.p1 phs000763.v1.p1</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Genome-wide association studies (GWAS) have identified numerous associations between genotypes and complex clinical conditions and phenotypic traits. Thousands of research articles have been published; more than 20,000 single nucleotide polymorphisms (SNPs) have been identified to be associated with various human phenotypes and diseases [<xref ref-type="bibr" rid="pone.0179106.ref001">1</xref>]. Knowledge of any close relationships between individuals is crucial to the validity of the analysis results. Closely related individuals should not be used together in case-control and population based association studies [<xref ref-type="bibr" rid="pone.0179106.ref002">2</xref>–<xref ref-type="bibr" rid="pone.0179106.ref005">5</xref>]. Cryptic relatedness can increase both false positive and false negative rates [<xref ref-type="bibr" rid="pone.0179106.ref004">4</xref>,<xref ref-type="bibr" rid="pone.0179106.ref006">6</xref>]. Although genetic relatedness can be calculated from reported pedigree structures, these structures are often incomplete and incorrect due to unreported relationships, non-paternity, adoption or sample labeling errors [<xref ref-type="bibr" rid="pone.0179106.ref007">7</xref>,<xref ref-type="bibr" rid="pone.0179106.ref008">8</xref>]. Fortunately, pedigree errors and cryptic relatedness can be detected using genotype data obtained in GWAS studies.</p>
<p>Algorithms and software packages have been developed to determine the subject relationships using genotype data [<xref ref-type="bibr" rid="pone.0179106.ref002">2</xref>,<xref ref-type="bibr" rid="pone.0179106.ref009">9</xref>–<xref ref-type="bibr" rid="pone.0179106.ref017">17</xref>]. Most of the existing methods determine genetic relationships by estimating the genome-wide averages of the number of alleles shared identical by descent (IBD) and/or kinship coefficient between each pair of individuals, with computation complexities at least <italic>O(n</italic><sup><italic>2</italic></sup><italic>S)</italic>, where <italic>n</italic> is the number of samples, and <italic>S</italic> is the number of SNPs. These algorithms were not optimized to determine subject relationships in datasets with more than a few thousand samples. However, the establishment of centralized databases such as the database of Genotypes and Phenotypes (dbGaP) at the National Center for Biotechnology Information (NCBI) and the European Genome-phenome Archive (EGA) at European Bioinformatics Institute has made it possible for researchers to access genotypic data from millions of individuals.</p>
<p>Two novel aspects arise with large controlled access databases. First, users will obtain permission to access only subsets of the data. Second, different users will have access to different subsets. Therefore, it is desirable for the database owners to <italic>precompute</italic> all possible relationships among all datasets. Then, each user can be provided with the precomputed relationships among only those datasets retrieved. The duplicates and close relationships should be determined even when the individual datasets have genotypes obtained from different genotyping platforms.</p>
<p>Two types of methods are commonly used to determine genetic relationships between individuals based on molecular markers: maximum-likelihood estimation (MLE) [<xref ref-type="bibr" rid="pone.0179106.ref018">18</xref>–<xref ref-type="bibr" rid="pone.0179106.ref020">20</xref>] and method-of-moment estimation (MM) [<xref ref-type="bibr" rid="pone.0179106.ref008">8</xref>,<xref ref-type="bibr" rid="pone.0179106.ref013">13</xref>,<xref ref-type="bibr" rid="pone.0179106.ref021">21</xref>,<xref ref-type="bibr" rid="pone.0179106.ref022">22</xref>]. Both MLE and MM methods use the observed numbers of alleles shared identity by state (IBS) to estimate the IBD sharing probabilities or kinship coefficients. Milligan [<xref ref-type="bibr" rid="pone.0179106.ref023">23</xref>] compared the statistical performance of these two types of methods. The maximum-likelihood estimators always generate biologically meaningful probabilities and are usually more accurate than the method-of-moment estimators. However, maximum-likelihood approaches are usually slower and sometimes more biased than the method-of-moment ones. Method-of-moment methods usually use the observed numbers of IBS sharing loci instead of the predicted numbers when calculating IBD sharing probabilities, and hence may yield estimates that cannot be interpreted as probabilities, in which case, researchers truncate the estimates into the meaningful range [0, 1]. The truncation of the results introduces artificial effects and biases.</p>
<p>Besides the computational complexity, another limitation of the existing algorithms is that they can be applied only to genotype datasets obtained using the same genotyping method (i.e. various SNP arrays or sequencing assays). For a genotype repository, such as dbGaP, the submitted genotype datasets have been obtained using many different genotyping methods.</p>
<p>We have developed algorithms to extract genotypes of common SNPs from genotype datasets obtained using different methods, and developed these algorithms into a software package called GRAF (Genetic Relationship and Fingerprinting) to determine quickly the relationships between subjects originally genotyped in disparate studies. The algorithms and software described in this article were developed as quality control tools for dbGaP curators to check all studies prior to release, and find subject overlaps across dbGaP studies. GRAF can also be used by dbGaP submitters and users to find errors in the genotype datasets and pedigree files.</p>
<p>The GRAF algorithms and software were briefly presented at the 22nd Annual International Conference on Intelligent Systems for Molecular Biology [<xref ref-type="bibr" rid="pone.0179106.ref024">24</xref>] and the 64th Annual Meeting of the American Society of Human Genetics [<xref ref-type="bibr" rid="pone.0179106.ref025">25</xref>] in 2014. Later, the KING software [<xref ref-type="bibr" rid="pone.0179106.ref011">11</xref>] was upgraded to version 2.0 to handle more than a million samples [<xref ref-type="bibr" rid="pone.0179106.ref026">26</xref>]. Since KING is most similar to our methods and can handle large data sets, we focus our comparisons on KING 2.0, using real genotype data with very large sample sizes.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>dbGaP and genotype fingerprinting</title>
<p>NCBI’s dbGaP database is a repository charged to archive, curate, and distribute information produced by genome scale studies investigating the interaction of genotypes and phenotypes [<xref ref-type="bibr" rid="pone.0179106.ref027">27</xref>]. As of August 15, 2016, the genotype and/or phenotype data of 1,430,765 samples collected from 1,091,830 research participants (referred to as subjects in this article) across 671 studies have been released to researchers by dbGaP.</p>
<p>Samples from a single subject or from closely related subjects are often submitted to different studies without being reported by dbGaP submitters, who may not know if the subjects participated in previously submitted studies. The dbGaP processing pipeline identifies samples that originate from the same subject and assigns a unique resource-wide subject ID (a.k.a., dbGaP Subject ID) for any genotyped subject. Theoretically, a few dozen genotypes from informative and independent SNPs can be used as “fingerprints” to distinguish subjects from each other in a database with millions of samples [<xref ref-type="bibr" rid="pone.0179106.ref028">28</xref>,<xref ref-type="bibr" rid="pone.0179106.ref029">29</xref>]. However, the genotypes submitted to dbGaP are obtained with different methods (i.e., various arrays or sequencing) and there are no SNPs that are covered by all the genotyping methods.</p>
<p>To support the dbGaP processing pipeline, we curated a large collection of markers that could be used for identity and relationship testing, which we refer to as the <italic>dbGaP Fingerprinting Collection</italic>. This collection was chosen to increase the chance that each sample has enough genotype information to identify it, while keeping the number of markers bounded. We selected 10,000 autosomal SNPs, where each had the following properties: (1) appears on at least 80% of the genotyping platforms thus far submitted to dbGaP; (2) is bi-allelic; (3) has minor allele frequency (MAF) &gt; 0.17 as reported by the 1000 Genomes Project [<xref ref-type="bibr" rid="pone.0179106.ref030">30</xref>]; (4) is separated from other selected SNPs by at least 50,000 bps; and (5) contains no complementary alleles, i.e., no A/T or G/C alleles. The non-complementary rule was imposed to avoid the DNA strand orientation problem. For example, if the two alleles of a fingerprinting SNP are A and G, then we know that the genotype AA in one dataset is the same as genotype TT in another dataset obtained with different genotyping methods, eliminating the need to know the DNA strand orientation used. If instead the alleles were A and T, then the meaning of genotypes AA and TT could not be disambiguated without knowing the DNA strand orientations.</p>
<p>We extracted the genotypes of 10,000 fingerprinting SNPs from binary PLINK.bed files [<xref ref-type="bibr" rid="pone.0179106.ref031">31</xref>] for 860,211 samples from 286 dbGaP studies and built the dbGaP Fingerprinting Collection. Each sample had at least 1,000 fingerprinting SNPs genotyped (Supporting Information, <xref ref-type="supplementary-material" rid="pone.0179106.s001">S1 Table</xref>). The average genotype missing rate resulting from SNPs not being on the chips or platforms is 9.1%, and the average rate of missing genotypes not called by genotyping methods is 2.9%.</p>
</sec>
<sec id="sec004">
<title>Finding identical samples: IBS, IBD and subject relationships</title>
<p>The genetic relatedness between two subjects can be estimated from SNP genotypes as a kinship coefficient—the probability that two alleles at the same locus are identical by descent (IBD). Some high values of the kinship coefficient are associated with specific relationships (e.g., second degree relatives). An important exception is that parent-offspring and full siblings have the same kinship coefficient of 0.25. The probability distributions of IBD cardinality <italic>P(Z = 0</italic>,<italic>1</italic>,<italic>2)</italic>, where <italic>Z</italic> is the number of alleles IBD, are more informative than kinship coefficients. Here, we restrict our analysis to relationships no more distant than third degree relatives.</p>
<p>Suppose a homogeneous, random mating population in Hardy-Weinberg equilibrium, having a bi-allelic SNP at location <italic>i</italic> with allele frequencies <italic>p</italic><sub><italic>i</italic></sub> and <italic>q</italic><sub><italic>i</italic></sub>. Any two subjects in the population can be observed to share 0, 1, or 2 alleles identical by state (IBS). Some of the IBS alleles shared by two subjects might be inherited from the same recent ancestor, or identical by decent (IBD). If we denote the number of IBD alleles as <italic>Z</italic> and the number of IBS alleles as <italic>I</italic>, as used by Purcell et al[<xref ref-type="bibr" rid="pone.0179106.ref013">13</xref>], the probability of each IBS state given an IBD state, <italic>P(I|Z)</italic> can be calculated by using the formulas in <xref ref-type="table" rid="pone.0179106.t001">Table 1</xref>. <xref ref-type="fig" rid="pone.0179106.g001">Fig 1</xref> shows how the equations in <xref ref-type="table" rid="pone.0179106.t001">Table 1</xref> are derived. For a pair of subjects, the kinship coefficient <italic>ϕ</italic> can be calculated using the <italic>P(Z)</italic> values: <italic>ϕ = P(Z = 2)/2 + P(Z = 1)/4</italic>.</p>
<fig id="pone.0179106.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Probabilities of shared alleles in pairwise sample comparisons for autosomal bi-allelic markers are derived from the list of genotype outcomes.</title>
<p>When no alleles are shared by descent (<italic>Z</italic>) (panel A, <italic>Z</italic> = 0), then the chance of seeing any specific combination of alleles is the product of the respective allele frequencies. When one (panel B, <italic>Z</italic> = 1) or both alleles (panel C, <italic>Z</italic> = 2) are shared by descent, then the possible number of genotype outcomes are reduced. The number of alleles identical by state (<italic>I</italic>) can be zero (panel A, lavender), one (all panels, no highlight), or two (all panels, green).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.g001" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0179106.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.t001</object-id>
<label>Table 1</label> <caption><title>Calculation of <italic>P(I|Z)</italic> value for each marker.</title></caption>
<alternatives>
<graphic id="pone.0179106.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center" colspan="3">IBD state</th>
</tr>
<tr>
<th align="left">IBS state</th>
<th align="center"><italic>Z = 0</italic></th>
<th align="center"><italic>Z = 1</italic></th>
<th align="left"><italic>Z = 2</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>I = 0</italic></td>
<td align="center"><italic><inline-formula id="pone.0179106.e001"><alternatives><graphic id="pone.0179106.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula></italic></td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left"><italic>I = 1</italic></td>
<td align="left"><italic><inline-formula id="pone.0179106.e002"><alternatives><graphic id="pone.0179106.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mn>4</mml:mn><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula></italic></td>
<td align="left"><italic><inline-formula id="pone.0179106.e003"><alternatives><graphic id="pone.0179106.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula></italic></td>
<td align="left">0</td>
</tr>
<tr>
<td align="left"><italic>I = 2</italic></td>
<td align="left"><italic><inline-formula id="pone.0179106.e004"><alternatives><graphic id="pone.0179106.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula></italic></td>
<td align="left"><italic><inline-formula id="pone.0179106.e005"><alternatives><graphic id="pone.0179106.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula></italic></td>
<td align="left">1</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec005">
<title>Statistical metrics to determine subject relationships</title>
<p>Assuming there is no inbreeding, the probabilities of different IBD states for common types of relationships are shown in the left columns in <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref>. The results in <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref> indicate that we can use <italic>P(Z = 2)</italic> to distinguish identical pairs (including samples from the same subject and those from monozygotic twins) from other types of relationships. We can also use <italic>P(Z = 0)</italic> to distinguish other types of close relationships.</p>
<table-wrap id="pone.0179106.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.t002</object-id>
<label>Table 2</label> <caption><title>Probabilities of different IBD and IBS states for different relationships.</title></caption>
<alternatives>
<graphic id="pone.0179106.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Relationship</th>
<th align="left">Abbrev.</th>
<th align="right"><italic>P(Z = 0)</italic></th>
<th align="right"><italic>P(Z = 1)</italic></th>
<th align="right"><italic>P(Z = 2)</italic></th>
<th align="center"><italic>P(I&lt;2)</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Identical pair</td>
<td align="left">ID</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="center">0.00</td>
</tr>
<tr>
<td align="left">Parent-offspring</td>
<td align="left">PO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="center">0.39</td>
</tr>
<tr>
<td align="left">Full sibling</td>
<td align="left">FS</td>
<td align="right">¼</td>
<td align="right">½</td>
<td align="right">¼</td>
<td align="center">0.33</td>
</tr>
<tr>
<td align="left">Second degree</td>
<td align="left">D2</td>
<td align="right">½</td>
<td align="right">½</td>
<td align="right">0</td>
<td align="center">0.47</td>
</tr>
<tr>
<td align="left">Third degree</td>
<td align="left">D3</td>
<td align="right">¾</td>
<td align="right">¼</td>
<td align="right">0</td>
<td align="center">0.50</td>
</tr>
<tr>
<td align="left">Unrelated</td>
<td align="left">UN</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="center">0.54</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>We compare the SNP genotypes of every two samples and use two statistical metrics to find their relationships. The first one is the genotype discordance rate when all SNPs with genotypes are counted, which we call <underline>A</underline>ll <underline>G</underline>enotype <underline>M</underline>ismatch <underline>R</underline>ate (AGMR), equivalent to the percentage of SNPs with IBS state <italic>I &lt; 2</italic>. The second one is the genotype mismatch rate when only the SNPs with both samples being homozygous are counted, which we call <underline>H</underline>omozygous <underline>G</underline>enotype <underline>M</underline>ismatch <underline>R</underline>ate (HGMR). Assuming a homogenous, random mating population, with allele frequencies uniformly distributed in the range between 0.1 and 0.9, the expected AGMR values are the same as the <italic>P(I&lt;2)</italic> values in <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref>, and the expected HGMR values and standard deviations are shown in <xref ref-type="table" rid="pone.0179106.t003">Table 3</xref>.</p>
<table-wrap id="pone.0179106.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.t003</object-id>
<label>Table 3</label> <caption><title>Predicted HGMR values and standard deviations for different types of relationships assuming allele frequencies are evenly distributed between 0.1 and 0.9.</title></caption>
<alternatives>
<graphic id="pone.0179106.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Relationship</th>
<th align="center">Expected HGMR</th>
<th align="center">SD</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Parent-offspring</td>
<td align="center">0.0000</td>
<td align="center">0.0000</td>
</tr>
<tr>
<td align="left">Full sibling</td>
<td align="center">0.0454</td>
<td align="center">0.0031</td>
</tr>
<tr>
<td align="left">Second degree</td>
<td align="center">0.1040</td>
<td align="center">0.0050</td>
</tr>
<tr>
<td align="left">Third degree</td>
<td align="center">0.1594</td>
<td align="center">0.0062</td>
</tr>
<tr>
<td align="left">Unrelated</td>
<td align="center">0.2172</td>
<td align="center">0.0073</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec006">
<title>Identical pairs within and between dbGaP studies</title>
<p>To find identical pairs within and across studies, we have developed three different algorithms—the naïve, quadratic and sub-quadratic—with computational complexities <italic>O(n</italic><sup><italic>2</italic></sup><italic>S)</italic>, <italic>O(n</italic><sup><italic>2</italic></sup><italic>)</italic>, and <italic>O(n log n)</italic>, respectively (see <xref ref-type="sec" rid="sec013">Methods</xref>). The naïve algorithm and the quadratic algorithm tolerate high genotype missing rates in the genotype datasets, but the sub-quadratic algorithm requires low genotype missing rates.</p>
<p>The naïve and the quadratic algorithms were implemented as multithreaded programs. We tested the naïve algorithm, the quadratic algorithm, and the duplicate sample detection function of KING 2.0 using the genotype dataset extract from all dbGaP studies on August 15, 2016, with minimum 1000 fingerprint SNPs having genotypes, on an Intel Xeon machine with 16 2.67 GHz CPUs. This dataset contains 884,794 samples, with average genotype missing rate 11.7%.</p>
<p>It took the naïve algorithm 65 hr 42 min to check all the samples. The running time of quadratic algorithm was 1 hr 34 min. KING 2.0, when being run with option “-duplicate” to only find duplicate samples, took 1 hr 48 min.</p>
<p>Since the native algorithm exhaustively checks all pairs of samples over all SNPs, we can use the identical pairs found by the naïve algorithm to evaluate the accuracies of the other two programs. Also since both the quadratic algorithm and KING 2.0 check genotypes of all SNPs at the last step, the specificities of both algorithms are 100%. Assuming all sample pairs with AGMR less than 10% are real identical pairs, <xref ref-type="table" rid="pone.0179106.t004">Table 4</xref> compares the sensitivities of these two algorithms for finding identical pairs with different AGMR ranges.</p>
<table-wrap id="pone.0179106.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.t004</object-id>
<label>Table 4</label> <caption><title>Comparison of the performances of the GRAF quadratic algorithm and KING 2.0 on finding identical pairs with different AGMR ranges.</title></caption>
<alternatives>
<graphic id="pone.0179106.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.t004" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left"/>
<th align="center" colspan="2">GRAF</th>
<th align="center" colspan="2">KING</th>
<th align="left"/>
<th align="left"/>
</tr>
<tr>
<th align="left">AGMR (%)</th>
<th align="left">#ID pairs</th>
<th align="left">#Missed</th>
<th align="left">FN (%)</th>
<th align="left">#Missed</th>
<th align="left">FN (%)</th>
<th align="left">Mean AGMR (%)</th>
<th align="left">Exp. FN (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">[0, 1)</td>
<td align="right">87500</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">1102</td>
<td align="right">1.26</td>
<td align="center">0.08</td>
<td align="right">4.1E-13</td>
</tr>
<tr>
<td align="left">[1, 2)</td>
<td align="right">1446</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">237</td>
<td align="right">16.39</td>
<td align="center">1.37</td>
<td align="right">2.7E-04</td>
</tr>
<tr>
<td align="left">[2, 3)</td>
<td align="right">276</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">29</td>
<td align="right">10.51</td>
<td align="center">2.38</td>
<td align="right">0.014</td>
</tr>
<tr>
<td align="left">[3, 4)</td>
<td align="right">72</td>
<td align="right">1</td>
<td align="right">1.39</td>
<td align="right">10</td>
<td align="right">13.89</td>
<td align="center">3.45</td>
<td align="right">0.159</td>
</tr>
<tr>
<td align="left">[4, 5)</td>
<td align="right">38</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">9</td>
<td align="right">23.68</td>
<td align="center">4.36</td>
<td align="right">0.656</td>
</tr>
<tr>
<td align="left">[5, 6)</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">3</td>
<td align="right">20.00</td>
<td align="center">5.48</td>
<td align="right">2.337</td>
</tr>
<tr>
<td align="left">[6, 7)</td>
<td align="right">20</td>
<td align="right">1</td>
<td align="right">5.00</td>
<td align="right">1</td>
<td align="right">5.00</td>
<td align="center">6.44</td>
<td align="right">5.263</td>
</tr>
<tr>
<td align="left">[7, 8)</td>
<td align="right">11</td>
<td align="right">1</td>
<td align="right">9.09</td>
<td align="right">2</td>
<td align="right">18.18</td>
<td align="center">7.49</td>
<td align="right">10.450</td>
</tr>
<tr>
<td align="left">[8, 9)</td>
<td align="right">8</td>
<td align="right">1</td>
<td align="right">12.50</td>
<td align="right">6</td>
<td align="right">75.00</td>
<td align="center">8.64</td>
<td align="right">18.563</td>
</tr>
<tr>
<td align="left">[9, 10)</td>
<td align="right">6</td>
<td align="right">4</td>
<td align="right">66.67</td>
<td align="right">6</td>
<td align="right">100.00</td>
<td align="center">9.40</td>
<td align="right">25.121</td>
</tr>
<tr>
<td align="left">[0, 10)</td>
<td align="right">89392</td>
<td align="right">8</td>
<td align="right">0.01</td>
<td align="right">1405</td>
<td align="right">1.57</td>
<td align="center">0.12</td>
<td align="right">1.8E-12</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t004fn001"><p>All of the identical pairs found by the naïve algorithm are grouped by AGMR values. #Missed: number of identical pairs missed by the algorithm; FN: false negative rate; Mean AGMR: average AGMR of the identical pairs in this group; Exp. FN: expected false negative rate of the quadratic algorithm calculated using <xref ref-type="disp-formula" rid="pone.0179106.e015">Eq 5</xref> (see <xref ref-type="sec" rid="sec013">Methods</xref>) supposing all sample pairs have the mean AGMR within the interval on that row of the table.</p></fn>
</table-wrap-foot>
</table-wrap>
<p><xref ref-type="table" rid="pone.0179106.t004">Table 4</xref> shows that GRAF quadratic algorithm has a much lower false negative rate than KING 2.0, especially when the genotype discordance rates are high. We also grouped the identical pairs by number of SNPs with genotypes and compared the performances of the two algorithms. <xref ref-type="table" rid="pone.0179106.t005">Table 5</xref> shows the results. All identical pairs had at least 287 SNPs with genotypes for each samples. GRAF and KING both worked well when more than 4000 SNPs were genotyped for both samples in each pair. When fewer SNPs had genotypes, GRAF could still find almost all of the identical pairs, but KING failed to detect many identical pairs.</p>
<table-wrap id="pone.0179106.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.t005</object-id>
<label>Table 5</label> <caption><title>Comparison of the performances of the GRAF quadratic algorithm and KING 2.0 on finding identical pairs with different numbers of SNPs with genotypes.</title></caption>
<alternatives>
<graphic id="pone.0179106.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.t005" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left"/>
<th align="center" colspan="2">GRAF</th>
<th align="center" colspan="2">KING 2.0</th>
</tr>
<tr>
<th align="left">#SNPs with genotypes</th>
<th align="left">Total pairs</th>
<th align="left">#Missed</th>
<th align="left">FN (%)</th>
<th align="left">#Missed</th>
<th align="left">FN (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">287–1000</td>
<td align="right">282</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">282</td>
<td align="right">100.00</td>
</tr>
<tr>
<td align="left">1001–2000</td>
<td align="right">975</td>
<td align="right">1</td>
<td align="right">0.10</td>
<td align="right">953</td>
<td align="right">97.74</td>
</tr>
<tr>
<td align="left">2001–3000</td>
<td align="right">158</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">42</td>
<td align="right">26.58</td>
</tr>
<tr>
<td align="left">3001–4000</td>
<td align="right">929</td>
<td align="right">2</td>
<td align="right">0.22</td>
<td align="right">111</td>
<td align="right">11.95</td>
</tr>
<tr>
<td align="left">4001–5000</td>
<td align="right">3743</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0</td>
<td align="right">0.00</td>
</tr>
<tr>
<td align="left">5001–6000</td>
<td align="right">39</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0</td>
<td align="right">0.00</td>
</tr>
<tr>
<td align="left">6001–7000</td>
<td align="right">4604</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">2</td>
<td align="right">0.04</td>
</tr>
<tr>
<td align="left">7001–8000</td>
<td align="right">12030</td>
<td align="right">2</td>
<td align="right">0.02</td>
<td align="right">1</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">8001–9000</td>
<td align="right">3984</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0</td>
<td align="right">0.00</td>
</tr>
<tr>
<td align="left">9001–10000</td>
<td align="right">62648</td>
<td align="right">2</td>
<td align="right">0.00</td>
<td align="right">14</td>
<td align="right">0.02</td>
</tr>
<tr>
<td align="left">287–10000</td>
<td align="right">89392</td>
<td align="right">8</td>
<td align="right">0.01</td>
<td align="right">1405</td>
<td align="right">1.57</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t005fn001"><p>#SNPs with genotypes: Ranges of numbers of SNPs with genotypes for both of the samples in each identical pair</p></fn>
<fn id="t005fn002"><p>#Non-null SNPs: For each identical pair, non-null SNPs are the SNPs at which both samples have genotypes. This column shows the ranges of counts of non-null SNPs.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>We also compared the sub-quadratic algorithm and the quadratic algorithm using all the samples in dbGaP. As mentioned above, comparing to the other two algorithms, the sub-quadratic algorithm is more sensitive to the missing genotype rate than the quadratic algorithm. To evaluate the performance of the sub-quadratic algorithm, we created several datasets from all of dbGaP studies by extracting genotypes of samples with maximum numbers of missing genotypes below seven thresholds: 10, 100, 1000, 2000, 3000, 5000 and 9000. <xref ref-type="table" rid="pone.0179106.t006">Table 6</xref> shows the results. The sub-quadratic algorithm was single-threaded. The running time against the dataset with 884,787 samples was 15 min. When the quadratic algorithm was run using one CPU core, it took 15 hr 39 min to check all of sample pairs.</p>
<table-wrap id="pone.0179106.t006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.t006</object-id>
<label>Table 6</label> <caption><title>Running times and prediction accuracies of the sub-quadratic algorithm tested with datasets of different sample sizes and genotype missing rates.</title></caption>
<alternatives>
<graphic id="pone.0179106.t006g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.t006" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" colspan="4">Dataset</th>
<th align="center" colspan="4">Performance of sub-quadratic algorithm</th>
</tr>
<tr>
<th align="center">Max geno miss</th>
<th align="center">Mean geno miss</th>
<th align="center">#Samples</th>
<th align="center">Total ID pairs</th>
<th align="center">#Rounds</th>
<th align="center">Time (min)</th>
<th align="center">#FN</th>
<th align="center">FN (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">10</td>
<td align="right">5.7</td>
<td align="right">68868</td>
<td align="right">6975</td>
<td align="right">12</td>
<td align="right">0.6</td>
<td align="right">0</td>
<td align="right">0.0</td>
</tr>
<tr>
<td align="right">100</td>
<td align="right">32.9</td>
<td align="right">407713</td>
<td align="right">44820</td>
<td align="right">45</td>
<td align="right">3.8</td>
<td align="right">0</td>
<td align="right">0.0</td>
</tr>
<tr>
<td align="right">1000</td>
<td align="right">153.7</td>
<td align="right">669927</td>
<td align="right">62931</td>
<td align="right">70</td>
<td align="right">6.7</td>
<td align="right">2</td>
<td align="right">0.0</td>
</tr>
<tr>
<td align="right">2000</td>
<td align="right">184.5</td>
<td align="right">688125</td>
<td align="right">66766</td>
<td align="right">88</td>
<td align="right">7.2</td>
<td align="right">44</td>
<td align="right">0.1</td>
</tr>
<tr>
<td align="right">3000</td>
<td align="right">415.4</td>
<td align="right">755156</td>
<td align="right">81380</td>
<td align="right">112</td>
<td align="right">9.0</td>
<td align="right">9127</td>
<td align="right">11.2</td>
</tr>
<tr>
<td align="right">5000</td>
<td align="right">500.8</td>
<td align="right">774255</td>
<td align="right">83379</td>
<td align="right">113</td>
<td align="right">9.4</td>
<td align="right">11240</td>
<td align="right">13.5</td>
</tr>
<tr>
<td align="right">9000</td>
<td align="right">1166.5</td>
<td align="right">884794</td>
<td align="right">89392</td>
<td align="right">135</td>
<td align="right">15.3</td>
<td align="right">13432</td>
<td align="right">15.0</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t006fn001"><p>The sub-quadratic algorithm was run five times for each input and the results were averaged and shown on this table. Max geno miss: maximum number of SNPs without genotypes for each sample; Mean geno miss: average number of SNPs per sample without genotypes; Total ID pairs: total number of identical pairs in each dataset found by the naïve algorithm; #Rounds: number of rounds ran by the sub-quadratic algorithm before it converged.</p></fn>
</table-wrap-foot>
</table-wrap>
<p><xref ref-type="table" rid="pone.0179106.t006">Table 6</xref> confirms that the sub-quadratic algorithm performs better when the genotype missing rate is not too high. When the maximum number of missing genotypes per sample is 2000 or fewer (average 185 or fewer missing genotypes), the sub-quadratic algorithm could detect 99.9% or more identical pairs. However, for the dataset with maximum 9000 missing genotypes per sample, it was able to find only 85% of the identical pairs.</p>
<p>The measured performances for the sub-quadratic algorithm were achieved when the two parameters <italic>m</italic> (number of markers checked) and <italic>c</italic> (number of rounds for convergence) were set to 20 and 10, respectively (see <xref ref-type="sec" rid="sec013">Methods</xref> for more details on the meanings of <italic>m</italic> and <italic>c</italic>). Increasing <italic>c</italic> can increase the sensitivity, at the cost of longer running time. Another way to increase the sensitivity is to run the sub-quadratic algorithm multiple times and take a union of the identical pairs obtained in different runs.</p>
<p>Since the quadratic algorithm is both fast and robust, tolerating high genotyping errors and systematic genotype gaps resulted from different genotyping methods, it is routinely used by dbGaP curators to find identical pairs within and across studies. We set the AGMR cutoff value to 20% when actually reporting putative identical pairs. For 884,797 samples in the database with maximum 9000 missing genotypes per sample, excluding those sample pairs that are proved to be incorrect by checking the genotypes, there are 42,402 identical sample pairs (24,127 within study and 18,275 across studies) reported by submitters; all 42,402 identical pairs were detected by the quadratic algorithm. In addition, the quadratic algorithm was able to find 47,433 identical pairs not reported by the submitters. Of these, most (46,124) are across studies and hence, would be unrecognizable to the submitters of single studies (<xref ref-type="fig" rid="pone.0179106.g002">Fig 2A</xref>).</p>
<fig id="pone.0179106.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Distribution of all genotype mismatch rates of identical pairs detected by the quadratic algorithm and those reported by submitters.</title>
<p>All samples in the dbGaP Fingerprint Collection are compared. Types of submitter-reported relationships are color coded. Coral red: samples are reported to be from the same subjects; Purple: samples are from monozygotic twins; Gray: no relationship reported by submitters. Panel A shows the whole graph. Panel B shows the same graph, stretched on y-axis to show details of the bottom part of the graph.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.g002" xlink:type="simple"/>
</fig>
<p><xref ref-type="fig" rid="pone.0179106.g002">Fig 2</xref> shows the distribution of the genotype mismatch rates of all the identical pairs detected by the quadratic algorithm, as well as those reported by the submitters. When the same graph is scaled to show the details (<xref ref-type="fig" rid="pone.0179106.g002">Fig 2B</xref>), we can see that there is a peak with average AGMR about 33%. Most of the pairs under this peak are reported by submitter as monozygotic twins. However, <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref> shows that 33% is the expected AGMR value of full sibling pairs. So, it is likely that most of these pairs are non-identical twins reported as identical twins by mistake.</p>
<p><xref ref-type="fig" rid="pone.0179106.g002">Fig 2A</xref> also shows a small peak with average AGMR about 54%, corresponding to the expected AGMR for unrelated pairs, indicating these pairs of samples are actually from unrelated or remotely related subjects, but reported incorrectly by submitters as either from the same subject or identical twins. The sample pairs with low AGMR values, e.g., less than 20%, are most likely collected from same subjects or identical twins. The genotype mismatches are caused by errors in genotyping, data processing, or sample mixups.</p>
</sec>
<sec id="sec007">
<title>Using HGMR to determine non-identical, closely related pairs of subjects</title>
<p><xref ref-type="table" rid="pone.0179106.t003">Table 3</xref> shows that HGMR can be used to distinguish subject pairs with different relationships in a homogeneous, random mating population. Actual human populations are much more complicated than this simple model. We selected some dbGaP studies and tested how HGMR values can be used to determine the subject relationships with real data.</p>
<p>As of August 15, 2016, there were four dbGaP studies with at least 500 pairs of related subjects reported by submitters for each relationship type of full sibling, second degree relatives (including grandparent-grandchild, avuncular, and half sibling pairs) and third-degree relatives (including first cousin and half-avuncular pairs), and with fingerprinting genotype missing rate less than 10% (<xref ref-type="table" rid="pone.0179106.t007">Table 7</xref>). We compared the genotypes of all the fingerprinting SNPs for all the sample pairs within each study using the naïve algorithm (see <xref ref-type="sec" rid="sec013">Methods</xref>). For all the studies, the distributions of HGMR values are close to the normal distributions predicted by assuming the populations are homogeneous, random mating (<xref ref-type="fig" rid="pone.0179106.g003">Fig 3</xref>). The matches are especially good for studies phs000763 (<xref ref-type="fig" rid="pone.0179106.g003">Fig 3A</xref>) and phs000397 (<xref ref-type="fig" rid="pone.0179106.g003">Fig 3C</xref>). <xref ref-type="fig" rid="pone.0179106.g004">Fig 4</xref> shows HGMR distributions of the subject pairs of the same studies, scaled and color-coded to display the closely related pairs. The mean HGMR values of full sibling, second degree relative, and third degree relative are close to the predicted values, but the standard deviations are much larger than the values predicted using the simple homogeneous, random mating model. For parent-offspring pairs, the predicted HGMR value is 0, and the actual values are also close to 0.</p>
<fig id="pone.0179106.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Distribution of homozygous genotype mismatch rates of sample pairs in four dbGaP studies.</title>
<p>Cyan curves show the distribution of HGMR values predicted with the assumption that the populations are homogeneous and random mating.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.g003" xlink:type="simple"/>
</fig>
<fig id="pone.0179106.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Distribution homozygous genotype mismatch rates of sample pairs in the same four dbGaP studies as in <xref ref-type="fig" rid="pone.0179106.g002">Fig 2</xref>.</title>
<p>Graph is zoomed in to show the related pairs. Cyan curves show the distribution of HGMR values predicted with the assumption that the populations are homogeneous and random mating. Types of relationships reported by submitters in pedigree files are color coded. Red: parent/offspring; Blue: full sibling; Green: second degree relative; Yellow: third degree relative; Gray: no relationship reported by submitters.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.g004" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0179106.t007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.t007</object-id>
<label>Table 7</label> <caption><title>Genotype missing rates and numbers of pairs of related samples reported in submitted pedigree files for four dbGaP studies.</title></caption>
<alternatives>
<graphic id="pone.0179106.t007g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.t007" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left"/>
<th align="left"/>
<th align="right" colspan="4">Pairs of related samples reported in pedigree files</th>
</tr>
<tr>
<th align="right">Study</th>
<th align="right">Samples</th>
<th align="right">Geno MR(%)</th>
<th align="right">Parent-offspring</th>
<th align="right">Full sibling</th>
<th align="right">Second degree</th>
<th align="right">Third degree</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">phs000763</td>
<td align="right">2058</td>
<td align="right">0.59</td>
<td align="right">1947</td>
<td align="right">2028</td>
<td align="right">5607</td>
<td align="right">3535</td>
</tr>
<tr>
<td align="right">phs000462</td>
<td align="right">1035</td>
<td align="right">0.81</td>
<td align="right">1079</td>
<td align="right">1228</td>
<td align="right">3211</td>
<td align="right">3500</td>
</tr>
<tr>
<td align="right">phs000397</td>
<td align="right">5013</td>
<td align="right">0.17</td>
<td align="right">2332</td>
<td align="right">3119</td>
<td align="right">6027</td>
<td align="right">7878</td>
</tr>
<tr>
<td align="right">phs000168</td>
<td align="right">5220</td>
<td align="right">0.12</td>
<td align="right">852</td>
<td align="right">3984</td>
<td align="right">3136</td>
<td align="right">2315</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec008">
<title>Using both HGMR and AGMR to determine subject relationships for dbGaP studies</title>
<p>We have shown that AGMR can be used to distinguish identical pairs from other types of relationships, and the latter can be separated from each other by using HGMR. <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref> also shows that the expected AGMR values are different among different types of relationships, and hence can also be used to separate these relationships, especially to separate full siblings from second degree relatives. To obtain greater discrimination power, we use joint HGMR and AGMR values to determine subject relationships.</p>
<p>If HGMR and AGMR values both follow normal distributions, then the joint values follow a bivariate normal distribution. We estimate some parameters using the genotype data in dbGaP Fingerprinting Collection of subjects with known to be closely related (<xref ref-type="table" rid="pone.0179106.t008">Table 8</xref>), and use the probability density function of the bivariate normal distribution to calculate the prior probabilities to obtain different AGMR and HGMR values for each type of relationship. After excluding the identical pairs and more remotely related subject pairs, we can calculate the posterior probability of any pair of subjects being PO, FS, D2, or D3 given AGMR and HGMR values, using Bayes theorem (see <xref ref-type="sec" rid="sec013">Methods</xref>). Using this method, we are able to directly determine subject relationships using SNP genotypes without estimating <italic>P(Z)</italic> values or kinship coefficients.</p>
<table-wrap id="pone.0179106.t008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.t008</object-id>
<label>Table 8</label> <caption><title>Mean HGMR and AGMR values and correlation coefficients between HGMR and AGMR of all related subjects reported in the data files submitted to dbGaP.</title></caption>
<alternatives>
<graphic id="pone.0179106.t008g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.t008" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="right"/>
<th align="center" colspan="2">HGMR (%)</th>
<th align="center" colspan="2">AGMR (%)</th>
<th align="center"/>
</tr>
<tr>
<th align="left">Relationship</th>
<th align="left">Number of pairs</th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">Correlation coefficient</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Identical</td>
<td align="justify">21099</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.08</td>
<td align="right">0.38</td>
<td align="right">0.317</td>
</tr>
<tr>
<td align="left">Parent-offspring</td>
<td align="justify">45184</td>
<td align="right">0.04</td>
<td align="right">0.07</td>
<td align="right">39.48</td>
<td align="right">1.47</td>
<td align="right">0.104</td>
</tr>
<tr>
<td align="left">Full sibling</td>
<td align="justify">28447</td>
<td align="right">4.86</td>
<td align="right">1.02</td>
<td align="right">33.59</td>
<td align="right">2.32</td>
<td align="right">0.784</td>
</tr>
<tr>
<td align="left">Second degree</td>
<td align="justify">18492</td>
<td align="right">11.16</td>
<td align="right">1.35</td>
<td align="right">47.30</td>
<td align="right">1.10</td>
<td align="right">0.803</td>
</tr>
<tr>
<td align="left">Third degree</td>
<td align="justify">10841</td>
<td align="right">17.32</td>
<td align="right">1.35</td>
<td align="right">51.07</td>
<td align="right">0.96</td>
<td align="right">0.830</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p><xref ref-type="fig" rid="pone.0179106.g005">Fig 5</xref> shows the distribution of HGMR and AGMR values of all pairs of subjects in dbGaP Fingerprinting Collection reported by submitters as closely related. The contour lines show the positions with the same predicted probability densities, and the areas within each contour line are expected to contain 95% of the subject pairs with each relationship type, excluding MZ twins.</p>
<fig id="pone.0179106.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Distribution of both HGMR and AGMR values of all pairs of samples reported by submitters as closely related.</title>
<p>Each dot represents one pair of samples. Types of relationships reported by submitters are color coded. Purple: same subject or monozygotic twins; Red: parent/offspring; Blue: full sibling; Green: second degree relative; Brown: third degree relative. Each contour line shows the area that is predicted to include 95% of the sample pairs for each type of relationship.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Comparison of GRAF and KING on Determination of Other Types of Relationships</title>
<p>We also compared GRAF and KING 2.0 on determining other types of closely related subjects. The same four studies with sufficiently large numbers of different relationships (see <xref ref-type="table" rid="pone.0179106.t006">Table 6</xref>) were used to compare the performances of GRAF and KING 2.0. <xref ref-type="fig" rid="pone.0179106.g006">Fig 6</xref> shows the results of GRAF and KING in scatter plots. For the GRAF results, it plots the AGMR values against HGMR values. For KING results, it plots kinship coefficient estimations against percentages of IBS0 SNPs.</p>
<fig id="pone.0179106.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Comparison of GRAF and KING on determining subject relationships for four dbGaP studies.</title>
<p>Relationships self-reported in the pedigree files are color coded: red = parent-offspring; blue = full sibling; green = second degree; deep yellow = third degree. Cyan lines show the cutoff values to separate different types of relationships from one another.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.g006" xlink:type="simple"/>
</fig>
<p>The cyan lines in <xref ref-type="fig" rid="pone.0179106.g006">Fig 6</xref> shows the cutoff lines used by the programs to separate different types of relationships. KING only uses kinship coefficient to separate different relationships, and hence the cutoff lines in the graph are straight lines. The cutoff values shown in <xref ref-type="fig" rid="pone.0179106.g006">Fig 6</xref> are suggested by the authors. However, both PO and FS are first degree relatives, and are expected to have the same kinship coefficients. After first degree relatives are separated from other relationships, KING uses percentage of SNPs with IBS0 to distinguish PO from FS. GRAF uses both HGMR and AGMR to determine the relationships. The cyan cutoff lines in <xref ref-type="fig" rid="pone.0179106.g006">Fig 6</xref> show the show the positions where the probabilities of the two types of relationships, calculated using either <xref ref-type="disp-formula" rid="pone.0179106.e033">Eq 13</xref> or <xref ref-type="disp-formula" rid="pone.0179106.e037">Eq 15</xref>, are equal (see <xref ref-type="sec" rid="sec013">Methods</xref>).</p>
<p><xref ref-type="fig" rid="pone.0179106.g006">Fig 6</xref> shows that when distinguishing full siblings from second degree relatives, the HGMR/AGMR combination is better than the combination of IBS0 and kinship coefficient estimation. If only one statistical metric is used to separate full sibling pairs from second degree relatives, HGMR is better than IBS0 and AGMR is better than kinship coefficient estimation.</p>
<p>The above conclusions might not be evident if we only check the plots with visual inspection. We can determine how well the values of two values are separated from each other by using receiver operating character (ROC) curves. The area under a ROC curve (AUC) reflects the discriminatory accuracy of a method. However, ROC curves are useful only when there are some overlaps between the two variables. In the case of these four dbGaP studies, full siblings are very well separated from second degree relatives using any of the four metrics, with no or very little overlaps. It is hard to use ROC curves to evaluate the discriminatory accuracies, since the AUC values will be 1 or very close to 1.</p>
<p>For two independent normal random variables with mean and variances <inline-formula id="pone.0179106.e006"><alternatives><graphic id="pone.0179106.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0179106.e007"><alternatives><graphic id="pone.0179106.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0179106.e008"><alternatives><graphic id="pone.0179106.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0179106.e009"><alternatives><graphic id="pone.0179106.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, AUC can be calculated using the following equation:
<disp-formula id="pone.0179106.e010">
<alternatives>
<graphic id="pone.0179106.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>Φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where Ф is the standard normal cumulative distribution function[<xref ref-type="bibr" rid="pone.0179106.ref032">32</xref>,<xref ref-type="bibr" rid="pone.0179106.ref033">33</xref>].</p>
<p>The value of <italic>δ</italic> can be estimated using the mean and standard deviations of the HGMR, AGMR, IBS0 and kinship coefficient estimations calculated from the samples being checked. The estimated <italic>δ</italic> values reflect how well two variables are separated. The larger the δ values, the better the two variables are separated. <xref ref-type="table" rid="pone.0179106.t009">Table 9</xref> shows the <italic>δ</italic> values when different metrics are used to distinguish full siblings from second degree relatives, and second degree relatives from third degree relatives, for the four studies.</p>
<table-wrap id="pone.0179106.t009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.t009</object-id>
<label>Table 9</label> <caption><title><italic>δ</italic> values when different metrics are used to separate different types of relationships.</title> <p>Kinship = kinship coefficient estimated by KING.</p></caption>
<alternatives>
<graphic id="pone.0179106.t009g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.t009" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center" colspan="4">δ value for full sibling/second degree</th>
<th align="center" colspan="4">δ value for second degree/third degree</th>
</tr>
<tr>
<th align="center">Phs</th>
<th align="center">HGMR</th>
<th align="center">IBS0</th>
<th align="center">AGMR</th>
<th align="center">Kinship</th>
<th align="center">HGMR</th>
<th align="center">IBS0</th>
<th align="center">AGMR</th>
<th align="center">Kinship</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">phs000763</td>
<td align="center">3.64</td>
<td align="center">3.22</td>
<td align="right">5.62</td>
<td align="right">4.88</td>
<td align="center">2.97</td>
<td align="center">2.97</td>
<td align="right">2.46</td>
<td align="right">2.79</td>
</tr>
<tr>
<td align="center">phs000462</td>
<td align="center">3.42</td>
<td align="center">3.08</td>
<td align="right">4.71</td>
<td align="right">4.38</td>
<td align="center">2.64</td>
<td align="center">2.70</td>
<td align="right">2.16</td>
<td align="right">2.45</td>
</tr>
<tr>
<td align="center">phs000397</td>
<td align="center">2.85</td>
<td align="center">2.60</td>
<td align="right">4.36</td>
<td align="right">3.83</td>
<td align="center">2.57</td>
<td align="center">2.55</td>
<td align="right">2.25</td>
<td align="right">2.43</td>
</tr>
<tr>
<td align="center">phs000168</td>
<td align="center">3.22</td>
<td align="center">2.94</td>
<td align="right">5.07</td>
<td align="right">4.56</td>
<td align="center">2.35</td>
<td align="center">2.47</td>
<td align="right">1.79</td>
<td align="right">2.27</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p><xref ref-type="table" rid="pone.0179106.t009">Table 9</xref> shows that when distinguishing full sibling pairs from first degree relatives, HGMR is better than IBS0, and AGMR is better than kinship coefficient estimation. When separating first degree relatives from second degree relatives, HGMR is similar to IBS0, but kinships coefficient estimation is better than AGMR.</p>
</sec>
<sec id="sec010">
<title>The GRAF software package</title>
<p>We have developed a software package called GRAF (<bold>G</bold>enetic <bold>R</bold>elationship <bold>A</bold>nd <bold>F</bold>ingerprinting) to extract the genotypes of the 10,000 dbGaP fingerprinting SNPs from datasets and to find identical pairs and other closely related subjects. GRAF takes the input for one or more datasets in byte-encoded (a.k.a., binary) PLINK format, along with some auxiliary information that makes it possible to recognize markers by position, dbSNP rs identifier, or dbSNP ss identifier. GRAF also compares the self-reported relationships in the pedigree file with relationships predicted using the genotypes. If multiple datasets are input, then GRAF compares all samples within and across all datasets in a pairwise manner. GRAF implements the quadratic algorithm to find the identical pairs and uses the aforementioned Bayes theorem method to determine subject relationships.</p>
<p>The main program of GRAF is implemented in C++. An auxiliary program for visualizing results is implemented in Perl. Genotypes of every 64 SNPs are encoded and stored in two 64-bit integers, and compared using bitwise operations and multithreading technique to improve the speed (Supplemental Material).</p>
<p>The executable files for GRAF and some documentation can be downloaded from a link at <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/Software.cgi" xlink:type="simple">http://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/Software.cgi</ext-link>. The main program is precompiled to run on 64-bit Linux computers.</p>
</sec>
<sec id="sec011">
<title>Using GRAF as a QC tool to find errors in data submitted to dbGaP</title>
<p>It is common that the data submitted to dbGaP contain errors, such as misreported subject relationships. For each study submitted to dbGaP, we use GRAF to validate the pedigree file and subject-sample mapping file against the submitted genotype data, and find closely related pairs of subjects that are not reported. The results are made available to the submitters with histograms and scatter plots as well as text tables so that dbGaP curators and data submitters can easily find the potential errors in the submitted datasets. <xref ref-type="fig" rid="pone.0179106.g007">Fig 7</xref> shows the genotype QC results of one dbGaP study with different types of errors. <xref ref-type="fig" rid="pone.0179106.g007">Fig 7A</xref> shows that three pairs of subjects that are reported in the pedigree as related but not MZ twins are actually genetically identical, one pair of MZ twins in the pedigree are probably DZ twins, and six pairs of subjects with identical genotypes are not reported in the pedigree and subject-sample mapping file. <xref ref-type="fig" rid="pone.0179106.g007">Fig 7B and 7C</xref> show that some subject pairs reported as related in the pedigree file are either related with different types of relationships or unrelated, and some closely related subject pairs are not reported in the pedigree file.</p>
<fig id="pone.0179106.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0179106.g007</object-id>
<label>Fig 7</label>
<caption>
<title>An example of GRAF results displayed on dbGaP website for curators and data submitters to find discrepancies between genotypes and pedigree files submitted to dbGaP.</title>
<p>The graphs show GRAF results of one dbGaP study before the errors were corrected by the submitter. Relationships reported by the submitter are color coded. (A) Distribution of AGMR values. Coral red: Duplicate samples; Purple: monozygotic twins; Blue: first, second, or third degree relative; Gray: no relationship reported by submitter. (B) Distribution of HGMR values. Red: parent/offspring; Blue: full sibling; Green: second degree relative; Yellow: third degree relative; Grey: no relationship reported by submitter. (C) Distribution of both HGMR and AGMR values of pairs of related samples, excluding those from same subjects or monozygotic twins. Red: parent/offspring; Blue: full sibling; Green: second degree relative; Yellow: third degree relative; Gray: no relationship reported by submitter.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.g007" xlink:type="simple"/>
</fig>
<p>GRAF is used by dbGaP curators and submitters as a quality control tool to check the genotype and pedigree files for all studies. The graphs generated by the GRAF auxiliary program enable users to quickly observe the overall relatedness among subjects, as well as the genotyping error rates. GRAF is also used to find subject overlaps across dbGaP studies and the results are reported to the submitters when appropriate. After subject overlaps are confirmed by the submitters, we assign a single dbGaP ID for multiple samples from the same individual. Users who download data from multiple dbGaP studies can find subject overlaps across dbGaP studies by checking dbGaP subject IDs. To find related, but not identical subjects, users need to rerun GRAF on the datasets downloaded.</p>
<p>For early studies that were released before GRAF was developed, the retrospective checking was limited to identifying duplicate samples and assigning them a shared identifier. For newer studies deposited in dbGaP, we have been requiring that all of the identical pairs should be correctly reported in the subject-sample mapping file and/or pedigree file before the study is released. In practice, all of the discrepancies between the first degree relatives detected by GRAF and those reported in the submitted files must be checked by the submitters; errors in the submitted files should be fixed. If the submitters are not able to fix the errors, we include the GRAF results in README files available to authorized users. If a study has already been released, we ask the submitter to fix the errors in new versions.</p>
</sec>
</sec>
<sec id="sec012" sec-type="conclusions">
<title>Discussion</title>
<p>We have developed and tested algorithms to quickly determine the subject relationships using SNP genotype data. To date, millions of individuals have been genotyped or sequenced on genome scale using different methods. Before GRAF was developed, there was no computer software available to find duplicate samples in large datasets with samples size as many as a million or more. As of today, besides GRAF, KING 2.0 is the only existing software that can process a dataset with a million samples in a few hours, not days or months. However, KING cannot be used to find duplicate samples obtained using different methods, especially when DNA strand orientations of the same SNPs are different. In addition, KING has not be been tested with large and real genotype datasets when many genotypes are missing or incorrect. We have developed a robust tool to extract genotypes of common SNPs from datasets obtained using different methods and quickly and robustly find all duplicate samples from very large datasets.</p>
<p>For finding duplicate samples and monozygotic twins, we check the genotype discordance rate over all the SNPs (AGMR). When the genotype missing rate is low, one can use the sub-quadratic algorithm to find all the duplicate samples. Depending on the genotype missing and error rate, and the desired prediction precisions and computation times, one can set the parameters accordingly, using equations provided in Methods. GRAF’s quadratic algorithm was able to find about 99.9% of the identical pairs in a combined dataset with 884,794 samples and genotype missing rate up to 90% per sample, when all of the identical pairs missed by the program were those with high genotype discordance rates, and the sensitivities were close to those predicted using the equations in Methods. Many more identical pairs in the same datasets were missed by KING 2.0. KING 2.0 finds identical pairs in several stages. In the first stage it checks genotypes of few SNPs. Then, at the subsequent stages it checks more and more SNPs, until at the last stage, all of the SNPs are checked. This algorithm runs in quadratic time, since usually most of time will be spent on the first stage when the number of SNPs checked is independent of the total number of SNPs genotyped. However, when genotype missing rate is high, since not enough SNPs are checked, one would predict that some of the identical pairs will be missed at the first stage, and will not be found in the subsequent sages. The test results with the real, combined genotype dataset from different dbGaP studies (<xref ref-type="table" rid="pone.0179106.t005">Table 5</xref>) confirmed the above hypothesis. When the genotype missing rate is 30% or more, about 60% of the identical pairs were missed by KING 2.0. So KING 2.0 can only be used to find identical pairs for datasets with low genotyping missing rates, but GRAF quadratic algorithm can robustly tolerate very high genotype missing rate, as long as the total numbers of correctly genotyped SNPs are enough to determine identical pairs.</p>
<p>The quadratic algorithm can find all identical pairs in a dataset with a million samples in a few hours, using current multi-CPU machines. However, when the sample size further increases, e.g., to hundreds of millions samples, the computation time will be days or months. The sub-quadratic algorithm finds identical pairs much faster. However, it does not work for datasets with high genotype missing rates. The sub-quadratic algorithm will be useful for finding identical pairs in datasets with very large sample sizes, or when computer hardware is limited or short running time is desired.</p>
<p>For determining subject relationships, we use the homozygous genotype mismatch rate (HGMR). Since the HGMR is similar to the AGMR, we can use algorithms similar to that for identical pairs to find non-identical but closely related subjects, by adjusting some parameters and the output specifications. However, since many SNPs are ignored when calculating HGMR, which is equivalent to high genotype missing rate for the algorithm, the sub-quadratic algorithm can only be used to find duplicate samples and identical twins.</p>
<p>The ratio of SNPs with IBS state 0 (IBS0) has been used as the basis of published methods to determine subject relationships [<xref ref-type="bibr" rid="pone.0179106.ref011">11</xref>,<xref ref-type="bibr" rid="pone.0179106.ref013">13</xref>,<xref ref-type="bibr" rid="pone.0179106.ref034">34</xref>,<xref ref-type="bibr" rid="pone.0179106.ref035">35</xref>]. Similar to IBS0, HGMR is also calculated with the number of SNPs with IBS state 0. However, IBS0 is the ratio to all the genotyped SNPs, while HGMR is the ratio to the genotyped SNPs with two homozygous genotypes. HGMR is simple enough so that a quadratic algorithm can be implemented to find the related subjects, while it is more sensitive in distinguishing different types of relationships than methods based on IBS0, especially in separating second degree relatives from full siblings (Figs <xref ref-type="fig" rid="pone.0179106.g004">4</xref> and <xref ref-type="fig" rid="pone.0179106.g005">5</xref>).</p>
<p>Since different types of related subjects are expected to have different probabilities of IBD states (<xref ref-type="table" rid="pone.0179106.t002">Table 2</xref>), most of the existing methods determine the subject relationships by calculating the probabilities of different IBD states[<xref ref-type="bibr" rid="pone.0179106.ref013">13</xref>], or kinship coefficients[<xref ref-type="bibr" rid="pone.0179106.ref011">11</xref>]. The probabilities of different IBD states can be estimated based on the observed IBS states. There are two types of methods to estimate the probabilities of different IBD states using IBS states[<xref ref-type="bibr" rid="pone.0179106.ref023">23</xref>], maximum-likelihood estimation[<xref ref-type="bibr" rid="pone.0179106.ref020">20</xref>] and method-of-moments estimation[<xref ref-type="bibr" rid="pone.0179106.ref022">22</xref>,<xref ref-type="bibr" rid="pone.0179106.ref036">36</xref>]. The practical problems with these methods were summarized in the Introduction.</p>
<p>To determine close genetic relationships between subjects in an outbred population, it is not absolutely necessary to calculate the probabilities of different IBD states, or kinship coefficients. Since for any two subjects, the observed IBS states are dependent on the probabilities of different IBD states, and the latter are determined by the genetic relationship, the prior probability distribution of IBS states can be calculated given a relationship type. The posterior probabilities of subject relationships given certain IBS states can be calculated using the Bayes theorem. However, when inbreeding exists, some parents are themselves closely related and the number of relationship types that need to be distinguished grows. In populations with substantial inbreeding, the relationship types can be much more complex and estimation of kinship coefficient matrix is central to effective genetic analysis[<xref ref-type="bibr" rid="pone.0179106.ref037">37</xref>,<xref ref-type="bibr" rid="pone.0179106.ref038">38</xref>].</p>
<p>The prior probability distributions predicted using homogeneous, random mating population models are considerably different from the real distributions (<xref ref-type="fig" rid="pone.0179106.g004">Fig 4</xref>). With large databases, such as dbGaP, one can empirically predict the prior probability distributions, and use these prior distributions to determine the relationships of any pair of subjects. Since no probabilities of IBD states need to be calculated in this process, no values are truncated, and results are not biased.</p>
<p>We use test statistics AGMR and HGMR, derived from IBS states to directly determine subject relationships. For determination of cryptic relationships and identification of pedigree errors, it is very important to be able to distinguish full siblings from second degree relatives since usually it is very easy to separate full siblings from parent-offspring pairs. <xref ref-type="fig" rid="pone.0179106.g006">Fig 6</xref> shows that in distinguishing full siblings from second degree relatives, HGMR is better than IBS0, and AGMR is better than the estimation of kinship coefficient. When GRAF combines HGMR and AGMR together when determining subject relationships, and hence can obtain even higher discrimination power.</p>
<p>AGMR and HGMR are useful in checking pedigree relationships and genotype datasets for quality control. At dbGaP, we calculate the AGMR and HGMR values for all the duplicate samples and closely related subjects, including all the related subjects as reported in the subject-sample mapping file and pedigree file, and plot the distributions of the AGMR and HGMR values. For single datasets, users of GRAF can quickly get the following useful information by examining the graphs visually.</p>
<list list-type="order">
<list-item><p>The potential errors in the subject-sample mapping file and pedigree file, or sample swapping in the genotype datasets, as indicated by the outliers at each relationship type.</p></list-item>
<list-item><p>The extent of relatedness among subjects as reflected by the numbers of pairs at each relationship type.</p></list-item>
<list-item><p>The genotyping error rate as indicated by the tails of the duplicate sample peak at the AGMR distribution curve and the tails of the parent-offspring curve.</p></list-item>
</list>
<p>Our analyses and test results above showed that the AGMR and HGMR values for a pair of samples can only be either 0 or much greater than 0, if there are no genotyping errors. For any pairs of samples with AGMR or HGMR slightly greater than 0, all of the genotype mismatches are most likely the result of genotyping errors. If two samples are not duplicates, then a low HGMR value (say less than 2%) indicates that the two subjects are parent-offspring. Empirically, a long tail of the peak near 0 in the AGMR or HGMR distribution curves indicates low genotyping quality.</p>
<p>GRAF can be used to find duplicate samples and identical twins across datasets, even if the genotypes are obtained using different methods. When sufficiently many fingerprint SNPs are covered by the genotyping methods, GRAF can also be used to find the related subjects across different datasets, and verify the pedigree files against the genotypes.</p>
<p>We have applied our algorithms and methods to the quality control checking of datasets submitted to dbGaP and helped the submitters to find and correct inconsistencies in the files. These algorithms and methods can be applied to other datasets. They might also be useful in forensic science for finding subject relationships.</p>
<p>One limitation of GRAF is that it does not take population stratification into consideration. It works very well in determining subject relationships and finding errors in pedigree files with dbGaP studies, where population stratification is not a serious problem. Many computational methods have been developed to find related subjects in admixed populations, e.g., KING-robust[<xref ref-type="bibr" rid="pone.0179106.ref011">11</xref>], REAP[<xref ref-type="bibr" rid="pone.0179106.ref035">35</xref>], PC-relate[<xref ref-type="bibr" rid="pone.0179106.ref034">34</xref>]. We have tried to use the genotypes of the fingerprinting SNPs to predict subject populations. Our preliminary results show that genotypes of the 10,000 fingerprinting SNPs are enough to determine subject populations in sub-continental levels (data not shown). When the method to determine subject populations using fingerprinting SNPs are ready to be used within GRAF, then GRAF can be improved to deal with datasets of admixed populations.</p>
<p>Another limitation is that the implementation of our methods in GRAF requires that at least some of the 10,000 fingerprinting SNPs be genotyped. The more fingerprinting SNPs that are genotyped, the more accurate the algorithm will be. When no or few fingerprinting SNPs are genotyped, no related subjects will be correctly identified. To solve this problem, we could compute the missing genotypes using imputation. In the longer-term, we believe that the genomic community would be better served if genotyping arrays and assays can be standardized, so that they included a common set of SNPs, for example, some or all of the 10,000 fingerprinting collection used by dbGaP. In addition, we will adjust the fingerprint SNP set in future, e.g., adding more SNPs covered by new technologies such as whole exome sequencing, removing some SNPs that were initially determined as bi-allelic but later proved to be multi-allelic.</p>
<p>Scientists who collect or analyze genotype data for GWAS may find GRAF useful in at least three scenarios. First, prospective submitters to dbGaP can run GRAF themselves and streamline the data submission process. If GRAF reports some predicted relationship that the submitter knows to be false, the submitter will be able to alert dbGaP curators of this discrepancy. Second, scientists who wish to do combined analysis of datasets at the dbGaP and EGA repositories may use GRAF to remove duplicate and closely related samples. Third, scientists who are collecting new samples to study some trait can access previous studies for that trait and use GRAF to evaluate whether prospective new study participants participated in another study. The second and third usage scenarios suggest an important area for future development of the GRAF software. It would be helpful to add to GRAF the capability to do only incremental comparisons. As datasets grow, only pairs of individuals in which at least one individual is new, since the last GRAF test, would be compared.</p>
</sec>
<sec id="sec013" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec014">
<title>The naïve, quadratic and sub-quadratic algorithms to find identical pairs</title>
<p>Among the relationships in <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref>, it is easiest to distinguish identical pairs from other relationships. Identical pairs are important because they reveal hidden sample duplicates. Since identical pairs have IBD states <italic>Z = 2</italic> at all sites, the observed IBS states will also be <italic>I = 2</italic> at all sites (<xref ref-type="table" rid="pone.0179106.t001">Table 1</xref>) provided there are no genotyping errors, no mutations and no somatic mosaicism. We can use the percentage of SNPs with IBS state <italic>I &lt; 2</italic>, to determine if two samples are genetically identical. Assume a pair of subjects with <italic>m</italic> independent SNPs having the same IBD state either 0, 1 or 2. If we randomly select a SNP, then the conditional probabilities that the two subjects have genotype mismatch (<italic>i</italic>.<italic>e</italic>., <italic>I &lt; 2</italic>) can be calculated using the following equations:
<disp-formula id="pone.0179106.e011">
<alternatives>
<graphic id="pone.0179106.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e011" xlink:type="simple"/>
<mml:math display="block" id="M11">
<mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
<disp-formula id="pone.0179106.e012">
<alternatives>
<graphic id="pone.0179106.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<disp-formula id="pone.0179106.e013">
<alternatives>
<graphic id="pone.0179106.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e013" xlink:type="simple"/>
<mml:math display="block" id="M13">
<mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>So, of the expected AGMR value for each type of relationship in <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref> is:
<disp-formula id="pone.0179106.e014">
<alternatives>
<graphic id="pone.0179106.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e014" xlink:type="simple"/>
<mml:math display="block" id="M14">
<mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula></p>
<p>If the frequencies of each allele are uniformly distributed in some interval, and if <italic>m</italic> is sufficiently large, then the expected genotype mismatch rates can be calculated using the above equations. The rightmost column of <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref> shows the predicted mismatch rates. In practice, the 10,000 SNPs were selected with known allele frequencies and those frequencies are not uniform, but we tested and show in the examples below that the approximation works adequately for our data.</p>
<p>To determine whether two samples are genetically identical, we compare the genotypes of these two samples over all the SNPs and calculate AGMR. The complexity of this naïve algorithm is <italic>O(n</italic><sup><italic>2</italic></sup><italic>S)</italic>, where <italic>n</italic> is number of samples and <italic>S</italic> is the number of SNPs.</p>
<p>Absent genotyping errors, we could conclude that two samples are non-identical if any genotype mismatch is found. Unfortunately, genotyping errors are common with current technologies and mutations do occur rarely. To overcome genotyping errors, we can check more SNPs until a certain number of genotype mismatches are encountered. Suppose that the genotype mismatch rate resulting from genotyping error is <italic>ε</italic>, and we randomly select <italic>m</italic> SNPs with genotypes and set a threshold <italic>k</italic>, such that two samples are deemed non-identical when there are <italic>k</italic> or more genotype mismatches. For that randomized method, the pair-wise identity false negative rate is expected to be:
<disp-formula id="pone.0179106.e015">
<alternatives>
<graphic id="pone.0179106.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e015" xlink:type="simple"/>
<mml:math display="block" id="M15">
<mml:mrow><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi><mml:mo>:</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>≥</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>!</mml:mo><mml:mi>i</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mo>ε</mml:mo><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ε</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where <italic>P</italic><sub><italic>ID</italic>:<italic>ismatches≥k</italic></sub> is the probability that there are <italic>k</italic> or more genotype mismatches for an identical pair of samples. In practice, the genotype mismatch rate varies from marker to marker. If the two samples are from two unrelated subjects, then the probability that there is a genotype mismatch at any single SNP is given in <xref ref-type="disp-formula" rid="pone.0179106.e013">Eq 3</xref>.</p>
<p>Denote the probability of genotype mismatch for an unrelated pair as <italic>η</italic>, i.e., <italic>η = P(I&lt;2|Z = 0)</italic>, and assume all the non-identical pairs are from unrelated subjects, the false positive rate can be calculated using the following equation:
<disp-formula id="pone.0179106.e016">
<alternatives>
<graphic id="pone.0179106.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e016" xlink:type="simple"/>
<mml:math display="block" id="M16">
<mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>U</mml:mi><mml:mi>N</mml:mi><mml:mo>:</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>!</mml:mo><mml:mi>i</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula></p>
<p>In practice, the sample pairs are not all independent, since each sample is compared against all other samples. However, for sufficiently large sample size, the above estimates of false negative and false positive rates should be accurate.</p>
<p>Eqs <xref ref-type="disp-formula" rid="pone.0179106.e015">5</xref> and <xref ref-type="disp-formula" rid="pone.0179106.e016">6</xref> show that we can implement an algorithm to check only a subset of the SNPs to find all the identical pairs (ID in <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref>). Since the number of SNPs that need to be checked (<italic>m</italic>) is not dependent on the total number of genotyped samples (<italic>n</italic>), the complexity of this algorithm is <italic>O(n</italic><sup><italic>2</italic></sup><italic>)</italic>. This algorithm is referred to as the “quadratic algorithm”.</p>
<p>The identity false positive rate can be minimized by checking the genotypes of all the <italic>S</italic> SNPs for those pairs having fewer than <italic>k</italic> mismatches out of <italic>m</italic> SNPs. If the false positive rate calculated using <xref ref-type="disp-formula" rid="pone.0179106.e016">Eq 6</xref> is low and there are relatively few identical pairs, then checking genotypes of more SNPs as mentioned above will not dramatically increase the running time.</p>
<p>Since the genotypes of every 64 SNPs are stored in two 64-bit integers, in the GRAF software, the quadratic algorithm is implemented by setting <italic>m</italic> = 64 and <italic>k</italic> = 8, i.e., the program stops checking genotypes if 8 or more genotype mismatches are found after 64 SNPs with non-null genotypes are compared. If the genotype mismatch rate <italic>ε</italic> resulting from genotyping error is known, we can predict the sensitivity of the quadratic algorithm using <xref ref-type="disp-formula" rid="pone.0179106.e015">Eq 5</xref>. Since the program keeps on checking genotypes until enough number of non-null genotypes are compared, the quadratic algorithm works even if the genotype missing rate is high.</p>
<p>If the genotype missing and error rates are both low, we can use a faster algorithm to find all the identical pairs. When all SNPs are correctly genotyped for all the samples, we can randomly select an ordered list of SNPs and save the genotypes of each sample in a string or integer. Then, we sort all samples by their genotypes and walk through the sorted list to find the identical pairs, which will appear next to each other on the list. The complexity of this sub-quadratic algorithm will be <italic>O(n log n)</italic>, which is the complexity of the sorting step.</p>
<p>However, if some genotypes are missing or incorrect, some of the identical pairs will not be consecutive on the list, and hence will be missed by this algorithm. For each identical pair, if we randomly select sets of <italic>m</italic> SNPs, the numbers of SNPs with missing or mismatched genotypes should roughly follow a Poisson distribution. Let <italic>δ</italic> be the rate of SNPs with missing or mismatched genotypes, the probability that none of the <italic>m</italic> SNPs have missing or mismatched SNPs is equivalent to the sensitivity of this method, which can be calculated as:
<disp-formula id="pone.0179106.e017">
<alternatives>
<graphic id="pone.0179106.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>_</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>δ</mml:mi></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula></p>
<p>To increase the sensitivity of the sub-quadratic algorithm, we can randomly select another set of SNPs with replacement and repeat the sorting and comparison of adjacent items. Assuming the missing or incorrect genotypes are randomly distributed among different samples and SNPs, if we repeat the process for <italic>r</italic> rounds, then the false negative rate of this method will be:
<disp-formula id="pone.0179106.e018">
<alternatives>
<graphic id="pone.0179106.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e018" xlink:type="simple"/>
<mml:math display="block" id="M18">
<mml:mrow><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>δ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula></p>
<p>A more structured description of the sub-quadratic algorithm is as follows:</p>
<p specific-use="line">Sort SNPs by genotype missing rate, from low to high</p>
<p specific-use="line">Putative ID pair set = {}</p>
<p specific-use="line">Real ID pair set = {}</p>
<p specific-use="line">Loop until <italic>done</italic></p>
<p specific-use="line">Randomly select <italic>m</italic> SNPs from the top of list</p>
<p specific-use="line">Code the genotype of each sample with an integer</p>
<p specific-use="line">Sort the samples by these integers</p>
<p specific-use="line">Check the sorted list to find new putative ID pairs</p>
<p specific-use="line">Add new putative ID pairs to the putative ID pair set</p>
<p specific-use="line">For each pair among the new putative ID pairs</p>
<p specific-use="line">Check all the 10,000 SNPs to determine if they are ID</p>
<p specific-use="line">Add new real ID pairs to the real ID pair set</p>
<p specific-use="line"><italic>done</italic> if no new real ID pair found in <italic>c</italic> consecutive rounds</p>
<p>The number of SNPs to check each time (<italic>m</italic>), and number of consecutive rounds without new ID pairs (<italic>c</italic>) should be selected based on the requirements of sensitivity and running time, as well as the quality of the genotype datasets. <xref ref-type="disp-formula" rid="pone.0179106.e017">Eq 7</xref> shows that the sensitivity of each round decreases when <italic>m</italic> increases. However, the false positive rate will also increase when <italic>m</italic> increases, which means more time will be spent on checking more SNPs to exclude these extra false negatives. Similarly, increasing the <italic>c</italic> number will decrease the false negative rate, according to <xref ref-type="disp-formula" rid="pone.0179106.e018">Eq 8</xref>, at the cost of longer running time.</p>
</sec>
<sec id="sec015">
<title>Using HGMR to determine other common relationships as non-identical related pairs</title>
<p>It is harder to distinguish non-identical relationships from each other than to separate identical pairs. <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref> shows that different types of relationships have different <italic>P(Z)</italic> and <italic>P(I)</italic> values. Most of the existing methods determine the relationships by estimating the <italic>P(Z)</italic> values using the observed IBS states. For example, Purcell et al[<xref ref-type="bibr" rid="pone.0179106.ref013">13</xref>] use the observed number of SNPs with IBD state 0, <italic>N(I = 0)</italic>, to estimate <italic>P(Z = 0)</italic> value. For a pair of subjects, if we check <italic>S</italic> SNPs, then the probability to have IBD state <italic>I</italic> = 0 for any SNP can be calculated using the following equation:
<disp-formula id="pone.0179106.e019">
<alternatives>
<graphic id="pone.0179106.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e019" xlink:type="simple"/>
<mml:math display="block" id="M19">
<mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula></p>
<p>By implementing the method-of-moments approach, some researchers use the <italic>observed</italic> number of SNPs with <italic>I = 0</italic> in replacement of the <italic>expected</italic> number, and estimate the probability as:
<disp-formula id="pone.0179106.e020">
<alternatives>
<graphic id="pone.0179106.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
</disp-formula></p>
<p>However, since the <italic>N(I = 0)/S</italic> values, i.e., observed rates of <italic>I = 0</italic> SNPs, can be greater than the predicted probabilities, the calculated values can be larger than 1.</p>
<p>If we only need to determine closely related subject pairs, e.g., up to third degree relatives, we do not have to estimate the <italic>P(Z)</italic> values. <xref ref-type="table" rid="pone.0179106.t002">Table 2</xref> and <xref ref-type="disp-formula" rid="pone.0179106.e019">Eq 9</xref> show that different non-identical relationships have different expected rates of <italic>I = 0</italic> SNPs. Therefore, we can use the rate of <italic>I = 0</italic> SNPs, without truncating the values, to distinguish these relationships.</p>
<p>A different test statistic, which we call the <italic>homozygous genotype mismatch rate</italic> (HGMR), can also be used to separate closely related non-identical pairs, with discrimination power higher than the rate of <italic>I = 0</italic> SNPs, especially in separating full sibling pairs from second degree relatives. For each pair of samples, we define HGMR as the genotype mismatch rate when only homozygotes are considered. Let A and B be the two alleles of any one SNP, we count only the SNPs with the following genotypes: either same homozygotes (SO, equivalent to genotypes AA|AA and BB|BB) or different homozygotes (DO, equivalent to genotypes AA|BB and BB|AA), and calculate HGMR using the following equation:
<disp-formula id="pone.0179106.e021">
<alternatives>
<graphic id="pone.0179106.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e021" xlink:type="simple"/>
<mml:math display="block" id="M21">
<mml:mrow><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>O</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula></p>
<p>The different homozygotes (DO) state implies the IBS state <italic>I = 0</italic>, i.e., <italic>N</italic><sub><italic>DO</italic></sub> = <italic>N(I = 0)</italic>, but the same homozygotes (SO) state does not imply the IBS state <italic>I = 2</italic>.</p>
<p>Let <italic>p</italic><sub><italic>i</italic></sub> and <italic>q</italic><sub><italic>i</italic></sub> be the frequencies of the two alleles for one SNP. The probabilities to have different homozygotes and same homozygotes can be computed using the following equations:
<disp-formula id="pone.0179106.e022">
<alternatives>
<graphic id="pone.0179106.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e022" xlink:type="simple"/>
<mml:math display="block" id="M22">
<mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mi>O</mml:mi><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pone.0179106.e023">
<alternatives>
<graphic id="pone.0179106.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e023" xlink:type="simple"/>
<mml:math display="block" id="M23">
<mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where the conditional probabilities can be derived from <xref ref-type="fig" rid="pone.0179106.g001">Fig 1</xref>:
<disp-formula id="pone.0179106.e024">
<alternatives>
<graphic id="pone.0179106.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e024" xlink:type="simple"/>
<mml:math display="block" id="M24">
<mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mi>O</mml:mi><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pone.0179106.e025">
<alternatives>
<graphic id="pone.0179106.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e025" xlink:type="simple"/>
<mml:math display="block" id="M25">
<mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pone.0179106.e026">
<alternatives>
<graphic id="pone.0179106.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e026" xlink:type="simple"/>
<mml:math display="block" id="M26">
<mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pone.0179106.e027">
<alternatives>
<graphic id="pone.0179106.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e027" xlink:type="simple"/>
<mml:math display="block" id="M27">
<mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>If we check <italic>S</italic> SNPs for subject pairs, <italic>N</italic><sub><italic>DO</italic></sub> and <italic>N</italic><sub><italic>SO</italic></sub> values will each roughly follow a binomial distribution, and the expected HGMR value will be:
<disp-formula id="pone.0179106.e028">
<alternatives>
<graphic id="pone.0179106.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e028" xlink:type="simple"/>
<mml:math display="block" id="M28">
<mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula></p>
<p>The expected value of the quotient of two random variables is not the same as the quotient of the two expected values. However, in this case, all the values are positive and the coefficient of the variables in the denominator is small, so the expected quotient is close to the quotient of the two expected values. In addition, since usually <italic>N</italic><sub><italic>SO</italic></sub> is much greater than <italic>N</italic><sub><italic>DO</italic></sub>, the standard deviation of HGMR is mostly dependent on the deviation of the numerator <italic>N</italic><sub><italic>DO</italic></sub>, and hence, can be estimated using the following equation:
<disp-formula id="pone.0179106.e029">
<alternatives>
<graphic id="pone.0179106.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e029" xlink:type="simple"/>
<mml:math display="block" id="M29">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
where <italic>P</italic><sub><italic>DO</italic></sub> is the probability that on a random SNP location the two subjects have different homozygous genotypes:
<disp-formula id="pone.0179106.e030">
<alternatives>
<graphic id="pone.0179106.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e030" xlink:type="simple"/>
<mml:math display="block" id="M30">
<mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>/</mml:mo><mml:mi>S</mml:mi></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>When allele frequencies are available, we can predict the mean HGMR values and standard deviations for any type of relationships using the above equations. <xref ref-type="table" rid="pone.0179106.t003">Table 3</xref> shows the predicted HGMR values and standard deviations for different types of relationships, assuming allele frequencies are uniformly distributed over a range of 0.1 to 0.9, and sufficiently large amount of independent SNPs are compared.</p>
</sec>
<sec id="sec016">
<title>Using both HGMR and AGMR to determine subject relationships</title>
<p>As described above, for pairs of samples, the numbers of SNPs with matched and mismatched genotypes are expected to follow binomial distributions. Therefore, when the number of SNPs compared is sufficiently large, the HGMR and AGMR values of each relationship type, except for parent-offspring and identical pairs, should approximately follow normal distributions, and the combination of both variables should follow a bivariate normal distribution. In general, if <italic>x</italic> and <italic>y</italic> are two variables following normal distributions
<disp-formula id="pone.0179106.e031">
<alternatives>
<graphic id="pone.0179106.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e031" xlink:type="simple"/>
<mml:math display="block" id="M31">
<mml:mi>x</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pone.0179106.e032">
<alternatives>
<graphic id="pone.0179106.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e032" xlink:type="simple"/>
<mml:math display="block" id="M32">
<mml:mi>y</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
then we have the following probability density function for both <italic>x</italic> and <italic>y</italic>:
<disp-formula id="pone.0179106.e033">
<alternatives>
<graphic id="pone.0179106.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e033" xlink:type="simple"/>
<mml:math display="block" id="M33">
<mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
where <italic>ρ</italic> is the correlation coefficient between <italic>x</italic> and <italic>y</italic>:
<disp-formula id="pone.0179106.e034">
<alternatives>
<graphic id="pone.0179106.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e034" xlink:type="simple"/>
<mml:math display="block" id="M34">
<mml:mi>ρ</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
</disp-formula></p>
<p>If we set <italic>x</italic> = HGMR and <italic>y</italic> = AGMR and estimate the values of <italic>μ</italic><sub><italic>x</italic></sub>, <italic>σ</italic><sub><italic>x</italic></sub>, <italic>μ</italic><sub><italic>y</italic></sub>, <italic>σ</italic><sub><italic>y</italic></sub>, and <italic>ρ</italic> of the whole population of each relationship type using the genotype data of a set of subjects sampled from the population, we can use the above equations to determine the relationship between any pair of subjects in the population.</p>
<p><xref ref-type="disp-formula" rid="pone.0179106.e033">Eq 13</xref> can be used to calculate the probability to get a specific pair of HGMR and AGMR when a subject pair is known to have relationship full sibling (FS), second degree relative (D2), third degree relative (D3), or unrelated (UN). However, since the HGMR values of parent-offspring (PO) pairs are not normally distributed, the above equation is not applicable to PO pairs.</p>
<p>For PO pairs, if there are no genotyping errors, HGMR values are expected to be 0. The homozygous genotype mismatches of PO pairs are all caused by genotyping errors or the rare mutational event. If genotyping errors were random over all the SNPs, then HGMR values would follow a Poisson distribution. Unfortunately, the actual genotyping errors are not random and the HGMR values of PO pairs do not follow a Poisson distribution. For subjects in dbGaP, the number of PO pairs roughly decreases exponentially when HGMR increases. We use the following exponential distribution function to estimate the distribution of HGMR values of PO pairs:
<disp-formula id="pone.0179106.e035">
<alternatives>
<graphic id="pone.0179106.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e035" xlink:type="simple"/>
<mml:math display="block" id="M35">
<mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
where <italic>x</italic> ≥ 0.</p>
<p>We have
<disp-formula id="pone.0179106.e036">
<alternatives>
<graphic id="pone.0179106.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e036" xlink:type="simple"/>
<mml:math display="block" id="M36">
<mml:mrow><mml:msubsup><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mspace width="0.25em"/><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The value of <italic>k</italic> is empirically set based on the actual HGMR values of all the pairs reported as PO in the files submitted to dbGaP. Since usually, it is easy to distinguish PO pairs from other relationships, <italic>k</italic> can be selected in a wide range without affecting the accuracy of genetic relationship prediction.</p>
<p>Let us also assume that for PO pairs HGMR and AGMR are independent, i.e., with correlation coefficient 0. Since AGMR values of PO pairs follow a normal distribution, we can use the following probability density function to estimate the distribution of both HGMR and AGMR values of PO pairs:
<disp-formula id="pone.0179106.e037">
<alternatives>
<graphic id="pone.0179106.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e037" xlink:type="simple"/>
<mml:math display="block" id="M37">
<mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula></p>
<p>The above simple model can only roughly estimate the probability distribution of HGMR and AGMR values of PO pairs. Fortunately, since PO pairs can be well separated from other relationship types using HGMR and AGMR (see analyses above), this simple model can still be used to distinguish PO pairs from other relationships.</p>
<p>When AGMR and HGMR probability density functions are available for all relationships, we can use them to determine the relationship of any pair of subjects. Given a set of subjects with genotypes, sampled from the same homogeneous population, we first calculate the HGMR and AGMR values for every pair of samples. Second, we use a cutoff AGMR value to exclude identical pairs, and a cutoff HGMR value to exclude all the remotely related and unrelated pairs. Third, suppose all the subject pairs remaining after the second stage have relationships in {PO, FS, D2, D3}, denoted by <italic>T</italic>. For each pair of subjects, if the HGMR and AGMR values are <italic>x</italic> and <italic>y</italic>, respectively, the probability that this pair has relationship <italic>R</italic> ∈ <italic>T</italic> can be calculated using the following equation:
<disp-formula id="pone.0179106.e038">
<alternatives>
<graphic id="pone.0179106.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e038" xlink:type="simple"/>
<mml:math display="block" id="M38">
<mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>If we also assume that the <italic>P(t)</italic> values are the same for all <italic>t</italic> ∈ <italic>T</italic>, then the above equation becomes:
<disp-formula id="pone.0179106.e039">
<alternatives>
<graphic id="pone.0179106.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0179106.e039" xlink:type="simple"/>
<mml:math display="block" id="M39">
<mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula></p>
<p>The mean HGMR and AGMR values <italic>μ</italic><sub><italic>x</italic></sub> and <italic>μ</italic><sub><italic>y</italic></sub>, and the standard deviations <italic>σ</italic><sub><italic>x</italic></sub>, <italic>σ</italic><sub><italic>y</italic></sub> and correlation coefficient <italic>ρ</italic> are required when calculating the <italic>P(R|xy)</italic> values. Within each dbGaP study, if there are sufficiently many subjects genotyped, we can calculate the allele frequencies for all of the 10,000 fingerprinting SNPs, and then use Eqs <xref ref-type="disp-formula" rid="pone.0179106.e012">4</xref> and <xref ref-type="disp-formula" rid="pone.0179106.e026">11</xref> to compute <italic>μ</italic><sub><italic>x</italic></sub> and <italic>μ</italic><sub><italic>y</italic></sub> values. In practice, we calculate the standard deviations and correlation coefficients of HGMR and AGMR for all subject pairs in dbGaP with known relationships for each relationship <italic>R</italic> (<xref ref-type="table" rid="pone.0179106.t007">Table 7</xref>) and use these values to estimate <italic>σ</italic><sub><italic>x</italic></sub>, <italic>σ</italic><sub><italic>y</italic></sub> and <italic>ρ</italic> values empirically. When <italic>μ</italic><sub><italic>x</italic></sub>, <italic>σ</italic><sub><italic>x</italic></sub>, <italic>μ</italic><sub><italic>y</italic></sub>, <italic>σ</italic><sub><italic>y</italic></sub>, and <italic>ρ</italic> values are available for each study, we check every pair of subjects and calculate the <italic>P(R|xy)</italic> values for all relationships <italic>R ∈</italic> {PO, FS, D2, D3}, and determine the relationship as the type that has the maximum <italic>P(R|xy)</italic> value.</p>
</sec>
<sec id="sec017">
<title>Algorithms to find non-identical but closely related subjects</title>
<p>Using HGMR values, the subject relationships can be determined with algorithms very similar to the algorithm described above for finding identical pairs. For determining identical pairs, the mismatch rates of all genotypes are calculated. When checking for non-identical relationships, we ignore the heterozygous SNPs and calculate the genotype mismatch rates. The quadratic algorithm can be modified to find non-identical related pairs as explained above and in the Supplementary Material. Actually, when SNPs with heterozygous genotypes are skipped for each pair of subjects, finding PO pairs is the same as finding identical pairs, since a PO pair is expected to have no mismatched genotypes, like an identical pair. The only difference is that fewer SNPs are used when finding PO pairs. If we use <italic>m</italic> to represent number of SNPs with valid genotypes, (i.e., those with two homozygous genotypes for one pair of subjects), then the false positive rate can be calculated using <xref ref-type="disp-formula" rid="pone.0179106.e015">Eq 5</xref>. Since many SNPs are not valid for calculating HGMR, more SNPs need to be checked each time, and the cutoff value <italic>k</italic> also needs to be adjusted based on the estimation of number of valid SNPs.</p>
</sec>
</sec>
<sec id="sec018">
<title>Supporting information</title>
<supplementary-material id="pone.0179106.s001" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Sample sizes and genotype missing rates of studies in the dbGaP fingerprinting collection.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0179106.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0179106.s002" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Bitwise operations to calculate HGMR and AGMR values.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>This research was supported in part by the Intramural Research Program of the National Institutes of Health, National Library of Medicine. The authors thank Dr. Masato Kimura for his helpful discussions about the algorithms. We are also grateful to the dbGaP curators for testing and using GRAF.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0179106.ref001"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Hindorff LA, MacArthur J, Morales J, Junkins HA, Hall PN, et al. (2016) A Catalog of Published Genome-Wide Association Studies. Available at: <ext-link ext-link-type="uri" xlink:href="http://www.genome.gov/gwastudies" xlink:type="simple">www.genome.gov/gwastudies</ext-link>. Accessed August 15, 2016.</mixed-citation></ref>
<ref id="pone.0179106.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Glusman</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Shankaracharya</surname></name>, <name name-style="western"><surname>Caballero</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Relationship estimation from whole-genome sequence data</article-title>. <source>PLoS Genet</source> <volume>10</volume>: <fpage>e1004144</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1004144" xlink:type="simple">10.1371/journal.pgen.1004144</ext-link></comment> <object-id pub-id-type="pmid">24497848</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pemberton</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>JZ</given-names></name>, <name name-style="western"><surname>Rosenberg</surname> <given-names>NA</given-names></name> (<year>2010</year>) <article-title>Inference of unexpected genetic relatedness among individuals in HapMap Phase III</article-title>. <source>Am J Hum Genet</source> <volume>87</volume>: <fpage>457</fpage>–<lpage>464</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2010.08.014" xlink:type="simple">10.1016/j.ajhg.2010.08.014</ext-link></comment> <object-id pub-id-type="pmid">20869033</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Voight</surname> <given-names>BF</given-names></name>, <name name-style="western"><surname>Pritchard</surname> <given-names>JK</given-names></name> (<year>2005</year>) <article-title>Confounding from cryptic relatedness in case-control association studies</article-title>. <source>PLoS Genet</source> <volume>1</volume>: <fpage>e32</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.0010032" xlink:type="simple">10.1371/journal.pgen.0010032</ext-link></comment> <object-id pub-id-type="pmid">16151517</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weedon</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Lango</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lindgren</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Wallace</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>DM</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Genome-wide association analysis identifies 20 loci that influence adult height</article-title>. <source>Nat Genet</source> <volume>40</volume>: <fpage>575</fpage>–<lpage>583</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.121" xlink:type="simple">10.1038/ng.121</ext-link></comment> <object-id pub-id-type="pmid">18391952</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Dimitromanolakis</surname> <given-names>A</given-names></name> (<year>2012</year>) <article-title>Identifying cryptic relationships</article-title>. <source>Methods Mol Biol</source> <volume>850</volume>: <fpage>47</fpage>–<lpage>57</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/978-1-61779-555-8_4" xlink:type="simple">10.1007/978-1-61779-555-8_4</ext-link></comment> <object-id pub-id-type="pmid">22307693</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Glusman</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Huff</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Caballero</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Roach</surname> <given-names>JC</given-names></name> (<year>2014</year>) <article-title>Accurate and robust prediction of genetic relationship from whole-genome sequences</article-title>. <source>PLoS One</source> <volume>9</volume>: <fpage>e85437</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0085437" xlink:type="simple">10.1371/journal.pone.0085437</ext-link></comment> <object-id pub-id-type="pmid">24586241</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname> <given-names>L</given-names></name> (<year>2012</year>) <article-title>Detecting pedigree relationship errors</article-title>. <source>Methods Mol Biol</source> <volume>850</volume>: <fpage>25</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/978-1-61779-555-8_3" xlink:type="simple">10.1007/978-1-61779-555-8_3</ext-link></comment> <object-id pub-id-type="pmid">22307692</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Choi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wijsman</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Weir</surname> <given-names>BS</given-names></name> (<year>2009</year>) <article-title>Case-control association testing in the presence of unknown relationships</article-title>. <source>Genet Epidemiol</source> <volume>33</volume>: <fpage>668</fpage>–<lpage>678</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/gepi.20418" xlink:type="simple">10.1002/gepi.20418</ext-link></comment> <object-id pub-id-type="pmid">19333967</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Day-Williams</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Blangero</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dyer</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Lange</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sobel</surname> <given-names>EM</given-names></name> (<year>2011</year>) <article-title>Linkage analysis without defined pedigrees</article-title>. <source>Genet Epidemiol</source> <volume>35</volume>: <fpage>360</fpage>–<lpage>370</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/gepi.20584" xlink:type="simple">10.1002/gepi.20584</ext-link></comment> <object-id pub-id-type="pmid">21465549</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Manichaikul</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mychaleckyj</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Rich</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Daly</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sale</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Robust relationship inference in genome-wide association studies</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>2867</fpage>–<lpage>2873</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq559" xlink:type="simple">10.1093/bioinformatics/btq559</ext-link></comment> <object-id pub-id-type="pmid">20926424</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morrison</surname> <given-names>J</given-names></name> (<year>2013</year>) <article-title>Characterization and correction of error in genome-wide IBD estimation for samples with population structure</article-title>. <source>Genet Epidemiol</source> <volume>37</volume>: <fpage>635</fpage>–<lpage>641</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/gepi.21737" xlink:type="simple">10.1002/gepi.21737</ext-link></comment> <object-id pub-id-type="pmid">23740691</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Purcell</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Neale</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Todd-Brown</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ferreira</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>. <source>Am J Hum Genet</source> <volume>81</volume>: <fpage>559</fpage>–<lpage>575</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1086/519795" xlink:type="simple">10.1086/519795</ext-link></comment> <object-id pub-id-type="pmid">17701901</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stevens</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Heckenberg</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Roberson</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Baugher</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Downey</surname> <given-names>TJ</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Inference of relationships in population data using identity-by-descent and identity-by-state</article-title>. <source>PLoS Genet</source> <volume>7</volume>: <fpage>e1002287</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1002287" xlink:type="simple">10.1371/journal.pgen.1002287</ext-link></comment> <object-id pub-id-type="pmid">21966277</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thornton</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>McPeek</surname> <given-names>MS</given-names></name> (<year>2010</year>) <article-title>ROADTRIPS: case-control association testing with partially or completely unknown population and pedigree structure</article-title>. <source>Am J Hum Genet</source> <volume>86</volume>: <fpage>172</fpage>–<lpage>184</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2010.01.001" xlink:type="simple">10.1016/j.ajhg.2010.01.001</ext-link></comment> <object-id pub-id-type="pmid">20137780</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Staples</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Witherspoon</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Jorde</surname> <given-names>LB</given-names></name>, <name name-style="western"><surname>Nickerson</surname> <given-names>DA</given-names></name>, <collab>University of Washington Center for Mendelian Genomics</collab>, <etal>et al</etal>. (<year>2016</year>) <article-title>PADRE: Pedigree-Aware Distant-Relationship Estimation</article-title>. <source>Am J Hum Genet</source> <volume>99</volume>: <fpage>154</fpage>–<lpage>162</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2016.05.020" xlink:type="simple">10.1016/j.ajhg.2016.05.020</ext-link></comment> <object-id pub-id-type="pmid">27374771</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>He</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Eskin</surname> <given-names>E</given-names></name> (<year>2014</year>) <article-title>IPED2X: a robust pedigree reconstruction algorithm for complicated pedigrees</article-title>. <source>J Bioinform Comput Biol</source> <volume>12</volume>: <fpage>1442007</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1142/S0219720014420074" xlink:type="simple">10.1142/S0219720014420074</ext-link></comment> <object-id pub-id-type="pmid">25553812</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anderson</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Weir</surname> <given-names>BS</given-names></name> (<year>2007</year>) <article-title>A maximum-likelihood method for the estimation of pairwise relatedness in structured populations</article-title>. <source>Genetics</source> <volume>176</volume>: <fpage>421</fpage>–<lpage>440</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.106.063149" xlink:type="simple">10.1534/genetics.106.063149</ext-link></comment> <object-id pub-id-type="pmid">17339212</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huff</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Witherspoon</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Simonson</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Watkins</surname> <given-names>WS</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Maximum-likelihood estimation of recent shared ancestry (ERSA)</article-title>. <source>Genome Res</source> <volume>21</volume>: <fpage>768</fpage>–<lpage>774</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.115972.110" xlink:type="simple">10.1101/gr.115972.110</ext-link></comment> <object-id pub-id-type="pmid">21324875</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thompson</surname> <given-names>EA</given-names></name> (<year>1975</year>) <article-title>The estimation of pairwise relationships</article-title>. <source>Ann Hum Genet</source> <volume>39</volume>: <fpage>173</fpage>–<lpage>188</lpage>. <object-id pub-id-type="pmid">1052764</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lynch</surname> <given-names>M</given-names></name> (<year>1988</year>) <article-title>Estimation of relatedness by DNA fingerprinting</article-title>. <source>Mol Biol Evol</source> <volume>5</volume>: <fpage>584</fpage>–<lpage>599</lpage>. <object-id pub-id-type="pmid">3193879</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name> (<year>2002</year>) <article-title>An estimator for pairwise relatedness using molecular markers</article-title>. <source>Genetics</source> <volume>160</volume>: <fpage>1203</fpage>–<lpage>1215</lpage>. <object-id pub-id-type="pmid">11901134</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Milligan</surname> <given-names>BG</given-names></name> (<year>2003</year>) <article-title>Maximum-likelihood estimation of relatedness</article-title>. <source>Genetics</source> <volume>163</volume>: <fpage>1153</fpage>–<lpage>1167</lpage>. <object-id pub-id-type="pmid">12663552</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref024"><label>24</label><mixed-citation publication-type="other" xlink:type="simple">Jin Y, Feolo M (2014) Accurate and fast identification of genetic relationship in large databases of genotypes. Poster B03 presented at: 22nd Annual International Conference on Intelligent Systems for Molecular Biology; 2014 July 11–15; Boston, USA.</mixed-citation></ref>
<ref id="pone.0179106.ref025"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Jin Y, Stefanov S, Dracheva S, Wang Z, Sharopova N, et al. (2014) DbGaP Genotype Fingerprint Collection. Platform presentation at: 64th Annual Meeting of the American Society of Human Genetics; 2014 Oct 18–22; San Diego, USA.</mixed-citation></ref>
<ref id="pone.0179106.ref026"><label>26</label><mixed-citation publication-type="other" xlink:type="simple">Chen WM, Manichaikul A, Rich SS (2016) Relationship inference and integrated analysis in one million samples. Poster #373 presented at: 66th Annual Meeting of the American Society of Human Genetics; 2016 Oct 18–22; Vancouver, Canada.</mixed-citation></ref>
<ref id="pone.0179106.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mailman</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Feolo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kimura</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tryka</surname> <given-names>K</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>The NCBI dbGaP database of genotypes and phenotypes</article-title>. <source>Nat Genet</source> <volume>39</volume>: <fpage>1181</fpage>–<lpage>1186</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng1007-1181" xlink:type="simple">10.1038/ng1007-1181</ext-link></comment> <object-id pub-id-type="pmid">17898773</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lin</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Owen</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Altman</surname> <given-names>RB</given-names></name> (<year>2004</year>) <article-title>Genetics. Genomic research and human subject privacy</article-title>. <source>Science</source> <volume>305</volume>: <fpage>183</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1095019" xlink:type="simple">10.1126/science.1095019</ext-link></comment> <object-id pub-id-type="pmid">15247459</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McGuire</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Gibbs</surname> <given-names>RA</given-names></name> (<year>2006</year>) <article-title>Genetics. No longer de-identified</article-title>. <source>Science</source> <volume>312</volume>: <fpage>370</fpage>–<lpage>371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1125339" xlink:type="simple">10.1126/science.1125339</ext-link></comment> <object-id pub-id-type="pmid">16627725</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><collab>1000 Genomes Project Consortium</collab> (<year>2012</year>) <article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source> <volume>491</volume>: <fpage>56</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11632" xlink:type="simple">10.1038/nature11632</ext-link></comment> <object-id pub-id-type="pmid">23128226</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chang</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Tellier</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Vattikuti</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Purcell</surname> <given-names>SM</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>. <source>Gigascience</source> <volume>4</volume>: <fpage>7</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13742-015-0047-8" xlink:type="simple">10.1186/s13742-015-0047-8</ext-link></comment> <object-id pub-id-type="pmid">25722852</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Faraggi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Reiser</surname> <given-names>B</given-names></name> (<year>2002</year>) <article-title>Estimation of the area under the ROC curve</article-title>. <source>Statist Med</source> <volume>21</volume>: <fpage>3093</fpage>–<lpage>3106</lpage>.</mixed-citation></ref>
<ref id="pone.0179106.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reiser</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Guttman</surname> <given-names>I</given-names></name> (<year>1987</year>) <article-title>A comparison of three point estimators for P (Y &lt; X) in the normal case</article-title>. <source>Comput Stat Data Anal</source> <volume>5</volume>: <fpage>59</fpage>–<lpage>66</lpage>.</mixed-citation></ref>
<ref id="pone.0179106.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Conomos</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Reiner</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Weir</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Thornton</surname> <given-names>TA</given-names></name> (<year>2016</year>) <article-title>Model-free Estimation of Recent Genetic Relatedness</article-title>. <source>Am J Hum Genet</source> <volume>98</volume>: <fpage>127</fpage>–<lpage>148</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2015.11.022" xlink:type="simple">10.1016/j.ajhg.2015.11.022</ext-link></comment> <object-id pub-id-type="pmid">26748516</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thornton</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hoffmann</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Ochs-Balcom</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Caan</surname> <given-names>BJ</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Estimating kinship in admixed populations</article-title>. <source>Am J Hum Genet</source> <volume>91</volume>: <fpage>122</fpage>–<lpage>138</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2012.05.024" xlink:type="simple">10.1016/j.ajhg.2012.05.024</ext-link></comment> <object-id pub-id-type="pmid">22748210</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lynch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ritland</surname> <given-names>K</given-names></name> (<year>1999</year>) <article-title>Estimation of pairwise relatedness with molecular markers</article-title>. <source>Genetics</source> <volume>152</volume>: <fpage>1753</fpage>–<lpage>1766</lpage>. <object-id pub-id-type="pmid">10430599</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Habier</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fernando</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Dekkers</surname> <given-names>JC</given-names></name> (<year>2007</year>) <article-title>The impact of genetic relationship information on genome-assisted breeding values</article-title>. <source>Genetics</source> <volume>177</volume>: <fpage>2389</fpage>–<lpage>2397</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.107.081190" xlink:type="simple">10.1534/genetics.107.081190</ext-link></comment> <object-id pub-id-type="pmid">18073436</object-id></mixed-citation></ref>
<ref id="pone.0179106.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gianola</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>de los Campos</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>WG</given-names></name>, <name name-style="western"><surname>Manfredi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Fernando</surname> <given-names>R</given-names></name> (<year>2009</year>) <article-title>Additive genetic variability and the Bayesian alphabet</article-title>. <source>Genetics</source> <volume>183</volume>: <fpage>347</fpage>–<lpage>363</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.109.103952" xlink:type="simple">10.1534/genetics.109.103952</ext-link></comment> <object-id pub-id-type="pmid">19620397</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>