<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-12-04836</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0043866</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
              <subj-group>
                <subject>Metagenomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Ecology</subject>
            <subj-group>
              <subject>Biogeography</subject>
              <subject>Marine ecology</subject>
              <subject>Microbial ecology</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Marine biology</subject>
            <subj-group>
              <subject>Marine ecology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Earth sciences</subject>
          <subj-group>
            <subject>Marine and aquatic sciences</subject>
            <subj-group>
              <subject>Marine ecology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Computational Biology</subject>
          <subject>Marine and Aquatic Sciences</subject>
        </subj-group>
      </article-categories><title-group><article-title>Functional Biogeography of Ocean Microbes Revealed through Non-Negative Matrix Factorization</article-title><alt-title alt-title-type="running-head">Functional Biogeography of Ocean Microbes with NMF</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Jiang</surname>
            <given-names>Xingpeng</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="fn" rid="fn1">
            <sup>¤a</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Langille</surname>
            <given-names>Morgan G. I.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="fn" rid="fn2">
            <sup>¤b</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Neches</surname>
            <given-names>Russell Y.</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Elliot</surname>
            <given-names>Marie</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Levin</surname>
            <given-names>Simon A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff5">
            <sup>5</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Eisen</surname>
            <given-names>Jonathan A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="aff" rid="aff6">
            <sup>6</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Weitz</surname>
            <given-names>Joshua S.</given-names>
          </name>
          <xref ref-type="aff" rid="aff7">
            <sup>7</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Dushoff</surname>
            <given-names>Jonathan</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1">
        <label>1</label>
        <addr-line>College of Information Science and Technology, Drexel University, Philadelphia, Pennsylvania, United States of America</addr-line>
      </aff><aff id="aff2">
        <label>2</label>
        <addr-line>Department of Biochemistry and Molecular Biology, Dalhousie University, Halifax, Nova Scotia, Canada</addr-line>
      </aff><aff id="aff3">
        <label>3</label>
        <addr-line>Genome Center and Microbiology Graduate Group, University of California Davis, Davis, California, United States of America</addr-line>
      </aff><aff id="aff4">
        <label>4</label>
        <addr-line>Department of Biology and M. G. DeGroote Institute for Infectious Disease Research, McMaster University, Hamilton, Ontario, Canada</addr-line>
      </aff><aff id="aff5">
        <label>5</label>
        <addr-line>Department of Ecology and Evolutionary Biology, Princeton University, Princeton, New Jersey, United States of America</addr-line>
      </aff><aff id="aff6">
        <label>6</label>
        <addr-line>Department of Evolution and Ecology, Department of Medical Microbiology and Immunology, University of California Davis, Davis, California, United States of America</addr-line>
      </aff><aff id="aff7">
        <label>7</label>
        <addr-line>School of Biology and School of Physics, Georgia Institute of Technology, Atlanta, Georgia, United States of America</addr-line>
      </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Horn</surname>
            <given-names>Matthias</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">
        <addr-line>University of Vienna, Austria</addr-line>
      </aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">jsweitz@gatech.edu</email> (JW); <email xlink:type="simple">dushoff@mcmaster.ca</email> (JD)</corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: XJ ML RN ME SL JE JW JD. Performed the experiments: XJ ML RN. Analyzed the data: XJ ML RN JE JW JD ME. Contributed reagents/materials/analysis tools: XJ ML RN JE JW JD. Wrote the paper: XJ ML RN ME SL JE JW JD.</p>
        </fn>
        <fn fn-type="current-aff" id="fn1">
          <label>¤a</label>
          <p>Current address: Department of Biology and M. G. DeGroote Institute for Infectious Disease Research, McMaster University, Hamilton, Ontario, Canada</p>
        </fn>
        <fn fn-type="current-aff" id="fn2">
          <label>¤b</label>
          <p>Current address: Genome Center, University of California Davis, Davis, California, United States of America</p>
        </fn>
      </author-notes><pub-date pub-type="collection">
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>18</day>
        <month>9</month>
        <year>2012</year>
      </pub-date><volume>7</volume><issue>9</issue><elocation-id>e43866</elocation-id><history>
        <date date-type="received">
          <day>12</day>
          <month>2</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>30</day>
          <month>7</month>
          <year>2012</year>
        </date>
      </history><permissions>
        
        <copyright-holder>Jiang et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions><abstract>
        <p>The direct “metagenomic” sequencing of genomic material from complex assemblages of bacteria, archaea, viruses and microeukaryotes has yielded new insights into the structure of microbial communities. For example, analysis of metagenomic data has revealed the existence of previously unknown microbial taxa whose spatial distributions are limited by environmental conditions, ecological competition, and dispersal mechanisms. However, differences in genotypes that might lead biologists to designate two microbes as taxonomically distinct need not necessarily imply differences in ecological function. Hence, there is a growing need for large-scale analysis of the distribution of microbial function across habitats. Here, we present a framework for investigating the biogeography of microbial function by analyzing the distribution of protein families inferred from environmental sequence data across a global collection of sites. We map over 6,000,000 protein sequences from unassembled reads from the Global Ocean Survey dataset to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e001" xlink:type="simple"/></inline-formula> protein families, generating a protein family relative abundance matrix that describes the distribution of each protein family across sites. We then use non-negative matrix factorization (NMF) to approximate these protein family profiles as linear combinations of a small number of ecological components. Each component has a characteristic functional profile and site profile. Our approach identifies common functional signatures within several of the components. We use our method as a filter to estimate functional distance between sites, and find that an NMF-filtered measure of functional distance is more strongly correlated with environmental distance than a comparable PCA-filtered measure. We also find that functional distance is more strongly correlated with environmental distance than with geographic distance, in agreement with prior studies. We identify similar protein functions in several components and suggest that functional co-occurrence across metagenomic samples could lead to future methods for de-novo functional prediction. We conclude by discussing how NMF, and other dimension reduction methods, can help enable a macroscopic functional description of marine ecosystems.</p>
      </abstract><funding-group>
        <funding-statement>This work was supported by the Defense Advanced Projects Research Agency under grants HR0011-05-1-0057 and HR0011-09-1-0055. Additional support was received from the Gordon and Betty Moore Foundation, Grant 1660, to JE, and from the National Science Foundation Award 1046001 to SL. JW holds a Career Award at the Scientific Interface from the Burroughs Wellcome Fund. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group><counts>
        <page-count count="9"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Metagenomics – large-scale sequencing of DNA isolated directly from environmental samples – has greatly facilitated the study of microbial communities <xref ref-type="bibr" rid="pone.0043866-Riesenfeld1">[1]</xref>–<xref ref-type="bibr" rid="pone.0043866-Dinsdale1">[6]</xref>. This wealth of information has created a new set of challenges in understanding the factors underlying the functional processes mediated by microbes at community, regional and global scales <xref ref-type="bibr" rid="pone.0043866-Eisen1">[2]</xref>. For example, many variants of proteins with similar functions have been identified <xref ref-type="bibr" rid="pone.0043866-Yooseph1">[7]</xref>, but little is known about whether such differences have meaningful effects on ecosystem-level function. Further, genome resequencing has revealed that the genetic composition of microbes is highly variable <xref ref-type="bibr" rid="pone.0043866-Perna1">[8]</xref>–<xref ref-type="bibr" rid="pone.0043866-Bates1">[12]</xref>, which suggests that information on taxonomic diversity is insufficient to characterize functional diversity. Thus, a complementary series of analyses are necessary to quantify the functional properties of microbial communities and to explain how differences in their functional properties relate to environmental and geographic factors. Such analyses have the potential to help form the empirical foundation for the study of microbial biogeography <xref ref-type="bibr" rid="pone.0043866-Martiny1">[13]</xref>–<xref ref-type="bibr" rid="pone.0043866-Nemergut1">[16]</xref>.</p>
      <p>Data from the Global Ocean Sampling (GOS) <xref ref-type="bibr" rid="pone.0043866-Rusch1">[5]</xref> expedition has been previously used to investigate the relationship between microbial function and environmental variables. The GOS is appealing for such studies, since it includes samples from diverse locations and habitats, allowing investigation of the interplay among biogeography, environment, and microbial functions. The GOS data set also has important technical advantages, including: numerous samples; consistent and extensive metadata; and long, information-rich, sequence reads. Gianoulis et al <xref ref-type="bibr" rid="pone.0043866-Gianoulis1">[17]</xref> introduced a canonical correlation analysis (CCA) framework that was used to identify “metabolic footprints” associated with particular environments. A follow-up study <xref ref-type="bibr" rid="pone.0043866-Patel1">[18]</xref> by the same group limited their analysis to 151 membrane protein families and used CCA again to identify relationships between protein families and environmental variables. The most recent functional analysis of GOS uses similar pathway/protein mappings and CCA methods as Gianoulis et al. <xref ref-type="bibr" rid="pone.0043866-Gianoulis1">[17]</xref>, <xref ref-type="bibr" rid="pone.0043866-Patel1">[18]</xref>, but incorporates several additional environmental measures <xref ref-type="bibr" rid="pone.0043866-Raes1">[19]</xref>. This study found that, of the climatic factors measured, temperature and sunlight were the major determinants of putative biological functions within each sample. Additionally, this study found that environmental, but not geographic, distance between samples was correlated with function.</p>
      <p>Eigenvector methods such as CCA and principal component analysis (PCA) are powerful tools for dimensional reduction, but pose problems for biological interpretation, because they represent data by adding and subtracting multiples of components with positive and negative elements, even when the original data has no negative entries (as with functional abundance counts). Here we use non-negative matrix factorization (NMF) <xref ref-type="bibr" rid="pone.0043866-Lee1">[20]</xref> methods to gain a complementary perspective on relationships between functions, environment, and biogeography. Using either approach, a community can be represented as a combination of components. NMF approximates samples using components without negative elements, and combines these components by adding positive multiples. In the context of metagenomic profiles, the components represent groups of functional or taxonomic categories that tend to co-occur in samples. Such “parts-based” representations have been useful for the recognition of features in human faces, text and gene expression <xref ref-type="bibr" rid="pone.0043866-Lee1">[20]</xref>, <xref ref-type="bibr" rid="pone.0043866-Brunet1">[21]</xref>. In eigenvector-based decompositions, most components have positive sign for some categories and negative sign for others, and samples are also described with positive contributions from some components and negative contributions from others, preventing a straightforward parts-based interpretation.</p>
      <p>The lower-dimensional structure identified by NMF methods is often very different from that of eigenvector-based methods. In particular, if microbial communities really are composed of fundamental components that combine in different proportions to make observed communities, NMF will use the data to approximate these underlying “parts”, whereas PCA will find more abstract components which have both positive and negative weights. NMF is an efficient dimension-reduction method that has been previously used in biology, especially in identifying biologically meaningful clusters of co-expressed genes in high dimensional gene expression data sets <xref ref-type="bibr" rid="pone.0043866-Brunet1">[21]</xref>–<xref ref-type="bibr" rid="pone.0043866-Devarajan1">[23]</xref>. The disadvantage of NMF is that – unlike eigenvector-based methods – it provides only an approximate decomposition, and this decomposition is sensitive to the choice of “rank” – the number of components for NMF factorization.</p>
      <p>The starting point for analyses of microbial function biogeography is a matrix containing abundance counts of functional groups or protein families for each of the sites sampled in the study. Previous studies have focused mainly on using the KEGG <xref ref-type="bibr" rid="pone.0043866-Kanehisa1">[24]</xref> database since it contains mappings between ortholog groups (KOs) and higher level groupings (KEGG Modules/Pathways), combined with using CCA as their data reduction technique. Here, we instead use the Pfam database <xref ref-type="bibr" rid="pone.0043866-Finn1">[25]</xref> which, in addition to full length protein families, contains many shorter protein domain families.</p>
      <p>In this study, we make Pfam assignments for over 6,000,000 protein sequences from the GOS, resulting in 8214 unique protein families distributed across 45 sample sites. We then apply an NMF-based framework to investigate patterns of protein family distribution and their correlation with environmental variables. We illustrate how NMF can be used as an effective data reduction method and identify Pfams with common functionality in several of the NMF components. We suggest that future methods could possibly use patterns of co-occurence of protein families across metagenomic samples as a novel non-homology based method for protein function annotation. In addition, we examine the site profiles of the components, and look for associations with geographical and environmental patterns, showing that using NMF as a filter provides further evidence that functional distance correlates better with environmental factors than geographical distance of metagenomic oceanic samples.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>NMF decomposes high-dimensional data into a small number of components</title>
        <p>We selected a subset of 45 out of a total of 79 GOS samples to avoid known problems involving contamination and outliers (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). Our selection criteria were similar to those used in other studies <xref ref-type="bibr" rid="pone.0043866-Gianoulis1">[17]</xref>–<xref ref-type="bibr" rid="pone.0043866-Raes1">[19]</xref>. These 45 samples represent a wide geographic and environmental range (<xref ref-type="supplementary-material" rid="pone.0043866.s008">Table S7</xref>). We then made Pfam assignments for all proteins found in the 45 samples, counted the Pfam assignments for each sample, and normalized these counts by the total number of assignments in the sample (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). The end result is a “profile matrix” with 45 columns representing the samples and 8214 rows representing Pfams. This profile matrix gives the estimated relative abundance of Pfams in each site and is the starting point for NMF decomposition.</p>
        <p>The NMF decomposition can be thought of as an empirical attempt to describe observed Pfam patterns in terms of a small number of functional “components” (see <xref ref-type="fig" rid="pone-0043866-g001">Figure 1</xref>). Each component is associated with a “functional profile” describing the average relative abundance of each Pfam in the component, and with a “site profile”, describing how strongly the component is represented at each site. Thus, the observed Pfam distribution at a site is approximated as a weighted sum of the functional profiles of our components, with each component's profile weighted by its site profile at that site. In explicit terms, we approximate the observed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e002" xlink:type="simple"/></inline-formula> Pfam read matrix (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e003" xlink:type="simple"/></inline-formula>) as the product of: a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e004" xlink:type="simple"/></inline-formula> matrix whose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e005" xlink:type="simple"/></inline-formula> columns are functional profiles for our components (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e006" xlink:type="simple"/></inline-formula>); and a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e007" xlink:type="simple"/></inline-formula> matrix whose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e008" xlink:type="simple"/></inline-formula> rows are the corresponding site profiles (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e009" xlink:type="simple"/></inline-formula>). The demonstrative example in <xref ref-type="fig" rid="pone-0043866-g001">Figure 1</xref>, uses a factorization of rank 2 (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e010" xlink:type="simple"/></inline-formula>) to reduce a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e011" xlink:type="simple"/></inline-formula> matrix of Pfam abundances (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e012" xlink:type="simple"/></inline-formula>) into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e013" xlink:type="simple"/></inline-formula> matrix of functional profiles (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e014" xlink:type="simple"/></inline-formula>) and a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e015" xlink:type="simple"/></inline-formula> matrix of site profiles (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e016" xlink:type="simple"/></inline-formula>). In this example, the best approximation found by NMF has one component with a functional profile very similar to that of the first site, and one that is similar to the remaining two sites.</p>
        <fig id="pone-0043866-g001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0043866.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>A conceptual illustration of NMF decomposition.</title>
            <p>Left: We start with a sample of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e017" xlink:type="simple"/></inline-formula> Pfams across <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e018" xlink:type="simple"/></inline-formula> sites, and perform a rank <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e019" xlink:type="simple"/></inline-formula> factorization, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e020" xlink:type="simple"/></inline-formula>. In real applications the reduction in rank is more dramatic. Color codes show Pfam relative abundance. Right: The subfigures illustrate different ways of looking at the decomposition using rows and columns.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.g001" xlink:type="simple"/>
        </fig>
        <p>We applied a concordance method (see <xref ref-type="sec" rid="s4">Materials and Methods</xref> and <xref ref-type="bibr" rid="pone.0043866-Jiang1">[26]</xref>) to compare possible decomposition ranks, and found that 5 is a suitable rank for the NMF decomposition of the GOS data (Figure 1 in <xref ref-type="supplementary-material" rid="pone.0043866.s010">Text S1</xref>). This means that the observed Pfam profile matrix (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e021" xlink:type="simple"/></inline-formula>) can be stably approximated using 5 functional profiles and associated site profiles.</p>
      </sec>
      <sec id="s2b">
        <title>Identifying and interpreting the biological basis of functional profiles of components</title>
        <p>The functional profiles for each of our five components are shown in <xref ref-type="fig" rid="pone-0043866-g002">Figure 2a</xref>. Each component has one or more sets of “characteristic” Pfams, which have relatively high abundance within that component and low abundance in other components (See blocks labelled by arrows in <xref ref-type="fig" rid="pone-0043866-g002">Figure 2a</xref>). However, unlike some traditional clustering approaches, NMF does not restrict Pfams to be assigned to a single component, and in fact some Pfams are found in high concentration in multiple components. For example, <xref ref-type="fig" rid="pone-0043866-g002">Figure 2a</xref> shows areas of overlap occurring on the same row between the large blocks of high concentration near the top of components 2 and 4 (The blocks indicated by blue and green arrows in <xref ref-type="fig" rid="pone-0043866-g002">Figure 2a</xref>).</p>
        <fig id="pone-0043866-g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0043866.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Functional profiles of NMF generated components and the corresponding similarity matrix.</title>
            <p>a) Five ecological components identified by using NMF across Pfam functional profiles (rows). Colored arrows roughly indicate the clusters of “characteristic” Pfams corresponding to each of the five components; black arrows roughly indicate the cluster of “ubiquitous” Pfams. b) Pfam profile similarity matrices generated using NMF filtering. The matrices are aligned so that the same row corresponds to the same Pfam in each matrix. Pfams with similar profiles are grouped by applying spectral reordering to the similarity matrix (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). Due to visualization and computational limitations, a random subset of 1000 Pfams are used for ordering and display.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.g002" xlink:type="simple"/>
        </fig>
        <p>We then constructed a Pfam similarity matrix, using NMF as a <italic>filter</italic> (<xref ref-type="fig" rid="pone-0043866-g002">Figure 2b</xref>). This filtered similarity matrix shows clearer patterns of clustering than we find using “direct” similarity or PCA-based filtering (<xref ref-type="fig" rid="pone-0043866-g002">Figure 2</xref> in <xref ref-type="supplementary-material" rid="pone.0043866.s010">Text S1</xref>). These clusters naturally overlap in many cases, illustrating the advantages of not relying on a strict clustering algorithm. Most of the clusters in the similarity matrix correspond to Pfam blocks dominated by a single component, as can be seen by comparing with <xref ref-type="fig" rid="pone-0043866-g002">Figure 2a</xref>. However, the third cluster instead corresponds to Pfams that are broadly distributed across all of the components. This can be seen by comparison with <xref ref-type="fig" rid="pone-0043866-g002">Figure 2a</xref> (the Pfam block indicated by black arrows), or by the mid-intensity cross that encompasses the white core of the cluster in in <xref ref-type="fig" rid="pone-0043866-g002">Figure 2b</xref>.</p>
        <p>To better understand the functional relevance of the NMF components, we identified Pfams that were strongly associated with each component. We applied NMF on the whole Pfam profile and we selected Pfams based on the <italic>correlation</italic> between their spatial distribution and the site profile of each component (<xref ref-type="fig" rid="pone-0043866-g003">Figure 3a</xref>). We contend that this correlation-based approach is preferable to “specificity-” <xref ref-type="bibr" rid="pone.0043866-Jiang1">[26]</xref> or “projection-” <xref ref-type="bibr" rid="pone.0043866-Saez1">[27]</xref>, <xref ref-type="bibr" rid="pone.0043866-Kim2">[28]</xref> based methods, because it avoids undue bias toward either rare or ubiquitous Pfams (see <xref ref-type="sec" rid="s4">Materials and Methods</xref> and <xref ref-type="fig" rid="pone-0043866-g004">Figure 4</xref> in <xref ref-type="supplementary-material" rid="pone.0043866.s010">Text S1</xref>).</p>
        <fig id="pone-0043866-g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0043866.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Components across sites.</title>
            <p>a) Weight for each of the five components at each of the 45 sites (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e022" xlink:type="simple"/></inline-formula>); b) the site-similarity matrix (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e023" xlink:type="simple"/></inline-formula>); c) environmental variables for the sites. The matrices are aligned so that the same row corresponds to the same site in each matrix. Sites are ordered by applying spectral reordering to the similarity matrix (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). Rows are aligned across the three matrices.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.g003" xlink:type="simple"/>
        </fig>
        <p>We found that some of our components had a suite of strongly associated Pfams whose distribution across sites was strongly correlated with the site profile of the component. Component 2 had the clearest group of strongly associated Pfams (126 Pfams have a correlation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e024" xlink:type="simple"/></inline-formula> to this component). Components 1 and 5 also had groups of Pfams with relatively high correlation values (28 and 52 Pfams have a correlation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e025" xlink:type="simple"/></inline-formula> to component 1 and 5 respectively), while Components 3 and 4 did not have any strongly associated Pfams (Figure 7 in <xref ref-type="supplementary-material" rid="pone.0043866.s010">Text S1</xref>).</p>
        <p>To determine if there are particular functions that are associated with each of the components, we manually inspected the lists of Pfams that were most strongly correlated with their respective component. Interestingly, we found commonality in the functional annotation of Pfams associated with components that had strongly associated Pfams (i.e., Components 1, 2, and 5) (<xref ref-type="supplementary-material" rid="pone.0043866.s002">Table S1</xref>, <xref ref-type="supplementary-material" rid="pone.0043866.s003">S2</xref> and <xref ref-type="supplementary-material" rid="pone.0043866.s006">S5</xref>). Using the 100 most strongly associated Pfams for each component, we found that 40% of the Pfams with known function were related to transport and signalling in Component 1 (which we call “Signalling”) (<xref ref-type="supplementary-material" rid="pone.0043866.s002">Table S1</xref>); 37% of the Pfams with known function were photosystem-associated in Component 2 (“Photosystem”); and 22% of the Pfams with known function were phage-associated in Component 5 (“Phage”) (See <xref ref-type="supplementary-material" rid="pone.0043866.s006">Table S5</xref>). In Components 3 and 4, which did not have strongly associated Pfams (<xref ref-type="supplementary-material" rid="pone.0043866.s004">Tables S3</xref>, <xref ref-type="supplementary-material" rid="pone.0043866.s005">S4</xref>), we could not identify any functional patterns. Components 3 and 4 may represent combinations of different ecological components that are not separated in this particular decomposition.</p>
        <p>The proportion of Pfams without any annotations ranged from 15% (Component 4) to 54% (Component 2: Photosystem). Unidentified Pfams with high association to Components 1, 2 and 5 may have similar functional themes to other Pfams seen in these components, or they may have functions that are ecologically linked to the identified theme, or they may be associated taxonomically rather than functionally (ie., they may be expressed by the same taxa that express the identified Pfams). In the future, we suggest developing statistical methods to identify groups of strong associations, and associated false discovery rates.</p>
        <p>Additionally, we inspected the Pfams that were associated with the “ubiquitous” cluster previously identified in <xref ref-type="fig" rid="pone-0043866-g002">Figure 2</xref>. Many of these Pfams are associated with bacterial primary metabolism and only 1% of these had unknown functions (<xref ref-type="supplementary-material" rid="pone.0043866.s007">Table S6</xref>). This is a striking difference compared to the 15–54% proportion of unknown Pfams seen in the five NMF components.</p>
      </sec>
      <sec id="s2c">
        <title>Characterizing the site profiles of components</title>
        <p><xref ref-type="fig" rid="pone-0043866-g003">Figure 3a</xref> shows the estimated site profile for each of the five components. Components 2 (Photosystem) and 4 (Unidentified) are broadly distributed; Components 1 (Signalling) and 5 (Phage) are largely restricted to a handful of sites; and component 3 (Unidentified) shows an intermediate pattern. There is a great deal of overlap between site profiles for different components. For example, component 3 has relatively high similarity to components 2 and 4 (0.57 and 0.65 respectively, see <xref ref-type="fig" rid="pone-0043866-g002">Figure 2</xref> in <xref ref-type="supplementary-material" rid="pone.0043866.s010">Text S1</xref> for a similarity heatmap among components).</p>
        <p><xref ref-type="fig" rid="pone-0043866-g003">Figure 3b</xref> shows the pattern of filtered similarity between sites. We see clear patterns of grouping, which do not emerge when we calculate functional distances without filtering, or use PCA rather than NMF filtering (<xref ref-type="fig" rid="pone-0043866-g003">Figure 3</xref> in <xref ref-type="supplementary-material" rid="pone.0043866.s010">Text S1</xref>). As with the Pfams, we see clusters roughly associated with our components, but there is more overlap than with the Pfam clusters (<xref ref-type="fig" rid="pone-0043866-g002">Figure 2b</xref>).</p>
        <p><xref ref-type="fig" rid="pone-0043866-g003">Figure 3c</xref> shows the distribution of environmental variables measured at each site. Inspection of <xref ref-type="fig" rid="pone-0043866-g003">Figure 3</xref> reveals qualitative correspondence between environmental factors and clusters of similar sites in the similarity matrix. For example, the “North American East Coast” samples are divided into two groups in the bottom right of the similarity matrix (See <xref ref-type="fig" rid="pone-0043866-g003">Figure 3b</xref>). Inspection of the environmental features suggests that the split in these samples also corresponds with differences in insolation and water depth.</p>
        <p>We can also examine patterns of similarity between the components themselves, using site profiles or functional profiles (see <xref ref-type="fig" rid="pone-0043866-g005">Figure 5</xref> in <xref ref-type="supplementary-material" rid="pone.0043866.s010">Text S1</xref>). All 5 components have strikingly high similarities in their functional profiles, indicating a lot of Pfams which are well represented in many components. Similarity in site profiles is much lower on average, indicating that many pairs of components do not tend to overlap within samples. Overall patterns of similarity also differ: for example, the Phage component (5) and Signalling component (1) have a very high level of functional similarity, but very low similarity in their site profiles.</p>
      </sec>
      <sec id="s2d">
        <title>Measuring functional distance using an NMF filter</title>
        <p>Based on the clear patterns in <xref ref-type="fig" rid="pone-0043866-g003">Figure 3</xref>, we hypothesized that NMF-filtered Pfam distance would be a useful metric for functional distance between sites. To test this idea, we compared how well different measures of functional distance were modeled by a combination of environmental distance and geographic distances in a naive regression model. Using adjusted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e026" xlink:type="simple"/></inline-formula> as a measure of overall correlation, we found that the correlation of NMF-filtered Pfam distance with environmental and geographic distances (overall adjusted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e027" xlink:type="simple"/></inline-formula>) was comparable to that of unfiltered Pfam distance (adjusted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e028" xlink:type="simple"/></inline-formula>), and higher than that of PCA-filtered Pfam distance using the same number of components (adjusted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e029" xlink:type="simple"/></inline-formula>). This suggests that the NMF filtering retains more information relevant to these correlations than PCA filtering.</p>
        <p>Therefore, we used NMF-filtered Pfam distance to ask about patterns across sites. Specifically, how did functional distance between sites correlate with environmental and geographic distance? Environmental distances were calculated as Euclidean distances of normalized environmental variables (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>), while geographic distances were calculated using great circles. We used logged geographic distances as our main predictor so as not to give too much emphasis to large distances in our linear models.</p>
        <p>We found that our measure of functional distance was more correlated with overall environmental distance (<xref ref-type="fig" rid="pone-0043866-g004">Figure 4a</xref>) than with logged geographic distance (<xref ref-type="fig" rid="pone-0043866-g004">Figure 4b</xref>). We confirmed this result with a multivariate Mantel test; when both distances were used as predictors, the partial correlation between Pfam distance and environmental distance (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e030" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e031" xlink:type="simple"/></inline-formula>) was much higher than that between Pfam distance and logged geographic distance (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e032" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e033" xlink:type="simple"/></inline-formula>). This result was similar to that found by <xref ref-type="bibr" rid="pone.0043866-Raes1">[19]</xref>, although our partial correlation for environmental distance was substantially higher (0.45 vs. 0.27). Although it was also statistically significant, the partial correlation with geographic distance (0.11) seems so low as to be biologically negligible. These results were robust to different choices of ranks in the NMF decomposition (Figure 8 in <xref ref-type="supplementary-material" rid="pone.0043866.s010">Text S1</xref>).</p>
        <fig id="pone-0043866-g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0043866.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Pairwise correlation between distances.</title>
            <p>a. Environmental distance vs. functional distance (cor = 0.451, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e034" xlink:type="simple"/></inline-formula>, regular Mantel test). b. Logged geographic distance vs. functional distance (cor = 0.127/P = 0.014).</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.g004" xlink:type="simple"/>
        </fig>
        <p>Next, we superimposed the Pfam similarity matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e035" xlink:type="simple"/></inline-formula> on a global map to visualize how functional differences were influenced by environmental conditions and geographic location (see <xref ref-type="fig" rid="pone-0043866-g005">Figure 5</xref>). In the global map we connected sites based on their functional similarity and their environmental similarity respectively. The number of lines connecting sites depended on an arbitrary choice of similarity threshold. A movie showing how this pattern changes over a wide range of thresholds is available as Movie S1. Many early links were established between sites that were well-separated geographically, consistent with our result that the Pfam similarity of microbial communities was more strongly associated with environmental differences than with physical distance.</p>
        <fig id="pone-0043866-g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0043866.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Functional and environmental similarity on a global map.</title>
            <p>The 120 pairs of sites with highest functional (environmental) similarity are linked in blue (green). Environmental similarity is calculated from the environmental distance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e036" xlink:type="simple"/></inline-formula> using the transformation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e037" xlink:type="simple"/></inline-formula>. A movie showing this pattern over a range of similarity thresholds is available as Movie S1.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.g005" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>A significant challenge in metagenomic data analysis is distinguishing important functions and informative patterns from the thousands of functions and/or taxa that are initially identified. In this study, we illustrated how NMF could be used to find functional patterns without supervision. We approximated the GOS dataset of over 6,000,000 unique protein sequences, representing 8214 Pfam abundances distributed across 45 sites, as a combination of five components, each with a characteristic functional profile and site profile. We showed that using this NMF decomposition as a lens allowed identification of novel patterns of clustering of Pfams, and overlaps between these clusters. We looked for groups of Pfams whose distribution across sites was strongly correlated with the identified components, and found three examples of components in which there were identifiable trends in functional annotation corresponding to signalling, photosystem, and phage-associated Pfams.</p>
      <p>The NMF lens also allowed us to identify overlapping clusters of the 45 sites in our study. Again, this gave us a novel view on the relationship between sites. In particular, NMF filtering yielded sharper patterns of site similarity than are seen with directly measured similarity or PCA-based similarity (<xref ref-type="fig" rid="pone-0043866-g003">Figure 3</xref> in <xref ref-type="supplementary-material" rid="pone.0043866.s010">Text S1</xref>). We also found evidence that functional profiles of sites were more strongly correlated with environmental distance than with geographic distance. This correlation has been observed before in the GOS dataset <xref ref-type="bibr" rid="pone.0043866-Raes1">[19]</xref>, where function was inferred using the KEGG database, rather than the Pfam database used here. In this case, we found that the use of NMF filtering greatly increased the amount of overall correlation seen. This is likely due to filtered distances being less dependent on differences in ubiquitous Pfams. We suggest that filtered distances, and NMF filtering in particular, may provide an improved means to measure the functional distance between sites.</p>
      <p>Although we have focused primarily on the use of NMF as a means to analyze function at a community level, NMF may also help to make specific biological predictions in assigning functions to domains of unknown function (DUFs). For example, we found that many Pfams that are strongly associated with component 2 (photosystem-related) and component 5 (phage-related) using our correlation approach (<xref ref-type="fig" rid="pone-0043866-g004">Figure 4</xref> in <xref ref-type="supplementary-material" rid="pone.0043866.s010">Text S1</xref>) are Domains of Unknown Function (DUFs). Follow-up analysis of the closest taxonomic matches to these DUFs is consistent with many of them sharing function with other members of the component, i.e., DUFs from component 2 have close matches to photoautotrophs (largely cyanobacteria) whereas DUFs from component 5 have close matches to phages.</p>
      <p>This clustering of Pfams is similar to the idea of phylogenetic profiling <xref ref-type="bibr" rid="pone.0043866-Pellegrini1">[29]</xref>, which detects proteins that have similar co-occurrence profiles across hundreds or thousands of genomes and has been used to generate hypotheses for functional annotation of unknown proteins <xref ref-type="bibr" rid="pone.0043866-Wu1">[30]</xref>. In contrast, our approach works by associating genes across communities from metagenomic samples. It is important to note that genes associated by this method may be from the same or different organisms; further refinement and testing are needed before any novel annotation can be assigned. For example, it will be of interest to investigate how correlation between DUFs and protein families with known function change as the NMF rank is increased. Moving forward, this sort of “community profiling” could provide a useful tool, which would improve as more metagenomic samples are analyzed.</p>
      <p>Metagenomic data provide remarkable detail coding for the functionalities of the species that comprise ecosystems, but much of that detail is likely irrelevant to the robustness of the properties that characterize those systems at macroscopic levels. As we have shown, NMF can help link the microscopic to the macroscopic as part of a statistical framework that extracts the signal from the noise; however more work is needed. Here we have focused on protein families, but deeper understanding of function will require linking these protein families to metabolic pathways. Bridging from metagenomic reads to pathways in broad-scale analyses will allow us to work toward a point where quantitative predictions of community functions can be made based on sequence data as a starting point for detailed biogeochemical analysis. This approach provides hope for developing a macroscopic functional description of marine ecosystems, broadly analogous to so-called “life-zones” in terrestrial ecosystems <xref ref-type="bibr" rid="pone.0043866-Holdridge1">[31]</xref>, <xref ref-type="bibr" rid="pone.0043866-Whittaker1">[32]</xref>, in which the broad characteristics of ecological communities can be inferred from physico-chemical parameters.</p>
    </sec>
    <sec id="s4" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>Datasets</title>
        <sec id="s4a1">
          <title>Pfam profile</title>
          <p>The Global Ocean Sampling expedition <xref ref-type="bibr" rid="pone.0043866-Rusch1">[5]</xref> is a complex data set. We selected a subset of samples which had been processed in similar ways. In particular, we used only samples with filter size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e038" xlink:type="simple"/></inline-formula>, and excluded samples that appeared to represent completely distinct environmental conditions, such as those from freshwater environments. An additional ten samples with very few reads were deleted, while another six samples were excluded due to no hits being found in a preliminary search against the SEED protein database on the MG-RAST server <xref ref-type="bibr" rid="pone.0043866-Meyer1">[33]</xref>. Lastly, four samples that were extreme outliers in a preliminary NMF analysis (GS000a, GS020, GS032 and GS033) were not included. The final dataset is composed of 45 samples, summarized in <xref ref-type="supplementary-material" rid="pone.0043866.s008">Table S7</xref>.</p>
          <p>A total of 20,729,138 protein sequences from unassembled reads for the 45 samples were downloaded from CAMERA <xref ref-type="bibr" rid="pone.0043866-Sun1">[34]</xref>, and searched using HMMER 3.0 (<ext-link ext-link-type="uri" xlink:href="http://hmmer.org" xlink:type="simple">http://hmmer.org</ext-link>) against all 11,912 protein families from the Pfam database version 24 <xref ref-type="bibr" rid="pone.0043866-Finn1">[25]</xref> using Pfam's per-family gathering threshold cutoffs. The Pfam database has since been updated to version 26, but due to the large computational requirements of the original annotation, version 24 of Pfam was kept for analysis. Multiple Pfams were allowed to be mapped to the same protein since Pfams often represent protein domains and many proteins are multi-domain. In all, 8,040,951 Pfam assignments were identified in 6,010,368 protein sequences and 8214 different Pfams were found at least once in the 45 samples. The number of assignments for each Pfam was counted per sample, and the counts were normalized to the number of Pfams assignments in the sample. The result is a matrix of Pfam relative abundances (Pfam profile matrix) with 8214 rows (one for each Pfam) and 45 columns (one for each sample), whose column sums are equal to one.</p>
        </sec>
        <sec id="s4a2">
          <title>Geographic distance</title>
          <p>Geographic distances were calculated as pairwise distances among sample locations using the great circle route as well as the latitude and longitude recorded in the GOS sample metadata. We used log-transformed geographic distances in correlation analyses so as to not give undue weight to very large distances.</p>
        </sec>
        <sec id="s4a3">
          <title>Environmental factors</title>
          <p>We extracted salinity, sample depth, chlorophyll level, temperature and water depth from the GOS metadata <xref ref-type="bibr" rid="pone.0043866-Rusch1">[5]</xref>, and these values are shown in <xref ref-type="supplementary-material" rid="pone.0043866.s009">Table S8</xref>. Total incident solar insolation at the surface was obtained from the NASA Surface meteorology and Solar Energy (SSE, <ext-link ext-link-type="uri" xlink:href="http://eosweb.larc.nasa.gov/sse/" xlink:type="simple">http://eosweb.larc.nasa.gov/sse/</ext-link>) Release 6.0 Data Set (Jan 2008) 22-year Monthly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e039" xlink:type="simple"/></inline-formula> Annual Average (July 1983–June 2005). Missing environmental values were estimated as the average value for the respective variable. We used the square root of water depth in correlation analyses to avoid over-weighting samples taken over the very deep ocean.</p>
        </sec>
      </sec>
      <sec id="s4b">
        <title>Non-negative matrix factorization (NMF)</title>
        <p>If we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e040" xlink:type="simple"/></inline-formula> Pfams and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e041" xlink:type="simple"/></inline-formula> samples, then the size of the profile matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e042" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e043" xlink:type="simple"/></inline-formula>. NMF decomposition finds matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e044" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e045" xlink:type="simple"/></inline-formula>, (with dimension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e046" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e047" xlink:type="simple"/></inline-formula>, respectively, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e048" xlink:type="simple"/></inline-formula> is the <italic>rank</italic> of our factorization) such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e049" xlink:type="simple"/></inline-formula>. We search for non-negative approximations that minimize the Kullback–Leibler (KL) divergence between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e050" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e051" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pone.0043866-Lee1">[20]</xref>, <xref ref-type="bibr" rid="pone.0043866-Brunet1">[21]</xref>.</p>
        <sec id="s4b1">
          <title>Selecting the rank for NMF decomposition</title>
          <p>We have introduced a method based on the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e052" xlink:type="simple"/></inline-formula> matrix for choosing an appropriate rank (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e053" xlink:type="simple"/></inline-formula>) for NMF analysis in the presence of overlap <xref ref-type="bibr" rid="pone.0043866-Jiang1">[26]</xref>. Approximate factorizations are typically found iteratively from a random starting point <xref ref-type="bibr" rid="pone.0043866-Lee1">[20]</xref>, and rank is often chosen based on the stability of different realizations of this process. We constructed a symmetric similarity matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e054" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e055" xlink:type="simple"/></inline-formula> was column-normalized so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e056" xlink:type="simple"/></inline-formula> had ones down the diagonal; thus each off-diagonal entry gave the similarity of two samples as seen by our NMF decomposition. We then defined the “concordance index” <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e057" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e058" xlink:type="simple"/></inline-formula> was the mean squared difference between off-diagonal entries of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e059" xlink:type="simple"/></inline-formula> obtained from different realizations of the decomposition <xref ref-type="bibr" rid="pone.0043866-Jiang1">[26]</xref>. The concordance index <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e060" xlink:type="simple"/></inline-formula> reflected the stability of this matrix across different realizations of the factorization, and was used to select a good decomposition rank <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e061" xlink:type="simple"/></inline-formula>.</p>
        </sec>
        <sec id="s4b2">
          <title>Normalization of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e062" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e063" xlink:type="simple"/></inline-formula></title>
          <p>Appropriate normalizations are employed for different purposes. In order to construct sites and Pfams similarity matrices from the results of NMF, we normalize the columns of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e064" xlink:type="simple"/></inline-formula> (which are sites) and the rows of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e065" xlink:type="simple"/></inline-formula> (which are Pfams) respectively so that each similarity matrix has ones down the diagonal.</p>
        </sec>
        <sec id="s4b3">
          <title>Spectral reordering</title>
          <p>To investigate the clustering patterns of samples and Pfams, we employed spectral reordering instead of clustering technology because spectral reordering offers an attractive alternative for clustering <xref ref-type="bibr" rid="pone.0043866-Maetschke1">[35]</xref>. We treated the symmetric, positive, similarity matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e066" xlink:type="simple"/></inline-formula> as a weighted graph-adjacency matrix, and applied spectral reordering after an “affinity” transformation <xref ref-type="bibr" rid="pone.0043866-Maetschke1">[35]</xref>. Choosing the scale <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e067" xlink:type="simple"/></inline-formula> of the affinity transformation is a complex problem <xref ref-type="bibr" rid="pone.0043866-ZelnikManor1">[36]</xref>, <xref ref-type="bibr" rid="pone.0043866-Alzate1">[37]</xref>. We chose the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e068" xlink:type="simple"/></inline-formula> that minimized the Laplacian distance criterion for the untransformed matrix.</p>
        </sec>
      </sec>
      <sec id="s4c">
        <title>Selecting Pfam similarity groups</title>
        <p>We and others <xref ref-type="bibr" rid="pone.0043866-Jiang1">[26]</xref>, <xref ref-type="bibr" rid="pone.0043866-Kim2">[28]</xref> have used specificity-based methods (i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e069" xlink:type="simple"/></inline-formula>-based) to select observed elements similar to NMF basis elements. Specificity-based methods, however, can be sensitive to sampling density (under-sampled Pfams will have a tendency to look specific). Here, therefore, we instead proposed two methods based on similarity and correlation respectively. Given a Pfam <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e070" xlink:type="simple"/></inline-formula> and a component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e071" xlink:type="simple"/></inline-formula>, we defined the similarity between them as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e072" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e073" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e074" xlink:type="simple"/></inline-formula> denoted the normalization of them by their Euclidean norms. In the “correlation” method, we used the Pearson correlation coefficient for the correlation between a component profile and a Pfam profile. We found that the correlation method was better than specificity- and similarity-based methods in selecting Pfams. To investigate the possible function of components, we selected the 100 most strongly associated Pfams for each component to investigate their known functions.</p>
      </sec>
      <sec id="s4d">
        <title>Measuring functional distance between sites</title>
        <p>We propose a method for measuring sample distance based on NMF filtering of Pfam profiles. The matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e075" xlink:type="simple"/></inline-formula> gives the coefficients that approximate each site's functional profile as a linear combination of site profiles. We thus used Euclidean distances between columns of the normalized matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e076" xlink:type="simple"/></inline-formula> as a measure of functional distance. We called functional distance calculated using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e077" xlink:type="simple"/></inline-formula> a “filtered” functional distance. We also calculated “unfiltered” distances, based on Euclidean distances between columns of the original Pfam matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0043866.e078" xlink:type="simple"/></inline-formula>.</p>
      </sec>
      <sec id="s4e">
        <title>Mantel statistics and permutation tests</title>
        <p>Mantel tests are used to test the significance of correlations between dissimilarity or distance matrices, while controlling for underlying correlation structure. The statistical method is widely used in ecology studies to test the linear or monotonic independence of the elements in two distance matrices <xref ref-type="bibr" rid="pone.0043866-Martiny1">[13]</xref>, <xref ref-type="bibr" rid="pone.0043866-Raes1">[19]</xref>. Furthermore, a recent study suggested that Mantel test is a robust and powerful tool to be used in ecological analysis <xref ref-type="bibr" rid="pone.0043866-Borcard11">[38]</xref>. The “ecodist” and “vegan” packages in R were used to compute Euclidean distance for the Mantel and partial Mantel statistical analysis. 999 permutations in each test were used to obtain the p-value.</p>
      </sec>
      <sec id="s4f">
        <title>Pfam function mining</title>
        <p>Pfams within the 5 components were manually inspected for possible trends and common functions by looking at the Pfam annotations as well as Gene Ontology annotations using Pfam2GO.</p>
      </sec>
      <sec id="s4g">
        <title>Scripts and data</title>
        <p>All of the data and scripts used in our analysis are available at <ext-link ext-link-type="uri" xlink:href="http://yushan.mcmaster.ca/theobio/GOS_NMF/" xlink:type="simple">http://yushan.mcmaster.ca/theobio/GOS_NMF/</ext-link>.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pone.0043866.s001" mimetype="image/gif " orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.s001" xlink:type="simple">
        <label>Movie S1</label>
        <caption>
          <p>
            <bold>Patterns of functional and environmental similarity visualized on a global map across a range of thresholds.</bold>
          </p>
          <p>(GIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0043866.s002" mimetype="text/comma-separated-values" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.s002" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p>
            <bold>Pfams associated with functional component 1 (“Signalling”), along with GO annotations.</bold>
          </p>
          <p>(CSV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0043866.s003" mimetype="text/comma-separated-values" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.s003" xlink:type="simple">
        <label>Table S2</label>
        <caption>
          <p>
            <bold>Pfams associated with functional component 2 (“Photosystem”), along with GO annotations.</bold>
          </p>
          <p>(CSV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0043866.s004" mimetype="text/comma-separated-values" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.s004" xlink:type="simple">
        <label>Table S3</label>
        <caption>
          <p>
            <bold>Pfams associated with functional component 3 (“Unknown”), along with GO annotations.</bold>
          </p>
          <p>(CSV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0043866.s005" mimetype="text/comma-separated-values" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.s005" xlink:type="simple">
        <label>Table S4</label>
        <caption>
          <p>
            <bold>Pfams associated with functional component 4 (“Unknown”), along with GO annotations.</bold>
          </p>
          <p>(CSV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0043866.s006" mimetype="text/comma-separated-values" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.s006" xlink:type="simple">
        <label>Table S5</label>
        <caption>
          <p>
            <bold>Pfams associated with functional component 5 (“Bacteriophage”), along with GO annotations.</bold>
          </p>
          <p>(CSV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0043866.s007" mimetype="text/comma-separated-values" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.s007" xlink:type="simple">
        <label>Table S6</label>
        <caption>
          <p>
            <bold>Pfams similar to the “ubiquitous” cluster, along with GO annotations.</bold>
          </p>
          <p>(CSV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0043866.s008" mimetype="text/comma-separated-values" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.s008" xlink:type="simple">
        <label>Table S7</label>
        <caption>
          <p>
            <bold>Description of selected GOS samples.</bold>
          </p>
          <p>(CSV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0043866.s009" mimetype="text/comma-separated-values" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.s009" xlink:type="simple">
        <label>Table S8</label>
        <caption>
          <p>
            <bold>Environmental data associated with selected GOS samples.</bold>
          </p>
          <p>(CSV)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0043866.s010" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0043866.s010" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>
            <bold>Supporting figures and descriptions.</bold>
          </p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors thank Miguel Fortuna for helpful conversations that contributed to project development. The authors thank several anonymous reviewers for feedback on the manuscript.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pone.0043866-Riesenfeld1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Riesenfeld</surname><given-names>CS</given-names></name>, <name name-style="western"><surname>Schloss</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Handelsman</surname><given-names>J</given-names></name> (<year>2004</year>) <article-title>Metagenomics: genomic analysis of microbial communities</article-title>. <source>Annu Rev Genet</source> <volume>38</volume>: <fpage>525</fpage>–<lpage>52</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Eisen1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eisen</surname><given-names>JA</given-names></name> (<year>2007</year>) <article-title>Environmental shotgun sequencing: its potential and challenges for studying the hidden world of microbes</article-title>. <source>PLoS Biol</source> <volume>5</volume>: <fpage>e82</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Wooley1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wooley</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Godzik</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Friedberg</surname><given-names>I</given-names></name> (<year>2010</year>) <article-title>A primer on metagenomics</article-title>. <source>PLoS Comput Biol</source> <volume>6</volume>: <fpage>e1000667</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Handelsman1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Handelsman</surname><given-names>J</given-names></name> (<year>2004</year>) <article-title>Metagenomics: application of genomics to uncultured microorganisms</article-title>. <source>Microbiol Mol Biol Rev</source> <volume>68</volume>: <fpage>669</fpage>–<lpage>85</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Rusch1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rusch</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Halpern</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Sutton</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Heidelberg</surname><given-names>KB</given-names></name>, <name name-style="western"><surname>Williamson</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>The Sorcerer II Global Ocean Sampling expedition: northwest Atlantic through eastern tropical Pacific</article-title>. <source>PLoS Biol</source> <volume>5</volume>: <fpage>e77</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Dinsdale1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dinsdale</surname><given-names>EA</given-names></name>, <name name-style="western"><surname>Edwards</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Hall</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Angly</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Breitbart</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Functional metagenomic profiling of nine biomes</article-title>. <source>Nature</source> <volume>452</volume>: <fpage>629</fpage>–<lpage>32</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Yooseph1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yooseph</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sutton</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Rusch</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Halpern</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Williamson</surname><given-names>SJ</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>The Sorcerer II Global Ocean Sampling expedition: expanding the universe of protein families</article-title>. <source>PLoS Biol</source> <volume>5</volume>: <fpage>e16</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Perna1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Perna</surname><given-names>NT</given-names></name>, <name name-style="western"><surname>Plunkett</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Burland</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Mau</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Glasner</surname><given-names>JD</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Genome sequence of enterohaemorrhagic <italic>Escherichia coli</italic> O157:H7</article-title>. <source>Nature</source> <volume>409</volume>: <fpage>529</fpage>–<lpage>33</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Tettelin1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tettelin</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Masignani</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Cieslewicz</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Donati</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Medini</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Genome analysis of multiple pathogenic isolates of <italic>Streptococcus agalactiae</italic>: implications for the microbial “pan-genome”</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>102</volume>: <fpage>13950</fpage>–<lpage>5</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Rasko1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rasko</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Rosovitz</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Myers</surname><given-names>GS</given-names></name>, <name name-style="western"><surname>Mongodin</surname><given-names>EF</given-names></name>, <name name-style="western"><surname>Fricke</surname><given-names>WF</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>The pangenome structure of <italic>Escherichia coli</italic>: comparative genomic analysis of <italic>E. coli</italic> commensal and pathogenic isolates</article-title>. <source>J Bact</source> <volume>190</volume>: <fpage>6881</fpage>–<lpage>6893</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Kislyuk1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kislyuk</surname><given-names>AO</given-names></name>, <name name-style="western"><surname>Haegeman</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Bergman</surname><given-names>NH</given-names></name>, <name name-style="western"><surname>Weitz</surname><given-names>JS</given-names></name> (<year>2011</year>) <article-title>Genomic fluidity: an integrative view of gene diversity within microbial populations</article-title>. <source>BMC Genomics</source> <volume>12</volume>: <fpage>32</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Bates1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bates</surname><given-names>ST</given-names></name>, <name name-style="western"><surname>Cropsey</surname><given-names>GW</given-names></name>, <name name-style="western"><surname>Caporaso</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Fierer</surname><given-names>N</given-names></name> (<year>2011</year>) <article-title>Bacterial communities associated with the lichen symbiosis</article-title>. <source>Appl Environ Microbiol</source> <volume>77</volume>: <fpage>1309</fpage>–<lpage>14</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Martiny1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martiny</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Bohannan</surname><given-names>BJ</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Colwell</surname><given-names>RK</given-names></name>, <name name-style="western"><surname>Fuhrman</surname><given-names>JA</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Microbial biogeography: putting microorganisms on the map</article-title>. <source>Nat Rev Microbiol</source> <volume>4</volume>: <fpage>102</fpage>–<lpage>12</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Green1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Green</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bohannan</surname><given-names>BJ</given-names></name> (<year>2006</year>) <article-title>Spatial scaling of microbial biodiversity</article-title>. <source>Trends Ecol Evol</source> <volume>21</volume>: <fpage>501</fpage>–<lpage>7</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Green2">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Green</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Bohannan</surname><given-names>BJ</given-names></name>, <name name-style="western"><surname>Whitaker</surname><given-names>RJ</given-names></name> (<year>2008</year>) <article-title>Microbial biogeography: from taxonomy to traits</article-title>. <source>Science</source> <volume>320</volume>: <fpage>1039</fpage>–<lpage>43</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Nemergut1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nemergut</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Costello</surname><given-names>EK</given-names></name>, <name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lozupone</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Global patterns in the biogeography of bacterial taxa</article-title>. <source>Environ Microbiol</source> <volume>13</volume>: <fpage>135</fpage>–<lpage>44</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Gianoulis1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gianoulis</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Raes</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Patel</surname><given-names>PV</given-names></name>, <name name-style="western"><surname>Bjornson</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Korbel</surname><given-names>JO</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Quantifying environmental adaptation of metabolic pathways in metagenomics</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>106</volume>: <fpage>1374</fpage>–<lpage>9</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Patel1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patel</surname><given-names>PV</given-names></name>, <name name-style="western"><surname>Gianoulis</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Bjornson</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Yip</surname><given-names>KY</given-names></name>, <name name-style="western"><surname>Engelman</surname><given-names>DM</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Analysis of membrane proteins in metagenomics: networks of correlated environmental features and protein families</article-title>. <source>Genome Res</source> <volume>20</volume>: <fpage>960</fpage>–<lpage>71</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Raes1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Letunic</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Yamada</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Jensen</surname><given-names>LJ</given-names></name>, <name name-style="western"><surname>Bork</surname><given-names>P</given-names></name> (<year>2011</year>) <article-title>Toward molecular trait-based ecology through integration of biogeochemical, geographical and metagenomic data</article-title>. <source>Mol Syst Biol</source> <volume>7</volume>: <fpage>473</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Lee1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname><given-names>DD</given-names></name>, <name name-style="western"><surname>Seung</surname><given-names>HS</given-names></name> (<year>1999</year>) <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>. <source>Nature</source> <volume>401</volume>: <fpage>788</fpage>–<lpage>91</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Brunet1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brunet</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Tamayo</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Golub</surname><given-names>TR</given-names></name>, <name name-style="western"><surname>Mesirov</surname><given-names>JP</given-names></name> (<year>2004</year>) <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>101</volume>: <fpage>4164</fpage>–<lpage>9</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Kim1">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname><given-names>PM</given-names></name>, <name name-style="western"><surname>Tidor</surname><given-names>B</given-names></name> (<year>2003</year>) <article-title>Subsystem identification through dimensionality reduction of large-scale gene expression data</article-title>. <source>Genome Res</source> <volume>13</volume>: <fpage>1706</fpage>–<lpage>18</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Devarajan1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Devarajan</surname><given-names>K</given-names></name> (<year>2008</year>) <article-title>Nonnegative matrix factorization: an analytical and interpretive tool in computational biology</article-title>. <source>PLoS Comput Biol</source> <volume>4</volume>: <fpage>e1000029</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Kanehisa1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Furumichi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Tanabe</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hirakawa</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>KEGG for representation and analysis of molecular networks involving diseases and drugs</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>: <fpage>D355</fpage>–<lpage>60</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Finn1">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Finn</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Mistry</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Tate</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Coggill</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Heger</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>: <fpage>D211</fpage>–<lpage>22</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Jiang1">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jiang</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Weitz</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Dushoff</surname><given-names>J</given-names></name> (<year>2012</year>) <article-title>A non-negative matrix factorization framework for identifying modular patterns in metagenomic profile data</article-title>. <source>J Math Biol</source> <volume>64</volume>: <fpage>697</fpage>–<lpage>711</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Saez1">
        <label>27</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Saez</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Marqui</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Tirado</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Carazo</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Montano</surname><given-names>A</given-names></name> (<year>2006</year>) <article-title>Biclustering of gene expression data by Non-smooth Non-negative Matrix Factorization</article-title>. <source>BMC Bioinformatics</source> <volume>7</volume>: <fpage>78</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Kim2">
        <label>28</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Park</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>Sparse non-negative matrix factorizations via alternating non-negativity-constrained least squares for microarray data analysis</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>1495</fpage>–<lpage>502</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Pellegrini1">
        <label>29</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pellegrini</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Marcotte</surname><given-names>EM</given-names></name>, <name name-style="western"><surname>Thompson</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Eisenberg</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Yeates</surname><given-names>TO</given-names></name> (<year>1999</year>) <article-title>Assigning protein functions by comparative genome analysis: protein phylogenetic profiles</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>96</volume>: <fpage>4285</fpage>–<lpage>8</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Wu1">
        <label>30</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ren</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Durkin</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Daugherty</surname><given-names>SC</given-names></name>, <name name-style="western"><surname>Brinkac</surname><given-names>LM</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Life in hot carbon monoxide: the complete genome sequence of <italic>Carboxydothermus hydrogenoformans</italic> Z-2901</article-title>. <source>PLoS Genet</source> <volume>1</volume>: <fpage>e65</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Holdridge1">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holdridge</surname><given-names>LR</given-names></name> (<year>1947</year>) <article-title>Determination of world plant formations from simple climatic data</article-title>. <source>Science</source> <volume>105</volume>: <fpage>367</fpage>–<lpage>368</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Whittaker1">
        <label>32</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Whittaker</surname><given-names>RH</given-names></name> (<year>1962</year>) <article-title>Classification of Natural Communities</article-title>. <source>Botanical Review</source> <volume>28</volume>: <fpage>1</fpage>–<lpage>239</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Meyer1">
        <label>33</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Paarmann</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Souza</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Olson</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Glass</surname><given-names>EM</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>The metagenomics RAST server - a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>. <source>BMC Bioinformatics</source> <volume>9</volume>: <fpage>386</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Sun1">
        <label>34</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Altintas</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Community cyberinfrastructure for Advanced Microbial Ecology Research and Analysis: the CAMERA resource</article-title>. <source>Nucleic Acids Res</source> <volume>39</volume>: <fpage>D546</fpage>–<lpage>51</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Maetschke1">
        <label>35</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maetschke</surname><given-names>SR</given-names></name>, <name name-style="western"><surname>Kassahn</surname><given-names>KS</given-names></name>, <name name-style="western"><surname>Dunn</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Han</surname><given-names>SP</given-names></name>, <name name-style="western"><surname>Curley</surname><given-names>EZ</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>A visual framework for sequence analysis using n-grams and spectral rearrangement</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>737</fpage>–<lpage>44</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-ZelnikManor1">
        <label>36</label>
        <mixed-citation publication-type="other" xlink:type="simple">Zelnik-Manor L, Perona P (2004) Self-Tuning Spectral Clustering. In Proceedings of the International Conference on Neural Information Processing Systems (NIPS).</mixed-citation>
      </ref>
      <ref id="pone.0043866-Alzate1">
        <label>37</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alzate</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Suykens</surname><given-names>JA</given-names></name> (<year>2010</year>) <article-title>Multiway spectral clustering with out-of-sample extensions through weighted kernel PCA</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source> <volume>32</volume>: <fpage>335</fpage>–<lpage>47</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0043866-Borcard11">
        <label>38</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Borcard</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Legendre</surname><given-names>P</given-names></name> (<year>2012</year>) <article-title>Is the Mantel correlogram powerful enough to be useful in ecological analysis? A simulation study</article-title>. <source>Ecology</source><volume>93</volume>: <fpage>1473</fpage>–<lpage>81</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>