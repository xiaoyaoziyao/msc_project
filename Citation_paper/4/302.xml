<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-11-13357</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0027992</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Biotechnology</subject>
            <subj-group>
              <subject>Applied microbiology</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
              <subj-group>
                <subject>Metagenomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Biotechnology</subject>
          <subject>Computational Biology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Accurate Genome Relative Abundance Estimation Based on Shotgun Metagenomic Reads</article-title><alt-title alt-title-type="running-head">GRAMMy Based on Shotgun Metagenomic Reads</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Xia</surname>
            <given-names>Li C.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Cram</surname>
            <given-names>Jacob A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Chen</surname>
            <given-names>Ting</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Fuhrman</surname>
            <given-names>Jed A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Sun</surname>
            <given-names>Fengzhu</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Molecular and Computational Biology Program, Department of Biological Sciences, University of Southern California, Los Angeles, California, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Marine and Environmental Biology, Department of Biological Sciences, University of Southern California, Los Angeles, California, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Tsinghua National Laboratory for Information Science and Technology, Tsinghua University, Beijing, People's Republic of China</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Dias-Neto</surname>
            <given-names>Emmanuel</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">AC Camargo Cancer Hospital, Brazil</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">fsun@usc.edu</email></corresp>
        <fn fn-type="con">
          <p>Designed the study: LCX TC JAF FS. Implemented the model and performed the experiments: LCX. Analyzed the data sets: LCX JAC.. Wrote the paper: LCX JAC TC JAF FS.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <year>2011</year>
      </pub-date><pub-date pub-type="epub">
        <day>6</day>
        <month>12</month>
        <year>2011</year>
      </pub-date><volume>6</volume><issue>12</issue><elocation-id>e27992</elocation-id><history>
        <date date-type="received">
          <day>12</day>
          <month>7</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>30</day>
          <month>10</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Xia et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Accurate estimation of microbial community composition based on metagenomic sequencing data is fundamental for subsequent metagenomics analysis. Prevalent estimation methods are mainly based on directly summarizing alignment results or its variants; often result in biased and/or unstable estimates. We have developed a unified probabilistic framework (named GRAMMy) by explicitly modeling read assignment ambiguities, genome size biases and read distributions along the genomes. Maximum likelihood method is employed to compute Genome Relative Abundance of microbial communities using the Mixture Model theory (GRAMMy). GRAMMy has been demonstrated to give estimates that are accurate and robust across both simulated and real read benchmark datasets. We applied GRAMMy to a collection of 34 metagenomic read sets from four metagenomics projects and identified 99 frequent species (minimally 0.5% abundant in at least 50% of the data- sets) in the human gut samples. Our results show substantial improvements over previous studies, such as adjusting the over-estimated abundance for <italic>Bacteroides</italic> species for human gut samples, by providing a new reference-based strategy for metagenomic sample comparisons. GRAMMy can be used flexibly with many read assignment tools (mapping, alignment or composition-based) even with low-sensitivity mapping results from huge short-read datasets. It will be increasingly useful as an accurate and robust tool for abundance estimation with the growing size of read sets and the expanding database of reference genomes.</p>
      </abstract><funding-group><funding-statement>This research is partially supported by National Science Foundation (NSF) DMS1043075 and OCE1136818. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="13"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Microbial organisms are ubiquitous dwellers of the earth's biosphere whose activities shape the earth's biogeochemistry. Through pathogenesis and symbiosis, they also play important roles in the health and metabolism of macro-organisms. For example, the human body is inhabited by trillions of microbes, affecting our digestive system, immune system, and physiology <xref ref-type="bibr" rid="pone.0027992-Turnbaugh1">[1]</xref>. Thus, the knowledge of their presence and abundance in nature is of great relevance to ecology as well as to human well-being. To study microbes in natural environments, researchers frequently apply whole genome shotgun sequencing to uncultured samples to generate genomic sequence reads reflecting the structure of microbial communities <xref ref-type="bibr" rid="pone.0027992-Venter1">[2]</xref>, <xref ref-type="bibr" rid="pone.0027992-Tyson1">[3]</xref>. Using the sequencing data, investigators try to address basic community questions such as: <italic>who they are</italic>, <italic>how many they are</italic>, and <italic>what they do</italic>. As a consequence of the random sampling and sequencing scheme of the shotgun metagenomics approach, the presence and abundance information of metagenomes is preserved in raw reads although some studies have shown that biases in sampling can occur, as is true for virtually all approaches <xref ref-type="bibr" rid="pone.0027992-Morgan1">[4]</xref>. However, the subsequent analysis of metagenomic data remains a challenging computational problem because of the mixed nature of metagenomes and the fact that we only sequence a small fraction of them.</p>
      <p>Several computational methods have been developed to extract taxonomic information from metagenomic sequence reads. These existing methods can be separated into two classes: composition-based and alignment-based. In the composition-based approaches, similarity measures based on oligonucleotide composition, also known as k-mer frequencies, are used to classify metagenomic reads. For instances, TETRA, CompostBin, TACOA, and AbundanceBin are all reference-free methods and they cluster sequences with different binning strategies <xref ref-type="bibr" rid="pone.0027992-Diaz1">[5]</xref>, <xref ref-type="bibr" rid="pone.0027992-Chatterji1">[6]</xref>, <xref ref-type="bibr" rid="pone.0027992-Teeling1">[7]</xref>, <xref ref-type="bibr" rid="pone.0027992-Wu1">[8]</xref>. PhyloPythia uses pre-trained composition-based classifiers to group sequences <xref ref-type="bibr" rid="pone.0027992-McHardy1">[9]</xref> and Phymm trains interpolated Markov model-based classifiers <xref ref-type="bibr" rid="pone.0027992-Kelley1">[10]</xref>, <xref ref-type="bibr" rid="pone.0027992-Brady1">[11]</xref>. However, none of these binning or classification approaches is designed to estimate the relative abundance of genomes for microbial communities (or the genome relative abundance (GRA)).</p>
      <p>In the alignment-based approaches, alignment and mapping tools, such as BLAST, are commonly used to find similarity hits of the query reads to the references <xref ref-type="bibr" rid="pone.0027992-Altschul1">[12]</xref>. Some of them, such as Sort-ITEMS, use BLASTX for amino acid sequence similarity search <xref ref-type="bibr" rid="pone.0027992-MonzoorulHaque1">[13]</xref>. However, we will only focus on similarity search based on nucleic acid sequence only. The MEGAN software parses BLAST results and traces back the lowest common ancestor of ambiguously assigned reads to generate a phylogenetic distribution of the reads <xref ref-type="bibr" rid="pone.0027992-Huson1">[14]</xref>. An intuitive way of estimating GRA based on MEGAN is using the normalized read distribution along the leaves of the phylogenetic tree, leaving out the reads assigned to multiple references. However, estimation of abundance levels by this method, which discards reads with multiple origins, can be biased by many factors, including the variation of genome size <xref ref-type="bibr" rid="pone.0027992-Angly1">[15]</xref>, <xref ref-type="bibr" rid="pone.0027992-Beszteri1">[16]</xref>. The latest Genome Abundance and Average Size (GAAS) tool weighs hits by their E-values and gives a direct estimation of genome relative abundance <xref ref-type="bibr" rid="pone.0027992-Angly1">[15]</xref>. However, its accuracy and reliability are still hindered by the prevailing existence of read assignment ambiguities and the oversimplified estimation scheme.</p>
      <p>In parallel with computational developments, significant improvements in sequencing technology have also been underway. Traditional metagenomic read sets are based on Sanger sequencing, which has an average read length at about 800 bp or above. At these lengths, taxonomic origin identification for the reads is relatively easy when the reference genomes are known. However, there was only limited availability of reference genomes as well as limited sequencing depth. Therefore, the relative abundance levels could not be accurately estimated, especially for complex communities in the past. Recent wide spread adoption of next generation sequencing (NGS) technologies in the metagenomics research community has led to the emergence of several massive, but short, read sets from Roche/454 (millions of 100–400 bp reads), Illumina/Solexa and ABI/SOLiD platforms (tens of millions of 50–100 bp reads) <xref ref-type="bibr" rid="pone.0027992-Turnbaugh2">[17]</xref>, <xref ref-type="bibr" rid="pone.0027992-Qin1">[18]</xref>.</p>
      <p>The paradigm shift in sequencing technologies has impacted downstream analyses. Specifically, the identification of the origin of a read becomes more difficult for several reasons. First, a large number of short reads cannot be uniquely mapped to a specific location of one genome. Instead, they map to multiple locations of one or multiple genomes. These ambiguities are directly associated with the read length reduction in NGS technologies. Second, communities usually consist of many microbes with similar genomes, different only in some parts, making it indeed impossible to determine the origin of a particular short read based solely on its sequence.</p>
      <p>Despite these difficulties, NGS read sets have brought us richer abundance information of microbial communities than traditional datasets because of the significant increase in the number of reads. Along with the increase of read set size, efforts to assemble more reference genomes are ongoing <xref ref-type="bibr" rid="pone.0027992-Peterson1">[19]</xref>, <xref ref-type="bibr" rid="pone.0027992-Nelson1">[20]</xref>. In addition, new experimental techniques, such as single-cell sequencing approaches are being developed to sequence reference genomes directly from environmental samples <xref ref-type="bibr" rid="pone.0027992-Stepanauskas1">[21]</xref>, <xref ref-type="bibr" rid="pone.0027992-Woyke1">[22]</xref>. Thus, in view of the constraints of current computational tools and the fast expanding sequencing capacities, we are motivated to develop a new method for accurate and reliable GRA estimation, one that can meet the challenges of short reads and the growing number of reference genomes.</p>
      <p>In this paper, we introduce GRAMMy, a unified Genome Relative Abundance (GRA) estimation framework using Mixture Model theory (MMy)-based modeling of shotgun metagenomic reads. Our GRAMMy framework is a reference-based method and utilizes the nucleic acid sequence similarity or composition. We first tested GRAMMy using our simulated reads as well as some synthetic communities with real reads from other studies (the FAMeS datasets) <xref ref-type="bibr" rid="pone.0027992-Mavromatis1">[23]</xref>. Compared to other reference-based methods, including GAAS and the abundance estimates from MEGAN, GRAMMy shows greatly improved accuracy in abundance estimations. Furthermore, with a reasonable sequencing depth, GRAMMy's estimates converge to the true abundance levels and remain stable. We then analyzed 34 real metagenomic read sets with GRAMMy, the results of which yielded interesting and new insights in biology. Finally, we packaged the GRAMMy tools as a C++ extension to Python, which can be downloaded freely from GRAMMy's homepage (<ext-link ext-link-type="uri" xlink:href="http://meta.usc.edu/softs/grammy" xlink:type="simple">http://meta.usc.edu/softs/grammy</ext-link>).</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>The GRAMMy framework</title>
        <p>The GRAMMy framework is based on a mixture model for the short metagenomic reads and an Expectation Maximization (EM) algorithm, as outlined in the model schema and the analysis flowchart in <xref ref-type="fig" rid="pone-0027992-g001">Figures 1</xref> and <xref ref-type="fig" rid="pone-0027992-g002">2</xref>. GRAMMy accepts a set of shotgun reads, as well as some references (<italic>e.g.</italic> genomes, scaffolds or contigs) as inputs and subsequently performs the Maximum Likelihood Estimation (MLE) of the relative abundance levels. In the typical GRAMMy workflow, which is shown in <xref ref-type="fig" rid="pone-0027992-g002">Figure 2</xref>, the end user starts with the metagenomic read set and reference genome set and then chooses between mapping-based (‘map’) and k-mer composition-based (‘k-mer’) assignment options. In either option, after the assignment procedure, an intermediate matrix describing the probability that each read is assigned to one of the reference genomes is produced. This matrix, along with the read set and reference genome set, is fed forward to the EM algorithm module for estimation of the genome relative abundance levels. After the calculation, GRAMMy outputs the GRA estimates as a numerical vector, as well as the log-likelihood and standard errors for the estimates. If the taxonomy information for the input reference genomes is available, strain (genome) level GRA estimates can be combined to calculate high taxonomic level abundance, such as species and genus level estimates.</p>
        <fig id="pone-0027992-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0027992.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>The GRAMMy model.</title>
            <p>A schematic diagram of the finite mixture model underlies the GRAMMy framework for shotgun metagenomics. In the figure, ‘iid’ stands for “independent identically distributed”.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.g001" xlink:type="simple"/>
        </fig>
        <fig id="pone-0027992-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0027992.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>The GRAMMy flowchart.</title>
            <p>A typical flowchart of GRAMMy analysis pipeline employs ‘map’ and ‘k-mer’ assignment.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.g002" xlink:type="simple"/>
        </fig>
        <p>We implemented the computation-intensive core of GRAMMy in C++ with Standard Template Library (STL) for best performance and compatibility, and we integrated the typical workflow tools into a Python extension. Compared to other methods included in our study, we showed the superior accuracy and robustness of GRAMMy's estimates, as detailed in the following sections. Other choices of read assignment schema, such as NGS mapping tools and Markov Model-based read assignment <xref ref-type="bibr" rid="pone.0027992-Rosen1">[24]</xref>, can also be incorporated into GRAMMy, since they produce a reasonable read assignment probability matrix. The GRAMMy package is open source, and users are able to implement other workflow variants.</p>
      </sec>
      <sec id="s2b">
        <title>Simulated read benchmarks</title>
        <p>We first tested GRAMMy by using a series of simulated read sets. By using read sets generated from a collection of genomes included in the FAMeS study <xref ref-type="bibr" rid="pone.0027992-Mavromatis1">[23]</xref>, we were able to assign the true relative abundance levels and confirm the estimation accuracies by analyzing the errors between the estimates and true values. The numerical error measure RRMSE (Relative Root Mean Square Error), which computes the root mean square average of relative errors, was used to assess the accuracy and robustness of estimates. The detailed discussion of the simulation studies is provided in the <xref ref-type="supplementary-material" rid="pone.0027992.s011">Text S1</xref> and the results are presented in <xref ref-type="supplementary-material" rid="pone.0027992.s001">Figures S1</xref>, <xref ref-type="supplementary-material" rid="pone.0027992.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pone.0027992.s003">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0027992.s004">S4</xref>. <xref ref-type="supplementary-material" rid="pone.0027992.s001">Figure S1</xref> shows that all the error measures decrease to 0 as the number of reads increases. <xref ref-type="supplementary-material" rid="pone.0027992.s002">Figure S2A</xref> shows that effect of sequencing errors on the GRA estimation accuracy and it shows that sequence errors have a significant effect on short reads (&lt;200 bp) while the effect is minimal for long reads. <xref ref-type="supplementary-material" rid="pone.0027992.s002">Figure S2B</xref> shows that missing reference genomes in the reference genome set does not significantly affect the estimation accuracy for the genomes in the reference data set even if 50% of the genomes in the community are unknown. <xref ref-type="supplementary-material" rid="pone.0027992.s002">Figure S2C</xref> shows the effect of different abundance distribution on the estimation accuracy and it shows that such an effect is not significant although we do see a slight increase in the measurement errors for communities with uneven abundance distributions compared to that for the even abundance distributions. In summary, our simulations show that the GRAMMy estimates are accurate and stable across a range of anticipated scenarios.</p>
        <p>Interestingly, a relatively small number of short reads is sufficient to obtain an accurate estimate of relative abundance of the genomes, thus eliminating the need for an excessively ‘deep sequencing’ scheme in certain richness assessing scenarios. As shown by all panels in <xref ref-type="supplementary-material" rid="pone.0027992.s001">Figure S1</xref>, RRMSEs start to stabilize when the number of reads (<italic>RN</italic>) surpassed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e001" xlink:type="simple"/></inline-formula>, indicating the existence of a threshold for the number of reads needed to recover the community abundance structure. The trend also shows that a relatively small number of read sets could still provide substantial information for the abundance estimation, when the read assignment ambiguity is properly handled. However, the number of required reads depends on the number of organisms in the community and the distribution of relative abundances of the different organisms.</p>
        <p>We also compared GRAMMy to other methods. With the objective of estimating the GRA of communities, we first benchmarked GRAMMy with GAAS. In addition, we included MEGAN, which produces a read profile that summarizes the number of reads assigned to their lowest common ancestors (LCA). We estimated the GRA based on MEGAN using the normalized percentages from the reads distributed on leaf taxon. In the benchmark, we used a series of simulated read sets generated from genomes randomly selected from the FAMeS study <xref ref-type="bibr" rid="pone.0027992-Mavromatis1">[23]</xref> (see details in <xref ref-type="supplementary-material" rid="pone.0027992.s011">Text S1</xref>). The same genomes used in read generation were also used as our reference genomes. We then used BLAT to align the reads to the reference genomes and fed the output into GRAMMy, GAAS and MEGAN. The default options of GAAS and MEGAN were used in our study. <xref ref-type="supplementary-material" rid="pone.0027992.s003">Figure S3A</xref> shows the results from the simulation read sets with read lengths (<italic>RL</italic>s) equal to 100 or 400 bp generated from MetaSim <xref ref-type="bibr" rid="pone.0027992-Richter1">[25]</xref> using the ‘with sequencing errors’ option. We see that GRAMMy (‘map’) significantly outperformed GAAS, MEGAN and GRAMMy (‘k-mer’) in all settings. Among all the methods tested, GRAMMy (‘map’) is the only method with RRMSEs decreasing to zero as the number of reads increases.</p>
        <p>To account for the poor performance of other methods, we can point to several possible reasons. For GAAS, assigning ambiguous hits based on their E-value weights is <italic>ad hoc</italic> and may reduce its accuracy because the E-value is only a statistical measure for the quality of the alignment. For MEGAN, its arbitrary cutoff at the top five percent hits and its non-probabilistic handling of ambiguous hits may reduce the accuracy of GRA estimates. In addition, for both MEGAN and GAAS, there is also the possibility of losing accuracy when changing from BLAST hits to BLAT hits. While it has been argued that BLAST alignment is the best way to assign reads <xref ref-type="bibr" rid="pone.0027992-Brady1">[11]</xref>, it is too computationally intensive for BLAST-aligning every read to references <xref ref-type="bibr" rid="pone.0027992-Qin1">[18]</xref>. Instead, fast mapping tools like BLAT only keep a small number of high-similarity hits, while, at the same time, possibly reducing the accuracy of both GAAS and MEGAN. In contrast, the superior performance of GRAMMy (‘map’) shows that the probabilistic way of handling ambiguous hits could help to improve the estimation, which also gives GRAMMy an advantage over other methods when encountering incoming short read sets of very large sizes.</p>
        <p>In conclusion, when the reference set is available, the GRAMMy framework based on mapping or alignment gave the best result for GRA estimation. Thus, the ‘map’ approach is generally the method of choice in most application settings. Only when assembled reference genomes are absent, GRAMMy (‘k-mer’) is needed as a still viable solution for GRA estimation, since at <italic>RL</italic> equal to 400 bp its performance is comparable to the estimates from GAAS and MEGAN. However, the k-mer composition approach has limited power to distinguish the different genomes, as the compositions of k-mer are usually heterogeneous across the genomes. In addition, there is no genome size bias correction if ‘k-mer’ method is used without prior knowledge of genome lengths.</p>
        <p>In addition to the above methods, relative abundance estimation based on ribotype (retrieving rRNA sequences and classifying into taxonomic bins, <italic>e.g.</italic> 16S rRNA), protein marker (similar to ribotype method except replacing rRNA by protein marker, <italic>e.g. rpo</italic>B) and hit counting (counting the total number of all hits in each taxonomic bin) has been used to estimate relative abundance <xref ref-type="bibr" rid="pone.0027992-Rusch1">[26]</xref>, <xref ref-type="bibr" rid="pone.0027992-Case1">[27]</xref>, <xref ref-type="bibr" rid="pone.0027992-Biers1">[28]</xref>. We compared the 16S-based (adapted from <italic>Biers et al.</italic> <xref ref-type="bibr" rid="pone.0027992-Biers1">[28]</xref>), <italic>rpo</italic>B-based and BLAT hit counting estimates to GRAMMy estimates using our simulated read set. <xref ref-type="supplementary-material" rid="pone.0027992.s003">Figure S3B</xref> shows that GRAMMy outperformed all other methods in this controlled setting. All other methods show three obvious drawbacks: a persisting bias, significant variation and a strong dependence on the number of reads.</p>
        <p>In fact, 16S rRNA and <italic>rpo</italic>B genes are only very small parts of genomes; therefore, even if the total number of reads is large, the reads covering these genes are barely about 1/1000 of all reads. If the total number of reads is small and there are not enough reads covering 16S rRNA genes, then the method is not viable as a result of its substantial instability. Even if the total number of reads increases, due to gene copy number and genome size variations, the estimates still do not converge to the true abundance values. Similar trends were also observed when BLAT mapping hit counts were directly normalized and used for abundance estimation. On the contrary, GRAMMy always produced much more accurate and reliable estimates.</p>
        <p>For the estimates at different taxonomic levels, the estimation errors gradually decrease from the strain level to the kingdom level and are mostly small given a relatively large number of reads (see <xref ref-type="supplementary-material" rid="pone.0027992.s004">Figure S4</xref>).</p>
      </sec>
      <sec id="s2c">
        <title>Artificial metagenomes with real reads</title>
        <p>We further compared the estimates of GRAMMy with those of GAAS and MEGAN, using the third party FAMeS dataset <xref ref-type="bibr" rid="pone.0027992-Mavromatis1">[23]</xref>. The FAMeS data are comprised of three synthetic metagenomic read sets constructed by random sampling from real whole genome shotgun sequencing reads. These constructed read sets are labeled ‘simLC’, ‘simMC’ and ‘simHC’, according to different complexities of the communities. Each set is composed of approximately ten thousand Sanger reads from 113 microbial genomes. These artificially created metagenomes have considerably different abundance distributions, ranging from uniform-like in the ‘simLC’ set to steep power-law-like in the ‘simHC’ set, with the ‘simMC’ set in between. We ran GRAMMy (‘map’), MEGAN and GAAS on all three data sets.</p>
        <p>The results, which are summarized in <xref ref-type="table" rid="pone-0027992-t001">Table 1</xref>, show that the measured Relative Root Mean Square Error (RRMSE) and Average Relative Error (AVGRE) for GRAMMy (‘map’) are approximately 10–20%, while those for MEGAN-based estimates are approximately 40–50%, and those for GAAS are even larger. The benchmark further substantiates that GRAMMy (‘map’) yields the most accurate estimates for all these sets. Although the errors are not close to zero, the results are still respectable, considering that the overall sequencing depth is low in all these sets, which is, on average, less than a hundred reads per genome. The highest accuracies reachable are certainly affected by the limited number of reads and the presence of sequencing errors in these read sets. Nonetheless, recent real read sets are frequently two to three orders of magnitude larger than the FAMeS data, making accurate GRA estimation more feasible.</p>
        <table-wrap id="pone-0027992-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0027992.t001</object-id><label>Table 1</label><caption>
            <title>Comparison of estimation accuracy.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0027992-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="2" rowspan="1">simLC</td>
                <td align="left" colspan="2" rowspan="1">simMC</td>
                <td align="left" colspan="2" rowspan="1">simHC</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">RRMSE</td>
                <td align="left" colspan="1" rowspan="1">AVGRE</td>
                <td align="left" colspan="1" rowspan="1">RRMSE</td>
                <td align="left" colspan="1" rowspan="1">AVGRE</td>
                <td align="left" colspan="1" rowspan="1">RRMSE</td>
                <td align="left" colspan="1" rowspan="1">AVGRE</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">GRAMMy</td>
                <td align="left" colspan="1" rowspan="1">20.0%</td>
                <td align="left" colspan="1" rowspan="1">14.0%</td>
                <td align="left" colspan="1" rowspan="1">25.6%</td>
                <td align="left" colspan="1" rowspan="1">19.7%</td>
                <td align="left" colspan="1" rowspan="1">21.6%</td>
                <td align="left" colspan="1" rowspan="1">14.7%</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">MEGAN</td>
                <td align="left" colspan="1" rowspan="1">48.6%</td>
                <td align="left" colspan="1" rowspan="1">39.3%</td>
                <td align="left" colspan="1" rowspan="1">50.0%</td>
                <td align="left" colspan="1" rowspan="1">40.6%</td>
                <td align="left" colspan="1" rowspan="1">50.2%</td>
                <td align="left" colspan="1" rowspan="1">40.8%</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">GAAS</td>
                <td align="left" colspan="1" rowspan="1">433.8%</td>
                <td align="left" colspan="1" rowspan="1">152.5%</td>
                <td align="left" colspan="1" rowspan="1">171.4%</td>
                <td align="left" colspan="1" rowspan="1">111.6%</td>
                <td align="left" colspan="1" rowspan="1">507.9%</td>
                <td align="left" colspan="1" rowspan="1">165.8%</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p><xref ref-type="table" rid="pone-0027992-t001">Table 1:</xref> Comparison of estimation accuracy. A summary of Relative Root Mean Square Error (RRMSE) and Average Relative Error (AVGRE) measured from MEGAN-based, GAAS and GRAMMy (‘map’) estimates of simLC, simMC and simHC subsets of the FAMeS data. GRAMMy (‘map’) has the lowest error rate for both error measures across all the subsets.</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s2d">
        <title>Meta-analysis of human gut metagenomes</title>
        <p>The human gastrointestinal tract harbors the largest group of human symbiotic microbes. Several shotgun metagenomics studies on these communities have been published. With more than six hundred human-related bacteria reference genomes publicly available, we are well positioned to use these datasets to illustrate the practical uses of GRAMMy. We collected ‘gut’ data from three major human gut metagenome projects including two U.S. human distal guts (∼800 bp Sanger reads, ∼100,000 reads per sample, labeled ‘hg’), 18 U.S. adult samples from twin families (∼250 bp 454 reads, ∼500,000 reads per sample, obese and lean, labeled ‘uhg’), and 13 Japanese gut samples (∼800 bp Sanger reads, ∼100,000 reads per sample, weaned or unweaned infants and adults, labeled ‘jhg’) <xref ref-type="bibr" rid="pone.0027992-Turnbaugh2">[17]</xref>, <xref ref-type="bibr" rid="pone.0027992-Gill1">[29]</xref>, <xref ref-type="bibr" rid="pone.0027992-Kurokawa1">[30]</xref>.</p>
        <p>For the reference set for the 33 human gut samples, we used a comprehensive collection of human gut microbes (labeled ‘HGS’), containing 388 currently available human gastrointestinal microbial genomes from multiple sources (see <xref ref-type="supplementary-material" rid="pone.0027992.s007">Table S1A</xref>). BLAT was used to assign metagenomic reads to the ‘HGS’ set according to their alignment similarities, and the overall study was labeled using the combination of the read set name, the reference genome set name, and the cut-off identity rate, such as ‘hg_HGS_90’, ‘uhg_HGS_90’, ‘jhg_HGS_90’. The results with cut-off at ‘90 percent’ identity rate are summarized in <xref ref-type="table" rid="pone-0027992-t002">Table 2</xref> and that from both ‘75’ and ‘90’ are provided in <xref ref-type="supplementary-material" rid="pone.0027992.s008">Tables S2</xref>, <xref ref-type="supplementary-material" rid="pone.0027992.s009">S3</xref>.</p>
        <table-wrap id="pone-0027992-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0027992.t002</object-id><label>Table 2</label><caption>
            <title>Summary statistics for the metagenomic datasets.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0027992-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.t002" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="3" rowspan="1">Mapped rate (%)</td>
                <td align="left" colspan="3" rowspan="1">Ambiguity rate (%)</td>
                <td align="left" colspan="3" rowspan="1">Average Genome Length (bp)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Data (# Sets)</td>
                <td align="left" colspan="1" rowspan="1">Med.</td>
                <td align="left" colspan="1" rowspan="1">Min.</td>
                <td align="left" colspan="1" rowspan="1">Max</td>
                <td align="left" colspan="1" rowspan="1">Med.</td>
                <td align="left" colspan="1" rowspan="1">Min.</td>
                <td align="left" colspan="1" rowspan="1">Max.</td>
                <td align="left" colspan="1" rowspan="1">Med.</td>
                <td align="left" colspan="1" rowspan="1">Min.</td>
                <td align="left" colspan="1" rowspan="1">Max.</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">hg_HGS(2)</td>
                <td align="left" colspan="1" rowspan="1">46.65</td>
                <td align="left" colspan="1" rowspan="1">43.15</td>
                <td align="left" colspan="1" rowspan="1">50.15</td>
                <td align="left" colspan="1" rowspan="1">31.65</td>
                <td align="left" colspan="1" rowspan="1">30.32</td>
                <td align="left" colspan="1" rowspan="1">32.98</td>
                <td align="left" colspan="1" rowspan="1">2890092</td>
                <td align="left" colspan="1" rowspan="1">2660792</td>
                <td align="left" colspan="1" rowspan="1">3119393</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">jhg_HGS(13)</td>
                <td align="left" colspan="1" rowspan="1">59.61</td>
                <td align="left" colspan="1" rowspan="1">35.99</td>
                <td align="left" colspan="1" rowspan="1">76.92</td>
                <td align="left" colspan="1" rowspan="1">45.11</td>
                <td align="left" colspan="1" rowspan="1">22.53</td>
                <td align="left" colspan="1" rowspan="1">65.71</td>
                <td align="left" colspan="1" rowspan="1">3745629</td>
                <td align="left" colspan="1" rowspan="1">2268438</td>
                <td align="left" colspan="1" rowspan="1">5657331</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">uhg_HGS(18)</td>
                <td align="left" colspan="1" rowspan="1">52.35</td>
                <td align="left" colspan="1" rowspan="1">37.49</td>
                <td align="left" colspan="1" rowspan="1">72.51</td>
                <td align="left" colspan="1" rowspan="1">35.90</td>
                <td align="left" colspan="1" rowspan="1">21.65</td>
                <td align="left" colspan="1" rowspan="1">59.81</td>
                <td align="left" colspan="1" rowspan="1">3619072</td>
                <td align="left" colspan="1" rowspan="1">3047940</td>
                <td align="left" colspan="1" rowspan="1">4752910</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">amd_AMD(1)</td>
                <td align="left" colspan="1" rowspan="1">45.64</td>
                <td align="left" colspan="1" rowspan="1">46.64</td>
                <td align="left" colspan="1" rowspan="1">45.64</td>
                <td align="left" colspan="1" rowspan="1">1.48</td>
                <td align="left" colspan="1" rowspan="1">1.48</td>
                <td align="left" colspan="1" rowspan="1">1.48</td>
                <td align="left" colspan="1" rowspan="1">2163584</td>
                <td align="left" colspan="1" rowspan="1">2163584</td>
                <td align="left" colspan="1" rowspan="1">2163584</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt102">
              <label/>
              <p><xref ref-type="table" rid="pone-0027992-t002">Table 2:</xref> Summary statistics for the metagenomic datasets. Median (Med.), minimum (Min.) and maximum (Max.) of mapped rate, ambiguity rate and estimated average genome length for the samples: two from U.S. adult human gut (‘hg’), 13 from Japanese human gut (‘jhg’), 18 from U.S. twin families human gut (‘uhg’) and1 from acid mind drainage (‘amd’) are shown. Two reference genome sets, ‘HGS’, ‘AMD’, were used for human gut samples (‘hg’, ‘jhg’, ‘uhg’) and the acid mine drainage sample (‘amd’), respectively.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p><xref ref-type="table" rid="pone-0027992-t002">Table 2</xref> gives the mapped rates and ambiguity rates for each data set. The mapped rate is the proportion of reads mapped at least once to the reference genomes. It can be seen from the table that 45–60%, in median, of human gut metagenomic reads were mapped to the references for all these studies. This value suggests that the reference genome set provides a good homolog resource for the human gut metagenomic reads, even though there are still several sets only showing less than 40% mapped rate.</p>
        <p>Another quantity, ambiguity rate, is the proportion of reads that are mapped at least twice to the references. As we can see, about 21–65% of the reads were ambiguously mapped to the reference genome set across the human gut samples. While ‘uhg_HGS’ is a collection of 454 short reads, we also noticed that it has a comparable median ambiguity rate to the other two Sanger read sets. This indicates that at 250 bp, a 454 read is already as specific as a Sanger read. However, because of the ambiguities arising from the intrinsic composition of the communities, we still encountered a significant portion of reads having multiple hits regardless of their read lengths.</p>
        <p>We estimated the relative abundances of reference genomes for these datasets and the results are summarized in <xref ref-type="supplementary-material" rid="pone.0027992.s010">Table S4</xref>. Based on these estimates, we calculated the average genome lengths for these metagenomes. The medians of genome lengths range from 2.8 Mbp to 3.7 Mbp, as shown in <xref ref-type="table" rid="pone-0027992-t002">Table 2</xref> and <xref ref-type="supplementary-material" rid="pone.0027992.s009">Table S3</xref>. These statistics show that the average genome lengths for the three human gut datasets are comparable. Indeed, there is no statistically significant difference in the medians of average genome length between ‘jhg’ and ‘ugh’ samples (Wilcoxon test, two-sided, P = 0.3539). The test involving ‘hg’ set is not suitable since it only contains two samples.</p>
        <p>Next, we identified the most frequent species across all the metagenomes. In <xref ref-type="fig" rid="pone-0027992-g003">Figure 3</xref>, we show the 99 species with at least 0.05% of relative abundance in at least 50% of the metagenome samples in the order of their median relative abundance. Among the top ten most common species, there are eight from the <italic>Firmicutes</italic> phylum including members of <italic>Faecalibacterium</italic>, <italic>Eubacterium</italic> and <italic>Ruminococcus</italic> genera, and two from the <italic>Bacteroides</italic> genus of <italic>Bacteroidetes</italic> phylum. It shows the predominance of <italic>Firmicutes</italic> and <italic>Bacteroidetes</italic> in the human gastrointestinal tract. In general, these frequent species display a long-tail distribution in relative abundance levels, meaning that most species are detected across many samples, though they are not highly abundant. We also found that the abundance levels of some species are highly variable, while most others are relatively constant (see the quantile boxes and outliers in <xref ref-type="fig" rid="pone-0027992-g003">Figure 3</xref>). In choosing the minimum occurrence rate and minimum abundance threshold for a typical human gut read set (∼100,000 reads, 800 bp), the 0.05% of relative abundance roughly corresponded to a sequencing size of 40 Kbp from the genome. This size was 25-fold more than the size coverage per genome using 16S RNA sequencing according to <italic>Qin et al.</italic> <xref ref-type="bibr" rid="pone.0027992-Qin1">[18]</xref>. We used a different identity rate cut-off (75%) for parsing BLAT hits and similar frequent species results were obtained. They are shown in <xref ref-type="supplementary-material" rid="pone.0027992.s005">Figure S5</xref>.</p>
        <fig id="pone-0027992-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0027992.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Frequent species for human gut metagenomes.</title>
            <p>The 99 species occurring in at least 50% of the 33 human gut samples with a minimum relative abundance of 0.05% were selected. ‘gut_HGS_90’ indicates that the human gut (‘gut’) read sets were mapped to the reference genome set (‘HGS’) with an identity rate cut-off at 90% (‘90’).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.g003" xlink:type="simple"/>
        </fig>
        <p>We compared our results to the 75 non-redundant, frequent species identified in a recent study <xref ref-type="bibr" rid="pone.0027992-Qin1">[18]</xref>. Although we used different datasets and methodologies, our study shows comparable results. For example, between the two identified sets, five of the top ten common species are shared and so are eleven of the top twenty. The criteria they used (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e002" xlink:type="simple"/></inline-formula>1% genome coverage and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e003" xlink:type="simple"/></inline-formula>50% presence), if converted, roughly correspond to 0.05% in minimum relative abundance levels in our study.</p>
        <p>However, we had some improvements over their results. They used a smaller (195) reference genome set and did not consider the genome size bias and the ambiguous hits. Consequently, their result might have missed some of the top frequent species and misplaced some species into the top rankings. In fact, the <italic>Bacteroides</italic> species, with genome lengths ranging from 5 Mbp to 8 Mbp, well above the median average genome lengths of human gut samples, are constantly ranked higher in their ranking. In our results, however, this bias is corrected, and the rankings are accordingly lowered, with some of their top 20 ranked <italic>Bacteroides</italic> species dropping out of the top 40.</p>
        <p>Next, we used the GRA estimates for frequent species as the basis for hierarchically clustering all the human gut samples, as shown in <xref ref-type="fig" rid="pone-0027992-g004">Figure 4</xref>. It can be seen that most of the frequent species belong to <italic>Firmicutes</italic>, <italic>Bacteroides</italic> and <italic>Actinobacteria</italic> (see column color-coding). We also see that the unweaned infants (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e004" xlink:type="simple"/></inline-formula>6 months) are all grouped closely together (see row color-coding), possibly indicating their distinct gut microbial communities in comparison to that for the weaned infant and adult samples. This phenomenon was noticed in the original paper <xref ref-type="bibr" rid="pone.0027992-Kurokawa1">[30]</xref>, and our results further strengthened their claim by incorporating data from more human gut metagenomics studies. A close look at the top 20 most abundant strains revealed that the unweaned infants' community profiles were dominated by only a few strains from <italic>Actinobacteria</italic>. The lack of diversity of infant gastrointestinal tract has also been reported in other studies, for example, see <italic>Vaishampayan et al.</italic> <xref ref-type="bibr" rid="pone.0027992-Vaishampayan1">[31]</xref>. The pattern might be related to the microbial colonization process of infant gastrointestinal tract; however, no clear explanation for this interesting phenomenon is available to date.</p>
        <fig id="pone-0027992-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0027992.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Heatmap biclustering of human gut metagenomes.</title>
            <p>‘gut_HGS_90’ indicates that the human gut (‘gut’) read sets were mapped to the reference genome set (‘HGS’) with an identity rate cut-off at 90% (‘90’). The bottom labels indicate human gut samples. The top right legend shows the color-coding for columns indicating the sample age category and dataset origin. The bottom right legend shows color-coding for rows indicating the top 4 most abundant phyla in human gut. The relative abundance for each sample is normalized by a rank transformation.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.g004" xlink:type="simple"/>
        </fig>
        <p>On the other hand, there is no clear-cut evidence showing that samples from the same dataset or Body Mass Index (BMI) category are grouped together, even though there is such a trend. Note that the clustering results depend on the criterion of identifying frequent species. These species were chosen as a trade-off between the number of frequent species required for resolution power and the number that would risk including too many unreliable estimates from less abundant species. The parameters we had chosen were based on <italic>Qin et al</italic>. <xref ref-type="bibr" rid="pone.0027992-Qin1">[18]</xref>. We did the same analysis with a different identity rate cut-off (75%) for BLAT hits and two different minimum relative abundance thresholds (0.01% and 0.1%) for frequent species selection. Similar results were obtained. They are shown in <xref ref-type="supplementary-material" rid="pone.0027992.s006">Figures S6</xref>.</p>
      </sec>
      <sec id="s2e">
        <title>The acid mine drainage data set</title>
        <p>In samples from other environments where reference genomes are not well characterized, such as soil, ocean and some extreme environments, assemblages like contigs and draft genomes from the sample itself can be used in addition to available known genomes. Acid mine drainage sites are extreme environments where only a few species of specially adapted microbes can survive. We downloaded the raw read set (labeled ‘amd’), which contains 103,462 Sanger shotgun reads (∼750 bp) from one environmental sample of a biofilm <xref ref-type="bibr" rid="pone.0027992-Tyson1">[3]</xref>. The genome sequences of coexisting species were partially assembled using the metagenomic reads, among which are two dominant ones: <italic>Ferroplasma sp. Type II</italic> and <italic>Leptospirillum sp. Group II 5-way CG</italic>. The genome assemblages are in the draft state, but we roughly know their genome sizes <xref ref-type="bibr" rid="pone.0027992-Tyson1">[3]</xref>. To study the community structure, we constructed an acid mine drainage reference genome set (‘AMD’) using the two draft genomes and other currently available bacterial genomes of acid mine habitats (<xref ref-type="supplementary-material" rid="pone.0027992.s007">Table S1B</xref>). We mapped the read set ‘amd’ to this reference genome set and subsequently labeled the result ‘amd_AMD’.</p>
        <p>Out of the reads mapped to the references, only a slight portion of them (∼2%) had multiple hits (<xref ref-type="table" rid="pone-0027992-t002">Table 2</xref>). We then estimated the GRA for the acid mine drainage community using GRAMMy. <xref ref-type="fig" rid="pone-0027992-g005">Figure 5</xref> shows the relative abundance of the six strains we included in the ‘AMD’ reference. It confirms that the community is dominated by the two draft genomes (98% in total relative abundance) with only marginal fraction of the other acid mine strains. The dominance of the two strains is consistent with the results from the genomic study in the original work, even though their fluorescence in-situ hybridization (FISH) result only reveals the dominance of <italic>Leptospirillum sp. Group II</italic> species <xref ref-type="bibr" rid="pone.0027992-Tyson1">[3]</xref>.</p>
        <fig id="pone-0027992-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0027992.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>GRAMMy estimates of GRAs for the acid mine drainage data.</title>
            <p>Estimated relative abundance for each strain is shown as a percentage. The first two strains dominate the sample.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.g005" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>We have developed the GRAMMy framework for estimating genome relative abundance with shotgun metagenomic reads. It has three unique features. First, it is unique in providing a rigorous probabilistic framework for estimating Genome Relative Abundance (GRA). The estimation can be easily extended to higher taxonomic levels by simply adding up the relative abundance of genomes affiliated with the specific higher-level taxon while maintaining the accuracy, since the estimated GRA is already properly normalized and corrected for genome size bias.</p>
      <p>Second, GRAMMy provides users with a wide choice of mapping and alignment tools. Its ability to use the results from linear time NGS mapping tools helps to reduce the computation burden for analyzing current massive metagenomic read sets. The GRAMMy program currently supports tabular BLAST formats, however, the mapping results from other popular mapping tools, such as MAQ, Bowtie and PerM <xref ref-type="bibr" rid="pone.0027992-Li1">[32]</xref>, <xref ref-type="bibr" rid="pone.0027992-Langmead1">[33]</xref>, <xref ref-type="bibr" rid="pone.0027992-Chen1">[34]</xref>, can be easily adapted to the GRAMMy framework. The algorithm is also linear in time and space with the input data size and the current implementation is much faster than MEGAN and GAAS in handling large read sets, processing one million of reads in seconds (see <xref ref-type="fig" rid="pone-0027992-g006">Figure 6</xref>, the BLAT mapping time is excluded for all compared tools). In addition, GRAMMy is memory efficient and we have not encountered problems in processing read number in the order of millions with hundreds of microbial genomes with our 12GB nodes. However, if memory bottleneck is reached, we can always divides the reads into sub-samples and use GRAMMy in a bootstrap fashion, because a certain number of reads can already provide substantial amount of abundance information as indicated by our simulations.</p>
      <fig id="pone-0027992-g006" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0027992.g006</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Running time comparison.</title>
          <p>GRAMMy is the fastest in all cases as compared to MEGAN and GAAS in processing time. The BLAT mapping time is excluded for all compared tools.</p>
        </caption>
        <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.g006" xlink:type="simple"/>
      </fig>
      <p>Third, the method is especially suitable for short read datasets due to its better handling of read assignment ambiguities. In typical cases of a short read set, there are 10% to 40% of reads having assignment ambiguities <xref ref-type="bibr" rid="pone.0027992-Huson1">[14]</xref>. The source of assignment ambiguity can be sequencing errors, genetic variations, horizontal gene transfers or closely related genomes. By taking into account the information from the ambiguously assigned part of the read set, our study showed that we can improve the genome abundance estimation for metagenomic data.</p>
      <p>In applying the GRAMMy framework to the real metagenomic datasets, we used two different identity rate cut-offs: 75% and 90%. While the results from 90% were shown, we also kept the 75% results in the supplementary files. Lowering the thresholds will certainly increase the mapped rate as well as the ambiguity rate, as shown in <xref ref-type="supplementary-material" rid="pone.0027992.s008">Table S2</xref>. However, in our analysis of human gut metagenomes, the average genome size estimates and abundance estimates were not significantly changed by using different cut-offs, as shown in <xref ref-type="supplementary-material" rid="pone.0027992.s009">Tables S3</xref> and <xref ref-type="supplementary-material" rid="pone.0027992.s010">S4</xref>. Still, in other applications, researchers have to trade off between ambiguity rate and mapped rate to obtain reasonable GRA estimates for their data.</p>
      <p>There is also the practical question of how many genomes to be included as reference. This, however, is always the choice of users. As long as the read-to-genome associations found by mapping tools are reliable and the coverage rate is high (as in our simulations), GRAMMy can reliably estimate low abundance levels and the concern of over-fitting can be alleviated. In real data, the estimation accuracy of the GRA of the low-abundance genomes depends on the number of reads mapped to each genome and the reliability of mappings. The estimated variance of the GRAs can give some ideas about the accuracy of the estimates.</p>
      <p>In summary, with the experimental side of shotgun metagenomics accelerating its pace, the GRAMMy method we proposed has the potential to produce more accurate taxonomic abundance estimations for downstream computational analyses.</p>
    </sec>
    <sec id="s4" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>A finite mixture model</title>
        <p>We developed a finite mixture model for the GRAMMy framework. Following <italic>Angly et al.</italic> we used genome relative abundance (GRA) as the relative abundance measure of mostly unicellular microbial organisms <xref ref-type="bibr" rid="pone.0027992-Angly1">[15]</xref>. We describe the sampling and sequencing procedure as follows: First, randomly choose a genome <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e005" xlink:type="simple"/></inline-formula> with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e006" xlink:type="simple"/></inline-formula> proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e007" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e008" xlink:type="simple"/></inline-formula> is the abundance and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e009" xlink:type="simple"/></inline-formula> is the genome length. Second, randomly generate a read <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e010" xlink:type="simple"/></inline-formula> from it. Without loss of generality, we further assume that for the given genome <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e011" xlink:type="simple"/></inline-formula> we can reasonably approximate the generation of shotgun reads by some component distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e012" xlink:type="simple"/></inline-formula> such that the probability of generating a read <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e013" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e014" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e015" xlink:type="simple"/></inline-formula>. With a reasonable assumption of independence between the two sampling steps, the whole procedure is probabilistically equivalent to sampling from a mixture distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e016" xlink:type="simple"/></inline-formula>, with the mixing parameters denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e017" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e018" xlink:type="simple"/></inline-formula> and the component distributions denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e019" xlink:type="simple"/></inline-formula>, where <italic>m</italic> is the number of genomes. Subsequently, each read set, denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e020" xlink:type="simple"/></inline-formula>, can be regarded as a realized independent, identically distributed (iid) sample of size <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e021" xlink:type="simple"/></inline-formula> from the mixture <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e022" xlink:type="simple"/></inline-formula>. The relative abundance of known genomes is exactly a transformation of the mixing parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e023" xlink:type="simple"/></inline-formula>, which can be estimated based on the read set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e024" xlink:type="simple"/></inline-formula>. A schematic view of the finite mixture model is shown in <xref ref-type="fig" rid="pone-0027992-g001">Figure 1</xref>. With the component distributions properly set up, we can find the maximum likelihood estimate (MLE) of the mixing parameters.</p>
        <p>In many studies, our knowledge of the genomes present in the community is limited. Under these circumstances, we can define the mixture with the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e025" xlink:type="simple"/></inline-formula> components for known genomes and the last <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e026" xlink:type="simple"/></inline-formula>-th component for the collective of unknown genomes. Note that for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e027" xlink:type="simple"/></inline-formula> known components, we suppose that their genome sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e028" xlink:type="simple"/></inline-formula> and genome sizes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e029" xlink:type="simple"/></inline-formula> are known. Therefore, the GRA for known genomes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e030" xlink:type="simple"/></inline-formula> is the normalized abundance, where the relative abundance for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e031" xlink:type="simple"/></inline-formula>-th known genome is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e032" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e033" xlink:type="simple"/></inline-formula>. In the biological setting, we want to estimate vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e034" xlink:type="simple"/></inline-formula>, which is a measure of organism relative abundance. In the transformed mixture problem, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e035" xlink:type="simple"/></inline-formula> is related to the mixing parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e036" xlink:type="simple"/></inline-formula> by:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e037" xlink:type="simple"/><label>(1)</label></disp-formula>or the inverse:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e038" xlink:type="simple"/><label>(2)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e039" xlink:type="simple"/></inline-formula>. The number of sampled reads is both proportional to the genome relative abundance and the length. Because the two factors are confounded, the missing knowledge of the genome length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e040" xlink:type="simple"/></inline-formula> prohibits the estimation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e041" xlink:type="simple"/></inline-formula> from the data. Since the effective genome length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e042" xlink:type="simple"/></inline-formula> for the unknown genomes is not available, we cannot estimate the relative abundance of the unknown component. However, the relative abundance of known genomes can still be estimated using our procedures.</p>
      </sec>
      <sec id="s4b">
        <title>Estimation of GRA using Expectation Maximization (EM) algorithm</title>
        <p>To estimate the mixing parameters, we adopted the EM algorithm to calculate the maximum likelihood estimate (MLE). In the EM framework, we assume a ‘missing’ data matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e043" xlink:type="simple"/></inline-formula>, in which each entry <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e044" xlink:type="simple"/></inline-formula> is a random variable indicating whether <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e045" xlink:type="simple"/></inline-formula> is from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e046" xlink:type="simple"/></inline-formula> or not. Then we can solve for the parameters by iteratively estimating <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e047" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e048" xlink:type="simple"/></inline-formula> using Algorithm 1 (see supporting Methods). Note that a variable with superscript <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e049" xlink:type="simple"/></inline-formula> stands for its value at the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e050" xlink:type="simple"/></inline-formula>-th iteration, e.g., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e051" xlink:type="simple"/></inline-formula> is the estimate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e052" xlink:type="simple"/></inline-formula> at the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e053" xlink:type="simple"/></inline-formula>-th step. The EM at the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e054" xlink:type="simple"/></inline-formula>-th iteration is:</p>
        <list list-type="bullet">
          <list-item>
            <p>
              <bold>E-step</bold>
            </p>
          </list-item>
        </list>
        <p>Assuming <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e055" xlink:type="simple"/></inline-formula> known, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e056" xlink:type="simple"/></inline-formula> can be updated by the corresponding posterior probabilities:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e057" xlink:type="simple"/><label>(3)</label></disp-formula></p>
        <list list-type="bullet">
          <list-item>
            <p>
              <bold>M-step</bold>
            </p>
          </list-item>
        </list>
        <p>Assuming <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e058" xlink:type="simple"/></inline-formula> known, the new mixing parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e059" xlink:type="simple"/></inline-formula> are updated by:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e060" xlink:type="simple"/><label>(4)</label></disp-formula>When the MLE of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e061" xlink:type="simple"/></inline-formula> is found, using Equation (1), the MLE of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e062" xlink:type="simple"/></inline-formula> can be calculated, thereby solving the original problem.</p>
        <p>The space complexity of the EM algorithm is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e063" xlink:type="simple"/></inline-formula> and the time complexity of the EM algorithm is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e064" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e065" xlink:type="simple"/></inline-formula> the average number of associated genomes for one read and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e066" xlink:type="simple"/></inline-formula> is the time cost related to the convergence criteria for EM. Since <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e067" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e068" xlink:type="simple"/></inline-formula> are both constants not related to <italic>n</italic>, the algorithm is linear in space and time complexity with the read number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e069" xlink:type="simple"/></inline-formula>. Further, the concavity of the log-likelihood function can be shown and the EM algorithm is guaranteed to converge to global maximum (see <xref ref-type="supplementary-material" rid="pone.0027992.s011">Text S1</xref>).</p>
      </sec>
      <sec id="s4c">
        <title>Read probability approximations</title>
        <p>The probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e070" xlink:type="simple"/></inline-formula> is assessed based on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e071" xlink:type="simple"/></inline-formula>. Ideally, it is the probability that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e072" xlink:type="simple"/></inline-formula> is generated when read being uniformly sampled from genome <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e073" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e074" xlink:type="simple"/></inline-formula> be the number of copies of read <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e075" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e076" xlink:type="simple"/></inline-formula>. Then the probability is approximated by:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e077" xlink:type="simple"/><label>(5)</label></disp-formula>However, due to sequencing errors and natural genetic variations, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e078" xlink:type="simple"/></inline-formula>'s are not readily observable. When the mapping or alignment results from BLAST, BLAT, or other mapping tools are available, the number of high quality hits of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e079" xlink:type="simple"/></inline-formula> on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e080" xlink:type="simple"/></inline-formula> can effectively be used as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e081" xlink:type="simple"/></inline-formula>'s. To keep only these reliable and statistically significant hits, raw hits are filtered by E-value, alignment length and identity rate. We refer to the finite mixture model with the read probability from mapping and alignment results as ‘map’ in the remainder of the paper.</p>
        <p>An alternative way to assess the read probabilities is by using k-mer composition. For the <italic>j</italic>-th genome, we calculate the fraction of a k-word <italic>w</italic> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e082" xlink:type="simple"/></inline-formula>, the normalized frequency of the word <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e083" xlink:type="simple"/></inline-formula> in genome <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e084" xlink:type="simple"/></inline-formula>. For a read <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e085" xlink:type="simple"/></inline-formula>, we define pseudo-likelihood for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e086" xlink:type="simple"/></inline-formula> by:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e087" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e088" xlink:type="simple"/></inline-formula> is the set of words formed by sliding windows of size <italic>k</italic> along <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e089" xlink:type="simple"/></inline-formula>. This probabilistic assignment captures the overall similarity between reads and genomes, an idea adopted in other composition-based studies such as in <italic>Sandberg et al.</italic> <xref ref-type="bibr" rid="pone.0027992-Sandberg1">[35]</xref>. It is especially useful when a large number of reads do not have reliable hits with reference genomes. We will refer to the finite mixture model with the read probability from the multinomial k-mer composition as ‘k-mer’ in the remainder of the paper.</p>
      </sec>
      <sec id="s4d">
        <title>Standard errors for GRA estimates</title>
        <p>We also derived the asymptotic covariance matrix for the mixing parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e090" xlink:type="simple"/></inline-formula> using the asymptotic theory for MLE estimates. Because there are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e091" xlink:type="simple"/></inline-formula> independent parameters in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e092" xlink:type="simple"/></inline-formula>, we can choose them as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e093" xlink:type="simple"/></inline-formula> and denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e094" xlink:type="simple"/></inline-formula>. Further, let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e095" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e096" xlink:type="simple"/></inline-formula> be the MLE estimates for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e097" xlink:type="simple"/></inline-formula> and its corresponding GRA, respectively. Then, the asymptotic standard error for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e098" xlink:type="simple"/></inline-formula> is approximately:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e099" xlink:type="simple"/><label>(7)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e100" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e101" xlink:type="simple"/></inline-formula> is the observed information matrix.</p>
        <p>If only a small number (as compared to number of parameters) of reads are mapped, the conditions for the asymptotic to hold cannot be satisfied. We can alternatively use the bootstrap covariance estimator for the standard error of MLE:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e102" xlink:type="simple"/><label>(8)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e103" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e104" xlink:type="simple"/></inline-formula> is the bootstrap mean estimator.</p>
      </sec>
      <sec id="s4e">
        <title>Numerical error measures</title>
        <p>We use the following measures to evaluate the accuracy of the GRA estimate. Let the true GRA be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e105" xlink:type="simple"/></inline-formula> and its estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e106" xlink:type="simple"/></inline-formula>. The first measure is the commonly used root mean square version of relative error <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e107" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pone.0027992-Engeman1">[36]</xref>. We also included three other error measures: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e108" xlink:type="simple"/></inline-formula> (the average relative error), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e109" xlink:type="simple"/></inline-formula> (the maximum relative error), and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e110" xlink:type="simple"/></inline-formula> (the <italic>Total Variation Distance</italic> <xref ref-type="bibr" rid="pone.0027992-Liu1">[37]</xref>), which are all commonly used to evaluate the accuracy of an estimate.</p>
      </sec>
      <sec id="s4f">
        <title>Real read sets and reference genome sets</title>
        <p>In preparing the real read sets, we downloaded the FAMeS data from JGI (<ext-link ext-link-type="uri" xlink:href="http://FAMeS.jgi-psf.org" xlink:type="simple">http://FAMeS.jgi-psf.org</ext-link>), the ‘hg’ data from TraceDB (<ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nih.gov/pub/TraceDB/" xlink:type="simple">ftp://ftp.ncbi.nih.gov/pub/TraceDB/</ext-link>, NCBI project id: 16729), the ‘uhg’ data from Sequence Read Archive (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/Traces/sra/" xlink:type="simple">http://www.ncbi.nlm.nih.gov/Traces/sra/</ext-link>, NCBI project id: 32089), the ‘jhg’ data from BGI (<ext-link ext-link-type="uri" xlink:href="http://gutmeta.genomics.org.cn/" xlink:type="simple">http://gutmeta.genomics.org.cn/</ext-link>) <xref ref-type="bibr" rid="pone.0027992-Kurokawa1">[30]</xref> and the ‘amd’ data from TraceDB (NCBI project id: 13696).</p>
        <p>In preparing the reference genome sets, we downloaded currently available complete and draft bacteria genomes from the NCBI Refseq (<ext-link ext-link-type="uri" xlink:href="http://ftp.ncbi.nih.gov/refseq" xlink:type="simple">http://ftp.ncbi.nih.gov/refseq</ext-link>), MetaHit (<ext-link ext-link-type="uri" xlink:href="http://www.metahit.eu/" xlink:type="simple">http://www.metahit.eu/</ext-link>), HMCJ (<ext-link ext-link-type="uri" xlink:href="http://metagenome.jp" xlink:type="simple">http://metagenome.jp</ext-link>), WUSTL Gordon Lab (<ext-link ext-link-type="uri" xlink:href="http://genome.wustl.edu/" xlink:type="simple">http://genome.wustl.edu/</ext-link>) and JGI (<ext-link ext-link-type="uri" xlink:href="http://genome.jgi-psf.org/" xlink:type="simple">http://genome.jgi-psf.org/</ext-link>). We manually curated genomes to remove redundancy and organized them into a NCBI Taxonomy (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/Taxonomy" xlink:type="simple">http://www.ncbi.nlm.nih.gov/Taxonomy</ext-link>) database. We used the genome information available from IMG/M (<ext-link ext-link-type="uri" xlink:href="http://img.jgi.doe.gov" xlink:type="simple">http://img.jgi.doe.gov</ext-link>), IMG/HMP (<ext-link ext-link-type="uri" xlink:href="http://www.hmpdacc-resources.org/cgi-bin/img_hmp" xlink:type="simple">http://www.hmpdacc-resources.org/cgi-bin/img_hmp</ext-link>) and GOLD (<ext-link ext-link-type="uri" xlink:href="http://www.genomesonline.org" xlink:type="simple">http://www.genomesonline.org</ext-link>) to group them by habitats <xref ref-type="bibr" rid="pone.0027992-Markowitz1">[38]</xref>, <xref ref-type="bibr" rid="pone.0027992-Liolios1">[39]</xref>. Finally, we obtained 388 human gastrointestinal tract genomes for a human gut reference genome set (‘HGS’).</p>
      </sec>
      <sec id="s4g">
        <title>Read filtering and assignment procedures</title>
        <p>In the ‘map’ read probability backend, we used BLAT to map reads to reference genomes. We prefer BLAT to BLAST, as BLAT is tens of times faster in handling low-sensitivity similarity search for massive number of sequences than BLAST. Since we only kept alignment results with identity rate greater than 90%, the BLAT result should not differ much from what if BLAST was used. For the human gut and simulated data, we used similar filtering methods as by <italic>Turnbaugh et al.</italic> <xref ref-type="bibr" rid="pone.0027992-Turnbaugh2">[17]</xref>, <xref ref-type="bibr" rid="pone.0027992-Turnbaugh3">[40]</xref> (E-value ≤0.0001, aligned length more than 75% of its <italic>RL</italic> and identity ≥90%). In the ‘k-mer’ read-probability backend, we used k-mer length k = 6. For GAAS and MEGAN, we used the same mapping results from BLAT, as a common starting point. We used GAAS's default filtering options (E-value≤0.0001, aligned length more than 80% of its <italic>RL</italic>, and identity ≥80%), as well as MEGAN's default options (min-score = 35 for <italic>RL</italic> equal to 100 bp and min-score = 50 for <italic>RL</italic> equal to 400 bp; top percent = 5%, min support = 2), for comparisons.</p>
        <p>In evaluating the ribotype and protein marker based method, we used the <italic>E.coli</italic> 16S rRNA <italic>rrs</italic>E and ribosome protein <italic>rpo</italic>B genes to retrieve homolog sequences from the simulated reads, which were then filtered by options (E-value<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e111" xlink:type="simple"/></inline-formula>0.0001, aligned length more than 75% of its <italic>RL</italic> and identity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e112" xlink:type="simple"/></inline-formula>90%), according to <xref ref-type="bibr" rid="pone.0027992-Biers1">[28]</xref>. Our validations have shown that variations of these parameters within a reasonable range had little effect on the results.</p>
      </sec>
      <sec id="s4h">
        <title>Higher level taxonomic statistics</title>
        <p>Many downstream analyses can be carried out based on GRAMMy's estimates. For example, the average genome length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e113" xlink:type="simple"/></inline-formula> is readily obtainable:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e114" xlink:type="simple"/><label>(9)</label></disp-formula>Subsequently, we can test the statistical significance of the median average genome length difference between two sample groups by Wilcoxon test (<monospace>wilcox.test</monospace> in R).</p>
        <p>Since genome size bias has already been corrected, we can use GRAMMy estimates to calculate the relative abundance of a higher-level taxon by simple addition. For this purpose, we used the NCBI Taxonomy, which has the taxonomic assignments for all reference genomes we used here. To illustrate, for a specific taxonomic level <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e115" xlink:type="simple"/></inline-formula>, the relative abundance of a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e116" xlink:type="simple"/></inline-formula>-th specific taxon <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e117" xlink:type="simple"/></inline-formula> is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e118" xlink:type="simple"/><label>(10)</label></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.e119" xlink:type="simple"/><label>(11)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0027992.e120" xlink:type="simple"/></inline-formula> can be any one of the seven hierarchical levels in the taxonomy, from species to kingdom.</p>
      </sec>
      <sec id="s4i">
        <title>Hierarchical biclustering</title>
        <p>It is possible to use GRAMMy estimates for clustering analysis and statistical hypothesis testing. We clustered the samples based on the pairwise similarities (correlations) of their relative abundance distribution. Because of the long-tailed shape of the distribution, the signal-to-noise ratio is low for these less abundant genomes. Therefore, using the thresholds .05% for the minimum abundance and 50% for the minimum occurrence <xref ref-type="bibr" rid="pone.0027992-Qin1">[18]</xref>, we selected the estimates for these more abundant genomes (which are more reliable for clustering). We used rank transformation, which normalizes GRAs by taking their ranks and applying score transformation and R function <monospace>heatmap</monospace> for hierarchical clustering.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pone.0027992.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s001" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>The convergence of GRAMMy.</bold> The estimation errors, as measured by different numerical methods: (A) Relative Root Mean Square Error (RRMSE) in percentage versus Read Number (RN) for different read lengths (RL). (B) Relative Root Mean Square Error (RRMSE), Average Relative Error (AVGRE), Maximum Relative Error (MAXRE), and Distance of Total Variation (DTV) versus Read Number for read length equal 100 bp. GRAMMy (‘map’) was used.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0027992.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s002" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p><bold>Simulated read set benchmarks.</bold> Effects of different perturbations on GRAMMy's estimation: (A) Effects of sequencing errors: results from ‘with sequencing error’ and ‘without sequencing error’ read sets are labeled as ‘w. Seq Err’ and ‘wo. Seq Err’, respectively. (B) Effects of unknown genomes: results from estimation ‘with unknown genomes’ and ‘without unknown genomes’ read sets are labeled as ‘w. Unknowns’ and ‘wo. Unknowns’, respectively. (C) Effects of different genome relative abundance distributions: results from more concentrated abundance distribution and less concentrated read sets are labeled as ‘steep’ and ‘flat’, respectively. Relative Root Mean Square Error (RRMSE) as a percentage is plotted against Read Number. GRAMMy (‘map’) was used.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0027992.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s003" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p><bold>Performance comparison of different methods.</bold> The performance comparisons for different estimation methods: (A) MEGAN-based (‘MEGAN’), GAAS (‘GAAS’) and GRAMMy (‘map’ and ‘k-mer’) on simulated read sets with sequencing errors at read length 100 bp and 400 bp. (B) 16S-based (‘16S’), BLAT hit counting (‘BLAT’), <italic>rpo</italic>B-based and GRAMMy (‘map’). Relative Root Mean Square Error (RRMSE) as a percentage is plotted against Read Number (RN).</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0027992.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s004" xlink:type="simple">
        <label>Figure S4</label>
        <caption>
          <p><bold>Estimation errors at different taxonomic levels.</bold> Average Relative Error (AVGRE) as a percentage is plotted against taxonomic level. The errors gradually decrease from strains to kingdom taxonomic levels.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0027992.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s005" xlink:type="simple">
        <label>Figure S5</label>
        <caption>
          <p><bold>Frequent species for the human gut metagenomes.</bold> The 99 species occurring in at least 50% of the 33 human gut samples with a minimum relative abundance of 0.05% were selected. ‘gut_HGS_75’ indicates that the human gut (‘gut’) read sets were mapped to the reference genome set (‘HGS’) with an identity rate cut-off at 75% (‘75’).</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0027992.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s006" xlink:type="simple">
        <label>Figure S6</label>
        <caption>
          <p><bold>Heatmap biclustering of the human gut metagenomes.</bold> ‘gut_HGS_90’ indicates that the human gut (‘gut’) read sets were mapped to the reference genome set (‘HGS’) with an identity rate cut-off at 90% (‘90’), while ‘gut_HGS_75’ indicates cut-off at 75%(‘75’). The bottom labels indicate human gut samples. The top right legend shows the color-coding for columns indicating the sample age category and dataset origin. The bottom right legend shows color-coding for rows indicating the top 4 most abundant phyla in human gut. (A) Heatmap clustering of the ‘gut’ samples, with strains of abundance &gt;0.05% in at least 50% of samples selected at 75% identity rate cut-off. (B) Heatmap clustering of the ‘gut’ samples, with strains of abundance &gt;0.01% in at least 50% of samples selected at 90% identity rate cut-off. (C) Heatmap clustering of the ‘gut’ samples, with strains of abundance &gt;0.1% in at least 50% of samples selected at 90% identity rate cut-off.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0027992.s007" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s007" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p><bold>Reference genome sets.</bold> Columns are NCBI taxon ID (‘NCBI Taxon ID’), organism name (‘Name’), genome project status (‘Status’: ‘D’ for draft and ‘F’ for finished), and data source of genome sequences (‘Source’). (A) ‘HGS’ reference genome set. (B) ‘AMD’ reference genome set.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0027992.s008" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s008" xlink:type="simple">
        <label>Table S2</label>
        <caption>
          <p><bold>Mapping rate statistics.</bold> Columns are read set name (‘Set Name’), total number of reads (‘Total Reads’), number of mapped reads (‘Mapped Reads’), proportion of mapped reads (‘Mapped rate’), number of ambiguous reads(‘Ambiguous Reads’), proportion of ambiguous reads (‘Ambiguous rate’). ‘xxx_yyy_zzz’ abbreviation is as specified in Methods, where ‘xxx’ is the read set, ‘yyy’ is the reference genome set and ‘zzz’ is the cut-off for identity rate. (A) ‘hg_HGS_90’. (B) ‘jhg_HGS_90’. (C) ‘jhg_HGS_90’. (D) ‘amd_AMD_90’. (E) ‘hg_HGS_75’. (F) ‘jhg_HGS_75’. (G) ‘uhg_HGS_75’. (H) ‘amd_AMD_75’. (I) Median (‘Median’), minimum (‘Min’) and maximum (‘Max’) summary of mapped ratios in panels (A–H). (J) Median (‘Median’), minimum (‘Min’) and maximum (‘Max’) summary of ambiguous ratios in panels (A–H).</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0027992.s009" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s009" xlink:type="simple">
        <label>Table S3</label>
        <caption>
          <p><bold>Average genome length.</bold> Average genome length estimates from GRAMMy. ‘xxx_yyy_zzz’ abbreviation is as specified in Methods, where ‘xxx’ is the read set, ‘yyy’ is the reference genome set and ‘zzz’ is the cut-off for identity rate. Median (‘Median’), minimum (‘Min’) and maximum (‘Max’) summary of GRAMMy estimated average genome length.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0027992.s010" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s010" xlink:type="simple">
        <label>Table S4</label>
        <caption>
          <p><bold>GRAMMy estimates of GRAs for the human gut samples.</bold> Each row represents a data set and each column represents a species. The excel file name is abbreviated as ‘xxx_yyy_zzz’ , where ‘xxx’ is the read set, ‘yyy’ is the reference genome set, and ‘zzz’ is the cut-off for identity rate. A) ‘hg_HGS_90’. (B) ‘jhg_HGS_90’. (C) ‘jhg_HGS_90’. (D) ‘hg_HGS_75’. (E) ‘jhg_HGS_75’. (F) ‘uhg_HGS_75’.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0027992.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0027992.s011" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>
            <bold>Simulation details and technical derivations.</bold>
          </p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank Shibu Yooseph at the J. Craig Venter Institute and Junjie Qin at the Beijing Genome Institute for helping with the microbiome datasets.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pone.0027992-Turnbaugh1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Ley</surname><given-names>RE</given-names></name><name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name><name name-style="western"><surname>Fraser-Liggett</surname><given-names>CM</given-names></name><name name-style="western"><surname>Knight</surname><given-names>R</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>The human microbiome project.</article-title>             <source>Nature</source>             <volume>449</volume>             <fpage>804</fpage>             <lpage>810</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Venter1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Venter</surname><given-names>JC</given-names></name><name name-style="western"><surname>Remington</surname><given-names>K</given-names></name><name name-style="western"><surname>Heidelberg</surname><given-names>JF</given-names></name><name name-style="western"><surname>Halpern</surname><given-names>AL</given-names></name><name name-style="western"><surname>Rusch</surname><given-names>D</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Environmental genome shotgun sequencing of the Sargasso Sea.</article-title>             <source>Science</source>             <volume>304</volume>             <fpage>66</fpage>             <lpage>74</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Tyson1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tyson</surname><given-names>GW</given-names></name><name name-style="western"><surname>Chapman</surname><given-names>J</given-names></name><name name-style="western"><surname>Hugenholtz</surname><given-names>P</given-names></name><name name-style="western"><surname>Allen</surname><given-names>EE</given-names></name><name name-style="western"><surname>Ram</surname><given-names>RJ</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Community structure and metabolism through reconstruction of microbial genomes from the environment.</article-title>             <source>Nature</source>             <volume>428</volume>             <fpage>37</fpage>             <lpage>43</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Morgan1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Morgan</surname><given-names>JL</given-names></name><name name-style="western"><surname>Darling</surname><given-names>AE</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>JA</given-names></name></person-group>             <year>2010</year>             <article-title>Metagenomic sequencing of an in vitro-simulated microbial community.</article-title>             <source>PLoS ONE</source>             <volume>5</volume>             <fpage>e10209</fpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Diaz1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Diaz</surname><given-names>NN</given-names></name><name name-style="western"><surname>Krause</surname><given-names>L</given-names></name><name name-style="western"><surname>Goesmann</surname><given-names>A</given-names></name><name name-style="western"><surname>Niehaus</surname><given-names>K</given-names></name><name name-style="western"><surname>Nattkemper</surname><given-names>TW</given-names></name></person-group>             <year>2009</year>             <article-title>TACOA: taxonomic classification of environmental genomic fragments using a kernelized nearest neighbor approach.</article-title>             <source>BMC Bioinformatics</source>             <volume>10</volume>             <fpage>56</fpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Chatterji1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chatterji</surname><given-names>S</given-names></name><name name-style="western"><surname>Yamazaki</surname><given-names>I</given-names></name><name name-style="western"><surname>Bai</surname><given-names>Z</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>JA</given-names></name></person-group>             <year>2008</year>             <article-title>CompostBin: A DNA composition-based algorithm for binning environmental shotgun reads.</article-title>             <source>Research in Computational Molecular Biology, Proceedings</source>             <volume>4955</volume>             <fpage>17</fpage>             <lpage>28</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Teeling1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Teeling</surname><given-names>H</given-names></name><name name-style="western"><surname>Waldmann</surname><given-names>J</given-names></name><name name-style="western"><surname>Lombardot</surname><given-names>T</given-names></name><name name-style="western"><surname>Bauer</surname><given-names>M</given-names></name><name name-style="western"><surname>Glockner</surname><given-names>FO</given-names></name></person-group>             <year>2004</year>             <article-title>TETRA: a web-service and a stand-alone program for the analysis and comparison of tetranucleotide usage patterns in DNA sequences.</article-title>             <source>BMC Bioinformatics</source>             <volume>5</volume>             <fpage>163</fpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Wu1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>YW</given-names></name><name name-style="western"><surname>Ye</surname><given-names>Y</given-names></name></person-group>             <year>2011</year>             <article-title>A novel abundance-based algorithm for binning metagenomic sequences using l-tuples.</article-title>             <source>J Comput Biol</source>             <volume>18</volume>             <fpage>523</fpage>             <lpage>534</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-McHardy1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>McHardy</surname><given-names>AC</given-names></name><name name-style="western"><surname>Martin</surname><given-names>HG</given-names></name><name name-style="western"><surname>Tsirigos</surname><given-names>A</given-names></name><name name-style="western"><surname>Hugenholtz</surname><given-names>P</given-names></name><name name-style="western"><surname>Rigoutsos</surname><given-names>I</given-names></name></person-group>             <year>2007</year>             <article-title>Accurate phylogenetic classification of variable-length DNA fragments.</article-title>             <source>Nat Methods</source>             <volume>4</volume>             <fpage>63</fpage>             <lpage>72</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Kelley1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kelley</surname><given-names>DR</given-names></name><name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name></person-group>             <year>2010</year>             <article-title>Clustering metagenomic sequences with interpolated Markov models.</article-title>             <source>BMC Bioinformatics</source>             <volume>11</volume>             <fpage>544</fpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Brady1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brady</surname><given-names>A</given-names></name><name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name></person-group>             <year>2009</year>             <article-title>Phymm and PhymmBL: metagenomic phylogenetic classification with interpolated Markov models.</article-title>             <source>Nat Methods</source>             <volume>6</volume>             <fpage>673</fpage>             <lpage>676</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Altschul1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name></person-group>             <year>1990</year>             <article-title>Basic local alignment search tool.</article-title>             <source>J Mol Biol</source>             <volume>215</volume>             <fpage>403</fpage>             <lpage>410</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-MonzoorulHaque1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Monzoorul Haque</surname><given-names>M</given-names></name><name name-style="western"><surname>Ghosh</surname><given-names>TS</given-names></name><name name-style="western"><surname>Komanduri</surname><given-names>D</given-names></name><name name-style="western"><surname>Mande</surname><given-names>SS</given-names></name></person-group>             <year>2009</year>             <article-title>SOrt-ITEMS: Sequence orthology based approach for improved taxonomic estimation of metagenomic sequences.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>1722</fpage>             <lpage>1730</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Huson1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Huson</surname><given-names>DH</given-names></name><name name-style="western"><surname>Auch</surname><given-names>AF</given-names></name><name name-style="western"><surname>Qi</surname><given-names>J</given-names></name><name name-style="western"><surname>Schuster</surname><given-names>SC</given-names></name></person-group>             <year>2007</year>             <article-title>MEGAN analysis of metagenomic data.</article-title>             <source>Genome Res</source>             <volume>17</volume>             <fpage>377</fpage>             <lpage>386</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Angly1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Angly</surname><given-names>FE</given-names></name><name name-style="western"><surname>Willner</surname><given-names>D</given-names></name><name name-style="western"><surname>Prieto-Davo</surname><given-names>A</given-names></name><name name-style="western"><surname>Edwards</surname><given-names>RA</given-names></name><name name-style="western"><surname>Schmieder</surname><given-names>R</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>The GAAS metagenomic tool and its estimations of viral and microbial average genome size in four major biomes.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000593</fpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Beszteri1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Beszteri</surname><given-names>B</given-names></name><name name-style="western"><surname>Temperton</surname><given-names>B</given-names></name><name name-style="western"><surname>Frickenhaus</surname><given-names>S</given-names></name><name name-style="western"><surname>Giovannoni</surname><given-names>SJ</given-names></name></person-group>             <year>2010</year>             <article-title>Average genome size: a potential source of bias in comparative metagenomics.</article-title>             <source>ISME J</source>             <volume>4</volume>             <fpage>1075</fpage>             <lpage>1077</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Turnbaugh2">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Ley</surname><given-names>RE</given-names></name><name name-style="western"><surname>Mahowald</surname><given-names>MA</given-names></name><name name-style="western"><surname>Magrini</surname><given-names>V</given-names></name><name name-style="western"><surname>Mardis</surname><given-names>ER</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>An obesity-associated gut microbiome with increased capacity for energy harvest.</article-title>             <source>Nature</source>             <volume>444</volume>             <fpage>1027</fpage>             <lpage>1031</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Qin1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Qin</surname><given-names>J</given-names></name><name name-style="western"><surname>Li</surname><given-names>R</given-names></name><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Arumugam</surname><given-names>M</given-names></name><name name-style="western"><surname>Burgdorf</surname><given-names>KS</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>A human gut microbial gene catalogue established by metagenomic sequencing.</article-title>             <source>Nature</source>             <volume>464</volume>             <fpage>59</fpage>             <lpage>65</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Peterson1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Peterson</surname><given-names>J</given-names></name><name name-style="western"><surname>Garges</surname><given-names>S</given-names></name><name name-style="western"><surname>Giovanni</surname><given-names>M</given-names></name><name name-style="western"><surname>McInnes</surname><given-names>P</given-names></name><name name-style="western"><surname>Wang</surname><given-names>L</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>The NIH Human Microbiome Project.</article-title>             <source>Genome Res</source>             <volume>19</volume>             <fpage>2317</fpage>             <lpage>2323</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Nelson1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nelson</surname><given-names>KE</given-names></name><name name-style="western"><surname>Weinstock</surname><given-names>GM</given-names></name><name name-style="western"><surname>Highlander</surname><given-names>SK</given-names></name><name name-style="western"><surname>Worley</surname><given-names>KC</given-names></name><name name-style="western"><surname>Creasy</surname><given-names>HH</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>A catalog of reference genomes from the human microbiome.</article-title>             <source>Science</source>             <volume>328</volume>             <fpage>994</fpage>             <lpage>999</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Stepanauskas1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stepanauskas</surname><given-names>R</given-names></name><name name-style="western"><surname>Sieracki</surname><given-names>ME</given-names></name></person-group>             <year>2007</year>             <article-title>Matching phylogeny and metabolism in the uncultured marine bacteria, one cell at a time.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>9052</fpage>             <lpage>9057</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Woyke1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Woyke</surname><given-names>T</given-names></name><name name-style="western"><surname>Xie</surname><given-names>G</given-names></name><name name-style="western"><surname>Copeland</surname><given-names>A</given-names></name><name name-style="western"><surname>Gonzalez</surname><given-names>JM</given-names></name><name name-style="western"><surname>Han</surname><given-names>C</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Assembling the marine metagenome, one cell at a time.</article-title>             <source>PLoS ONE</source>             <volume>4</volume>             <fpage>e5299</fpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Mavromatis1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mavromatis</surname><given-names>K</given-names></name><name name-style="western"><surname>Ivanova</surname><given-names>N</given-names></name><name name-style="western"><surname>Barry</surname><given-names>K</given-names></name><name name-style="western"><surname>Shapiro</surname><given-names>H</given-names></name><name name-style="western"><surname>Goltsman</surname><given-names>E</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Use of simulated data sets to evaluate the fidelity of metagenomic processing methods.</article-title>             <source>Nat Methods</source>             <volume>4</volume>             <fpage>495</fpage>             <lpage>500</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Rosen1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rosen</surname><given-names>GL</given-names></name><name name-style="western"><surname>Sokhansanj</surname><given-names>BA</given-names></name><name name-style="western"><surname>Polikar</surname><given-names>R</given-names></name><name name-style="western"><surname>Bruns</surname><given-names>MA</given-names></name><name name-style="western"><surname>Russell</surname><given-names>J</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Signal processing for metagenomics: extracting information from the soup.</article-title>             <source>Curr Genomics</source>             <volume>10</volume>             <fpage>493</fpage>             <lpage>510</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Richter1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Richter</surname><given-names>DC</given-names></name><name name-style="western"><surname>Ott</surname><given-names>F</given-names></name><name name-style="western"><surname>Auch</surname><given-names>AF</given-names></name><name name-style="western"><surname>Schmid</surname><given-names>R</given-names></name><name name-style="western"><surname>Huson</surname><given-names>DH</given-names></name></person-group>             <year>2008</year>             <article-title>MetaSim: a sequencing simulator for genomics and metagenomics.</article-title>             <source>PLoS ONE</source>             <volume>3</volume>             <fpage>e3373</fpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Rusch1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rusch</surname><given-names>DB</given-names></name><name name-style="western"><surname>Halpern</surname><given-names>AL</given-names></name><name name-style="western"><surname>Sutton</surname><given-names>G</given-names></name><name name-style="western"><surname>Heidelberg</surname><given-names>KB</given-names></name><name name-style="western"><surname>Williamson</surname><given-names>S</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>The Sorcerer II Global Ocean Sampling expedition: northwest Atlantic through eastern tropical Pacific.</article-title>             <source>PLoS Biol</source>             <volume>5</volume>             <fpage>e77</fpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Case1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Case</surname><given-names>RJ</given-names></name><name name-style="western"><surname>Boucher</surname><given-names>Y</given-names></name><name name-style="western"><surname>Dahllof</surname><given-names>I</given-names></name><name name-style="western"><surname>Holmstrom</surname><given-names>C</given-names></name><name name-style="western"><surname>Doolittle</surname><given-names>WF</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Use of 16S rRNA and rpoB genes as molecular markers for microbial ecology studies.</article-title>             <source>Appl Environ Microbiol</source>             <volume>73</volume>             <fpage>278</fpage>             <lpage>288</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Biers1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Biers</surname><given-names>EJ</given-names></name><name name-style="western"><surname>Sun</surname><given-names>S</given-names></name><name name-style="western"><surname>Howard</surname><given-names>EC</given-names></name></person-group>             <year>2009</year>             <article-title>Prokaryotic genomes and diversity in surface ocean waters: interrogating the global ocean sampling metagenome.</article-title>             <source>Appl Environ Microbiol</source>             <volume>75</volume>             <fpage>2221</fpage>             <lpage>2229</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Gill1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gill</surname><given-names>SR</given-names></name><name name-style="western"><surname>Pop</surname><given-names>M</given-names></name><name name-style="western"><surname>Deboy</surname><given-names>RT</given-names></name><name name-style="western"><surname>Eckburg</surname><given-names>PB</given-names></name><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Metagenomic analysis of the human distal gut microbiome.</article-title>             <source>Science</source>             <volume>312</volume>             <fpage>1355</fpage>             <lpage>1359</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Kurokawa1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kurokawa</surname><given-names>K</given-names></name><name name-style="western"><surname>Itoh</surname><given-names>T</given-names></name><name name-style="western"><surname>Kuwahara</surname><given-names>T</given-names></name><name name-style="western"><surname>Oshima</surname><given-names>K</given-names></name><name name-style="western"><surname>Toh</surname><given-names>H</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Comparative metagenomics revealed commonly enriched gene sets in human gut microbiomes.</article-title>             <source>DNA Res</source>             <volume>14</volume>             <fpage>169</fpage>             <lpage>181</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Vaishampayan1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Vaishampayan</surname><given-names>PA</given-names></name><name name-style="western"><surname>Kuehl</surname><given-names>JV</given-names></name><name name-style="western"><surname>Froula</surname><given-names>JL</given-names></name><name name-style="western"><surname>Morgan</surname><given-names>JL</given-names></name><name name-style="western"><surname>Ochman</surname><given-names>H</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Comparative metagenomics and population dynamics of the gut microbiota in mother and infant.</article-title>             <source>Genome Biol Evol</source>             <volume>2</volume>             <fpage>53</fpage>             <lpage>66</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Li1">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name><name name-style="western"><surname>Ruan</surname><given-names>J</given-names></name><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name></person-group>             <year>2008</year>             <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores.</article-title>             <source>Genome Res</source>             <volume>18</volume>             <fpage>1851</fpage>             <lpage>1858</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Langmead1">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Langmead</surname><given-names>B</given-names></name><name name-style="western"><surname>Trapnell</surname><given-names>C</given-names></name><name name-style="western"><surname>Pop</surname><given-names>M</given-names></name><name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name></person-group>             <year>2009</year>             <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome.</article-title>             <source>Genome Biol</source>             <volume>10</volume>             <fpage>R25</fpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Chen1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>Y</given-names></name><name name-style="western"><surname>Souaiaia</surname><given-names>T</given-names></name><name name-style="western"><surname>Chen</surname><given-names>T</given-names></name></person-group>             <year>2009</year>             <article-title>PerM: efficient mapping of short sequencing reads with periodic full sensitive spaced seeds.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>2514</fpage>             <lpage>2521</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Sandberg1">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sandberg</surname><given-names>R</given-names></name><name name-style="western"><surname>Winberg</surname><given-names>G</given-names></name><name name-style="western"><surname>Branden</surname><given-names>CI</given-names></name><name name-style="western"><surname>Kaske</surname><given-names>A</given-names></name><name name-style="western"><surname>Ernberg</surname><given-names>I</given-names></name><etal/></person-group>             <year>2001</year>             <article-title>Capturing whole-genome characteristics in short sequences using a naive Bayesian classifier.</article-title>             <source>Genome Res</source>             <volume>11</volume>             <fpage>1404</fpage>             <lpage>1409</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Engeman1">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Engeman</surname><given-names>RM</given-names></name><name name-style="western"><surname>Sugihara</surname><given-names>RT</given-names></name><name name-style="western"><surname>Pank</surname><given-names>LF</given-names></name><name name-style="western"><surname>Dusenberry</surname><given-names>WE</given-names></name></person-group>             <year>1994</year>             <article-title>A Comparison of Plotless Density Estimators Using Monte Carlo Simulation.</article-title>             <source>Ecology</source>             <volume>75</volume>             <fpage>1769</fpage>             <lpage>1779</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Liu1">
        <label>37</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name></person-group>             <year>2008</year>             <source>Monte Carlo strategies in scientific computing</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0027992-Markowitz1">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Markowitz</surname><given-names>VM</given-names></name><name name-style="western"><surname>Chen</surname><given-names>IM</given-names></name><name name-style="western"><surname>Palaniappan</surname><given-names>K</given-names></name><name name-style="western"><surname>Chu</surname><given-names>K</given-names></name><name name-style="western"><surname>Szeto</surname><given-names>E</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>The integrated microbial genomes system: an expanding comparative analysis resource.</article-title>             <source>Nucleic Acids Res</source>             <volume>38</volume>             <fpage>D382</fpage>             <lpage>390</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Liolios1">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liolios</surname><given-names>K</given-names></name><name name-style="western"><surname>Chen</surname><given-names>IM</given-names></name><name name-style="western"><surname>Mavromatis</surname><given-names>K</given-names></name><name name-style="western"><surname>Tavernarakis</surname><given-names>N</given-names></name><name name-style="western"><surname>Hugenholtz</surname><given-names>P</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>The Genomes On Line Database (GOLD) in 2009: status of genomic and metagenomic projects and their associated metadata.</article-title>             <source>Nucleic Acids Res</source>             <volume>38</volume>             <fpage>D346</fpage>             <lpage>354</lpage>          </element-citation>
      </ref>
      <ref id="pone.0027992-Turnbaugh3">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name><name name-style="western"><surname>Yatsunenko</surname><given-names>T</given-names></name><name name-style="western"><surname>Cantarel</surname><given-names>BL</given-names></name><name name-style="western"><surname>Duncan</surname><given-names>A</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>A core gut microbiome in obese and lean twins.</article-title>             <source>Nature</source>             <volume>457</volume>             <fpage>480</fpage>             <lpage>484</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>