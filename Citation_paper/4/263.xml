<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-14-12046</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0105776</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Gene ontologies</subject><subj-group><subject>Gene ontology annotations</subject></subj-group></subj-group><subj-group><subject>Genome annotation</subject><subject>Genomic databases</subject></subj-group></subj-group><subj-group><subject>Comparative genomics</subject></subj-group></subj-group><subj-group><subject>Ecology</subject><subj-group><subject>Community ecology</subject><subj-group><subject>Community structure</subject></subj-group></subj-group></subj-group><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Bacterial genomics</subject><subj-group><subject>Bacterial genomes</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group><subject>Microbiology</subject></subj-group><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group><subject>Systems biology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Ecology and environmental sciences</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>BLAST algorithm</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Research and analysis methods</subject><subj-group><subject>Computational techniques</subject></subj-group><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Software-aided sequence analysis</subject></subj-group></subj-group><subj-group><subject>Database searching</subject><subj-group><subject>Sequence similarity searching</subject></subj-group></subj-group><subj-group><subject>Biological databases</subject></subj-group></subj-group><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Comparative Analysis of Functional Metagenomic Annotation and the Mappability of Short Reads</article-title>
<alt-title alt-title-type="running-head">Comparative Analysis of Short-Read Functional Metagenomic Annotation</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Carr</surname><given-names>Rogan</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Borenstein</surname><given-names>Elhanan</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Genome Sciences, University of Washington, Seattle, WA, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Computer Science and Engineering, University of Washington, Seattle, WA, United States of America</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Santa Fe Institute, Santa Fe, NM, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Gibas</surname><given-names>Cynthia</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of North Carolina at Charlotte, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">elbo@uw.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: RC EB. Performed the experiments: RC. Analyzed the data: RC EB. Contributed to the writing of the manuscript: RC EB.</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>22</day><month>8</month><year>2014</year></pub-date>
<volume>9</volume>
<issue>8</issue>
<elocation-id>e105776</elocation-id>
<history>
<date date-type="received"><day>17</day><month>3</month><year>2014</year></date>
<date date-type="accepted"><day>25</day><month>7</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Carr, Borenstein</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>To assess the functional capacities of microbial communities, including those inhabiting the human body, shotgun metagenomic reads are often aligned to a database of known genes. Such homology-based annotation practices critically rely on the assumption that short reads can map to orthologous genes of similar function. This assumption, however, and the various factors that impact short read annotation, have not been systematically evaluated. To address this challenge, we generated an extremely large database of simulated reads (totaling 15.9 Gb), spanning over 500,000 microbial genes and 170 curated genomes and including, for many genomes, <italic>every</italic> possible read of a given length. We annotated each read using common metagenomic protocols, fully characterizing the effect of read length, sequencing error, phylogeny, database coverage, and mapping parameters. We additionally rigorously quantified gene-, genome-, and protocol-specific annotation biases. Overall, our findings provide a first comprehensive evaluation of the capabilities and limitations of functional metagenomic annotation, providing crucial goal-specific best-practice guidelines to inform future metagenomic research.</p>
</abstract>
<funding-group><funding-statement>This work was supported by New Innovator Award DP2 AT007802-01 to EB and by NIH P30 DK089507. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="13"/></counts><custom-meta-group><custom-meta id="data-availability" xlink:type="simple"><meta-name>Data Availability</meta-name><meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files.</meta-value></custom-meta></custom-meta-group></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Metagenomics, the study of uncultured microorganisms through the analysis of genomic material obtained directly from environmental samples, has been used to study the structure, function, and dynamics of microbial communities. These studies allowed us to gain a deeper understanding of the tremendous diversity of microbes in various environments <xref ref-type="bibr" rid="pone.0105776-Rusch1">[1]</xref>–<xref ref-type="bibr" rid="pone.0105776-Wu1">[3]</xref>, the complex structure of the communities they form <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>, and the crucial impact they have on the surrounding environment <xref ref-type="bibr" rid="pone.0105776-Tyson1">[5]</xref>. Amongst the numerous communities explored by metagenomics-based methods, studies of the human microbiome have been especially exciting, allowing us to characterize the previously unmapped composition of this complex ecosystem <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>, <xref ref-type="bibr" rid="pone.0105776-Qin1">[6]</xref>–<xref ref-type="bibr" rid="pone.0105776-Morgan1">[8]</xref> and to link compositional shifts in the microbiome to multiple diseases <xref ref-type="bibr" rid="pone.0105776-Qin1">[6]</xref>, <xref ref-type="bibr" rid="pone.0105776-Qin2">[9]</xref>–<xref ref-type="bibr" rid="pone.0105776-Greenblum1">[11]</xref>.</p>
<p>While earlier studies focused mainly on the composition of species in the community, nowadays, many metagenomic studies take a gene-centric approach and further aim to characterize the overall functional profile of the community through shotgun metagenomics. In such studies, shotgun sequencing reads are mapped to a database of orthologous gene groups (e.g., KEGG <xref ref-type="bibr" rid="pone.0105776-Kanehisa1">[12]</xref>, COG <xref ref-type="bibr" rid="pone.0105776-Tatusov1">[13]</xref>, EggNOG <xref ref-type="bibr" rid="pone.0105776-Powell1">[14]</xref>, M5NR <xref ref-type="bibr" rid="pone.0105776-Wilke1">[15]</xref>, Metacyc <xref ref-type="bibr" rid="pone.0105776-Caspi1">[16]</xref>) to identify matches to genes or proteins with known and annotated functions. Notably, it is the biological function of the identified homologous gene rather than the taxonomic identity that is sought in such an analysis. Accordingly, mapping is most often done with a translated BLAST search to identify high-scoring (though potentially evolutionarily distant) alignments indicative of orthology <xref ref-type="bibr" rid="pone.0105776-Dalevi1">[17]</xref>. By tracking the number of reads that map to each gene family or orthology group, the functional profile of the metagenome can be obtained, providing insight into the functional capacity of the community as a whole <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>, <xref ref-type="bibr" rid="pone.0105776-Yatsunenko1">[7]</xref>, <xref ref-type="bibr" rid="pone.0105776-Greenblum1">[11]</xref>, <xref ref-type="bibr" rid="pone.0105776-Turnbaugh1">[18]</xref>–<xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref>. This annotation process and the estimation of the number of reads that map to each function is a crucial step in comparative metagenomic studies and in the discovery of functional shifts associated with disease, as it is the foundation of all such analyses.</p>
<p>A critical assumption behind this annotation scheme and the key to accurately recovering the functional profile of the metagenome is that short sequencing reads contain enough information to unambiguously map to the correct function. Put differently, these annotation protocols assume that each read will be mapped to either its gene of origin (if, for example, a genome closely related to the one from which the read originated were to be present in the database) or to an orthologous gene from a potentially distant genome annotated with the same function. These protocols further assume that reads originating from intergenic regions or from orthology groups with unknown function (e.g., functions not represented in our database) will not be erroneously mapped to any of the functionally annotated genes in our database. These assumptions are essential both for estimating the relative abundance of each function (or gene) in the community and for determining the presence or absence of gene families or other functional modules of interest. To date, however, no comprehensive and systematic analysis has evaluated these assumptions on a large scale, nor have protocols for this annotation procedure been standardized. The lack of such a systematic analysis makes the results presented in many metagenomic studies hard to assess and interpret and challenges any attempt to compare functional analysis across different studies.</p>
<p>Notably, the assumptions above and the annotation of short reads are still important even when some preprocessing (e.g., clustering <xref ref-type="bibr" rid="pone.0105776-Kelley1">[21]</xref>, <xref ref-type="bibr" rid="pone.0105776-Li1">[22]</xref> or assembly <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>, <xref ref-type="bibr" rid="pone.0105776-Qin1">[6]</xref>, <xref ref-type="bibr" rid="pone.0105776-Sharon1">[23]</xref>, <xref ref-type="bibr" rid="pone.0105776-Albertsen1">[24]</xref>) or post processing (e.g., pathway-level analysis or network reconstruction <xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref>, <xref ref-type="bibr" rid="pone.0105776-Liu1">[25]</xref>) are involved. Specifically, when short reads are clustered or assembled into contigs and whole genes are called and annotated, direct short-read annotation can still be used to annotate the potentially sizeable number of unassembled reads (e.g. ∼50% of reads from human microbiome samples <xref ref-type="bibr" rid="pone.0105776-Qin1">[6]</xref>, <xref ref-type="bibr" rid="pone.0105776-Meth1">[26]</xref>). Moreover, even when reads are assembled into contigs, direct functional annotation is often still performed independently for <italic>all</italic> short reads to obtain an unbiased functional abundance profile for the entire sample <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>. Similarly, when estimating pathway coverage and abundance, even though the integration of annotation data from multiple reads, gap filling methods, and subnetwork scoring schemes can improve the accuracy of the obtained functional profile, the accuracy of the annotation of individual reads will clearly impact any downstream analysis. More generally, characterizing the information content of short reads and their mappability to gene families and functions goes beyond addressing questions concerning the applicability of short read annotation practices and may help elucidate profound and fundamental properties of microbial genomes.</p>
<p>Here, we address this challenge and perform a large-scale and systematic evaluation of homology-based functional annotation of short reads. We aim to uncover the impact of various technological and biological factors affecting the resulting annotation profiles, to compare common annotation protocols, and, more generally, to investigate the intrinsic mappability of such short reads. We focus primarily on annotation protocols that use translated BLAST. Direct translated BLAST searches of short reads for functional homology is a common strategy in microbiome research <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>, <xref ref-type="bibr" rid="pone.0105776-Yatsunenko1">[7]</xref>, <xref ref-type="bibr" rid="pone.0105776-Greenblum1">[11]</xref>, <xref ref-type="bibr" rid="pone.0105776-Dalevi1">[17]</xref>–<xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref>, and was one of the key methods used by the Human Microbiome Project (HMP) for sample annotation <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>, <xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref>. Tools promoted by this project (e.g., <xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref>) further relied on such BLAST alignments as input and are becoming the <italic>de facto</italic> standard in human microbiome research. To date, however, there has been no in-depth analysis of the systematic biases inherent to these homology-based annotation protocols and their many variations found in the literature. Our study, accordingly, seeks to provide a benchmark, demonstrating what can be expected of such annotation strategies, what their strengths and weaknesses are, and what biases can be expected in the functional annotation profiles obtained by such protocols.</p>
<p>To this end, we have constructed a large-scale database containing more than 143 million simulated shotgun sequencing reads spanning more than 500,000 microbial genes and 170 curated and annotated genomes. Each read was annotated using common metagenomic protocols, and the obtained annotations were carefully analyzed at various scales, from the single-read level to the entire dataset level, to investigate the different factors that affect the accuracy of the obtained annotations. We took advantage of the fact that BLAST-based annotation maps each read to the database independently to analyze the annotation obtained for each read in the context of the genome from which it originated, fixing in place any genomic and phylogenetic characteristics that might bias the annotation process and allowing us to accurately characterize the impact of such characteristics across the bacterial and archaeal tree of life. This approach additionally allowed us to test the importance of the phylogenetic coverage of the database (i.e., the relation of the strain in question to those present in the database) to the annotation process. We further rigorously examined the impact of sequencing error, read length, phylogeny, copy number, annotation protocol, and BLAST parameters. Finally, we examined the effect of different annotation protocols on the functional profile obtained for HMP metagenomic samples, and assessed the performance of an alternative alignment strategy. Overall, this extensive analysis provides a first comprehensive assessment of functional metagenomic annotation, quantifying gene orthology group-specific, genome-specific, and protocol-specific annotation biases and suggesting goal-dependent best-practice guidelines.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Reference genomes, simulated short reads, and annotations</title>
<p>We collected curated reference genomes of 170 microbial species spanning 23 phyla and 89 genera across the bacterial and archaeal tree of life (<xref ref-type="supplementary-material" rid="pone.0105776.s006">Table S1</xref>). Curated annotations of these genomes were obtained from the KEGG database <xref ref-type="bibr" rid="pone.0105776-Kanehisa1">[12]</xref> to identify protein-coding genes and their associated KEGG Orthology (KO) annotations. The total number of genes and the number of KO-associated genes (‘KO genes’) vary significantly across genomes (<xref ref-type="supplementary-material" rid="pone.0105776.s006">Table S1</xref>). For example, the genome of <italic>E. coli</italic> O157:H7, a well-characterized strain, was annotated with 5477 protein-coding genes, of which 2999 were KO genes (55%), while the genome of <italic>B. thetaiotaomicron</italic>, a human commensal bacterium, had 4816 protein-coding genes, of which only 1365 were KO genes (28%). The genome of <italic>S. pneumoniae</italic> ATCC 700669, which we analyze in detail below, was also relatively well characterized, with 55% of its protein-coding genes mapped to KOs. The <italic>phylogenetic coverage</italic> of these genomes in the KEGG database also vary significantly, with some having as many as 51 genomes from the same species (<italic>E. coli</italic>) and as many as 79 in the same genus (<italic>S. pneumoniae</italic>), while other genomes were the only representative of their genus in the database.</p>
<p>From these genomes we generated an extremely large-scale database of simulated short sequencing reads, including 179 unique short read datasets totaling more than 15.9 Gb (<xref ref-type="supplementary-material" rid="pone.0105776.s007">Table S2</xref>). Specifically, we used a sliding window approach to generate short reads of a given length from each of the genomes above. For some genomes, <italic>every</italic> possible 101-bp read was generated (<xref ref-type="fig" rid="pone-0105776-g001">Figure 1a</xref>). As described below, additional datasets were also generated to examine the impact of read length and sequencing error on the annotation process (<xref ref-type="supplementary-material" rid="pone.0105776.s007">Table S2</xref>). The origin of each read was recorded to note whether it originated from a KO gene, a non-KO gene, or an intergenic region. These reads were then mapped to the KEGG database using the blastx protocol employed by the Human Microbiome Project (HMP) <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>, <xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref> and annotated according to the identified matches. To evaluate the accuracy of the annotation process, obtained annotations were compared to the annotation of the region in the curated genome from which each read originated (<xref ref-type="fig" rid="pone-0105776-g001">Figure 1a</xref>). Complete details of the methods used are provided in <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>.</p>
<fig id="pone-0105776-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105776.g001</object-id><label>Figure 1</label><caption>
<title>Overview of the analysis scheme.</title>
<p>(<bold>a</bold>) Simulated sets of reads of length L are generated from curated and annotated reference genomes using a sliding window approach. The origin of each read is recorded, and reads are labeled to note whether they originated from genes associated with a KO (purple), from genes not associated with a KO (green), or from an intergenic region (gray). Each read is then annotated through a translated BLAST search against the KEGG database and the obtained annotation is compared to the annotation of the genome region from which the read was derived, to evaluate whether the correct gene and/or correct KO were recovered. (<bold>b</bold>) Evaluating the annotation of the <italic>S. pneumoniae</italic> genome. The inner ring represents the proportion of the genome annotated with KO genes, non-KO genes, and intergenic regions. The outer ring illustrates how reads originating from each such category were annotated, illustrating the accuracy of the annotations obtained by a BLAST-based search.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105776.g001" position="float" xlink:type="simple"/></fig></sec><sec id="s2b">
<title>A best-case scenario for functionally annotating short reads</title>
<p>We first analyze an ideal case for annotating short shotgun metagenomic sequencing reads, wherein reads originated from strains that have been sequenced, are well-annotated, and are present in the reference database. We used the set of <italic>every</italic> possible <italic>S. pneumoniae</italic> read, described above, and annotated each read using a typical BLAST-based protocol (see below and <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>). Overall, we found that the obtained annotation accurately described the <italic>S. pneumoniae</italic> strain's known functions with little error (<xref ref-type="fig" rid="pone-0105776-g001">Figure 1b</xref>). Specifically, KO annotations had 96.9% precision, suggesting that only a few reads from non-KO genes or from intergenic regions were incorrectly assigned a KO and that only a few reads from KO genes were assigned the wrong KO. Moreover, the annotation of reads originating from a KO gene had a 94.7% recall, indicating that, generally, reads originating from such genes were correctly identified. Importantly however, in the majority of cases, while the correct KO was recovered, the annotation process could not accurately identify the specific gene of origin, as reads often matched equally well to homologous genes from multiple other strains (<xref ref-type="fig" rid="pone-0105776-g001">Figure 1b</xref>). The prevalence of such tied matches is at least partly an outcome of using a translated BLAST search which identifies matches at the peptide level, allowing divergence in the nucleotide sequence. This lack of specificity is a clear benefit of the translated BLAST approach in functionally annotating short reads, but comes at the cost of inaccurate taxonomic classification, for which marker gene approaches are better suited <xref ref-type="bibr" rid="pone.0105776-Segata1">[27]</xref>–<xref ref-type="bibr" rid="pone.0105776-Wu2">[29]</xref>.</p>
</sec><sec id="s2c">
<title>The impact of sequencing errors and read length</title>
<p>Importantly, one of the key goals of this study is to characterize the information contained in short DNA fragments in terms of the function of the gene from which they originated. We therefore focused on the potential mappability of short reads and largely ignored artifacts introduced by specific sequencing technologies. Yet, to confirm that such technology-derived factors do not dramatically affect our findings, we examined the impact of typical sequencing errors on the annotation process. To this end, experimentally derived Illumina error profiles were added to the set of 101-bp <italic>S. pneumoniae</italic> reads with error rates of 0.15%, 1.5%, and 3% to generate 3 new datasets (<italic>Methods</italic>). Reads were then annotated and analyzed as before. Overall, we found a minimal change in the accuracy of the obtained annotations, with comparable recall and precision levels to those observed without sequencing errors, regardless of the error rate or phylogenetic coverage (<xref ref-type="supplementary-material" rid="pone.0105776.s008">Table S3</xref>).</p>
<p>Thus far, our analysis has been restricted to 101-bp reads – a common length for Illumina sequencing reads and the length generated by the HMP <xref ref-type="bibr" rid="pone.0105776-Meth1">[26]</xref>. However, various sequencing technologies (e.g. Roche 454 Genome Sequencer, Pacific Biosciences, as well as newer Illumina protocols) can now generate longer reads, and in general, it is likely that available high-throughput reads will continue to increase in length as sequencing technologies mature. To examine the effect of read length on the performance of a typical translated BLAST-based annotation protocol, we generated 5 additional simulated datasets from the <italic>S. pneumoniae</italic> genome with read lengths of 75, 150, 200, 300, and 400 bp (<xref ref-type="supplementary-material" rid="pone.0105776.s007">Table S2</xref>). Annotating and analyzing these datasets using the same protocols as before, we found, not surprisingly, that read length significantly influences the annotation process. Specifically, for reads originating from within KO genes, the recall increased with read length, while the precision decreased (<xref ref-type="supplementary-material" rid="pone.0105776.s008">Table S3</xref>). Including all reads overlapping KO genes, recall begins to decrease with read length for reads longer than 150 bp (<xref ref-type="supplementary-material" rid="pone.0105776.s001">Figure S1b</xref>). Furthermore, the choice of annotation protocol (see below) significantly affects annotation performance for longer reads (<xref ref-type="supplementary-material" rid="pone.0105776.s008">Table S3</xref>). Current protocols were developed mostly for 101-bp or shorter reads and consequently commonly used alignment cutoff values (e.g., E-value&lt;1) may be too permissive for longer reads, leading to spurious annotations and reduced precision (<xref ref-type="supplementary-material" rid="pone.0105776.s013">Text S1</xref> and <xref ref-type="supplementary-material" rid="pone.0105776.s001">Figure S1</xref>). Examining the E-value distributions obtained for longer reads demonstrated that as expected, for a fixed E-value cutoff, precision decreases with read length (<xref ref-type="supplementary-material" rid="pone.0105776.s001">Figure S1a</xref>, <xref ref-type="supplementary-material" rid="pone.0105776.s002">Figure S2</xref>). Moreover, length-dependent cutoff values can be determined to increase the annotation precision with a relatively small decrease in recall (<xref ref-type="supplementary-material" rid="pone.0105776.s013">Text S1</xref>).</p>
</sec><sec id="s2d">
<title>The impact of phylogenetic coverage of the reference database</title>
<p>Clearly, in many — if not most — cases, the actual strains from which the sampled microbial reads originate are not represented in the reference database. In fact, in many environments, the community may include strains from species, genera, or even higher taxonomic levels that are not at all covered by reference genomes <xref ref-type="bibr" rid="pone.0105776-Wright1">[30]</xref>. It is therefore crucial to test the robustness of the annotation process in such scenarios and to assess how well short reads can be functionally mapped in the absence of closely related references. To this end, we re-annotated the set of short reads derived from <italic>S. pneumonia</italic> described above, but with the corresponding (i) strain, (ii) species, or (iii) genus removed from the database (<italic>Methods</italic>). We found that predicted annotations decreased in accuracy with phylogenetic coverage as expected (<xref ref-type="fig" rid="pone-0105776-g002">Figure 2a</xref>). However, as long as genomes from the genus <italic>Streptococcus</italic> were present in the database, the impact on the annotation process was relatively minimal. In contrast, when all genomes from the genus <italic>Streptococcus</italic> were removed from the database, the recall fell to 70.7%.</p>
<fig id="pone-0105776-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105776.g002</object-id><label>Figure 2</label><caption>
<title>The impact of phylogenetic coverage of the database on the performance of a translated BLAST-based annotation.</title>
<p>(<bold>a</bold>) The inner ring represents the proportion of the <italic>S. pneumonia</italic> genome annotated with KO genes, non-KO genes, and intergenic regions, as in <xref ref-type="fig" rid="pone-0105776-g001">Figure 1</xref>. Outer Rings illustrate the annotations for reads from each such category obtained with varying levels of phylogenetic coverage, ranging from having the strain from which the reads originated present in the database, to having only other genomes from the same species, genus, or higher taxonomic levels present. (<bold>b</bold>) The impact of phylogenetic database coverage on the annotation of <italic>B. fragilis</italic>, <italic>E. coli</italic>, <italic>S. elongatus</italic>, and <italic>M. maripaludis</italic> genomes.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105776.g002" position="float" xlink:type="simple"/></fig>
<p>Notably, <italic>S. pneumoniae</italic> is well covered by our database, which contains 18 genomes from this species and 79 genomes from the genus <italic>Streptococcus</italic>. To determine whether the results described above could be generalized to other bacterial and archaeal species, we performed the same analysis for 4 additional species: <italic>Bacteroides fragilis</italic>, <italic>Escherichia coli</italic> (both human commensal bacteria), <italic>Synechococcus elongatus</italic> (a freshwater cyanobacterium), and <italic>Methanococcus maripaludis</italic> (a marine archaeon). The impact of phylogenetic coverage for these 4 species is generally consistent with that seen in <italic>S. pneumonia</italic>, with overall high recall and precision for mapping reads from KO genes when the strain is present in the database and a decrease in performance with decreasing phylogenetic coverage (<xref ref-type="fig" rid="pone-0105776-g002">Figure 2b</xref>). However, the exact decrease and the coverage at which accuracy dropped significantly, vary from species to species. For example, the recall for annotating <italic>S. elongatus</italic> drops dramatically even after the removal of all the species genomes from the database, although other members of this genus are still present in the database. Additional results for the impact of phylogenetic coverage across a large array of microbial organisms are presented below (and in <xref ref-type="fig" rid="pone-0105776-g003">Figure 3</xref>).</p>
<fig id="pone-0105776-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105776.g003</object-id><label>Figure 3</label><caption>
<title>The performance of BLAST-based annotation of short reads across the bacterial and archaeal tree of life.</title>
<p>The phylogenetic tree was obtained from Ref. <xref ref-type="bibr" rid="pone.0105776-Ciccarelli1">[50]</xref>. Colored rings represent the recall for identifying reads originating from a KO gene using the <italic>top gene</italic> protocol. The 4 rings correspond to varying levels of database coverage. Specifically, the innermost ring illustrates the recall obtained when the strain from which the reads originated is included in the database, while the other 3 rings, respectively, correspond to cases where only genomes from the same species, genus, or more remote taxonomic relationships are present in the database. Entries where no data were available (for example, when the strain from which the reads originated was the only member of its species) are shaded gray. For one genome in each phylum, denoted by a black dot at the branch tip, every possible 101-bp read was generated for this analysis. For the remaining genomes, every 10<sup>th</sup> possible read was used. Blue bars represent the fraction of the genome's peptide genes associated with a KO; for reference, the values are shown for <italic>E. coli</italic>, <italic>B. thetaiotaomicron</italic>, and <italic>S. pneumoniae</italic>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105776.g003" position="float" xlink:type="simple"/></fig></sec><sec id="s2e">
<title>Annotation accuracy across the tree of life</title>
<p>To fully explore the effect of phylogeny on translated BLAST-based short read annotation of bacteria and archaea, we performed the same analysis for an additional 165 organisms across the bacterial and archaeal tree of life (<xref ref-type="fig" rid="pone-0105776-g003">Figure 3</xref>). For one organism from each phylum, every possible 101-bp read was simulated, and for the remaining organisms every 10<sup>th</sup> possible read was simulated (i.e., using a sliding window with 10-bp jumps). We found that the precision for identifying reads from KO genes was generally consistent across the tree (average precision 0.95±0.03), but the recall appears to be clade specific (<xref ref-type="fig" rid="pone-0105776-g003">Figure 3</xref>). Furthermore, the effect of the phylogenetic coverage of the database on recall also varied significantly from clade to clade. Interestingly, while some of this variation could be attributed to the availability of reference genomes closely related to the clade of interest (e.g. <italic>Escherichia</italic>, <italic>Shewanella</italic>), some of the variation is clearly attributed to natural divergence within the clade. For example, as mentioned above, the annotation of reads from a <italic>Synechococcus elongatus</italic> genome is relatively poor when <italic>elongatus</italic> species are removed from the database even when other genomes from the same genus are present. This is possibly because the genus <italic>Synechococcus</italic> contains both freshwater and marine species, and <italic>S. elongatus</italic>, a freshwater species, has diverged significantly from the marine species included in this clade. Such clade-specific variations should be taken into account when annotating short reads from relatively less well studied clades.</p>
</sec><sec id="s2f">
<title>Comparison of annotation protocols</title>
<p>In most studies, the translated BLAST search is only the first step in the annotation process and one of a variety of protocols is then used to analyze the obtained set of alignments (i.e., those that satisfy a predefined threshold) and to determine the annotation that will be assigned to each read. For our analysis in the previous sections, we used the ‘<italic>top gene’</italic> protocol, assigning each read with the gene annotation of the top-scoring alignment(s). This is a common protocol that has been used in many previous studies (e.g., <xref ref-type="bibr" rid="pone.0105776-Yatsunenko1">[7]</xref>, <xref ref-type="bibr" rid="pone.0105776-Turnbaugh1">[18]</xref>, <xref ref-type="bibr" rid="pone.0105776-Huson1">[31]</xref>–<xref ref-type="bibr" rid="pone.0105776-Markowitz1">[33]</xref>). Other studies, however, apply different protocols, such as assigning the annotation of potentially sub optimal alignments to enrich for functional annotations <xref ref-type="bibr" rid="pone.0105776-Turnbaugh2">[19]</xref>, or averaging over multiple high-scoring hits (e.g., <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>, <xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref>). In this section, we therefore compared the <italic>top gene</italic> protocol with three additional protocols: The ‘<italic>top KO’</italic> protocol aims to maximize the number of annotated reads, assigning the read with the annotation of the top-scoring alignment to a KO gene, even if better alignments have been found to other non-KO genes in the database. This is analogous to performing a search only against genes with known orthology groups (e.g., COG <xref ref-type="bibr" rid="pone.0105776-Tatusov1">[13]</xref>, EggNOG <xref ref-type="bibr" rid="pone.0105776-Powell1">[14]</xref>). The <italic>‘top 20 genes’</italic> protocol seeks to correct for annotation errors and mismatches, using the annotation of the top 20 alignments weighted by their E-values. Finally, the <italic>‘top 20 KOs’</italic> protocol combines these two approaches, using the same top 20 alignments but considering only those that align to KO genes, weighted by E-value <xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref>. A detailed description of these protocols is provided in <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>.</p>
<p>To evaluate these annotation protocols, we examined the set of annotations obtained by each protocol for each of the 170 strain-derived datasets described above, calculating the precision and recall in each case (<xref ref-type="supplementary-material" rid="pone.0105776.s008">Table S3</xref>). We found marked differences between the performances of these four protocols, highlighting the impact of annotation methodology on downstream results. Specifically, when the strain from which the reads originated was removed from the BLAST database, the <italic>top gene</italic> protocol reached higher precision than any of the three other protocols in almost every dataset, with the <italic>top 20 genes</italic> protocol being a close second (<xref ref-type="fig" rid="pone-0105776-g004">Figure 4a</xref>). Yet, this high precision comes with slightly lower recall, and when higher recall is desired, the <italic>top KO</italic> or <italic>top 20 KOs</italic> are better choices (<xref ref-type="fig" rid="pone-0105776-g004">Figure 4b</xref>). These patterns hold regardless of the phylogenetic coverage of the database (<xref ref-type="supplementary-material" rid="pone.0105776.s008">Table S3</xref>). Generally, however, it appears that protocols that consider only alignments to KO genes (e.g., <italic>top KO</italic> and <italic>top 20 KOs</italic>) suffer a lack of precision in return for a slightly higher recall. This tradeoff between precision and recall can have a significant impact on downstream analysis and should be considered when designing a metagenomic analysis pipeline with a specific goal.</p>
<fig id="pone-0105776-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105776.g004</object-id><label>Figure 4</label><caption>
<title>Comparison of annotation protocols for analyzing BLAST results.</title>
<p>The (<bold>a</bold>) precision and (<bold>b</bold>) recall are illustrated for several protocols for identifying reads originating from KO genes when the strain from which the reads originated is absent from the database. Genomes are ordered by their precision and recall, respectively, using the <italic>top gene</italic> protocol.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105776.g004" position="float" xlink:type="simple"/></fig></sec><sec id="s2g">
<title>Evaluating the annotation profile obtained for complete sets of reads</title>
<p>As discussed above, a BLAST-based search independently maps each read to the reference database, and in the previous sections, we therefore focused on the ability of such a process to correctly recover the annotation of any single read. In practice, however, the various annotations obtained for the set of reads in a given sample are commonly analyzed jointly, as the overall functional profile of the metagenome is of more interest than the annotation of individual reads. In this context, erroneous annotation of individual reads may be acceptable as long as the combined annotation profile is relatively accurate. The accuracy of this combined profile may be especially important when downstream integrative analyses or pathway-level reconstructions (e.g., <xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref>) are performed. In this section we accordingly examined the annotation profile obtained for a complete set of reads by aggregating the counts calculated for each KO across all reads in each 101-bp dataset (<xref ref-type="supplementary-material" rid="pone.0105776.s008">Table S3</xref>; <italic>Methods</italic>). We then compared these aggregated counts to the KO profile of the genome from which each dataset was derived. Since copy numbers are a more intuitive measure than relative abundances, we further translated these aggregated KO counts into copy number estimates by normalizing KO counts by the length of the gene and dividing by the average normalized counts of 15 highly-conserved single-copy genes (<italic>Methods</italic>; <xref ref-type="bibr" rid="pone.0105776-Carr1">[34]</xref>). By examining the predicted copy number of each KO in each dataset and comparing it to the actual copy number of the KO in the corresponding genome, we found that direct short read annotation successfully distinguished KOs with different copy numbers (<xref ref-type="fig" rid="pone-0105776-g005">Figure 5a</xref>). Predicted copy numbers were distributed normally around the expected value, with greater deviation for higher copy numbers, as expected for a constant error rate per read. This analysis, however, also illustrates the relatively high rate of false predictions, wherein KOs that are in fact absent from the sample are predicted to be present. To determine how accurately the recovered KO abundance profiles reflected the actual KO abundance in each dataset, we calculated the Jensen-Shannon distance between the predicted and actual distributions of KO copy numbers, comparing the performances of the 4 protocols described above. We again found that the <italic>top gene</italic> protocol had the most accurate representation of KO copy numbers, regardless of phylogenetic coverage (<xref ref-type="supplementary-material" rid="pone.0105776.s008">Table S3</xref>; paired t-test; <italic>Methods</italic>).</p>
<fig id="pone-0105776-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105776.g005</object-id><label>Figure 5</label><caption>
<title>Performance of BLAST-based annotation in recovering the functional profile of a complete set of reads.</title>
<p>(<bold>a</bold>) The probability function of predicting the copy number of a given KO in a given dataset across all simulated 101-bp datasets using the <italic>top gene</italic> protocol and when the strain from which the reads originated is absent from the database. Only KOs with copy numbers 1 to 4 are illustrated. The curve corresponding to copy number 0 represents false positive KO predictions. The smaller peaks showing in some curves (e.g., the two extra peaks in the blue “1 copy” curve) were found to be due to stretches of intergenic reads that mismapped to KO genes in the database and likely reflect genomic misannotations or pseudogenes. (<bold>b</bold>) The average recall across all simulated 101-bp datasets for identifying reads originating from each KO, ranked from highest to lowest average recall. 95% confidence intervals are shown in green. Recall is calculated for the case where the strain from which the read originated is absent from the database.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105776.g005" position="float" xlink:type="simple"/></fig>
<p>Having characterized the mappability of &gt;143 million reads originating from many different genomes and associated with thousands of different orthology groups (KOs), we finally examined the variability in the recall of reads originating from different KOs. Such variability makes some KOs easier to identify than others through short read annotation schemes, potentially biasing the obtained functional profile of a metagenomic sample. As demonstrated in <xref ref-type="fig" rid="pone-0105776-g005">Figure 5b</xref>, recall values across KOs are relatively consistent and high for most KOs, with &gt;88% of the KOs in our analysis having &gt;0.85 average recall. Yet a small number of KOs have consistently low recall. To determine whether poorly mapped KOs tend to be associated with specific functions, we examined the KOs in the bottom 5% of recall. We found that the pathways for lysine-, polycyclic aromatic hydrocarbon-, bisphenol-, limonene and pinene-, aminobenzoate-, and ethylbenzene degradation were all enriched in these poorly mapping KOs (hypergeometric test at 0.05 FDR; <xref ref-type="supplementary-material" rid="pone.0105776.s009">Table S4</xref>). We additionally computed the correlation between the obtained recall values and various gene properties derived from the KEGG database to gain insight into potential determinants of mappability (<italic>Methods</italic>). We found that recall decreases for KOs with higher variability in length and copy number, suggesting as expected that low sequence conservation can lead to lower mappability <xref ref-type="bibr" rid="pone.0105776-Zhang1">[35]</xref>, and for KOs containing genes with high sequence similarity to genes in other KOs (<xref ref-type="supplementary-material" rid="pone.0105776.s009">Table S4</xref>). This gene-specific variability should be considered when analyzing the functional composition of metagenomes and when performing comparative metagenomic analysis. A list of these poorly mappable KOs, with the average recall and precision obtained, can be found in <xref ref-type="supplementary-material" rid="pone.0105776.s010">Table S5</xref>.</p>
</sec><sec id="s2h">
<title>Evaluating the impact of annotation protocols on functional profiles obtained for HMP samples</title>
<p>In the analyses above, we have characterized translated-BLAST-based annotation of short metagenomic reads through the use of carefully controlled simulations. Such simulations allow for the precise quantification of the accuracy and error in the annotation process as a function of various biological and technological parameters. In this section, we further explored the impact of the four translated-BLAST based annotation protocols described above on the annotation of real biological samples and examined their impact on the obtained functional profiles. To this end, we used these protocols to re-annotate 15 stool samples from the Human Microbiome Project (HMP) <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>, <xref ref-type="bibr" rid="pone.0105776-Meth1">[26]</xref> and translated the obtained KO abundance profiles to pathway abundance profiles to determine whether the different protocols led to discrepancies in the perceived pathway-level functional profile of each sample and whether such an effect could mask real biological signals (see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>).</p>
<p>We first set out to compare the variation in the functional profile introduced by the selection of a protocol to the natural variation in functional profiles between different samples. We accordingly calculated the Jensen-Shannon distances between the profiles obtained by the different protocols for any given sample and the Jensen-Shannon distances obtained for the various samples by any given protocol. Importantly, we found that the inter-protocol distances are on the same order of magnitude as the inter-sample distances for any one protocol (<xref ref-type="supplementary-material" rid="pone.0105776.s011">Table S6</xref>). A similar pattern was also observed for the KO abundance profiles (<xref ref-type="supplementary-material" rid="pone.0105776.s011">Table S6</xref>). Moreover, performing a principal component analysis of the calculated pathway abundance profiles, we found that the first principal component separates samples mostly by annotation protocol and that inter-sample variation is mostly captured only by the second component (<xref ref-type="fig" rid="pone-0105776-g006">Figure 6</xref>). This pattern, wherein variation introduced by protocol selection masks true biological variation between samples, is analogous to a batch effect often observed when mixing samples derived by different experimental procedures. Finally, to demonstrate that these apparent protocol-dependent discrepancies introduced consistent biases in pathway abundances and could therefore impact downstream comparative analysis, we examined which pathways appear to be differentially abundant between the profile obtained by one protocol (‘top gene’) and those obtained by other protocols. We found that in fact the vast majority of pathways were differentially abundant between protocols (Wilcoxon-signed rank test at 0.05 FDR; <xref ref-type="supplementary-material" rid="pone.0105776.s012">Table S7</xref>).</p>
<fig id="pone-0105776-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105776.g006</object-id><label>Figure 6</label><caption>
<title>A principal component analysis of the pathway abundance profiles obtained for the 15 analyzed HMP samples and by the four different annotation protocols.</title>
<p>HMP samples are numbered from 1 to 15 according to the list that appears in <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>. The different protocols are represented by color and shape. Note that two outlier protocols for sample 14 are not shown but were included in the PCA calculation.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105776.g006" position="float" xlink:type="simple"/></fig>
<p>Combined, these findings clearly demonstrate that the choice of functional annotation protocol plays a significant role in analyzing a metagenomic sample and greatly impacts the obtained functional profiles. More importantly, our analysis indicates that inter-protocol variation is comparable to inter-sample variation, suggesting that protocol choice can dramatically impact biological interpretation, potentially obscuring real biological signals and impeding downstream comparative analysis.</p>
</sec><sec id="s2i">
<title>Comparison of alignment strategies</title>
<p>Functional annotation of short metagenomic sequencing reads is most often performed with a translated BLAST search, which aligns a nucleotide sequence to amino acid sequences using all six possible nucleotide reading frames. As discussed above, this alignment strategy sacrifices accuracy in taxonomic labeling of the sequencing read for improved detection of potential protein homology at longer evolutionary distances. While BLAST-based alignments are likely to remain a viable option in coming years, the growth of microbial genome collections, especially in the context of specific environments, has rendered high-quality alignment of sequencing reads directly to genomes an increasingly attractive option for annotating reads. To further explore the tradeoff between identification of function and identification of taxonomy made by these protocols, we compared the performance of translated BLAST to a commonly-used high-quality aligner (BWA <xref ref-type="bibr" rid="pone.0105776-Li2">[36]</xref>), examining the obtained precision and recall of functional annotation using a set of reference genomes at an increasing evolutionary distance. To this end, we re-annotated the set of short reads derived from <italic>S. pneumonia</italic> described above, but with groups of genomes removed from the reference database using a 16S-based distance cutoff (<italic>Methods</italic>, and <xref ref-type="supplementary-material" rid="pone.0105776.s003">Figure S3</xref>). As expected, we find that at short evolutionary distances, BWA has a marginally higher precision and recall than BLAST for identifying KOs (<xref ref-type="supplementary-material" rid="pone.0105776.s004">Figure S4</xref>). Importantly, however, recall for BWA approaches zero at longer evolutionary distances and its precision drops dramatically once the number of Bacterial and Archaeal genomes in the reference database is small, while translated BLAST maintains a relatively high recall and precision (<xref ref-type="supplementary-material" rid="pone.0105776.s003">Figures S3</xref> and <xref ref-type="supplementary-material" rid="pone.0105776.s004">S4</xref>).</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>We have presented a systematic and comprehensive study of BLAST-based functional annotation of short sequencing reads and rigorously characterized annotation protocols commonly used in metagenomic studies. We found that in general such direct annotation of short reads accurately identifies both individual reads and the functional profile of entire samples, but that there is significant variability in annotation accuracy, with many factors impacting the annotation process. For example, the obtained accuracy is affected both by the phylogenetic coverage of the database, with related genomes from the same genus being necessary to accurately annotate most species, and by the phylogeny of the strain in question, with the recall being strongly clade-dependent. Read length was also found to play an important role, with the permissive E-value thresholds appropriate for identifying correct short-read alignments (<xref ref-type="supplementary-material" rid="pone.0105776.s013">Text S1</xref> and <xref ref-type="supplementary-material" rid="pone.0105776.s002">Figure S2</xref>) leading to a decreasing accuracy for longer (&gt;200-bp) reads. Once such longer-read technologies become widely available, new strategies for read-based annotation will be necessary, including length-dependent E-value cutoffs and, ideally, incorporating additional methods, such as contig assembly and gene calling <xref ref-type="bibr" rid="pone.0105776-Gevers1">[37]</xref>–<xref ref-type="bibr" rid="pone.0105776-Treangen1">[39]</xref>. In contrast, our analysis demonstrated that typical next-generation sequencing error had little effect on annotation accuracy, probably owing to the nature of translated BLAST searches.</p>
<p>Taken together, our findings highlight the need to design a study-specific pipeline, taking into account the goals of the study and the relative importance of each bias in the annotation process, such as the tradeoff between recall and precision. For example, a comparative metagenomic study that aims to identify differentially abundant genes or pathways in some disease (e.g., Refs. <xref ref-type="bibr" rid="pone.0105776-Qin1">[6]</xref>, <xref ref-type="bibr" rid="pone.0105776-Qin2">[9]</xref>, <xref ref-type="bibr" rid="pone.0105776-Karlsson1">[10]</xref>, <xref ref-type="bibr" rid="pone.0105776-Turnbaugh1">[18]</xref>) requires an accurate estimation of gene abundances and may apply a different annotation protocol compared to a study aiming to reconstruct a metagenome-level metabolic network (e.g., <xref ref-type="bibr" rid="pone.0105776-Greenblum2">[40]</xref>) that requires accurate prediction of gene presence. These tradeoffs, and the importance of specific annotation parameters and protocols, may also account for previously reported poor performances of homology-based annotation of short reads in terms of both recall <xref ref-type="bibr" rid="pone.0105776-Wommack1">[41]</xref> and precision <xref ref-type="bibr" rid="pone.0105776-Zhang1">[35]</xref>. Our findings suggest that these could be partly rescued by, for example, using a more permissive E-value cutoff to gain a higher recall and using a broader database to gain high precision. Specifically, annotation procedures using a reference database containing only genes associated with known orthology groups (such as COG), rather than representatives of all genes, effectively use a ‘<italic>top KO’</italic> approach which decreases precision.</p>
<p>Importantly, while the analysis presented here relied specifically on KEGG genome annotations, the conclusions are likely applicable to any gene orthology-based database. More generally, the functional annotation protocols evaluated here are clearly based on the conjecture that sequence homology is an indicator of shared function. This orthology–function conjecture has been shown to hold as a general trend, but is also known to be false in at least some cases <xref ref-type="bibr" rid="pone.0105776-Gabaldn1">[42]</xref>. Nonetheless, as demonstrated above, the functional profiles estimated by such homology-based annotation protocols clearly successfully reconstruct the overall functional profile of the sampled community.</p>
<p>Notably, successors to short-read sequencing technologies, such as long-read sequencing and single-cell genomics, are on the horizon. When such technologies become standard components of microbiome experiments, translated BLAST-based functional annotation may no longer be the best option for estimating the functional profile of a community. Translated BLAST alignments also require relatively long runtimes compared to approaches like BWA <xref ref-type="bibr" rid="pone.0105776-Li2">[36]</xref> or Bowtie <xref ref-type="bibr" rid="pone.0105776-Langmead1">[43]</xref> (though many specialized, efficient implementations of BLAST have been recently introduced <xref ref-type="bibr" rid="pone.0105776-Davis1">[44]</xref>, <xref ref-type="bibr" rid="pone.0105776-Oehmen1">[45]</xref>). These newer technologies, however, are still in their early stages and at least several years will be required before they are widely adopted. Furthermore, strategies for mapping short metagenomic reads to reference genomes from highly-related strains (e.g., BWA <xref ref-type="bibr" rid="pone.0105776-Li2">[36]</xref>, Bowtie <xref ref-type="bibr" rid="pone.0105776-Langmead1">[43]</xref>) require near-complete genome coverage of a microbial community to provide a reliable community-level functional description. While it is likely that the human microbiome will be relatively well covered within the next decade, highly diverse and open environments such as the ocean may never have complete genome catalogs. Translated BLAST-based approaches, and more generally, homology-based annotation protocols, therefore still represent a viable option for functional characterization of metagenomic samples for years to come.</p>
<p>Overall, our findings offer an improved understanding of homology-based annotation capabilities and delineate the boundaries of metagenomic functional annotation practices. The clade-dependent accuracy of the obtained annotation we observed above highlights the pressing need to extend the collection of reference genomes available and to capture a wider diversity of gene orthology groups through efforts such as the Genomic Encyclopaedia of Bacteria and Archaea (GEBA) Project <xref ref-type="bibr" rid="pone.0105776-Wu3">[46]</xref> and especially the Microbial Dark Matter (MDM) project <xref ref-type="bibr" rid="pone.0105776-Rinke1">[47]</xref>. The results and methodologies of our study can be used to pinpoint particular phylogenetic branches for additional sequencing, such as branches with consistently poor functional annotation that suggest sparse coverage of representative sequences. Our findings indeed demonstrate that including a diverse representation of genera should be a priority for sequencing programs. Clearly, this need for diversity should be balanced with efforts to reduce the complexity of the database (e.g., using representative sequences as in the Pfam database <xref ref-type="bibr" rid="pone.0105776-Punta1">[48]</xref>) and with improved characterization of the link between sequence homology and shared function <xref ref-type="bibr" rid="pone.0105776-Gabaldn1">[42]</xref>. Ultimately, however such combined efforts, aiming to both improve annotation practices and expand reference microbial databases, will allow us to move toward a more accurate annotation of metagenomic data and a more complete understanding of the functional capacities encoded by microbial communities.</p>
</sec><sec id="s4" sec-type="methods">
<title>Methods</title>
<sec id="s4a">
<title>Simulating sequencing reads</title>
<p>Simulated sequencing reads were generated by sliding a fixed-size window across complete genomes obtained from the KEGG database (KEGG v. 63; July 2<sup>nd</sup>, 2012 weekly release) <xref ref-type="bibr" rid="pone.0105776-Kanehisa1">[12]</xref>. The genome of <italic>Streptococcus pneumoniae</italic> ATCC 700669 (KEGG code <italic>sne</italic>), was used to test the effects of read length and sequencing error. Specifically, to test the effect of read length, 6 datasets of simulated reads were created, including <italic>every</italic> possible read of lengths 75, 101, 150, 200, 300, and 400 bp. The 101-bp dataset was then used as the basis for simulating reads with sequencing error rates of 0.15%, 1.5%, and 3%. To simulate this next-generation sequencing error, a position-dependent error profile created with Ibis <xref ref-type="bibr" rid="pone.0105776-Kircher1">[49]</xref> from an Illumina sequencing run with a total error rate of 0.15% was applied and uniformly magnified to achieve the desired error rate. To study the effect of phylogeny, simulated sequencing reads were further generated from 167 bacterial and archaeal genomes included in the tree of life constructed by Ref. <xref ref-type="bibr" rid="pone.0105776-Ciccarelli1">[50]</xref> and from two additional human-commensal genomes of <italic>E. coli</italic> and <italic>B. fragilis</italic>. See <xref ref-type="supplementary-material" rid="pone.0105776.s006">Table S1</xref> for a complete list of genomes used in this analysis. Organisms from the tree of life of Ref. <xref ref-type="bibr" rid="pone.0105776-Ciccarelli1">[50]</xref> were mapped to KEGG organisms first by NCBI TaxID, and then by matching the strain name if the NCBI TaxID did not match. Species for which more than one KEGG organism existed were mapped to an arbitrary strain from that species. One species, <italic>Gemmata obscuriglobus</italic>, did not have a representative strain in KEGG and was not included in the analysis. Sets of simulated reads consisting of <italic>every</italic> possible 101-bp read were generated for the two human-commensal genomes and for one organism from each of the 23 Phyla present in the tree (resulting in &gt;100-fold coverage). Alpha-, beta-, gamma-, delta-, and epsilonproteobacteria were considered separate phyla in the analysis. For the remaining 144 genomes, simulated reads were generated representing every 10<sup>th</sup> possible sequencing read by moving a sliding window over the genome at 10 bp jumps (resulting in a &gt;10-fold coverage). A complete list of the 178 datasets of simulated reads generated for this analysis is provided in <xref ref-type="supplementary-material" rid="pone.0105776.s007">Table S2</xref>.</p>
</sec><sec id="s4b">
<title>Mapping and annotating reads</title>
<p>To annotate the simulated reads, each sequencing read from each dataset was aligned to a custom peptide database containing the peptide sequences from all annotated KEGG organisms (KEGG v. 63; July 2<sup>nd</sup>, 2012 weekly release <xref ref-type="bibr" rid="pone.0105776-Kanehisa1">[12]</xref>). To this end, Translated Query-Protein Subject BLAST (blastx) v. 2.2.25+, with standard parameters and accepting all matches with an E-value&lt;1 (as done by the HMP <xref ref-type="bibr" rid="pone.0105776-Huttenhower1">[4]</xref>, <xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref>) was used (average execution time 7.6098±0.76247 s/read). To test the effect of low-complexity sequence filtering on the obtained alignments, identical searches were performed with SEG filtering <xref ref-type="bibr" rid="pone.0105776-Wootton1">[51]</xref> disabled for all error-free <italic>S. pneumoniae</italic> datasets (see <xref ref-type="supplementary-material" rid="pone.0105776.s013">Text S1</xref>). To examine the impact of the phylogenetic coverage of the database, additional BLAST results were simulated by removing alignments to the correct strain, species, or genus from the original set of BLAST alignments. This is mathematically equivalent to a scenario where database sequences from the corresponding strain, species, or genus are replaced with non-matching sequences of identical lengths, thereby preserving all database size-based metrics (e.g. E-value).</p>
<p>Once reads were mapped to the KEGG database, each read was annotated according to the KEGG Orthology groups (KOs) associated with the identified alignments. As described in the main text, four different protocols were applied to determine which of the potentially many alignments found would be used to annotate the read: (i) <italic>‘Top gene’</italic> – the read was annotated based on the top-scoring alignment (i.e., the alignment(s) with the smallest E-value), regardless of whether this alignment was associated with a KO or not. If several alignments were tied for the top score, all were used. If the top scoring alignment(s) was not associated with any KO, the read was annotated has having <italic>no result</italic>. (ii) <italic>‘Top KO’</italic> – the read was annotated based on the top scoring alignment(s) that was associated with a KO. Potentially better scoring alignments that were not associated with a KO were ignored. (iii) <italic>‘Top 20 genes’</italic> – the read was annotated based on the top 20 scoring alignments (i.e., the up-to 20 alignments with the smallest E-values), regardless of whether these alignments were associated with a KO or not. (iv) <italic>‘Top 20 KOs’</italic> – the read was annotated based on all alignments that were associated with a KO among the top 20 scoring alignments. In case of top scoring ties or in protocols where multiple alignments were considered (i.e., <italic>top 20 genes</italic> or <italic>top 20 KOs</italic>), the read was annotated based on all the selected alignments weighted by their P-value using the following formula: <disp-formula id="pone.0105776.e001"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105776.e001" xlink:type="simple"/><label>(1)</label></disp-formula>or<disp-formula id="pone.0105776.e002"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105776.e002" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105776.e003" xlink:type="simple"/></inline-formula> is the weight, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105776.e004" xlink:type="simple"/></inline-formula> the E-value for annotation <italic>i</italic>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105776.e005" xlink:type="simple"/></inline-formula> is the corresponding P-value. As the E-value denotes the expected number of matches for an alignment of a given score in the given database, and the P-value denotes the probability of finding at least one match with at least this score in the database, considering the P-value in this manner thus weights the matches by their relative probabilities of occurring by chance. While this weighting scheme was employed by the HMP, it was found that the functional form of the weighting scheme and the alignment parameter used (E-value, bit-score) had little effect on the annotations <xref ref-type="bibr" rid="pone.0105776-Abubucker1">[20]</xref>. If the collection of alignments were associated with more than one KO, the read would therefore be annotated with multiple KOs, each given a fractional count that summed to unity. Notably, cases in which alignments not associated with a KO were considered (e.g., in the <italic>top 20 genes</italic> protocol), these alignments clearly did not contribute to the set of KOs with which the read was annotated but were still considered in the weighting scheme, thereby lowering the fractional counts given to the other KO alignments.</p>
</sec><sec id="s4c">
<title>Evaluating obtained annotations</title>
<p>To evaluate the accuracy of the annotation process, the annotations obtained for each read were compared to the annotations associated with the genomic region from which the read originated. Specifically, each read could have originated from a <italic>KO gene</italic> (a gene associated with a KO annotation), a <italic>non-KO gene</italic> (a gene with no known KO annotation), or from an <italic>intergenic</italic> region. Reads that originated from multiple genomic categories (e.g., reads that span both a gene and an intergenic region) were excluded from the analyses as the ‘correct’ annotation was not well defined. Repeating the analysis with such multiple-category reads included by weighing the categories with the relative coverage within each read did not qualitatively change the results reported in the main text (<xref ref-type="supplementary-material" rid="pone.0105776.s008">Table S3</xref>; and see also <xref ref-type="supplementary-material" rid="pone.0105776.s013">Text S1</xref> and <xref ref-type="supplementary-material" rid="pone.0105776.s005">Figure S5</xref> for an analysis of the mappability of partially overlapping reads). Considering these categories, the set of alignments and annotations obtained for each read could then be classified (<xref ref-type="fig" rid="pone-0105776-g001">Figure 1a</xref>). Specifically, each alignment obtained for a read originating from a KO gene could be classified as (a) correct gene and correct KO, (b) incorrect gene but correct KO, (c) incorrect gene and incorrect KO, or (d) incorrect gene that is not associated with a KO. Similarly, each alignment obtained for a read originating from a non-KO gene could be classified as (a) correct gene that is, as expected, not associated with a KO, (b) incorrect gene that is not associated with a KO, or (c) incorrect gene and incorrect KO. Finally, an alignment obtained for a read originating from an intergenic region could be classified as (a) incorrect gene and incorrect KO, or (b) incorrect gene that is not associated with a KO. Reads for which no alignment was found by blastx were classified as <italic>‘no result’</italic>. For alignment ties or in protocols were multiple alignments could be considered (e.g., top 20 genes), the classifications of all alignments considered were weighted as described above. To evaluate the performance of the annotation process in each dataset, the overall recall and precision of the obtained annotations were calculated. When comparing annotation performance across read lengths, all reads were included in the analysis, as multiple-category reads accounted for almost half the reads for longer sequencing reads.</p>
</sec><sec id="s4d">
<title>Evaluating the annotation profile for a complete sets of reads</title>
<p>When evaluating the accuracy of the annotation profile obtained for a complete set of reads (e.g., all reads simulated from a specific genome), the total count for each KO was calculated as the sum of all counts toward this KO obtained across all the reads included in this dataset. KO counts were then normalized by the length of the gene to correct for length-bias in read counts. To simulate the case where the actual gene from which the read originated was not known, gene lengths were approximated by the length of the gene to which the read was aligned. For comparison, KOs were alternatively normalized by the average length of all the genes associated with the KO. This scheme, however, resulted in reduced accuracy across all protocols and at all levels of phylogenetic coverage (<xref ref-type="supplementary-material" rid="pone.0105776.s008">Table S3</xref>). Finally, to estimate the copy number of each KO, these normalized counts were divided by the mean count over a set of 15 ribosomal genes found with 1 copy across all bacteria and archaea in the KEGG database <xref ref-type="bibr" rid="pone.0105776-Carr1">[34]</xref>. To estimate how well the predicted KO copy numbers in each sample reflected the actual KO copy numbers, the square root of the Jensen-Shannon divergence (JSD), the Jensen-Shannon distance, between the calculated and actual KO copy numbers was calculated. To gain insight into potential determinants of mappability, we further computed the correlation between the recall values obtained and the average, standard deviation, and coefficient of deviation of the gene lengths for each KO, the number of genes in each KO, the number of genomes covered by each KO, and the mean and standard deviation of genes per genome. Additionally, we computed the correlation between the recall values and the fraction of matches to genes from different KOs and the percent-identity of the highest match to a gene from a different KO in the KEGG Orthology SSDB using a gene chosen randomly for each KO from the genomes used in this study <xref ref-type="bibr" rid="pone.0105776-Kanehisa1">[12]</xref>.</p>
</sec><sec id="s4e">
<title>Evaluating annotation profiles obtained for HMP stool samples</title>
<p>Human sequence-filtered and quality-filtered, Illumina shotgun sequences were downloaded from the Human Microbiome Project Data Analysis Coordination Center (<ext-link ext-link-type="uri" xlink:href="http://HMPDACC.org" xlink:type="simple">http://HMPDACC.org</ext-link>) for 15 stool samples from the original HMP cohort (SRS011084, SRS024075, SRS024388, SRS011239, SRS020233, SRS011302, SRS049900, SRS011271, SRS015190, SRS011529, SRS016989, SRS011134, SRS058770, SRS023971, SRS021484). Sequencing reads were aligned to the same custom peptide database as the simulated reads using mBLAST (mblastx) <xref ref-type="bibr" rid="pone.0105776-Davis1">[44]</xref>, a multicore, shared memory implementation of the Translated Query-Protein Subject BLAST (blastx), with standard parameters and accepting all matches with an E-value&lt;1 (average execution time 0.6±0.8 ms/read). KO abundances were computed using each of the four protocols, as outlined above. Pathway abundances were calculated by summing the abundances of all KOs associated with each pathway, and the pathway abundances for each sample were normalized by the total pathway count. Only pathways with differences in ≥10 samples were tested for differential abundance.</p>
</sec><sec id="s4f">
<title>Comparison of functional annotations derived with BWA to translated BLAST alignments</title>
<p>Custom reference databases for BWA (nucleotide sequences) and BLAST (peptide sequences) were constructed from gene sequences from all annotated KEGG organisms (KEGG v. 63; July 2<sup>nd</sup>, 2012 weekly release <xref ref-type="bibr" rid="pone.0105776-Kanehisa1">[12]</xref>) that were at an evolutionary distance greater than some cutoff from <italic>Streptococcus pneumoniae</italic> ATCC 700669 (KEGG code <italic>sne</italic>). To determine these evolutionary distances, we used the protocol employed in Refs. <xref ref-type="bibr" rid="pone.0105776-Levy1">[52]</xref>, <xref ref-type="bibr" rid="pone.0105776-Zaneveld1">[53]</xref>. Briefly, 16S rRNA gene sequences were extracted from all Archaea and Bacteria in KEGG. If an Archaeon or Bacterium had no annotated 16S rRNA genes, then 16S rRNA sequences were obtained from the same taxa in the Integrated Microbial Genomes (IMG) database, v. 4.0 <xref ref-type="bibr" rid="pone.0105776-Markowitz2">[54]</xref>, using the corresponding NCBI Taxon ID. 76 Bacteria and Archaea from KEGG had no 16S gene annotated in either KEGG or the IMG and were excluded from the analysis. 16S rRNA genes were then aligned to the Greengenes core set using PyNAST v. 0.1 <xref ref-type="bibr" rid="pone.0105776-Caporaso1">[55]</xref>. Distances between all pairs of aligned 16S rRNA sequences were computed using Clearcut v. 1.0.9 <xref ref-type="bibr" rid="pone.0105776-Evans1">[56]</xref>. The evolutionary distance from the <italic>S. pneumoniae</italic> ‘<italic>sne</italic>’ genome was then calculated as the mean distance between all <italic>sne</italic> 16S rRNA genes and all 16S rRNA genes from a given genome. BWA databases were constructed at evolutionary distances of 0.0, 0.05, 0.125, 0.2, 0.275, 0.35, 0.425, 0.5, and 0.575 (<xref ref-type="supplementary-material" rid="pone.0105776.s003">Figure S3</xref>). At short evolutionary distances (0.0, 0.05, 0.125), BLAST matches were found by removing alignments to genomes at evolutionary distances below the cutoff (or to genomes that had been excluded from the analysis) from the alignment to all protein-coding genes from annotated organisms, as described above. For evolutionary distances longer than 0.125, new BLAST databases were constructed to avoid skewing the E-value metrics by changing the database size. Similar to previous simulations, all possible contiguous 101-bp reads from the <italic>S. pneumoniae</italic> ‘<italic>sne</italic>’ genome were aligned to each database. Translated Query-Protein Subject BLAST (blastx) alignments were performed as done previously. BWA alignments were performed using BWA-MEM version 0.7.8 <xref ref-type="bibr" rid="pone.0105776-Li2">[36]</xref>, taking the top alignment. Functional annotation was performed as described above, using the ‘top gene’ approach for the translated BLAST alignments.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pone.0105776.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0105776.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>The precision (a, circles) and recall (b, squares) for identifying KEGG orthology groups from short sequencing reads using different E-value cutoffs as a function of read length.</bold></p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0105776.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>The distribution of E-values from translated BLAST searches of simulated short sequencing reads against all annotated peptides from the KEGG database.</bold> The distributions obtained for the (<bold>a</bold>) 101-bp and (<bold>b</bold>) 400-bp datasets derived from the <italic>S. pneumoniae</italic> genome are shown. The different colors represent the various categories of reads and their annotation as in <xref ref-type="fig" rid="pone-0105776-g001">Figure 1</xref>. The bimodal distribution seen in (<bold>b</bold>) is due to the use of a low-complexity filter in the translated BLAST search (See <xref ref-type="supplementary-material" rid="pone.0105776.s013">Text S1</xref>).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0105776.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>The number of available bacterial and archaeal genomes as a function of 16S distance from </bold><bold><italic>Streptococcus pneumoniae</italic></bold><bold> ATCC 700669 (KEGG code </bold><bold><italic>sne</italic></bold><bold>), represented as a histogram.</bold> Vertical dashed lines highlight the evolutionary distance cutoffs used to construct reference genome databases for comparing BWA and BLAST alignments (see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref> and also <xref ref-type="supplementary-material" rid="pone.0105776.s004">Figure S4</xref>).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0105776.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>The precision (a, circles) and recall (b, squares) for BWA- (white) and translated BLAST- (blue) based functional annotation of the </bold><bold><italic>Streptococcus pneumoniae</italic></bold><bold> ATCC 700669 (KEGG code </bold><bold><italic>sne</italic></bold><bold>) genome as a function of the minimal evolutionary distance to genomes included in the reference database.</bold></p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0105776.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p><bold>The mappability of reads that only partially overlap a KO gene through a translated BLAST search.</bold> The probability of such overlapping reads to correctly map to the KO of origin, vs. the probability to erroneously map to a gene from an incorrect KO, a non-KO gene, or to have no result is shown as a function of the number of bases the read overlaps with the gene. Probabilities are averaged across all 101-bp datasets, with error bars representing 95% confidence intervals.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s006" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pone.0105776.s006" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p><bold>Summary of all genomes used in this study.</bold></p>
<p>(DOCX)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s007" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pone.0105776.s007" position="float" xlink:type="simple"><label>Table S2</label><caption>
<p><bold>Summary of all datasets generated for this study.</bold></p>
<p>(DOCX)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s008" mimetype="application/vnd.ms-excel" xlink:href="info:doi/10.1371/journal.pone.0105776.s008" position="float" xlink:type="simple"><label>Table S3</label><caption>
<p><bold>Summary of all results obtained for each simulated dataset.</bold></p>
<p>(XLS)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s009" mimetype="application/vnd.ms-excel" xlink:href="info:doi/10.1371/journal.pone.0105776.s009" position="float" xlink:type="simple"><label>Table S4</label><caption>
<p><bold>Correlation of various KO properties with KO average recall values, and pathways enriched (FDR&lt;0.05) among the KOs in the bottom 5% of recall.</bold></p>
<p>(XLS)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s010" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" xlink:href="info:doi/10.1371/journal.pone.0105776.s010" position="float" xlink:type="simple"><label>Table S5</label><caption>
<p><bold>The average recall and precision obtained per KEGG Orthology Group (KO). Poorly mapping genes (Recall&lt;85%) are highlighted in red.</bold></p>
<p>(XLSX)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s011" mimetype="application/vnd.ms-excel" xlink:href="info:doi/10.1371/journal.pone.0105776.s011" position="float" xlink:type="simple"><label>Table S6</label><caption>
<p><bold>The Jensen-Shannon distance between KO or pathway abundance profiles for different samples and for the same sample annotated with different annotation protocols.</bold></p>
<p>(XLS)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s012" mimetype="application/vnd.ms-excel" xlink:href="info:doi/10.1371/journal.pone.0105776.s012" position="float" xlink:type="simple"><label>Table S7</label><caption>
<p><bold>Pathways and KOs enriched between HMP stool samples annotated with different functional annotation protocols.</bold> A ‘1’ indicates enrichment (FDR&lt;0.05) and ‘0’ indicates no enrichment.</p>
<p>(XLS)</p>
</caption></supplementary-material><supplementary-material id="pone.0105776.s013" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pone.0105776.s013" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>An analysis of E-value cutoff schemes and the effect of low-complexity filtering on typical E-value distributions, and an analysis of reads originating from multiple genomic regions.</bold></p>
<p>(DOCX)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>Thanks to Martin Kircher for the sequencing error models and surrounding discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0105776-Rusch1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rusch</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Halpern</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Sutton</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Heidelberg</surname><given-names>KB</given-names></name>, <name name-style="western"><surname>Williamson</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>The Sorcerer II Global Ocean Sampling expedition: northwest Atlantic through eastern tropical Pacific</article-title>. <source>PLoS Biol</source> <volume>5</volume>: <fpage>e77</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0050077" xlink:type="simple">10.1371/journal.pbio.0050077</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Ley1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ley</surname><given-names>RE</given-names></name>, <name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lozupone</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Ramey</surname><given-names>RR</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Evolution of mammals and their gut microbes</article-title>. <source>Science (80-)</source> <volume>320</volume>: <fpage>1647</fpage>–<lpage>1651</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1155725" xlink:type="simple">10.1126/science.1155725</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Wu1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Halpern</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Rusch</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Yooseph</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Stalking the fourth domain in metagenomic data: searching for, discovering, and interpreting novel, deep branches in marker gene phylogenetic trees</article-title>. <source>PLoS One</source> <volume>6</volume>: <fpage>e18011</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0018011" xlink:type="simple">10.1371/journal.pone.0018011</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Huttenhower1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huttenhower</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Gevers</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Abubucker</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Badger</surname><given-names>JH</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source> <volume>486</volume>: <fpage>207</fpage>–<lpage>214</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11234" xlink:type="simple">10.1038/nature11234</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Tyson1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tyson</surname><given-names>GW</given-names></name>, <name name-style="western"><surname>Chapman</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Allen</surname><given-names>EE</given-names></name>, <name name-style="western"><surname>Ram</surname><given-names>RJ</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Community structure and metabolism through reconstruction of microbial genomes from the environment</article-title>. <source>Nature</source> <volume>428</volume>: <fpage>37</fpage>–<lpage>43</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature02340" xlink:type="simple">10.1038/nature02340</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Qin1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Raes</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Arumugam</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Burgdorf</surname><given-names>KS</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title>. <source>Nature</source> <volume>464</volume>: <fpage>59</fpage>–<lpage>65</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08821" xlink:type="simple">10.1038/nature08821</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Yatsunenko1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yatsunenko</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Rey</surname><given-names>FE</given-names></name>, <name name-style="western"><surname>Manary</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Trehan</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Dominguez-Bello</surname><given-names>MG</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Human gut microbiome viewed across age and geography</article-title>. <source>Nature</source>. <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11053" xlink:type="simple">10.1038/nature11053</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Morgan1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morgan</surname><given-names>XC</given-names></name>, <name name-style="western"><surname>Segata</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Huttenhower</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>Biodiversity and functional genomics in the human microbiome</article-title>. <source>Trends Genet</source> <fpage>1</fpage>–<lpage>8</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tig.2012.09.005" xlink:type="simple">10.1016/j.tig.2012.09.005</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Qin2"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Cai</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>A metagenome-wide association study of gut microbiota in type 2 diabetes</article-title>. <source>Nature</source> <volume>490</volume>: <fpage>55</fpage>–<lpage>60</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11450" xlink:type="simple">10.1038/nature11450</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Karlsson1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Karlsson</surname><given-names>FH</given-names></name>, <name name-style="western"><surname>Tremaroli</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Nookaew</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Bergström</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Behre</surname><given-names>CJ</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Gut metagenome in European women with normal, impaired and diabetic glucose control</article-title>. <source>Nature</source> <fpage>4</fpage>–<lpage>10</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12198" xlink:type="simple">10.1038/nature12198</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Greenblum1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greenblum</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Borenstein</surname><given-names>E</given-names></name> (<year>2011</year>) <article-title>Metagenomic systems biology of the human gut microbiome reveals topological shifts associated with obesity and inflammatory bowel disease</article-title>. <source>PNAS</source> <volume>109</volume>: <fpage>594</fpage>–<lpage>599</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1116053109/-/DCSupplemental" xlink:type="simple">10.1073/pnas.1116053109/-/DCSupplemental</ext-link>. <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/cgi/doi/10.1073/pnas.1116053109" xlink:type="simple">www.pnas.org/cgi/doi/10.1073/pnas.1116053109</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Kanehisa1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sato</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Furumichi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Tanabe</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>KEGG for integration and interpretation of large-scale molecular data sets</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>D109</fpage>–<lpage>14</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr988" xlink:type="simple">10.1093/nar/gkr988</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Tatusov1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tatusov</surname><given-names>RL</given-names></name>, <name name-style="western"><surname>Fedorova</surname><given-names>ND</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Jacobs</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Kiryutin</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>The COG database: an updated version includes eukaryotes</article-title>. <source>BMC Bioinformatics</source> <volume>4</volume>: <fpage>41</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-4-41" xlink:type="simple">10.1186/1471-2105-4-41</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Powell1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Powell</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Szklarczyk</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Trachana</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Roth</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kuhn</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>eggNOG v3.0: orthologous groups covering 1133 organisms at 41 different taxonomic ranges</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>D284</fpage>–<lpage>9</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1060" xlink:type="simple">10.1093/nar/gkr1060</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Wilke1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilke</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Harrison</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Wilkening</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Field</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Glass</surname><given-names>EM</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The M5nr: a novel non-redundant database containing protein sequences and annotations from multiple sources and associated tools</article-title>. <source>BMC Bioinformatics</source> <volume>13</volume>: <fpage>141</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-13-141" xlink:type="simple">10.1186/1471-2105-13-141</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Caspi1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Caspi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Altman</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Dreher</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Fulcher</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Subhraveti</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The MetaCyc database of metabolic pathways and enzymes and the BioCyc collection of pathway/genome databases</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>D742</fpage>–<lpage>53</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1014" xlink:type="simple">10.1093/nar/gkr1014</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Dalevi1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dalevi</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ivanova</surname><given-names>NN</given-names></name>, <name name-style="western"><surname>Mavromatis</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Hooper</surname><given-names>SD</given-names></name>, <name name-style="western"><surname>Szeto</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Annotation of metagenome short reads using proxygenes</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>i7</fpage>–<lpage>13</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn276" xlink:type="simple">10.1093/bioinformatics/btn276</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Turnbaugh1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Yatsunenko</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Cantarel</surname><given-names>BL</given-names></name>, <name name-style="western"><surname>Duncan</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>A core gut microbiome in obese and lean twins</article-title>. <source>Nature</source> <volume>457</volume>: <fpage>480</fpage>–<lpage>484</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07540" xlink:type="simple">10.1038/nature07540</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Turnbaugh2"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Ridaura</surname><given-names>VK</given-names></name>, <name name-style="western"><surname>Faith</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Rey</surname><given-names>FE</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>The effect of diet on the human gut microbiome: a metagenomic analysis in humanized gnotobiotic mice</article-title>. <source>Sci Transl Med</source> <volume>1</volume>: <fpage>6ra14</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/scitranslmed.3000322" xlink:type="simple">10.1126/scitranslmed.3000322</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Abubucker1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abubucker</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Segata</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Goll</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Schubert</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Izard</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Metabolic Reconstruction for Metagenomic Data and Its Application to the Human Microbiome</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>e1002358</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002358" xlink:type="simple">10.1371/journal.pcbi.1002358</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Kelley1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kelley</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Delcher</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Pop</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2012</year>) <article-title>Gene prediction with Glimmer for metagenomic sequences augmented by classification and clustering</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>e9</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1067" xlink:type="simple">10.1093/nar/gkr1067</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Li1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Fu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Niu</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Wooley</surname><given-names>J</given-names></name> (<year>2012</year>) <article-title>Ultrafast clustering algorithms for metagenomic sequence analysis</article-title>. <source>Brief Bioinform</source> <volume>13</volume>: <fpage>656</fpage>–<lpage>668</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bib/bbs035" xlink:type="simple">10.1093/bib/bbs035</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Sharon1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sharon</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Morowitz</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Thomas</surname><given-names>BC</given-names></name>, <name name-style="western"><surname>Costello</surname><given-names>EK</given-names></name>, <name name-style="western"><surname>Relman</surname><given-names>DA</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Time series community genomics analysis reveals rapid shifts in bacterial species, strains, and phage during infant gut colonization</article-title>. <source>Genome Res</source> <volume>23</volume>: <fpage>111</fpage>–<lpage>120</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.142315.112" xlink:type="simple">10.1101/gr.142315.112</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Albertsen1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Albertsen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Skarshewski</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Nielsen</surname><given-names>KL</given-names></name>, <name name-style="western"><surname>Tyson</surname><given-names>GW</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Genome sequences of rare, uncultured bacteria obtained by differential coverage binning of multiple metagenomes</article-title>. <source>Nat Biotechnol</source> <volume>31</volume>. <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2579" xlink:type="simple">10.1038/nbt.2579</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Liu1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Pop</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>MetaPath: identifying differentially abundant metabolic pathways in metagenomic datasets</article-title>. <source>BMC Proc</source> <volume>5</volume> <supplement>Suppl 2</supplement>: <fpage>S9</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1753-6561-5-S2-S9" xlink:type="simple">10.1186/1753-6561-5-S2-S9</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Meth1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Methé</surname><given-names>BA</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>KE</given-names></name>, <name name-style="western"><surname>Pop</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Creasy</surname><given-names>HH</given-names></name>, <name name-style="western"><surname>Giglio</surname><given-names>MG</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>A framework for human microbiome research</article-title>. <source>Nature</source> <volume>486</volume>: <fpage>215</fpage>–<lpage>221</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11209" xlink:type="simple">10.1038/nature11209</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Segata1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segata</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Waldron</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ballarini</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Narasimhan</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Jousson</surname><given-names>O</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Metagenomic microbial community profiling using unique clade-specific marker genes</article-title>. <source>Nat Methods</source>: <fpage>1</fpage>–<lpage>7</lpage>. <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2066" xlink:type="simple">10.1038/nmeth.2066</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Sunagawa1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sunagawa</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Mende</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Zeller</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Izquierdo-Carrasco</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Berger</surname><given-names>SA</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Metagenomic species profiling using universal phylogenetic marker genes</article-title>. <source>Nat Methods</source>. <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2693" xlink:type="simple">10.1038/nmeth.2693</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Wu2"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Jospin</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Eisen</surname><given-names>JA</given-names></name> (<year>2013</year>) <article-title>Systematic identification of gene families for use as “markers” for phylogenetic and phylogeny-driven ecological studies of bacteria and archaea and their major subgroups</article-title>. <source>PLoS One</source> <volume>8</volume>: <fpage>e77033</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0077033" xlink:type="simple">10.1371/journal.pone.0077033</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Wright1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wright</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Mewis</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Hanson</surname><given-names>NW</given-names></name>, <name name-style="western"><surname>Konwar</surname><given-names>KM</given-names></name>, <name name-style="western"><surname>Maas</surname><given-names>KR</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Genomic properties of Marine Group A bacteria indicate a role in the marine sulfur cycle</article-title>. <source>ISME J</source> <fpage>1</fpage>–<lpage>14</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ismej.2013.152" xlink:type="simple">10.1038/ismej.2013.152</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Huson1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huson</surname><given-names>DH</given-names></name>, <name name-style="western"><surname>Mitra</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ruscheweyh</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Weber</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Schuster</surname><given-names>SC</given-names></name> (<year>2011</year>) <article-title>Integrative analysis of environmental sequences using MEGAN4</article-title>. <source>Genome Res</source> <volume>21</volume>: <fpage>1552</fpage>–<lpage>1560</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.120618.111" xlink:type="simple">10.1101/gr.120618.111</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Meyer1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Paarmann</surname><given-names>D</given-names></name>, <name name-style="western"><surname>D'Souza</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Olson</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Glass</surname><given-names>EM</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>The metagenomics RAST server - a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>. <source>BMC Bioinformatics</source> <volume>9</volume>: <fpage>386</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-9-386" xlink:type="simple">10.1186/1471-2105-9-386</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Markowitz1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Markowitz</surname><given-names>VM</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>IA</given-names></name>, <name name-style="western"><surname>Chu</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Szeto</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Palaniappan</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>IMG/M: the integrated metagenome data management and comparative analysis system</article-title>. <volume>40</volume>: <fpage>123</fpage>–<lpage>129</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr975" xlink:type="simple">10.1093/nar/gkr975</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Carr1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carr</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Shen-Orr</surname><given-names>SS</given-names></name>, <name name-style="western"><surname>Borenstein</surname><given-names>E</given-names></name> (<year>2013</year>) <article-title>Reconstructing the genomic content of microbiome taxa through shotgun metagenomic deconvolution</article-title>. <source>PLoS Comput Biol</source> <volume>9</volume>: <fpage>e1003292</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003292" xlink:type="simple">10.1371/journal.pcbi.1003292</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Zhang1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Doak</surname><given-names>TG</given-names></name>, <name name-style="western"><surname>Ye</surname><given-names>Y</given-names></name> (<year>2012</year>) <article-title>Artificial functional difference between microbial communities caused by length difference of sequencing reads</article-title>. <source>Pac Symp Biocomput</source>: <fpage>259</fpage>–<lpage>270</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105776-Li2"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp324" xlink:type="simple">10.1093/bioinformatics/btp324</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Gevers1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gevers</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pop</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Schloss</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Huttenhower</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>Bioinformatics for the Human Microbiome Project</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>e1002779</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002779" xlink:type="simple">10.1371/journal.pcbi.1002779</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Kultima1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kultima</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Sunagawa</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>MOCAT: a metagenomics assembly and gene prediction toolkit</article-title>. <source>PLoS One</source> <volume>7</volume>: <fpage>e47656</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0047656" xlink:type="simple">10.1371/journal.pone.0047656</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Treangen1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Treangen</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Koren</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sommer</surname><given-names>DD</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Astrovskaya</surname><given-names>I</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>MetAMOS: a modular and open source metagenomic assembly and analysis pipeline</article-title>. <source>Genome Biol</source> <volume>14</volume>: <fpage>R2</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2013-14-1-r2" xlink:type="simple">10.1186/gb-2013-14-1-r2</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Greenblum2"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greenblum</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Chiu</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Levy</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Carr</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Borenstein</surname><given-names>E</given-names></name> (<year>2013</year>) <article-title>Towards a predictive systems-level model of the human microbiome: progress, challenges, and opportunities</article-title>. <source>Curr Opin Biotechnol</source> <volume>24</volume>: <fpage>810</fpage>–<lpage>820</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.copbio.2013.04.001" xlink:type="simple">10.1016/j.copbio.2013.04.001</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Wommack1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wommack</surname><given-names>KE</given-names></name>, <name name-style="western"><surname>Bhavsar</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ravel</surname><given-names>J</given-names></name> (<year>2008</year>) <article-title>Metagenomics: read length matters</article-title>. <source>Appl Environ Microbiol</source> <volume>74</volume>: <fpage>1453</fpage>–<lpage>1463</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/AEM.02181-07" xlink:type="simple">10.1128/AEM.02181-07</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Gabaldn1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gabaldón</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Koonin</surname><given-names>EV</given-names></name> (<year>2013</year>) <article-title>Functional and evolutionary implications of gene orthology</article-title>. <source>Nat Rev Genet</source> <volume>14</volume>: <fpage>360</fpage>–<lpage>366</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg3456" xlink:type="simple">10.1038/nrg3456</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Langmead1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Langmead</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2012</year>) <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source> <volume>9</volume>: <fpage>357</fpage>–<lpage>359</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1923" xlink:type="simple">10.1038/nmeth.1923</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Davis1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Davis</surname><given-names>C</given-names></name> (<year>2013</year>) <article-title>mBLAST: Keeping up with the Sequencing Explosion for (Meta) Genome Analysis</article-title>. <source>J Data Mining Genomics Proteomics</source> <volume>04</volume>. <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4172/2153-0602.1000135" xlink:type="simple">10.4172/2153-0602.1000135</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Oehmen1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oehmen</surname><given-names>CS</given-names></name>, <name name-style="western"><surname>Baxter</surname><given-names>DJ</given-names></name> (<year>2013</year>) <article-title>ScalaBLAST 2.0: rapid and robust BLAST calculations on multiprocessor systems</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>797</fpage>–<lpage>798</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt013" xlink:type="simple">10.1093/bioinformatics/btt013</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Wu3"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Mavromatis</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Pukall</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Dalin</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>A phylogeny-driven genomic encyclopaedia of Bacteria and Archaea</article-title>. <source>Nature</source> <volume>462</volume>: <fpage>1056</fpage>–<lpage>1060</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08656" xlink:type="simple">10.1038/nature08656</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Rinke1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rinke</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Schwientek</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Sczyrba</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ivanova</surname><given-names>NN</given-names></name>, <name name-style="western"><surname>Anderson</surname><given-names>IJ</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Insights into the phylogeny and coding potential of microbial dark matter</article-title>. <source>Nature</source> <volume>499</volume>: <fpage>431</fpage>–<lpage>437</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12352" xlink:type="simple">10.1038/nature12352</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Punta1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Punta</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Coggill</surname><given-names>PC</given-names></name>, <name name-style="western"><surname>Eberhardt</surname><given-names>RY</given-names></name>, <name name-style="western"><surname>Mistry</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Tate</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>D290</fpage>–<lpage>301</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1065" xlink:type="simple">10.1093/nar/gkr1065</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Kircher1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kircher</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Stenzel</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Kelso</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>Improved base calling for the Illumina Genome Analyzer using machine learning strategies</article-title>. <source>Genome Biol</source> <volume>10</volume>: <fpage>R83</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2009-10-8-r83" xlink:type="simple">10.1186/gb-2009-10-8-r83</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Ciccarelli1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ciccarelli</surname><given-names>FD</given-names></name>, <name name-style="western"><surname>Doerks</surname><given-names>T</given-names></name>, <name name-style="western"><surname>von Mering</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Creevey</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Snel</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Toward automatic reconstruction of a highly resolved tree of life</article-title>. <source>Science</source> <volume>311</volume>: <fpage>1283</fpage>–<lpage>1287</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1123061" xlink:type="simple">10.1126/science.1123061</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Wootton1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wootton</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Federhen</surname><given-names>S</given-names></name> (<year>1996</year>) <article-title>Analysis of compositionally biased regions in sequence databases</article-title>. <source>Methods Enzymol</source> <volume>266</volume>: <fpage>554</fpage>–<lpage>571</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105776-Levy1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levy</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Borenstein</surname><given-names>E</given-names></name> (<year>2013</year>) <article-title>Metabolic modeling of species interaction in the human microbiome elucidates community-level assembly rules</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>110</volume>: <fpage>12804</fpage>–<lpage>12809</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1300926110" xlink:type="simple">10.1073/pnas.1300926110</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Zaneveld1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zaneveld</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Lozupone</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Gordon</surname><given-names>JI</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Ribosomal RNA diversity predicts genome diversity in gut bacteria and their relatives</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>: <fpage>3869</fpage>–<lpage>3879</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkq066" xlink:type="simple">10.1093/nar/gkq066</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Markowitz2"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Markowitz</surname><given-names>VM</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>IMA</given-names></name>, <name name-style="western"><surname>Palaniappan</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Chu</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Szeto</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>IMG: the Integrated Microbial Genomes database and comparative analysis system</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>D115</fpage>–<lpage>22</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1044" xlink:type="simple">10.1093/nar/gkr1044</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Caporaso1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Caporaso</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Bittinger</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Bushman</surname><given-names>FD</given-names></name>, <name name-style="western"><surname>DeSantis</surname><given-names>TZ</given-names></name>, <name name-style="western"><surname>Andersen</surname><given-names>GL</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>PyNAST: a flexible tool for aligning sequences to a template alignment</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>266</fpage>–<lpage>267</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp636" xlink:type="simple">10.1093/bioinformatics/btp636</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0105776-Evans1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Evans</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Sheneman</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Foster</surname><given-names>J</given-names></name> (<year>2006</year>) <article-title>Relaxed neighbor joining: a fast distance-based phylogenetic tree construction method</article-title>. <source>J Mol Evol</source> <volume>62</volume>: <fpage>785</fpage>–<lpage>792</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00239-005-0176-2" xlink:type="simple">10.1007/s00239-005-0176-2</ext-link></comment></mixed-citation>
</ref>
</ref-list></back>
</article>