<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-14-22244</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0116121</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Heat-Passing Framework for Robust Interpretation of Data in Networks</article-title>
<alt-title alt-title-type="running-head">Heat-Passing Framework for Robust Interpretation of Data in Networks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Fang</surname> <given-names>Yi</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Sun</surname> <given-names>Mengtian</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ramani</surname> <given-names>Karthik</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Electrical and Computer Engineering, New York University Abu Dhabi, Abu Dhabi, UAE</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>School of Mechanical Engineering, Purdue University, West Lafayette, Indiana, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Oliva</surname> <given-names>Baldo</given-names></name>
<role>Academic Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Universitat Pompeu Fabra, Barcelona Research Park of Biomedicine (PRBB), SPAIN</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: YF MS. Performed the experiments: YF. Analyzed the data: YF. Contributed reagents/materials/analysis tools: YF. Wrote the paper: YF KR.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">yfang@nyu.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>10</day>
<month>2</month>
<year>2015</year>
</pub-date>
<volume>10</volume>
<issue>2</issue>
<elocation-id>e0116121</elocation-id>
<history>
<date date-type="received">
<day>19</day>
<month>5</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>4</day>
<month>12</month>
<year>2014</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Fang et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0116121" xlink:type="simple"/>
<abstract>
<p>Researchers are regularly interested in interpreting the multipartite structure of data entities according to their functional relationships. Data is often heterogeneous with intricately hidden inner structure. With limited prior knowledge, researchers are likely to confront the problem of transforming this data into knowledge. We develop a new framework, called <italic>heat-passing</italic>, which exploits intrinsic similarity relationships within noisy and incomplete raw data, and constructs a meaningful map of the data. The proposed framework is able to rank, cluster, and visualize the data all at once. The novelty of this framework is derived from an analogy between the process of data interpretation and that of heat transfer, in which all data points contribute simultaneously and globally to reveal intrinsic similarities between regions of data, meaningful coordinates for embedding the data, and exemplar data points that lie at optimal positions for heat transfer. We demonstrate the effectiveness of the heat-passing framework for robustly partitioning the complex networks, analyzing the globin family of proteins and determining conformational states of macromolecules in the presence of high levels of noise. The results indicate that the methodology is able to reveal functionally consistent relationships in a robust fashion with no reference to prior knowledge. The heat-passing framework is very general and has the potential for applications to a broad range of research fields, for example, biological networks, social networks and semantic analysis of documents.</p>
</abstract>
<funding-group>
<funding-statement>The authors would like to thank the Institute for Pure &amp; Applied Mathematics for providing fellowship to support KR’s visit. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="20"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>Data are available from the following sources: Zachary Karate Club Data (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://konect.uni-koblenz.de/networks/ucidata-zachary">http://konect.uni-koblenz.de/networks/ucidata-zachary</ext-link>); Globin Protein Sequence (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="ftp://selab.janelia.org/pub/software/hmmer/2.2g/">ftp://selab.janelia.org/pub/software/hmmer/2.2g/</ext-link>); pairseqsim (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.bioconductor.org/packages/bioc/1.8/html/pairseqsim.html">http://www.bioconductor.org/packages/bioc/1.8/html/pairseqsim.html</ext-link>); Ribosome Map: Our 3-D density maps of the two distinct ribosome states are provided by Sjors H W Scheres. Requests to access this data can be made by contacting Dr. Scheres (<email xlink:type="simple">scheres@mrc-lmb.cam.ac.uk</email>). (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www2.mrc-lmb.cam.ac.uk/groups/scheres/">http://www2.mrc-lmb.cam.ac.uk/groups/scheres/</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Advances in information technologies coupled with new data generation sources have resulted in the production of data at an unprecedented scale from sources as diverse as social networks, web pages, protein sequences and multimedia images. Given the lack of sufficient prior knowledge about the data, it is often challenging for people to infer a clear picture of the internal mechanism through which regions of the data set interact meaningfully with each other. An effective way of interpreting data is to place all of the data in a network and to study the behavior of the network system governed by agreement among all individual interactions. The measured behavior can now robustly reflect the hidden structure behind the network [<xref ref-type="bibr" rid="pone.0116121.ref001">1</xref>, <xref ref-type="bibr" rid="pone.0116121.ref002">2</xref>]. The advantage of placing data in a network has been highlighted by the commercial success of Google, attributed to the elegant algorithm PageRank, which exploits global structure of cyber network from the local hyper-link of the web-page [<xref ref-type="bibr" rid="pone.0116121.ref003">3</xref>]. PageRank characterizes the behavior of the web-pages’ network through a probability distribution of the resulting random walk mapped onto the network. The innovation of PageRank has inspired data mining procedures for scientists in biological and social science, for example, protein ranking and community structure detection [<xref ref-type="bibr" rid="pone.0116121.ref001">1</xref>, <xref ref-type="bibr" rid="pone.0116121.ref004">4</xref>]. Practically, the superiority of structure-based approaches arises from the process of propagating the local similarity to global information that redefines the similarity among any data pair [<xref ref-type="bibr" rid="pone.0116121.ref005">5</xref>, <xref ref-type="bibr" rid="pone.0116121.ref006">6</xref>]. That is, after propagation of local similarity, the relationship among the data points is redefined according to the re-organization of all of the data points simultaneously. This map retains a great deal of important information, provides a concise picture of the interactions within the data, and highlights underlying intrinsic structures of the data set.</p>
<p>In this paper, we emphasize the advantage gained by exploiting the global intrinsic structure behind the data as encoded in the <italic>geometric heat flow</italic> on the network, and develop the method to interpret the revealed structure. We assume that all of the data can be properly embedded in a manifold where the original local interactions (distance or similarity) are approximately preserved [<xref ref-type="bibr" rid="pone.0116121.ref007">7</xref>]. We then use heat flow as a proxy for information flow over the network. The advantage thereby is that heat is sensitive to the geometric structure of the data, and its flow over the network intrinsically takes all local infinitesimal interactions of a system into account [<xref ref-type="bibr" rid="pone.0116121.ref008">8</xref>, <xref ref-type="bibr" rid="pone.0116121.ref009">9</xref>]. In short, our point of view is that to understand the network, we need to understand the system behavior of the network reflected by the flow of heat on it. The <italic>global</italic> rate of heat transfer across the entire network depends on the points of application of heat. This observation allows us to identify a number of nodes with high overall tendency to transfer heat to all other points in an efficient manner. This identification is carried out through an analogy between heat passing and <italic>message passing</italic>, and ensures the global optimal determination of the nodes of application of heat, which we call heat centers [<xref ref-type="bibr" rid="pone.0116121.ref010">10</xref>, <xref ref-type="bibr" rid="pone.0116121.ref011">11</xref>]. Using the framework we developed, we demonstrate that the heat-passing is able to complete the tasks of data ranking, visualizing, and clustering in our heat featured space all at once (refer to the section ‘Method’ below).</p>
<p>The key contribution of the proposed method is the development of a heat-passing framework which efficiently interprets the noisy raw data in a robust manner. There is no need to specify the number of clusters for the data and the heat passing process is driven by a set of proposed definitions (heat center, heat sink, heat absorption and emission, and average temperature). <xref ref-type="fig" rid="pone.0116121.g001">Fig. 1</xref> conveys a conceptual idea of the heat-passing framework. <xref ref-type="fig" rid="pone.0116121.g001">Fig. 1(A)</xref> indicates that heat is distributed throughout the network with various degrees of efficiency depending on where the heat source is applied. The average temperature (indicated on the top of each figure) of all of the nodes quantitatively reflects the efficiency of heat flowing across the network. We want to determine the optimal nodes (heat centers) that achieve an efficient flow of heat across the whole network <xref ref-type="fig" rid="pone.0116121.g001">Fig. 1(A)(6)</xref>. The heat-passing process, illustrated in <xref ref-type="fig" rid="pone.0116121.g001">Fig. 1(B)</xref>, demonstrates the procedure of finding the heat centers and their corresponding heat sinks. We will discuss the process below.</p>
<fig id="pone.0116121.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116121.g001</object-id>
<label>Figure 1</label>
<caption>
<title>Illustration of heat flow and heat passing.</title>
<p>Heat-passing framework is to understand the system behavior of a network reflected by the flow of heat over it. This figure illustrates the heat flow across the network by applying the heat source on different nodes in (A) and the message exchange of heat passing process in (B). In (A), there are six figures displaying the temperature distribution after heat flows for a certain time with application of the heat source on six different nodes. The normalized temperature is listed on the top of each figure. The average temperature is used to initialize the clustering center preference value <italic>hcpv</italic>. The higher the temperature the faster the heat flows on the network. In (B), two figure show the message exchange process. The first figure shows the process of heat sink sending absorption message to candidate heat center. The second figure shows the process of heat center sending emission message to heat sink. <italic>ha</italic> denotes heat absorption message and <italic>he</italic> denotes heat emission message.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116121.g001"/>
</fig>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>Heat-passing framework is to understand the system behavior of a network reflected by the flow of heat over it. Since heat flows through all possible flowing paths between two nodes in a network, if a node has a number of paths to other nodes, the heat flows faster and aggregates rapidly across the network. Consequently, the average temperature is higher when the heat is applied at nodes with a large number of paths to the other nodes, as indicated in <xref ref-type="fig" rid="pone.0116121.g001">Fig. 1(A)(6)</xref>. The heat passing process aims to optimally identify those nodes, which we call heat centers, through which the heat flow over the network is most efficient. We view packets of heat as refined geometric messages allowing us to efficiently describe paths that are constrained by the intrinsic structure of the network [<xref ref-type="bibr" rid="pone.0116121.ref009">9</xref>]. The strength of the heat message viewpoint is derived from its efficient encoding into the <italic>heat kernel</italic> that accounts simultaneously for all ‘dynamic packets of evidence’ coming from the exchange of heat between <italic>all</italic> pairs of points on the network [<xref ref-type="bibr" rid="pone.0116121.ref012">12</xref>, <xref ref-type="bibr" rid="pone.0116121.ref013">13</xref>]. For example, the authors in [<xref ref-type="bibr" rid="pone.0116121.ref013">13</xref>] found that heat-diffusion based functional distances among protein domains closely correlate with sequence alignment, structural proximity and phylogenetic similarity. Our proposed framework includes two parts: the definition of the heat flow information on the network and the heat-passing process for the determination of heat centers that facilitate global flow.</p>
<sec id="sec002a">
<title>Heat flow on the network</title>
<p>We assume the data can be embedded in a manifold and that the data points are connected by weighted edges that reflect the geometry of this manifold. The heat flow on the manifold can then be quantitatively approximated by the heat kernel <italic>H</italic><sub>t</sub>(<italic>i</italic>,<italic>j</italic>), normally viewed as a function of two points <italic>i</italic>,<italic>j</italic> on the network at any given time <italic>t</italic>. The physical interpretation of this quantity arises from the application of a unit amount of heat at the node <italic>i</italic>, which is then allowed to flow along the edges. The rate of diffusion over any one of the edges is determined by its weight. The value of the heat kernel <italic>H</italic><sub>t</sub>(<italic>i</italic>,<italic>j</italic>) is the amount of heat accumulated at <italic>j</italic> after time <italic>t</italic>. The heat kernel is sensitive to the structure of the network as it collects heat based information about all the possible paths between two nodes on the network. The heat will flow faster when applied to a node with many paths to other nodes on the network. We approximate the heat kernel of the manifold using the eigenfunction expansion described below [<xref ref-type="bibr" rid="pone.0116121.ref008">8</xref>, <xref ref-type="bibr" rid="pone.0116121.ref009">9</xref>]. The network under study is denoted as a graph <italic>G</italic> = (<italic>V,E,W</italic>), where <italic>V</italic> is the set of notes, <italic>E</italic> is a set of edges, and <italic>W</italic> is the weight matrix, so that <italic>W<sub>ij</sub></italic> is the weight of the edge connecting node <italic>i</italic> and node <italic>j</italic>. Here, we assume that there are no loops in the network, so that <italic>W<sub>ii</sub></italic> = 0 for each <italic>i</italic>. The graph Laplacian is defined as follows:
<disp-formula id="pone.0116121.e001">
<alternatives>
<graphic id="pone.0116121.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e001"/>
<mml:math id="M1" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>L</mml:mi>
<mml:mo>=</mml:mo>
<mml:mi>D</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>W</mml:mi>
</mml:mrow>
</mml:math></alternatives>
<label>(1)</label>
</disp-formula>
where <italic>D</italic> is a diagonal degree matrix and its diagonal entries are given by the summation of rows of <italic>W</italic>:
<disp-formula id="pone.0116121.e002">
<alternatives>
<graphic id="pone.0116121.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e002"/>
<mml:math id="M2" display="block" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo><mml:mstyle displaystyle="true">
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mi>j</mml:mi>
</mml:munder>
</mml:mstyle><mml:msub>
<mml:mi>W</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
The normalized Laplacian of the graph is defined by
<disp-formula id="pone.0116121.e003">
<alternatives>
<graphic id="pone.0116121.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e003"/>
<mml:math id="M3" display="block" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>L</mml:mi>
<mml:mi>N</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo><mml:msup>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow>
</mml:msup>
<mml:mi>L</mml:mi><mml:msup>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></alternatives>
<label>(3)</label>
</disp-formula>
Then the heat kernel can be defined by
<disp-formula id="pone.0116121.e004">
<alternatives>
<graphic id="pone.0116121.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e004"/>
<mml:math id="M4" display="block" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover>
<mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow>
<mml:mrow>
<mml:mo>∣</mml:mo><mml:mi>V</mml:mi><mml:mo>∣</mml:mo></mml:mrow>
</mml:munderover>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:mrow>
<mml:mo>−</mml:mo><mml:msub>
<mml:mi>λ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mi>t</mml:mi></mml:mrow>
</mml:msup>
<mml:msub>
<mml:mi>ϕ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub>
<mml:mi>ϕ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
where <italic>λ<sub>k</sub></italic> is the <italic>k<sub>th</sub></italic> eigenvalue of the Laplacian and <italic>ϕ<sub>k</sub></italic> is the <italic>k<sub>th</sub></italic> normalized eigenfunction. The eigenvalues are ordered so that
<disp-formula id="pone.0116121.e005">
<alternatives>
<graphic id="pone.0116121.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e005"/>
<mml:math id="M5" display="block" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>λ</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>≤</mml:mo>
<mml:msub>
<mml:mi>λ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>≤</mml:mo>
<mml:mo>⋯</mml:mo>
<mml:mo>≤</mml:mo>
<mml:msub>
<mml:mi>λ</mml:mi>
<mml:mrow>
<mml:mo>∣</mml:mo>
<mml:mi>V</mml:mi>
<mml:mo>∣</mml:mo>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
and we pick an eigenvector for each eigenvalue. If the eigenvalue has geometric multiplicity one, the eigenfunction will be well-defined up to a scalar. The normalization of the eigenfunctions here refers to a choice of constants so that
<disp-formula id="pone.0116121.e006">
<alternatives>
<graphic id="pone.0116121.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e006"/>
<mml:math id="M6" display="block" overflow="scroll">
<mml:mrow>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mi>i</mml:mi>
</mml:munder>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mo>∣</mml:mo>
<mml:msub>
<mml:mi>ϕ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>∣</mml:mo>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
The quantity <italic>H</italic><sub>t</sub>(<italic>i</italic>,<italic>j</italic>), the <italic>heat affinity</italic> between the pair of points <italic>i</italic> and <italic>j</italic>, is a measure of heat transfer between the two points after time <italic>t</italic>. We observe the symmetry:
<disp-formula id="pone.0116121.e007">
<alternatives>
<graphic id="pone.0116121.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e007"/>
<mml:math id="M7" display="block" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>j</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>=</mml:mo><mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>j</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo><mml:mn>,</mml:mn></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
reflecting the symmetry of the Laplacian, whereby the eigenvalues are guaranteed to be real and endowed with a complete basis of eigenvectors.</p>
<p>The average temperature of the whole network when heat is applied on the node <italic>i</italic>, reflects the average amount of heat received by the nodes other than <italic>i</italic> after time <italic>t</italic>. The larger the value, the faster the heat dissipates across the network. The average temperature naturally evaluates the influence of a node, which means, how important the node is among all of the nodes in the network. We therefore use the average temperature to naturally initialize the clustering center preference value of a node (see section 2.2 for details).</p>
<disp-formula id="pone.0116121.e008">
<alternatives>
<graphic id="pone.0116121.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e008"/>
<mml:math id="M8" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>T</mml:mi>
<mml:mi>e</mml:mi>
<mml:mi>m</mml:mi>
<mml:msub>
<mml:mi>p</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mstyle displaystyle="true">
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>j</mml:mi>
<mml:mo>≠</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:munder>
</mml:mstyle>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>j</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(7)</label>
</disp-formula>
<p>The heat kernel measures the heat affinity between any pair of nodes on the network, which, in turn, reflects how heat flows across the network over time when starting from any initial distribution of heat. The efficiency of heat diffusing over the network depends on the nodes the heat is applied to. We are interested in globally locating the optimal nodes of application of heat to achieve the most efficient heat flow. The optimization problem can be viewed as searching over configurations of the labels g = (g<sub>1</sub>,…,g<sub><italic>N</italic></sub>) so as to minimize the energy <inline-formula id="pone.0116121.e009"><alternatives><graphic id="pone.0116121.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e009"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow>
<mml:mi>E</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>g</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>g</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives></inline-formula>. It is more convenient to think of maximizing the net similarity, which is the negative energy [<xref ref-type="bibr" rid="pone.0116121.ref010">10</xref>].
<disp-formula id="pone.0116121.e010">
<alternatives>
<graphic id="pone.0116121.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e010"/>
<mml:math id="M10" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>g</mml:mi>
<mml:mo>=</mml:mo>
<mml:munder>
<mml:mi mathvariant="italic">argmax</mml:mi>
<mml:mi>g</mml:mi>
</mml:munder>
<mml:mo>(</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>g</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>)</mml:mo>
<mml:mo>−</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
<mml:mi>χ</mml:mi>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>g</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>)</mml:mo>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(8)</label>
</disp-formula>
where <italic>N</italic> is total number of points, <italic>t</italic> denotes a specific time scale and <italic>g<sub>i</sub></italic> denotes the label for point <italic>i</italic>. The first term is the summary of the heat affinity within each cluster and the second term is introduced to make sure that if a node is voted as an exemplar by other nodes, it has to be its own exemplar. The <italic>χ</italic>(g<sub><italic>i</italic></sub>) is set to ∞ if node g<sub><italic>i</italic></sub> does not select itself as its own exemplar and 0 otherwise [<xref ref-type="bibr" rid="pone.0116121.ref014">14</xref>]. Note that, a trivial solution for this optimization problem is that every node selects itself as its own exemplar. To avoid this trivial solution, an addition input cost is introduced while making a point into an exemplar [<xref ref-type="bibr" rid="pone.0116121.ref014">14</xref>, <xref ref-type="bibr" rid="pone.0116121.ref015">15</xref>]. The heat center preference value explained below is one of solution to avoid the trivial solution as suggested in [<xref ref-type="bibr" rid="pone.0116121.ref014">14</xref>].</p>
<p>As shown in [<xref ref-type="bibr" rid="pone.0116121.ref010">10</xref>], an optimization problem of this kind can be solved by the message-passing algorithm. We adapt this algorithm to solve <xref ref-type="disp-formula" rid="pone.0116121.e008">Equation 8</xref>. Beyond solving this optimization problem, we develop a number of other physics based concepts associated with heat flow over network. We describe these principles within a heat-passing framework below.</p>
<p>The calculation of the exact heat kernel is computationally expensive as calculating the entire spectral decomposition of the normalized Laplacian <italic>L</italic> has complexity <italic>O(n<sup>3</sup>)</italic> using QR algorithm. This can be reduced to <italic>O(n<sup>2</sup>)</italic> as graphs are generally locally connected and hence sparse using the more efficient Lanczos method [<xref ref-type="bibr" rid="pone.0116121.ref016">16</xref>]. The complexity can be further reduced to <italic>O(kn)</italic> by trading off accuracy and calculating only the first (smallest) <inline-formula id="pone.0116121.e011"><alternatives><graphic id="pone.0116121.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e011"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>≪</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> eigenvectors and eigenvalues and approximating the summand in <xref ref-type="disp-formula" rid="pone.0116121.e004">Equation 4</xref> using these values. The error bound is (generally) linear in 1/<italic>k</italic> as larger eigenvalues correspond to local frequencies or oscillations (intra-cluster) giving little information about community structure or data relationship (inter-cluster) [<xref ref-type="bibr" rid="pone.0116121.ref017">17</xref>]. However, we perform the spectral decomposition only once and exponentially re-weight the eigenvalues in the summand for any value of the time parameter <italic>t</italic>.</p>
</sec>
<sec id="sec002b">
<title>Heat passing process</title>
<p>As mentioned, the heat passing process aims to seek out the optimal heat centers and corresponding heat sinks by which the heat diffusion over the network is most efficient. The whole process is driven by the heat flow message without requiring any prior knowledge about the data. Even the number of optimal heat centers is revealed as a <italic>result</italic> of the heat-passing procedure. Two message packets are defined for the heat-passing procedure (see <xref ref-type="fig" rid="pone.0116121.g001">Fig. 1</xref>): heat emission <italic>he</italic>(<italic>s,c</italic>) and heat absorption <italic>ha</italic>(<italic>s,c</italic>). The heat emission message <italic>he</italic>(<italic>s,c</italic>), sent from candidate heat center <italic>c</italic> to its potential heat sink <italic>s</italic>, reflects how well the center <italic>c</italic> transmits heat to sink <italic>s</italic> by taking into account the support from the other sinks of the <italic>c</italic>. The heat absorption message <italic>ha</italic>(<italic>s,c</italic>), sent from the potential heat sink <italic>s</italic> to heat center <italic>c</italic>, reflects how well the sink <italic>s</italic> absorbs the heat from the center <italic>c</italic> by comparing it to the heat absorbed from other competing heat centers.</p>
<p>We can initialize each node with a heat center preference value <italic>hcpv</italic>, reflecting how well the node prefers itself to be a heat center. The heat center preference value plays an important role in the initialization of the heat passing process for the determination of heat centers. We use the average temperature, defined in <xref ref-type="disp-formula" rid="pone.0116121.e007">Equation 7</xref>, as the heat center preference value of a node. This is because the higher the average temperature, the more the node emits heat to other nodes, therefore, the better it prefers to be the heat center.</p>
<p>We initialize the heat emissions to zero: <italic>he</italic><sub>0</sub> (<italic>s,c</italic>) = 0 because every node is treated equally at the begin. The heat absorption for each node is initialized as follows:
<disp-formula id="pone.0116121.e012">
<alternatives>
<graphic id="pone.0116121.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e012"/>
<mml:math id="M12" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>h</mml:mi>
<mml:msub>
<mml:mi>a</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>≔</mml:mo>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi mathvariant="italic">max</mml:mi>
<mml:mrow>
<mml:msup>
<mml:mi>c</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
<mml:mo>≠</mml:mo>
<mml:mi>c</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:msup>
<mml:mi>c</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
<mml:mo>)</mml:mo>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(9)</label>
</disp-formula>
After the first calculation, we iterate the process and modify the heat absorption.
<disp-formula id="pone.0116121.e013">
<alternatives>
<graphic id="pone.0116121.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e013"/>
<mml:math id="M13" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>≔</mml:mo>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi mathvariant="italic">max</mml:mi>
<mml:mrow>
<mml:msup>
<mml:mi>c</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
<mml:mo>≠</mml:mo>
<mml:mi>c</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>h</mml:mi>
<mml:mi>e</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:msup>
<mml:mi>c</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
<mml:mo>)</mml:mo>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:msup>
<mml:mi>c</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
<mml:mo>)</mml:mo>
<mml:mo>)</mml:mo>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(10)</label>
</disp-formula>
where the heat emission <italic>he</italic>(<italic>s,c)</italic> of <italic>c</italic> with respect to <italic>s</italic> is defined iteratively by
<disp-formula id="pone.0116121.e014">
<alternatives>
<graphic id="pone.0116121.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e014"/>
<mml:math id="M14" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>h</mml:mi>
<mml:mi>e</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>≔</mml:mo>
<mml:mi mathvariant="italic">min</mml:mi>
<mml:mrow>
<mml:mo stretchy="true">{</mml:mo>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>+</mml:mo>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mi>s</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
<mml:mo>∉</mml:mo>
<mml:mo>{</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>}</mml:mo>
</mml:mrow>
</mml:munder>
<mml:mi mathvariant="italic">max</mml:mi>
<mml:mo>{</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>}</mml:mo>
</mml:mrow>
<mml:mo stretchy="true">}</mml:mo>
</mml:mrow>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(11)</label>
</disp-formula>
The self-heat absorption <italic>ha</italic>(<italic>c,c</italic>) is set to the heat center preference <italic>hcpv</italic> minus the largest heat affinity between the node <italic>c</italic> and all other candidate heat centers. In addition, the self-heat emission <italic>he</italic>(<italic>c,c</italic>) is defined iteratively by
<disp-formula id="pone.0116121.e015">
<alternatives>
<graphic id="pone.0116121.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e015"/>
<mml:math id="M15" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>h</mml:mi>
<mml:mi>e</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>c</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>:</mml:mo>
<mml:mo>=</mml:mo>
<mml:mstyle displaystyle="true">
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>≠</mml:mo>
<mml:mi>c</mml:mi>
</mml:mrow>
</mml:munder>
</mml:mstyle>
<mml:mi>m</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>x</mml:mi>
<mml:mo>{</mml:mo>
<mml:mn>0,</mml:mn>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>}</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(12)</label>
</disp-formula>
During the iteration, the heat emission and absorption is dynamically updated to reflect the accumulated evidence for a node be a heat center as well as the evidence for a node be the heat sink for some other specific heat center. In later iterations, according the definition above, the self-heat absorption for some nodes can become negative, which means those nodes would prefer to receive the heat from another node rather than themselves. Consequently, as described in <xref ref-type="disp-formula" rid="pone.0116121.e011">Equation 11</xref>, the heat emission <italic>he</italic>(<italic>s,c</italic>) for some nodes will drop below zero when they are assigned to the other heat centers. Therefore, those nodes will lose the competition to be a heat center as only the maximum heat emission is considered for competing, as described in <xref ref-type="disp-formula" rid="pone.0116121.e010">Equation 10</xref>.</p>
<p>The normalized heat transfer coefficient <italic>ht</italic>(<italic>s,c</italic>) is then defined at each stage by
<disp-formula id="pone.0116121.e016">
<alternatives>
<graphic id="pone.0116121.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e016"/>
<mml:math id="M16" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>h</mml:mi>
<mml:mi>t</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>≔</mml:mo>
<mml:mi>h</mml:mi>
<mml:mi>e</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>+</mml:mo>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(13)</label>
</disp-formula>
For any node <italic>c</italic>, its heat sinks set <italic>S<sub>c</sub></italic> is defined by
<disp-formula id="pone.0116121.e017">
<alternatives>
<graphic id="pone.0116121.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e017"/>
<mml:math id="M17" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>∈</mml:mo>
<mml:msub>
<mml:mi>S</mml:mi>
<mml:mi>c</mml:mi>
</mml:msub>
<mml:mo>⇔</mml:mo>
<mml:mi>h</mml:mi>
<mml:mi>t</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi mathvariant="italic">max</mml:mi>
<mml:mi>z</mml:mi>
</mml:msub>
<mml:mi>h</mml:mi>
<mml:mi>t</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(14)</label>
</disp-formula>
We say the <italic>c</italic> is a heat center for the sink <italic>s</italic> if <inline-formula id="pone.0116121.e018"><alternatives><graphic id="pone.0116121.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e018"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The iteration process stops after a fixed number of iterations or after the changes in the messages falls below a threshold.</p>
<p>In general, the heat passing process includes two alternative processes (see <xref ref-type="fig" rid="pone.0116121.g001">Fig. 1(B(1)) and 1(B(2))</xref>): the heat sink searching for its appropriate heat center and the heat center searching for its appropriate heat sinks. The first process is initialized by a heat sink to show how it thinks the candidate heat center is the optimal one after comparing the candidate heat center to all other possible heat centers. The heat absorption message sent from the sink to the candidate indicates how well the sink absorbs the heat from the candidate heat center by comparing it to the heat absorbed from the other competing heat centers. The second process is initialized by the candidate center to show how suitable it is as a center for the heat sink after collecting the supporting evidence from its other heat sinks. The heat emission message sent from the heat center to the sink indicates how well the center sends the heat to the sink by taking into account the support from the other sinks of this center. These two processes iteratively determine the optimal heat centers and corresponding sink sets. This is enabled by maximizing normalized heat transfer coefficient (<xref ref-type="disp-formula" rid="pone.0116121.e013">Equation 13</xref>) when each pair of heat center and sink are optimally matched. Note that, the optimum heat center may not align well with the average center of nodes because 1) heat-passing clusters the nodes based their connectivity which might not consistent with average center determined by compactness, 2) the optimum heat centers have to be actual nodes picked up from the data members while the average central nodes dose not necessarily lie on the actual nodes.</p>
</sec>
<sec id="sec002c">
<title>Data interpretations revealed by heat-passing</title>
<p>Bringing raw data to the stage of meaningful interpretation involves at least three main tasks: ranking, visualizing, and clustering data. We will show that the heat-passing framework can complete those three tasks for all data at once. We define the heat distance, heat coordinates and heat centers and sinks with respect to ranking, visualizing and clustering.</p>
<sec id="sec002ca">
<title>1. Heat distance</title>
<p>The heat distance can be defined from the heat kernel <xref ref-type="disp-formula" rid="pone.0116121.e004">Equation 4</xref> as follows [<xref ref-type="bibr" rid="pone.0116121.ref013">13</xref>]:
<disp-formula id="pone.0116121.e019">
<alternatives>
<graphic id="pone.0116121.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e019"/>
<mml:math id="M19" display="block" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>j</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mn>2</mml:mn>
<mml:mo>*</mml:mo>
</mml:msup>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(15)</label>
</disp-formula>
Given a query data, we can rank the data points according their heat distance to the query. If we pre-compute heat distance, one can efficiently search the database for a given query.</p>
</sec>
<sec id="sec002cb">
<title>2. Heat coordinate</title>
<p>The heat coordinate can also be derived from the heat kernel as follows:
<disp-formula id="pone.0116121.e020">
<alternatives>
<graphic id="pone.0116121.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e020"/>
<mml:math id="M20" display="block" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi mathvariant="italic">Cor</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>λ</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mi>t</mml:mi>
<mml:mo>∕</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msub>
<mml:mi>ϕ</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>,</mml:mo>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>λ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mi>t</mml:mi>
<mml:mo>∕</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msub>
<mml:mi>ϕ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>,</mml:mo>
<mml:mi>…</mml:mi>
<mml:mo>,</mml:mo>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>λ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mi>t</mml:mi>
<mml:mo>∕</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msub>
<mml:mi>ϕ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(16)</label>
</disp-formula>
Here, <italic>λ<sub>k</sub></italic> is the <italic>k<sub>th</sub></italic> eigenvalue of the Laplacian and <italic>ϕ<sub>k</sub></italic> is the <italic>k</italic>-th normalized eigenfunction. The heat coordinate is defined on a space of dimension <italic>k</italic> (less than the number of the data points). Typically, the <italic>i</italic>-th coordinate will decay faster than the <italic>j</italic>-th coordinate when <italic>i&gt;j</italic>, so that a choice of <italic>k</italic> corresponds to the retainment of <italic>k</italic> significant terms in the heat coordinates.</p>
</sec>
<sec id="sec002cc">
<title>3. Heat center and sink</title>
<p>As mentioned already, the data-driven heat-passing procedure reveals optimal heat centers together with their corresponding regions of influence consisting of optimal heat sinks for each heat center. One gets thereby, a natural partition of the nodes into different clusters with the heat centers becoming the cluster centers and the corresponding heat sinks the cluster members. In a precise form, for each heat center <italic>hc</italic>, its region cluster <italic>S<sub>hc</sub></italic> is defined by
<disp-formula id="pone.0116121.e021">
<alternatives>
<graphic id="pone.0116121.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e021"/>
<mml:math id="M21" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>x</mml:mi>
<mml:mo>∈</mml:mo>
<mml:msub>
<mml:mi>S</mml:mi>
<mml:mrow>
<mml:mi>h</mml:mi>
<mml:mi>c</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>⇔</mml:mo>
<mml:mi>h</mml:mi>
<mml:mi>t</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>h</mml:mi>
<mml:mi>c</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi mathvariant="italic">max</mml:mi>
<mml:mi>z</mml:mi>
</mml:msub>
<mml:mi>h</mml:mi>
<mml:mi>t</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math></alternatives>
<label>(17)</label>
</disp-formula>
where <italic>z</italic> denotes competing heat centers and <italic>ht</italic>(<italic>x,hc</italic>) denotes the normalized heat transfer coefficient between <italic>x</italic> and <italic>hc</italic>.</p>
</sec>
</sec>
<sec id="sec002d">
<title>Performance index</title>
<p>We define three performance indices, accuracy index (AI), rand index (RI) and quality index (QI), to evaluate the performance of our method [<xref ref-type="bibr" rid="pone.0116121.ref018">18</xref>]. The index values are normalized to [0, 1]. The larger the value, the better the performance is. The first two indices are used to evaluate the accuracy of the corrected assignment. The third index is used to evaluate the quality of the cluster assignment in terms of the compactness of the intra-clusters and spareness of the inter-clusters.</p>
<sec id="sec002da">
<title>1. Accuracy index and Rand index</title>
<p>The accuracy index is simply calculated as the ratio of the number of images with a correctly assigned class and the total number of images. A more advanced index for accuracy evaluation is rand index which evaluates the match between system-generated clusters to the ground truth. If C is the number of correct match and I is the number of incorrect match, RI is defined as:
<disp-formula id="pone.0116121.e022">
<alternatives>
<graphic id="pone.0116121.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e022"/>
<mml:math id="M22" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>R</mml:mi>
<mml:mi>I</mml:mi>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mi>C</mml:mi>
<mml:mrow>
<mml:mi>C</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>I</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math></alternatives>
<label>(18)</label>
</disp-formula>
Generally, we compare all pairs of data after clustering. We consider a pair to be a correctly matched pair if the pair of data is in the same cluster in both the ground truth and the system-generated clustering, or if they are in different clusters in both the ground truth clustering and the system-generated clustering. We consider all other cases to be incorrect match. The value of RI falls in the range of [0, 1]. The data perfectly matches the ground truth if RI is 1.</p>
</sec>
<sec id="sec002db">
<title>2. Quality index</title>
<p>The widely-used silhouette index is chosen as quality index evaluate the quality of the cluster assignment in this work. <xref ref-type="disp-formula" rid="pone.0116121.e019">Equation 19</xref> shows the formula for computing the silhouette value.</p>
<disp-formula id="pone.0116121.e023">
<alternatives>
<graphic id="pone.0116121.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e023"/>
<mml:math id="M23" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>Q</mml:mi>
<mml:mi>I</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>K</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mrow>
</mml:munderover>
<mml:mfrac>
<mml:mrow>
<mml:mi>b</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>−</mml:mo>
<mml:mi>a</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi mathvariant="italic">max</mml:mi>
<mml:mo>{</mml:mo>
<mml:mi>a</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>,</mml:mo>
<mml:mi>b</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>}</mml:mo>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math></alternatives>
<label>(19)</label>
</disp-formula>
<p>where, <italic>QI</italic>(<italic>K</italic>) denotes value for the clustering with <italic>K</italic> clusters, <italic>N<sub>k</sub></italic> denotes the total number of samples, i denotes the <italic>ith</italic> sample, <italic>a</italic>(<italic>i</italic>) denotes the average similarity of sample i to all other samples in the same cluster, and <italic>b</italic>(<italic>i</italic>) is the minimum value of the set of all the average similarity scores from sample i to all other clusters. The range of <italic>QI</italic> value is from −1 to 1, with 1 representing perfect clustering, 0 representing random clustering, and −1 representing perfect anti-clustering. A QI value greater than 0.5 indicates a good clustering, and less than 0.2 indicates a lack of substantial cluster structure. Note that we normalize the QI to the range [0, 1] in our experiment.</p>
</sec>
</sec>
</sec>
<sec id="sec003" sec-type="results">
<title>Results</title>
<p>In this section, we have carried out several sets of experiments in partitioning complex network into a small number of clusters, clustering, ranking and visualizing the Globin protein family into biological meaningful subfamilies and determining the conformational states of macromolecules in the presence of a high level of noise. Our experience for setting time parameter is that a range of small diffusion time provides a high resolution view of the network and is thus suitable for analysis. In experimental tests below, we set time parameter <italic>t</italic> of 4 and max iteration of 20000 for heat passing process.</p>
<sec id="sec003a">
<title>Community Structure Detection</title>
<p>Recently, we have seen an exponential growth of networks in social science, economics, and communication with the advancement in technology. It is of great interest to develop approaches to reduce the complexity for better understanding the networks. These needs have resulted in research efforts such as partitioning the large network into a number of small subnetworks. However, many challenges remain in automatically partitioning the network with communities overlapping and large portions of missing and spurious links [<xref ref-type="bibr" rid="pone.0116121.ref019">19</xref>–<xref ref-type="bibr" rid="pone.0116121.ref021">21</xref>]. In this experiment, we will demonstrate the heat-passing is able to solve the detections of the community structure in a robust manner without depending on any prior knowledge about the network, including the number of the communities.</p>
<p>We test a well known network about a karate club, which is constructed by Wayne Zachary after his observation of social interactions among members of a karate club at an American university [<xref ref-type="bibr" rid="pone.0116121.ref022">22</xref>]. The club was split into two smaller clubs because of a conflict over the price of karate lessons that arose between the club’s president and main teacher. The two smaller clubs are then headed by the president and main teacher, who are denoted by node 34 and 1, respectively in <xref ref-type="fig" rid="pone.0116121.g002">Fig. 2</xref>. The original network is used as the input to heat passing framework. <xref ref-type="fig" rid="pone.0116121.g002">Fig. 2</xref> shows the partition result. There are two groups revealed by our method (members belong to the president’s club are highlighted by orange circle and members belong to the teacher’s club are highlighted by green circles, as shown in the Figure). Two heat centers are located by our method (person number 34 and 1), which matches the leadership in the actual karate social network. We partition the club into two groups: G1 = {1: 8, 11: 14, 17, 18, 20, 22} and G2 = {9, 10, 15, 16, 19, 21, 23:34}, where 11: 14 denotes the integers in the range of [<xref ref-type="bibr" rid="pone.0116121.ref011">11</xref>, <xref ref-type="bibr" rid="pone.0116121.ref014">14</xref>] and 23: 34 denotes the integers in the range of [<xref ref-type="bibr" rid="pone.0116121.ref023">23</xref>, <xref ref-type="bibr" rid="pone.0116121.ref034">34</xref>]. The partition result by our method is consistent with actual observation by Zachary except for the member number 9. In addition, we color the each node according to the average temperature value (see definition in <xref ref-type="disp-formula" rid="pone.0116121.e007">Equation 7</xref>). The closer the color is to red, the higher the value of the average temperature, therefore, the larger the value of the heat center preference value of a node. We can clearly observe that node 34 and 1 are very close to the red end.</p>
<fig id="pone.0116121.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116121.g002</object-id>
<label>Figure 2</label>
<caption>
<title>Community structure detection in Zachary’s karate club network.</title>
<p>Two clusters are revealed by our method. The nodes circled in orange belong to one faction, and the nodes circled in green belong to another one. The color of a node indicates the average temperature of the node. The closer the color is to red, the higher the average temperature, therefore the better the node prefers to be heat center. The closer the color is to blue, the lower the average temperature, therefore the better the node prefers to be heat sink. A color bar is displayed on the right side. We obtained G 1 = {1: 8, 10: 14, 17, 18, 20, 22} and G2 = {9, 15, 16, 19, 21, 23: 34}.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116121.g002"/>
</fig>
<p>It is of interest to further investigate the case of member number 9. As stated in [<xref ref-type="bibr" rid="pone.0116121.ref022">22</xref>], member number 9 is a supporter of the president but becomes a member of the teacher’s club after the fission. This is because that he has to join the teacher’s faction for the black belt (master status). However, structurally it is clear that he should be classified as member of president’s faction. It is an overriding interest that leads to his factional affiliation to teacher’s club after the split. Therefore, the classification result by our method is consistent with the actual social structure of the karate network based on the interactions among members. In a recent study [<xref ref-type="bibr" rid="pone.0116121.ref021">21</xref>], the authors propose an efficient method with application to the partition of members in the karate club. Although they demonstrate an impressive partition, the classification of two members (9 and 10) is not consistent with the actual observation by Zachary. We think the case member 9 can be explained by the similar reason above. For the case of member 10, we think it is because the person 10 has connections to members in both factions. However, our heat passing framework captures his/her preference to president’s faction based on the intrinsic relationship to other members. For comparison, we run original affinity prorogation on karate network. We found that AP identified three groups of nodes with cluster centers of 1, 34, and 32. This is inconsistent with actual observations.</p>
</sec>
<sec id="sec003b">
<title>Clustering, ranking and visualizing Globin protein family</title>
<p>Clustering, ranking, and visualizing proteins based on their sequence or structural similarity are useful in assisting biologist to infer the functions of un-annotated proteins [<xref ref-type="bibr" rid="pone.0116121.ref004">4</xref>, <xref ref-type="bibr" rid="pone.0116121.ref023">23</xref>]. Given query sequence, searching databases of protein sequences or DNA for evolutionary or functional relationships are of great interests for biologists. The classification of a large number of proteins into biological meaningful subgroups would speed up the database searches and improve the inference of protein function. The visualization of protein in a Euclidean space would provide graphical view of the proteins in a relative position, which greatly free biologist’s focus on data process but the analysis. We will show how the heat-passing is able to cluster,rank, visualize the proteins at once.</p>
<p>We demonstrated the feasibility of heat passing approach in the context of analysis of the globin proteins family, which contains a large family of heme-containing proteins functioned in binding and/or transportation of oxygen. We used a number 519 (out of 630) globin sequences released with HMMER2 software package [<xref ref-type="bibr" rid="pone.0116121.ref024">24</xref>, <xref ref-type="bibr" rid="pone.0116121.ref025">25</xref>]. The selection includes four types of chains, a number of 235 <italic>α</italic>-globin (HBA) subfamilies, 197 <italic>β</italic>-globin (HBB) subfamilies, 17 Leghemoglobin (LGB) subfamilies and 70 Myoglobin (MYG) subfamilies according to the SwissProt database annotation [<xref ref-type="bibr" rid="pone.0116121.ref026">26</xref>]. The BIOCONDUCTOR package PAIRSEQSIM is used to compute the distance matrix among the all pairs of proteins (519*519) [<xref ref-type="bibr" rid="pone.0116121.ref027">27</xref>]. We show the testing result in terms of clustering, ranking, and visualizing in the <xref ref-type="fig" rid="pone.0116121.g003">Fig. 3</xref>. The clustering performance is evaluated by the AI, RI and QI, which are 1.00, 1.00 and 0.74 respectively. Heat-passing reveals four subfamilies with a perfect classification according to the performance index. We then show the protein ranking by specificity-sensitivity curve according to the heat distance defined by heat-passing. We find that heat-passing performs exceptionally well on the ranking and searching according to the specificity-sensitivity curve. Furthermore, the figure displays a visualization of the sequence space of 519 globin proteins. For illustration purposes, we only choose the first three heat coordinates for each proteins. The 3D representation is quite informative and provides a clear picture about the relationship among the proteins. Four classes of the globin family are visually distinguishable based on the heat coordinate of each protein in the embedded space.</p>
<fig id="pone.0116121.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116121.g003</object-id>
<label>Figure 3</label>
<caption>
<title>Test for clustering, ranking and clustering globin protein.</title>
<p>Figure displays test result for the analysis of globin proteins. The 519 proteins from globin family are plotted in the 3D Euclidean space according to their heat coordinate <italic>Cor<sup>t</sup></italic>. Different clusters are colored differently: Blue points are <italic>α</italic>-globin protein, purple points are <italic>β</italic>-globin protein, black points are leghemoglobins and green points are myoglobins. The performance index for clustering are listed on the bottom left with RI and AI being 1.00 and QI being 0.74. The specificity-sensitivity curve on the bottom right is used to evaluate the performance ranking and searching based on the heat distance. The PDBID for three proteins used to display 3D structure are 1FSX (<italic>α</italic>-globin and <italic>β</italic>-globin), 1B1N (leghemoglobins), 2MM1 (Myoglobins).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116121.g003"/>
</fig>
<p>It is interesting to further investigate the distribution of the proteins in the embedded space. The outliers of each cluster is of interest because it normally reflects the function difference from the proteins in the main cluster. We first observe that a group of myoglobins (highlighted by red dashed circle) are slightly away from the rest of the myoglobin cluster. We mapped those proteins back to the original sequence file and find that they are all fish proteins: MYG-CYPCA (COMMON CARP), MYG-GALAU (SHARK), MYG-GALJA (SHARK), MYG-HETPO (PORT JACKSON SHARK), MYG-MUSAN (GUMMY SHARK), MYG-THUAL (YELLOWFIN TUNA). The positioning of the protein in the embedded sapce is encouraging because the fish myoglobins are experimentally observed with different structures from the mammalian myoglobins [<xref ref-type="bibr" rid="pone.0116121.ref028">28</xref>]. Positioning the proteins with heat coordinates, we can easily view the structural distinction based on the protein sequence. In addition, we have the observations for other two globins cluters: <italic>α</italic>-globin cluster (HBA) and <italic>β</italic>-globin cluster (HBB) (all highlighted by red dashed circle), for example, HBAM-RANCA and HBB-HETPO. We therefore predict that those globins might be structurally different from the rest of the cluster. We leave the biological verification of this predication in our future work. The group of leghemoglobins is very tightly centered together which is consistent with the observation in [<xref ref-type="bibr" rid="pone.0116121.ref024">24</xref>]. With the only input of protein sequence similarity input, heat-passing clearly interprets the proteins of globin family. We can easily tell the structural and functional relationship within a subfamily and across different types of subfamilies through the global picture about the data.</p>
<p>One critical parameter for the heat passing that has not been fully discussed in the experiment is the heat dissipation time <italic>t</italic>. The time parameter <italic>t</italic> is important as it essentially reflects the resolution of the network. The larger the time, the more globally the structure is exploited. While we understand that there is no unique value of time that best describes the network, based on the experiments, heat passing prefers to a range of small diffusion time provides a high resolution view of the network and is thus suitable for analysis of underlying structure of a network. In this test, we select the time <italic>t</italic> from 2 to 10. The clustering performance can be found in the <xref ref-type="fig" rid="pone.0116121.g004">Fig. 4</xref>. As we can see from the table, the clustering performance is consistently good with a wide range of time <italic>t</italic>.</p>
<fig id="pone.0116121.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116121.g004</object-id>
<label>Figure 4</label>
<caption>
<title>Clustering of globin protein data at different time parameter.</title>
<p>Table shows the clustering performance of heat passing with different time parameter from 2 to 10.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116121.g004"/>
</fig>
<p>In addition, for comparison we run original affinity prorogation on globin protein network, we found that AP identified 22 groups of proteins while the correct number is 4. The <italic>AI</italic> and <italic>RI</italic> for AP are 0.47 and 0.78 respectively, which are lower compared to heat passing (<italic>AI</italic>:1.00 and <italic>RI</italic>:1.00).</p>
</sec>
<sec id="sec003c">
<title>Macromolecular heterogeneity</title>
<p>Conformational heterogeneity presents a significant challenge in determination of high resolution 3-D structure using single particle cryo-EM [<xref ref-type="bibr" rid="pone.0116121.ref029">29</xref>–<xref ref-type="bibr" rid="pone.0116121.ref031">31</xref>]. The structural heterogeneity, stemming from either varying compositions or varying conformations, will lead to a combination of a mixture of images from particles a different structure and result in a smeared or even incorrect reconstruction, if not taken into account. A noise-robust (the image is extremely noisy), assumption-free (the number of the conformational states is unknown) clustering approach would pose a clear advantage over the existing methods. In this test, each projection image is a node in the network and the the similarity between a pair of images is assigned to the edge weight. The similarity between a pair of projection images is computed based on Fourier slice theorem [<xref ref-type="bibr" rid="pone.0116121.ref032">32</xref>, <xref ref-type="bibr" rid="pone.0116121.ref033">33</xref>]. We firstly introduce the details about how to compute the similarity between projections image and build the network for the images, and then how the heat-passing method solve this challenging problem below.</p>
<p><bold>Similarity calculation among the projections images</bold>. According to the Fourier Central Section theorem, the 2-D Fourier transform of a projection image is equal to a slice through the origin of the 3-D Fourier transform of the corresponding 3-D object. Therefore, the Fourier transforms of every pair of projection images from the same object have an intersection line (common line) <xref ref-type="fig" rid="pone.0116121.g005">Fig. 5</xref>. The Fourier values along the common line from those pairs of projection images should be identical. Since the views of the images are not known, we first compute the similarity scores between all line pairs (at a given angular sampling step size) of two images and then set at the best similarity score. At a given level of noises and discretization errors, the higher the similarity score is, the greater is the probability that two images are from particles of the same conformation. The steps for computing the similarity between a pair of images are summarized as follows:</p>
<list list-type="order">
<list-item>
<p>Compute the Polar Fourier Transform (PF) of each image using a constant angular sampling (In this study, we used 1.8 degrees which results in 200 lines for each image).</p>
</list-item>
<list-item>
<p>Compute the similarity scores for all line-to-line pairs between the two images (In this study, we obtain 200 x 200 scores for a pair of images).</p>
</list-item>
<list-item>
<p>Choose the largest similarity score to be the distance between two images. The similarity is computed as follows:
<disp-formula id="pone.0116121.e024">
<alternatives>
<graphic id="pone.0116121.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e024"/>
<mml:math id="M24" display="block" overflow="scroll">
<mml:mrow>
<mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow>
<mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mi>N</mml:mi>
</mml:mfrac>
<mml:mo>|</mml:mo><mml:msup>
<mml:mo>∑</mml:mo>
<mml:mtext>​</mml:mtext>
</mml:msup>
<mml:mover accent="true">
<mml:mrow>
<mml:msub>
<mml:mi>F</mml:mi>
<mml:mi>A</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mo stretchy="true">→</mml:mo>
</mml:mover>
<mml:mrow><mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true">
<mml:mrow>
<mml:msub>
<mml:mi>F</mml:mi>
<mml:mi>B</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mo stretchy="true">→</mml:mo>
</mml:mover>
<mml:mrow><mml:mo>(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>)</mml:mo>
<mml:mo>|</mml:mo></mml:mrow>
</mml:mrow>
</mml:math>
</alternatives>
<label>(20)</label>
</disp-formula>
Where <italic>D</italic>(<italic>A</italic>,<italic>B</italic>) denotes the distance between the common lines from image <italic>A</italic> and image <italic>B</italic>, <italic>N</italic> denotes the number of the sample points along the common line, and <inline-formula id="pone.0116121.e025"><alternatives><graphic id="pone.0116121.e025g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e025"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0116121.e026"><alternatives><graphic id="pone.0116121.e026g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116121.e026"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denote the Fourier value for <italic>ith</italic> sample point on the common lines from image <italic>A</italic> and <italic>B</italic> respectively.</p>
</list-item>
</list>
<fig id="pone.0116121.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116121.g005</object-id>
<label>Figure 5</label>
<caption>
<title>Illustration for Fourier slice theorem.</title>
<p>Figure illustrates the Fourier slice theorem about computing the common line between two projection images.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116121.g005"/>
</fig>
<p><bold>Test on ribosome data with conformational states</bold>. Test on ribosome data with two conformational states, The 70S E. coli ribosome in the process of translation is a well-known system with heterogeneous conformations in the solution. The subtle structural differences among the different conformations pose a great challenge in determining the number of states and accurately classifying the particles into appropriate states. In our experiments, the 3-D density maps of the two distinct ribosome states (<xref ref-type="fig" rid="pone.0116121.g006">Fig. 6(A)</xref>) are provided by Sjors H W Scheres [<xref ref-type="bibr" rid="pone.0116121.ref034">34</xref>]. The projection images are simulated by projecting the ribosome structures at random views, corrupted by zero-mean Gaussian noises at different levels, and then randomly shift the center of the images (up to %6 of image size). <xref ref-type="fig" rid="pone.0116121.g006">Fig. 6(B)</xref> illustrates the the projection images of two ribosome molecules with noise (SNR = 0.1). When SNR is at 0.1 or lower, the ribosome particles are barely visible, and the visual contrasts of these images are similar to or lower than typical single particle cryo-EM images. We performed the clustering experiment with two distinct ribosome states (states I and II). The first conformation (I) is in un-ratcheted state with three bound tRNAs at the A, P, E sites but without bound elongation factor G (EF-G). The second conformation (II) is in a ratcheted state with bound EF-G and a single tRNA in the hybrid P/E position. The structural difference between these two states, mainly caused by the ratcheting of a 30S subunit relative to the 50S subunit and by the bound tRNAs and EF-G, are recognizable in the surface views of the established structures (<xref ref-type="fig" rid="pone.0116121.g006">Fig. 6(A)</xref>). Four hundred projection images (130x130 pixels) at random views were generated for each of the two ribosome conformations. Noise was then added to the projection images to obtain test image datasets at multiple SNRs (range from 0.05 to 5). The distance score for all image pairs, including images from the same conformational state and from different states, is first computed. The histograms for intra-class and inter-class distance scores is significantly overlapped when SNR is low (0.1 for example <xref ref-type="fig" rid="pone.0116121.g006">Fig. 6(C)</xref>), which indicates there is a significant overlapping between two clusters of images. As expected, the clustering became more challenging at low SNRs.</p>
<fig id="pone.0116121.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116121.g006</object-id>
<label>Figure 6</label>
<caption>
<title>Illustration for two ribosome conformational states, projection images and distance histogram.</title>
<p>Figure(A) shows the 3D structure of two 70S ribosome conformation states: the unratcheted state in complex with three tRNAs (orange, green, red) and the ratcheted state in complex with one tRNA (blue) and EF-G (purple). (B) The mixture of the projection images from two states at SNR = 0.1. (C) The histogram of the common line based pair-wise distances for intra-class (red) and inter-class (blue). The distance for images across different classes is larger but significantly overlapped with intra-class distance because of the existence of noise.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116121.g006"/>
</fig>
<p>In addition, the common line measurement is historically sensitive to noise. We demonstrate that the common line position error and the total percentage of corrected measured common lines. The correct positions (ground truth) for the common lines are calculated based on the projection angles. The common line position errors are calculated according to the difference between ground truth positions and the measured positions under different SNR values. An average line position error was calculated for all pairs of images for each SNR level. When the signal is strong, the error should be nearly zero. However, the line position error is expected to reach 90 degrees if the noise level is too high and the measured line positions approach random positions. Similarly, we also recorded the percentage of the correct (error less than 5 degree) common line positions for each noise level. The results were displayed in <xref ref-type="fig" rid="pone.0116121.g007">Fig. 7</xref>. As expected, the common line position errors become smaller and the percentage of correctly identified common lines increase as SNR increases.</p>
<fig id="pone.0116121.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116121.g007</object-id>
<label>Figure 7</label>
<caption>
<title>Illustration for common line angle offset.</title>
<p>The degree of common line offset reflects the error angle between the detected common line and the real common line because of the noise. Figure plots the common line angle offset and percentage of correctly detected common lines at different SNR levels. As we expect, the value of the degree is decreasing and the percentage is increasing with respect to the increasing value of SNR.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116121.g007"/>
</fig>
<p>The clustering results on these test images are shown in <xref ref-type="fig" rid="pone.0116121.g008">Fig. 8</xref>. In this test, the optimal number of classes (i.e. conformations) (K = 2) is correctly determined even when the SNR decreases to 0.05. Three performance index for different levels of noise are plotted in <xref ref-type="fig" rid="pone.0116121.g008">Fig. 8(A)</xref>. As expected, the performance index increases with the increasing SNR. Importantly, the clustering maintains a perfect accuracy and rand index at SNR as low as 0.2, a noise level at which the image contrast is comparable to that of actual cryo-EM images. When SNR is at 0.2, our method is able to accurately classify 99% percent of images even in the presence of such overwhelming level of noises. The clustering accuracy drops as SNR decreases but remains reasonable (AI = 0.75 and RI = 0.63) even when SNR reaches 0.05. With SNR equal to 0.05, one can hardly recognize the existence of a ribosome particle in the image box, and the image contrast at this SNR level is probably worse than that of most real cryo-EM images. The <xref ref-type="fig" rid="pone.0116121.g008">Fig. 8(B)</xref> displays that two revealed images (boxed in red and blue colors respectively) for heat centers which link to their own images for sinks (images are displayed at SNR = 0.20). These results demonstrate that our method is very robust to high noise levels. Since the similarities among images are computed based on Fourier Central Section Theorem, a measurement that only uses a small fraction of the image data (i.e. a line in a 2-D plane) and is known to be sensitive to noises [<xref ref-type="bibr" rid="pone.0116121.ref032">32</xref>], these results are very exciting in a sense that a well documented issue can be partially overcome by our heat-passing framework. Furthermore, according to <xref ref-type="fig" rid="pone.0116121.g008">Fig. 8(A)</xref>, comparing the SNR dependence of QI, AI and RI, we find that QI is positively correlated to increased AI and RI. This observation suggests that QI can be used in evaluating the confidence level of the clustering result. This is critical in practice for real cryo-EM projects since neither the actual number of classes nor the correct class member assignment is known.</p>
<fig id="pone.0116121.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116121.g008</object-id>
<label>Figure 8</label>
<caption>
<title>Performance evaluation for ribosome test.</title>
<p>Figure (A) shows the performance index for all of the raw images being classified into two clusters. On the top of the figure are the projection images at corresponding noise levels. The plot illustrates the value of AI, RI and QI with respect to the increasing value of SNR. Figure(B) displays two images (boxed in red and blue colors) for the heat centers and their own images for heat sinks at SNR = 0.2.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116121.g008"/>
</fig>
<p>As heat passing is derived from affinity propagation based on heat kernel, we compared their performance for clustering ribosome images from two conformational states. We used the same image data sets above for affinity propagation. In <xref ref-type="fig" rid="pone.0116121.g009">Fig. 9</xref>, we can find that Affinity propagation consistently performs worse than heat passing with lower values of AI and RI. Another interesting observation is that the AI for affinity propagation is very low with the value under 0.3 even when SNR increases to 0.5. And the AI is close to 1.0 for heat passing when SNR is near to 0.2. This can be explained by the fact that Affinity propagation is not able to identify the correct number of clusters. The identified clusters number is 15, 7, 8, 9, 13, 14 for the SNR from 0.05 to 0.5. Since the AI is sensitive to the ground truth label, it stays low for all of the tests. In contrast, the heat passing is able to identify the correct number of the clusters and both AI and RI remain higher for all of SNR values.</p>
<fig id="pone.0116121.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116121.g009</object-id>
<label>Figure 9</label>
<caption>
<title>Evaluation of affinity propagation in ribosome test.</title>
<p>Figure shows the performance index for all of the raw images being classified into two clusters. The plot illustrates the value of AI and RI with respect to the increasing value of SNR.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116121.g009"/>
</fig>
</sec>
</sec>
<sec id="sec004" sec-type="conclusions">
<title>Discussion</title>
<p>The abundance of newly-measured data from various disciplines, such as social networks, the internet, biological networks, experimental measurements, and multimedia, has shifted scientists’ attention from data collection to data analysis. Despite the broad success of current approaches for data analysis, heterogeneity, incompleteness, measurement error, and inherent noise are sources of concern challenging any claim of complete data interpretation. In the previous sections, we have described a new heat-passing framework for exploiting the intrinsic similarity relationship behind a network of noisy and incomplete raw data that maps the network out in a robust manner. We discuss the features of the heat-passing framework and our contributions as follows:</p>
<sec id="sec004a">
<title>Heat-passing provides a robust, global and structure-based method for data interpretation</title>
<p>A good data analysis approach should be robust to noise, as the observed data, especially biological data, is often noisy and heterogeneous with a low coverage of the whole system. Any approach, if simply based on individual local pairs of data or a small number of neighbors, is likely to be overwhelmed by the noise and incompleteness. It is of great importance to place all of the data in a network and study the behavior of the network system governed by agreement among all individual interactions. The desired effect is to generate and display significant knowledge of the overall global structure of the data. Heat-passing is a type of structure-based approach, with the heat flow encoded as structure-aware information that enables diffusion across the network to reveal the intrinsic relationship among the data points. The excellent robustness against noise is highlighted by its good performance in resolving the conformational states for the macromolecular at noise level (<italic>SNR</italic> = 0.05).</p>
</sec>
<sec id="sec004b">
<title>Heat-passing is independent of prior knowledge about data</title>
<p>In addition to being robust to noise, the dependence on prior knowledge about data is also crucial for a computational data analysis approach. The importance is particularly highlighted when scientists have limited knowledge or none about the data, for example, when a new biological machine is firstly studied. Any prior assumption applied to such data on the basis of previous experimental results or observations, is likely to bias investigation. Given the abundance of instances where only little a priori knowledge about the data is available, we must favor approaches that are independent of prior knowledge, which can provide the insight about the data with little or no human intervention. Heat-passing provides a coherent framework for learning from data and for reasoning about underlying structure without depending on much prior knowledge. For example, rather than requiring the number of heat centers to be pre-specified, heat-passing only takes geometric similarity within the data set as input in order to optimally determine the number and location of heat centers as well as corresponding regions of influence. Even though the method is automatic, the process is able to unearth hidden structure from the statistical regularities of large data sets.</p>
</sec>
<sec id="sec004c">
<title>Limitations and future directions</title>
<p>With rapid advances in measurement technology, almost every type of data is accumulating at a rapid pace, and brings to focus robust and intelligent approaches to data analysis. The opportunity is clear for computational scientists to speed up the development of methodology to meet the needs of this ever-growing data. Our heat-passing framework is inspired by the physical process of heat flow. We have outlined its many appealing features and diverse potential applications. We expect heat-passing to be broadly applicable to various areas of data interpretation, and especially as an approach to complex network analysis. However, this paper presents only a first implementation, with very promising results in the completed tests. One area that particularly calls for more investigation is the heat evolution time. Although it is difficult to choose a proper time parameter, it plays a critical role in looking through the geometric structure at multiple scales. In our future work, we will investigate good strategies to determine time as a means for taking stock of the raw data at different level of details.</p>
</sec>
</sec>
</body>
<back>
<ack>
<p>We would like to thank NYU Abu Dhabi for providing start-up support for Yi Fang for this research. The authors would like to thank Wen Jiang (Purdue University), Minhyong Kim (University of Oxford) and the anonymous reviewers for the helpful suggestions and comments.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0116121.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rosvall</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bergstrom</surname> <given-names>CT</given-names></name> (<year>2008</year>) <article-title>Maps of random walks on complex networks reveal community structure</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>105</volume>: <fpage>1118</fpage>–<lpage>1123</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0706851105" xlink:type="simple">10.1073/pnas.0706851105</ext-link></comment> <object-id pub-id-type="pmid">18216267</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Newman</surname> <given-names>MEJ</given-names></name> (<year>2003</year>) <article-title>The structure and function of complex networks</article-title>. <source>SIAM Review</source> <volume>45</volume>: <fpage>167</fpage>–<lpage>256</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/S003614450342480" xlink:type="simple">10.1137/S003614450342480</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116121.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="other">
<name name-style="western"><surname>Page</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Brin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Motwani</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Winograd</surname> <given-names>T</given-names></name> (<year>1998</year>) <article-title>The pagerank citation ranking: Bringing order to the web</article-title>. <source>Proceedings of the 7th International World Wide Web Conference</source>: <fpage>161</fpage>–<lpage>172</lpage>.</mixed-citation>
</ref>
<ref id="pone.0116121.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Weston</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Elisseeff</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Leslie</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Noble</surname> <given-names>WS</given-names></name> (<year>2004</year>) <article-title>Protein ranking: From local to global structure in the protein similarity network</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>101</volume>: <fpage>6559</fpage>–<lpage>6563</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0308067101" xlink:type="simple">10.1073/pnas.0308067101</ext-link></comment> <object-id pub-id-type="pmid">15087500</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Singer</surname> <given-names>A</given-names></name> (<year>2008</year>) <article-title>A remark on global positioning from local distances</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>105</volume>: <fpage>9507</fpage>–<lpage>9511</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0709842104" xlink:type="simple">10.1073/pnas.0709842104</ext-link></comment> <object-id pub-id-type="pmid">18621694</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Coifman</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lafon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Maggioni</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nadler</surname> <given-names>B</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Geometric diffusions as a tool for harmonic analysis and structure definition of data: Diffusion maps</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>102</volume>: <fpage>7426</fpage>–<lpage>7431</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0500334102" xlink:type="simple">10.1073/pnas.0500334102</ext-link></comment> <object-id pub-id-type="pmid">15899970</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Boguna</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Krioukov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Claffy</surname> <given-names>KC</given-names></name> (<year>2009</year>) <article-title>Navigability of complex networks</article-title>. <source>Nature Physics</source> <volume>5</volume>: <fpage>74</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nphys1130" xlink:type="simple">10.1038/nphys1130</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116121.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bai</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Hancock</surname> <given-names>ER</given-names></name> (<year>2004</year>) <article-title>Heat kernels, manifolds and graph embedding</article-title>. <source>Lecture Notes in Computer Science</source> <volume>3138</volume>: <fpage>198</fpage>–<lpage>206</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-3-540-27868-9_20" xlink:type="simple">10.1007/978-3-540-27868-9_20</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116121.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="other">
<name name-style="western"><surname>Sun</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ovsjanikov</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Guibas</surname> <given-names>L</given-names></name> (<year>2009</year>) <article-title>A concise and provably informative multi-scale signature based on heat diffusion</article-title>. <source>SGP ’09: Proceedings of the Symposium on Geometry Processing</source>: <fpage>1383</fpage>–<lpage>1392</lpage>.</mixed-citation>
</ref>
<ref id="pone.0116121.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Frey</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Dueck</surname> <given-names>D</given-names></name> (<year>2007</year>) <article-title>Clustering by passing messages between data points</article-title>. <source>Science</source> <volume>315</volume>: <fpage>972</fpage>–<lpage>976</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1136800" xlink:type="simple">10.1126/science.1136800</ext-link></comment> <object-id pub-id-type="pmid">17218491</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>T</given-names></name> (<year>2007</year>) <article-title>Adaptive affinity propagation clustering</article-title>. <source>Acta Automatica Sinica</source> <volume>33</volume>: <fpage>242</fpage>–<lpage>1246</lpage>.</mixed-citation>
</ref>
<ref id="pone.0116121.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lafon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>A</given-names></name> (<year>2006</year>) <article-title>Diffusion maps and coarse-graining: A unified framework for dimensionality reduction, graph partitioning, and data set parameterization</article-title>. <source>Ieee Transactions on Pattern Analysis and Machine Intelligence</source> <volume>28</volume>: <fpage>1393</fpage>–<lpage>1403</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TPAMI.2006.184" xlink:type="simple">10.1109/TPAMI.2006.184</ext-link></comment> <object-id pub-id-type="pmid">16929727</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lerman</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Shakhnovich</surname> <given-names>B</given-names></name> (<year>2007</year>) <article-title>Defining functional distance using manifold embeddings of gene ontology annotations</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>104</volume>: <fpage>11334</fpage>–<lpage>11339</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0702965104" xlink:type="simple">10.1073/pnas.0702965104</ext-link></comment> <object-id pub-id-type="pmid">17595300</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="other">
<name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Furtlehner</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sebag</surname> <given-names>M</given-names></name> (<year>2008</year>) <source>Data streaming with affinity propagation</source>: <fpage>628</fpage>–<lpage>643</lpage>.</mixed-citation>
</ref>
<ref id="pone.0116121.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="other">
<name name-style="western"><surname>Givoni</surname> <given-names>IE</given-names></name> (<year>2012</year>) <source>Beyond affinity propagation: Message passing algorithms for clustering</source>. <comment>PhD Thesis</comment>, <publisher-name>University of Toronto</publisher-name>.</mixed-citation>
</ref>
<ref id="pone.0116121.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Qiu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hancock</surname> <given-names>E</given-names></name> (<year>2007</year>) <article-title>Clustering and embedding using commute times</article-title>. <source>Pattern Analysis and Machine Intelligence, IEEE Transcations On</source> <volume>29</volume>: <fpage>1873</fpage>–<lpage>1890</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TPAMI.2007.1103" xlink:type="simple">10.1109/TPAMI.2007.1103</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116121.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lipman</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Rustamov</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Funkhouser</surname> <given-names>TA</given-names></name> (<year>2010</year>) <article-title>Biharmonic distance</article-title>. <source>ACM Trans Graph</source> <volume>29</volume>: <fpage>27:1</fpage>–<lpage>27:11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1145/1805964.1805971" xlink:type="simple">10.1145/1805964.1805971</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116121.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Iyer</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Jayanti</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lou</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kalyanaraman</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ramani</surname> <given-names>K</given-names></name> (<year>2005</year>) <article-title>Three-dimensional shape searching: state-of-the-art review and future trends</article-title>. <source>Computer-Aided Design</source> <volume>37</volume>: <fpage>509</fpage>–<lpage>530</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cad.2004.07.002" xlink:type="simple">10.1016/j.cad.2004.07.002</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116121.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Boccaletti</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Latora</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Moreno</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Chavez</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hwang</surname> <given-names>DU</given-names></name> (<year>2006</year>) <article-title>Complex networks: Structure and dynamics</article-title>. <source>Physics Reports</source> <volume>424</volume>: <fpage>175</fpage>–<lpage>308</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.physrep.2005.10.009" xlink:type="simple">10.1016/j.physrep.2005.10.009</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116121.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Guimera</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sales-Pardo</surname> <given-names>M</given-names></name> (<year>2009</year>) <article-title>Missing and spurious interactions and the reconstruction of complex networks</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>106</volume>: <fpage>22073</fpage>–<lpage>22078</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0908366106" xlink:type="simple">10.1073/pnas.0908366106</ext-link></comment> <object-id pub-id-type="pmid">20018705</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>E</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Vanden-Eijnden</surname> <given-names>E</given-names></name> (<year>2008</year>) <article-title>Optimal partition and effective dynamics of complex networks</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>105</volume>: <fpage>7907</fpage>–<lpage>7912</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0707563105" xlink:type="simple">10.1073/pnas.0707563105</ext-link></comment> <object-id pub-id-type="pmid">18303119</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zachary</surname> <given-names>WW</given-names></name> (<year>1977</year>) <article-title>An information flow model for conflict and fission in small groups</article-title>. <source>Journal of Anthropological Research</source> <volume>33</volume>: pp. <fpage>452</fpage>–<lpage>473</lpage>.</mixed-citation>
</ref>
<ref id="pone.0116121.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Xia</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Paccanaro</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Gerstein</surname> <given-names>M</given-names></name> (<year>2005</year>) <article-title>Assessing the limits of genomic data integration for predicting protein networks</article-title>. <source>Genome Research</source> <volume>15</volume>: <fpage>945</fpage>–<lpage>953</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.3610305" xlink:type="simple">10.1101/gr.3610305</ext-link></comment> <object-id pub-id-type="pmid">15998909</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mian</surname> <given-names>IS</given-names></name>, <name name-style="western"><surname>Sjlander</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Haussler</surname> <given-names>D</given-names></name> (<year>1994</year>) <article-title>Hidden markov models in computational biology: Applications to protein modeling</article-title>. <source>Journal of Molecular Biology</source> <volume>235</volume>: <fpage>1501</fpage>–<lpage>1531</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.1994.1104" xlink:type="simple">10.1006/jmbi.1994.1104</ext-link></comment> <object-id pub-id-type="pmid">8107089</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Eddy</surname> <given-names>S</given-names></name> (<year>1998</year>) <article-title>Profile hidden markov models</article-title>. <source>Bioinformatics</source> <volume>14</volume>: (<fpage>755</fpage>–<lpage>763</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/14.9.755" xlink:type="simple">10.1093/bioinformatics/14.9.755</ext-link></comment> <object-id pub-id-type="pmid">9918945</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gasteiger</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gattiker</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hoogland</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ivanyi</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Appel</surname> <given-names>R</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Expasy: The proteomics server for in-depth protein knowledge and analysis</article-title>. <source>Nucleic Acids Res</source> <volume>31</volume>: <fpage>3784</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkg563" xlink:type="simple">10.1093/nar/gkg563</ext-link></comment> <object-id pub-id-type="pmid">12824418</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="other">
<name name-style="western"><surname>Gentleman</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Carey</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Bates</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Bolstad</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dettling</surname> <given-names>M</given-names></name>, <etal>et al</etal> <collab xlink:type="simple">DMB</collab> (<year>2004</year>) <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>. <source>Genome Biology</source> <fpage>5</fpage>.</mixed-citation>
</ref>
<ref id="pone.0116121.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cashon</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Vayda</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sidell</surname> <given-names>B</given-names></name> (<year>1997</year>) <article-title>Kinetic characterization of myoglobins from vertebrates with vastly different body temperatures—effects on autooxidation and oxygenation</article-title>. <source>Comparative Biochemistry and Physiology</source> <volume>117</volume>: <fpage>613</fpage>–<lpage>620</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0305-0491(97)00011-4" xlink:type="simple">10.1016/S0305-0491(97)00011-4</ext-link></comment> <object-id pub-id-type="pmid">9297803</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Alberts</surname> <given-names>B</given-names></name> (<year>1998</year>) <article-title>The cell as a collection of protein machines: preparing the next generation of molecular biologists</article-title>. <source>Cell</source> <volume>92</volume>: <fpage>291</fpage>–<lpage>294</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0092-8674(00)80922-8" xlink:type="simple">10.1016/S0092-8674(00)80922-8</ext-link></comment> <object-id pub-id-type="pmid">9476889</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Stahlberg</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Walz</surname> <given-names>T</given-names></name> (<year>2008</year>) <article-title>Molecular electron microscopy: State of the art and current challenges</article-title>. <source>ACS Chemical Biology</source> <volume>3</volume>: <fpage>268</fpage>–<lpage>81</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/cb800037d" xlink:type="simple">10.1021/cb800037d</ext-link></comment> <object-id pub-id-type="pmid">18484707</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Leschziner</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nogales</surname> <given-names>E</given-names></name> (<year>2007</year>) <article-title>Visualizing flexibility at molecular resolution: analysis of heterogeneity in single-particle electron microscopy reconstructions</article-title>. <source>Annu Rev Biophys Biomol Struct</source> <volume>36</volume>: <fpage>43</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.biophys.36.040306.132742" xlink:type="simple">10.1146/annurev.biophys.36.040306.132742</ext-link></comment> <object-id pub-id-type="pmid">17201674</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Frank</surname> <given-names>J</given-names></name> (<year>2006</year>) <source>Three-dimensional electron microscopy of macromolecular assemblies: visualization of biological molecules in their native state</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pone.0116121.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Herman</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kalinowski</surname> <given-names>M</given-names></name> (<year>2008</year>) <article-title>Classification of heterogeneous electron microscopic projections into homogeneous subsets</article-title>. <source>Ultramicroscopy</source> <volume>108</volume>: <fpage>327</fpage>–<lpage>38</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ultramic.2007.05.005" xlink:type="simple">10.1016/j.ultramic.2007.05.005</ext-link></comment> <object-id pub-id-type="pmid">17574340</object-id></mixed-citation>
</ref>
<ref id="pone.0116121.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Scheres</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Valle</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Herman</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Eggermont</surname> <given-names>P</given-names></name> (<year>2007</year>) <article-title>Disentangling conformational states of macromolecules in 3d-em through likelihood optimization</article-title>. <source>Nat Methods</source> <volume>4</volume>: <fpage>27</fpage>–<lpage>29</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth992" xlink:type="simple">10.1038/nmeth992</ext-link></comment> <object-id pub-id-type="pmid">17179934</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>