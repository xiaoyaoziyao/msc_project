<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01359</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003429</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Evolutionary modeling</subject><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Phylogenetic Gaussian Process Model for the Inference of Functionally Important Regions in Protein Tertiary Structures</article-title>
<alt-title alt-title-type="running-head">Phylogenetic Gaussian Process Model</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Huang</surname><given-names>Yi-Fei</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Golding</surname><given-names>G. Brian</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><addr-line>Department of Biology, McMaster University, Hamilton, Ontario, Canada</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Kosakovsky Pond</surname><given-names>Sergei L.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of California San Diego, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">golding@mcmaster.ca</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: YFH. Performed the experiments: YFH. Analyzed the data: YFH. Contributed reagents/materials/analysis tools: YFH. Wrote the paper: YFH GBG.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>1</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>16</day><month>1</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>1</issue>
<elocation-id>e1003429</elocation-id>
<history>
<date date-type="received"><day>31</day><month>7</month><year>2013</year></date>
<date date-type="accepted"><day>22</day><month>11</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Huang, Golding</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>A critical question in biology is the identification of functionally important amino acid sites in proteins. Because functionally important sites are under stronger purifying selection, site-specific substitution rates tend to be lower than usual at these sites. A large number of phylogenetic models have been developed to estimate site-specific substitution rates in proteins and the extraordinarily low substitution rates have been used as evidence of function. Most of the existing tools, e.g. Rate4Site, assume that site-specific substitution rates are independent across sites. However, site-specific substitution rates may be strongly correlated in the protein tertiary structure, since functionally important sites tend to be clustered together to form functional patches. We have developed a new model, GP4Rate, which incorporates the Gaussian process model with the standard phylogenetic model to identify slowly evolved regions in protein tertiary structures. GP4Rate uses the Gaussian process to define a nonparametric prior distribution of site-specific substitution rates, which naturally captures the spatial correlation of substitution rates. Simulations suggest that GP4Rate can potentially estimate site-specific substitution rates with a much higher accuracy than Rate4Site and tends to report slowly evolved regions rather than individual sites. In addition, GP4Rate can estimate the strength of the spatial correlation of substitution rates from the data. By applying GP4Rate to a set of mammalian B7-1 genes, we found a highly conserved region which coincides with experimental evidence. GP4Rate may be a useful tool for the <italic>in silico</italic> prediction of functionally important regions in the proteins with known structures.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>To understand how a protein functions, a critical step is to know which regions in its protein tertiary structure may be functionally important. Functionally important protein regions are typically more conserved than other regions because mutations in these regions are more likely to be deleterious. A number of phylogenetic models have been developed to identify conserved sites or regions in proteins by comparing protein sequences from multiple species. However, most of these methods treat amino acid sites independently and do not consider the spatial clustering of conserved sites in the protein tertiary structure. Therefore, their power of identifying functional protein regions is limited. We develop a new statistical model, GP4Rate, which combines the information from the protein sequences and the protein tertiary structure to infer conserved regions. We demonstrate that GP4Rate outperforms Rate4Site, the most widely used phylogenetic software for inferring functional amino acid sites, via simulations with a case study of B7-1 genes. GP4Rate is a potentially useful tool for guiding mutagenesis experiments or providing insights on the relationship between protein structures and functions.</p>
</abstract>
<funding-group><funding-statement>This work was funded by an NSERC (<ext-link ext-link-type="uri" xlink:href="http://www.nserc-crsng.gc.ca/Index_eng.asp" xlink:type="simple">http://www.nserc-crsng.gc.ca/Index_eng.asp</ext-link>) Discovery grant to GBG (grant number RGPIN140221-10). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>An important question in biology is the identification of functional residues in proteins. This information can help us understand the relationship between protein structures and functions as well as guide us to design new proteins by genetic engineering. However, experimental techniques for identifying functional sites, e.g. mutagenesis, are time consuming and expensive, which prohibits the brute force scanning of functional sites by experiments. Therefore, bioinformatics tools are useful, because they can narrow down the candidate sites for experimental investigation. Evolution operates similar to a high-throughput mutagenesis experiment: spontaneous mutations introduce protein variants in each generation and then the functional effects of the spontaneous mutations are “measured” by natural selection <xref ref-type="bibr" rid="pcbi.1003429-Kumar1">[1]</xref>. Therefore, protein sequences contain signatures of natural selection which reflect the functions of amino acid residues. For example, mutations at the functionally important sites tend to disrupt the proteins' normal functions, so these sites usually are more conserved than unimportant ones. If the sequences of a family of homologous proteins can be collected from multiple species, we may compare these sequences to infer which sites are more important than others.</p>
<p>A number of bioinformatics tools based on phylogenetics have been developed to infer functional sites by the simple idea that functionally important amino acid sites tend to be more conserved than unimportant ones <xref ref-type="bibr" rid="pcbi.1003429-Lichtarge1">[2]</xref>–<xref ref-type="bibr" rid="pcbi.1003429-Ashkenazy1">[11]</xref>. Given the multiple sequence alignment and the phylogenetic tree of a protein family, these phylogenetic methods can infer the amino acid substitution rate at each site in the alignment and an unusually low substitution rate implies that the site is functionally important. It has been shown that the predicted conserved sites coincide with experimental evidence, which confirms that these bioinformatics tools are useful.</p>
<p>However, these existing methods are far from flawless. Most of the popular methods, e.g. Rate4Site <xref ref-type="bibr" rid="pcbi.1003429-Mayrose1">[7]</xref> used in the ConSurf web server <xref ref-type="bibr" rid="pcbi.1003429-Ashkenazy1">[11]</xref>, assume that the substitution rates are independent across sites. In statistical terms, this means that the sites in the alignment are independent and identically distributed (i.i.d.). The i.i.d. assumption simplifies the statistical modeling, but it is unrealistic from the viewpoint of biology. The i.i.d. assumption implies that the slowly evolved functional sites are randomly distributed in the protein tertiary structure. In contrast, it is well known that functionally important sites tend to be close to each other in the protein tertiary structure and form functional regions, e.g. ligand binding sites or catalytic active sites. Clearly the i.i.d. assumption is inappropriate if a functional region consists of a number of sites.</p>
<p>Several methods have been developed to incorporate the spatial correlation of evolutionary patterns, e.g. substitution rates at the protein level or <italic>dN/dS</italic> ratios at the codon level, to overcome the drawbacks of the i.i.d. assumption <xref ref-type="bibr" rid="pcbi.1003429-Dean1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Simon1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Nimrod1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Suzuki1">[12]</xref>–<xref ref-type="bibr" rid="pcbi.1003429-Watabe1">[16]</xref>. Most of these methods use a sliding window framework, in which the amino acid substitution rate or the <italic>dN/dS</italic> ratio at a focal site is approximated by the average substitution rate in a set of neighbor sites in the protein tertiary structure <xref ref-type="bibr" rid="pcbi.1003429-Dean1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Suzuki1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Berglund1">[13]</xref>. A site is considered to be a neighbor of the focal site if the Euclidean distance between the two sites is smaller than a predefined window size. Unfortunately, these sliding window methods also have intrinsic drawbacks. Firstly, in most, if not all, of sliding window methods the neighbor sites, including the focal site itself, are weighted equally in the inference of the substitution rate. However, clearly the focal site itself contains more information on its substitution rate than the sites near the boundary of the sliding window. Secondly, it is unclear how to determine the optimal window size <xref ref-type="bibr" rid="pcbi.1003429-Huang1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Zhang1">[18]</xref>. If the window size is too large, there will be too many distant sites in the window, which could bias the estimation at the focal site. In contrast, if the window size is too small, the sliding window methods will not be able to capture the spatial correlation of substitution rates and may lead to overfitting. Furthermore, there is evidence that the optimal window sizes may vary among different protein families <xref ref-type="bibr" rid="pcbi.1003429-Suzuki1">[12]</xref>.</p>
<p>Very recently, a Bayesian model which combines the Potts model in statistical physics and the phylogenetic model has been proposed by Watabe and Kishino to infer protein patches under positive selection in protein tertiary structures <xref ref-type="bibr" rid="pcbi.1003429-Watabe1">[16]</xref>. In Watabe and Kishino's model, the Potts model is used to define a prior distribution of <italic>dN/dS</italic> ratios over a protein tertiary structure. This model solved many problems of the sliding window framework. However, the prior distribution in Watabe and Kishino's model is unnormalized <xref ref-type="bibr" rid="pcbi.1003429-Watabe1">[16]</xref>, which makes it difficult to design efficient algorithms to estimate hyperparameters. An advanced algorithm, thermodynamic integration <xref ref-type="bibr" rid="pcbi.1003429-Lartillot1">[19]</xref>, was used in Watabe and Kishino's model to infer hyperparameters. However, the algorithm may be very inefficient, especially if there are many hyperparameters in the Potts model.</p>
<p>Here we propose to incorporate a Gaussian process with the phylogenetic model to overcome the drawbacks of the existing methods. The Gaussian process has been widely applied in geostatistics and machine learning to capture the spatial correlation of interesting features <xref ref-type="bibr" rid="pcbi.1003429-Banerjee1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Rasmussen1">[21]</xref>. Here we will briefly introduce the basic idea of the Gaussian process. More details of the Gaussian process and its applications can be found in the geostatistics and machine learning literature, e.g. <xref ref-type="bibr" rid="pcbi.1003429-Banerjee1">[20]</xref>. A Gaussian process defines a probability distribution over functions, namely that a single sample point of the Gaussian process is a function over a space, e.g. a 3D space. Because the sample points of the Gaussian process are “smooth” functions, the Gaussian process encodes an intrinsic spatial correlation. Thus physically closely located points in the space are more likely to have similar function values. Therefore, the Gaussian process is very useful for defining prior distributions over spatially correlated patterns. For example, in this paper we are interested in modeling the spatial correlation of site-specific substitution rates in protein tertiary structures. If we image each residue in a protein tertiary structure as a single point in the 3D space, the Gaussian process can be used to define a prior distribution of site-specific log substitution rates over these points (residues). The “smoothness” property of Gaussian process prior suggests that two physically closely located sites are more likely to have similar site-specific log substitution rates than two distantly located sites. Then, the Gaussian process prior can be combined with standard phylogenetic likelihood functions <xref ref-type="bibr" rid="pcbi.1003429-Felsenstein1">[22]</xref> to infer site-specific substitution rates from real data.</p>
<p>We name this kind of hybrid model of Gaussian processes and phylogenetics as a phylogenetic Gaussian process model (Phylo-GPM). In the Phylo-GPM framework, the spatial correlation of substitution rates can be naturally described and the strength of spatial correlation can be learned from the data. Therefore, it overcomes the common drawback of the sliding window methods that the window size must be manually specified. Unlike Watabe and Kishino's model <xref ref-type="bibr" rid="pcbi.1003429-Watabe1">[16]</xref>, the phylogenetic Gaussian process model uses a normalized prior, so simple algorithms, i.e. the widely used Metropolis algorithm <xref ref-type="bibr" rid="pcbi.1003429-Metropolis1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Hastings1">[24]</xref>, can be used to efficiently infer hyperparameters. We have developed software, GP4Rate, based on the Phylo-GPM framework. In both simulated and real datasets, GP4Rate outperforms Rate4Site, a widely used tool based on the i.i.d. assumption. Therefore, GP4Rate may be a useful tool for the identification of functionally important sites.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>2D toy protein simulations</title>
<p>Simulations were implemented to evaluate the performance of GP4Rate and to compare it with the widely used software, Rate4Site <xref ref-type="bibr" rid="pcbi.1003429-Mayrose1">[7]</xref>. In the comparisons, Rate4Site is used as a representative of the classic phylogenetic models which use the discrete Gamma distribution to describe the variation of substitution rates across sites <xref ref-type="bibr" rid="pcbi.1003429-Yang1">[25]</xref> but do not consider the spatial correlation of site-specific substitution rates in the protein tertiary structure. Because the true site-specific substitution rates are known in the simulated alignments, the estimated site-specific substitution rates can be compared with the true rates to evaluate the performance of the two methods. We generated two sets of simulated alignments based on different assumptions. In this and the next section, we will describe the first set of simulations which were based on a 2D toy protein structure. Thereafter we will describe the second set of simulations which were based on more realistic assumptions.</p>
<p>To generate simulated alignments, we need a phylogenetic tree to describe the evolutionary relationship between simulated sequences, a protein structure to calculate the pairwise Euclidean distances between sites, a substitution model, and a vector of substitution rates. Note that the following discussions will be mainly based on the substitution rates rather than their log values. A simple phylogenetic tree was used in all simulations (<xref ref-type="fig" rid="pcbi-1003429-g001">Figure 1A</xref>). The tree consisted of four sequences and all the branch lengths were equal to 0.2 substitution per site. Because the total branch length was equal to 1 substitution per site, on average an amino acid site only contained a single substitution. Therefore, the accurate estimation of substitution rate at a single site is challenging. The JTT substitution model <xref ref-type="bibr" rid="pcbi.1003429-Jones1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Kosiol1">[27]</xref> was used in all simulations. Note that the protein tertiary structure and the vectors of substitution rates used in the two sets of simulated alignments were different and will be described in detail below.</p>
<fig id="pcbi-1003429-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003429.g001</object-id><label>Figure 1</label><caption>
<title>The phylogenetic tree used in all simulations and an example of 2D toy protein structure.</title>
<p>(A) the phylogenetic tree used in all simulations; (B) a 5 by 5 2D toy protein. In the phylogenetic tree, there are 4 species and all branch lengths are equal to 0.2 substitutions per site. In the example of 2D toy protein, there are 25 amino acids which are dots in a 5 by 5 2D grid. Lines between dots correspond to the “covalent bonds” between amino acid residues. A larger 20 by 20 2D toy protein with 400 residues is used in the 2D toy protein simulations.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003429.g001" position="float" xlink:type="simple"/></fig>
<p>In the 2D toy protein model, the protein tertiary structure was described by a 20 by 20 regular 2D grid, in which each dot corresponds to an amino acid in the toy protein structure (<xref ref-type="fig" rid="pcbi-1003429-g001">Figure 1B</xref>). In addition, we assumed that the distance between adjacent sites in the 2D grid is equal to 5 Å. This distance is comparable to the average distance between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e001" xlink:type="simple"/></inline-formula>carbon atoms of the physically interacting residues in real proteins. Even though the 2D toy protein model is artificial and no real protein has a similar structure, it is useful because the estimated site-specific substitution rates can be easily visualized by a heatmap (<xref ref-type="fig" rid="pcbi-1003429-g002">Figure 2</xref>). Therefore, we used the 2D toy protein model to check the correctness of the program and to get insights on the performance of GP4Rate.</p>
<fig id="pcbi-1003429-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003429.g002</object-id><label>Figure 2</label><caption>
<title>The visualization of the estimated site-specific substitution rates in the 2D toy protein simulations.</title>
<p>The heatmaps are based on two randomly selected alignments, one for each configuration. The substitution rates in the heatmaps are arranged according to the toy 2D protein structure. (A, B) the true substitution rates in the first and second configurations, respectively; (C, D) the substitution rates estimated by GP4Rate in the first and second configurations, respectively; (E, F) the substitution rates estimated by Rate4Site in the first and second configurations, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003429.g002" position="float" xlink:type="simple"/></fig>
<p>Two different spatial configurations of site-specific substitution rates were used in the 2D toy protein simulations. In the first configuration, the 20 by 20 grid was divided into 4 non-overlapping blocks, each of which was a 10 by 10 grid (<xref ref-type="fig" rid="pcbi-1003429-g002">Figure 2A</xref>). Sites within a block had the same substitution rates but different blocks could have different substitution rates. Two substitution rates, 0.2 and 1.8, were used for simulations and the substitution rates of blocks were alternatively arranged in the 2D protein structure (<xref ref-type="fig" rid="pcbi-1003429-g002">Figure 2A</xref>). Therefore, the toy proteins consisted of two conserved blocks with low substitution rates (0.2) and two variable blocks with high substitution rates (1.8). The second configuration was similar to the first one, but the sizes of non-overlapping blocks were 5 by 5 instead of 10 by 10 (<xref ref-type="fig" rid="pcbi-1003429-g002">Figure 2B</xref>). Twenty simulated alignments were generated for each configuration of site-specific substitution rates. It is easy to notice that the average site-specific substitution rate is equal to 1 in both configurations.</p>
<p>A program based on Bio++ <xref ref-type="bibr" rid="pcbi.1003429-Dutheil1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Gueguen1">[29]</xref> was developed to implement the simulations. For each simulated alignment, we ran two separate MCMC chains using GP4Rate to estimate site-specific substitution rates. For each MCMC chain, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e002" xlink:type="simple"/></inline-formula> iterations were implemented and the trace plots of the MCMC outputs were monitored to ensure the convergence of the MCMC chains. The first <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e003" xlink:type="simple"/></inline-formula> of the iterations were discarded as burn-in. Then, the two chains were combined to calculate the average substitution rate at each site. To compare the performance of GP4Rate with that of Rate4Site, we also used Rate4Site to estimate the substitution rates. To make the results of GP4Rate and Rate4Site more comparable, the phylogenetic tree and branch lengths were fixed to the true values in both GP4Rate and Rate4Site.</p>
<p>We firstly randomly sampled two simulated alignments, one for each configuration, as examples to get insights on the performances of GP4Rate and Rate4Site. As shown in <xref ref-type="fig" rid="pcbi-1003429-g002">Figure 2C and 2D</xref>, the site-specific substitution rates estimated by GP4Rate are smoothly distributed within the 2D protein structures. In addition, GP4Rate segments the 2D protein structures into blocks which correspond to the true patches with different substitution rates. In contrast, the spatial distributions of substitution rates estimated by Rate4Site are far from smooth. The sites with similar substitution rates are not clustered together and do not form clearly bounded patches (<xref ref-type="fig" rid="pcbi-1003429-g002">Figure 2E and 2F</xref>). Thus, GP4Rate can capture the spatial correlation of substitution rates but Rate4Site cannot.</p>
</sec><sec id="s2b">
<title>Quantitative evaluation of different models</title>
<p>To quantitatively evaluate the performance of GP4Rate and Rate4Site, we used receiver operating characteristic (ROC) curves to measure the power of the two methods. ROC curves are widely used to evaluate the accuracy of binary classifiers. The area under a ROC curve is usually used as a measure of the power of the corresponding method. To apply ROC curves to the simulated datasets, we must divide the amino acid sites into two categories, functional sites and nonfunctional sites, before generating simulated alignments. The functional sites are used as true positives while the nonfunctional sites are used as true negatives. In the 2D toy protein simulations, functional sites evolved at the lower rate (0.2) while nonfunctional sites evolved at the higher rate (1.8). Then, the ROC curves were created by plotting the average true positive rates <italic>versus</italic> the average false positive rates using the ROCR library in R <xref ref-type="bibr" rid="pcbi.1003429-Sing1">[30]</xref>. As shown in <xref ref-type="fig" rid="pcbi-1003429-g003">Figure 3A and 3B</xref>, the areas under the ROC curves generated by GP4Rate are larger than those generated by Rate4Site, which suggests that GP4Rate outperforms Rate4site.</p>
<fig id="pcbi-1003429-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003429.g003</object-id><label>Figure 3</label><caption>
<title>The quantitative comparison of GP4Rate and Rate4Site in the 2D toy protein simulations.</title>
<p>(A) the ROC curves of GP4Rate and Rate4Site in the first configuration; (B) the ROC curves of GP4Rate and Rate4Site in the second configuration; (C) the losses of GP4Rate and Rate4Site in the first configuration; (D) the losses of GP4Rate and Rate4Site in the second configuration. In the ROC curves, the solid lines correspond to the performance of GP4Rate while the dotted lines correspond to the performance of Rate4Site. In the plots of losses, each point corresponds to a simulated alignment. The losses of the two methods are calculated by <xref ref-type="disp-formula" rid="pcbi.1003429.e004">Equation 1</xref>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003429.g003" position="float" xlink:type="simple"/></fig>
<p>ROC curves measure whether a model can distinguish slowly evolved functional sites from the other sites. If a model can assign relatively low substitution rates to slowly evolved sites and relatively high rates to the other sites, it will perform well in the evaluations based on ROC curves. However, ROC curves cannot capture potential systematic biases of the model. For example, if the model adds a constant bias to the site-specific substitution rates, its ROC curves will be exactly the same regardless of the magnitude of the constant bias. Therefore, we used a simple loss function complementary with the ROC curves to capture any potential systematic biases of the estimated site-specific substitution rates. The loss function is defined by the following formula<disp-formula id="pcbi.1003429.e004"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003429.e004" xlink:type="simple"/><label>(1)</label></disp-formula>in which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e005" xlink:type="simple"/></inline-formula> is the total number of sites in the alignment, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e006" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e007" xlink:type="simple"/></inline-formula> are the true and estimated log substitution rates at site <italic>i</italic>, respectively. The log values of site-specific substitution rates are used in the right-hand side of <xref ref-type="disp-formula" rid="pcbi.1003429.e004">Equation 1</xref>, since we want to emphasize the differences between low substitution rates. It is desirable because both GP4Rate and Rate4Site were designed to detect conserved regions with low substitution rates. Unlike ROC curves, a model which introduces a larger systematic bias will have a higher average loss than a model which introduces a smaller bias.</p>
<p>We plotted the losses of both GP4Rate and Rate4Site in the 2D toy protein simulations. As shown in <xref ref-type="fig" rid="pcbi-1003429-g003">Figure 3C and 3D</xref>, GP4Rate outperforms Rate4Site, as evident by the lower losses produced by GP4Rate (paired Wilcoxon test, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e008" xlink:type="simple"/></inline-formula> for both of the two configurations). The improved accuracy originates from GP4Rate's ability to model the spatial correlation of site-specific substitution rates, since the performance gap between GP4Rate and Rate4Site becomes smaller in the second configuration which consists of smaller conserved and variable patches.</p>
<p>GP4Rate has two hyperparameters, i.e. the characteristic length scale <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e009" xlink:type="simple"/></inline-formula> and the signal standard deviation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e010" xlink:type="simple"/></inline-formula>, which model the strength of spatial correlation of substitution rates and the marginal variation of substitution rate at a single site, respectively. An advantage of GP4Rate over the sliding window methods is that the hyperparameters can be learned from the data. In contrast, the window size of the sliding window methods must be predefined before analyses. To show that GP4Rate can learn the hyperparameters from the data, we plotted the estimated median hyperparameters of the simulated alignments. As shown in <xref ref-type="fig" rid="pcbi-1003429-g004">Figure 4A</xref>, the characteristic length scales <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e011" xlink:type="simple"/></inline-formula> estimated in the first configuration are about 3 fold larger than those estimated in the second configuration. Because the patches are much larger in the first configuration, the result suggests that GP4Rate can learn the magnitude of the spatial correlation of substitution rates from the data. The estimated signal standard deviations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e012" xlink:type="simple"/></inline-formula> in the two configurations are similar, which matches the intuition that the two configurations are similar except in the strength of spatial correlations of substitution rates.</p>
<fig id="pcbi-1003429-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003429.g004</object-id><label>Figure 4</label><caption>
<title>The hyperparameters estimated by GP4Rate in the 2D toy protein simulations.</title>
<p>The unit of the characteristic length scale is Å while the signal standard deviation is unitless. (A) the estimated characteristic length scale; (B) the estimated signal standard deviation.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003429.g004" position="float" xlink:type="simple"/></fig>
<p>In summary, when spatial correlation of substitution rates exists in proteins, GP4Rate always outperforms Rate4Site. However, the spatial correlation of site-specific substitution rates may be insignificant in some proteins. Therefore, we also evaluated both GP4Rate and Rate4Site in simulated alignments in which the spatial correlation of site-specific substitution rates is absent. These simulated alignments were generated by randomly shuffling the columns in each alignment in the first spatial configuration of substitution rates (<xref ref-type="fig" rid="pcbi-1003429-g002">Figure 2A</xref>). The permutations of alignments destroyed the spatial patten of site-specific substitution rates. Here we only summarize the performance of GP4Rate and Rate4Site in the permuted alignments and more details can be found in the online Supplementary Material. The absence of spatial correlation results in close-to-zero characteristic length scales in GP4Rate, which confirms that GP4Rate can detect the absence of spatial correlation when there is none. Plots of ROC curves show that GP4Rate and Rate4Site have effectively the same power to distinguish slowly evolved sites from the other sites. In contrast, when we use the loss function (<xref ref-type="disp-formula" rid="pcbi.1003429.e004">Equation 1</xref>) to measure the accuracy of estimated substitution rates, GP4Rate is less accurate than Rate4Site. Nevertheless, GP4Rate and Rate4Site have similar power to find slowly evolved functional sites, since in practice it is the relative rankings of sites instead of their absolute substitution rates tell us which sites may be more likely to be functional.</p>
</sec><sec id="s2c">
<title>Realistic simulations</title>
<p>We generated a second set of simulated alignments based on more realistic assumptions. The basic idea is that if we have a large number of highly diverged sequences, a simple method which does not consider the spatial correlation of substitution rates may accurately estimate the site-specific substitution rates because of the rich information in a very large dataset. We may generate simulated alignments based on the real protein tertiary structure and the presumably accurately estimated site-specific substitution rates. These simulated alignments may have similar features as real proteins.</p>
<p>In this set of simulations, we used the same phylogenetic tree (<xref ref-type="fig" rid="pcbi-1003429-g001">Figure 1A</xref>) and the JTT substitution model <xref ref-type="bibr" rid="pcbi.1003429-Jones1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Kosiol1">[27]</xref> used in the 2D toy protein simulations. The protein tertiary structure and the site-specific substitution rates were based on a real protein, B-cell lymphoma extra large (Bcl-xL). This protein has been studied using Rate4Site and the two predicted conserved patches coincide with the regions with known functions <xref ref-type="bibr" rid="pcbi.1003429-Glaser1">[31]</xref>. We downloaded the protein tertiary structure of Bcl-xL from Protein Data Bank (PDB ID: 1MAZ <xref ref-type="bibr" rid="pcbi.1003429-Muchmore1">[32]</xref>). The site-specific substitution rates estimated by Rate4Site were obtained from the ConSurf-DB database <xref ref-type="bibr" rid="pcbi.1003429-Goldenberg1">[10]</xref>. In ConSurf-DB, 131 unique homologs of Bcl-xL were automatically collected and then Rate4Site was applied to estimate the site-specific substitution rates. Because of the very large number of sequences in the dataset, the estimation of site-specific substitution rates may be relatively accurate. We generated 20 simulated alignments based on the above assumptions and both GP4Rate and Rate4Site were applied to the simulated alignments using the same setting described in the 2D toy protein simulations.</p>
<p>To evaluate the performance of GP4Rate and Rate4Site by ROC curves, we divided the sites into two categories before generating simulated alignments: slowly evolved functional sites and others. Based on the site-specific substitution rates reported by ConSurf-DB, the 10 percent most slowly evolved sites were considered to be functional while the others were not. As shown in <xref ref-type="fig" rid="pcbi-1003429-g005">Figure 5A</xref>, GP4Rate is more powerful to distinguish slowly evolved sites from the other sites, since the area under the ROC curve of GP4Rate is larger than that of Rate4Site. In addition, based on the loss function defined by <xref ref-type="disp-formula" rid="pcbi.1003429.e004">Equation 1</xref>, GP4Rate produces lower losses in 18 out of the 20 simulated alignments (<xref ref-type="fig" rid="pcbi-1003429-g005">Figure 5B</xref>) and the median loss of GP4Rate is significantly smaller than that of Rate4Site (paired Wilcoxon test, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e013" xlink:type="simple"/></inline-formula> value&lt;10<sup>−4</sup>). Therefore, GP4Rate still outperforms Rate4Site in the realistic simulations.</p>
<fig id="pcbi-1003429-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003429.g005</object-id><label>Figure 5</label><caption>
<title>The quantitative comparison of GP4Rate and Rate4Site in the realistic simulations.</title>
<p>(A) the ROC curves of GP4Rate and Rate4Site in the realistic simulations; (B) the losses of GP4Rate and Rate4Site in the realistic simulations. In the ROC curves, the solid line corresponds to the performance of GP4Rate while the dotted line corresponds to the performance of Rate4Site. In the plot of losses, each point corresponds to a simulated alignment. The losses of the two methods are calculated by <xref ref-type="disp-formula" rid="pcbi.1003429.e004">Equation 1</xref>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003429.g005" position="float" xlink:type="simple"/></fig></sec><sec id="s2d">
<title>Case study of B7-1 genes</title>
<p>The B7-1 (CD80) family is a member of the immunoglobulin superfamily (IgSF) and is critical for the regulation of immune responses <xref ref-type="bibr" rid="pcbi.1003429-Collins1">[33]</xref>. The protein tertiary structure of the human B7-1 protein has been determined <xref ref-type="bibr" rid="pcbi.1003429-Ikemizu1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Stamper1">[35]</xref>. The human B7-1 protein consists of two IgSF domains (IgV and IgC), each of which shows an anti-parallel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e014" xlink:type="simple"/></inline-formula> sandwich structure <xref ref-type="bibr" rid="pcbi.1003429-Ikemizu1">[34]</xref>. We applied GP4Rate and Rate4Site to 7 mammalian B7-1 sequences downloaded from the NCBI HomoloGene database <xref ref-type="bibr" rid="pcbi.1003429-Sayers1">[36]</xref> and compared their performances. The N-terminal and C-terminal sequences were trimmed in the alignment, because the corresponding atoms are absent in the X-ray crystal structure. The resulting alignment consists of 199 amino acid sites. Then the phylogenetic tree was inferred by PhyML with the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e015" xlink:type="simple"/></inline-formula> model <xref ref-type="bibr" rid="pcbi.1003429-Guindon1">[37]</xref>. The protein sequences in the alignment are very similar to each other as evident by the lack of gaps in the alignment (data not shown). Therefore, the information in each site in the alignment is very limited and it is hard to infer site-specific substitution rates accurately.</p>
<p>We used the human B7-1 protein structure (PDB ID: 1I8L <xref ref-type="bibr" rid="pcbi.1003429-Stamper1">[35]</xref>) to calculate the pairwise Euclidean distances between the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e016" xlink:type="simple"/></inline-formula>carbon atoms of amino acids. Then, we applied GP4Rate to the B7-1 alignment to infer site-specific substitution rates. We ran two independent MCMC chains for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e017" xlink:type="simple"/></inline-formula> iterations, and the first <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e018" xlink:type="simple"/></inline-formula> of the iterations were discarded as burn-in. We first estimated the posterior marginal distributions of hyperparameters based on the MCMC samples. As shown in <xref ref-type="fig" rid="pcbi-1003429-g006">Figure 6</xref>, the estimated characteristic length scale <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e019" xlink:type="simple"/></inline-formula> is significantly higher than 0, which confirms that the substitution rates are correlated in real proteins. The presence of spatial correlation of substitution rates may facilitate the discovery of slowly evolved functional regions. To test this hypothesis, the mean site-specific substitution rates of the MCMC samples were calculated and the 20 most slowly evolved sites were considered to be functional. Then, the 20 most slowly evolved sites were superimposed onto the protein tertiary structure (PDB ID: 1I8L <xref ref-type="bibr" rid="pcbi.1003429-Stamper1">[35]</xref>). As shown in <xref ref-type="fig" rid="pcbi-1003429-g007">Figure 7A</xref>, the slowly evolved sites predicted by GP4Rate are not randomly distributed and instead form a single large region in the IgC domain. A systematic mutagenesis study has suggested that the IgC domains are important for binding CTLA-4 and CD28 <xref ref-type="bibr" rid="pcbi.1003429-Peach1">[38]</xref>, even though the effects of the IgC domain may be indirect <xref ref-type="bibr" rid="pcbi.1003429-Stamper1">[35]</xref>. To test whether the predicted slowly evolved sites overlap with the experimentally verified functional sites <xref ref-type="bibr" rid="pcbi.1003429-Peach1">[38]</xref>, the 7 experimentally verified functional sites in the IgC domain were mapped onto the human B7-1 structure (<xref ref-type="fig" rid="pcbi-1003429-g007">Figure 7A</xref>). Clearly 4 experimentally verified functional sites in the IgC domain, i.e. Q157, D158, E162, and L163, are within the slowly evolved patch predicted by GP4Rate, which highlights the potential usefulness of GP4Rate.</p>
<fig id="pcbi-1003429-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003429.g006</object-id><label>Figure 6</label><caption>
<title>The empirical marginal density functions of the hyperparameters in the case study of B7-1 genes.</title>
<p>The unit of the characteristic length scale is Å while the signal standard deviation is unitless.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003429.g006" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003429-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003429.g007</object-id><label>Figure 7</label><caption>
<title>The locations of the 20 most conserved sites in the protein tertiary structure of the human B7-1 protein (PDB ID: 1I8L).</title>
<p>The blue sites are the 20 most conserved sites and the space-filled atoms correspond to the experimentally verified functional sites in the IgC domain <xref ref-type="bibr" rid="pcbi.1003429-Peach1">[38]</xref>. The experimentally verified functional sites in the IgV domain are not shown. The protein structures are visualized by Jmol <xref ref-type="bibr" rid="pcbi.1003429-Jmol1">[59]</xref>. A list of the most conserved sites can be found in the online Supplementary Material. (A) the 20 most conserved sites predicted by GP4Rate; (B) the 20 most conserved sites predicted by Rate4Site.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003429.g007" position="float" xlink:type="simple"/></fig>
<p>To compare GP4Rate with Rate4Site, we also applied Rate4Site to the same dataset. The superimposition of the 20 most slowly evolved sites predicted by Rate4Site is shown in <xref ref-type="fig" rid="pcbi-1003429-g007">Figure 7B</xref>. The sites predicted by Rate4Site are present in both the IgV and IgC domains and do not form clearly bounded regions. Even though 2 experimentally verified functional sites in the IgC domain, i.e. F106 and I113, overlap with the sites predicted by Rate4Site, the 4 experimentally verified functional sites detected by GP4Rate do not overlap with the sites predicted by Rate4Site. Therefore, GP4Rate and Rate4Site can provide complementary insights to real data.</p>
<p>To investigate which model, GP4Rate or Rate4Site, fits the B7-1 dataset better, we performed a Bayesian model comparison. The direct comparison between GP4Rate and Rate4Site is impractical, because Rate4Site is based on the maximum likelihood principle instead of the Bayesian principle. However, it is not very difficult to develop a Bayesian version of Rate4Site by specifying a prior distribution over parameters. Therefore, we developed a Bayesian version of Rate4Site and compared it with GP4Rate. Details of the Bayesian model comparison can be found in the online Supplementary Material and we only summarize the results here. We compared the site-specific substitution rates estimated by the original Rate4Site and its Bayesian version and found that the two programs produced essentially the same result. Therefore, the marginal likelihood estimated by the Bayesian version of Rate4Site may be used to evaluate how good the original Rate4Site fits the B7-1 dataset. The log marginal likelihood of GP4Rate is equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e020" xlink:type="simple"/></inline-formula> while the log marginal likelihood of the Bayesian Rate4Site is equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e021" xlink:type="simple"/></inline-formula>, which suggests a very large Bayes factor of GP4Rate compared with the Bayesian Rate4Site (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e022" xlink:type="simple"/></inline-formula>). Therefore, GP4Rate fits the B7-1 dataset much better than the Bayesian Rate4Site.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>Many phylogenetic methods have been developed to identify slowly evolved amino acid sites which may be functional. However, the most widely used methods, e.g. Rate4Site, ignore the spatial correlation of site-specific substitution rates. Some other methods use the sliding-window framework to capture the spatial correlation of substitution rates, but the statistical method for choosing the optimal window size is largely unknown. Since the strength of the spatial correlation of substitution rates is unknown in most of proteins, the sliding window methods are problematic in real data analyses. In GP4Rate, both of the two issues are solved under a Bayesian statistical framework. By using the Gaussian process to define the prior distribution of the site-specific log substitution rates, GP4Rate can naturally model the spatial clustering of functionally important sites and the hyperparameters which measure the strength of spatial correlation can be inferred from the data instead of being manually specified before the analyses.</p>
<p>In simulated datasets, GP4Rate significantly outperforms Rate4Site. The power of GP4Rate is mainly derived from the fact that GP4Rate has the added ability to model the spatial correlation of substitution rates. By borrowing statistical information from neighbor sites with similar substitution rates, GP4Rate can estimate the site-specific substitution rates with a much higher accuracy than Rate4Site. In the case study of B7-1 genes, GP4Rate predicted a slowly evolved functional patch in the protein tertiary structure and 4 sites within the region are well supported by experimental evidence. In contrast, the slowly evolved sites predicted by Rate4Site are scattered and do not form clearly bounded regions. In addition, we have shown that GP4Rate fits the B7-1 dataset much better than Rate4Site based on Bayesian model comparison.</p>
<p>The performance gap between GP4Rate and Rate4Site will be maximized when the protein sequences are very similar to each other and the spatial correlation is strong. Therefore, GP4Rate is most suitable to analyze small gene families, e.g. new genes or small gene families derived from recent gene duplication events. When the spatial correlation of substitution rates is weak, GP4Rate and Rate4Site may generate similar results. For example, we applied GP4Rate to 38 RH1 genes <xref ref-type="bibr" rid="pcbi.1003429-Yokoyama1">[39]</xref> and found that the spatial correlation of substitution rates is much weaker in the RH1 dataset than that in the B7-1 dataset (data not shown). In this case, the difference between GP4Rate and Rate4Site is subtle. Therefore, a rigorous model comparison as shown in the case study of B7-1 genes may be important in data analyses.</p>
<p>Because GP4Rate is based on MCMC simulations, it is slower than Rate4Site. For example, it took about 1 CPU day for GP4Rate to analyze the B7-1 dataset. However, GP4Rate is still very useful for small scale problems, e.g. guiding mutagenesis experiments, since the experimental time is much longer than the execution time of GP4Rate. The time cost of GP4Rate can be reduced in the future using advanced algorithms, e.g. more efficient MCMC sampling algorithms or sparse approximations of the Gaussian process <xref ref-type="bibr" rid="pcbi.1003429-Vanhatalo1">[40]</xref>. The most time consuming step of GP4Rate is the Cholesky decomposition whose time complexity is a cubic function of the number of sites in the alignment. In practice, a simple method to reduce the computational time is to perform the analyses based on a selected subset of amino acid sites. For example, it is well known that surface residues are more likely to be involved in interactions with other proteins or ligands. If these interactions are most interesting to users, a fast analysis based only on the surface residues may be appropriate.</p>
<p>In addition to modeling the spatial correlation of site-specific substitution rates, protein tertiary structures have been used to improve phylogenetic models and the estimation of site-specific substitution rates in a few other studies <xref ref-type="bibr" rid="pcbi.1003429-Robinson1">[41]</xref>–<xref ref-type="bibr" rid="pcbi.1003429-Meyer2">[46]</xref>. These methods can be roughly divided into two categories. The first category of models assumes that the fixation probability of new mutations is determined by how the mutations influence the stability of the protein <xref ref-type="bibr" rid="pcbi.1003429-Robinson1">[41]</xref>–<xref ref-type="bibr" rid="pcbi.1003429-Rodrigue2">[43]</xref>. Typically it is assumed that mutations which stabilize the protein structure are more likely to be fixed than mutations which destabilize the protein structure. Unlike this category of models, the Phylo-GPM framework does not provide a mechanistic interpretation for the estimated substitution rates. However, GP4Rate may be more powerful to identify functional regions which are not directly relevant to the stability of proteins. The second category of models assumes that the site-specific substitution rates or <italic>dN/dS</italic> ratios are influenced by the local environment of the focal site in the protein tertiary structure <xref ref-type="bibr" rid="pcbi.1003429-Conant1">[44]</xref>–<xref ref-type="bibr" rid="pcbi.1003429-Meyer2">[46]</xref>. For example, it has been shown that the <italic>dN/dS</italic> ratio of a site is influenced by its relative solvent accessibility (RSA) <xref ref-type="bibr" rid="pcbi.1003429-Conant1">[44]</xref>–<xref ref-type="bibr" rid="pcbi.1003429-Meyer2">[46]</xref>. It is relatively straightforward to combine the Phylo-GPM framework with local features of amino acid sites. For example, in this study we assume that the site-specific log substitution rates follow a zero-mean Gaussian distribution. We may replace the zero-mean rate vector by a new one in which the mean of log substitution rate at a site is a linear function of its local features, e.g. RSA. It is very interesting to investigate whether adding local features to the Phylo-GPM framework improves model fitting in the future.</p>
<p>The Phylo-GPM framework proposed in this paper may be used as a general tool to model the spatial correlation of patterns in the protein tertiary structure. The phylogenetic hidden Markov model (Phylo-HMM) is a popular method which combines the hidden Markov model and statistical phylogenetics <xref ref-type="bibr" rid="pcbi.1003429-Siepel1">[47]</xref>. It has been used to model the spatial correlation of evolutionary patterns along primary sequences <xref ref-type="bibr" rid="pcbi.1003429-Huang1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Yang2">[48]</xref>–<xref ref-type="bibr" rid="pcbi.1003429-DeMaio1">[53]</xref>. The Phylo-GPM framework may be viewed as an extension of the Phylo-HMM to the protein tertiary structures. In the future, new methods based on the Phylo-GPM framework may be developed to identify functional divergence or positive selection in proteins.</p>
</sec><sec id="s4">
<title>Models</title>
<sec id="s4a">
<title>Overall design of the phylogenetic Gaussian process model</title>
<p>GP4Rate is an open-source software application written in C++ and its source code is freely available from <ext-link ext-link-type="uri" xlink:href="http://info.mcmaster.ca/yifei/software.html" xlink:type="simple">http://info.mcmaster.ca/yifei/software.html</ext-link>. GP4Rate combines the protein alignment and the protein tertiary structure to infer groups of close-located functional sites evolved at low rate. We assume that the protein alignment, the phylogenetic tree, and the tertiary structure of one protein in the alignment are provided by users. In GP4Rate, both the topology and the branch lengths of the phylogenetic tree are fixed to improve the speed of the program. In addition, we assume that the protein sequences in the alignment belong to the same gene family and have very similar functions, which implies that the functionally important sites do not vary among sequences and the site-specific substitution rates do not change over time. However, we do assume that the substitution rates can vary across different sites. The site-specific rates are used as proxies of functionality: very low substitution rates suggest the corresponding sites are functionally important.</p>
<p>In most molecular phylogenetic programs, e.g. Rate4Site <xref ref-type="bibr" rid="pcbi.1003429-Mayrose1">[7]</xref>, PAML <xref ref-type="bibr" rid="pcbi.1003429-Yang3">[54]</xref>, and PhyML <xref ref-type="bibr" rid="pcbi.1003429-Guindon1">[37]</xref>, the site-specific substitution rates are assumed to be i.i.d. and follow a simple discrete distribution, usually the discrete Gamma distribution <xref ref-type="bibr" rid="pcbi.1003429-Yang1">[25]</xref>. Recently, Dirichlet process pirors have been used to model the variable substitution rates over sites to overcome the inflexibility of the simple discrete distributions <xref ref-type="bibr" rid="pcbi.1003429-Huelsenbeck1">[55]</xref>, but it is still assumed that the site-specific substitution rates are i.i.d. The i.i.d. assumption implies that slowly evolved functional sites are scattered in the protein tertiary structure. The major contribution of this paper is to relax the i.i.d. assumption using the Gaussian process <xref ref-type="bibr" rid="pcbi.1003429-Rasmussen1">[21]</xref> which can naturally capture the spatial correlation of site-specific substitution rates in the protein tertiary structure.</p>
<p>In GP4Rate, the parameters are estimated using the Bayesian principle. In Bayesian statistics, the parameters are random variables and the conditional distribution of parameters given data, i.e. the posterior distribution, gives us an estimation of parameters. For simplicity of presentation, first we focus on the vector of site-specific log substitution rates, which is the collection of log values of substitution rates at all amino acid sites, and defer the discussions on the other parameters. The posterior distribution of the vector of log site-specific substitution rates can be defined by the following equation,<disp-formula id="pcbi.1003429.e023"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003429.e023" xlink:type="simple"/><label>(2)</label></disp-formula>In the equation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e024" xlink:type="simple"/></inline-formula> is the vector of site-specific log substitution rates, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e025" xlink:type="simple"/></inline-formula> is the protein alignment while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e026" xlink:type="simple"/></inline-formula> is its <italic>i</italic>-th column, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e027" xlink:type="simple"/></inline-formula> is the phylogenetic tree with the associated branch lengths. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e028" xlink:type="simple"/></inline-formula> is the site-specific likelihood at site <italic>i</italic>, which is a function of the site-specific log substitution rate at site <italic>i</italic>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e029" xlink:type="simple"/></inline-formula> is the fundamentally important prior distribution of site-specific log substitution rates.</p>
<p>A realistic <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e030" xlink:type="simple"/></inline-formula> should be able to describe the spatial correlation of site-specific substitution rates. In GP4Rate, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e031" xlink:type="simple"/></inline-formula> is specified by a zero-mean Gaussian process. A Gaussian process is a probability measure defined over a function space. In the statistical modeling of site-specific substitution rates, we are only interested in the marginal distribution of the Gaussian process over a finite set of spatial locations which correspond to the locations of residues in the protein tertiary structure. By the definition of Gaussian processes, the marginal distribution of a zero-mean Gaussian process is a zero-mean multivariate Gaussian distribution <xref ref-type="bibr" rid="pcbi.1003429-Rasmussen1">[21]</xref>. Therefore, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e032" xlink:type="simple"/></inline-formula> may be rewritten in the following format,<disp-formula id="pcbi.1003429.e033"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003429.e033" xlink:type="simple"/><label>(3)</label></disp-formula>The correlation of site-specific substitution rates is determined by the covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e034" xlink:type="simple"/></inline-formula>, in which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e035" xlink:type="simple"/></inline-formula> is the pairwise distance matrix which measures the Euclidean distance between the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e036" xlink:type="simple"/></inline-formula>carbon atoms of amino acids in the protein tertiary structure. Furthermore, the covariance function is parameterized by two hyperparameters, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e037" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e038" xlink:type="simple"/></inline-formula>, which measure the strength of spatial correlation and the variation of substitution rates across sites, respectively. By plugging <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e039" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e040" xlink:type="simple"/></inline-formula>, the prior distribution of the hyperparameters, into <xref ref-type="disp-formula" rid="pcbi.1003429.e023">Equation 2</xref>, it can be expanded to the following format,<disp-formula id="pcbi.1003429.e041"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003429.e041" xlink:type="simple"/><label>(4)</label></disp-formula>In the following sections, we will provide more details on the specifications of the right-hand side terms of <xref ref-type="disp-formula" rid="pcbi.1003429.e041">Equation 4</xref> and the MCMC algorithm for the sampling of parameters, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e042" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e043" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e044" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4b">
<title>Gaussian process as a prior distribution of site-specific log substitution rates</title>
<p>As mentioned above, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e045" xlink:type="simple"/></inline-formula> follows a zero-mean multivariate Gaussian distribution (<xref ref-type="disp-formula" rid="pcbi.1003429.e033">Equation 3</xref>). In the multivariate Gaussian distribution, the covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e046" xlink:type="simple"/></inline-formula> is specified by a covariance function. By default, GP4Rate uses the Matérn 1.5 covariance function,<disp-formula id="pcbi.1003429.e047"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003429.e047" xlink:type="simple"/><label>(5)</label></disp-formula>In the equation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e048" xlink:type="simple"/></inline-formula> is an element in the covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e049" xlink:type="simple"/></inline-formula> while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e050" xlink:type="simple"/></inline-formula> is an element in the distance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e051" xlink:type="simple"/></inline-formula> which measures the Euclidean distance between site <italic>i</italic> and site <italic>j</italic> in the protein tertiary structure. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e052" xlink:type="simple"/></inline-formula> is an indicator function which is equal to 1 if site <italic>i</italic> and site <italic>j</italic> are the same site and equal to 0 otherwise. The covariance function contains two free parameters, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e053" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e054" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e055" xlink:type="simple"/></inline-formula> is the characteristic length which determines the strength of the spatial correlation of substitution rates. If it is small, the spatial correlation is weak and only nearby sites have similar log substitution rates. Instead, if it is large, the spatial correlation is strong and distant sites can have similar log substitution rates. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e056" xlink:type="simple"/></inline-formula> is the signal standard deviation which measures the marginal variation of log substitution rates at a single site. Small <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e057" xlink:type="simple"/></inline-formula> implies that the variation of log substitution rates is small. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e058" xlink:type="simple"/></inline-formula> is a fixed “jitter” term which introduces a small amount of noise to the diagonal elements in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e059" xlink:type="simple"/></inline-formula>. The “jitter” term ensures that the Cholesky decomposition, a critical numerical algorithm in the MCMC simulations, is numerically stable and improves the mixing of the MCMC simulations <xref ref-type="bibr" rid="pcbi.1003429-Neal1">[56]</xref>. The “jitter” term is usually a small positive number (e.g. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e060" xlink:type="simple"/></inline-formula>), so it does not significantly change the behavior of the covariance function <xref ref-type="bibr" rid="pcbi.1003429-Neal1">[56]</xref>. Clearly <xref ref-type="disp-formula" rid="pcbi.1003429.e047">Equation 5</xref> implies that the covariance of log substitution rates are decreasing with increasing Euclidean distance between two amino acid sites, which is compatible with our intuition that nearby sites tend to have similar substitution rates due to similar functions.</p>
<p>In addition to the Matérn 1.5 covariance function, GP4Rate has two alternative covariance functions for users to choose. One is the Matérn 2.5 covariance function,<disp-formula id="pcbi.1003429.e061"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003429.e061" xlink:type="simple"/><label>(6)</label></disp-formula>The other is the widely used squared-exponential covariance function,<disp-formula id="pcbi.1003429.e062"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003429.e062" xlink:type="simple"/><label>(7)</label></disp-formula></p>
<p>The three covariance functions are all special cases of the general Matérn covariance function <xref ref-type="bibr" rid="pcbi.1003429-Rasmussen1">[21]</xref>. The major difference between them is that the three covariance functions describe different levels of smoothness in the spatial distribution of site-specific log substitution rates <xref ref-type="bibr" rid="pcbi.1003429-Rasmussen1">[21]</xref>. In the squared-exponential covariance function, the site-specific log substitution rates are smoothly distributed in the protein tertiary structure. Therefore, it is most suitable to model proteins with relatively large functional regions. In contrast, the Matérn 1.5 covariance function is the least smooth one and is suitable to model proteins with small functional patches. In this paper, we used the Matérn 1.5 covariance function in all analyses to allow for proteins that may have relatively small functional patches and could have nearby sites with very different substitution rates.</p>
<p>The hyperparameters in the covariance functions, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e063" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e064" xlink:type="simple"/></inline-formula>, follow a prior distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e065" xlink:type="simple"/></inline-formula>. We assume that the characteristic length, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e066" xlink:type="simple"/></inline-formula>, and the signal standard deviation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e067" xlink:type="simple"/></inline-formula>, are independent and follow exponential distributions. Therefore, the prior distribution is defined by the following probability density function,<disp-formula id="pcbi.1003429.e068"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003429.e068" xlink:type="simple"/><label>(8)</label></disp-formula>We choose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e069" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e070" xlink:type="simple"/></inline-formula> to be large so that the prior distribution has relatively weak information.</p>
</sec><sec id="s4c">
<title>Approximation of the phylogenetic likelihood function</title>
<p>To fully define the unnormalized posterior distribution (<xref ref-type="disp-formula" rid="pcbi.1003429.e041">Equation 4</xref>), the likelihood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e071" xlink:type="simple"/></inline-formula> must be specified. We follow the standard phylogenetic model first described by Felsenstein <xref ref-type="bibr" rid="pcbi.1003429-Felsenstein1">[22]</xref>. We assume that the substitution model in the phylogenetic likelihood function is fixed to the JTT model <xref ref-type="bibr" rid="pcbi.1003429-Jones1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Kosiol1">[27]</xref> while the phylogenetic tree is fixed to the one provided by the users. The likelihood can be calculated by the pruning algorithm and the gaps in the alignment may be treated as missing data <xref ref-type="bibr" rid="pcbi.1003429-Felsenstein1">[22]</xref>. However, the calculation of the likelihood function can easily become the most time consuming step in the MCMC sampling, because we need to evaluate the likelihood millions of times. We have applied a simple linear interpolation method to reduce the computational time of the likelihood evaluation <xref ref-type="bibr" rid="pcbi.1003429-Press1">[57]</xref>. GP4Rate calculates the site-specific log likelihoods at a set of evenly spaced substitution rates and then approximates the site-specific log likelihoods at other rates by interpolation. Note that the linear interpolation is performed based on the site-specific substitution rates while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e072" xlink:type="simple"/></inline-formula> is the vector of their log values, so an exponential transformation, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e073" xlink:type="simple"/></inline-formula>, must be performed for each site <italic>i</italic> before the interpolation. By default, GP4Rate calculates and caches the site-specific log likelihoods at 4000 evenly spaced substitution rates, ranging from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e074" xlink:type="simple"/></inline-formula> to 20. In each step of the likelihood calculation, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e075" xlink:type="simple"/></inline-formula> is between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e076" xlink:type="simple"/></inline-formula> and 20, the corresponding site-specific log likelihood is approximated by the following formula,<disp-formula id="pcbi.1003429.e077"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003429.e077" xlink:type="simple"/><label>(9)</label></disp-formula>On the right hand side, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e078" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e079" xlink:type="simple"/></inline-formula> are the two cached substitution rates which are closest to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e080" xlink:type="simple"/></inline-formula>, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e081" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e082" xlink:type="simple"/></inline-formula> are the site-specific log likelihoods of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e083" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e084" xlink:type="simple"/></inline-formula>, respectively. In practice, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e085" xlink:type="simple"/></inline-formula> is rarely bigger than 20 or smaller than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e086" xlink:type="simple"/></inline-formula>. If it is indeed outside this, the log likelihood at the closest boundary is used as the approximate log likelihood.</p>
</sec><sec id="s4d">
<title>Markov Chain Monte Carlo sampling</title>
<p>GP4Rate uses MCMC simulations to sample parameters from their posterior distribution. The algorithm follows previous studies by Neal <xref ref-type="bibr" rid="pcbi.1003429-Neal1">[56]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Neal2">[58]</xref>. As described in the previous sections, the parameters in GP4Rate have two components. The first one is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e087" xlink:type="simple"/></inline-formula> and the second one consists of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e088" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e089" xlink:type="simple"/></inline-formula>. In each iteration, the two components are sequentially updated by the Metropolis algorithm with symmetric proposals <xref ref-type="bibr" rid="pcbi.1003429-Metropolis1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1003429-Hastings1">[24]</xref>.</p>
<p>To update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e090" xlink:type="simple"/></inline-formula>, GP4Rate uses a proposal distribution suggested by Neal <xref ref-type="bibr" rid="pcbi.1003429-Neal1">[56]</xref>,<disp-formula id="pcbi.1003429.e091"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003429.e091" xlink:type="simple"/><label>(10)</label></disp-formula>In the equation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e092" xlink:type="simple"/></inline-formula> is the current vector of site-specific log substitution rates while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e093" xlink:type="simple"/></inline-formula> is the new proposal. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e094" xlink:type="simple"/></inline-formula> is the Cholesky decomposition of the covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e095" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e096" xlink:type="simple"/></inline-formula> is a vector of independent standard Gaussian variables. The proposal distribution is tuned by the constant, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e097" xlink:type="simple"/></inline-formula>. A large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e098" xlink:type="simple"/></inline-formula> leads to large changes of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e099" xlink:type="simple"/></inline-formula> while small <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e100" xlink:type="simple"/></inline-formula> leads to small changes. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e101" xlink:type="simple"/></inline-formula> is chosen to make the acceptance rate of new proposals close to 0.25.</p>
<p>Instead of updating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e102" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e103" xlink:type="simple"/></inline-formula> in the original scale, we transform them to the log scale. The use of a log scale removes the boundaries of the two parameters and makes the MCMC sampling of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e104" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e105" xlink:type="simple"/></inline-formula> independent from the scale of the data <xref ref-type="bibr" rid="pcbi.1003429-Neal1">[56]</xref>. The two parameters are updated by a sliding window method with a bivariate Gaussian proposal <xref ref-type="bibr" rid="pcbi.1003429-Neal2">[58]</xref>. The Gaussian proposal is tuned so that the acceptance rate of new proposals is close to 0.25.</p>
<p>In practice, the update of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e106" xlink:type="simple"/></inline-formula> is much faster than the update of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e107" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e108" xlink:type="simple"/></inline-formula>, because the update of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e109" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e110" xlink:type="simple"/></inline-formula> requires a Cholesky decomposition whose time complexity is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e111" xlink:type="simple"/></inline-formula>, in which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e112" xlink:type="simple"/></inline-formula> is the total number of sites in the alignment. Therefore, it is reasonable to update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e113" xlink:type="simple"/></inline-formula> more often than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e114" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e115" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003429-Neal1">[56]</xref>. In each iteration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e116" xlink:type="simple"/></inline-formula> is updated 50 times while the pair of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e117" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e118" xlink:type="simple"/></inline-formula> is updated once. After every 10 iterations, the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e119" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e120" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003429.e121" xlink:type="simple"/></inline-formula> are recorded.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003429.s001" mimetype="application/vnd.ms-excel" xlink:href="info:doi/10.1371/journal.pcbi.1003429.s001" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p><bold>The list of most slowly evolved sites predicted by GP4Rate and Rate4Site in the case study of B7-1 genes.</bold></p>
<p>(XLS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003429.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003429.s002" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>The comparison of GP4Rate and Rate4Site in the simulations without spatial correlation of substitution rates and the Bayesian model comparison of GP4Rate and Rate4Site in the case study of B7-1 genes.</bold></p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank Shozo Yokoyama for kindly sharing the RH1 dataset used in an early version of this paper and Julien Dutheil for kindly providing help on the Bio++ library.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003429-Kumar1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kumar</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dudley</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Filipski</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>L</given-names></name> (<year>2011</year>) <article-title>Phylomedicine: an evolutionary telescope to explore and diagnose the universe of disease mutations</article-title>. <source>Trends in Genetics</source> <volume>27</volume>: <fpage>377</fpage>–<lpage>386</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Lichtarge1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lichtarge</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Bourne</surname><given-names>HR</given-names></name>, <name name-style="western"><surname>Cohen</surname><given-names>FE</given-names></name> (<year>1996</year>) <article-title>An evolutionary trace method defines binding surfaces common to protein families</article-title>. <source>Journal of Molecular Biology</source> <volume>257</volume>: <fpage>342</fpage>–<lpage>358</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Dean1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dean</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Golding</surname><given-names>G</given-names></name> (<year>2000</year>) <article-title>Enzyme evolution explained (sort of)</article-title>. <source>Pacific Symposium on Biocom-puting</source> <volume>2000</volume>: <fpage>6</fpage>–<lpage>17</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Madabushi1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Madabushi</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yao</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Marsh</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kristensen</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Philippi</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>Structural clusters of evolutionary trace residues are statistically significant and common in proteins</article-title>. <source>Journal of Molecular Biology</source> <volume>316</volume>: <fpage>139</fpage>–<lpage>154</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Simon1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simon</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Stone</surname><given-names>EA</given-names></name>, <name name-style="western"><surname>Sidow</surname><given-names>A</given-names></name> (<year>2002</year>) <article-title>Inference of functional regions in proteins by quantification of evolutionary constraints</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>99</volume>: <fpage>2912</fpage>–<lpage>2917</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Innis1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Innis</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Anand</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sowdhamini</surname><given-names>R</given-names></name> (<year>2004</year>) <article-title>Prediction of functional sites in proteins using conserved functional group analysis</article-title>. <source>Journal of Molecular Biology</source> <volume>337</volume>: <fpage>1053</fpage>–<lpage>1068</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Mayrose1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mayrose</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Graur</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ben-Tal</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Pupko</surname><given-names>T</given-names></name> (<year>2004</year>) <article-title>Comparison of site-specific rate-inference methods for protein sequences: Empirical bayesian methods are superior</article-title>. <source>Molecular Biology and Evolution</source> <volume>21</volume>: <fpage>1781</fpage>–<lpage>1791</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Nimrod1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nimrod</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Glaser</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Steinberg</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ben-Tal</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Pupko</surname><given-names>T</given-names></name> (<year>2005</year>) <article-title><italic>In silico</italic> identification of functional regions in proteins</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>i328</fpage>–<lpage>i337</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Capra1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Capra</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Singh</surname><given-names>M</given-names></name> (<year>2007</year>) <article-title>Predicting functionally important residues from sequence conservation</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>1875</fpage>–<lpage>1882</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Goldenberg1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goldenberg</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Erez</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Nimrod</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Ben-Tal</surname><given-names>N</given-names></name> (<year>2009</year>) <article-title>The ConSurf-DB: pre-calculated evolutionary conservation profiles of protein structures</article-title>. <source>Nucleic Acids Research</source> <volume>37</volume>: <fpage>D323</fpage>–<lpage>D327</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Ashkenazy1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ashkenazy</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Erez</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Martz</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Pupko</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Ben-Tal</surname><given-names>N</given-names></name> (<year>2010</year>) <article-title>ConSurf 2010: calculating evolutionary conservation in sequence and structure of proteins and nucleic acids</article-title>. <source>Nucleic Acids Research</source> <volume>38</volume>: <fpage>W529</fpage>–<lpage>W533</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Suzuki1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Suzuki</surname><given-names>Y</given-names></name> (<year>2004</year>) <article-title>Three-dimensional window analysis for detecting positive selection at structural regions of proteins</article-title>. <source>Molecular Biology and Evolution</source> <volume>21</volume>: <fpage>2352</fpage>–<lpage>2359</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Berglund1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berglund</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Wallner</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Elofsson</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Liberles</surname><given-names>DA</given-names></name> (<year>2005</year>) <article-title>Tertiary windowing to detect positive diversifying selection</article-title>. <source>Journal of Molecular Evolution</source> <volume>60</volume>: <fpage>499</fpage>–<lpage>504</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Liang1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Landweber</surname><given-names>LF</given-names></name> (<year>2006</year>) <article-title>SWAKK: a web server for detecting positive selection in proteins using a sliding window substitution rate analysis</article-title>. <source>Nucleic Acids Research</source> <volume>34</volume>: <fpage>W382</fpage>–<lpage>W384</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Tusche1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tusche</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Steinbruck</surname><given-names>L</given-names></name>, <name name-style="western"><surname>McHardy</surname><given-names>AC</given-names></name> (<year>2012</year>) <article-title>Detecting patches of protein sites of influenza a viruses under positive selection</article-title>. <source>Molecular Biology and Evolution</source> <volume>29</volume>: <fpage>2063</fpage>–<lpage>2071</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Watabe1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Watabe</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name> (<year>2013</year>) <article-title>Spatial distribution of selection pressure on a protein based on the hierarchical bayesian model</article-title>. <source>Molecular Biology and Evolution</source> <volume>30</volume><supplement>(12)</supplement>: <fpage>2714</fpage>–<lpage>22</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Huang1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname><given-names>YF</given-names></name>, <name name-style="western"><surname>Golding</surname><given-names>GB</given-names></name> (<year>2012</year>) <article-title>Inferring sequence regions under functional divergence in duplicate genes</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>176</fpage>–<lpage>183</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Zhang1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Townsend</surname><given-names>JP</given-names></name> (<year>2009</year>) <article-title>Maximum-likelihood model averaging to profile clustering of site types across discrete linear sequences</article-title>. <source>PLoS Computational Biology</source> <volume>5</volume>: <fpage>e1000421</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Lartillot1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name> (<year>2006</year>) <article-title>Computing Bayes factors using thermodynamic integration</article-title>. <source>Sys-tematic Biology</source> <volume>55</volume>: <fpage>195</fpage>–<lpage>207</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Banerjee1"><label>20</label>
<mixed-citation publication-type="other" xlink:type="simple">Banerjee S, Carlin BP, Gelfand AE (2004) Hierarchical Modeling and Analysis for Spatial Data. Chapman and Hall/CRC, 1 edition.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Rasmussen1"><label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Rasmussen CE, Williams CKI (2005) Gaussian Processes for Machine Learning. The MIT Press, 1 edition.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Felsenstein1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name> (<year>1981</year>) <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>Journal of Molecular Evolution</source> <volume>17</volume>: <fpage>368</fpage>–<lpage>376</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Metropolis1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Metropolis</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Teller</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Teller</surname><given-names>E</given-names></name> (<year>1953</year>) <article-title>Equation of state calculations by fast computing machines</article-title>. <source>The Journal of Chemical Physics</source> <volume>21</volume>: <fpage>1087</fpage>–<lpage>1092</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Hastings1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hastings</surname><given-names>WK</given-names></name> (<year>1970</year>) <article-title>Monte Carlo sampling methods using Markov chains and their applications</article-title>. <source>Biometrika</source> <volume>57</volume>: <fpage>97</fpage>–<lpage>109</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Yang1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name> (<year>1994</year>) <article-title>Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: approximate methods</article-title>. <source>Journal of Molecular Evolution</source> <volume>39</volume>: <fpage>306</fpage>–<lpage>314</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Jones1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname><given-names>DT</given-names></name>, <name name-style="western"><surname>Taylor</surname><given-names>WR</given-names></name>, <name name-style="western"><surname>Thornton</surname><given-names>JM</given-names></name> (<year>1992</year>) <article-title>The rapid generation of mutation data matrices from protein sequences</article-title>. <source>Computer Applications in the Biosciences</source> <volume>8</volume>: <fpage>275</fpage>–<lpage>282</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Kosiol1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kosiol</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>N</given-names></name> (<year>2005</year>) <article-title>Different versions of the Dayhoff rate matrix</article-title>. <source>Molecular Biology and Evolution</source> <volume>22</volume>: <fpage>193</fpage>–<lpage>199</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Dutheil1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dutheil</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Gaillard</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Bazin</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Glemin</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ranwez</surname><given-names>V</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Bio++: a set of C++ libraries for sequence analysis, phylogenetics, molecular evolution and population genetics</article-title>. <source>BMC Bioinformatics</source> <volume>7</volume>: <fpage>188</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Gueguen1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gueguen</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Gaillard</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Boussau</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Gouy</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Groussin</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Bio++: Efficient extensible libraries and tools for computational molecular evolution</article-title>. <source>Molecular Biology and Evolution</source> <volume>30</volume>: <fpage>1745</fpage>–<lpage>1750</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Sing1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sing</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Lengauer</surname><given-names>T</given-names></name> (<year>2005</year>) <article-title>ROCR: visualizing classifier performance in R</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>3940</fpage>–<lpage>3941</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Glaser1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Glaser</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Pupko</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Paz</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Bell</surname><given-names>RE</given-names></name>, <name name-style="western"><surname>Bechor-Shental</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>ConSurf: Identification of functional regions in proteins by surface-mapping of phylogenetic information</article-title>. <source>Bioinformatics</source> <volume>19</volume>: <fpage>163</fpage>–<lpage>164</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Muchmore1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muchmore</surname><given-names>SW</given-names></name>, <name name-style="western"><surname>Sattler</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Liang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Meadows</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Harlan</surname><given-names>JE</given-names></name>, <etal>et al</etal>. (<year>1996</year>) <article-title>X-ray and NMR structure of human Bcl-xL, an inhibitor of programmed cell death</article-title>. <source>Nature</source> <volume>381</volume>: <fpage>335</fpage>–<lpage>341</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Collins1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Collins</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ling</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Carreno</surname><given-names>B</given-names></name> (<year>2005</year>) <article-title>The B7 family of immune-regulatory ligands</article-title>. <source>Genome Biology</source> <volume>6</volume>: <fpage>223</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Ikemizu1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ikemizu</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gilbert</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Fennelly</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Collins</surname><given-names>AV</given-names></name>, <name name-style="western"><surname>Harlos</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2000</year>) <article-title>Structure and dimerization of a soluble form of B7-1</article-title>. <source>Immunity</source> <volume>12</volume>: <fpage>51</fpage>–<lpage>60</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Stamper1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stamper</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Tobin</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Erbe</surname><given-names>DV</given-names></name>, <name name-style="western"><surname>Ikemizu</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Crystal structure of the B7-1/CTLA-4 complex that inhibits human immune responses</article-title>. <source>Nature</source> <volume>410</volume>: <fpage>608</fpage>–<lpage>611</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Sayers1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sayers</surname><given-names>EW</given-names></name>, <name name-style="western"><surname>Barrett</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Benson</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Bolton</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Bryant</surname><given-names>SH</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Database resources of the National Center for Biotechnology Information</article-title>. <source>Nucleic Acids Research</source> <volume>40</volume>: <fpage>D13</fpage>–<lpage>D25</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Guindon1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Guindon</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gascuel</surname><given-names>O</given-names></name> (<year>2003</year>) <article-title>A simple, fast, and accurate algorithm to estimate large phylogenies by maximum likelihood</article-title>. <source>Systematic Biology</source> <volume>52</volume>: <fpage>696</fpage>–<lpage>704</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Peach1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peach</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Bajorath</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Naemura</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Leytze</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Greene</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>1995</year>) <article-title>Both extracellular immunoglobin-like domains of cd80 contain residues critical for binding t cell surface receptors CTLA-4 and CD28</article-title>. <source>Journal of Biological Chemistry</source> <volume>270</volume>: <fpage>21181</fpage>–<lpage>21187</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Yokoyama1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yokoyama</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Tada</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Britt</surname><given-names>L</given-names></name> (<year>2008</year>) <article-title>Elucidation of phenotypic adaptations: Molecular analyses of dim-light vision proteins in vertebrates</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>105</volume>: <fpage>13480</fpage>–<lpage>13485</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Vanhatalo1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vanhatalo</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Vehtari</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>Sparse log Gaussian processes via MCMC for spatial epidemiology</article-title>. <source>Journal of Machine Learning Research - Proceedings Track</source> <volume>1</volume>: <fpage>73</fpage>–<lpage>89</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Robinson1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>DT</given-names></name>, <name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Thorne</surname><given-names>JL</given-names></name> (<year>2003</year>) <article-title>Protein evolution with depen- dence among codons due to tertiary structure</article-title>. <source>Molecular Biology and Evolution</source> <volume>20</volume>: <fpage>1692</fpage>–<lpage>1704</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Rodrigue1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rodrigue</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Bryant</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name> (<year>2005</year>) <article-title>Site interdependence attributed to tertiary structure in amino acid sequence evolution</article-title>. <source>Gene</source> <volume>347</volume>: <fpage>207</fpage>–<lpage>217</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Rodrigue2"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rodrigue</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name> (<year>2006</year>) <article-title>Assessing site-interdependent phylogenetic models of sequence evolution</article-title>. <source>Molecular Biology and Evolution</source> <volume>23</volume>: <fpage>1762</fpage>–<lpage>1775</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Conant1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Conant</surname><given-names>GC</given-names></name>, <name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name> (<year>2009</year>) <article-title>Solvent exposure imparts similar selective pressures across a range of yeast proteins</article-title>. <source>Molecular Biology and Evolution</source> <volume>26</volume>: <fpage>1155</fpage>–<lpage>1161</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Meyer1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname><given-names>AG</given-names></name>, <name name-style="western"><surname>Wilke</surname><given-names>CO</given-names></name> (<year>2013</year>) <article-title>Integrating sequence variation and protein structure to identify sites under selection</article-title>. <source>Molecular Biology and Evolution</source> <volume>30</volume>: <fpage>36</fpage>–<lpage>44</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Meyer2"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname><given-names>AG</given-names></name>, <name name-style="western"><surname>Dawson</surname><given-names>ET</given-names></name>, <name name-style="western"><surname>Wilke</surname><given-names>CO</given-names></name> (<year>2013</year>) <article-title>Cross-species comparison of site-specific evolutionary-rate variation in influenza haemagglutinin</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>368</volume>: <fpage>20120334</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Siepel1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Siepel</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name> (<year>2004</year>) <article-title>Combining phylogenetic and hidden markov models in biosequence analysis</article-title>. <source>Journal of Computational Biology</source> <volume>11</volume>: <fpage>413</fpage>–<lpage>428</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Yang2"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name> (<year>1995</year>) <article-title>A space-time process model for the evolution of DNA sequences</article-title>. <source>Genetics</source> <volume>139</volume>: <fpage>993</fpage>–<lpage>1005</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Felsenstein2"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Churchill</surname><given-names>GA</given-names></name> (<year>1996</year>) <article-title>A hidden Markov model approach to variation among sites in rate of evolution</article-title>. <source>Molecular Biology and Evolution</source> <volume>13</volume>: <fpage>93</fpage>–<lpage>104</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Siepel2"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Siepel</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Bejerano</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Pedersen</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Hinrichs</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Hou</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Evolutionarily conserved elements in vertebrate, insect, worm, and yeast genomes</article-title>. <source>Genome Research</source> <volume>15</volume>: <fpage>1034</fpage>–<lpage>1050</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Siepel3"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Siepel</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Pollard</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name> (<year>2006</year>) <article-title>New methods for detecting lineage-specific selection</article-title>. <source>Lecture Notes in Computer Science</source> <volume>3909</volume>: <fpage>190</fpage>–<lpage>205</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Mayrose2"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mayrose</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Doron-Faigenboim</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Bacharach</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Pupko</surname><given-names>T</given-names></name> (<year>2007</year>) <article-title>Towards realistic codon models: among site variability and dependency of synonymous and non-synonymous rates</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>i319</fpage>–<lpage>i327</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-DeMaio1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>De Maio</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Schltterer</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Kosiol</surname><given-names>C</given-names></name> (<year>2013</year>) <article-title>Estimating empirical codon hidden markov models</article-title>. <source>Molecular Biology and Evolution</source> <volume>30</volume>: <fpage>725</fpage>–<lpage>736</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Yang3"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name> (<year>2007</year>) <article-title>PAML 4: Phylogenetic analysis by maximum likelihood</article-title>. <source>Molecular Biology and Evolution</source> <volume>24</volume>: <fpage>1586</fpage>–<lpage>1591</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Huelsenbeck1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name> (<year>2007</year>) <article-title>A nonparametric method for accommodating and testing across-site rate variation</article-title>. <source>Systematic Biology</source> <volume>56</volume>: <fpage>975</fpage>–<lpage>987</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Neal1"><label>56</label>
<mixed-citation publication-type="other" xlink:type="simple">Neal R (1997) Monte Carlo implementation of Gaussian process models for Bayesian regression and classification. Technical report, University of Toronto.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Press1"><label>57</label>
<mixed-citation publication-type="other" xlink:type="simple">Press W, Teukolsky S, Vetterling W, Flannery B (1992) Numerical Recipes in C. Cambridge University Press, 2nd edition.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Neal2"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neal</surname><given-names>R</given-names></name> (<year>1999</year>) <article-title>Regression and classification using Gaussian process priors</article-title>. <source>Bayesian Statistics</source> <volume>6</volume>: <fpage>475</fpage>–<lpage>501</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003429-Jmol1"><label>59</label>
<mixed-citation publication-type="other" xlink:type="simple">Jmol: an open-source Java viewer for chemical structures in 3D. <ext-link ext-link-type="uri" xlink:href="http://www.jmol.org/" xlink:type="simple">http://www.jmol.org/</ext-link>.</mixed-citation>
</ref>
</ref-list></back>
</article>