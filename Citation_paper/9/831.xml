<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-13-05513</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0072043</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Natural selection</subject></subj-group></subj-group></subj-group><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject><subj-group><subject>Natural selection</subject></subj-group></subj-group><subj-group><subject>Population genetics</subject><subj-group><subject>Natural selection</subject></subj-group></subj-group><subj-group><subject>Evolutionary theory</subject></subj-group></subj-group><subj-group><subject>Genetics</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Natural selection</subject></subj-group></subj-group></subj-group><subj-group><subject>Population biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Natural selection</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Complex systems</subject><subject>Game theory</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Altruism Can Proliferate through Population Viscosity despite High Random Gene Flow</article-title>
<alt-title alt-title-type="running-head">Altruism Can Proliferate despite High Gene Flow</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Schonmann</surname><given-names>Roberto H.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Vicente</surname><given-names>Renato</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Caticha</surname><given-names>Nestor</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Mathematics, University of California Los Angeles, Los Angeles, California, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Applied Mathematics, Instituto de Matemática e Estatstica, Universidade de São Paulo, São Paulo, SP, Brazil</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Departamento de Física Geral, Instituto de Física, Universidade de São Paulo, São Paulo, SP, Brazil</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Najmanovich</surname><given-names>Rafael Josef</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Universite de Sherbrooke, Canada</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">rhs@math.ucla.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: RHS RV NC. Performed the experiments: RV. Analyzed the data: RHS RV NC. Contributed reagents/materials/analysis tools: RV NC. Wrote the paper: RHS.</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>19</day><month>8</month><year>2013</year></pub-date>
<volume>8</volume>
<issue>8</issue>
<elocation-id>e72043</elocation-id>
<history>
<date date-type="received"><day>5</day><month>2</month><year>2013</year></date>
<date date-type="accepted"><day>5</day><month>7</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Schonmann et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>The ways in which natural selection can allow the proliferation of cooperative behavior have long been seen as a central problem in evolutionary biology. Most of the literature has focused on interactions between pairs of individuals and on linear public goods games. This emphasis has led to the conclusion that even modest levels of migration would pose a serious problem to the spread of altruism through population viscosity in group structured populations. Here we challenge this conclusion, by analyzing evolution in a framework which allows for complex group interactions and random migration among groups. We conclude that contingent forms of strong altruism that benefits equally all group members, regardless of kinship and without greenbeard effects, can spread when rare under realistic group sizes and levels of migration, due to the assortment of genes resulting only from population viscosity. Our analysis combines group-centric and gene-centric perspectives, allows for arbitrary strength of selection, and leads to extensions of Hamilton’s rule for the spread of altruistic alleles, applicable under broad conditions.</p>
</abstract>
<funding-group><funding-statement>This project was partially supported by CNPq, under grant 480476/2009-8 and by the Center for Natural and Artificial Information Processing Systems of the University of São Paulo (NAP CNAIPS-USP). No additional external funding has been received for this study. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="10"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>The evolution of cooperation and altruism are fundamental scientific challenges highlighted by their role in the major transitions in life’s history, when natural selection acted simultaneously on several competing levels <xref ref-type="bibr" rid="pone.0072043-MaynardSmith1">[1]</xref>–<xref ref-type="bibr" rid="pone.0072043-Bourke1">[8]</xref>. In this context, the relevance of basic concepts, including group selection and Hamilton’s rule remain controversial <xref ref-type="bibr" rid="pone.0072043-Wilson1">[9]</xref>–<xref ref-type="bibr" rid="pone.0072043-Simon1">[18]</xref>. Here we address these problems by studying a framework for evolution in group structured populations that incorporates inter- and intra-group competition and migration. Combining group-centric with gene-centric perspectives in a constructive group/kin selection approach, we build methodology that allows for the analysis of arbitrary non-linear fitness functions, resulting from complex multi-individual interactions across life cycles. We obtain the conditions for a rare social allele to invade the population. This is obtained in a mathematically rigorous way, by analyzing the stability of the equilibrium in which this allele is absent. This analysis is done for arbitrary strength of selection, but when selection is weak and groups are large the condition for invasion simplifies significantly into a form that is easy to apply and provides substantial intuition. In the case of linear fitness functions, the condition for invasion is identical to Hamilton’s rule, and it is natural to regard the more general non-linear cases as generalizations of that rule. Our results also show that one of the most widely used approaches to analyzing kin selection models, <xref ref-type="bibr" rid="pone.0072043-Taylor1">[19]</xref>, <xref ref-type="bibr" rid="pone.0072043-Wenseleers1">[7]</xref>(condition (6.7)), and <xref ref-type="bibr" rid="pone.0072043-Gardner1">[16]</xref>(Box 6), yields incorrect results in some biologically relevant situations.</p>
<p>Our results reveal conditions that are biologically realistic and under which altruism can evolve when rare even with modest genetic relatedness in groups, without kin recognition or greenbeard effects (the altruistic acts benefit all group members equally). In this way we challenge a common understanding according to which inter-group selection favoring altruism could only override intra-group selection favoring selfishness under exceptional conditions, namely small group size and very low migration rates <xref ref-type="bibr" rid="pone.0072043-Leigh1">[13]</xref>, <xref ref-type="bibr" rid="pone.0072043-West2">[17]</xref>, <xref ref-type="bibr" rid="pone.0072043-MaynardSmith2">[20]</xref>–<xref ref-type="bibr" rid="pone.0072043-MaynardSmith4">[28]</xref>. The issue is illustrated by quoting from the recent review <xref ref-type="bibr" rid="pone.0072043-Leigh1">[13]</xref>, p.12: “For group selection to overcome selection within groups, less than one succesfully reproducing migrant may be exchanged per two populations per population lifetime.” The fact that this idea is still incorporated in mainstream evolutionary biology is illustrated by the theoretical considerations on pp. 11, 12 of the influential recent textbook <xref ref-type="bibr" rid="pone.0072043-Davies1">[29]</xref>, where one reads: “[…] for group selection to work populations must be isolated, such that individuals cannot migrate among them. Otherwise there would be nothing to stop the migration of selfish individuals […]. Once selfish individuals arrive, their genotype would soon spread. In nature groups are rarely isolated sufficiently to prevent such immigration.”</p>
<p>We identify the emphasis on linear public goods games in the literature, including most of the papers quoted in the previous paragraph, as having supported this belief in exceptionality. For these games, the condition for altruism to proliferate is Hamilton’s classical rule, requiring the relatedness in groups to exceed the ratio of cost to benefit for each altruistic act. Therefore, in this setting, altruism can only spread when either relatedness is large, or the cost/benefit ratio is low. And since relatedness is often low <xref ref-type="bibr" rid="pone.0072043-MaynardSmith4">[28]</xref> (Table 8.3), <xref ref-type="bibr" rid="pone.0072043-Bowles1">[30]</xref>, <xref ref-type="bibr" rid="pone.0072043-Hartl1">[31]</xref> (Tables 6.4 and 6.5), <xref ref-type="bibr" rid="pone.0072043-Bowles2">[32]</xref>, <xref ref-type="bibr" rid="pone.0072043-Hamilton2">[33]</xref> (Table 4.9), exceptionally low cost/benefit ratios are required, as observed for instance in <xref ref-type="bibr" rid="pone.0072043-Refard1">[34]</xref>. In the absence of reasons to expect low cost/benefit ratios to be common, researchers whose intuition is molded by the linear public goods game are naturally led to the belief that altruism could only spread through population viscosity in exceptional cases.</p>
<p>In contrast, we show that for iterated public goods games, in which altruists cooperate or not in each round based on previous outcomes <xref ref-type="bibr" rid="pone.0072043-Joshi1">[35]</xref>, <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref>, altruism can spread even when cost/benefit ratios for each altruistic act are reasonably high, groups are large, selection is weak and migration rates are substantially larger than the inverse of group size (high gene flow, realistically low relatedness). This result corrects <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref>, who predicted that large group size would not allow cooperation to spread when rare in this model. For species that live in groups, several vital group activities repeat themselves periodically and behavior changes as feedback is obtained from previous iterations. The iterated public goods game that we study is therefore often more realistic than a simple one shot public goods game. A proper analysis of this model fills therefore an important gap in the literature. (To illustrate the fact that the incorrect conclusion from <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref> is still incorporated in the literature, we refer the reader to, e.g., Section 4.5 of the textbook <xref ref-type="bibr" rid="pone.0072043-McElreath1">[37]</xref> and p. 359 of the very recent textbook <xref ref-type="bibr" rid="pone.0072043-Davies1">[29]</xref>).</p>
<p>To obtain our result in the case of weak selection and large groups we show that in the absence of selection, when groups are large, the fraction of group members that are close relatives of a randomly chosen individual has a non-Gaussian distribution with a fatter tail. As a consequence, even when altruistic alleles are rare in the population, they have a significant probability of concentrating in some groups, accruing substantial reproductive gains through multi-individual synergy.</p>
<sec id="s1a">
<title>The Two-Level Fisher-Wright Framework</title>
<p>When members of a species live in groups, their reproductive success depends on the behavior of all group members. More efficient groups may grow faster and split, outcompeting the less efficient ones that die out. On the other hand, individuals may free ride on the cooperation of other members of their group, and in this way outcompete them. This picture is further complicated by migration among groups. The <italic>Two-level Fisher-Wright framework with selection and migration</italic> (2lFW) captures all these elements, in a simplified fashion. (In the last two paragraphs of this section we explain how it relates to the trait group framework and budding-viscosity models.) In 2lFW haploid individuals live in a large number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e001" xlink:type="simple"/></inline-formula> of groups of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e002" xlink:type="simple"/></inline-formula>, and are of two genetically determined phenotypic types, A or N. Generations do not overlap, reproduction is asexual and the type is inherited by the offspring (mutations will be considered briefly later). The relative fitness (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e003" xlink:type="simple"/></inline-formula>) of a type A, and that of a type N, in a group that has <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e004" xlink:type="simple"/></inline-formula> types A, are, respectively, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e005" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e006" xlink:type="simple"/></inline-formula> with the convention that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e007" xlink:type="simple"/></inline-formula>, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e008" xlink:type="simple"/></inline-formula>. The quantities <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e010" xlink:type="simple"/></inline-formula> represent life-cycle payoffs derived from behavior, physiology, etc. The parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e011" xlink:type="simple"/></inline-formula> indicates the strength of selection. <xref ref-type="fig" rid="pone-0072043-g001">Figure 1</xref> describes the creation of a new generation in the 2lFW through inter- and intra- group competition, followed by migration at rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e012" xlink:type="simple"/></inline-formula>.</p>
<fig id="pone-0072043-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0072043.g001</object-id><label>Figure 1</label><caption>
<title>Diagram of the 2lFW process.</title>
<p><bold>(Left) FW intergroup competition:</bold> Each group in the new generation independently descends from a group in the previous generation, with probabilities proportional to group average fitness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e013" xlink:type="simple"/></inline-formula> <bold>(Center) FW Intragroup competition:</bold> If a group descends from a group with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e014" xlink:type="simple"/></inline-formula> types A, then it will have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e015" xlink:type="simple"/></inline-formula> types A with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e016" xlink:type="simple"/></inline-formula> where the binomial probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e017" xlink:type="simple"/></inline-formula> is the probability of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e018" xlink:type="simple"/></inline-formula> successes in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e019" xlink:type="simple"/></inline-formula> independent trials, each with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e020" xlink:type="simple"/></inline-formula> of success. <bold>(Right) Migration:</bold> Once the new <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e021" xlink:type="simple"/></inline-formula> groups have been formed according to the two-level competition process, a random fraction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e022" xlink:type="simple"/></inline-formula> of the individuals migrates. Migrants are randomly shuffled. <bold>Note:</bold> The assignment of relative fitness to the groups in the fashion done above is a necessary and sufficient condition <xref ref-type="bibr" rid="pone.0072043-Kerr2">[68]</xref> for individuals in the parental generation to have each an expected number of offspring proportional to their personal relative fitness.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0072043.g001" position="float" xlink:type="simple"/></fig>
<p>Cases in which types A behave in some altruistic fashion are of particular interest <xref ref-type="bibr" rid="pone.0072043-Kerr1">[38]</xref>. Most of the literature concerns the very special case of a <italic>linear</italic> public goods game (PG), defined by<disp-formula id="pone.0072043.e023"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e023" xlink:type="simple"/></disp-formula><disp-formula id="pone.0072043.e024"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e024" xlink:type="simple"/></disp-formula>with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e025" xlink:type="simple"/></inline-formula>, in which each type A cooperates, at a cost <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e026" xlink:type="simple"/></inline-formula> to herself, providing a benefit <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e027" xlink:type="simple"/></inline-formula> shared by the other members of her group. The need to consider more complex intra-group interactions and non-linear payoff functions is, nevertheless, well known <xref ref-type="bibr" rid="pone.0072043-West1">[10]</xref>, <xref ref-type="bibr" rid="pone.0072043-Nowak2">[14]</xref>, <xref ref-type="bibr" rid="pone.0072043-Bowles1">[30]</xref>, <xref ref-type="bibr" rid="pone.0072043-Joshi1">[35]</xref>, <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref>, <xref ref-type="bibr" rid="pone.0072043-Kokko1">[39]</xref>–<xref ref-type="bibr" rid="pone.0072043-Boyd2">[49]</xref>. Non-linearities appear naturally whenever activities involve many group members simultaneously. They result from threshold phenomena, increasing returns to scale, saturation, etc. For instance, to hunt large prey may require a large minimum number of hunters, the likelihood of success may first increase rapidly with the number of hunters, but it may plateau when this number becomes very large. Allowing for the analysis of such synergistic multi-individual interactions and activities is a central feature of our approach, distinguishing it from theoretical frameworks based on pairwise interactions, or single actors benefiting a group <xref ref-type="bibr" rid="pone.0072043-Lehmann1">[4]</xref>, <xref ref-type="bibr" rid="pone.0072043-Queller1">[50]</xref>, <xref ref-type="bibr" rid="pone.0072043-Lehmann2">[51]</xref>.</p>
<p>The 2lFW framework can be seen as a generalization of the trait-group framework (see Sec. 2.3.2 of <xref ref-type="bibr" rid="pone.0072043-Okasha1">[5]</xref>), which corresponds to the case <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e028" xlink:type="simple"/></inline-formula>. One can interpret <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e029" xlink:type="simple"/></inline-formula> as a viscosity, or an assortment parameter. Because migration is completely random in 2lFW, this assortment represents a worst case scenario, abstracting away additional assortment caused by kin recognition, greenbeard effects, selective acceptance of migrants, joint migration of individuals, etc. We notice that, according to <xref ref-type="bibr" rid="pone.0072043-Mayo1">[52]</xref>, the 2lFW can be classified as a Type II group selection model, as the intergroup competition component qualifies as an explicit group level event that is absent in a trait-group model. It is well known <xref ref-type="bibr" rid="pone.0072043-Joshi1">[35]</xref>, <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref>, <xref ref-type="bibr" rid="pone.0072043-Archetti1">[43]</xref> that even when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e030" xlink:type="simple"/></inline-formula> non-linearities in fitness functions allow for coexistence of cooperators and defectors. But under the strong altruism condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e031" xlink:type="simple"/></inline-formula> (meaning that each type A would be better off mutating into a type N), this is not the case <xref ref-type="bibr" rid="pone.0072043-Kerr1">[38]</xref>, <xref ref-type="bibr" rid="pone.0072043-Matessi1">[53]</xref>. One of our goals is to determine the level of migration compatible with invasion by rare strong altruists.</p>
<p>The model with the population structure of 2lFW and PG payoffs was studied in <xref ref-type="bibr" rid="pone.0072043-Gardner2">[54]</xref> with the name “budding-viscosity model”. But, as the authors explained on p.1714, this name may not be appropriate in some applications. We propose the name “two-level Fisher-Wright framework with selection and migration” to denote a mathematical structure applicable to several demographic/reproductive biological systems, including group fissioning and budding, and admitting arbitrary payoff functions. This name also emphasizes that selection occurs at the individual and the group levels. In <xref ref-type="bibr" rid="pone.0072043-Gardner2">[54]</xref> motivation for the population structure is discussed in detail, references to previous work leading to it are provided (notably <xref ref-type="bibr" rid="pone.0072043-Goodnight1">[55]</xref>) and an explanation of how it allows viscosity to increase relatedness without increasing in the same measure the competition among relatives (as is the case in an island model with inelastic group size <xref ref-type="bibr" rid="pone.0072043-Taylor2">[56]</xref>) is presented. The analysis in <xref ref-type="bibr" rid="pone.0072043-Gardner2">[54]</xref> relied on the assumptions of PG payoffs and weak selection (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e032" xlink:type="simple"/></inline-formula>). The paper <xref ref-type="bibr" rid="pone.0072043-Lehmann3">[57]</xref> provides an alternative analysis, which depends on the same strong assumptions, in the section called “typical kin selection model”. This paper was a response to <xref ref-type="bibr" rid="pone.0072043-Trausen1">[58]</xref>, where group selection was argued to be an important mechanism for the evolution of cooperation, and a multilevel selection model based on Moran’s model was introduced. In <xref ref-type="bibr" rid="pone.0072043-Lehmann3">[57]</xref> it was argued that kin selection is a better tool for studying evolution in group structured populations. In the context of this debate, our analysis of 2lFW with non-linear fitness functions highlights the importance of combining group-centric with gene-centric perspectives, and shows that group selection can be an important force in evolution under realistic conditions. It also shows that mathematically rigorous analysis can be carried out, to a large extent, even when selection is strong, fitness functions are non-linear and migration rates are arbitrary. And it shows that one has to be very careful in applying mathematically non-rigorous methodology, as it can produce substantially incorrect results, even when selection is weak. We will see this when we observe that methods based on the approximation of regression coefficients by partial derivatives lead to such incorrect results in important examples.</p>
</sec></sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>A Basic Example: Iterated Public Goods Game</title>
<p>Non-linearities in life-cycle payoffs can result from activities repeating themselves during a lifetime, and behavior being contingent on previous outcomes. A basic example is the iterated public goods game (IPG) <xref ref-type="bibr" rid="pone.0072043-Joshi1">[35]</xref>, <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref>. In IPG a PG is repeated an average of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e033" xlink:type="simple"/></inline-formula> times in a life-cycle. We will suppose that types N never cooperate, while types A cooperate in the first round and later cooperate only if at least a fraction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e034" xlink:type="simple"/></inline-formula> of group members cooperated in the previous round. The payoffs (see Figure S1 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>) are, therefore, given by<disp-formula id="pone.0072043.e035"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e035" xlink:type="simple"/></disp-formula><disp-formula id="pone.0072043.e036"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e036" xlink:type="simple"/></disp-formula>for constants <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e037" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e038" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e039" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e040" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e041" xlink:type="simple"/></inline-formula> are costs and benefits in each iteration). Mathematically, this model generalizes the iterated prisoner dilemma and tit-for-tat, from the dyadic setting of <xref ref-type="bibr" rid="pone.0072043-Trivers1">[59]</xref> and <xref ref-type="bibr" rid="pone.0072043-Axelrod1">[60]</xref> to the multi-individual setting. But while direct or indirect reciprocity requires the identification of individuals in the group, this is not the case here. The behavior of types A in the IPG can be triggered by individuals simply discontinuing cooperative behavior when previous cooperation produced negative feedback to them, for instance, when they received a negative payoff. In other words, allele A can predispose individuals to cooperate, but as they do it and obtain feedback from that behavior, they may continue it or discontinue it. The IPG is in this sense closely related to generalized reciprocity mechanisms <xref ref-type="bibr" rid="pone.0072043-Rutte1">[61]</xref>, <xref ref-type="bibr" rid="pone.0072043-Rankin1">[62]</xref> with low cognitive requirements. (In generalized reciprocity models individuals interact in pairs, and generalized reciprocators help any other member of the group, but only in the first iteration, or when they were helped by some group member in the previous iteration. In contrast, in the IPG the actions involve several individuals simultaneously, but as in generalized reciprocity, individuals react to their own previous experience, without having to remember who did what.) Negative feedback from cooperation should occur if the fraction of group members that cooperated was less than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e042" xlink:type="simple"/></inline-formula>, but not if it was larger than that threshold, since in the former case the payoff to a cooperator is negative, while in the latter case it is positive. This gives a special role to the value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e043" xlink:type="simple"/></inline-formula>.</p>
<p>When are types A altruistic in the IPG? There is more than one way in which the concept of altruism in the context of the trait-group framework has been defined <xref ref-type="bibr" rid="pone.0072043-Kerr1">[38]</xref>. These different definitions carry over to the 2lFW. A particularly simple concept is called in <xref ref-type="bibr" rid="pone.0072043-Kerr1">[38]</xref> the “multilevel interpretation” of altruism. That definition requires the two conditions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e044" xlink:type="simple"/></inline-formula>, for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e045" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e046" xlink:type="simple"/></inline-formula> increasing in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e047" xlink:type="simple"/></inline-formula>. The first one means that types A are always worse off than types N in the same group, and the second one means that the more types A in a group, the better for the group. Both conditions are clearly always satisfied in the IPG.</p>
<p>There are nevertheless good arguments for considering other definitions of altruism <xref ref-type="bibr" rid="pone.0072043-Kerr1">[38]</xref>. A particularly appealing definition is called “focal-complement interpretation” in <xref ref-type="bibr" rid="pone.0072043-Kerr1">[38]</xref>, and is often known as “mutation condition”, or “strong altruism”. Suppose that a type N mutated into a type A, everything else remaining unchanged. Would this cause a decrease in the fitness of the mutant? Would it cause an increase in the average fitness of the other members of the mutant’s group? Since the average fitness of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e048" xlink:type="simple"/></inline-formula> members of the mutant’s group increases with the mutation, the answer to the second question will be affirmative whenever the answer to the first question is affirmative. Therefore the condition for types A to be strongly altruistic is that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e049" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e050" xlink:type="simple"/></inline-formula>. In <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> (Section S8, last subsection) this condition is shown to be satisfied when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e051" xlink:type="simple"/></inline-formula> and to fail otherwise.</p>
<p>To sum up, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e052" xlink:type="simple"/></inline-formula>, the behavior of types A is altruistic in the strong sense that each type A individual would increase its fitness if it behaved as a type N, everything else being equal, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e053" xlink:type="simple"/></inline-formula>. Moreover, types N always free ride and have greater fitness than types A in the same group, regardless of the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e054" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e055" xlink:type="simple"/></inline-formula>, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e056" xlink:type="simple"/></inline-formula>.</p>
<p><xref ref-type="fig" rid="pone-0072043-g002">Figure 2</xref> displays a detailed analysis of some instances of the IPG, giving conditions for allele A to spread when rare (In this figure, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e057" xlink:type="simple"/></inline-formula>, so that, in particular, types A are strongly altruistic). For many species that live and interact in groups for many years, several vital activities, including collective hunting and food sharing, can repeat themselves hundreds or thousands of times in a life-cycle, giving plausibility to the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e058" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pone-0072043-g002">Figure 2</xref>. The assumption that individuals discontinue behavior after a single unsuccessful participation is a simplification. When this is not a realistic assumption, we can, however, interpret the parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e059" xlink:type="simple"/></inline-formula> as the ratio between the typical number of repetitions of the activity and the typical number of unsuccessful attempts before cooperation is discontinued by a type A.</p>
<fig id="pone-0072043-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0072043.g002</object-id><label>Figure 2</label><caption>
<title>Iterated public goods game (IPG).</title>
<p>A public goods game (PG) is repeated an average of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e060" xlink:type="simple"/></inline-formula> times in a life-cycle. In each round each individual can cooperate at a cost <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e061" xlink:type="simple"/></inline-formula> to herself, producing a benefit <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e062" xlink:type="simple"/></inline-formula> shared by the other members of the group. Types N never cooperate, while types A cooperate in the first round and later cooperate only if at least a fraction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e063" xlink:type="simple"/></inline-formula> of group members cooperated in the previous round. In all panels <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e064" xlink:type="simple"/></inline-formula> (types A are strongly altruistic) and curves correspond to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e065" xlink:type="simple"/></inline-formula> (black, this case is identical to PG), 10 (blue), 100 (magenta), 1000 (green) (bottom to top in Panel A, top to bottom in Panels B and C). <bold>Panel A:</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e066" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e067" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e068" xlink:type="simple"/></inline-formula>. Curves give the critical migration rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e069" xlink:type="simple"/></inline-formula> below which types A proliferate when rare, and that solves <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e070" xlink:type="simple"/></inline-formula>, or equivalently <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e071" xlink:type="simple"/></inline-formula> in (1). (The subscript ‘s’ stands for ‘survival’.) The dependence of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e072" xlink:type="simple"/></inline-formula> on the strength of selection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e073" xlink:type="simple"/></inline-formula> indicates the relevance of studying both weak and strong selection. Short horizontal red lines indicate value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e074" xlink:type="simple"/></inline-formula> under weak selection, obtained from setting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e075" xlink:type="simple"/></inline-formula> in (2) (note the excellent agreement). <bold>Panel B:</bold> Again, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e076" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e077" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e078" xlink:type="simple"/></inline-formula>. Curves give the critical relatedness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e079" xlink:type="simple"/></inline-formula> above which types A proliferate. Here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e080" xlink:type="simple"/></inline-formula> is the relatedness obtained from neutral genetic markers. Short horizontal red lines are again from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e081" xlink:type="simple"/></inline-formula> in (2). <bold>Panel C:</bold> Limit of large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e082" xlink:type="simple"/></inline-formula> under weak selection. Critical values of relatedness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e083" xlink:type="simple"/></inline-formula>, as function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e084" xlink:type="simple"/></inline-formula>. Solid lines provide the solution to the equation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e085" xlink:type="simple"/></inline-formula> derived from setting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e086" xlink:type="simple"/></inline-formula> in (3). Dashed lines give its approximation (5). Red vertical line corresponds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e087" xlink:type="simple"/></inline-formula>, while horizontal red lines are at the same level of those from Panel B. Their intersections illustrate the fact that both the solid and dashed lines in Panel C are good approximations to weak-selection values of critical relatedness, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e088" xlink:type="simple"/></inline-formula>, when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e089" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0072043.g002" position="float" xlink:type="simple"/></fig>
<p>Panel C, in which selection is weak and groups are large, shows two important contrasting results. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e090" xlink:type="simple"/></inline-formula>, and the IPG is identical to the PG, allele A can only invade under Hamilton’s condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e091" xlink:type="simple"/></inline-formula>. But as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e092" xlink:type="simple"/></inline-formula> increases, the level of relatedness needed for invasion drops substantially, so that for modest values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e093" xlink:type="simple"/></inline-formula>, allele A can invade under <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e094" xlink:type="simple"/></inline-formula> significantly lower than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e095" xlink:type="simple"/></inline-formula>, compatible with levels observed in several species, including humans <xref ref-type="bibr" rid="pone.0072043-MaynardSmith4">[28]</xref> (Table 8.3), <xref ref-type="bibr" rid="pone.0072043-Bowles1">[30]</xref>, <xref ref-type="bibr" rid="pone.0072043-Hartl1">[31]</xref> (Tables 6.4 and 6.5), <xref ref-type="bibr" rid="pone.0072043-Bowles2">[32]</xref>, <xref ref-type="bibr" rid="pone.0072043-Hamilton2">[33]</xref> (Table 4.9). The corresponding number of migrants per group per generation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e096" xlink:type="simple"/></inline-formula>, can be of the order of 10. Further examples showing the spread of altruism and cooperation under high levels of gene flow and low levels of relatedness are provided in Figure S5, S6, S7 and S8, S20 and S21 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>.</p>
<p>The 2-player iterated prisoner dilemma has been analysed in detail in the literature, as reviewed, for instance in Chapter 4 of <xref ref-type="bibr" rid="pone.0072043-McElreath1">[37]</xref>. In this setting, when types N are defectors and types A play tit-for-tat, types A will not be able to invade when rare, if assortment is random (because then they are typically paired with defectors and lose in fitness to those by cooperating in the first iteration). A very modest level of relatedness is nevertheless sufficient to allow tit-for-tat to proliferate when rare, as computed in Section 4.1.2 of <xref ref-type="bibr" rid="pone.0072043-McElreath1">[37]</xref>. Our computations here provide similar results for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e097" xlink:type="simple"/></inline-formula>-player iterated public goods game and correct the computations in Section 4.5.1 of that text, which had indicated that types A would require very high levels of relatedness to invade. In <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> (Section S8, next to last subsection), we explain in detail what assumption in <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref>, reproduced in <xref ref-type="bibr" rid="pone.0072043-McElreath1">[37]</xref>, led to that incorrect conclusion.</p>
<p>It is important to also emphasize a relevant difference between tit-for-tat in 2-player iterated prisoner’s dilemmas and types A with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e098" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e099" xlink:type="simple"/></inline-formula>-player public goods games (as in <xref ref-type="fig" rid="pone-0072043-g002">Figure 2</xref>). The former can proliferate under random assortment provided that initially they are not very rare. This is so because, when common, tit-for-tat is not altruistic; cooperation in each iteration assures continuation of cooperation, and in the long run benefits the cooperator. In contrast, the latter is strongly altruistic in the sense that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e100" xlink:type="simple"/></inline-formula> and therefore never proliferates under random assortment (<xref ref-type="bibr" rid="pone.0072043-Matessi1">[53]</xref>, reviewed in <xref ref-type="bibr" rid="pone.0072043-Kerr1">[38]</xref>). In other words, while 2-player reciprocity is sometimes not altruistic, but rather cooperative, the behavior of types A that we are studying in <xref ref-type="fig" rid="pone-0072043-g002">Figure 2</xref>, is genuinely altruistic rather than simply cooperative.</p>
</sec><sec id="s2b">
<title>Condition for Invasion Under Strong Selection</title>
<p>To analyze the 2lFW, denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e101" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e102" xlink:type="simple"/></inline-formula> the fraction of groups in generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e103" xlink:type="simple"/></inline-formula> that have exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e104" xlink:type="simple"/></inline-formula> types A. Denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e105" xlink:type="simple"/></inline-formula> the frequency of types A in the population. The state of the population in generation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e106" xlink:type="simple"/></inline-formula> is described by the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e107" xlink:type="simple"/></inline-formula>, since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e108" xlink:type="simple"/></inline-formula>. We will suppose that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e109" xlink:type="simple"/></inline-formula>, so that, by the law of large numbers, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e110" xlink:type="simple"/></inline-formula> evolves as a deterministic (non-linear) dynamical system in dimension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e111" xlink:type="simple"/></inline-formula>. Here we will study its linearization close to the fixed point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e112" xlink:type="simple"/></inline-formula>, with no types A. This means that we are restricting ourselves to the case in which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e113" xlink:type="simple"/></inline-formula>, and studying the conditions for allele A to invade the population when rare. With the notation introduced in <xref ref-type="fig" rid="pone-0072043-g001">Fig. 1</xref>, we have then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e114" xlink:type="simple"/></inline-formula>, where<disp-formula id="pone.0072043.e115"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e115" xlink:type="simple"/></disp-formula><disp-formula id="pone.0072043.e116"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e116" xlink:type="simple"/></disp-formula><disp-formula id="pone.0072043.e117"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e117" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e118" xlink:type="simple"/></inline-formula> represents the binomial distribution with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e119" xlink:type="simple"/></inline-formula> trials with probability of success <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e120" xlink:type="simple"/></inline-formula> and we use the standard Kronecker notation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e121" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e122" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e123" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e124" xlink:type="simple"/></inline-formula>. Matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e125" xlink:type="simple"/></inline-formula> represents the production of groups in the new generation, through the two-level competition, prior to migration. Matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e126" xlink:type="simple"/></inline-formula> represents the effect of types A migrating out of groups, and matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e127" xlink:type="simple"/></inline-formula> represents the effect of these migrant types A joining groups that previous to migration had no types A. (Explanation for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e128" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e129" xlink:type="simple"/></inline-formula>: When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e130" xlink:type="simple"/></inline-formula>, the migrant types A are a small fraction of the migrant population, and therefore each one is likely to settle in a different group that had no types A before migration. A group that had <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e131" xlink:type="simple"/></inline-formula> types A prior to migration will therefore have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e132" xlink:type="simple"/></inline-formula> types A after migration with the probability given by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e133" xlink:type="simple"/></inline-formula> above. To understand the form of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e134" xlink:type="simple"/></inline-formula> now, note that such a group that had <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e135" xlink:type="simple"/></inline-formula> types A prior to migration will contribute an average of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e136" xlink:type="simple"/></inline-formula> migrant types A, who will therefore produce that same number of groups with exactly one type <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e137" xlink:type="simple"/></inline-formula> each.)</p>
<p>A standard application of the Perron-Frobenius Theorem (See Section 2 of <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>) implies that when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e138" xlink:type="simple"/></inline-formula>, we have, in good approximation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e139" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e140" xlink:type="simple"/></inline-formula> is a constant that depends on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e141" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e142" xlink:type="simple"/></inline-formula> is the leading eigenvalue of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e143" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e144" xlink:type="simple"/></inline-formula> is its corresponding left-eigenvector normalized as a probability vector. This means that, regardless of the initial distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e145" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e146" xlink:type="simple"/></inline-formula>, demographics and natural selection drive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e147" xlink:type="simple"/></inline-formula> towards multiples of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e148" xlink:type="simple"/></inline-formula>, in what can be seen as self-organization of copies of A in the optimal stable way for them to spread. Once this has happened, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e149" xlink:type="simple"/></inline-formula> grows at rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e150" xlink:type="simple"/></inline-formula>. Consequently, allele A will proliferate, when rare, if the <italic>viability condition</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e151" xlink:type="simple"/></inline-formula> holds, and it will vanish if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e152" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pone-0072043-g002">Figure 2</xref> and Sections S1 and S2 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> for applications and further explanations, see also Figure S2 to S9 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> for illustrations). When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e153" xlink:type="simple"/></inline-formula>, even if allele A is initially absent, a small rate of mutation will introduce it, allowing it to then invade the population. In the terminology of evolutionary game theory (see, e.g., <xref ref-type="bibr" rid="pone.0072043-MaynardSmith4">[28]</xref>(Chapter 7)), phenotype N is an evolutionary stable strategy (ESS) when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e154" xlink:type="simple"/></inline-formula> and N is not an ESS when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e155" xlink:type="simple"/></inline-formula>.</p>
<p>The viability condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e156" xlink:type="simple"/></inline-formula> has a gene-centric (kin-selection) interpretation in terms of average (neighbor modulated) fitnesses. For this purpose, define <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e157" xlink:type="simple"/></inline-formula>. Then it is well known that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e158" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e159" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e160" xlink:type="simple"/></inline-formula> are the average fitnesses of types A and N, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e161" xlink:type="simple"/></inline-formula> is the average fitness of all individuals. If we choose a random type A, it will have probability proportional to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e162" xlink:type="simple"/></inline-formula> of being in a group with exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e163" xlink:type="simple"/></inline-formula> types A (Bayesian sampling bias, reviewed in Section S3 of <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>). Therefore <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e164" xlink:type="simple"/></inline-formula>. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e165" xlink:type="simple"/></inline-formula>, if we choose a random individual, it is likely to be in a group with no types A. Therefore, in good approximation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e166" xlink:type="simple"/></inline-formula>. Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e167" xlink:type="simple"/></inline-formula> is driven towards multiples of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e168" xlink:type="simple"/></inline-formula>, we obtain.<disp-formula id="pone.0072043.e169"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e169" xlink:type="simple"/><label>(1)</label></disp-formula>provided <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e170" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e171" xlink:type="simple"/></inline-formula> (the error term is of order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e172" xlink:type="simple"/></inline-formula>+<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e173" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e174" xlink:type="simple"/></inline-formula>). The viability condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e175" xlink:type="simple"/></inline-formula> can also be stated as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e176" xlink:type="simple"/></inline-formula>, in (1). It is important to observe that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e177" xlink:type="simple"/></inline-formula> does not need to be monotone, and that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e178" xlink:type="simple"/></inline-formula> is the proper condition for invasion only when, as in (1), one is considering the stationary regime, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e179" xlink:type="simple"/></inline-formula>. (See Figures S10, S11, S12 and S13 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> for illustrations of the onset of this stationary regime.)</p>
</sec><sec id="s2c">
<title>Weak Selection</title>
<p>If selection is weak, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e180" xlink:type="simple"/></inline-formula>, migration acts much faster than selection, providing a separation of time scales <xref ref-type="bibr" rid="pone.0072043-Rousset1">[3]</xref>, <xref ref-type="bibr" rid="pone.0072043-Lehmann3">[57]</xref>, <xref ref-type="bibr" rid="pone.0072043-Roze1">[63]</xref>–<xref ref-type="bibr" rid="pone.0072043-Ohtsuki1">[65]</xref>. This allows us to replace <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e181" xlink:type="simple"/></inline-formula> in (1) with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e182" xlink:type="simple"/></inline-formula>, obtained by assuming <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e183" xlink:type="simple"/></inline-formula> within error of order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e184" xlink:type="simple"/></inline-formula> (see also Figure S15 and S16 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>). Defining now <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e185" xlink:type="simple"/></inline-formula>, allows us then to rewrite the neighbor modulated fitness relation (1) in the form<disp-formula id="pone.0072043.e186"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e186" xlink:type="simple"/><label>(2)</label></disp-formula>(within error term of order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e187" xlink:type="simple"/></inline-formula>). Algebraic simplifications (presented in Section S5 of <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>) transform the eigenvalue equation for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e188" xlink:type="simple"/></inline-formula> into the following equations for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e189" xlink:type="simple"/></inline-formula>:</p>
<p><disp-formula id="pone.0072043.e190"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e190" xlink:type="simple"/></disp-formula>with the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e191" xlink:type="simple"/></inline-formula> matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e192" xlink:type="simple"/></inline-formula> given by</p>
<p><disp-formula id="pone.0072043.e193"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e193" xlink:type="simple"/></disp-formula>Matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e194" xlink:type="simple"/></inline-formula> is a Markov transition matrix (i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e195" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e196" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e197" xlink:type="simple"/></inline-formula> is its invariant probability distribution (see Section S5 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> and Figure S17 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> for details). They have natural interpretations in terms of identity by descent (IBD) under neutral genetic drift, as we explain next when we provide a second, independent, derivation of (2). This derivation is gene-centered, and is more intuitive and simpler than the derivations in the previous section. But it relies heavily on the assumption that selection is weak.</p>
<p>Two individuals are said to be IBD if following their lineages back in time, they coalesce before a migration event affects either one (see Figure S14 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> for an illustration of the concept). The separation of time scales implies that when selection acts, the demographic distribution is well approximated by that obtained in equilibrium with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e198" xlink:type="simple"/></inline-formula>. This means that in good approximation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e199" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e200" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e201" xlink:type="simple"/></inline-formula> equilibrium probability that in the group of a randomly chosen focal type A there are exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e202" xlink:type="simple"/></inline-formula> types A (focal included). But because we are supposing that types A are rare, the only individuals that are type A in this group are those that are IBD to the focal, so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e203" xlink:type="simple"/></inline-formula> is also the probability that exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e204" xlink:type="simple"/></inline-formula> individuals in this group are IBD to the focal. As in the derivation of (1), since types A are rare, we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e205" xlink:type="simple"/></inline-formula> and hence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e206" xlink:type="simple"/></inline-formula>, which is (2).</p>
<p>Now, the probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e207" xlink:type="simple"/></inline-formula> that the focal is IBD to exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e208" xlink:type="simple"/></inline-formula> other members of her group is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e209" xlink:type="simple"/></inline-formula> if the focal is a migrant (probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e210" xlink:type="simple"/></inline-formula>), while if she is not a migrant (probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e211" xlink:type="simple"/></inline-formula>), then we have to consider how many individuals in her mother’s group were IBD to her mother. If, counting her mother, that number was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e212" xlink:type="simple"/></inline-formula> (probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e213" xlink:type="simple"/></inline-formula>, assuming demographic equilibrium) then the probability that the focal is IBD to exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e214" xlink:type="simple"/></inline-formula> other members of her group is equal to the probability that of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e215" xlink:type="simple"/></inline-formula> other members of her group, exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e216" xlink:type="simple"/></inline-formula> are non-migrants who chose for mother one of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e217" xlink:type="simple"/></inline-formula> candidates (among <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e218" xlink:type="simple"/></inline-formula> possibilities) that were IBD to the focal’s mother (probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e219" xlink:type="simple"/></inline-formula>). Combining these pieces, we have<disp-formula id="pone.0072043.e220"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e220" xlink:type="simple"/></disp-formula></p>
<p>This is exactly the same as the set of equations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e221" xlink:type="simple"/></inline-formula>.</p>
<p>The IBD distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e222" xlink:type="simple"/></inline-formula> contains all the relevant information about genetic relatedness in the groups, including and exceeding that given by the average relatedness between group members, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e223" xlink:type="simple"/></inline-formula> (see Figure S18 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>), obtained from lineages, regression coefficients, or Wright’s <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e224" xlink:type="simple"/></inline-formula> statistics. (See Sections S3 and S5 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> for a review on these alternative, equivalent, definitions of relatedness, and its computation.) Specifically, we can define <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e225" xlink:type="simple"/></inline-formula> as the probability that a second member chosen from the focal’s group is IBD to the focal and then obtain (from linearity of expected values) that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e226" xlink:type="simple"/></inline-formula> is a linear function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e227" xlink:type="simple"/></inline-formula>’s first moment. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e228" xlink:type="simple"/></inline-formula> is a non-linear function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e229" xlink:type="simple"/></inline-formula>, more information contained in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e230" xlink:type="simple"/></inline-formula>, including its higher moments, is needed to decide whether <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e231" xlink:type="simple"/></inline-formula> in (2). (In <xref ref-type="bibr" rid="pone.0072043-Gardner3">[66]</xref> the second moment of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e232" xlink:type="simple"/></inline-formula> was used to obtain conditions for invasion by rare greenbeards in an island population structure.) It is important to also stress that (2) can be easily used for applications in which even the knowledge of all the moments of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e233" xlink:type="simple"/></inline-formula> (see <xref ref-type="bibr" rid="pone.0072043-Roze1">[63]</xref>) would be cumbersome to apply, as for instance in the computation of the short horizontal red lines in <xref ref-type="fig" rid="pone-0072043-g002">Figure 2</xref>, Panels A and B.</p>
</sec><sec id="s2d">
<title>Large Groups Under Weak Selection</title>
<p>The stationarity condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e234" xlink:type="simple"/></inline-formula> allows for a recursive computation of all the moments of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e235" xlink:type="simple"/></inline-formula> (see Section S5 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>). These moments can then be used to show the powerful result that if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e236" xlink:type="simple"/></inline-formula> is large and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e237" xlink:type="simple"/></inline-formula> is small, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e238" xlink:type="simple"/></inline-formula>, when properly rescaled, is close to a beta distribution, with mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e239" xlink:type="simple"/></inline-formula> (see Section S6 and Figure S19 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>). In this case, if in addition to the assumption of weak selection, also <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e240" xlink:type="simple"/></inline-formula> is well approximated by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e241" xlink:type="simple"/></inline-formula>, for some piecewise continuous function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e242" xlink:type="simple"/></inline-formula>, then (2) takes the easy to apply form<disp-formula id="pone.0072043.e243"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e243" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e244" xlink:type="simple"/></inline-formula>. <xref ref-type="disp-formula" rid="pone.0072043.e169">Equations (1</xref>) and (3) play complementary roles in the analysis of 2lFW. Both provide the condition for invasion by allele A; (1) holds in full generality, while (3) requires special assumptions (small <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e245" xlink:type="simple"/></inline-formula>, large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e246" xlink:type="simple"/></inline-formula>), but is computationally much simpler and provides a great deal of intuition, as we discuss next.</p>
<p><xref ref-type="disp-formula" rid="pone.0072043.e243">Equation (3</xref>) should be contrasted with what <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref> predicted by supposing that the number of individuals in a group that are IBD to a focal individual would be well approximated by a binomial with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e247" xlink:type="simple"/></inline-formula> attempts and probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e248" xlink:type="simple"/></inline-formula> of success. That would lead to a normal distribution, narrowly concentrated close to its mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e249" xlink:type="simple"/></inline-formula>, in place of the beta distribution above. Our result reveals a strong dependency structure among lineages, producing the beta distribution, with a standard deviation comparable to its mean, and a tail that decays slowly compared to a Gaussian distribution. As a consequence, fitness functions that are large only when the fraction of types A in a group is above a threshold value, as in the IPG, will allow for proliferation of types A under levels of relatedness substantially lower than that predicted under the assumption in <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref> (for another example see also Section S7 and in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> and Figure S20 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>). We will refer to the fact that the fraction of group members that are IBD to a focal individual has a non-vanishing standard deviation, even when selection is weak and groups are large, as <italic>persistence of variability</italic>. This phenomenon poses a severe limitation to the applicability of covariance-regression methods in which regression of fitness on genotype is replaced with derivatives, as in <xref ref-type="bibr" rid="pone.0072043-Taylor1">[19]</xref>, <xref ref-type="bibr" rid="pone.0072043-Gardner1">[16]</xref>(Box 6), <xref ref-type="bibr" rid="pone.0072043-Wenseleers1">[7]</xref>(condition (6.7)). Both the assumptions in <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref>, or in <xref ref-type="bibr" rid="pone.0072043-Taylor1">[19]</xref> applied to the IPG would have implied incorrectly that when selection is weak and groups are large, types A could only invade the population when rare if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e250" xlink:type="simple"/></inline-formula> (these computations are presented in Sections S8 an S9 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>). In a companion paper <xref ref-type="bibr" rid="pone.0072043-McElreath1">[37]</xref> we show that methodologies in which one expresses the fitness of a focal individual in terms of partial derivatives with respect to the focal individual’s phenotype and the phenotype of the individuals with whom the focal interacts, as in <xref ref-type="bibr" rid="pone.0072043-Rousset1">[3]</xref>, <xref ref-type="bibr" rid="pone.0072043-Wenseleers1">[7]</xref>, <xref ref-type="bibr" rid="pone.0072043-Gardner1">[16]</xref>, <xref ref-type="bibr" rid="pone.0072043-Taylor1">[19]</xref>, <xref ref-type="bibr" rid="pone.0072043-Lehmann2">[51]</xref>, <xref ref-type="bibr" rid="pone.0072043-Lehmann3">[57]</xref>, require <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e251" xlink:type="simple"/></inline-formula> to be a linear function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e252" xlink:type="simple"/></inline-formula>.</p>
<p>For the PG, (2) and (3) clearly reduce to the well known <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e253" xlink:type="simple"/></inline-formula>. The same is also true for the more general (1), as was shown in <xref ref-type="bibr" rid="pone.0072043-Hamilton1">[22]</xref>, where in case of strong selection the relatedness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e254" xlink:type="simple"/></inline-formula> depends on the payoff functions. (The derivation in <xref ref-type="bibr" rid="pone.0072043-Hamilton1">[22]</xref> was based on the Price equation. An alternative derivation is provided in Section 4 of <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>.) In contrast, if we are under the conditions of (3) with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e255" xlink:type="simple"/></inline-formula>, then<disp-formula id="pone.0072043.e256"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e256" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e257" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e258" xlink:type="simple"/></inline-formula>-th moment of the beta distribution.</p>
<p>For the IPG, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e259" xlink:type="simple"/></inline-formula>, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e260" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e261" xlink:type="simple"/></inline-formula>, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e262" xlink:type="simple"/></inline-formula>. The viability condition derived from (3) can be analyzed in detail, by simple, but long, computations, presented in Section S8 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref> and illustrated by Figure S21–S26 in <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>. In the case <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e263" xlink:type="simple"/></inline-formula>, the viability condition reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e264" xlink:type="simple"/></inline-formula>. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e265" xlink:type="simple"/></inline-formula> is large, this yields the following approximation for the critical relatedness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e266" xlink:type="simple"/></inline-formula>:<disp-formula id="pone.0072043.e267"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e267" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p>If also <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e268" xlink:type="simple"/></inline-formula>, then<disp-formula id="pone.0072043.e269"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0072043.e269" xlink:type="simple"/><label>(6)</label></disp-formula></p>
<p>The simplicity and transparency of (5) and (6) illustrate the power of (3), and <xref ref-type="fig" rid="pone-0072043-g002">Fig. 2</xref> shows how well they compare to the more general, but less transparent (1). Note also how (5) and (6) provide a direct grasp on the effect of the number of repetitions in the game, and a nice comparison between the PG and the IPG. Both <xref ref-type="fig" rid="pone-0072043-g002">Figure 2</xref> and (6) show that alleles that promote contingent cooperative behavior, which is discontinued when participation is low, can spread under levels of genetic relatedness (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e270" xlink:type="simple"/></inline-formula>) more than 5 times smaller than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e271" xlink:type="simple"/></inline-formula>. This mechanism should, therefore, be seriously investigated as a possible route for the proliferation of altruistic/cooperative behavior.</p>
</sec><sec id="s2e">
<title>Conclusions</title>
<list list-type="order"><list-item>
<p>Natural selection in group structured populations is best analyzed by a combination of group-centric and gene-centric perspectives and methods. Both shed light, carry intuition and provide computational power, in different ways. For instance, in this paper the analysis of invasion under strong selection focused on groups, while that under weak selection focused on genes. Our computations indicate the advantage of a pluralistic group-centric/gene-centric approach over views that regard one of these two approaches as being redundant, less informative, or counterproductive. Contrast, on one hand, with, e.g., <xref ref-type="bibr" rid="pone.0072043-Nowak2">[14]</xref>, which to us seems excessively negative about the contributions of kin selection ideas. And contrast, on the other hand, with, e.g., Section 6.5 of <xref ref-type="bibr" rid="pone.0072043-West2">[17]</xref>, or the subsection on group selection in Chapter 15 of <xref ref-type="bibr" rid="pone.0072043-Davies1">[29]</xref>, which to us seem excessively negative about the contributions of group selection ideas).</p>
</list-item><list-item>
<p>Rigorous mathematical analysis of models is sometimes possible even when fitness functions are non-linear, selection is possibly strong, and the migration rate is arbitrary. And it is needed for assessing the validity of non-rigorous approaches, showing for instance that regression coefficients may be poorely approximated by partial derivatives, even when selection is weak. (Contrast with, e.g., <xref ref-type="bibr" rid="pone.0072043-Taylor1">[19]</xref>(from (1) to (2)), <xref ref-type="bibr" rid="pone.0072043-Lehmann2">[51]</xref>((3.4), (3.5)), <xref ref-type="bibr" rid="pone.0072043-Gardner1">[16]</xref>(Box 6), <xref ref-type="bibr" rid="pone.0072043-Wenseleers1">[7]</xref>(condition (6.7)).)</p>
</list-item><list-item>
<p>Hamilton’s condition for the spread of altruism, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e272" xlink:type="simple"/></inline-formula>, should be complemented with more general rules (like those obtained by setting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e273" xlink:type="simple"/></inline-formula> in (2), (3), or (4)) that extend it to non-linear fitness functions. In Section 9 of <xref ref-type="supplementary-material" rid="pone.0072043.s001">File S1</xref>, we compare these extensions of Hamilton’s condition to other extensions, based on covariance-regression formulas, like display (5) in <xref ref-type="bibr" rid="pone.0072043-Gardner1">[16]</xref>. We observe there that for the fundamental purpose of computing critical levels of relatedness needed for invasion, in term of parameters of the models, like in (5) and (6) above, covariance-regression formulas are incomplete in that they must be complemented with computations of the appropriate distribution of alleles in groups. And once these distributions are computed, our methods are much more direct and simpler.</p>
</list-item><list-item>
<p>Contingent forms of group altruism that are discontinued when participation is low can proliferate under biologically realistic conditions even in large groups. Their role in the spread of altruism should be empirically investigated. (Contrast with <xref ref-type="bibr" rid="pone.0072043-Boyd1">[36]</xref>.)</p>
</list-item><list-item>
<p>Natural selection can promote traits that (in net terms over a full life-cycle) are costly to the actors and beneficial to the other members of their group, under demographic conditions that are not stringent. This can happen in large groups and with realistically high levels of gene flow, through population viscosity, without the need for kin recognition or greenbeard effects. Excessive focus on one-shot linear public goods games in the literature has obscured this fact. (Contrast with, e.g., <xref ref-type="bibr" rid="pone.0072043-Leigh1">[13]</xref>, <xref ref-type="bibr" rid="pone.0072043-West2">[17]</xref>, <xref ref-type="bibr" rid="pone.0072043-MaynardSmith2">[20]</xref>–<xref ref-type="bibr" rid="pone.0072043-Davies1">[29]</xref>.)</p>
</list-item></list>
</sec></sec><sec id="s3">
<title>Supporting Information</title>
<supplementary-material id="pone.0072043.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0072043.s001" position="float" xlink:type="simple"><label>File S1</label><caption>
<p><bold>Supporting Information. Figure S1,</bold> Payoff profiles. Payoffs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e274" xlink:type="simple"/></inline-formula> for types A are represented by black squares, while red circles depict payoffs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e275" xlink:type="simple"/></inline-formula> for types N. From left: Public goods game (PG, Example 1) for <italic>n</italic> = 20, <italic>C</italic> = 1 and <italic>B</italic> = 5. Iterated public goods game (IPG, Example 2) for <italic>n</italic> = 20, <italic>C</italic> = 1, <italic>B</italic> = 5, <italic>a</italic> = 4 and <italic>T</italic> = 2. Threshold model (THR, Example 3) for <italic>n</italic> = 20 <italic>C</italic> = 1, <italic>θ</italic> = 4 and <italic>A</italic> = <italic>A</italic>′ = 10. <bold>Figure S2,</bold> Perron-Frobenius eigenvalues <italic>ρ</italic> as a function of <italic>m</italic> for <italic>δ</italic> = 0.1, 0.2 and 0.4. From top to bottom: Public goods game (PG, Example 1) with <italic>n</italic> = 20, <italic>C</italic> = 1, <italic>B</italic> = 5. Iterated public goods (IPG, Example 2) with <italic>n</italic> = 20, <italic>C</italic> = 1, <italic>B</italic> = 5, <italic>a</italic> = 8 and <italic>T</italic> = 10. Threshold model (THR, Example 3) with <italic>n</italic> = 20, <italic>C</italic> = 1, <italic>θ</italic> = 4, <italic>A</italic> = <italic>A</italic>′ = 10. Critical migration values <italic>m<sub>s</sub></italic> are obtained by solving <italic>ρ</italic>(<italic>m<sub>s</sub></italic>) = 1. <bold>Figure S3,</bold> Public goods game (Example 1): Panel A represents critical values <italic>m<sub>s</sub></italic> as a function of the strength of selection <italic>δ</italic>. Curves correspond to the case <italic>C</italic> = 1, <italic>B</italic> = 2 and <italic>n</italic> = 10 (top, black dotted line), <italic>n</italic> = 20 (middle, blue dashed line) and <italic>n</italic> = 50 (bottom, magenta full line). Short horizontal red lines indicate critical values at the weak selection limit obtained from (2) in the paper. The inset shows the same curves within the full range of possible values for <italic>m<sub>s</sub></italic>, illustrating the well known fact that for this model, only under exceptional conditions can the allele A invade. Panel B depicts the same conditions except for <italic>B</italic> = 5. <bold>Figure S4,</bold> Public goods game (Example 1): Critical relatedness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e276" xlink:type="simple"/></inline-formula> above which types A proliferate, as a function of the strength of selection <italic>δ</italic>. (<italic>R</italic><sup>0</sup>(<italic>m</italic>) = (1– <italic>m</italic>)<sup>2</sup>/(<italic>n</italic> – (<italic>n</italic> –1)(1– <italic>m</italic>)<sup>2</sup>) ≈ 1/(1+2<italic>nm</italic>) is the relatedness obtained from neutral genetic markers; see Sections S5 and S7). Panels correspond to the same parameter values as in Figure S3: <italic>C</italic> = 1, <italic>B</italic> = 2 and <italic>n</italic> = 10 (bottom, black dotted line), <italic>n</italic> = 20 (middle, blue dashed line) and <italic>n</italic> = 50 (top, magenta full line). Panel B depicts the same conditions except for <italic>B</italic> = 5. Short horizontal red lines indicate critical values at the weak selection limit obtained from Hamilton’s rule <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e277" xlink:type="simple"/></inline-formula>, or, equivalently, from (2) in the paper. Note the appreciable effect of the strength of selection. <bold>Figure S5,</bold> Iterated public goods game (Example 2): Critical values <italic>m<sub>s</sub></italic> as a function of the strength of selection <italic>δ</italic>. Panel A depicts the case <italic>n</italic> = 20, <italic>C</italic> = 1, <italic>B</italic> = 5, <italic>a</italic> = 4 with, respectively from bottom to top, <italic>T</italic> = 1 (dotted black line), <italic>T</italic> = 10 (dashed blue line), <italic>T</italic> = 100 (dot-dashed magenta) and <italic>T</italic> = 500 (green full line). Panel B depicts the same conditions except for <italic>a</italic> = 8. Short horizontal red lines indicate critical values at the weak selection limit obtained from (2) in the paper. Each curve has <italic>T</italic> fixed, but to compare different values of <italic>T</italic>, the product <italic>δT</italic> is a natural measure of strength of selection, and is used in the horizontal axis. <bold>Figure S6,</bold> Iterated public goods game (Example 2): Critical relatedness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e278" xlink:type="simple"/></inline-formula> above which types A proliferate, as a function of the strength of selection <italic>δ</italic>. (<italic>R</italic><sup>0</sup>(<italic>m</italic>) = (1– <italic>m</italic>)<sup>2</sup>/(<italic>n</italic> – (<italic>n</italic> –1)(1– <italic>m</italic>)<sup>2</sup>) is the relatedness obtained from neutral genetic markers; see Sections S5 and S7). Panels correspond to the same parameter values as in Figure S5: Panel A depicts the case <italic>n</italic> = 20, <italic>C</italic> = 1, <italic>B</italic> = 5, <italic>a</italic> = 4 with, respectively from top to bottom, <italic>T</italic> = 1 (dotted black line), <italic>T</italic> = 10 (dashed blue line), <italic>T</italic> = 100 (dot-dashed magenta) and <italic>T</italic> = 500 (green full line). Panel B depicts the same conditions except for <italic>a</italic> = 8. As in Figure S5, each curve has <italic>T</italic> fixed, but to compare different values of <italic>T</italic>, the product <italic>δT</italic> is a natural measure of strength of selection, and is used in the horizontal axis. Short horizontal red lines indicate critical values at the weak selection limit obtained from (2) in the paper. These values are: Panel A: 0.2000, 0.0865, 0.0402, 0.0243. Panel B: 0.2000, 0.1099, 0.0638, 0.0452. Note the very low values of critical relatedness in Panel A. <bold>Figure S7,</bold> Threshold model (Example 3): Critical values <italic>m<sub>s</sub></italic> as a function of the strength of selection <italic>δ</italic>. Panel A depicts the case <italic>n</italic> = 20, <italic>C</italic> = 1, <italic>θ</italic> = 4, <italic>A</italic>′ = 2<italic>A</italic>, with, respectively from bottom to top, <italic>A</italic> = 5 (dotted black line), <italic>A</italic> = 10 (dashed blue line), <italic>A</italic> = 50 (dot-dashed magenta) and <italic>A</italic> = 100 (green full line). Panel B depicts the same conditions except for <italic>θ</italic> = 8. Short horizontal red lines indicate critical values at the weak selection limit obtained from (2) in the paper. Each curve has <italic>A</italic> fixed, but to compare different values of <italic>A</italic>, the product <italic>δA</italic> is a natural measure of strength of selection, and is used in the horizontal axis. <bold>Figure S8,</bold> Threshold model (Example 3): Critical relatedness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e279" xlink:type="simple"/></inline-formula> above which types A proliferate, as a function of the strength of selection <italic>δ</italic>. (<italic>R</italic><sup>0</sup>(<italic>m</italic>) = (1– <italic>m</italic>)<sup>2</sup>/(<italic>n</italic> – (<italic>n</italic> –1)(1– <italic>m</italic>)<sup>2</sup>) is the relatedness obtained from neutral genetic markers; see Sections S5 and S7). Panels correspond to the same parameter values as in Figure S7: Panel A depicts the case <italic>n</italic> = 20, <italic>C</italic> = 1, <italic>θ</italic> = 4, <italic>A</italic>′ = 2<italic>A</italic>, with, respectively from top to bottom, <italic>A</italic> = 5 (dotted black line), <italic>A</italic> = 10 (dashed blue line), <italic>A</italic> = 50 (dot-dashed magenta) and <italic>A</italic> = 100 (green full line). Panel B depicts the same conditions except for <italic>θ</italic> = 8. As in Figure S7, each curve has <italic>A</italic> fixed, but to compare different values of <italic>A</italic>, the product <italic>δA</italic> is a natural measure
of strength of selection, and is used in the horizontal axis. Short horizontal red lines indicate critical values at the weak selection limit obtained from (2) in the paper. These values are: Panel A: 0.012, 0.017, 0.044, 0.071. Panel B: 0.061, 0.075, 0.137, 0.194. Note the extremely low values of critical relatedness in Panel A. The large values of <italic>A</italic> can result from contingent cooperation, based on feedback, as for the IPG. For instance, suppose that a certain activity repeats itself <italic>T</italic> times over a life-cycle. Suppose also that in each repetition the payoff is well described by the threshold model. If types A discontinue the participation when their payoff in the previous round was negative (as in the IPG discussed in <xref ref-type="fig" rid="pone-0072043-g002">Figure 2</xref> in the paper), then the resulting payoff over the <italic>T</italic> iterations is also given by a threshold model, with the same value of <italic>C</italic>, but <italic>A</italic> replaced by (<italic>A</italic> – <italic>C</italic>)<italic>T</italic>+<italic>C</italic>, and <italic>A</italic>′ replaced with <italic>A</italic>′<italic>T</italic>. This gives plausibility to values of <italic>A</italic> and <italic>A</italic>′ as large as those in this figure, since <italic>T</italic> can be in the hundreds, or thousands (see discussion on the IPG in the paper). <bold>Figure S9,</bold> Public goods game (Example 1): Perron-Frobenius eigenvectors <italic>ν</italic> = (<italic>ν</italic><sub>1</sub>, …, <italic>ν<sub>n</sub></italic>) represented in each box as a histogram, as a function of the strength of selection <italic>δ</italic> (rows) and of the migration rate parameter <italic>m</italic> (columns). Critical migration rates <italic>m<sub>s</sub></italic> are annotated in each row. Perron-Frobenius eigenvalues <italic>ρ</italic> are also provided for each box. In this picture we have <italic>C</italic> = 1, <italic>B</italic> = 2 and <italic>n</italic> = 20. <bold>Figure S10,</bold> Self-organization of copies of A. In these pictures we have PG with <italic>n</italic> = 2, <italic>C</italic> = 1, <italic>B</italic> = 3, <italic>δ</italic> = 0.3, resulting in <italic>m<sub>s</sub></italic> = 0.2889. Pictures show evolution of <italic>f</italic>(<italic>t</italic>) = (<italic>f</italic><sub>1</sub>(<italic>t</italic>), <italic>f</italic><sub>2</sub>(<italic>t</italic>)), started from several different initial distributions <italic>f</italic>(0). Circles over the lines mark <italic>f</italic>(<italic>t</italic>), with <italic>t</italic> = 0, 1, …, 500 obtained by iterations of the map <italic>f</italic>(<italic>t</italic> +1) = <italic>f</italic>(<italic>t</italic>)<italic>M</italic>(<italic>A</italic>+<italic>B</italic>). The direction spanned by the eigenvector <italic>ν</italic> is represented as a dotted green line. Left side (black): cases with <italic>ρ</italic> &lt;1, the allele A is eliminated; right side (red): cases with <italic>ρ</italic> &gt;1, the allele A spreads. In the top row, <italic>m</italic> is far from <italic>m<sub>s</sub></italic>: (A1) <italic>m</italic> = 0.3389, <italic>ρ</italic> = 0.9340, <italic>ν</italic> = (0.8506, 0.1494); (B1) <italic>m</italic> = 0.2389, <italic>ρ</italic> = 1.078, <italic>ν</italic> = (0.7342, 0.2658). In the bottom row, <italic>m</italic> is close to <italic>m<sub>s</sub></italic>: (A2) <italic>m</italic> = 0.2890, <italic>ρ</italic> = 0.999856, <italic>ν</italic> = (0.7342, 0.2658); (B2) <italic>m</italic> = 0.2888, <italic>ρ</italic> = 1.000014, <italic>ν</italic> = (0.7999, 0.2001). Note that in all cases <italic>f</italic>(<italic>t</italic>) reaches in a few generations a steady state, in which it shrinks (<italic>ρ</italic> &lt;1), or grows (<italic>ρ</italic> &gt;1), as a multiple of <italic>ν</italic>. When <italic>m</italic> approaches <italic>m<sub>s</sub></italic>, the eigenvalue <italic>ρ</italic> becomes close to 1, the stationary movement along the direction given by <italic>ν</italic> slows down and the trajectories towards this direction straighten themselves, but are not slowed down. <bold>Figure S11,</bold> Self-organization of copies of A. In this picture we have IPG with <italic>n</italic> = 10, <italic>C</italic> = 1, <italic>B</italic> = 3, <italic>T</italic> = 100, <italic>a</italic> = 2, <italic>δ</italic> = 0.01, and <italic>m</italic> = 0.153, slightly smaller than <italic>m<sub>s</sub></italic> = 0.163. Top part shows evolution of <italic>p</italic>(<italic>t</italic>), and bottom part shows corresponding evolution of <italic>f</italic>(<italic>t</italic>) = (<italic>f</italic><sub>1</sub>(<italic>t</italic>), …, <italic>f</italic><sub>10</sub>(<italic>t</italic>)), displayed as normalized histograms. Two initial conditions are compared: (Red) <italic>f</italic>(0) = 10<sup>–2</sup>(1, 0, …, 0), so that <italic>p</italic>(0) = 10<sup>–3</sup>. (Black) <italic>f</italic>(0) = 10<sup>–5</sup>(0, …, 0, 1), so that <italic>p</italic>(0) = 10<sup>–5</sup>. Note that from generation to generation the distribution of copies of A adjusts itself to the same stationary distribution, “losing memory of the initial distribution”. <bold>Figure S12,</bold> Self-organization of copies of A. This picture corresponds to the same model and situation described in Figure S11, but with a different time-frame, including later times. Note that eventually the two curves of <italic>p</italic>(<italic>t</italic>) become parallel straight lines, illustrating the exponential growth of <italic>p</italic>(<italic>t</italic>) at rate <italic>ρ</italic> independently of the initial condition. This picture also illustrates two other important points: 1) The possible non-monotonicity of <italic>p</italic>(<italic>t</italic>). 2) The fact that the asymptotic rate of growth may be smaller than the initial rate of growth. Indeed, computations of Δ<italic>p</italic> only indicate the long term prospects for the allele A, when done under stationary conditions, as in (1). The initial distribution of copies of A in the red line produces neighbor modulated fitness for A below that of allele N, so that Δ<italic>p</italic>(0) &lt;0. In contrast, the initial distribution of copies of A in the black line produces neighbor modulated fitness for A well above that of allele N, so that not only Δ<italic>p</italic>(0) &gt;0, but this growth happens at an unsustainably high rate. The distribution <italic>ν</italic>, towards which the copies of A self-organize is optimal for their stationary, stable, growth. This is so because (<italic>ρ</italic>, <italic>ν</italic>) is the leading eigenpair of the driving matrix <italic>M</italic>(<italic>A</italic>+<italic>B</italic>): <italic>ν</italic> is the vector <italic>ν</italic>′ that satisfies the eigenvalue (stationarity) equation <italic>ν</italic>′<italic>M</italic>(<italic>A</italic>+<italic>B</italic>) = <italic>ρ</italic>′<italic>ν</italic>′, with maximum <italic>ρ</italic>′. <bold>Figure S13,</bold> Self-organization of copies of A. This picture corresponds to the same model described in Figure S11, but now <italic>m</italic> = 0.173 is slightly larger than <italic>m<sub>s</sub></italic> = 0.163. Note that again eventually the two curves of <italic>p</italic>(<italic>t</italic>) become parallel straight lines, illustrating in this case the exponential decrease of <italic>p</italic>(<italic>t</italic>) at a rate independent of the initial condition. Here again one can see that Δ<italic>p</italic>(0) is not indicative of the relevant long term evolution. The self-organized distribution <italic>ν</italic> is still optimal for the proliferation of the allele A in a stable, sustainable, fashion. But when <italic>ρ</italic> &lt;1, as in this picture, this optimal stable distribution is still not good enough for A to spread, and instead, its copies are eliminated by natural selection. <bold>Figure S14,</bold> This diagram illustrates the concept of identity by descent (IBD) in the 2lFW. Two individuals <italic>X</italic> an <italic>Y</italic> in a given group in generation <italic>t</italic>, regardless of their type, are identical by descent (IBD) if their lineages, when followed back in time, coalesce before a migration event (indicated by a dashed arrow in the figure in the right panel). Considering a migration rate of <italic>m</italic>, migration typically takes place within a random number, of order 1/<italic>m</italic> of generations back. <bold>Figure S15,</bold> Perron-Frobenius eigenvectors <italic>ν</italic> = <italic>ν<sup>δ</sup></italic> for selection strengths <italic>δ</italic> = 0.01 (left column), <italic>δ</italic> = 0.3 (middle column) and <italic>δ</italic> = 0.7 (right column). Migration rate
is set to <italic>m</italic> = 0.1 and group sizes to <italic>n</italic> = 20. Each line represents a different model. The top row, labeled as PG depicts the Public Goods game (Example 1) with parameters <italic>C</italic> = 1 and <italic>B</italic> = 2. The Iterated Public Goods game (Example 2) with parameters <italic>C</italic> = 1, <italic>B</italic> = 4, <italic>a</italic> = 4 and <italic>T</italic> = 10 is shown in row at the middle, labeled as IPG. The bottom row shows Perron-Frobenius eigenvectors for the Threshold model (THR, Example 3) with <italic>C</italic> = 1, <italic>A</italic> = <italic>A</italic>′ = 5 and <italic>θ</italic> = 4. The leftmost column emphasizes that the weak selection limit <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e280" xlink:type="simple"/></inline-formula> is independent of the model. In contrast, when selection is strong, <italic>ν<sup>δ</sup></italic> depends on the model, as illustrated in the other columns. <bold>Figure S16,</bold> Distribution <italic>π<sub>k</sub></italic> (bars) given by <italic>π</italic> = <italic>πQ</italic> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e281" xlink:type="simple"/></inline-formula>, compared with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e282" xlink:type="simple"/></inline-formula>. Here <italic>ν<sup>δ</sup></italic> is the Perron-Frobenius eigenvector of <italic>M</italic>(<italic>A</italic>+<italic>B</italic>), with <italic>δ</italic> = 0.01, for the Threshold model (THR, Example 3) with parameters <italic>n</italic> = 20, <italic>C</italic> = 1, <italic>A</italic> = <italic>A</italic>′ = 5 and <italic>θ</italic> = 4 (red diamonds). The comparison is repeated for migration rates <italic>m</italic> = 0.01 (top panel) and <italic>m</italic> = 0.1 (bottom panel). <bold>Figure S17,</bold> This diagram illustrates why <italic>K<sup>D</sup></italic> evolves as a Markov chain driven by <italic>Q</italic>. In this picture <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e283" xlink:type="simple"/></inline-formula> represents the number of individuals that are IBD to the focal individual <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e284" xlink:type="simple"/></inline-formula>, in generation <italic>u</italic> (red circle). Two scenarios are discernible. MC1 (left panel): the focal individual is a migrant. This happens with probability <italic>m</italic> and implies that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e285" xlink:type="simple"/></inline-formula>. MC2 (right panel): the focal individual <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e286" xlink:type="simple"/></inline-formula> is not a migrant, and she is a child of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e287" xlink:type="simple"/></inline-formula>. Each individual in the focal group in generation <italic>u</italic> chooses a mother from the group of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e288" xlink:type="simple"/></inline-formula> in the previous generation with uniform probability, as <italic>δ</italic> = 0. With probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e289" xlink:type="simple"/></inline-formula> the chosen mother is IBD to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e290" xlink:type="simple"/></inline-formula> (orange circles) and, consequently, her children are also IBD to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e291" xlink:type="simple"/></inline-formula>, provided that they are not migrants. In this case, the number of individuals in generation <italic>u</italic> that are IBD to the focal is, therefore, 1 (for the focal individual herself) plus a number of individuals given by a binomial random variable with probability of success <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e292" xlink:type="simple"/></inline-formula> in <italic>n</italic> –1 trials. <bold>Figure S18,</bold> Relatedness <italic>R</italic><sup>0</sup> as a function of migration rate <italic>m</italic>, under neutral drift, <italic>δ</italic> = 0, as given by (S11). From top to bottom, <italic>n</italic> = 20 (dot-dashed blue line), <italic>n</italic> = 50 (dashed green line) and <italic>n</italic> = 100 (full red line). <bold>Figure S19,</bold> Limit of large <italic>n</italic> and small <italic>m</italic> under weak selection. This figure compares tail probabilities for the distribution <italic>π</italic> (stairs) and for Beta distributions with parameters <italic>α</italic> = 1 and <italic>β</italic> = 2<italic>mn</italic>. Panel A shows the case <italic>n</italic> = 20 for, from top to bottom, <italic>m</italic> = 0.01 (red dotted line), <italic>m</italic> = 0.1 (blue dashed line) and <italic>m</italic> = 0.5 (black dot dashed line). Panel B depicts the same scenarios for the case <italic>n</italic> = 100. <bold>Figure S20,</bold> Limit of large <italic>n</italic> under weak selection for the threshold model (THR, Example 3). Panels represent critical migration rates (A and C) and critical relatedness (B and D) for the THR with <italic>C</italic> = 1, <italic>A</italic> = <italic>A</italic>′ = 10 as a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e293" xlink:type="simple"/></inline-formula>. Top panels A and B depict the case <italic>n</italic> = 20. Bottom panels C and D depict the case <italic>n</italic> = 100. In each panel critical values obtained by the viability condition under weak selection derived from (A2) (black full lines) are compared with the approximation for large <italic>n</italic> given by (S25) (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e294" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e295" xlink:type="simple"/></inline-formula>, approx.1, dashed blue lines) and with the approximation (S26) (approx.2, dotted red lines). <bold>Figure S21,</bold> Limit of large <italic>n</italic> under weak selection for the Iterated public goods (IPG) game (Example 2). Panels represent critical migration rates (A and C) and critical relatedness (B and D) for the IPG with <italic>C</italic> = 1, <italic>B</italic> = 5 and <italic>T</italic> = 100 as a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e296" xlink:type="simple"/></inline-formula>. Top panels A and B depict the case <italic>n</italic> = 20. Bottom panels C and D depict the case <italic>n</italic> = 100. In each panel critical values obtained by the viability condition under weak selection derived from (2) (black full lines) are compared with the approximation for large <italic>n</italic> given by solving (S27) in <italic>R</italic> (approx., dashed blue lines). In panel B we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e297" xlink:type="simple"/></inline-formula> when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e298" xlink:type="simple"/></inline-formula>, and in panel D we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e299" xlink:type="simple"/></inline-formula> when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e300" xlink:type="simple"/></inline-formula>. Types A are altruistic in the strong sense of (S31) when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e301" xlink:type="simple"/></inline-formula>. <bold>Figure S22,</bold> Limit of large <italic>n</italic> under weak selection for the Iterated public goods (IPG) game (Example 2): behavior of solutions for (S27) - Part 1. Top panel: <italic>H</italic>(<italic>R</italic>) corresponds to the l.h.s. of (S27) while <italic>G</italic>(<italic>R</italic>) depicts the r.h.s. of (S27). <italic>H</italic>(<italic>R</italic>) is strictly decreasing and it is positive for <italic>R</italic>&lt;<italic>C</italic>/<italic>B</italic>. Derivatives of <italic>G</italic>(<italic>R</italic>) converge to 0 as <italic>R</italic> → 0. <italic>H</italic>(<italic>R</italic>) and <italic>G</italic>(<italic>R</italic>) are equal to each other at exactly one point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e302" xlink:type="simple"/></inline-formula> that is a decreasing function of <italic>C</italic>/<italic>B</italic>. Curves depicted correspond to the cases <italic>C</italic>/<italic>B</italic> = 0.5 (full black line), <italic>C</italic>/<italic>B</italic> = 0.2 (dashed red line) and <italic>C</italic>/<italic>B</italic> = 0.1 (dot-dashed blue line) with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e303" xlink:type="simple"/></inline-formula> and <italic>T</italic> = 100. Bottom panel: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e304" xlink:type="simple"/></inline-formula> as a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e305" xlink:type="simple"/></inline-formula> for <italic>C</italic>/<italic>B</italic> = 0.5
(top, full black line), <italic>C</italic>/<italic>B</italic> = 0.2 (middle, dashed red line) and <italic>C</italic>/<italic>B</italic> = 0.1 (bottom, dot-dashed blue line) and <italic>T</italic> = 100. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e306" xlink:type="simple"/></inline-formula> is continuous in the interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e307" xlink:type="simple"/></inline-formula>, takes the value <italic>C</italic>/<italic>B</italic> on both end-points of this domain and has a minimum at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e308" xlink:type="simple"/></inline-formula>. <bold>Figure S23,</bold> Limit of large <italic>n</italic> under weak selection for the Iterated public goods (IPG) game (Example 2): behavior of solutions for (S27) - Part 2. Top panel: <italic>G</italic>(<italic>R</italic>) and <italic>H</italic>(<italic>R</italic>) for <italic>C</italic>/<italic>B</italic> = 0.5, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e309" xlink:type="simple"/></inline-formula> and <italic>T</italic> = 10 (leftmost, full black line), <italic>T</italic> = 10<sup>3</sup> (dashed red line) and <italic>T</italic> = 10<sup>5</sup> (dot-dashed blue line). <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e310" xlink:type="simple"/></inline-formula> is a decreasing function of <italic>T</italic>. Bottom panel: in the limit <italic>T</italic> → ∞, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e311" xlink:type="simple"/></inline-formula> then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e312" xlink:type="simple"/></inline-formula> (full magenta line). If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e313" xlink:type="simple"/></inline-formula> then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e314" xlink:type="simple"/></inline-formula> very slowly. <bold>Figure S24,</bold> Limit of large <italic>n</italic> under weak selection for the Iterated public goods (IPG) game (Example 2): behavior of solutions for (S27) - Part 3. <italic>H</italic>(<italic>R</italic>) (strictly decreasing straight line) and <italic>G</italic>(<italic>R</italic>) for <italic>C</italic>/<italic>B</italic> = 0.5 and <italic>T</italic> = 10 for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e315" xlink:type="simple"/></inline-formula>, 0.1, 0.3, 0.4, 0.5 from right to left in Panel A and for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e316" xlink:type="simple"/></inline-formula>, 0.6, 0.7, 0.9, 0.999 from left to right in Panel B. The graph of <italic>G</italic>(<italic>R</italic>) moves upwards for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e317" xlink:type="simple"/></inline-formula> and downwards for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e318" xlink:type="simple"/></inline-formula>. <italic>G</italic>(<italic>R</italic>) → (<italic>T</italic> –1)(<italic>BR</italic> – <italic>C</italic>) as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e319" xlink:type="simple"/></inline-formula> (dashed magenta line in Panel A). In Panel B it can be seen that <italic>G</italic>(<italic>R</italic>) → 0 as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e320" xlink:type="simple"/></inline-formula>. <bold>Figure S25,</bold> Limit of large <italic>n</italic> under weak selection for the Iterated public goods (IPG) game (Example 2): behavior of solutions for (S27) - Part 4. In all panels <italic>C</italic>/<italic>B</italic> = 0.5. Panel A depicts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e321" xlink:type="simple"/></inline-formula> as a function of 1/log(<italic>T</italic>) for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e322" xlink:type="simple"/></inline-formula> (full black line) and for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e323" xlink:type="simple"/></inline-formula> (dashed red line). For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e324" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e325" xlink:type="simple"/></inline-formula> (this value is approximately 0.286 for the case shown). If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e326" xlink:type="simple"/></inline-formula> then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e327" xlink:type="simple"/></inline-formula> converges to 0 very slowly as <italic>T</italic> increases, more specifically <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e328" xlink:type="simple"/></inline-formula> (dotted magenta line). Bottom panels show the behavior of <italic>G</italic>(<italic>R</italic>) as <italic>T</italic> increases. Panel B: case <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e329" xlink:type="simple"/></inline-formula> for, from right to left, <italic>T</italic> = 2, 10, 100, 500. Panel A: case <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e330" xlink:type="simple"/></inline-formula> for <italic>T</italic> = 2, 10, 100, 500, from right to left. <italic>G</italic>(<italic>R</italic>) stays at zero for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e331" xlink:type="simple"/></inline-formula> and goes monotonically to infinity for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e332" xlink:type="simple"/></inline-formula>. <bold>Figure S26,</bold> The solid lines provide the solution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0072043.e333" xlink:type="simple"/></inline-formula> of <italic>C</italic>/<italic>B</italic> – <italic>R</italic> = (<italic>T</italic> –1)<italic>R</italic>(1– (<italic>C</italic>/<italic>B</italic>))<sup>1/<italic>R</italic></sup>, as a function of <italic>C</italic>/<italic>B</italic>, for (top to bottom) <italic>T</italic> = 1 (black), 10 (blue), 100 (magenta), 1000 (green) and 10000 (cian). The corresponding dashed lines with same colors (no black one) provide the approximation (A5), <italic>R</italic> = –ln(1– (<italic>C</italic>/<italic>B</italic>))/ln <italic>T</italic>. This figure is an expanded version of Panel C of <xref ref-type="fig" rid="pone-0072043-g002">Figure 2</xref> in the paper.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>The authors thank Rob Boyd for many hours of stimulating and informative conversations on the subjects in this paper. Thanks are given to Marek Biskup for assistance in exploring the nature of the distribution π. We are also grateful to Clark Barrett, Maciek Chudek, Daniel Fessler, Kevin Foster, Willem Frankenhuis, Bailey House, Laurent Lehmann, Glauco Machado, Sarah Mathew, Diogo Meyer, Cristina Moya, Peter Nonacs, Karthik Panchanathan, Susan Perry, Joan Silk, Jennifer Smith and Ming Xue for nice conversations and feedback on various aspects of this project and related subjects. We thank also the referees and the editor for their comments.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0072043-MaynardSmith1"><label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">Maynard Smith J, Szathmáry E (1995) The Major Transitions in Evolution. Oxford, UK: Oxford University Press.</mixed-citation>
</ref>
<ref id="pone.0072043-Frank1"><label>2</label>
<mixed-citation publication-type="other" xlink:type="simple">Frank SA (1998) Foundations of Social Evolution. Princeton, NJ, USA.: Princeton University Press.</mixed-citation>
</ref>
<ref id="pone.0072043-Rousset1"><label>3</label>
<mixed-citation publication-type="other" xlink:type="simple">Rousset F (2004) Genetic Structure and Selection in Subdivided Populations. Princeton, NJ, USA: Princeton University Press.</mixed-citation>
</ref>
<ref id="pone.0072043-Lehmann1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lehmann</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Keller</surname><given-names>L</given-names></name> (<year>2006</year>) <article-title>The evolution of cooperation and altruism - a general framework and a classification of models</article-title>. <source>J Evolution Biol</source> <volume>19</volume>: <fpage>1365</fpage>–<lpage>1378</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Okasha1"><label>5</label>
<mixed-citation publication-type="other" xlink:type="simple">Okasha S (2006) Evolution and the Levels of Selection. Oxford, UK: Oxford University Press.</mixed-citation>
</ref>
<ref id="pone.0072043-Nowak1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nowak</surname><given-names>MA</given-names></name> (<year>2006</year>) <article-title>Five rules for the evolution of cooperation</article-title>. <source>Science</source> <volume>314</volume>: <fpage>1560</fpage>–<lpage>1563</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Wenseleers1"><label>7</label>
<mixed-citation publication-type="other" xlink:type="simple">Wenseleers T, Gardner A, Foster KR (2010) Social evolution theory: a review of methods and approaches. In: Szekely T, Moore AJ, Komdeur J, editors, Social Behaviour: Genes, Ecology and Evolution, Cambridge, UK: Cambridge University Press, Cambridge, UK. 132–158.</mixed-citation>
</ref>
<ref id="pone.0072043-Bourke1"><label>8</label>
<mixed-citation publication-type="other" xlink:type="simple">Bourke AF (2011) Principles of Social Evolution. Oxford, UK: Oxford University Press.</mixed-citation>
</ref>
<ref id="pone.0072043-Wilson1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>EO</given-names></name> (<year>2007</year>) <article-title>Rethinking the theoretical foundation of sociobiology</article-title>. <source>Q Rev Biol</source> <volume>82</volume>: <fpage>327</fpage>–<lpage>348</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-West1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>West</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Griffn</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Gardner</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>Evolutionary explanations of cooperation</article-title>. <source>Curr Biol</source> <volume>17</volume>: <fpage>R661</fpage>–<lpage>R672</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Foster1"><label>11</label>
<mixed-citation publication-type="other" xlink:type="simple">Foster K (2009) A defense of sociobiology. In: Cold Spring Harbor Symposia on Quantitative Biology 74. Cold Spring Harbor Press, 403–418.</mixed-citation>
</ref>
<ref id="pone.0072043-Traulsen1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Traulsen</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Mathematics of kin- and group-selection: Formally equivalent?</article-title> <source>Evolution</source> <volume>64</volume>: <fpage>316</fpage>–<lpage>323</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Leigh1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leigh</surname><given-names>EG</given-names></name> (<year>2010</year>) <article-title>The group selection controversy</article-title>. <source>J Evolution Biol</source> <volume>23</volume>: <fpage>6</fpage>–<lpage>19</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Nowak2"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nowak</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Tarnita</surname><given-names>CE</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>EO</given-names></name> (<year>2010</year>) <article-title>The evolution of eusociality</article-title>. <source>Nature</source> <volume>466</volume>: <fpage>1057</fpage>–<lpage>1062</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Abbot1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abbot</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Inclusive fitness theory and eusociality</article-title>. <source>Nature</source> <volume>471</volume>: <fpage>E1</fpage>–<lpage>E4</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Gardner1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gardner</surname><given-names>A</given-names></name>, <name name-style="western"><surname>West</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Wild</surname><given-names>G</given-names></name> (<year>2011</year>) <article-title>The genetical theory of kin selection</article-title>. <source>J Evolution Biol</source> <volume>24</volume>: <fpage>1020</fpage>–<lpage>1043</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-West2"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>West</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Mouden</surname><given-names>CE</given-names></name>, <name name-style="western"><surname>Gardner</surname><given-names>A</given-names></name> (<year>2011</year>) <article-title>Sixteen common misconceptions about the evolution of cooperation in humans</article-title>. <source>Evol Hum Behav</source> <volume>32</volume>: <fpage>231</fpage>–<lpage>262</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Simon1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simon</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Fletcher</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Doebeli</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>Hamilton’s rule in multi-level selection models</article-title>. <source>J Theor Biol</source> <volume>299</volume>: <fpage>55</fpage>–<lpage>63</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Taylor1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Taylor</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Frank</surname><given-names>SA</given-names></name> (<year>1996</year>) <article-title>How to make a kin selection model</article-title>. <source>J Evolution Biol</source> <volume>180</volume>: <fpage>27</fpage>–<lpage>37</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-MaynardSmith2"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maynard-Smith</surname><given-names>J</given-names></name> (<year>1964</year>) <article-title>Group selection and kin selection</article-title>. <source>Nature</source> <volume>201</volume>: <fpage>1145</fpage>–<lpage>7</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Williams1"><label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Williams GC (1966) Adaptation and Natural Selection. Princeton, NJ, USA: Princeton University Press.</mixed-citation>
</ref>
<ref id="pone.0072043-Hamilton1"><label>22</label>
<mixed-citation publication-type="other" xlink:type="simple">Hamilton W (1975) Innate social aptitude of man: An approach from evolutionary genetics. In: Fox R, editor, ASA Studies 4: Biosocial Anthropology, London, UK: Malaby Press. 133–153.</mixed-citation>
</ref>
<ref id="pone.0072043-MaynardSmith3"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maynard-Smith</surname><given-names>J</given-names></name> (<year>1976</year>) <article-title>Group selection</article-title>. <source>Q Rev Biol</source> <volume>51</volume>: <fpage>277</fpage>–<lpage>283</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Aoki1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aoki</surname><given-names>K</given-names></name> (<year>1982</year>) <article-title>A condition for group selection to prevail over counteracting individual selection</article-title>. <source>Evolution</source> <volume>36</volume>: <fpage>832</fpage>–<lpage>842</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Crow1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Crow</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Aoki</surname><given-names>K</given-names></name> (<year>1982</year>) <article-title>Group selection for a polygenic behavioral trait: differential proliferation model</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>79</volume>: <fpage>2628</fpage>–<lpage>2631</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Kimura1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kimura</surname><given-names>M</given-names></name> (<year>1983</year>) <article-title>Diffusion models of intergroup selection, with special reference to the evolution of altruistic character</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>80</volume>: <fpage>6317</fpage>–<lpage>6321</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Leigh2"><label>27</label>
<mixed-citation publication-type="other" xlink:type="simple">Leigh EG (1983) When does the good of the group override the advantage of the individual? Proc Natl Acad Sci U S A : 2985–2989.</mixed-citation>
</ref>
<ref id="pone.0072043-MaynardSmith4"><label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Maynard Smith J (1998) Evolutionary Genetics. Oxford, UK: Oxford University Press, second edition.</mixed-citation>
</ref>
<ref id="pone.0072043-Davies1"><label>29</label>
<mixed-citation publication-type="other" xlink:type="simple">Davies NB, Krebs JR, West SA (2012) An Introduction to Behavioral Ecology. Oxford, UK: Wiley-Blackwell, fourth edition.</mixed-citation>
</ref>
<ref id="pone.0072043-Bowles1"><label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Bowles S, Gintis H (2011) A Cooperative Species: Human Reciprocity and its Evolution. Princeton, NJ, USA: Princeton University Press.</mixed-citation>
</ref>
<ref id="pone.0072043-Hartl1"><label>31</label>
<mixed-citation publication-type="other" xlink:type="simple">Hartl DL, Clark AG (2007) Principles of Population Genetics. Sunderland, MA, USA: Sinauer Associates, fourth edition edition. Especially Table 6.4, Chapter 6.</mixed-citation>
</ref>
<ref id="pone.0072043-Bowles2"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bowles</surname><given-names>S</given-names></name> (<year>2006</year>) <article-title>Group competition, reproductive leveling, and the evolution of human altruism</article-title>. <source>Science</source> <volume>314</volume>: <fpage>1569</fpage>–<lpage>1572</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Hamilton2"><label>33</label>
<mixed-citation publication-type="other" xlink:type="simple">Hamilton M (2009) Population Genetics. Oxford, UK: Wiley-Blackwell.</mixed-citation>
</ref>
<ref id="pone.0072043-Refard1"><label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Refard D, Bergmiller T, Kümmerli R (2013) Altruism can evolve when relatedness is low: evidence from bacteria commiting suicide upon phage infection. Proc R Soc B 280.</mixed-citation>
</ref>
<ref id="pone.0072043-Joshi1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Joshi</surname><given-names>N</given-names></name> (<year>1987</year>) <article-title>Evolution of cooperation by reciprocation within structured demes</article-title>. <source>J Genet</source> <volume>66</volume>: <fpage>69</fpage>–<lpage>84</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Boyd1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boyd</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Richerson</surname><given-names>PJ</given-names></name> (<year>1988</year>) <article-title>The evolution of reciprocity in sizable groups</article-title>. <source>J Theor Biol</source> <volume>132</volume>: <fpage>337</fpage>–<lpage>356</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-McElreath1"><label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">McElreath R, Boyd R (2007) Mathematical Models of Social Evolution. Chicago: University of Chicago Press.</mixed-citation>
</ref>
<ref id="pone.0072043-Kerr1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kerr</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Godfrey-Smith</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Feldman</surname><given-names>MW</given-names></name> (<year>2004</year>) <article-title>What is altruism?</article-title> <source>Trends Ecol Evol</source> <volume>19</volume>: <fpage>135</fpage>–<lpage>140</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Kokko1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kokko</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Johnstone</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Clutton-Brock</surname><given-names>T</given-names></name> (<year>2001</year>) <article-title>The evolution of cooperative breeding through group augmentation</article-title>. <source>Proc R Soc B</source> <volume>268</volume>: <fpage>187</fpage>–<lpage>196</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Avils1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Avilés</surname><given-names>L</given-names></name> (<year>2002</year>) <article-title>Solving the freeloaders paradox: genetic associations and frequency-dependence selection in the evolution of cooperation among non-relatives</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>99</volume>: <fpage>14268</fpage>–<lpage>14273</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Hauert1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hauert</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Synergy and discounting of cooperation in social dilemmas</article-title>. <source>J Theor Biol</source> <volume>239</volume>: <fpage>195</fpage>–<lpage>202</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-vanVeelen1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van Veelen</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Group selection, kin selection, altruism and cooperation: when inclusive fitness is right and when it can be wrong</article-title>. <source>J Theor Biol</source> <volume>259</volume>: <fpage>589</fpage>–<lpage>600</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Archetti1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Archetti</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Scheuring</surname><given-names>I</given-names></name> (<year>2010</year>) <article-title>Coexistence of cooperation and defection in public goods games</article-title>. <source>Evolution</source> <volume>65</volume>: <fpage>1140</fpage>–<lpage>11148</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Gore1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gore</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Youk</surname><given-names>H</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Snowdrift game dynamics and facultative cheating in yeast</article-title>. <source>Nature</source> <volume>459</volume>: <fpage>253</fpage>–<lpage>256</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Chuang1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chuang</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Rivoire</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Cooperation and Hamilton’s rule in a simple microbial system</article-title>. <source>Mol Syst Biol</source> <volume>6</volume>: <fpage>1</fpage>–<lpage>7</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Smith1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Dyken</surname><given-names>JDV</given-names></name>, <name name-style="western"><surname>Zee</surname><given-names>PC</given-names></name> (<year>2010</year>) <article-title>Generalization of Hamilton’s rule for the evolution of microbial cooperation</article-title>. <source>Science</source> <volume>328</volume>: <fpage>1700</fpage>–<lpage>1703</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Heinsohn1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heinsohn</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Packer</surname><given-names>C</given-names></name> (<year>1995</year>) <article-title>Complex cooperative strategies in group-territorial african lions</article-title>. <source>Science</source> <volume>269</volume>: <fpage>1260</fpage>–<lpage>1262</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Bergmller1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bergmüller</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Integrating cooperative breeding into theoretical concepts of cooperation</article-title>. <source>Behav Process</source> <volume>76</volume>: <fpage>61</fpage>–<lpage>72</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Boyd2"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boyd</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Gintis</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Bowles</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Coordinated punishment of defectors sustains cooperation and can proliferate when rare</article-title>. <source>Science</source> <volume>328</volume>: <fpage>617</fpage>–<lpage>620</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Queller1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Queller</surname><given-names>DC</given-names></name> (<year>1992</year>) <article-title>Quantitative genetics, inclusive fitness, and group selection</article-title>. <source>Am Nat</source> <volume>139</volume>: <fpage>540</fpage>–<lpage>558</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Lehmann2"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lehmann</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Rousset</surname><given-names>F</given-names></name> (<year>2010</year>) <article-title>How life history and demography promote or inhibit the evolution of helping behaviors</article-title>. <source>Phil Trans R Soc B</source> <volume>365</volume>: <fpage>2599</fpage>–<lpage>2617</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Mayo1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mayo</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Gilinsky</surname><given-names>N</given-names></name> (<year>1987</year>) <article-title>Models of group selection</article-title>. <source>Philosophy of Science</source> <volume>54</volume>: <fpage>515</fpage>–<lpage>538</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Matessi1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Matessi</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Jayakar</surname><given-names>S</given-names></name> (<year>1976</year>) <article-title>Conditions for the evolution of altruism under darwinian selection</article-title>. <source>Theor Popul Biol</source> <volume>9</volume>: <fpage>360</fpage>–<lpage>387</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Gardner2"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gardner</surname><given-names>A</given-names></name>, <name name-style="western"><surname>West</surname><given-names>S</given-names></name> (<year>2006</year>) <article-title>Demography, altruism and the benefits of budding</article-title>. <source>J Evolution Biol</source> <volume>19</volume>: <fpage>1707</fpage>–<lpage>1716</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Goodnight1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goodnight</surname><given-names>KF</given-names></name> (<year>1992</year>) <article-title>The effect of stochastic variation on kin selection in a budding-viscous population</article-title>. <source>Am Nat</source> <volume>140</volume>: <fpage>1028</fpage>–<lpage>1040</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Taylor2"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Taylor</surname><given-names>PD</given-names></name> (<year>1992</year>) <article-title>Altruism in viscous populations - an inclusive fitness model</article-title>. <source>Evol Ecol</source> <volume>6</volume>: <fpage>352</fpage>–<lpage>356</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Lehmann3"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lehmann</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Group selection and kin selection: Two concepts but one process</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>104</volume>: <fpage>6736</fpage>–<lpage>6739</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Trausen1"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trausen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Nowak</surname><given-names>MA</given-names></name> (<year>2006</year>) <article-title>Evolution of cooperation by multilevel selection</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>103</volume>: <fpage>10952</fpage>–<lpage>10955</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Trivers1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trivers</surname><given-names>RL</given-names></name> (<year>1971</year>) <article-title>The evolution of reciprocal altruism</article-title>. <source>Q Rev Biol</source> <volume>46</volume>: <fpage>35</fpage>–<lpage>57</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Axelrod1"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Axelrod</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Hamilton</surname><given-names>WD</given-names></name> (<year>1981</year>) <article-title>The evolution of cooperation</article-title>. <source>Science</source> <volume>211</volume>: <fpage>1390</fpage>–<lpage>1396</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Rutte1"><label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rutte</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Taborsky</surname><given-names>M</given-names></name> (<year>2007</year>) <article-title>Generalized reciprocity in rats</article-title>. <source>PLoS Biology</source> <volume>5</volume>: <fpage>1421</fpage>–<lpage>1425</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Rankin1"><label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rankin</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Taborsky</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Assortment and the evolution of generalized reciprocity</article-title>. <source>Evolution</source> <volume>67</volume>: <fpage>1913</fpage>–<lpage>1922</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Roze1"><label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roze</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Rousset</surname><given-names>F</given-names></name> (<year>2008</year>) <article-title>Multilocus models in infinite island modedel of population structure</article-title>. <source>Theor Popul Biol</source> <volume>73</volume>: <fpage>529</fpage>–<lpage>542</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Lessard1"><label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lessard</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>Diffusion approximations for one-locus multi-allele kin selection, mutation and random drift in group-structured populations: a unifying approach to selection models in population genetics</article-title>. <source>J Math Biol</source> <volume>59</volume>: <fpage>659</fpage>–<lpage>696</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Ohtsuki1"><label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ohtsuki</surname><given-names>H</given-names></name> (<year>2010</year>) <article-title>Evolutionary games in Wright’s Island model: kin selection meets evolutionary game theory</article-title>. <source>Evolution</source> <volume>64</volume>: <fpage>3344</fpage>–<lpage>3353</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Gardner3"><label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gardner</surname><given-names>A</given-names></name>, <name name-style="western"><surname>West</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>Greenbeards</article-title>. <source>Evolution</source> <volume>64</volume>: <fpage>25</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pone.0072043-Schonmann1"><label>67</label>
<mixed-citation publication-type="other" xlink:type="simple">Schonmann RH, Boyd R, Vicente R (2012) The Taylor-Frank method cannot be applied to some biologically important, continuous fitness functions. ArXiv:1209.1412v1.</mixed-citation>
</ref>
<ref id="pone.0072043-Kerr2"><label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kerr</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Godfrey-Smith</surname><given-names>P</given-names></name> (<year>2002</year>) <article-title>Individual and multi-level perspective on selection in structured populations</article-title>. <source>Biol Phil</source> <volume>17</volume>: <fpage>477</fpage>–<lpage>517</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>