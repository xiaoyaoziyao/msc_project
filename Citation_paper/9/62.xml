<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-0161R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000406</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biophysics/RNA Structure</subject><subject>Biophysics/Theory and Simulation</subject><subject>Computational Biology/Macromolecular Structure Analysis</subject><subject>Computational Biology/Molecular Dynamics</subject><subject>Mathematics/Statistics</subject><subject>Molecular Biology/Bioinformatics</subject></subj-group></article-categories><title-group><article-title>A Probabilistic Model of RNA Conformational Space</article-title><alt-title alt-title-type="running-head">A Probabilistic Model of RNA Conformational Space</alt-title></title-group><contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Frellsen</surname><given-names>Jes</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Moltke</surname><given-names>Ida</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Thiim</surname><given-names>Martin</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mardia</surname><given-names>Kanti V.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ferkinghoff-Borg</surname><given-names>Jesper</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hamelryck</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>The Bioinformatics Center, Department of Biology, University of Copenhagen, Copenhagen, Denmark</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Statistics, University of Leeds, Leeds, United Kingdom</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>DTU Elektro, Technical University of Denmark, Lyngby, Denmark</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Gardner</surname><given-names>Paul</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Wellcome Trust Sanger Institute, United Kingdom</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">thamelry@binf.ku.dk</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: JF IM MT TH. Performed the experiments: JF IM MT. Analyzed the data: JF IM MT TH. Contributed reagents/materials/analysis tools: KVM JFB. Wrote the paper: JF IM TH. Important parts of the research for this article was conducted as part of a joint master thesis project to which MT, IM and JF contributed equally.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>6</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>19</day><month>6</month><year>2009</year></pub-date><volume>5</volume><issue>6</issue><elocation-id>e1000406</elocation-id><history>
<date date-type="received"><day>17</day><month>2</month><year>2009</year></date>
<date date-type="accepted"><day>6</day><month>5</month><year>2009</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2009</copyright-year><copyright-holder>Frellsen et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>The increasing importance of non-coding RNA in biology and medicine has led to a growing interest in the problem of RNA 3-D structure prediction. As is the case for proteins, RNA 3-D structure prediction methods require two key ingredients: an accurate energy function and a conformational sampling procedure. Both are only partly solved problems. Here, we focus on the problem of conformational sampling. The current state of the art solution is based on fragment assembly methods, which construct plausible conformations by stringing together short fragments obtained from experimental structures. However, the discrete nature of the fragments necessitates the use of carefully tuned, unphysical energy functions, and their non-probabilistic nature impairs unbiased sampling. We offer a solution to the sampling problem that removes these important limitations: a probabilistic model of RNA structure that allows efficient sampling of RNA conformations in continuous space, and with associated probabilities. We show that the model captures several key features of RNA structure, such as its rotameric nature and the distribution of the helix lengths. Furthermore, the model readily generates native-like 3-D conformations for 9 out of 10 test structures, solely using coarse-grained base-pairing information. In conclusion, the method provides a theoretical and practical solution for a major bottleneck on the way to routine prediction and simulation of RNA structure and dynamics in atomic detail.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>The importance of RNA in biology and medicine has increased immensely over the last several years, due to the discovery of a wide range of important biological processes that are under the guidance of non-coding RNA. As is the case with proteins, the function of an RNA molecule is encoded in its three-dimensional (3-D) structure, which in turn is determined by the molecule's sequence. Therefore, interest in the computational prediction of the 3-D structure of RNA from sequence is great. One of the main bottlenecks in routine prediction and simulation of RNA structure and dynamics is sampling, the efficient generation of RNA-like conformations, ideally in a mathematically and physically sound way. Current methods require the use of unphysical energy functions to amend the shortcomings of the sampling procedure. We have developed a mathematical model that describes RNA's conformational space in atomic detail, without the shortcomings of other sampling methods. As an illustration of its potential, we describe a simple yet efficient method to sample conformations that are compatible with a given secondary structure. An implementation of the sampling method, called BARNACLE, is freely available.</p>
</abstract><funding-group><funding-statement>This work was supported by Carlsbergs Mindelegat (<ext-link ext-link-type="uri" xlink:href="http://www.carlsbergsmindelegat.dk" xlink:type="simple">http://www.carlsbergsmindelegat.dk</ext-link>), the Danish Research Council for Technology and Production Sciences (<ext-link ext-link-type="uri" xlink:href="http://en.fi.dk" xlink:type="simple">http://en.fi.dk</ext-link>), the Danish National Research Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.dg.dk" xlink:type="simple">http://www.dg.dk</ext-link>) and the University of Copenhagen (<ext-link ext-link-type="uri" xlink:href="http://www.science.ku.dk" xlink:type="simple">http://www.science.ku.dk</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="11"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Non-coding RNA is of crucial importance for the functioning of the living cell, where it plays key catalytic, regulatory and structural roles <xref ref-type="bibr" rid="pcbi.1000406-Eddy1">[1]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Amaral1">[2]</xref>. Understanding the exact mechanisms behind these functions is therefore of great importance for both biology and medicine. In many cases, this understanding requires knowledge of RNA structure in atomic detail. However, determining the structure of an RNA molecule experimentally is typically a time consuming, expensive and difficult task <xref ref-type="bibr" rid="pcbi.1000406-Shapiro1">[3]</xref>. Therefore, algorithms for RNA structure prediction have attracted much interest, initially with the main focus on predicting secondary structure. Many noticeable advances have been made in the area of secondary structure prediction; most recently the introduction of statistical sampling had an important impact <xref ref-type="bibr" rid="pcbi.1000406-Shapiro1">[3]</xref>–<xref ref-type="bibr" rid="pcbi.1000406-Ding1">[5]</xref>.</p>
<p>In the past years, an increasing number of relevant structures have become available, and much progress has been made in the understanding of the three dimensional (3-D) structure of RNA. The conformational space of RNA has been analyzed using methods inspired by the Ramachandran plot for proteins <xref ref-type="bibr" rid="pcbi.1000406-Sundaralingam1">[6]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Murthy1">[7]</xref>, the RNA base pair interactions have been accurately classified <xref ref-type="bibr" rid="pcbi.1000406-Leontis1">[8]</xref>, and the conformational space of the RNA backbone has been clustered into discrete recurring conformations <xref ref-type="bibr" rid="pcbi.1000406-Sundaralingam1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1000406-Murray1">[9]</xref>–<xref ref-type="bibr" rid="pcbi.1000406-Hershkovitz1">[11]</xref>. These new insights have led to several useful tools for modeling RNA 3-D structure <xref ref-type="bibr" rid="pcbi.1000406-Shapiro1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Davis1">[12]</xref> and significant advances in atomic resolution prediction have recently been reported <xref ref-type="bibr" rid="pcbi.1000406-Parisien1">[13]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref>.</p>
<p>However, routine prediction of RNA 3-D structure still remains an important open problem, and with the growing gap between the number of known sequences and determined structures, the problem is becoming more and more pronounced. The two key ingredients in algorithms for RNA 3-D structure prediction, namely an accurate energy function and a conformational sampling procedure <xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref>, are both only partly solved problems. Here, we focus on the latter problem.</p>
<p>The current state of the art in RNA conformational sampling is based on fragment assembly methods, which construct plausible conformations by stringing together short fragments obtained from experimental structures. These methods have led to numerous important breakthroughs in the related fields of protein and RNA 3-D structure prediction in the last ten years <xref ref-type="bibr" rid="pcbi.1000406-Parisien1">[13]</xref>–<xref ref-type="bibr" rid="pcbi.1000406-Simons1">[15]</xref>. Nonetheless, fragment assembly methods are not a panacea. One of the problems associated with these methods is that they inherently discretize the continuous conformational space, and hence do not cover all relevant conformations <xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref>. This is problematic since the resolution of the conformational search procedure imposes limits on the energy function; the use of fine-grained energy terms requires continuous adjustments to the RNA's dihedral degrees of freedom, which fragment assembly methods cannot provide <xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref>. In other words, the shortcomings of the conformational sampling method need to be counteracted by tweaking the energy function. Furthermore, full conformational detail is of great importance for a complete understanding of RNA catalysis, binding <xref ref-type="bibr" rid="pcbi.1000406-Murray1">[9]</xref> and dynamics <xref ref-type="bibr" rid="pcbi.1000406-AlHashimi1">[16]</xref>.</p>
<p>Another fundamental problem with fragment assembly methods is their non-probabilistic nature, which makes their rigorous use in the framework of statistical physics problematic. Particularly, it is currently impossible to ensure unbiased sampling (which requires the property of detailed balance <xref ref-type="bibr" rid="pcbi.1000406-Gilks1">[17]</xref>) in a Markov chain Monte Carlo (MCMC) framework using fragment assembly as a proposal function <xref ref-type="bibr" rid="pcbi.1000406-Przytycka1">[18]</xref>. In other words, using a fragment library implies adding an inherently unknown additional term to the energy function <xref ref-type="bibr" rid="pcbi.1000406-Przytycka1">[18]</xref>. This means that the unbiased simulation of the dynamics of an RNA molecule under the control of an all-atom empirical forcefield using fragment assembly methods is currently impossible.</p>
<p>For these reasons we have developed a new solution to the conformational sampling problem: a probabilistic model, called BARNACLE, that describes RNA structure in a natural, continuous space. BARNACLE makes it possible to efficiently sample 3-D conformations that are RNA-like on a short length scale. Such a model can be used purely as a proposal distribution, but also as an energy term enforcing realistic local conformations. Imposing favorable long range interactions, such as hydrogen bonding between the bases, lies outside the scope of such a local model and is the task of a global energy function.</p>
<p>BARNACLE combines a dynamic Bayesian network (DBN) <xref ref-type="bibr" rid="pcbi.1000406-Ghahramani1">[19]</xref>, which suits the sequential nature of the RNA molecule, with directional statistics, a branch of statistics that is concerned with the representation of angular data. The model is not only computationally attractive, but can also be rigorously interpreted in the language of statistical physics <xref ref-type="bibr" rid="pcbi.1000406-Hamelryck1">[20]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Boomsma1">[21]</xref>, making it attractive from a theoretical viewpoint as well.</p>
<p>This approach is conceptually related to the probabilistic models of protein structure recently proposed by our group <xref ref-type="bibr" rid="pcbi.1000406-Hamelryck1">[20]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Boomsma1">[21]</xref>. However, the model presented here is clearly far from a trivial extension, as an RNA molecule has many more degrees of freedom than a protein; in the RNA backbone alone, there are 11 angles per residue <xref ref-type="bibr" rid="pcbi.1000406-Saenger1">[22]</xref>, as opposed to two in proteins. These many degrees of freedom combined with the limited number of experimentally determined RNA structures <xref ref-type="bibr" rid="pcbi.1000406-Berman1">[23]</xref> make this a particularly challenging statistical task for which a very different strategy was required. In particular, the approach we used for proteins would in the case of RNA require the use of a probability density function on the 7-dimensional hypertorus, which poses a serious statistical and computational obstacle.</p>
<p>Below, we describe the probabilistic model in detail, and show that it captures the crucial aspects of local RNA structure. We also demonstrate its usefulness in the context of RNA 3-D prediction, and end with an outlook on possible applications.</p>
</sec><sec id="s2">
<title>Results</title>
<p>In this section, we first briefly explain the parameterization of RNA 3-D structure, then describe the probabilistic model and finally present an evaluation of its performance in various contexts.</p>
<sec id="s2a">
<title>Parameterization of RNA 3-D structure</title>
<p>Before we can formulate a probabilistic model, we need a mathematical parameterization of RNA 3-D structure. For each residue in an RNA molecule, the parameterization consists of the base type (A, C, G and U) and the seven dihedral angles <italic>α</italic>, <italic>β</italic>, <italic>γ</italic>, <italic>χ</italic>, <italic>δ</italic>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e001" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e002" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1000406-g001">Figure 1</xref>). In many other parameterizations, one or more additional parameters are used, such as the dihedral angles in the sugar ring <xref ref-type="bibr" rid="pcbi.1000406-Saenger1">[22]</xref>. However, it is possible to calculate the positions of all non-hydrogen atoms in an RNA structure based on the seven dihedral angles and the base type using the SN-NeRF algorithm <xref ref-type="bibr" rid="pcbi.1000406-Parsons1">[24]</xref> and assuming ideal bond lengths and angles <xref ref-type="bibr" rid="pcbi.1000406-Gelbin1">[25]</xref>. This parameterization is advantageous as it is simple, yet sufficient to describe any RNA conformation in atomic detail on a local length scale.</p>
<fig id="pcbi-1000406-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000406.g001</object-id><label>Figure 1</label><caption>
<title>Ball-and-stick representation of an RNA fragment.</title>
<p>The seven relevant dihedral angles in the central nucleotide (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e003" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e004" xlink:type="simple"/></inline-formula>) are indicated with red labels. Each label is placed on the central bond of the four consecutive atoms that define the dihedral angle. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e005" xlink:type="simple"/></inline-formula> angle describes the rotation of the base relative to the RNA backbone, while the six other angles define the course of the backbone. All atoms in the central nucleotide are labeled and colored according to atom type (oxygen: red, phosphor: yellow, nitrogen: blue and carbon/hydrogen: grey). For clarity, the base is only partly shown.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.g001" xlink:type="simple"/></fig></sec><sec id="s2b">
<title>Description of the probabilistic model</title>
<p>The aim of the model, BARNACLE (BAyesian network model of RNA using Circular distributions and maximum Likelihood Estimation), is to capture both the marginal distributions of each of the seven angles and the local dependencies between them. The main ideas behind the design of the model are (i) to model the marginal distributions of the seven dihedral angles by mixtures of univariate probability distributions, since such mixtures have proven ideal for approximating arbitrary distributions <xref ref-type="bibr" rid="pcbi.1000406-McLachlan1">[26]</xref>, and (ii) to model the dependencies between the angles through a Markov chain of hidden states.</p>
<p>We have implemented these ideas in a DBN (<xref ref-type="fig" rid="pcbi-1000406-g002">Figure 2</xref>) that uses one slice (with position index <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e006" xlink:type="simple"/></inline-formula>) for each angle in the parameterization of a given RNA fragment. For example, for two nucleotides <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e007" xlink:type="simple"/></inline-formula> and <italic>i</italic>+1, the DBN consists of 14 slices that represent the angles<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e008" xlink:type="simple"/></disp-formula>in the given order. Each slice, <italic>j</italic>, consists of three stochastic variables: an angle identifier, <italic>D<sub>j</sub></italic>, that specifies which of the seven angles is represented in a given slice, a hidden variable, <italic>H<sub>j</sub></italic>, that can adopt 20 different discrete states (which is the optimal number of states, see below and <xref ref-type="sec" rid="s4">Materials and Methods</xref>), and an angular variable, <italic>A<sub>j</sub></italic>, that adopts values in the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e009" xlink:type="simple"/></inline-formula>. The DBN models the conformational space of an RNA molecule with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e010" xlink:type="simple"/></inline-formula> angles by the probability distribution:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e011" xlink:type="simple"/><label>(1)</label></disp-formula>where the sum runs over all possible hidden node sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e012" xlink:type="simple"/></inline-formula>.</p>
<fig id="pcbi-1000406-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000406.g002</object-id><label>Figure 2</label><caption>
<title>BARNACLE: a dynamic Bayesian network (DBN) that models the dihedral angles in an RNA fragment.</title>
<p>In the graph, the nodes represent stochastic variables, and the arrows encode their conditional independencies. That is, the graph structure specifies the form of the joint probability distribution of the variables. The shown DBN represents nine consecutive dihedral angles, where the seven central angles originate from a single nucleotide. Each slice <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e013" xlink:type="simple"/></inline-formula> (a column of three variables) corresponds to one dihedral angle in an RNA fragment. The variables in each slice are: an angle identifier, <italic>D<sub>j</sub></italic>, a hidden variable, <italic>H<sub>j</sub></italic>, and an angular variable, <italic>A<sub>j</sub></italic>. The angle identifier keeps track of which dihedral angle (from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e014" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e015" xlink:type="simple"/></inline-formula>) is represented by a slice, while the angular node models the actual dihedral angle value. The hidden nodes induce dependencies between all angles along the sequence (and not just between angles in consecutive slices).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.g002" xlink:type="simple"/></fig>
<p>We model all the factors in this expression that involve discrete variables as conditional probability tables. To model the angular variable, we use the univariate von Mises distribution <xref ref-type="bibr" rid="pcbi.1000406-Mardia1">[27]</xref>. This is the circular equivalent of the Gaussian distribution, with the density function<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e016" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e017" xlink:type="simple"/></inline-formula> is the angle, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e018" xlink:type="simple"/></inline-formula> is the mean angle, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e019" xlink:type="simple"/></inline-formula> is a concentration parameter and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e020" xlink:type="simple"/></inline-formula> is the modified Bessel function of the first kind, order 0. More precisely, we use a von Mises distribution to model each of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e021" xlink:type="simple"/></inline-formula> distributions, with parameters determined by the value of the <italic>H<sub>j</sub></italic>. In this way each dihedral angle distribution is modeled as a weighted sum over the same set of 20 von Mises distributions. This idea is crucial for the development of a tractable model of this high dimensional space, as it leads to a very economical model, in which many parameters are common. Only 40 parameters are used for the von Mises distributions, which represent the angles in continuous space. The final model has only 537 non-zero parameters.</p>
<p>All the parameters are estimated by maximum-likelihood estimation from experimental RNA data (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). The calculation of the sum in the probability density function (equation (1)) can be efficiently calculated using the <italic>forward algorithm</italic> <xref ref-type="bibr" rid="pcbi.1000406-Durbin1">[28]</xref>. Also, efficient algorithms exist to sample from the probability distribution (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>).</p>
<p>We use the base type information in the construction of the 3-D atom positions, but do not explicitly represent the base type in the probabilistic model. The model only includes dihedral angles, and is thus a purely geometrical model. The reasons not to include base information directly into the model are two-fold: (i) by focusing on a purely geometric model we diminish the dimensionality of the problem, which is already substantial relative to the amount of data available, and (ii) the geometric model can easily be augmented with base information by a suitable energy function since the parameterization allows for the positioning of all the atoms in the base.</p>
</sec><sec id="s2c">
<title>Evaluation of BARNACLE</title>
<p>In the following section, we evaluate the model using four tests. In the first two tests, we examine how well the model describes local RNA structure by (i) an information-theoretic analysis of the angular distributions, including the distributions of individual angles and pairs of angles, and (ii) analyzing the length distribution of the most abundant substructure in RNA, the A-helix. In the third test, we examine if the model is consistent with the rotamer model introduced by Murray <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000406-Murray1">[9]</xref>. Finally, in the fourth test we evaluate how well the model performs in an MCMC algorithm for global RNA 3-D structure prediction. In the first three tests, we use a standard data set of experimentally determined RNA structures <xref ref-type="bibr" rid="pcbi.1000406-Murray1">[9]</xref>.</p>
<p>To the best of our knowledge, this is the first probabilistic model of local RNA 3-D structure in continuous space. Therefore, we construct our own baseline model for a meaningful comparison. The baseline model has the same design as BARNACLE (<xref ref-type="fig" rid="pcbi-1000406-g002">Figure 2</xref>), but without the (horizontal) arrows between the hidden variables, thereby removing the dependencies along the sequence. Such a model is called a <italic>mixture model</italic>. The use of a mixture model as baseline is highly appropriate for two reasons. First, a mixture model is theoretically able to approximate the marginal distributions of the individual angles arbitrarily well <xref ref-type="bibr" rid="pcbi.1000406-McLachlan1">[26]</xref>, and thus constitutes a challenging baseline. Second, it gives us the opportunity to test to what extent BARNACLE benefits from including sequential dependencies.</p>
</sec><sec id="s2d">
<title>Information-theoretic analysis of BARNACLE</title>
<p>In the first test, we compare BARNACLE to the mixture model using the information-theoretic approach, following Burnham and Anderson <xref ref-type="bibr" rid="pcbi.1000406-Burnham1">[29]</xref>. This approach is based on the Kullback-Leibler (KL) divergence, which is a natural measure of the distance (expressed in bits) between probability distributions <xref ref-type="bibr" rid="pcbi.1000406-Kullback1">[30]</xref>. For the selection of the best model for a given data set, this leads to the use of the Akaike Information Criterion (AIC). The AIC reaches a minimum value for the best model.</p>
<p>For BARNACLE, the minimum AIC value is reached at 20 hidden states and for the mixture model, at 25 hidden states (<xref ref-type="sec" rid="s4">Materials and Methods</xref>). According to the minimum AIC values, BARNACLE clearly outperforms the mixture model as a joint distribution over the data set, which illustrates the importance of taking the sequential dependencies into account.</p>
<p>Both models capture the multimodal nature and the skewness of the marginal distributions of the seven individual angles (<xref ref-type="fig" rid="pcbi-1000406-g003">Figure 3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000406.s001">Figure S1</xref>). The mixture model is expected to be more accurate at the level of the individual angular distributions <xref ref-type="bibr" rid="pcbi.1000406-McLachlan1">[26]</xref>, since sequential restraints are absent during its estimation. A comparison based on the difference between the KL divergence of the two models to the experimental data shows that this is indeed the case (see <xref ref-type="supplementary-material" rid="pcbi.1000406.s003">Table S1</xref>). This fact establishes the mixture model as a challenging baseline. However, the superiority of BARNACLE already becomes clear at the level of the pairwise angular distributions (within the same nucleotide, <xref ref-type="supplementary-material" rid="pcbi.1000406.s004">Table S2A</xref>, and in consecutive nucleotides, <xref ref-type="supplementary-material" rid="pcbi.1000406.s004">Table S2B</xref>). The difference in accuracy between the two models is also clearly visible in the corresponding pairwise histograms (<xref ref-type="fig" rid="pcbi-1000406-g004">Figure 4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000406.s002">Figure S2</xref>).</p>
<fig id="pcbi-1000406-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000406.g003</object-id><label>Figure 3</label><caption>
<title>The distributions of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e022" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e023" xlink:type="simple"/></inline-formula> angles.</title>
<p>The top figure shows the distributions of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e024" xlink:type="simple"/></inline-formula> angle and the bottom figure shows the distributions of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e025" xlink:type="simple"/></inline-formula> angle. The distributions in the experimental data set are shown as histograms. The density functions for the angles in the mixture model and BARNACLE are shown as light and dark grey lines, respectively. Both models capture the tri-modal nature of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e026" xlink:type="simple"/></inline-formula> angle and the skewed distribution of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e027" xlink:type="simple"/></inline-formula> angle. See <xref ref-type="supplementary-material" rid="pcbi.1000406.s002">Figure S2</xref> for plots of all 7 angles.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.g003" xlink:type="simple"/></fig><fig id="pcbi-1000406-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000406.g004</object-id><label>Figure 4</label><caption>
<title>Histograms of pairwise angle distributions.</title>
<p>The figure shows the distributions in the experimental data set (left column) and in data sampled from BARNACLE (middle column) and the mixture model (right column). Top row: the pairwise distributions of the dihedral angles <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e028" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e029" xlink:type="simple"/></inline-formula> within a nucleotide. Bottom row: the pairwise distributions of the inter-nucleotide angles <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e030" xlink:type="simple"/></inline-formula> and <italic>α</italic>, where each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e031" xlink:type="simple"/></inline-formula> angle is paired with the neighboring <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e032" xlink:type="simple"/></inline-formula> angle in the 3′-end direction.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.g004" xlink:type="simple"/></fig></sec><sec id="s2e">
<title>BARNACLE captures the length distribution of helices</title>
<p>In the second test, we evaluate how well BARNACLE captures the length distribution of the helical regions in RNA. The idea is to examine how well BARNACLE captures longer range dependencies between the dihedral angles. We do so by first sampling a set of structures from both BARNACLE and the mixture model (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). We then use the publicly available program Suitename <xref ref-type="bibr" rid="pcbi.1000406-Richardson1">[31]</xref> to identify all A-helix rotamers in both the sampled data sets and in the experimental data set. Finally, we analyze the distributions of the helix lengths in the three data sets, where helix length is defined as the number of consecutive A-helix rotamers.</p>
<p>The histograms for the experimental data set and the data set sampled from BARNACLE exhibit the same exponentially decaying distribution (<xref ref-type="fig" rid="pcbi-1000406-g005">Figure 5</xref>). In contrast, the histogram for the samples drawn from the mixture model decays significantly faster than the two others. The differences can again be quantified using the KL divergence. For the histograms of helices up to length 16, the KL divergence from the experimental length distribution to the length distribution in the BARNACLE data set is 0.014 bits, whereas the KL divergence for the mixture model data set is as large as 1.10 bits.</p>
<fig id="pcbi-1000406-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000406.g005</object-id><label>Figure 5</label><caption>
<title>Histograms of the lengths of helical regions.</title>
<p>The distributions in the experimental data set, and in the data sets sampled from BARNACLE and the mixture model are shown. The length is defined as the number of consecutive A-helix rotamers.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.g005" xlink:type="simple"/></fig>
<p>In conclusion, BARNACLE captures the length distribution of the helical regions. The comparison with the mixture model makes it clear that in this context the model benefits considerably from including the sequential dependencies between the angles.</p>
</sec><sec id="s2f">
<title>BARNACLE is consistent with an established rotamer model</title>
<p>In the third test, we evaluate whether BARNACLE is consistent with a discrete rotamer model that was first introduced in 2003 by Murray <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000406-Murray1">[9]</xref>. This rotamer model is currently used in the software package MolProbity <xref ref-type="bibr" rid="pcbi.1000406-Davis1">[12]</xref> for validation of the local structure of experimentally determined structures. In this model, all local structures are clustered into 46 different types, each represented by a single rotamer.</p>
<p>We first sample a set of structures from BARNACLE and the mixture model (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). The rotamers in the sampled and the experimental data sets are categorized using the program Suitename <xref ref-type="bibr" rid="pcbi.1000406-Richardson1">[31]</xref>, and their frequencies of occurrence are compared.</p>
<p>Strikingly, all 46 rotamer types are present in the BARNACLE samples. In addition, the fractions of the 45 non-helical rotamer types are similar in the experimental data set and in the BARNACLE samples (<xref ref-type="fig" rid="pcbi-1000406-g006">Figure 6</xref>). Finally, the percentage of A-helix rotamers also matches closely (74.6% in the experimental data set and 76.1% in the BARNACLE data).</p>
<fig id="pcbi-1000406-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000406.g006</object-id><label>Figure 6</label><caption>
<title>Histograms of the rotamer distributions in the non-helical regions.</title>
<p>The figure shows the distributions in the experimental data set (top and bottom), in the BARNACLE samples (top) and in the mixture model samples (bottom). The names of the rotamers, as defined by the RNA Ontology Consortium <xref ref-type="bibr" rid="pcbi.1000406-Richardson1">[31]</xref>, are used as index on the horizontal axis. The rotamers are sorted along the horizontal axis according to their frequency in the experimental data set.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.g006" xlink:type="simple"/></fig>
<p>Turning to the mixture model for comparison, we see that the fractions of the 45 non-helical rotamers in the experimental data set and in the samples are markedly different (<xref ref-type="fig" rid="pcbi-1000406-g006">Figure 6</xref>), and that the percentage of A-helix rotamers is considerably lower than in the experimental data set (53.2% versus 74.6%). In addition, the percentage of conformations that do not belong to any of the rotamers is markedly higher for the mixture model (28.0%) than for BARNACLE (20.1%) and the experimental data set (14.2%). Finally, the KL divergence from the distribution of the 46 rotamers in the experimental data set is higher to the mixture model data (1.83 bits) than to the BARNACLE data (0.20 bits).</p>
<p>Hence, BARNACLE is consistent with the rotamer model and also in this context, the model benefits from including sequential dependencies.</p>
</sec><sec id="s2g">
<title>BARNACLE generates RNA-like decoys</title>
<p>In the fourth and final test, we use BARNACLE to generate decoy structures for ten different RNA target structures, solely using coarse-grained base-pairing information (that is, secondary structure information).</p>
<p>We generate these structures using an MCMC method based on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e033" xlink:type="simple"/></inline-formula> multihistogram sampling <xref ref-type="bibr" rid="pcbi.1000406-Hesselbo1">[32]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-FerkinghoffBorg1">[33]</xref>, which makes it possible to obtain samples from BARNACLE that fall within a specified, favorable energy interval. In other words, we can sample from BARNACLE conditional upon a favorable energy. As energy function, we use a simple base pairing energy (measured in Å) that reaches a minimum when all the hydrogen bonds that are implied in the native secondary structure are present. In this way, we sample a large number of structures with correct secondary structure, but with all the fine-grained conformational details entirely left up to BARNACLE. The goal of this test is to examine whether BARNACLE is capable of generating plausible RNA structures from coarse grained base-pairing information only.</p>
<p>The test consists of using the MCMC method to generate a large number of decoys for each of the ten targets (see <xref ref-type="supplementary-material" rid="pcbi.1000406.s005">Table S3</xref> for details on execution). We consider all decoys that have good secondary structure (energy less than 1.0 Å) and evaluate their <italic>all-atom RMSD</italic> (including all non-hydrogen atoms) and the <italic>C4′ trace RMSD</italic> after optimal superimposition with the target RNA structure.</p>
<p>As a baseline, we again use the mixture model. We also include another baseline; a model in which each angle distribution is modeled by the uniform distribution on the circle. The RMSD values for the best decoys are shown in <xref ref-type="table" rid="pcbi-1000406-t001">Table 1</xref>. In this table, we have for comparison also included results from the lowest RMSD decoys obtained by Das and Baker's FARNA method on the same set of structures <xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref>. The target structures we use in this test are the single chain subset of the structures used to evaluate FARNA. To avoid bias, the models were re-trained on structures that were not homologous to any of the target structures <xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref> (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>).</p>
<table-wrap id="pcbi-1000406-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000406.t001</object-id><label>Table 1</label><caption>
<title>Generation of RNA decoys using secondary structure information.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000406-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="3" rowspan="1">Structure description</td>
<td align="left" colspan="2" rowspan="1">BARNACLE</td>
<td align="left" colspan="2" rowspan="1">Mixture model</td>
<td align="left" colspan="2" rowspan="1">Uniform model</td>
<td align="left" colspan="1" rowspan="1">FARNA</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">PDB ID</td>
<td align="left" colspan="1" rowspan="1">Len</td>
<td align="left" colspan="1" rowspan="1">Bps</td>
<td align="left" colspan="1" rowspan="1">RMSD</td>
<td align="left" colspan="1" rowspan="1">C4′ RMSD</td>
<td align="left" colspan="1" rowspan="1">RMSD</td>
<td align="left" colspan="1" rowspan="1">C4′ RMSD</td>
<td align="left" colspan="1" rowspan="1">RMSD</td>
<td align="left" colspan="1" rowspan="1">C4′ RMSD</td>
<td align="left" colspan="1" rowspan="1">C4′ RMSD</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">1ESY</td>
<td align="left" colspan="1" rowspan="1">19</td>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="left" colspan="1" rowspan="1"><bold>2.44</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>1.26</bold></td>
<td align="left" colspan="1" rowspan="1">2.61</td>
<td align="left" colspan="1" rowspan="1">1.43</td>
<td align="left" colspan="1" rowspan="1">8.14</td>
<td align="left" colspan="1" rowspan="1">6.96</td>
<td align="left" colspan="1" rowspan="1">1.44</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1KKA</td>
<td align="left" colspan="1" rowspan="1">17</td>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="left" colspan="1" rowspan="1"><bold>2.97</bold></td>
<td align="left" colspan="1" rowspan="1">2.23</td>
<td align="left" colspan="1" rowspan="1">3.45</td>
<td align="left" colspan="1" rowspan="1">2.16</td>
<td align="left" colspan="1" rowspan="1">6.57</td>
<td align="left" colspan="1" rowspan="1">5.42</td>
<td align="left" colspan="1" rowspan="1"><bold>2.08</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1L2X</td>
<td align="left" colspan="1" rowspan="1">27</td>
<td align="left" colspan="1" rowspan="1">8</td>
<td align="left" colspan="1" rowspan="1"><bold>3.87</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>2.77</bold></td>
<td align="left" colspan="1" rowspan="1">4.99</td>
<td align="left" colspan="1" rowspan="1">4.02</td>
<td align="left" colspan="1" rowspan="1">9.11</td>
<td align="left" colspan="1" rowspan="1">8.28</td>
<td align="left" colspan="1" rowspan="1">3.11</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1Q9A</td>
<td align="left" colspan="1" rowspan="1">27</td>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="left" colspan="1" rowspan="1"><bold>3.35</bold></td>
<td align="left" colspan="1" rowspan="1">2.92</td>
<td align="left" colspan="1" rowspan="1">5.01</td>
<td align="left" colspan="1" rowspan="1">4.41</td>
<td align="left" colspan="1" rowspan="1">8.70</td>
<td align="left" colspan="1" rowspan="1">7.82</td>
<td align="left" colspan="1" rowspan="1"><bold>2.65</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1QWA</td>
<td align="left" colspan="1" rowspan="1">21</td>
<td align="left" colspan="1" rowspan="1">8</td>
<td align="left" colspan="1" rowspan="1"><bold>2.96</bold></td>
<td align="left" colspan="1" rowspan="1">2.26</td>
<td align="left" colspan="1" rowspan="1">3.33</td>
<td align="left" colspan="1" rowspan="1">2.60</td>
<td align="left" colspan="1" rowspan="1">7.75</td>
<td align="left" colspan="1" rowspan="1">7.46</td>
<td align="left" colspan="1" rowspan="1"><bold>2.01</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1XJR</td>
<td align="left" colspan="1" rowspan="1">46</td>
<td align="left" colspan="1" rowspan="1">15</td>
<td align="left" colspan="1" rowspan="1"><bold>9.50</bold></td>
<td align="left" colspan="1" rowspan="1">9.36</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1"><bold>6.25</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1ZIH</td>
<td align="left" colspan="1" rowspan="1">12</td>
<td align="left" colspan="1" rowspan="1">4</td>
<td align="left" colspan="1" rowspan="1"><bold>0.95</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.80</bold></td>
<td align="left" colspan="1" rowspan="1">1.30</td>
<td align="left" colspan="1" rowspan="1">0.82</td>
<td align="left" colspan="1" rowspan="1">5.64</td>
<td align="left" colspan="1" rowspan="1">4.27</td>
<td align="left" colspan="1" rowspan="1">1.03</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">28SP</td>
<td align="left" colspan="1" rowspan="1">28</td>
<td align="left" colspan="1" rowspan="1">8</td>
<td align="left" colspan="1" rowspan="1"><bold>2.52</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>2.10</bold></td>
<td align="left" colspan="1" rowspan="1">5.53</td>
<td align="left" colspan="1" rowspan="1">4.70</td>
<td align="left" colspan="1" rowspan="1">9.97</td>
<td align="left" colspan="1" rowspan="1">9.79</td>
<td align="left" colspan="1" rowspan="1">2.31</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">2A43</td>
<td align="left" colspan="1" rowspan="1">26</td>
<td align="left" colspan="1" rowspan="1">7</td>
<td align="left" colspan="1" rowspan="1"><bold>3.58</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>2.65</bold></td>
<td align="left" colspan="1" rowspan="1">4.84</td>
<td align="left" colspan="1" rowspan="1">3.73</td>
<td align="left" colspan="1" rowspan="1">10.23</td>
<td align="left" colspan="1" rowspan="1">9.23</td>
<td align="left" colspan="1" rowspan="1">2.79</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">2F88</td>
<td align="left" colspan="1" rowspan="1">34</td>
<td align="left" colspan="1" rowspan="1">13</td>
<td align="left" colspan="1" rowspan="1"><bold>3.00</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>2.35</bold></td>
<td align="left" colspan="1" rowspan="1">5.11</td>
<td align="left" colspan="1" rowspan="1">4.78</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">2.41</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p><italic>Len</italic>: the number of nucleotides in the molecule; <italic>Bps</italic>: the number of Watson Crick and G–U wobble base pairs in the structure; <italic>RMSD</italic>: the all-atom RMSD of the decoys with the lowest all-atom RMSD from the native structure; <italic>C4′ RMSD</italic>: the C4′ RMSD of the decoy with the lowest C4′ RMSD from the native structure. <italic>FARNA C4′ RMSD</italic>: the C4′ RMSD for the decoys with the lowest C4′ RMSD obtained by Das and Baker's FARNA method <xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref>. A dash indicates that no structures with good base paring (energy below 1.0 Å) were obtained. All RMSD values are measured in Ångström (Å). Lowest (best) RMSD values are highlighted with bold face.</p></fn></table-wrap-foot></table-wrap>
<p>As shown in <xref ref-type="table" rid="pcbi-1000406-t001">Table 1</xref>, BARNACLE generates good decoys for all but the longest of the target structures (1XJR, which is equally challenging for the FARNA method). Most of the best decoys have all atom RMSD values below 4 Å, and C4′ RMSD values below 3 Å, and are thus close to the native target structure <xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref>. In all but one case, the best BARNACLE decoys have a lower RMSD than the best decoys generated using the mixture model, while in all cases, the uniform model performs considerably worse. The mixture model performs surprisingly well; for some of the targets the best decoys have an all-atom RMSD that is below 3 Å. However, when considering the RMSD distribution of all sampled decoys with good secondary structure, we see that BARNACLE generates more low RMSD decoys than the mixture model (<xref ref-type="supplementary-material" rid="pcbi.1000406.s006">Table S4</xref>); the 25% RMSD quantile for BARNACLE is in general lower than or about equal to the 5% quantile for the mixture model.</p>
<p>The best decoys for 1ZIH and 1L2X are shown in <xref ref-type="fig" rid="pcbi-1000406-g007">Figure 7</xref>. Note that for the structures generated with BARNACLE, the course of the backbone is very close to the native, and that for 1ZIH all the bases in the challenging loop region are also placed correctly. This can only be ascribed to the model, as the correct conformation of the backbone and of the bases in the loop is not directly promoted by the energy function. <xref ref-type="fig" rid="pcbi-1000406-g007">Figure 7</xref> clearly illustrates another way in which BARNACLE outperforms the mixture model: in the case of 1L2X, the course of the backbone is less RNA-like for the mixture model. These qualitative observations are confirmed quantitatively by the “suiteness” score (a structural quality score <xref ref-type="bibr" rid="pcbi.1000406-Davis1">[12]</xref>) of the decoys, which shows a considerably lower quality for the mixture model decoys (<xref ref-type="table" rid="pcbi-1000406-t002">Table 2</xref>). The uniform model performs much worse than both BARNACLE and the mixture model. Essentially it does not produce any realistic RNA conformations.</p>
<fig id="pcbi-1000406-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000406.g007</object-id><label>Figure 7</label><caption>
<title>Decoys generated using BARNACLE, the mixture model and the uniform model.</title>
<p>The decoys shown are those with the lowest full-atom RMSD from the native structures, among all decoys with good secondary structure (energy less than 1.0 Å). Decoys are shown for PDB structures 1ZIH and 1L2X. Pictures made using PyMOL (<ext-link ext-link-type="uri" xlink:href="http://www.pymol.org" xlink:type="simple">http://www.pymol.org</ext-link>).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.g007" xlink:type="simple"/></fig><table-wrap id="pcbi-1000406-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000406.t002</object-id><label>Table 2</label><caption>
<title>The average suiteness scores for the lowest RMSD decoys.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000406-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="3" rowspan="1">Structure description</td>
<td align="left" colspan="2" rowspan="1">BARNACLE</td>
<td align="left" colspan="2" rowspan="1">Mixture model</td>
<td align="left" colspan="2" rowspan="1">Uniform model</td>
<td align="left" colspan="1" rowspan="1">Target</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">PDB ID</td>
<td align="left" colspan="1" rowspan="1">Len</td>
<td align="left" colspan="1" rowspan="1">Bps</td>
<td align="left" colspan="1" rowspan="1">Best struct</td>
<td align="left" colspan="1" rowspan="1">Best C4′ struct</td>
<td align="left" colspan="1" rowspan="1">Best struct</td>
<td align="left" colspan="1" rowspan="1">Best C4′ struct</td>
<td align="left" colspan="1" rowspan="1">Best struct</td>
<td align="left" colspan="1" rowspan="1">Best C4′ struct</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">1ESY</td>
<td align="left" colspan="1" rowspan="1">19</td>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="left" colspan="1" rowspan="1"><bold>0.755</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.786</bold></td>
<td align="left" colspan="1" rowspan="1">0.571</td>
<td align="left" colspan="1" rowspan="1">0.640</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.168</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1KKA</td>
<td align="left" colspan="1" rowspan="1">17</td>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="left" colspan="1" rowspan="1"><bold>0.756</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.737</bold></td>
<td align="left" colspan="1" rowspan="1">0.715</td>
<td align="left" colspan="1" rowspan="1">0.637</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.210</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1L2X</td>
<td align="left" colspan="1" rowspan="1">27</td>
<td align="left" colspan="1" rowspan="1">8</td>
<td align="left" colspan="1" rowspan="1"><bold>0.652</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.629</bold></td>
<td align="left" colspan="1" rowspan="1">0.619</td>
<td align="left" colspan="1" rowspan="1">0.566</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.745</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1Q9A</td>
<td align="left" colspan="1" rowspan="1">27</td>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="left" colspan="1" rowspan="1"><bold>0.731</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.705</bold></td>
<td align="left" colspan="1" rowspan="1">0.604</td>
<td align="left" colspan="1" rowspan="1">0.575</td>
<td align="left" colspan="1" rowspan="1">0.001</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.714</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1QWA</td>
<td align="left" colspan="1" rowspan="1">21</td>
<td align="left" colspan="1" rowspan="1">8</td>
<td align="left" colspan="1" rowspan="1"><bold>0.789</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.827</bold></td>
<td align="left" colspan="1" rowspan="1">0.722</td>
<td align="left" colspan="1" rowspan="1">0.723</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.077</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1XJR</td>
<td align="left" colspan="1" rowspan="1">46</td>
<td align="left" colspan="1" rowspan="1">15</td>
<td align="left" colspan="1" rowspan="1"><bold>0.706</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.706</bold></td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">0.508</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">1ZIH</td>
<td align="left" colspan="1" rowspan="1">12</td>
<td align="left" colspan="1" rowspan="1">4</td>
<td align="left" colspan="1" rowspan="1"><bold>0.784</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.784</bold></td>
<td align="left" colspan="1" rowspan="1">0.675</td>
<td align="left" colspan="1" rowspan="1">0.610</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.505</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">28SP</td>
<td align="left" colspan="1" rowspan="1">28</td>
<td align="left" colspan="1" rowspan="1">8</td>
<td align="left" colspan="1" rowspan="1"><bold>0.812</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.816</bold></td>
<td align="left" colspan="1" rowspan="1">0.601</td>
<td align="left" colspan="1" rowspan="1">0.589</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.328</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">2A43</td>
<td align="left" colspan="1" rowspan="1">26</td>
<td align="left" colspan="1" rowspan="1">7</td>
<td align="left" colspan="1" rowspan="1"><bold>0.664</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.675</bold></td>
<td align="left" colspan="1" rowspan="1">0.529</td>
<td align="left" colspan="1" rowspan="1">0.456</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.692</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">2F88</td>
<td align="left" colspan="1" rowspan="1">34</td>
<td align="left" colspan="1" rowspan="1">13</td>
<td align="left" colspan="1" rowspan="1"><bold>0.746</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.776</bold></td>
<td align="left" colspan="1" rowspan="1">0.556</td>
<td align="left" colspan="1" rowspan="1">0.557</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">0.509</td>
</tr>
<tr>
<td align="left" colspan="3" rowspan="1">Average suiteness</td>
<td align="left" colspan="1" rowspan="1"><bold>0.732</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.737</bold></td>
<td align="left" colspan="1" rowspan="1">0.610</td>
<td align="left" colspan="1" rowspan="1">0.585</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.000</td>
<td align="left" colspan="1" rowspan="1">0.497</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt102"><label/><p>The table shows the average scores for the lowest RMSD decoys generated by BARNACLE, the mixture model and the uniform model. The average scores are calculated by Suitename <xref ref-type="bibr" rid="pcbi.1000406-Richardson1">[31]</xref> and higher scores indicate higher quality. <italic>Len</italic>: the number of nucleotides in the molecule; <italic>Bps</italic>: the number of Watson Crick and G–U wobble base pairs in the structure; <italic>Best struct</italic>: the average suiteness per suite for the lowest RMSD structure; <italic>Best C4′ struct</italic>: the average suiteness per suite for the lowest C4′ RMSD structure; <italic>Target</italic>: the average suiteness per suite for the experimental determined target structures. The highest (best) suiteness scores are highlighted with bold face. A dash indicates that no structures with the correct base paring (energy below 1.0 Å) were obtained.</p></fn></table-wrap-foot></table-wrap>
<p>It is finally worth noticing that the results obtained with BARNACLE for the ten structures are comparable to the results obtained with the FARNA method by Das and Baker <xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref>; for 6 of the target structures BARNACLE generates decoys with a lower RMSD than FARNA. BARNACLE (a sampling method, which we combine here with a very simple energy function based on native secondary structure) and FARNA (a full blown RNA prediction method) are of course very different methods, but the results indicate that BARNACLE can be used to generate state-of-the-art decoys in the context of 3-D RNA structure prediction in atomic detail.</p>
<p>However, the crucial improvement introduced by BARNACLE lies in providing a fully probabilistic sampling framework in continuous space, while maintaining state-of-the-art sampling quality (as shown by the comparison with FARNA). As pointed out before, sampling methods based on fragment assembly impose serious limits on the form of the energy function, and necessitates the use of unphysical energy terms. BARNACLE provides a satisfactory solution to this problem. The potential importance of BARNACLE is also illustrated by the enormous impact of the introduction of rigorous sampling methods on RNA secondary structure prediction <xref ref-type="bibr" rid="pcbi.1000406-Mathews1">[4]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Ding1">[5]</xref>.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>This study introduces a new approach to modeling local RNA 3-D structure. In contrast to previous approaches, we model the local conformational space as continuous, and in a fully probabilistic framework.</p>
<p>The introduced model has the potential to improve current structure prediction approaches in several ways. First, it allows for continuous adjustments in the conformational space, which accommodates the use of fine-grained energy terms. As pointed out by Das and Baker <xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref>, discrete models preclude that. Second, the probabilistic nature of BARNACLE enables unbiased sampling in an MCMC framework and makes it possible to include the local structural bias as a direct term in an energy function, which is not possible with non-probabilistic models.</p>
<p>Our model has several other potential uses, such as RNA structure validation. The current state of the art is to assign scores to short individual fragments based on their similarity to a set of rotamers <xref ref-type="bibr" rid="pcbi.1000406-Davis1">[12]</xref>. The model proposed here could be used to assign a likelihood to a whole sequence of dihedral angles or to pinpoint local stretches that have a low likelihood.</p>
<p>As for the quality of the model, we have shown that it captures the essential properties of local RNA structure, and that it is consistent with the rotameric model of RNA that underlies the structure validation tool MolProbity <xref ref-type="bibr" rid="pcbi.1000406-Davis1">[12]</xref>. In addition, we have demonstrated that the model readily generates good quality decoys for short RNA molecules using an MCMC framework and a simple energy function.</p>
<p>An obvious challenge for the future is to extend the model with sequence and evolutionary information. Given the high dimensionality of the problem, and the paucity of the data, this will pose a formidable statistical challenge.</p>
<p>With the development of the probabilistic model of local RNA structure and our previous work on probabilistic models of local protein structure <xref ref-type="bibr" rid="pcbi.1000406-Hamelryck1">[20]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Boomsma1">[21]</xref>, we have provided solutions to the conformational sampling problem for the two most important biological macromolecules: RNA and proteins. We expect to see considerable benefits from these models in many areas of application.</p>
</sec><sec id="s4">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Training and selecting a model</title>
<p>To obtain the final model, we optimized BARNACLE's parameters based on a set of known RNA structures, using the in-house dynamic Bayesian network software package Mocapy <xref ref-type="bibr" rid="pcbi.1000406-Hamelryck2">[34]</xref>. The optimization was done with the <italic>stochastic expectation maximization</italic> algorithm <xref ref-type="bibr" rid="pcbi.1000406-Nielsen1">[35]</xref>.</p>
<sec id="s4a1">
<title>Selecting number of hidden states</title>
<p>The optimal number of hidden states for BARNACLE was determined using the Akaike Information Criterion (AIC). We chose AIC over the two other model selection criteria, the <italic>Bayesian Information Criterion</italic> and the <italic>Integrated Completed Likelihood</italic>, since both criteria are known to underestimate the number of hidden states for density estimation <xref ref-type="bibr" rid="pcbi.1000406-Bishop1">[36]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Biernacki1">[37]</xref>, and clearly do so for our particular model design (data not shown). Both criteria point to models with fewer hidden states than the total number of modes in the angle distributions.</p>
<p>We trained seven models with 5, 10, 15, 20, 25, 30 and 40 hidden states, respectively. Each of these models were trained with 4 different initial sets of parameters, to avoid picking a model that converged to a local optimum. We chose the model with the lowest AIC score, resulting in 20 hidden states. We used the same training procedure for the baseline mixture model, which resulted in a model with 25 hidden states. The AIC plots for the two models can be seen in <xref ref-type="fig" rid="pcbi-1000406-g008">Figure 8</xref>.</p>
<fig id="pcbi-1000406-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000406.g008</object-id><label>Figure 8</label><caption>
<title>Selection of the best models using the Akaike Information Criterion.</title>
<p>The Akaike Information Criterion (AIC) scores are shown for all trained BARNACLE models (top) and mixture models (bottom). The AIC score reaches a minimum for the best model. The BARNACLE model with 20 hidden states, and the mixture model with 25 states have the best AIC scores (shown in red). The best models for each given number of hidden states are shown in black. The dotted lines are tendency lines constructed by cubic splines <xref ref-type="bibr" rid="pcbi.1000406-Forsythe1">[43]</xref>. The three outliers in the BARNACLE plot (at 10 and 15 hidden states) illustrate that the stochastic expectation maximization procedure can get stuck in a local optimum. Note that the best BARNACLE model has a lower (better) score than the best mixture model.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.g008" xlink:type="simple"/></fig></sec><sec id="s4a2">
<title>The Akaike Information Criterion</title>
<p>The Akaike Information Criterion (AIC) <xref ref-type="bibr" rid="pcbi.1000406-McLachlan1">[26]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Burnham1">[29]</xref> is a well established model selection criterion that favors the model which minimizes the expression<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e034" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e035" xlink:type="simple"/></inline-formula> is the likelihood of the model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e036" xlink:type="simple"/></inline-formula> given the data <italic>d</italic>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e037" xlink:type="simple"/></inline-formula> is the number of parameters. The AIC score is an estimate of the expected relative Kullback-Leibler divergence between the unknown mechanism that generated the data and the model fitted to the data <xref ref-type="bibr" rid="pcbi.1000406-Burnham1">[29]</xref> (for a definition of Kullback-Leibler divergence see below).</p>
</sec></sec><sec id="s4b">
<title>Training data</title>
<p>As training data, we used the angles from the structures in the 2005 version of the RNA data set compiled by Murray <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000406-Murray1">[9]</xref>, which consists of RNA 3-D structures of good quality determined by X-ray crystallography. For all the tests, except the decoy test, we used the entire data set for training. For the decoy test, we trained the models using the RNA data in the large ribosomal subunit (PDB code 1S72) in order to avoid bias from homologous structures <xref ref-type="bibr" rid="pcbi.1000406-Das1">[14]</xref>. For target 1Q9A, the homologous sequence at residues 2684–2710 in structure 1S72 was removed before training. Before we used the data set we removed outliers and ensured that the data consists of unbroken chains.</p>
<sec id="s4b1">
<title>Outlier removal</title>
<p>The compilers of the data set pointed out that the data set contains errors <xref ref-type="bibr" rid="pcbi.1000406-Murray1">[9]</xref>. Hence, we performed an outlier removal by applying the outlier definition of Knorr and Ng <xref ref-type="bibr" rid="pcbi.1000406-Knorr1">[38]</xref> to every angle pair within a residue. This led to the removal of the worst outliers, but did not significantly decrease the size of the data set: 971 out of 70,803 angles were removed.</p>
</sec><sec id="s4b2">
<title>Chain breaks</title>
<p>Some PDB files in the data set lack whole residues in the middle of a chain. We identified such residues by considering the bond distances O3′-P between consecutive residues. When such a distance was more than 50 times the standard deviation <xref ref-type="bibr" rid="pcbi.1000406-Gelbin1">[25]</xref>, we split the chain up at this point. Since we want to preserve the sequentiality in the data set, we use the Needlemann-Wunch algorithm <xref ref-type="bibr" rid="pcbi.1000406-Needleman1">[39]</xref> to align all the pieces to the full base sequence specified in the PDB header (the algorithm was modified to only allow insertions at split points). In this way, we calculate how many residues are missing. The missing residues are simply treated as missing data in the stochastic expectation maximization training procedure <xref ref-type="bibr" rid="pcbi.1000406-Nielsen1">[35]</xref>.</p>
</sec></sec><sec id="s4c">
<title>Sampling</title>
<p>It is possible to sample from BARNACLE in two different ways: one can (i) sample an entire sequence of angles, or (ii) resample a segment in an angle sequence seamlessly, that is, conditional upon the remaining angles. In both cases, the resulting angle sequence is subsequently converted into atomic coordinates.</p>
<sec id="s4c1">
<title>Sampling a sequence of angles</title>
<p>Sampling a sequence of angles is done using a three step procedure. First, one specifies the values of the angle identifier nodes, which for an RNA fragment of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e038" xlink:type="simple"/></inline-formula> nucleotides consists of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e039" xlink:type="simple"/></inline-formula> repeats of the sequence <italic>α</italic>, <italic>β</italic>, <italic>γ</italic>, <italic>χ</italic>, <italic>δ</italic>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e040" xlink:type="simple"/></inline-formula> and <italic>ζ</italic>. Then, the values of the hidden nodes, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e041" xlink:type="simple"/></inline-formula> are sampled from one end to the other, from the distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e042" xlink:type="simple"/></inline-formula>. Finally, the angular values are sampled from the distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e043" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4c2">
<title>Resampling a segment of angles</title>
<p>Assume that we have sampled a sequence of hidden values, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e044" xlink:type="simple"/></inline-formula>, and a sequence of angle values, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e045" xlink:type="simple"/></inline-formula>, given an appropriate sequence of identifier variables, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e046" xlink:type="simple"/></inline-formula>. Resampling a subsequence, from position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e047" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e048" xlink:type="simple"/></inline-formula> can then be done using the forward-backtrack algorithm <xref ref-type="bibr" rid="pcbi.1000406-Hamelryck1">[20]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Boomsma1">[21]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Cawley1">[40]</xref>. This algorithm is a two step procedure.</p>
<p>In the first step the hidden variables, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e049" xlink:type="simple"/></inline-formula> <italic>h<sub>m</sub></italic>, are resampled. This is done by first calculating the forward variables<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e050" xlink:type="simple"/></disp-formula>for each possible hidden node value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e051" xlink:type="simple"/></inline-formula> in each slice <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e052" xlink:type="simple"/></inline-formula>, using the forward algorithm <xref ref-type="bibr" rid="pcbi.1000406-Durbin1">[28]</xref>. Then the hidden nodes values, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e053" xlink:type="simple"/></inline-formula>, are sampled from position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e054" xlink:type="simple"/></inline-formula> to position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e055" xlink:type="simple"/></inline-formula> proportional to:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e056" xlink:type="simple"/></disp-formula>In the second step the angles, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e057" xlink:type="simple"/></inline-formula>, at each position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e058" xlink:type="simple"/></inline-formula>, are sampled from the distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e059" xlink:type="simple"/></inline-formula>.</p>
</sec></sec><sec id="s4d">
<title>Data sets used in the evaluations</title>
<p>We use data sets sampled from BARNACLE and the mixture model for the evaluations in the results section.</p>
<p>For the comparison of the pairwise angle distributions (<xref ref-type="fig" rid="pcbi-1000406-g004">Figure 4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000406.s002">Figure S2</xref>) we sampled data sets with the same size (9.8⋅10<sup>3</sup> nucleotides) and length distributions as the experimental data set.</p>
<p>For the comparison of the length distributions of helical regions (<xref ref-type="fig" rid="pcbi-1000406-g005">Figure 5</xref>) and the rotamer distribution (<xref ref-type="fig" rid="pcbi-1000406-g006">Figure 6</xref>), we sampled data sets of 100 times the size of the experimental data set (0.98⋅10<sup>6</sup> nucleotides), again with the same length distributions as the experimental data set. For these two comparisons, the data set has to be this large to ensure a sufficient sampling of the distribution in question from the mixture model. Certain rotamers (<xref ref-type="fig" rid="pcbi-1000406-g006">Figure 6</xref>) and long helical regions (<xref ref-type="fig" rid="pcbi-1000406-g005">Figure 5</xref>) only have negligible probabilities according to the mixture model, and for smaller sample sizes not all rotamers are sampled.</p>
</sec><sec id="s4e">
<title>Model evaluation using the Kullback-Leibler divergence</title>
<p>In the Results section, we use the Kullback-Leibler (KL) divergence <xref ref-type="bibr" rid="pcbi.1000406-Kullback1">[30]</xref> to measure the similarity between the experimental data and the models.</p>
<p>The KL divergence is a standard measure for the distance between two probability distributions. For two continuous probability density functions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e060" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e061" xlink:type="simple"/></inline-formula>, the KL divergence is defined as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e062" xlink:type="simple"/><label>(2)</label></disp-formula>while for two discrete probability mass functions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e063" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e064" xlink:type="simple"/></inline-formula> the KL divergence is defined as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e065" xlink:type="simple"/><label>(3)</label></disp-formula>Typically <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e066" xlink:type="simple"/></inline-formula> is taken to be an empirical data distribution or the “true” underlying distribution that generated the data, whereas <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e067" xlink:type="simple"/></inline-formula> typically represents a model or an approximation of <italic>p</italic>. The divergence is always non-negative and only becomes zero for equal distributions. When the binary logarithm is used in the definition, the divergence is measured in bits.</p>
<p>For the comparisons of the individual and pairwise angle distributions we use equation (2). We calculate the difference between the KL divergence from the experimental data set, <italic>p</italic>, to the mixture model, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e068" xlink:type="simple"/></inline-formula>, and the KL divergence from the experimental data set to BARNACLE, <italic>q</italic>, in the following way:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e069" xlink:type="simple"/></disp-formula>To calculate this expression, we use the fact that the KL divergence can be expressed in terms of statistical expectations <xref ref-type="bibr" rid="pcbi.1000406-Burnham1">[29]</xref>. The difference can be rewritten as the expectation with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e070" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e071" xlink:type="simple"/></disp-formula>Since the empirical distribution, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e072" xlink:type="simple"/></inline-formula>, is a set of observations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e073" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e074" xlink:type="simple"/></inline-formula>, we can calculate the expectations by averaging over these observations <xref ref-type="bibr" rid="pcbi.1000406-Do1">[41]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e075" xlink:type="simple"/></disp-formula></p>
<p>For the length distribution of the helical regions and the distribution of the 46 rotamers we use equation (3).</p>
</sec><sec id="s4f">
<title>Details on the MCMC simulations</title>
<p>The MCMC simulations are done in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e076" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000406-Hesselbo1">[32]</xref>, using the Metropolis-Hastings algorithm <xref ref-type="bibr" rid="pcbi.1000406-Gilks1">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000406-Hastings1">[42]</xref>, and the generalized multihistogram method for updating the weights <xref ref-type="bibr" rid="pcbi.1000406-FerkinghoffBorg1">[33]</xref>. The method has two main components: a proposal distribution, and an energy function (see below for details). The energy space is divided into <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e077" xlink:type="simple"/></inline-formula> bins (each of width 0.05 Å), and the method seeks to generate samples more often in low than in high energy bins. In particular, the target distribution is the density of states weighted according to the inverse of the cumulative density of states <xref ref-type="bibr" rid="pcbi.1000406-FerkinghoffBorg1">[33]</xref>. The final ensemble of sampled structure has the approximate property that the distribution of samples within each energy bin is the proposal distribution. In other words, we generate samples from BARNACLE that are conditional upon belonging to a low energy bin.</p>
<sec id="s4f1">
<title>Proposal distribution</title>
<p>We use three different models (BARNACLE, the mixture model and the uniform model) for the proposal distributions. For all three models, the proposals are constructed in the following way.</p>
<p>Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e078" xlink:type="simple"/></inline-formula> be the current candidate structure with the angle sequence <bold>x</bold><italic><sub>a</sub></italic>. The next candidate structure, <bold>x′</bold>, is then proposed by resampling a stretch of angles in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e079" xlink:type="simple"/></inline-formula> according to the model, and calculating the atom positions corresponding to the new angle sequence <bold>x′</bold><italic><sub>a</sub></italic>. For BARNACLE the resampling is efficiently done using the forward-backtrack algorithm (for a description see section on Sampling). For the mixture model and the uniform model, each angle in the subsequence can be resampled individually, since all angles are independent according to these models.</p>
<p>The length of the sequence to be resampled is drawn from a Poisson distribution with mean 2 that is truncated at the maximum number of angles in the target structure.</p>
<p>We require that all sampled structures are clash free; if a clash occurs, the structure is immediately rejected. We define a clash as a pair of non-covalently bonded atoms that are closer to each other than 1.8 Å.</p>
</sec><sec id="s4f2">
<title>Energy function</title>
<p>We use a distance-based energy function that enforces a desired secondary structure (Watson Crick and G–U wobble base pairs). The energy function is constructed in the following way.</p>
<p>Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e080" xlink:type="simple"/></inline-formula> be the distances between the donors and acceptors in each of the hydrogen bonds making up the desired secondary structure in a structure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e081" xlink:type="simple"/></inline-formula> (every A–U and G–U pair contributes two distances, and every C–G pair contributes three distances). The base paring energy of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e082" xlink:type="simple"/></inline-formula> is then defined as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e083" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000406.e084" xlink:type="simple"/></inline-formula> is a reference value for the hydrogen bond distance in the particular type of base pair. The reference value for each of the 7 donor-acceptor distances is calculated as the mean distance in the structures from the 2005 version of the RNA data set compiled by Murray <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000406-Murray1">[9]</xref>. The energy is measured in Å, and the minimal base pair energy of 0 Å is only obtained for structures with perfect base paring.</p>
<p>For the simulations presented in <xref ref-type="table" rid="pcbi-1000406-t001">Table 1</xref>, the enforced secondary structure is the secondary structure of the target structure.</p>
</sec></sec><sec id="s4g">
<title>Availability</title>
<p>A software implementation of BARNACLE is freely available on SourceForge (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/barnacle-rna/" xlink:type="simple">http://sourceforge.net/projects/barnacle-rna/</ext-link>).</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000406.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.s001" xlink:type="simple"><label>Figure S1</label><caption>
<p>The marginal distributions of all seven individual angles.</p>
<p>(0.06 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000406.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.s002" xlink:type="simple"><label>Figure S2</label><caption>
<p>Histograms of pairwise angle distributions with the highest and lowest KL difference.</p>
<p>(0.49 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000406.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.s003" xlink:type="simple"><label>Table S1</label><caption>
<p>The KL divergences for the seven individual angles.</p>
<p>(0.01 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000406.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.s004" xlink:type="simple"><label>Table S2</label><caption>
<p>The KL divergences for angle pairs.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000406.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.s005" xlink:type="simple"><label>Table S3</label><caption>
<p>Execution time of the MCMC algorithm.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000406.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000406.s006" xlink:type="simple"><label>Table S4</label><caption>
<p>The 5% and 25% quantiles of the RMSD distributions for decoys with correct base pairing.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank our colleagues at the Bioinformatics Centre (University of Copenhagen) for valuable comments and suggestions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000406-Eddy1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
</person-group>             <year>2001</year>             <article-title>Non-coding RNA genes and the modern RNA world.</article-title>             <source>Nat Rev Genet</source>             <volume>2</volume>             <fpage>919</fpage>             <lpage>929</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Amaral1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Amaral</surname><given-names>PP</given-names></name>
<name name-style="western"><surname>Dinger</surname><given-names>ME</given-names></name>
<name name-style="western"><surname>Mercer</surname><given-names>TR</given-names></name>
<name name-style="western"><surname>Mattick</surname><given-names>JS</given-names></name>
</person-group>             <year>2008</year>             <article-title>The eukaryotic genome as an RNA machine.</article-title>             <source>Science</source>             <volume>319</volume>             <fpage>1787</fpage>             <lpage>1789</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Shapiro1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shapiro</surname><given-names>BA</given-names></name>
<name name-style="western"><surname>Yingling</surname><given-names>YG</given-names></name>
<name name-style="western"><surname>Kasprzak</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Bindewald</surname><given-names>E</given-names></name>
</person-group>             <year>2007</year>             <article-title>Bridging the gap in RNA structure prediction.</article-title>             <source>Curr Opin Struct Biol</source>             <volume>17</volume>             <fpage>1</fpage>             <lpage>9</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Mathews1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mathews</surname><given-names>DH</given-names></name>
</person-group>             <year>2006</year>             <article-title>Revolutions in RNA secondary structure prediction.</article-title>             <source>J Mol Biol</source>             <volume>359</volume>             <fpage>526</fpage>             <lpage>532</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Ding1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ding</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name>
</person-group>             <year>2003</year>             <article-title>A statistical sampling algorithm for RNA secondary structure prediction.</article-title>             <source>Nucleic Acids Res</source>             <volume>31</volume>             <fpage>7280</fpage>             <lpage>7301</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Sundaralingam1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sundaralingam</surname><given-names>M</given-names></name>
</person-group>             <year>1969</year>             <article-title>Stereochemistry of nucleic acids and their constituents.</article-title>             <source>Biopolymers</source>             <volume>7</volume>             <fpage>821</fpage>             <lpage>860</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Murthy1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Murthy</surname><given-names>VL</given-names></name>
<name name-style="western"><surname>Srinivasan</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Draper</surname><given-names>DE</given-names></name>
<name name-style="western"><surname>Rose</surname><given-names>GD</given-names></name>
</person-group>             <year>1999</year>             <article-title>A complete conformational map for RNA.</article-title>             <source>J Mol Biol</source>             <volume>291</volume>             <fpage>313</fpage>             <lpage>327</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Leontis1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Leontis</surname><given-names>NB</given-names></name>
<name name-style="western"><surname>Westhof</surname><given-names>E</given-names></name>
</person-group>             <year>2001</year>             <article-title>Geometric nomenclature and classification of RNA base pairs.</article-title>             <source>RNA</source>             <volume>7</volume>             <fpage>499</fpage>             <lpage>512</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Murray1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Murray</surname><given-names>LJW</given-names></name>
<name name-style="western"><surname>Arendall</surname><given-names>WB</given-names><suffix>III</suffix></name>
<name name-style="western"><surname>Richardson</surname><given-names>DC</given-names></name>
<name name-style="western"><surname>Richardson</surname><given-names>JS</given-names></name>
</person-group>             <year>2003</year>             <article-title>RNA backbone is rotameric.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>100</volume>             <fpage>13904</fpage>             <lpage>13909</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Schneider1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schneider</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Morvek</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Berman</surname><given-names>H</given-names></name>
</person-group>             <year>2004</year>             <article-title>RNA conformational classes.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>1666</fpage>             <lpage>1677</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Hershkovitz1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hershkovitz</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Sapiro</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Tannenbaum</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Williams</surname><given-names>LD</given-names></name>
</person-group>             <year>2006</year>             <article-title>Statistical analysis of RNA backbone.</article-title>             <source>IEEE/ACM Trans Comput Biol Bioinform</source>             <volume>3</volume>             <fpage>33</fpage>             <lpage>46</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Davis1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Davis</surname><given-names>IW</given-names></name>
<name name-style="western"><surname>Leaver-Fay</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Chen</surname><given-names>VB</given-names></name>
<name name-style="western"><surname>Block</surname><given-names>JN</given-names></name>
<name name-style="western"><surname>Kapral</surname><given-names>GJ</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>MolProbity: all-atom contacts and structure validation for proteins and nucleic acids.</article-title>             <source>Nucleic Acids Res</source>             <volume>35</volume>             <fpage>W375</fpage>             <lpage>W383</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Parisien1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Parisien</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Major</surname><given-names>F</given-names></name>
</person-group>             <year>2008</year>             <article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data.</article-title>             <source>Nature</source>             <volume>452</volume>             <fpage>51</fpage>             <lpage>55</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Das1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Das</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Baker</surname><given-names>D</given-names></name>
</person-group>             <year>2007</year>             <article-title>Automated de novo prediction of native-like RNA tertiary structures.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>104</volume>             <fpage>14664</fpage>             <lpage>14669</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Simons1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Simons</surname><given-names>KT</given-names></name>
<name name-style="western"><surname>Kooperberg</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Huang</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Baker</surname><given-names>D</given-names></name>
</person-group>             <year>1997</year>             <article-title>Assembly of protein structures from fragments with similar local sequences using Bayesian scoring functions.</article-title>             <source>J Mol Biol</source>             <volume>268</volume>             <fpage>209</fpage>             <lpage>225</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-AlHashimi1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Al-Hashimi</surname><given-names>HM</given-names></name>
<name name-style="western"><surname>Walter</surname><given-names>NG</given-names></name>
</person-group>             <year>2008</year>             <article-title>RNA dynamics: it is about time.</article-title>             <source>Curr Opin Struct Biol</source>             <volume>18</volume>             <fpage>321</fpage>             <lpage>329</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Gilks1"><label>17</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gilks</surname><given-names>WR</given-names></name>
<name name-style="western"><surname>Richardson</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Spiegelhalter</surname><given-names>D</given-names></name>
</person-group>             <year>1995</year>             <article-title>Introducing Markov chain Monte Carlo.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Gilks</surname><given-names>WR</given-names></name>
<name name-style="western"><surname>Richardson</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Spiegelhalter</surname><given-names>D</given-names></name>
</person-group>             <source>Markov Chain Monte Carlo in Practice: Interdisciplinary Statistics</source>             <publisher-loc>Boca Raton</publisher-loc>             <publisher-name>Chapman &amp; Hall/CRC</publisher-name>             <fpage>1</fpage>             <lpage>19</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Przytycka1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Przytycka</surname><given-names>T</given-names></name>
</person-group>             <year>2004</year>             <article-title>Significance of conformational biases in Monte Carlo simulations of protein folding: lessons from Metropolis-Hastings approach.</article-title>             <source>Proteins</source>             <volume>57</volume>             <fpage>338</fpage>             <lpage>334</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Ghahramani1"><label>19</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ghahramani</surname><given-names>Z</given-names></name>
</person-group>             <year>1998</year>             <article-title>Learning dynamic Bayesian networks.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Giles</surname><given-names>CL</given-names></name>
<name name-style="western"><surname>Gori</surname><given-names>M</given-names></name>
</person-group>             <source>Adaptive Processing of Sequences and Data Structures</source>             <publisher-loc>Berlin</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>             <fpage>168</fpage>             <lpage>197</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Hamelryck1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hamelryck</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Kent</surname><given-names>JT</given-names></name>
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
</person-group>             <year>2006</year>             <article-title>Sampling realistic protein conformations using local structural bias.</article-title>             <source>PLoS Comput Biol</source>             <volume>2</volume>             <fpage>e131</fpage>             <comment>doi:10.1371/journal.pcbi.0020131</comment>          </element-citation></ref>
<ref id="pcbi.1000406-Boomsma1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Boomsma</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Mardia</surname><given-names>KV</given-names></name>
<name name-style="western"><surname>Taylor</surname><given-names>CC</given-names></name>
<name name-style="western"><surname>Ferkinghoff-Borg</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>A generative, probabilistic model of local protein structure.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>105</volume>             <fpage>8932</fpage>             <lpage>8937</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Saenger1"><label>22</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Saenger</surname><given-names>W</given-names></name>
</person-group>             <year>1983</year>             <source>Principles of Nucleic Acid Structure</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>             <fpage>556</fpage>          </element-citation></ref>
<ref id="pcbi.1000406-Berman1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berman</surname><given-names>HM</given-names></name>
<name name-style="western"><surname>Olson</surname><given-names>WK</given-names></name>
<name name-style="western"><surname>Beveridge</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Westbrook</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Gelbin</surname><given-names>A</given-names></name>
<etal/></person-group>             <year>1992</year>             <article-title>The nucleic acid database: a comprehensive relational database of three-dimensional structures of nucleic acids.</article-title>             <source>Biophys J</source>             <volume>63</volume>             <fpage>751</fpage>             <lpage>759</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Parsons1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Parsons</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Holmes</surname><given-names>JB</given-names></name>
<name name-style="western"><surname>Rojas</surname><given-names>JM</given-names></name>
<name name-style="western"><surname>Tsai</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Strauss</surname><given-names>CEM</given-names></name>
</person-group>             <year>2005</year>             <article-title>Practical conversion from torsion space to Cartesian space for in silico protein synthesis.</article-title>             <source>J Comput Chem</source>             <volume>26</volume>             <fpage>1063</fpage>             <lpage>1068</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Gelbin1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gelbin</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Schneider</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Clowney</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Hsieh</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Olson</surname><given-names>WK</given-names></name>
<name name-style="western"><surname>Berman</surname><given-names>HM</given-names></name>
</person-group>             <year>1996</year>             <article-title>Geometric parameters in nucleic acids: sugar and phosphate constituents.</article-title>             <source>J Am Chem Soc</source>             <volume>118</volume>             <fpage>519</fpage>             <lpage>529</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-McLachlan1"><label>26</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>McLachlan</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Peel</surname><given-names>D</given-names></name>
</person-group>             <year>2000</year>             <source>Finite Mixture Models</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>John Wiley &amp; Sons</publisher-name>             <fpage>456</fpage>          </element-citation></ref>
<ref id="pcbi.1000406-Mardia1"><label>27</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mardia</surname><given-names>KV</given-names></name>
<name name-style="western"><surname>Jupp</surname><given-names>PE</given-names></name>
</person-group>             <year>1999</year>             <source>Directional Statistics</source>             <publisher-loc>Chichester</publisher-loc>             <publisher-name>John Wiley &amp; Sons</publisher-name>             <fpage>460</fpage>          </element-citation></ref>
<ref id="pcbi.1000406-Durbin1"><label>28</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Mitchison</surname><given-names>G</given-names></name>
</person-group>             <year>1998</year>             <source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</source>             <publisher-loc>Cambridge</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>             <fpage>368</fpage>          </element-citation></ref>
<ref id="pcbi.1000406-Burnham1"><label>29</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Burnham</surname><given-names>KP</given-names></name>
<name name-style="western"><surname>Anderson</surname><given-names>DR</given-names></name>
</person-group>             <year>2002</year>             <source>Model Selection and Multimodel Inference: A Practical Information-Theoretic Approach</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer</publisher-name>             <fpage>488</fpage>          </element-citation></ref>
<ref id="pcbi.1000406-Kullback1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kullback</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Leibler</surname><given-names>RA</given-names></name>
</person-group>             <year>1951</year>             <article-title>On information and sufficiency.</article-title>             <source>Ann Math Stat</source>             <volume>22</volume>             <fpage>79</fpage>             <lpage>86</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Richardson1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Richardson</surname><given-names>JS</given-names></name>
<name name-style="western"><surname>Schneider</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Murray</surname><given-names>LW</given-names></name>
<name name-style="western"><surname>Kapral</surname><given-names>GJ</given-names></name>
<name name-style="western"><surname>Immormino</surname><given-names>RM</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>RNA backbone: Consensus all-angle conformers and modular string nomenclature (an RNA Ontology Consortium contribution).</article-title>             <source>RNA</source>             <volume>14</volume>             <fpage>1</fpage>             <lpage>17</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Hesselbo1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hesselbo</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Stinchcombe</surname><given-names>RB</given-names></name>
</person-group>             <year>1995</year>             <article-title>Monte Carlo simulation and global optimization without parameters.</article-title>             <source>Phys Rev Lett</source>             <volume>74</volume>             <fpage>2151</fpage>             <lpage>2155</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-FerkinghoffBorg1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ferkinghoff-Borg</surname><given-names>J</given-names></name>
</person-group>             <year>2002</year>             <article-title>Optimized Monte Carlo analysis for generalized ensembles.</article-title>             <source>Eur Phys J B</source>             <volume>29</volume>             <fpage>481</fpage>             <lpage>484</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Hamelryck2"><label>34</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hamelryck</surname><given-names>T</given-names></name>
</person-group>             <year>2007</year>             <source>Mocapy: A Parallelized Toolkit for Learning and Inference in Dynamic Bayesian Networks</source>             <publisher-loc>Manual</publisher-loc>             <publisher-name>University of Copenhagen</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000406-Nielsen1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nielsen</surname><given-names>SF</given-names></name>
</person-group>             <year>2000</year>             <article-title>The stochastic EM algorithm: estimation and asymptotic results.</article-title>             <source>Bernoulli</source>             <volume>6</volume>             <fpage>457</fpage>             <lpage>489</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Bishop1"><label>36</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bishop</surname><given-names>CM</given-names></name>
</person-group>             <year>2006</year>             <source>Pattern Recognition and Machine Learning</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer New York</publisher-name>             <fpage>740</fpage>          </element-citation></ref>
<ref id="pcbi.1000406-Biernacki1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Biernacki</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Celeux</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Govaert</surname><given-names>G</given-names></name>
</person-group>             <year>2000</year>             <article-title>Assessing a mixture model for clustering with the Integrated Completed Likelihood.</article-title>             <source>IEEE Trans Pattern Anal Mach Intell</source>             <volume>22</volume>             <fpage>719</fpage>             <lpage>725</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Knorr1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Knorr</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Ng</surname><given-names>R</given-names></name>
</person-group>             <year>1998</year>             <article-title>Algorithms for mining distance-base outliers from large datasets.</article-title>             <source>Proceedings of 24rd International Conference on Very Large Data Bases</source>             <volume>24</volume>             <fpage>392</fpage>             <lpage>403</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Needleman1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Needleman</surname><given-names>SB</given-names></name>
<name name-style="western"><surname>Wunsch</surname><given-names>CD</given-names></name>
</person-group>             <year>1970</year>             <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins.</article-title>             <source>J Mol Biol</source>             <volume>48</volume>             <fpage>443</fpage>             <lpage>453</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Cawley1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cawley</surname><given-names>SL</given-names></name>
<name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>
</person-group>             <year>2003</year>             <article-title>HMM sampling and applications to gene finding and alternative splicing.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>36</fpage>             <lpage>41</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Do1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Do</surname><given-names>MN</given-names></name>
</person-group>             <year>2003</year>             <article-title>Fast approximation of Kullback-Leibler distance for dependence trees and hidden Markov models.</article-title>             <source>IEEE Signal Process Lett</source>             <volume>10</volume>             <fpage>115</fpage>             <lpage>118</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Hastings1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hastings</surname><given-names>WK</given-names></name>
</person-group>             <year>1970</year>             <article-title>Monte Carlo sampling methods using Markov chains and their applications.</article-title>             <source>Biometrika</source>             <volume>57</volume>             <fpage>97</fpage>             <lpage>109</lpage>          </element-citation></ref>
<ref id="pcbi.1000406-Forsythe1"><label>43</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Forsythe</surname><given-names>GE</given-names></name>
<name name-style="western"><surname>Malcolm</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Moler</surname><given-names>CB</given-names></name>
</person-group>             <year>1977</year>             <source>Computer Methods for Mathematical Computations</source>             <publisher-loc>New Jersey</publisher-loc>             <publisher-name>Prentice Hall</publisher-name>             <fpage>259</fpage>          </element-citation></ref>
</ref-list>

</back>
</article>