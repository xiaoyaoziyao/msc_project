<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0178789</article-id>
<article-id pub-id-type="publisher-id">PONE-D-16-49615</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject><subj-group><subject>Normal distribution</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability density</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>A constrained multinomial Probit route choice model in the metro network: Formulation, estimation and application</article-title>
<alt-title alt-title-type="running-head">CMNP model formulation, estimation and application</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zhang</surname>
<given-names>Yongsheng</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6943-9156</contrib-id>
<name name-style="western">
<surname>Yao</surname>
<given-names>Enjian</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Wei</surname>
<given-names>Heng</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zheng</surname>
<given-names>Kangning</given-names>
</name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>School of Traffic and Transportation, Beijing Jiaotong University, Beijing, China</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>MOE Key Laboratory for Urban Transportation Complex Systems Theory and Technology, Beijing Jiaotong University, Beijing, China</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Advanced Research in Transportation Engineering and Systems (ART-EngineS) Laboratory, College of Engineering and Applied Science, The University of Cincinnati, Cincinnati, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>School of Traffic and Transportation, Beijing Jiaotong University, Beijing, China</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ma</surname>
<given-names>Xiaolei</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Beihang University, CHINA</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"> <list-item>
<p><bold>Conceptualization:</bold> YZ EY.</p></list-item> <list-item>
<p><bold>Funding acquisition:</bold> EY.</p></list-item> <list-item>
<p><bold>Methodology:</bold> YZ EY HW KZ.</p></list-item> <list-item>
<p><bold>Writing – original draft:</bold> YZ EY HW KZ.</p></list-item> <list-item>
<p><bold>Writing – review &amp; editing:</bold> YZ EY HW KZ.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">enjyao@bjtu.edu.cn</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>7</day>
<month>6</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<year>2017</year>
</pub-date>
<volume>12</volume>
<issue>6</issue>
<elocation-id>e0178789</elocation-id>
<history>
<date date-type="received">
<day>16</day>
<month>12</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>18</day>
<month>5</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Zhang et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0178789"/>
<abstract>
<p>Considering that metro network expansion brings us with more alternative routes, it is attractive to integrate the impacts of routes set and the interdependency among alternative routes on route choice probability into route choice modeling. Therefore, the formulation, estimation and application of a constrained multinomial probit (CMNP) route choice model in the metro network are carried out in this paper. The utility function is formulated as three components: the compensatory component is a function of influencing factors; the non-compensatory component measures the impacts of routes set on utility; following a multivariate normal distribution, the covariance of error component is structured into three parts, representing the correlation among routes, the transfer variance of route, and the unobserved variance respectively. Considering multidimensional integrals of the multivariate normal probability density function, the CMNP model is rewritten as Hierarchical Bayes formula and M-H sampling algorithm based Monte Carlo Markov Chain approach is constructed to estimate all parameters. Based on Guangzhou Metro data, reliable estimation results are gained. Furthermore, the proposed CMNP model also shows a good forecasting performance for the route choice probabilities calculation and a good application performance for transfer flow volume prediction.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100005089</institution-id>
<institution>Beijing Municipal Natural Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>8171003</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6943-9156</contrib-id>
<name name-style="western">
<surname>Yao</surname>
<given-names>Enjian</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work is supported by Beijing Natural Science Foundation (grant number 8171003). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="2"/>
<page-count count="19"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>With new lines put into operation almost every year, the large scaled metro system has formed in some major cities in China, such as Beijing, Shanghai, Guangzhou and Shenzhen. Taking Guangzhou Metro for instance, up to the year of 2014, it is the sixth busiest metro system in the world and the third largest metro network in China with 9 lines, 164 stations including 21 transfer stations, and 260.5 km of tracks. In a large scaled metro network, the large number of transfer stations which brings plenty of routes for some origin-destination (OD) pairs increases the complexity of route choice modeling. Usually, according to a specific scheme, an individual chooses the best route among many alternative routes with comprehensive consideration of multiple factors, including the variables denoting the level of service of metro system, such as in-vehicle travel time, number of transfers, transfer time, congestion level, etc. and the variables describing the influence of topological structure of the metro network and route direction on passengers’ route choice preferences, such as angular cost [<xref ref-type="bibr" rid="pone.0178789.ref001">1</xref>–<xref ref-type="bibr" rid="pone.0178789.ref002">2</xref>].</p>
<p>The complex nature of route choice process responses to a large scaled metro system has brought challenges in establishing route choice model to reveal realistic behavioral decisions in the actual route choice process. Traditionally, with respect to route choice in a large scaled metro network, a route is chosen from a route set which is derived from attributes’ limitations, such as travel time and number of transfers. For example, for an OD pair, if the shortest travel time of one route is 30min, it is a common sense that passengers will not consider the route with more than 60min travel time. In this case, the 60min travel time is the limitation and the routes with less than 60min travel time constitutes the routes set. However, route choice and routes set steps are usually carried out separately and independently in the metro system which leads to losing the consistence between the two steps. For the two steps, the route choice step is a compensatory choice process which focuses on calculating the trade-offs among multiple influencing factors and the routes set generation step is a non-compensatory process which pays attention to the cut-offs associated with the attributes’ limitations. The non-compensatory behavior has been proved in the choice process [<xref ref-type="bibr" rid="pone.0178789.ref003">3</xref>–<xref ref-type="bibr" rid="pone.0178789.ref005">5</xref>]. And semi-compensatory route choice modelling which combines the routes set generation and route choice steps has attracted much more attention. The relationships between semi-compensatory, compensatory and non-compensatory choice processes are shown in <xref ref-type="fig" rid="pone.0178789.g001">Fig 1</xref>.</p>
<fig id="pone.0178789.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0178789.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The relationships of different choice processes.</title>
<p>In the figure, ‘A+B = C’ means C is the combination of A and B. The arrow displays the one-to-one match.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.g001" xlink:type="simple"/>
</fig>
<p>Meanwhile, route over-lapping problem in the large scaled metro network has already been figured out by Yai et al. [<xref ref-type="bibr" rid="pone.0178789.ref006">6</xref>]. Especially for some OD pairs with long direct distance, the fact that some alternative routes will share some links brings the correlation among the routes. Although most Logit-based models were satisfactory in representing route choice behavior associated with route over-lapping problem, they were still the approximate responses to the real behavior. In order to exactly express the interdependency among alternatives, Probit model [<xref ref-type="bibr" rid="pone.0178789.ref007">7</xref>] is more suitable though its estimation is a little harder than Logit models. Faced with elaborative operational requirements and services, the operational department is looking forward to a more advanced route choice model to reveal passengers’ actual route choice behaviors so as to support personalized travel service and travel demand prediction.</p>
<p>Therefore, it is necessary to establish a semi-compensatory Probit route choice model and design an easier estimation approach for practice. In this paper, a constrained multinomial Probit route choice model is proposed to reveal the realistic route choice process along with the estimation approach, focusing on analyzing the semi-compensatory choice behavior and representing the interdependency among alternative routes.</p>
</sec>
<sec id="sec002">
<title>Literature review</title>
<p>Route choice model based on random utility maximization (RUM) theory [<xref ref-type="bibr" rid="pone.0178789.ref008">8</xref>] mainly consists of two types, including Logit and Probit models. Among various models, Multinomial Logit (MNL) model [<xref ref-type="bibr" rid="pone.0178789.ref009">9</xref>] is the most widely used due to its easy estimation and application. Ramming, Raveau et al., Zhang et al. and Liu et al. successfully analyzed route choice behavior with the consideration of level of service, social demographics, travel purpose and route direction based on MNL model [<xref ref-type="bibr" rid="pone.0178789.ref001">1</xref>, <xref ref-type="bibr" rid="pone.0178789.ref002">2</xref>, <xref ref-type="bibr" rid="pone.0178789.ref010">10</xref>–<xref ref-type="bibr" rid="pone.0178789.ref011">11</xref>]. But the assumption that the error component follows an identical and independent (IID) Gumbel distribution induces many weaknesses. In order to alleviate one of the weakness, known as route over-lapping problem which is caused by the interdependency among routes, many extended Logit models are developed, such as C-Logit [<xref ref-type="bibr" rid="pone.0178789.ref012">12</xref>], Path Sized Logit (PSL) [<xref ref-type="bibr" rid="pone.0178789.ref013">13</xref>–<xref ref-type="bibr" rid="pone.0178789.ref014">14</xref>], Paired Combinatorial Logit (PCL) [<xref ref-type="bibr" rid="pone.0178789.ref015">15</xref>–<xref ref-type="bibr" rid="pone.0178789.ref016">16</xref>], Cross Nested Logit (CNL) [<xref ref-type="bibr" rid="pone.0178789.ref017">17</xref>], Generalized Nested Logit (GNL) [<xref ref-type="bibr" rid="pone.0178789.ref018">18</xref>], Mixed Logit [<xref ref-type="bibr" rid="pone.0178789.ref019">19</xref>], etc. For the application in the metro network, Raveau et al. applied successfully C-Logit model to analyze passengers’ route choice preferences [<xref ref-type="bibr" rid="pone.0178789.ref020">20</xref>]. However, Logit models cannot avoid IID distribution assumption to formulate probability equation with closed form, weakening the interdependency among alternative routes, while Probit model [<xref ref-type="bibr" rid="pone.0178789.ref007">7</xref>] can reflect deeply the interdependency by covariance, closer to passenger’s actual route choice behavior. Yai et al. proposed a Probit model with structured variance to analyze route choice behavior in the railway network, saving the computational time to an extent [<xref ref-type="bibr" rid="pone.0178789.ref006">6</xref>].</p>
<p>Those models mainly focus on the process that an individual chooses the best route from a given routes set. The consistence between the routes set generation and route choice processes is usually neglected for metro passengers. Considering the interplay between the two sub-processes, Zhang et al. [<xref ref-type="bibr" rid="pone.0178789.ref021">21</xref>] successfully introduced constrained multinomial logit (CMNL) model [<xref ref-type="bibr" rid="pone.0178789.ref022">22</xref>–<xref ref-type="bibr" rid="pone.0178789.ref023">23</xref>] into route choice modeling in the metro network to analyze passengers’ semi-compensatory choice behavior. Semi-compensatory models combining compensatory and non-compensatory behaviors have been paid more and more attention [<xref ref-type="bibr" rid="pone.0178789.ref024">24</xref>–<xref ref-type="bibr" rid="pone.0178789.ref026">26</xref>]. As one of two major approaches, the two-stage approach is widely used, consisting of two stages: generating all possible consideration routes sets and then choosing routes from the generated routes sets [<xref ref-type="bibr" rid="pone.0178789.ref027">27</xref>]. The consideration routes set is a subset of master routes set which is limited by some specific attributes. The two-stage approach is attractive that different models are allowed to explain each stage and many successful applications have already been found in the literature [<xref ref-type="bibr" rid="pone.0178789.ref028">28</xref>–<xref ref-type="bibr" rid="pone.0178789.ref030">30</xref>]. However, it leads to computational complex because too many consideration routes sets need to be constructed from master routes set [<xref ref-type="bibr" rid="pone.0178789.ref031">31</xref>]. And it also would have no sufficient robustness of choice prediction at the level of individual sets [<xref ref-type="bibr" rid="pone.0178789.ref032">32</xref>]. In order to avoid such a complex combinatorial number of choice sets, a kink called non-compensatory component is added to utility function, known as the second semi-compensatory choice modeling approach [<xref ref-type="bibr" rid="pone.0178789.ref033">33</xref>–<xref ref-type="bibr" rid="pone.0178789.ref034">34</xref>]. The non-compensatory component won’t affect the utility when the attribute value lies in the domain, while it will negatively and significantly affect the utility when the attribute value exceeds the threshold. The non-compensatory component simplifies the structure of semi-compensatory choice model and saves the computational time by avoiding huge number of consideration choice sets compared with the two-stage approach. However, in those researches, kinks in the utility function make it non-differentiable at the cut-off, which is difficult to be applied in equilibrium and optimization processes.</p>
<p>To solve this problem, a constrained multinomial logit (CMNL) route choice model [<xref ref-type="bibr" rid="pone.0178789.ref021">21</xref>] is developed where the non-compensatory component is a continuous function, making utility function differentiable at the cutoff. However, its error component still follows (IID) Gumbel distribution and the route over-lapping problem in the route choice context still needs to be solved. Moreover, compared with the Gumbel distribution, the normal distribution is more approximate to the actual distribution of error component. To address the aforementioned problems, a study for developing a constrained multinomial probit (CMNP) route choice model for metro passengers is proposed in the paper. In this model, the error component follows the normal distribution instead of the IID Gumbel distribution to avoid the weaknesses. The correlations among alternative routes are measured by the covariance matrix.</p>
<p>The following sections of this paper are organized as follows: Section 3 introduces the CMNP route choice modeling methodology; Section 4 is about the estimation approach which is carried out based on MCMC method after transforming the CMNP model into Bayesian formulation; in Section 5, the CMNP model is estimated by the proposed estimation approach based on surveyed RP data in Guangzhou Metro and applied in forecasting the transfer passengers volumes; Section 6 is the conclusions.</p>
</sec>
<sec id="sec003">
<title>Modeling methodology</title>
<p>Based on random utility theory, the utility function with constrained characteristic attributes mainly consists of three parts: compensatory, non-compensatory and error components.
<disp-formula id="pone.0178789.e001">
<alternatives>
<graphic id="pone.0178789.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
where with respect to route <italic>k</italic> for OD pair <italic>rs</italic>, <inline-formula id="pone.0178789.e002"><alternatives><graphic id="pone.0178789.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the generalized utility perceived by passenger <italic>n</italic>; <inline-formula id="pone.0178789.e003"><alternatives><graphic id="pone.0178789.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the compensatory component; <inline-formula id="pone.0178789.e004"><alternatives><graphic id="pone.0178789.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is non-compensatory component; <inline-formula id="pone.0178789.e005"><alternatives><graphic id="pone.0178789.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msubsup><mml:mi>ε</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the random error component.</p>
<p>The compensatory component <inline-formula id="pone.0178789.e006"><alternatives><graphic id="pone.0178789.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is a trade-off function of characteristic attributes, including level of service variables, network topology, etc. This function represents the compensatory trade-offs among attributes. For simplicity, the compensatory component is defined as a linear function of attributes as shown below.
<disp-formula id="pone.0178789.e007">
<alternatives>
<graphic id="pone.0178789.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>H</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
where <italic>H</italic> is the number of characteristic attributes; <italic>X</italic><sub><italic>k</italic>,<italic>h</italic></sub> denotes the attributes; <italic>θ</italic><sub><italic>n</italic>,<italic>h</italic></sub> is the corresponding parameters needed to be estimated.</p>
<p>The non-compensatory component <inline-formula id="pone.0178789.e008"><alternatives><graphic id="pone.0178789.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is a cut-off function which should satisfy below conditions:</p>
<list list-type="order">
<list-item><p>It should be a continuous function which guarantees the application in traffic equilibrium and optimization process.</p></list-item>
<list-item><p>If a constrained attribute value of one route exceeds threshold, non-compensatory component will let the route utility tend to be negative infinity. Otherwise, non-compensatory component tends to be zero.</p></list-item>
</list>
<p>Therefore, the non-compensatory component <inline-formula id="pone.0178789.e009"><alternatives><graphic id="pone.0178789.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is formulated in this paper as follows:
<disp-formula id="pone.0178789.e010">
<alternatives>
<graphic id="pone.0178789.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>ln</mml:mtext><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where <inline-formula id="pone.0178789.e011"><alternatives><graphic id="pone.0178789.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is a continuous function limited in (0, 1). The part <inline-formula id="pone.0178789.e012"><alternatives><graphic id="pone.0178789.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> can be formulated as a probability function which represents the probability that route <italic>k</italic> is considered after the comparison between the constrained attributes of route <italic>k</italic> and the corresponding thresholds. Usually, more than one attribute is the constraint, according to conjunctive screen rule [<xref ref-type="bibr" rid="pone.0178789.ref035">35</xref>], <inline-formula id="pone.0178789.e013"><alternatives><graphic id="pone.0178789.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> can be defined as follows:
<disp-formula id="pone.0178789.e014">
<alternatives>
<graphic id="pone.0178789.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e014" xlink:type="simple"/>
<mml:math display="block" id="M14">
<mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>φ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
where for OD pair <italic>r-s</italic>, <inline-formula id="pone.0178789.e015"><alternatives><graphic id="pone.0178789.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the constrained attribute <italic>i</italic> of route <italic>k</italic>; <italic>I</italic><sub><italic>n</italic></sub> is the number of attributes constrained by individual <italic>n</italic>; the function <inline-formula id="pone.0178789.e016"><alternatives><graphic id="pone.0178789.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msubsup><mml:mi>φ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> measures the considered probability influenced only by characteristic attribute <inline-formula id="pone.0178789.e017"><alternatives><graphic id="pone.0178789.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. To specify this function, we can assume a scenario that a constrained attribute <inline-formula id="pone.0178789.e018"><alternatives><graphic id="pone.0178789.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> with perceived error <italic>Ψ</italic><sub>1</sub> has an upper bound <inline-formula id="pone.0178789.e019"><alternatives><graphic id="pone.0178789.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> with perceived error <italic>Ψ</italic><sub>2</sub> (if it is a lower bound, the sign will reverse), then the function <inline-formula id="pone.0178789.e020"><alternatives><graphic id="pone.0178789.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msubsup><mml:mi>φ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> can be calculated by
<disp-formula id="pone.0178789.e021">
<alternatives>
<graphic id="pone.0178789.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e021" xlink:type="simple"/>
<mml:math display="block" id="M21">
<mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>φ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where for OD pair <italic>r-s</italic>, <inline-formula id="pone.0178789.e022"><alternatives><graphic id="pone.0178789.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the threshold of attribute <italic>i</italic> constrained for individual <italic>n</italic>.</p>
<p>In this paper, we assume that the perception errors of the constrained attribute and threshold both follow the normal distributions and are independent from each other. Further, the errors <italic>Ψ</italic><sub>1</sub> and <italic>Ψ</italic><sub>2</sub> respectively follow normal distributions <inline-formula id="pone.0178789.e023"><alternatives><graphic id="pone.0178789.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0178789.e024"><alternatives><graphic id="pone.0178789.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0178789.e025"><alternatives><graphic id="pone.0178789.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0178789.e026"><alternatives><graphic id="pone.0178789.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are the variances, and <italic>γ</italic><sub><italic>i</italic></sub> is the mean denoting the location parameter. According to the property of normal distribution, <italic>Ψ</italic><sub>1</sub>-<italic>Ψ</italic><sub>2</sub> still follows normal distribution, that is <italic>Ψ</italic><sub>1</sub>-<italic>Ψ</italic><sub>2</sub> ~<italic>N</italic>(−<italic>γ</italic><sub><italic>i</italic></sub>, σ<sup>2</sup>), where <inline-formula id="pone.0178789.e027"><alternatives><graphic id="pone.0178789.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mtext>+</mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. And the function <inline-formula id="pone.0178789.e028"><alternatives><graphic id="pone.0178789.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msubsup><mml:mi>φ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is equal to
<disp-formula id="pone.0178789.e029">
<alternatives>
<graphic id="pone.0178789.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e029" xlink:type="simple"/>
<mml:math display="block" id="M29">
<mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>φ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>Φ</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>Φ</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
where <italic>ω</italic><sub><italic>i</italic></sub> is the scale parameter related to the variance (<italic>ω</italic><sub><italic>i</italic></sub>&gt;0, if <inline-formula id="pone.0178789.e030"><alternatives><graphic id="pone.0178789.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the upper bound of <inline-formula id="pone.0178789.e031"><alternatives><graphic id="pone.0178789.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>; else, <italic>ω</italic><sub><italic>i</italic></sub>&lt;0) which affects the changing speed of the probability from 0 to 1; Φ(·) is the cumulative probability function of standard normal distribution. On account of the location parameter <italic>γ</italic><sub><italic>i</italic></sub>, even if the constrained characteristic attribute value is equal to the threshold, the considered probability may not be 0.5, depending on individual preference. The impacts of these parameters (e.g. the scale parameter <italic>ω</italic><sub><italic>i</italic></sub> and location parameter <italic>γ</italic><sub><italic>i</italic></sub>) on the function are shown in <xref ref-type="fig" rid="pone.0178789.g002">Fig 2</xref>.</p>
<fig id="pone.0178789.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0178789.g002</object-id>
<label>Fig 2</label>
<caption>
<title>The impacts of scale and location parameters.</title>
<p>The impacts of scale and location parameters on considered probability function are displayed separately by changing the values.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.g002" xlink:type="simple"/>
</fig>
<p>Usually, in the metro system, the spatiotemporal constraints, referring to travel time and number of transfers, are taken as the constrained characteristic attributes. The fact that the passengers generally prefer to the route with smaller values of the two attributes leads to the result that both of the two constraints only have the upper bounds. In the route choice context for metro passengers, the thresholds to a specific attribute vary with OD pairs. The deterministic parts of the thresholds of constrained travel time and number of transfers are shown below respectively.
<disp-formula id="pone.0178789.e032">
<alternatives>
<graphic id="pone.0178789.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e032" xlink:type="simple"/>
<mml:math display="block" id="M32">
<mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mtext>ln</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mtext>+1</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
<disp-formula id="pone.0178789.e033">
<alternatives>
<graphic id="pone.0178789.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e033" xlink:type="simple"/>
<mml:math display="block" id="M33">
<mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mtext>+</mml:mtext><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
where <inline-formula id="pone.0178789.e034"><alternatives><graphic id="pone.0178789.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the bound of travel time (including in-vehicle time and transfer time) of individual <italic>n</italic> for OD pair <italic>rs</italic>, h; <inline-formula id="pone.0178789.e035"><alternatives><graphic id="pone.0178789.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the bound of number of transfers; <inline-formula id="pone.0178789.e036"><alternatives><graphic id="pone.0178789.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the shortest travel time for OD pair <italic>rs</italic>, h; <inline-formula id="pone.0178789.e037"><alternatives><graphic id="pone.0178789.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the minimum number of transfers; <italic>α</italic><sub><italic>n</italic></sub> and <italic>β</italic><sub><italic>n</italic></sub> are the bound parameters needed to be calibrated.</p>
<p>Assuming that error component <inline-formula id="pone.0178789.e038"><alternatives><graphic id="pone.0178789.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msubsup><mml:mi>ε</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> follows the multivariate normal distribution, that is <inline-formula id="pone.0178789.e039"><alternatives><graphic id="pone.0178789.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msubsup><mml:mi>ε</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>~</mml:mo><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Σ</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0178789.e040"><alternatives><graphic id="pone.0178789.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msubsup><mml:mi>Σ</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the covariance matrix associated with the correlation among alternative routes, together with the constraints on route availability in the utility function, it is called CMNP (constrained multinomial probit) model. With respect to the route choice scenario, the route over-lapping problem in the railway network has been identified by Yai et al. [<xref ref-type="bibr" rid="pone.0178789.ref006">6</xref>] which is similar to metro network. This paper rewrites the covariance matrix into three parts, where the first part depends on the correlation among routes, the second one denotes the transfer variance of the route, and the last one denotes the unobserved variance. The latter two parts distribute independently by route.
<disp-formula id="pone.0178789.e041">
<alternatives>
<graphic id="pone.0178789.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e041" xlink:type="simple"/>
<mml:math display="block" id="M41">
<mml:mrow><mml:msubsup><mml:mi>Σ</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mtext>2</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mi>I</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
<disp-formula id="pone.0178789.e042">
<alternatives>
<graphic id="pone.0178789.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e042" xlink:type="simple"/>
<mml:math display="block" id="M42">
<mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>Γ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
where <italic>m</italic> is the number of alternatives in the routes set; <inline-formula id="pone.0178789.e043"><alternatives><graphic id="pone.0178789.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the unit variance which is independent from each other; <inline-formula id="pone.0178789.e044"><alternatives><graphic id="pone.0178789.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the variance of transfer 1time; <inline-formula id="pone.0178789.e045"><alternatives><graphic id="pone.0178789.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mtext>0</mml:mtext><mml:mtext>2</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is constant and identical to all routes; <inline-formula id="pone.0178789.e046"><alternatives><graphic id="pone.0178789.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the over-lapping length between route <italic>k</italic> and <italic>j</italic> for OD pair <italic>rs</italic>; <inline-formula id="pone.0178789.e047"><alternatives><graphic id="pone.0178789.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the number of transfers of route <italic>m</italic>; <italic>I</italic> is the identity matrix; <italic>l</italic><sub><italic>i</italic></sub> is the length of link <italic>i</italic>; Γ<sub><italic>k</italic></sub> is the links set of route <italic>k</italic>; if link <italic>i</italic> is shared by route <italic>k</italic> and <italic>j</italic>, <italic>k</italic><sub><italic>ikj</italic></sub> = 1, otherwise, <italic>k</italic><sub><italic>ikj</italic></sub> = 0. There are only three parameters in this covariance matrix, but we just need to estimate the ratio <italic>λ</italic><sub>1</sub> of <inline-formula id="pone.0178789.e048"><alternatives><graphic id="pone.0178789.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> to <inline-formula id="pone.0178789.e049"><alternatives><graphic id="pone.0178789.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mtext>0</mml:mtext><mml:mtext>2</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and the ratio <italic>λ</italic><sub>2</sub> of <inline-formula id="pone.0178789.e050"><alternatives><graphic id="pone.0178789.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> to <inline-formula id="pone.0178789.e051"><alternatives><graphic id="pone.0178789.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mtext>0</mml:mtext><mml:mtext>2</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Then based on the random utility maximization, given the values of all parameters, the chosen probability of route <italic>k</italic> is equal to
<disp-formula id="pone.0178789.e052">
<alternatives>
<graphic id="pone.0178789.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e052" xlink:type="simple"/>
<mml:math display="block" id="M52">
<mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mtext>max</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>;</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>A</mml:mi></mml:mstyle><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
where <inline-formula id="pone.0178789.e053"><alternatives><graphic id="pone.0178789.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>A</mml:mi></mml:mstyle><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the routes set between OD pair <italic>rs</italic> for passenger <italic>n</italic>. With respect to current scale of the metro network, the largest size of the routes set <inline-formula id="pone.0178789.e054"><alternatives><graphic id="pone.0178789.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>A</mml:mi></mml:mstyle><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> can be set as 10.</p>
</sec>
<sec id="sec004">
<title>Model estimation</title>
<sec id="sec005">
<title>The Bayesian formulation to the CMNP model</title>
<p>Faced with multidimensional integrals of the multivariate normal densities especially for large routes set, MNP model is usually estimated by Bayesian formulation and Monte Carlo Markov Chain (MCMC) approach [<xref ref-type="bibr" rid="pone.0178789.ref036">36</xref>]. This paper mainly wants to exhibit how to transform CMNP model with structured covariance into Bayesian formula and introduce Cholesky Decomposition to descend the dimension of integral so that the computational time can be saved. After the dimension reduction process and integral domain transformation, the calculation of multidimensional integrals of the multivariate normal densities given the parameters can be carried out based on quasi-Monte Carlo method.</p>
<p>Here, we construct a vector <bold>ζ</bold> = <bold>μ</bold>∪σ∪Σ = <bold>θ</bold>∪<bold>ω</bold>∪<bold>γ</bold>∪<bold>z</bold>∪<bold>λ</bold> including all unknown parameters, where <bold>θ</bold> contains the parameters in the compensatory component; <bold>ω</bold> is the vector with the scale parameters; <bold>γ</bold> is the vector with the location parameters; <bold>z</bold> contains the parameters in the threshold function, that is <italic>α</italic><sub><italic>n</italic></sub> and <italic>β</italic><sub><italic>n</italic></sub> in this paper; <bold>λ</bold> covers the parameters in the covariance matrix. Meanwhile, the vector <bold>Y</bold> denotes the indicators of the observations referring to the chosen routes. Compared with the traditional probit model and the proposed CMNP model, the non-compensatory component in the CMNP model leads to the difference between the two models. However, the value of the non-compensatory component can be easily calculated given the unknown parameters, benefiting from the independent bivariate normal distribution assumption. Based on Bayes’ theorem, the posterior distribution <italic>π</italic>(<bold>ζ</bold>|<bold>Y</bold>) is proportional to the priors on all unknown parameters, that is, the joint posterior distribution for the Hierarchical Bayes model is as follows.
<disp-formula id="pone.0178789.e055">
<alternatives>
<graphic id="pone.0178789.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e055" xlink:type="simple"/>
<mml:math display="block" id="M55">
<mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ζ</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>θ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ω</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>γ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>θ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ω</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>γ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>λ</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ζ</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ζ</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
where <italic>π</italic>(·) is the probability density function; <italic>P</italic>(<bold>Y</bold>|<bold>θ</bold>, <bold>ω</bold>, <bold>γ</bold>, <bold>z</bold>, <bold>λ</bold>) is the probability of observation <bold>Y</bold> given all unknown parameters which is equal to <xref ref-type="disp-formula" rid="pone.0178789.e052">Eq (11)</xref>. Supposing that all parameters are independent from each other, we can get the below equations.</p>
<disp-formula id="pone.0178789.e056">
<alternatives>
<graphic id="pone.0178789.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e056" xlink:type="simple"/>
<mml:math display="block" id="M56">
<mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>θ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ω</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>γ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>λ</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ζ</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>θ</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>μ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>θ</mml:mi></mml:mstyle></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>σ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>θ</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ω</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>μ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ω</mml:mi></mml:mstyle></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>σ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ω</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>γ</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>μ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>γ</mml:mi></mml:mstyle></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>σ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>γ</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>μ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>σ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>λ</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>λ</mml:mi></mml:mstyle></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>λ</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
<disp-formula id="pone.0178789.e057">
<alternatives>
<graphic id="pone.0178789.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e057" xlink:type="simple"/>
<mml:math display="block" id="M57">
<mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ζ</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>μ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>θ</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>σ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>θ</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>μ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ω</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>σ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ω</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>μ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>γ</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>σ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>γ</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>μ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>σ</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>λ</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>λ</mml:mi></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
<p>Probit model is hard to be calculated even if all the unknown parameters are given because of the multivariate normal distribution. The <xref ref-type="disp-formula" rid="pone.0178789.e052">Eq (11)</xref> can be rewritten into the D-dimensional integrals of the multivariate normal density as follows.
<disp-formula id="pone.0178789.e058">
<alternatives>
<graphic id="pone.0178789.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e058" xlink:type="simple"/>
<mml:math display="block" id="M58">
<mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:msubsup><mml:mi>ε</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munderover><mml:mrow><mml:mo>⋯</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mtext>+</mml:mtext><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>⋯</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munderover><mml:mrow><mml:mo>Ω</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ε</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>⋯</mml:mo><mml:mi>d</mml:mi><mml:msubsup><mml:mi>ε</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula>
<disp-formula id="pone.0178789.e059">
<alternatives>
<graphic id="pone.0178789.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e059" xlink:type="simple"/>
<mml:math display="block" id="M59">
<mml:mrow><mml:mo>Ω</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ε</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>Σ</mml:mi><mml:msup><mml:mo>|</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ε</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ε</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula>
where <inline-formula id="pone.0178789.e060"><alternatives><graphic id="pone.0178789.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ε</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the random error vector.</p>
<p>Considering that the covariance matrix is a Hermitian, positive-definite matrix, the integral of the general multivariate normal distribution can be transformed into that of standard normal distribution via Cholesky Decomposition to the covariance matrix and other substitutions [<xref ref-type="bibr" rid="pone.0178789.ref037">37</xref>–<xref ref-type="bibr" rid="pone.0178789.ref038">38</xref>]. By this means, the integral domain is referred to as transforming the <italic>m</italic>-variate integral into one over the (<italic>m</italic>-1)-dimensional hypercube.</p>
<p>Based on Cholesky Decomposition, the covariance matrix can be written as
<disp-formula id="pone.0178789.e061">
<alternatives>
<graphic id="pone.0178789.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e061" xlink:type="simple"/>
<mml:math display="block" id="M61">
<mml:mrow><mml:mi>Σ</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula>
where <italic>D</italic> is a lower triangular matrix and <italic>D</italic><sup><italic>T</italic></sup> is its conjugate transpose. We set
<disp-formula id="pone.0178789.e062">
<alternatives>
<graphic id="pone.0178789.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e062" xlink:type="simple"/>
<mml:math display="block" id="M62">
<mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ε</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>q</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(18)</label>
</disp-formula>
where <inline-formula id="pone.0178789.e063"><alternatives><graphic id="pone.0178789.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>q</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a vector substituting random error vector <bold>ε</bold><sup><italic>rs</italic></sup>. Then the <xref ref-type="disp-formula" rid="pone.0178789.e052">Eq (11)</xref> can be transformed as
<disp-formula id="pone.0178789.e064">
<alternatives>
<graphic id="pone.0178789.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e064" xlink:type="simple"/>
<mml:math display="block" id="M64">
<mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>⋯</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>q</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(19)</label>
</disp-formula>
<disp-formula id="pone.0178789.e065">
<alternatives>
<graphic id="pone.0178789.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e065" xlink:type="simple"/>
<mml:math display="block" id="M65">
<mml:mrow><mml:msub><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtable><mml:mtr><mml:mtd><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mi>∞</mml:mi><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(20)</label>
</disp-formula>
where <inline-formula id="pone.0178789.e066"><alternatives><graphic id="pone.0178789.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:msub><mml:msup><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the upper limit of the <italic>i</italic>-th layer’s integration; <italic>d</italic><sub><italic>i</italic>,<italic>i</italic></sub> is the element in <italic>D</italic>. We assume
<disp-formula id="pone.0178789.e067">
<alternatives>
<graphic id="pone.0178789.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e067" xlink:type="simple"/>
<mml:math display="block" id="M67">
<mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mo>Φ</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(21)</label>
</disp-formula>
where <inline-formula id="pone.0178789.e068"><alternatives><graphic id="pone.0178789.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a vector substituting vector <bold>q</bold><sup><italic>rs</italic></sup>; Φ<sup>−1</sup>(·) is the inverse cumulative probability function of standard normal distribution, that is <italic>v</italic><sub><italic>i</italic></sub> = Φ(<italic>q</italic><sub><italic>i</italic></sub>). Meanwhile, we suppose <italic>v</italic><sub><italic>i</italic></sub> = <italic>w</italic><sub><italic>i</italic></sub><italic>e</italic><sub><italic>i</italic></sub>. Thus, we get the equation
<disp-formula id="pone.0178789.e069">
<alternatives>
<graphic id="pone.0178789.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e069" xlink:type="simple"/>
<mml:math display="block" id="M69">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>P</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mi>e</mml:mi><mml:mmultiscripts><mml:mrow/><mml:mprescripts/><mml:mn>1</mml:mn><mml:none/></mml:mmultiscripts></mml:mrow></mml:munderover><mml:mrow><mml:mo>⋯</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo>⋯</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mtext>0</mml:mtext><mml:mtext>1</mml:mtext></mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mtext>0</mml:mtext><mml:mtext>1</mml:mtext></mml:msubsup><mml:mrow><mml:mo>⋯</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mtext>0</mml:mtext><mml:mtext>1</mml:mtext></mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(22)</label>
</disp-formula>
<disp-formula id="pone.0178789.e070">
<alternatives>
<graphic id="pone.0178789.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e070" xlink:type="simple"/>
<mml:math display="block" id="M70">
<mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>Φ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo>Φ</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:msup><mml:mo>Φ</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(23)</label>
</disp-formula>
where <bold>w</bold> = (<italic>w</italic><sub>1</sub>, <italic>w</italic><sub>2</sub>,…,<italic>w</italic><sub><italic>m</italic></sub>) denotes the parameters vector.</p>
<p>When <italic>i</italic> = <italic>k</italic>, <italic>e</italic><sub><italic>i</italic></sub> = 1, the <italic>m</italic>-dimensional integration declines into (<italic>m</italic>-1)-dimensional integration. And quasi-Monte Carlo method can be used to calculate the probability of multivariate normal distribution given all unknown parameters.</p>
</sec>
<sec id="sec006">
<title>The parameter identification problem</title>
<p>With respect to the constrained multinomial logit model, Castro et al. discussed the parameter identification problem derived from the fact that one attribute exists both in the compensatory and non-compensatory components [<xref ref-type="bibr" rid="pone.0178789.ref023">23</xref>]. This problem has been avoided in this paper via the process that the threshold is regarded as a function whose value varies with the change of the OD scale. By this means, the parameters associated with the same attribute both in the compensatory and non-compensatory components are identifiable. Another parameter identification problem arises when the threshold parameter plus directly location parameter. In this paper, the constraint of number of transfers suffers this problem as <italic>β</italic>+<italic>γ</italic><sub><italic>τ</italic></sub>, where <italic>β</italic> is the threshold parameter and <italic>γ</italic><sub><italic>τ</italic></sub> is the location parameter. The two parameters cannot be identified, but we can estimate the sum of them without influence on other parameters. For simplicity, we can assume the location parameter is equal to 0, and then we can get the value of the threshold parameter.</p>
</sec>
<sec id="sec007">
<title>Probability calculation based on Monte Carlo simulation</title>
<p>With respect to the solution to <xref ref-type="disp-formula" rid="pone.0178789.e052">Eq (11)</xref> associated with the probit probability, the quasi-Monte Carlo method is carried out. Supposing that every element in <bold>w</bold> follows the uniform distribution <italic>w</italic><sub><italic>i</italic></sub> ~ <italic>U</italic>(0, 1) and the elements in <bold>w</bold> are independent from each other, we use Halton sequence to generate random data. The vector <bold>w</bold><sub><italic>j</italic></sub> = (w<sub>1<italic>j</italic></sub>,…<italic>w</italic><sub><italic>ij</italic></sub>,…<italic>w</italic><sub><italic>mj</italic></sub>). contains the random values generated by the Halton sequence in the <italic>j</italic>-th iteration. We can get the approximate solution to <xref ref-type="disp-formula" rid="pone.0178789.e052">Eq (11)</xref> given unknown parameters <bold>θ</bold>, <bold>ω</bold>, <bold>γ</bold>, <bold>z</bold>, <bold>λ</bold>, that is,
<disp-formula id="pone.0178789.e071">
<alternatives>
<graphic id="pone.0178789.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e071" xlink:type="simple"/>
<mml:math display="block" id="M71">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>P</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>J</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(24)</label>
</disp-formula>
where <italic>E</italic>(·) denotes the expected value.</p>
</sec>
<sec id="sec008">
<title>Estimation algorithm</title>
<p>The Metropolis-Hastings (M-H) algorithm [<xref ref-type="bibr" rid="pone.0178789.ref039">39</xref>–<xref ref-type="bibr" rid="pone.0178789.ref040">40</xref>] which is known as one of the MCMC approach is widely used to generate samples of the parameter from a prior distribution without the prior knowledge. In order to generate the final samples, candidates are drawn iteratively and they will be accepted as current samples with a certain probability in every iteration. With the increase of the number of iterations, Markov Chain ensures that we will gain a stationary posterior distribution of the parameter. In order to improve estimating efficiency, the variable-at-a-time Metropolis sampling scheme [<xref ref-type="bibr" rid="pone.0178789.ref039">39</xref>] is used to generate candidate for every parameter in turn in the parameters’ set. The estimation process is organized as follows.</p>
<p><italic>Step</italic> 1: Generate randomly initial values from pre-defined prior distribution, that is <inline-formula id="pone.0178789.e072"><alternatives><graphic id="pone.0178789.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ζ</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>NP</italic> denotes the number of parameters. And generate routes sets <bold>A</bold><sup><italic>rs</italic></sup> for OD pairs based on physical length. Set iteration <italic>t</italic> = 1 and <italic>i</italic> = 1.</p>
<p><italic>Step</italic> 2: Draw a candidate <inline-formula id="pone.0178789.e073"><alternatives><graphic id="pone.0178789.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>ζ</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> from a jumping distribution <inline-formula id="pone.0178789.e074"><alternatives><graphic id="pone.0178789.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> based on the Gaussian random walk Metropolis sampling method. This method suggests that the jumping distribution is supposed to be a normal distribution which is a symmetric distribution satisfying the equation <inline-formula id="pone.0178789.e075"><alternatives><graphic id="pone.0178789.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Here we set the jumping distribution as <inline-formula id="pone.0178789.e076"><alternatives><graphic id="pone.0178789.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>ξ</italic><sup>2</sup> is the proposal variance for the <italic>i-</italic>th parameter.</p>
<p><italic>Step</italic> 3: Calculate the acceptance ratio <inline-formula id="pone.0178789.e077"><alternatives><graphic id="pone.0178789.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mrow><mml:mi>ϑ</mml:mi><mml:mo>=</mml:mo><mml:mtext>min</mml:mtext><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>}</mml:mo><mml:mo>=</mml:mo><mml:mtext>min</mml:mtext><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where
<disp-formula id="pone.0178789.e078">
<alternatives>
<graphic id="pone.0178789.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e078" xlink:type="simple"/>
<mml:math display="block" id="M78">
<mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∝</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Y</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(25)</label>
</disp-formula>
<disp-formula id="pone.0178789.e079">
<alternatives>
<graphic id="pone.0178789.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e079" xlink:type="simple"/>
<mml:math display="block" id="M79">
<mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∝</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Y</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(26)</label>
</disp-formula>
where <inline-formula id="pone.0178789.e080"><alternatives><graphic id="pone.0178789.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, referring to <xref ref-type="disp-formula" rid="pone.0178789.e052">Eq (11)</xref>. The same parts can be canceled out and the ratio is
<disp-formula id="pone.0178789.e081">
<alternatives>
<graphic id="pone.0178789.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e081" xlink:type="simple"/>
<mml:math display="block" id="M81">
<mml:mrow><mml:mi>ϑ</mml:mi><mml:mo>=</mml:mo><mml:mtext>min</mml:mtext><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Y</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Y</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>⋅</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>}</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(27)</label>
</disp-formula></p>
<p><italic>Step</italic> 4: Draw a value <italic>u</italic> from the uniform distribution <italic>U</italic>(0, 1). If <italic>u</italic>≤<italic>ϑ</italic>, <bold>ζ</bold><sup>(<italic>m</italic>)</sup> = <bold>ζ</bold>*; otherwise, <bold>ζ</bold><sup>(<italic>m</italic>)</sup> = <bold>ζ</bold><sup>(<italic>m</italic>−1)</sup>.</p>
<p><italic>Step</italic> 5: If <italic>i</italic>&lt;<italic>NP</italic>, <italic>i</italic> = <italic>i</italic>+1, repeat <italic>Step</italic> 2—<italic>Step</italic>4; otherwise, continue <italic>Step</italic> 6.</p>
<p><italic>Step</italic> 6: If <italic>m</italic>&lt;<italic>M</italic>, <italic>m</italic> = <italic>m</italic>+1, <italic>i</italic> = 1, repeat <italic>Step</italic> 2—<italic>Step</italic> 5; otherwise, stop sampling.</p>
</sec>
</sec>
<sec id="sec009">
<title>Results and discussions</title>
<sec id="sec010">
<title>Data</title>
<p>All data are available in the supporting information file (<xref ref-type="supplementary-material" rid="pone.0178789.s003">S1_Dataset</xref>.).</p>
<p>With new lines put into operation ceaselessly, Guangzhou Metro becomes the sixth busiest metro system in the world and the third largest metro system in China. Up to July 2014, there are 8 lines and 136 stations (including 19 transfer stations) in operation, forming 256.6km operating length and carrying about 6.2 million daily ridership, except the APM Line. The APM Line isn’t in our consideration, because it belongs to a unique system which needs to swipe through again although you were in other lines. The metro system covers the major urban areas of the city, reaches into some large suburban area and connects Guangzhou city and Foshan city. Through statistical analysis, there are 3721 OD pairs for which the routes with the shortest travel times are not the routes with the minimum number of transfers. It provides the possibility that more than one route will be considered by passengers with comprehensive consideration of multiple factors. The large scaled metro network increases the complexity of route choice analysis.</p>
<p>In July 2014, Guangzhou Metro Corporation organized a survey in the metro stations to collect passengers’ travel characteristics, such as respondents’ actual travel routes. Totally, the effective sample size is 14142. Based on the survey data, <xref ref-type="fig" rid="pone.0178789.g003">Fig 3(a)</xref> shows the relationship between the difference (namely the threshold minus the shortest travel time) and the shortest travel time. It can be seen that the difference increases logarithmically with the increase of the shortest travel time which demonstrates that the travel time threshold formula in <xref ref-type="disp-formula" rid="pone.0178789.e032">Eq (7)</xref> is suitable. By data fitting, when <italic>α</italic><sub><italic>n</italic></sub> = 0.446, the mean absolute percentage error (MAPE) is the minimum 3.657%. <xref ref-type="fig" rid="pone.0178789.g003">Fig 3(b)</xref> shows that when the minimum number of transfers is 0, the weighted mean value of the threshold of number of transfers is 1.951, that is, <italic>β</italic><sub><italic>n</italic></sub> can be assumed as 1.951.</p>
<fig id="pone.0178789.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0178789.g003</object-id>
<label>Fig 3</label>
<caption>
<title>The thresholds of travel time and number of transfers.</title>
<p>The figure displays the survey data associated with thresholds. By fitting, the parameters in the thresholds can be estimated.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec011">
<title>Estimations</title>
<p>In the compensatory component, the in-vehicle travel time (<inline-formula id="pone.0178789.e082"><alternatives><graphic id="pone.0178789.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>1</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, h), number of transfers (<inline-formula id="pone.0178789.e083"><alternatives><graphic id="pone.0178789.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>2</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, time), transfer time (<inline-formula id="pone.0178789.e084"><alternatives><graphic id="pone.0178789.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>3</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, h), comfort degree (<inline-formula id="pone.0178789.e085"><alternatives><graphic id="pone.0178789.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>4</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, 0–1 variable) and revised angular cost (<inline-formula id="pone.0178789.e086"><alternatives><graphic id="pone.0178789.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>5</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, km) are considered with the corresponding parameters <italic>θ</italic><sub>1</sub>, <italic>θ</italic><sub>2,</sub> <italic>θ</italic><sub>3,</sub> <italic>θ</italic><sub>4</sub> and <italic>θ</italic><sub>5</sub>, where revised angular cost <inline-formula id="pone.0178789.e087"><alternatives><graphic id="pone.0178789.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>5</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> measures the deviation degree of a route by transforming <italic>sin()</italic> into <italic>tan()</italic> and comfort degree <inline-formula id="pone.0178789.e088"><alternatives><graphic id="pone.0178789.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>4</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> represents the congestion level in the train whose value is <inline-formula id="pone.0178789.e089"><alternatives><graphic id="pone.0178789.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>4</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> when average load factor of one route is smaller than 20%, otherwise, <inline-formula id="pone.0178789.e090"><alternatives><graphic id="pone.0178789.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>4</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. In the non-compensatory component, the travel time (<inline-formula id="pone.0178789.e091"><alternatives><graphic id="pone.0178789.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>0</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>1</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>3</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula><inline-formula id="pone.0178789.e092"><alternatives><graphic id="pone.0178789.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>3</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, h) and number of transfers <inline-formula id="pone.0178789.e093"><alternatives><graphic id="pone.0178789.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0178789.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext>2</mml:mtext></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are considered with the threshold parameters <italic>α</italic> and <italic>β</italic>, scale parameters <italic>ω</italic><sub><italic>t</italic></sub> and <italic>ω</italic><sub><italic>m</italic></sub> as well as location parameters <italic>γ</italic><sub><italic>t</italic></sub> and <italic>γ</italic><sub><italic>m</italic></sub> respectively. In case of the parameter identification problem in the threshold of number of transfers, the location parameter is assumed to be 0, that is <italic>γ</italic><sub><italic>m</italic></sub> = 0. Moreover, the parameter <italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub> in the covariance matrix needs to be estimated.</p>
<p>Based on the surveyed data, the proposed model, MNP model, MNL model and CMNL model are estimated respectively. The latter two models are estimated based on the maximization likelihood estimation method, while the proposed model and MNP model are estimated based on the estimation approach proposed by this paper. Under the non-informative condition, the prior distributions for all parameters are assumed to follow uniform distribution. Totally, what parameters we need to estimate are <italic>θ</italic><sub>1</sub>, <italic>θ</italic><sub>2</sub>, <italic>θ</italic><sub>3</sub>, <italic>θ</italic><sub>4</sub>, <italic>θ</italic><sub>5</sub>, <italic>α</italic>, <italic>β</italic>, <italic>ω</italic><sub><italic>t</italic></sub>, <italic>ω</italic><sub><italic>m</italic></sub>, <italic>γ</italic><sub><italic>t</italic></sub>, <italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub>. Considering the signs of the parameters, we assume that <italic>θ</italic><sub>1</sub>, <italic>θ</italic><sub>2</sub>, <italic>θ</italic><sub>3</sub> and <italic>θ</italic><sub>5</sub> follow U(-20, 0); <italic>θ</italic><sub>4</sub>, <italic>α</italic>, <italic>β</italic>, <italic>ω</italic><sub><italic>m</italic></sub>, <italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub> follow U(0, 20); <italic>ω</italic><sub><italic>t</italic></sub> follows U(60, 200); <italic>γ</italic><sub><italic>t</italic></sub> follows U(-1, 1). The proposal variance <italic>ξ</italic><sup>2</sup> is 0.05. The surveyed RP data is divided into two parts, referring to the 12039 data for estimation and 2103 data for examination. The scheme to screen the data will be described later. Based on MCMC approach, we tried 10000 iterations to estimate all parameters in the CMNP model, where the fore 5000 samples for each parameter are abandoned as burn-in period and the left 5000 effective samples for each parameter are drawn. The distribution of the effective samples for <italic>θ</italic><sub>1</sub> is taken as an example shown in <xref ref-type="fig" rid="pone.0178789.g004">Fig 4</xref>. Based on the samples, we can get the mean and 95% Bayesian conference interval (CI) shown in <xref ref-type="table" rid="pone.0178789.t001">Table 1</xref>, as well as the estimations of MNL, MNP and CMNL models.</p>
<fig id="pone.0178789.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0178789.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The distribution of effective samples for <italic>θ</italic><sub>1</sub>.</title>
<p>The figure exhibits the frequency distribution of the samples to represent the convergence directly.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.g004" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0178789.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0178789.t001</object-id>
<label>Table 1</label> <caption><title>Estimations of MNL, CMNL and CMNP models.</title></caption>
<alternatives>
<graphic id="pone.0178789.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Parameter</th>
<th align="center">MNL-value<break/>(<italic>t</italic>-value)</th>
<th align="center">MNP-mean<break/>(95% CI)</th>
<th align="center">CMNL-value<break/>(<italic>t</italic>-value)</th>
<th align="center">CMNP-mean<break/>(95% CI)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><italic>θ</italic><sub>1</sub></td>
<td align="center">-14.411<break/>(-31.103)</td>
<td align="center">-13.174<break/>([-13.165, -13.184])</td>
<td align="center">-10.224<break/>(-40.714)</td>
<td align="center">-9.074<break/>([-9.065, -9.084])</td>
</tr>
<tr>
<td align="center"><italic>θ</italic><sub>2</sub></td>
<td align="center">-2.256<break/>(-17.267)</td>
<td align="center">-2.071<break/>([-2.061, -2.081])</td>
<td align="center">-1.641<break/>(-15.324)</td>
<td align="center">-1.479<break/>([-1.468, -1.489])</td>
</tr>
<tr>
<td align="center"><italic>θ</italic><sub>3</sub></td>
<td align="center">-15.623<break/>(-16.654)</td>
<td align="center">-13.111<break/>([-13.100, -13.121])</td>
<td align="center">-11.712<break/>(-13.125)</td>
<td align="center">-11.100<break/>([-11.088, -11.111])</td>
</tr>
<tr>
<td align="center"><italic>θ</italic><sub>4</sub></td>
<td align="center">0.005<break/>(6.068)</td>
<td align="center">0.008<break/>([0.00799,0.00801])</td>
<td align="center">0.004<break/>(3.224)</td>
<td align="center">0.008<break/>([0.00799,0.00801])</td>
</tr>
<tr>
<td align="center"><italic>θ</italic><sub>5</sub></td>
<td align="center">-0.018<break/>(-2.016)</td>
<td align="center">-0.052<break/>([-0.0520, -0.0523])</td>
<td align="center">-0.061<break/>(-2.514)</td>
<td align="center">-0.075<break/>([-0.0751, -0.0753])</td>
</tr>
<tr>
<td align="center"><italic>α</italic></td>
<td align="center">--</td>
<td align="center">--</td>
<td align="center">0.460<break/>(3.412)</td>
<td align="center">0.455<break/>([0.450, 0.460])</td>
</tr>
<tr>
<td align="center"><italic>β</italic></td>
<td align="center">--</td>
<td align="center">--</td>
<td align="center">1.961<break/>(2.121)</td>
<td align="center">1.959([1.943, 1.975])</td>
</tr>
<tr>
<td align="center"><italic>ω</italic><sub><italic>t</italic></sub></td>
<td align="center">--</td>
<td align="center">--</td>
<td align="center">65.012<break/>(21.403)</td>
<td align="center">177.392<break/>([177.240, 177.548])</td>
</tr>
<tr>
<td align="center"><italic>ω</italic><sub><italic>m</italic></sub></td>
<td align="center">--</td>
<td align="center">--</td>
<td align="center">6.051<break/>(5.711)</td>
<td align="center">7.431<break/>([7.411, 7.452])</td>
</tr>
<tr>
<td align="center"><italic>γ</italic><sub><italic>t</italic></sub></td>
<td align="center">--</td>
<td align="center">--</td>
<td align="center">0.001<break/>(1.991)</td>
<td align="center">0.001<break/>([0.0009, 0.0011])</td>
</tr>
<tr>
<td align="center"><italic>λ</italic><sub><italic>1</italic></sub></td>
<td align="center">--</td>
<td align="center">0.621([0.620, 0.622])</td>
<td align="center">--</td>
<td align="center">0.675([0.674, 0.676])</td>
</tr>
<tr>
<td align="center"><italic>λ</italic><sub><italic>2</italic></sub></td>
<td align="center">--</td>
<td align="center">0.544([0.542, 0.546])</td>
<td align="center">--</td>
<td align="center">0.552([0.550, 0.554])</td>
</tr>
<tr>
<td align="center"><italic>ρ</italic><sup><italic>2</italic></sup></td>
<td align="center">0.442</td>
<td align="center">0.571</td>
<td align="center">0.533</td>
<td align="center">0.723</td>
</tr>
<tr>
<td align="center">Sample Size</td>
<td align="center">10000</td>
<td align="center">10000</td>
<td align="center">10000</td>
<td align="center">10000</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Kolmogorov-Smirnov (KS) Test is used to determine whether the samples follow normal distribution. <xref ref-type="fig" rid="pone.0178789.g004">Fig 4</xref> shows the distribution of the effective samples for parameter <italic>θ</italic><sub>1</sub> for an example. Descriptive statistics show that the average value is -9.074 and the standard deviation is 0.366. By KS test, the <italic>p</italic> value is 0.433 which is greater than 0.05, proving that the samples follow normal distribution at 5% significance level. Thus, the sampling process converges. Other parameters have the same characteristics. As shown in <xref ref-type="table" rid="pone.0178789.t001">Table 1</xref>, the different results for the parameters in MNP and CMNP models indicate that the MCMC approach can successfully distinguished all parameters though some of them have the same initial values. And the CI for every parameter ensures us to accept the means of the drawn samples. Meanwhile, coefficients of in-vehicle time, number of transfers, transfer time and revised angular cost are negative, meaning that the chosen probability of one route decreases along with the increase of in-vehicle time, number of transfers, transfer time or revised angular cost. Coefficients of comfort degree in both models are all positive, meaning that their increase will improve individual preference to the route. It is consistent with the common sense. Furthermore, <italic>t</italic>-values of the coefficients for MNL and CMNL models exceed 1.96, indicating that the null hypothesis that the true values of the coefficients are zero can be rejected at the 0.05 significance level. And the <italic>ρ</italic><sup>2</sup> of all models are greater than 0.2, indicating that all models have a good goodness-of-fit. Compared with the <italic>ρ</italic><sup>2</sup>, CMNP model are the greatest, illustrating that the proposed CMNP model is the best among all models.</p>
<p>In addition to the estimation performance, the forecasting performances of all models are compared. In order to gain plenty of actual choice results which are drawn from the surveyed data, the route choices between some similar OD pairs are aggregated. As shown in <xref ref-type="fig" rid="pone.0178789.g005">Fig 5</xref>, we combine the origins as an identical origin <bold>R</bold> as well as the identical destination <bold>S</bold>, that is, <bold>R</bold> contains Guangzhou South Railway Station (R1), Shibi (R2), Huijiang (R3), Nanpu (R4), Luoxi (R5), Nanzhou (R6), Dongxiao South (R7) and Jiangtai Road (R8); <bold>S</bold> contains Jingxi Nanfang Hospital (S1) and Meihuayuan (S2). The transfer stations are Haizhu Square (<italic>m</italic>1), Gongyuanqian (<italic>m</italic>2), Jiahewanggang (<italic>m</italic>3), Yantang (<italic>m</italic>4), Guangzhou East Railway Station (<italic>m</italic>5) and Tiyu West Road (<italic>m</italic>6). Excluding the routes with chosen probabilities smaller than 0.0001, we have four routes left in <xref ref-type="table" rid="pone.0178789.t002">Table 2</xref> along with the chosen probabilities according to different models. The number of the actual choices between the specific OD pairs in the surveyed data is 2103 and the absolute error is calculated to compare the forecasting performance as shown in <xref ref-type="table" rid="pone.0178789.t002">Table 2</xref>. We can see that CMNP model has the smallest MAE (Mean Absolute Error) which demonstrates that the proposed CMNP model has the best forecasting performance.</p>
<fig id="pone.0178789.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0178789.g005</object-id>
<label>Fig 5</label>
<caption>
<title>A diagram of deleted OD pairs and routes.</title>
<p>The origin stations are denoted as R; the destination stations are denoted as S; the transfer stations are denoted as m. Other stations are omitted in the figure. It means transferring if the route passes by a transfer station.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.g005" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0178789.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0178789.t002</object-id>
<label>Table 2</label> <caption><title>The comparisons of all models.</title></caption>
<alternatives>
<graphic id="pone.0178789.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Route</th>
<th align="center">Actual<break/>Prob.</th>
<th align="center">MNL<break/>Prob.(AE)</th>
<th align="center">MNP<break/>Prob.(MAE)</th>
<th align="center">CMNL<break/>Prob.(AE)</th>
<th align="center">CMNP<break/>Prob.(AE)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>K</italic>1: R -&gt; <italic>m</italic>2 -&gt; <italic>m</italic>6 -&gt; S</td>
<td align="center">51%</td>
<td align="center">45% (6%)</td>
<td align="center">46% (5%)</td>
<td align="center">58% (7%)</td>
<td align="center">53% (2%)</td>
</tr>
<tr>
<td align="left"><italic>K</italic>2: R -&gt; <italic>m</italic>2 -&gt; <italic>m</italic>5 -&gt; S</td>
<td align="center">19%</td>
<td align="center">38% (19%)</td>
<td align="center">27% (8%)</td>
<td align="center">23% (4%)</td>
<td align="center">21% (2%)</td>
</tr>
<tr>
<td align="left"><italic>K</italic>3: R -&gt; <italic>m</italic>3 -&gt; S</td>
<td align="center">21%</td>
<td align="center">13% (8%)</td>
<td align="center">16% (5%)</td>
<td align="center">12% (9%)</td>
<td align="center">20% (1%)</td>
</tr>
<tr>
<td align="left"><italic>K</italic>4: R -&gt; <italic>m</italic>1 -&gt; <italic>m</italic>4 -&gt; S</td>
<td align="center">9%</td>
<td align="center">4% (5%)</td>
<td align="center">11% (2%)</td>
<td align="center">7% (2%)</td>
<td align="center">6% (3%)</td>
</tr>
<tr>
<td align="left">Sum</td>
<td align="center">100%</td>
<td align="center">100% (38%)</td>
<td align="center">100% (20%)</td>
<td align="center">100% (22%)</td>
<td align="center">100% (8%)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec012">
<title>Application</title>
<p>The route choice model can be used to predict the transfer flow volume, section flow volume, etc. which are the basis of scheduling the train plan, guiding individual travel route, etc. The proposed CMNP route choice model determines the route choice probability for every OD pair in the metro network. And then the flow volume on the route can be derived from the product of the probability and the OD volume. By counting the number of passengers transferring between two different lines based on the train timetable, the transfer flow volume can be calculated. All testing data are provided by Guangzhou Metro Corporation. The results are shown in <xref ref-type="fig" rid="pone.0178789.g006">Fig 6</xref> where testing data is on the horizontal axis, predicting data is on the vertical axis, and the solid line is the basic line indicating that the predicting data is equal to the testing data if the data spot is on the line. Every spot represents the flow volume transferring form one running direction of one line to one running direction of another line. Usually, every line has two running directions. The mean absolute percentage error (MAPE) is 4.91% which shows that the proposed CMNP model has a good application prospect.</p>
<fig id="pone.0178789.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0178789.g006</object-id>
<label>Fig 6</label>
<caption>
<title>The transfer flow volume forecasting performance.</title>
<p>For each spot, it has two values, including the testing data corresponding to horizontal axis and forecasting value corresponding to vertical axis.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.g006" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec013" sec-type="conclusions">
<title>Conclusion</title>
<p>In a large scaled metro network, the complex nature of route choice process brings us a challenge to exactly figure out passengers’ actual decision rules. This paper focuses on integrating the impacts of routes set and the interdependency among alternative routes on route choice probability into route choice modeling in the metro network. The impact of routes set on route choice probability expresses the semi-compensatory choice process which is a combination of routes set generation and route choice stages. Thereafter, a constrained multinomial probit (CMNP) model is proposed by this paper, in which, the utility function consists of compensatory, non-compensatory and error parts. The compensatory part is a linear function of in-vehicle travel time, number of transfers, transfer time, congestion level and revised angular cost. The non-compensatory part measures the impact of considered probability of one route on the route’s utility by a logarithm function, where considered probability is calculated by a binary probit equation denoting the relationship between the constrained attributes (e.g. travel time and number of transfers) and the corresponding thresholds proposed by this paper. The error part follows a multivariate normal distribution, whose variance is structured into three parts, including measuring the correlation among routes, representing the transfer variance of the route, and denoting the unobserved variance.</p>
<p>With respect to the estimation, considering multidimensional integrals of the multivariate normal probability density function, the CMNP model is rewritten as Bayesian formulation and MCMC approach is constructed to estimate all parameters. As a key point to calculate the acceptance rate, given the unknown parameters, the multidimensional integrals of the multivariate normal probability density function can be transformed into those of standard normal distribution via Cholesky Decomposition to the covariance matrix and other substitutions. Then the integrals can be easily simulated by quasi-Monte Carlo algorithm.</p>
<p>At last, the proposed model is estimated by the proposed estimation approach based on the surveyed RP data in Guangzhou Metro. The estimations show that every parameter can be distinguished though they have the same initial values. And the Bayesian CI indicates the reliability of the mean of the samples. Moreover, compared with MNL, MNP and CMNL models, the proposed CMNP model shows the best forecasting performance with respect to the prediction on the route choice probabilities and transfer flow volumes.</p>
<p>In the future, we will try to estimate the proposed model based on the smart card data and the travel time reliability will also be considered in the model.</p>
</sec>
<sec id="sec014">
<title>Supporting information</title>
<supplementary-material id="pone.0178789.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Estimations of MNL, CMNL and CMNP models.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0178789.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.s002" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>The comparisons of all models.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0178789.s003" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pone.0178789.s003" xlink:type="simple">
<label>S1 Dataset</label>
<caption>
<title>All data used in this paper.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Many thanks for helpful suggestions from reviewers and the editor.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0178789.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raveau</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Muñoz</surname> <given-names>J C</given-names></name>, <name name-style="western"><surname>De Grange</surname> <given-names>L</given-names></name>. <article-title>A topological route choice model for metro</article-title>. <source>Transportation Research Part A: Policy and Practice</source>. <year>2011</year>; <volume>45</volume>(<issue>2</issue>): <fpage>138</fpage>–<lpage>147</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yao</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dai</surname> <given-names>H</given-names></name>. <article-title>Transfer volume forecasting method for the metro in networking conditions</article-title>. <source>Journal of the China Railway Society</source>. <year>2013</year>; <volume>23</volume>(<issue>11</issue>): <fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simon</surname> <given-names>H A</given-names></name>. <article-title>A behavioral model of rational choice</article-title>. <source>The Quarterly Journal of Economics</source>. <year>1955</year>; <volume>69</volume>: <fpage>99</fpage>–<lpage>118</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tversky</surname> <given-names>A</given-names></name>. <article-title>Elimination by aspects: a theory of choice</article-title>. <source>Psychological Review</source>. <year>1972</year>; <volume>79</volume>: <fpage>281</fpage>–<lpage>299</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bovy</surname> <given-names>P H L</given-names></name>. <article-title>On modelling route choice sets in transportation networks: a synthesis</article-title>. <source>Transport Reviews</source>. <year>2009</year>; <volume>29</volume>: <fpage>43</fpage>–<lpage>68</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yai</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Iwakura</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Morichi</surname> <given-names>S</given-names></name>. <article-title>Multinomial Probit with structured covariance for route choice behavior</article-title>. <source>Transportation Research Part B: Methodological</source>. <year>1997</year>; <volume>31</volume>(<issue>3</issue>): <fpage>195</fpage>–<lpage>207</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daganzo</surname> <given-names>C F</given-names></name>, <name name-style="western"><surname>Sheffi</surname> <given-names>Y</given-names></name>. <article-title>On stochastic models of traffic assignment</article-title>. <source>Transportation Science</source>. <year>1977</year>; <volume>11</volume>(<issue>3</issue>): <fpage>253</fpage>–<lpage>274</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McFadden</surname> <given-names>D</given-names></name>. <article-title>The revealed preferences of government bureaucracy</article-title>. <source>Bell Journal of Economics Management Science</source>. <year>1968</year>; <volume>6</volume>: <fpage>401</fpage>–<lpage>416</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dial</surname> <given-names>R B</given-names></name>. <article-title>A probabilistic multipath traffic assignment model: which obviates path enumeration</article-title>. <source>Transportation Research</source>. <year>1971</year>; <volume>5</volume>: <fpage>83</fpage>–<lpage>111</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref010"><label>10</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Ramming</surname> <given-names>M S</given-names></name>. <source>Network knowledge and route choice</source>. <publisher-loc>Massachusetts</publisher-loc>: <publisher-name>Massachusetts Institute of Technology</publisher-name>. <year>2001</year>: <fpage>111</fpage>–<lpage>212</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yao</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>. <article-title>Personalized route planning algorithm for urban rail transit passengers</article-title>. <source>Journal of Transportation Systems Engineering and Information Technology</source>. <year>2014</year>; <volume>14</volume>(<issue>05</issue>): <fpage>100</fpage>–<lpage>104</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref012"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Cascetta E, Nuzzolo A, Russo F, Vitetta A. A modified Logit route choice model overcoming path overlapping problems: specification and some calibration results for interurban networks, 13th International Symposium on Transportation and Traffic Theory. 1996; France.</mixed-citation></ref>
<ref id="pone.0178789.ref013"><label>13</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Ben-Akiva</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bierlaire</surname> <given-names>M</given-names></name>. <source>Discrete choice methods and their applications to short term travel decisions</source>. <year>1999</year>; <publisher-name>Springer</publisher-name>, <publisher-loc>US</publisher-loc>.</mixed-citation></ref>
<ref id="pone.0178789.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bekhor</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ben-Akiva</surname> <given-names>M E</given-names></name>, <name name-style="western"><surname>Ramming</surname> <given-names>M S</given-names></name>. <article-title>Evaluation of choice set generation algorithms for route choice models</article-title>. <source>Annals of Operations Research</source>. <year>2006</year>; <volume>14</volume>(<issue>1</issue>): <fpage>235</fpage>–<lpage>247</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref015"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Chu C. A paired combinatorial Logit model for travel demand analysis, 5th World Conference on Transport Research, 1989; Japan.</mixed-citation></ref>
<ref id="pone.0178789.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koppelman</surname> <given-names>F S</given-names></name>, <name name-style="western"><surname>Wen</surname> <given-names>C H</given-names></name>. <article-title>The paired combinatorial Logit model: properties, estimation and application</article-title>. <source>Transportation Research Part B: Methodological</source>. <year>2000</year>; <volume>34</volume>(<issue>2</issue>): <fpage>75</fpage>–<lpage>89</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref017"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Vovsha P. The cross-nested Logit model: application to mode choice in the Tel-Aviv metropolitan area, 76th Transportation Research Board Annual Meeting. 1997; Washington D. C., USA.</mixed-citation></ref>
<ref id="pone.0178789.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wen</surname> <given-names>C H</given-names></name>, <name name-style="western"><surname>Koppelman</surname> <given-names>F S</given-names></name>. <article-title>The generalized nested Logit model</article-title>. <source>Transportation Research Part B: Methodological</source>. <year>2001</year>; <volume>35</volume>(<issue>7</issue>): <fpage>627</fpage>–<lpage>641</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McFadden</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Train</surname> <given-names>K</given-names></name>. <article-title>Mixed MNL models for discrete response</article-title>. <source>Journal of Applied Econometrics</source>. <year>2000</year>; <volume>15</volume>(<issue>5</issue>): <fpage>447</fpage>–<lpage>470</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raveau</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Muñozs</surname> <given-names>J C</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>N H M</given-names></name>. <article-title>A behavioural comparison of route choice on metro networks: time, transfers, crowding, topology and socio-demographics</article-title>. <source>Transportation Research Part A: Policy and Practice</source>. <year>2014</year>; <volume>66</volume>: <fpage>185</fpage>–<lpage>195</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref021"><label>21</label><mixed-citation publication-type="other" xlink:type="simple">Zhang Y, Yao E, Liu S. A constrained MNL route choice model for metro passengers, 94th Transportation Research Board Annual Meeting. 2015; Washington D. C., USA.</mixed-citation></ref>
<ref id="pone.0178789.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martínez</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Aguila</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Hurtubia</surname> <given-names>R</given-names></name>. <article-title>The constrained multinomial Logit: a semi-compensatory choice model</article-title>. <source>Transportation Research Part B: Methodological</source>. <year>2009</year>; <volume>43</volume>(<issue>3</issue>): <fpage>365</fpage>–<lpage>377</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Castro</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Martı´nez</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Munizaga</surname> <given-names>M A</given-names></name>. <article-title>Estimation of a constrained multinomial Logit model</article-title>. <source>Transportation</source>. <year>2013</year>; <volume>40</volume>(<issue>3</issue>), <fpage>563</fpage>–<lpage>581</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cantillo</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Ortu´zar</surname> <given-names>J D</given-names></name>. <article-title>A semi-compensatory discrete choice model with explicit attribute thresholds of perception</article-title>. <source>Transportation Research Part B: Methodological</source>. <year>2005</year>; <volume>39</volume>(<issue>7</issue>): <fpage>641</fpage>–<lpage>657</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref025"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Kaplan S, Prato C G. Joint modeling of constrained path enumeration and path choice behaviour: a semi-compensatory approach, European Transport Conference. 2010; Glasgow.</mixed-citation></ref>
<ref id="pone.0178789.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kaplan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Prato</surname> <given-names>C G</given-names></name>. <article-title>Closing the gap between behavior and models in route choice: the role of spatiotemporal constraints and latent traits in choice set formation</article-title>. <source>Transportation Research Part F: Psychology and Behaviour</source>. <year>2012</year>; <volume>15</volume>(<issue>1</issue>): <fpage>9</fpage>–<lpage>24</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Manski</surname> <given-names>C</given-names></name>. <article-title>The structure of random utility models</article-title>. <source>Theory and Decision</source>. <year>1977</year>; <volume>8</volume>(<issue>3</issue>): <fpage>229</fpage>–<lpage>254</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref028"><label>28</label><mixed-citation publication-type="other" xlink:type="simple">Morikawa T. A hybrid probabilistic choice set model with compensatory and non-compensatory choice rules, 7th World Conference on Transport Research. 1995; Pergamon, Oxford.</mixed-citation></ref>
<ref id="pone.0178789.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rob</surname> <given-names>V N</given-names></name>, <name name-style="western"><surname>Hoogendoorn-Lanser</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Koppelman</surname> <given-names>F S</given-names></name>. <article-title>Using choice sets for estimation and prediction in route choice</article-title>. <source>Transportmetrica</source>. <year>2008</year>; <volume>4</volume>(<issue>2</issue>), <fpage>83</fpage>–<lpage>96</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kaplan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Shiftan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bekhor</surname> <given-names>S</given-names></name>. <article-title>Development and estimation of a semi-compensatory model with a flexible error structure</article-title>. <source>Transportation Research Part B: Methodological</source>. <year>2012</year>; <volume>46</volume>(<issue>2</issue>): <fpage>291</fpage>–<lpage>304</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Swait</surname> <given-names>J D</given-names></name>, <name name-style="western"><surname>Ben-Akiva</surname> <given-names>M E</given-names></name>. <article-title>Incorporating random constraints in discrete models of choice set generation</article-title>. <source>Transportation Research Part B: Methodological</source>. <year>1987</year>; <volume>21</volume>(<issue>2</issue>): <fpage>91</fpage>–<lpage>102</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref032"><label>32</label><mixed-citation publication-type="other" xlink:type="simple">Bliemer M C J, Bovy P H L. Impact of route choice set on route choice probabilities, 87th Transportation Research Board Annual Meeting. 2008; Washington, D. C., USA.</mixed-citation></ref>
<ref id="pone.0178789.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cascetta</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Papola</surname> <given-names>A</given-names></name>. <article-title>Random utility models with implicit availability/perception of choice alternatives for the simulation of travel demand</article-title>. <source>Transportation Research Part C: Emerging Technologies</source>. <year>2001</year>; <volume>9</volume>(<issue>4</issue>): <fpage>249</fpage>–<lpage>263</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Swait</surname> <given-names>J D</given-names></name>. <article-title>A non-compensatory choice model incorporating attribute cut-offs</article-title>. <source>Transportation Research Part B: Methodological</source>. <year>2001</year>; <volume>35</volume>(<issue>7</issue>): <fpage>903</fpage>–<lpage>928</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Timothy</surname> <given-names>J G</given-names></name>, <name name-style="western"><surname>Greg</surname> <given-names>M A</given-names></name>. <article-title>A choice model with conjunctive, disjunctive, and compensatory screening rules</article-title>. <source>Marketing Science</source>. <year>2004</year>; <volume>23</volume>(<issue>3</issue>): <fpage>391</fpage>–<lpage>406</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nobile</surname> <given-names>A</given-names></name>. <article-title>A Hybrid Markov Chain for the Bayesian Analysis of the Multinomial Probit Model</article-title>. <source>Statistics and Computing</source>. <year>1995</year>; <volume>8</volume>: <fpage>229</fpage>–<lpage>242</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Genz</surname> <given-names>A</given-names></name>. <article-title>Numerical computation of the multivariate normal probabilities</article-title>. <source>Journal of Computational and Graphical Statistics</source>. <year>1992</year>; <volume>1</volume>: <fpage>141</fpage>–<lpage>150</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Genz</surname> <given-names>A</given-names></name>. <article-title>Comparison of methods for the computation of multivariate normal probabilities</article-title>. <source>Computing Science and Statisties</source>. <year>1993</year>; <volume>25</volume>: <fpage>400</fpage>–<lpage>405</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Metropolis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname> <given-names>A W</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname> <given-names>M N</given-names></name>, <name name-style="western"><surname>Teller</surname> <given-names>A H</given-names></name>, <name name-style="western"><surname>Teller</surname> <given-names>E</given-names></name>. <article-title>Equation of state calculations by fast computing machines</article-title>. <source>The Journal of Chemical Physics</source>. <year>1953</year>; <volume>21</volume> (<issue>6</issue>): <fpage>1087</fpage>–<lpage>1092</lpage>.</mixed-citation></ref>
<ref id="pone.0178789.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hastings</surname> <given-names>W K</given-names></name>. <article-title>Monte Carlo sampling methods using Markov Chains and their applications</article-title>. <source>Biometrika</source>. <year>1970</year>; <volume>57</volume>: <fpage>97</fpage>–<lpage>109</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>