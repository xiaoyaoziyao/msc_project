<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-1163R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000868</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Evolutionary Modeling</subject><subject>Computational Biology/Metabolic Networks</subject><subject>Computational Biology/Systems Biology</subject></subj-group></article-categories><title-group><article-title>A Bayesian Approach to the Evolution of Metabolic Networks on a Phylogeny</article-title><alt-title alt-title-type="running-head">Metabolic Evolution on a Phylogeny</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mithani</surname><given-names>Aziz</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Preston</surname><given-names>Gail M.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hein</surname><given-names>Jotun</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Statistics, University of Oxford, Oxford, United Kingdom</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Plant Sciences, University of Oxford, Oxford, United Kingdom</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Regev</surname><given-names>Aviv</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Broad Institute of MIT and Harvard, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">mithani@stats.ox.ac.uk</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: AM GMP JH. Analyzed the data: AM. Wrote the paper: AM GMP JH.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>8</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>5</day><month>8</month><year>2010</year></pub-date><volume>6</volume><issue>8</issue><elocation-id>e1000868</elocation-id><history>
<date date-type="received"><day>28</day><month>9</month><year>2009</year></date>
<date date-type="accepted"><day>25</day><month>6</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Mithani et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>The availability of genomes of many closely related bacteria with diverse metabolic capabilities offers the possibility of tracing metabolic evolution on a phylogeny relating the genomes to understand the evolutionary processes and constraints that affect the evolution of metabolic networks. Using simple (independent loss/gain of reactions) or complex (incorporating dependencies among reactions) stochastic models of metabolic evolution, it is possible to study how metabolic networks evolve over time. Here, we describe a model that takes the reaction neighborhood into account when modeling metabolic evolution. The model also allows estimation of the strength of the neighborhood effect during the course of evolution. We present Gibbs samplers for sampling networks at the internal node of a phylogeny and for estimating the parameters of evolution over a phylogeny without exploring the whole search space by iteratively sampling from the conditional distributions of the internal networks and parameters. The samplers are used to estimate the parameters of evolution of metabolic networks of bacteria in the genus <italic>Pseudomonas</italic> and to infer the metabolic networks of the ancestral pseudomonads. The results suggest that pathway maps that are conserved across the <italic>Pseudomonas</italic> phylogeny have a stronger neighborhood structure than those which have a variable distribution of reactions across the phylogeny, and that some <italic>Pseudomonas</italic> lineages are going through genome reduction resulting in the loss of a number of reactions from their metabolic networks.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Metabolic networks correspond to one of the most complex cellular processes. Most organisms have a common set of reactions as a part of their metabolic networks that relate to essential processes such as generation of energy and the synthesis of important biological molecules, which are required for their survival. However, a large proportion of the reactions present in different organisms are specific to the needs of individual organisms. The regions of metabolic networks corresponding to these non-essential reactions are under continuous evolution. Using different models of evolution, we can ask important biological questions about the ways in which the metabolic networks of different organisms enable them to be well-adapted to the environments in which they live, and how these metabolic adaptations have evolved. We use a stochastic approach to study the evolution of metabolic networks and show that evolutionary inferences can be made using the structure of these networks. Our results indicate that plant pathogenic <italic>Pseudomonas</italic> are going through genome reduction resulting in the loss of metabolic functionalities. We also show the potential of stochastic approaches to infer the networks present at ancestral levels of a given phylogeny compared to deterministic methods such as parsimony.</p>
</abstract><funding-group><funding-statement>This work was supported by the grants from the Higher Education Commission, Government of Pakistan (AM), The Royal Society (GMP) and the Biotechnology and Biological Sciences Research Council grant BB/E007872/1 (GMP). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="19"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Biological networks are under continuous evolution and their evolution is one of the major areas of research today <xref ref-type="bibr" rid="pcbi.1000868-Dorogovtsev1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1000868-Ratmann1">[6]</xref>. The evolution of biological networks can be studied using various approaches such as maximum likelihood and parsimony <xref ref-type="bibr" rid="pcbi.1000868-Pl1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1000868-Stumpf1">[8]</xref>. The maximum likelihood approach calculates the likelihood of evolution of one network into another by summing over all possible networks that can occur during the course of evolution under the given model. Parsimony, on the other hand, assumes minimum evolution and only considers those networks that correspond to the minimum number of changes between the two networks. However, the problem with these approaches is that enumeration of networks potentially occurring during evolution becomes impractical in the case of biological networks as the number of networks grows exponentially with the network size. Recently, the evolution of biological networks has been studied using stochastic approaches where efficient sampling techniques makes the problem computationally tractable. For example, Wiuf <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Wiuf1">[5]</xref> used importance sampling to approximate the likelihood and estimate parameters for the growth of protein networks under a duplicate attachment model. Similarly, Ratmann <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Ratmann1">[6]</xref> used approximate Bayesian computation to summarize key features of protein networks. The authors also approximated the posterior distribution of the model parameters for network growth using a Markov Chain Monte Carlo algorithm.</p>
<p>In this work, we focus on metabolic networks. The evolution of metabolic networks is characterized by gain and loss of reactions (or enzymes) connecting two or more metabolites and can be described as a discrete space continuous time Markov process where at each step of the network evolution a reaction is either added or deleted until the desired network is obtained <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref>. To give a biologically relevant picture of evolution some reactions may be defined as core (reactions that cannot be deleted during the course of evolution) or prohibited (reactions that cannot be added) in the given networks. The evolution of metabolic networks can then be studied using simple (independent loss/gain of reactions) or complex (incorporating dependencies among reactions) stochastic models of metabolic evolution. We previously presented a neighbor-dependent model for the insertion and deletion of edges from a network where the rates with which reactions are added or removed from a network depend on the fraction of neighboring reactions present in the network <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref>. In this model, two reactions were considered to be neighbors if they shared at least one metabolite. The model is summarized in Section ‘Neighbor-dependent model’ below. The neighbor-dependent model depicts a biologically relevant picture of metabolic evolution by taking the network structure into account when calculating the rates of insertion and deletion of reactions from a network. The model is, however, limited in the sense that it does not allow one to measure the strength of the neighborhood structure affecting network evolution.</p>
<p>Here, we present an extended model called the hybrid model that combines an independent edge model, where edges are gained or lost independently, and a neighbor-dependent model of network evolution <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref> such that the rate of going from one network to another is a sum of the rates under the two models based on a parameter, which measures the probability of being in the neighbor dependent model. This allows estimation of the neighborhood effect during metabolic evolution. When modeling network evolution, we represent metabolic networks as directed hypergraphs <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref>–<xref ref-type="bibr" rid="pcbi.1000868-Yeung1">[11]</xref>, where an edge called a hyperedge represents a reaction and may connect any number of vertices or metabolites. Representing metabolic networks as hypergraphs not only captures the relationship between multiple metabolites involved in a reaction but also provides an intuitive approach to study evolution since loss or gain of reactions can be regarded as loss or gain of hyperedges.</p>
<p>We use the hybrid model to study the evolution of a set of metabolic networks connected over a phylogeny. Previous attempts to study the evolution of metabolic networks in a phylogenetic context include Dandekar <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Dandekar1">[12]</xref> and Peregrin <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-PeregrinAlvarez1">[13]</xref>. However, to our knowledge, the stochastic treatment of metabolic evolution over a phylogeny is an unexplored area. Here, the phylogenetic relationship between the networks is established using sequence data since the metabolic annotations available for the majority of genome-sequenced organisms are generated using automated annotation tools based on the similarity of predicted genes to genes of known function and, therefore, contain a huge amount of noise. In addition, we treat the branch lengths obtained using the sequence data as certain. The advantage of fixing branch lengths is that the calculations do not require summing over all branch lengths for the given tree. Calculating the likelihood over a phylogeny then requires a sum, over all possible networks that may have existed at the interior nodes of the tree, of the probabilities of each scenario of events. This is similar to the idea introduced by Felsenstein <xref ref-type="bibr" rid="pcbi.1000868-Felsenstein1">[14]</xref> for observing DNA sequences over a phylogeny. To sample the networks at internal nodes of the tree a Gibbs sampler <xref ref-type="bibr" rid="pcbi.1000868-Gelfand1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1000868-Geman1">[16]</xref> is presented that samples a network conditioned on its three neighbors, including a parent and two children networks, for given parameter values. A Gibbs sampler for estimating the parameters of evolution that encases the Gibbs sampler for internal networks sampling is also presented. The sampler estimates the evolution parameters without exploring the whole search space by iteratively sampling from the conditional distributions of the trees and parameters. We demonstrate the Gibbs sampler by estimating and comparing the evolution parameters for the metabolic networks of bacteria belonging to the genus <italic>Pseudomonas</italic>. The Gibbs sampler can also be used to infer the ancestral networks of a given phylogeny. This is shown by inferring the metabolic networks of <italic>Pseudomonas</italic> spp. ancestors.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<sec id="s2a">
<title>Neighbor-dependent model</title>
<p>In the neighbor-dependent for the evolution of metabolic networks <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref> hyperedges are inserted or deleted from a network depending on the fraction of neighboring hyperedges present in the network. Two hyperedges are considered as neighbors if they share a node. The model assumes that the number of nodes in a network remains fixed and there is a set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e001" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e002" xlink:type="simple"/></inline-formula> of hyperedges connecting these nodes. The model also assumes the existence of a network called <italic>Reference Network</italic> which contains all these hyperedges. If the hyperedges in the reference network are labeled 1 to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e003" xlink:type="simple"/></inline-formula> then any given network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e004" xlink:type="simple"/></inline-formula> can be represented as a sequence of 0s and 1s such that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e005" xlink:type="simple"/></inline-formula>-th entry <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e006" xlink:type="simple"/></inline-formula> in the sequence is 1 if and only if the hyperedge labeled <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e007" xlink:type="simple"/></inline-formula> is present in the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e008" xlink:type="simple"/></inline-formula>, and 0 otherwise. Let the rate matrix describing the evolution under the neighbor-dependent model be denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e009" xlink:type="simple"/></inline-formula>. An entry <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e010" xlink:type="simple"/></inline-formula> in this rate matrix corresponds to the rate of going from a network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e011" xlink:type="simple"/></inline-formula> to a network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e012" xlink:type="simple"/></inline-formula>, which differs from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e013" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e014" xlink:type="simple"/></inline-formula>. In the neighbor-dependent model, the rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e015" xlink:type="simple"/></inline-formula> of going from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e016" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e017" xlink:type="simple"/></inline-formula> depends on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e018" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e019" xlink:type="simple"/></inline-formula> and the neighboring hyperedges <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e020" xlink:type="simple"/></inline-formula> present in the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e021" xlink:type="simple"/></inline-formula>, and is given as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e022" xlink:type="simple"/><label>(1)</label></disp-formula>where the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e023" xlink:type="simple"/></inline-formula> corresponds to the neighborhood component and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e024" xlink:type="simple"/></inline-formula> is the appropriate entry from the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e025" xlink:type="simple"/></inline-formula> rate matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e026" xlink:type="simple"/></inline-formula> for the hyperedge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e027" xlink:type="simple"/></inline-formula>. The rate matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e028" xlink:type="simple"/></inline-formula> is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e029" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e030" xlink:type="simple"/></inline-formula> is the insertion rate and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e031" xlink:type="simple"/></inline-formula> is the deletion rate.</p>
<p>The neighborhood component <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e032" xlink:type="simple"/></inline-formula> weights the insertion and deletion rates by the proportion of neighbors present in the network and is given as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e033" xlink:type="simple"/><label>(3)</label></disp-formula>The denominator <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e034" xlink:type="simple"/></inline-formula> in Equation 3 gives the number of hyperedges present in the current network.</p>
</sec><sec id="s2b">
<title>Hybrid model of network evolution</title>
<p>Although the neighbor-dependent model summarized above produces a biologically relevant behavior whereby highly connected reactions are toggled more frequently than the poorly connected counterparts, it does not allow one to determine the strength of the neighborhood structure effecting the evolution of metabolic networks. To overcome this limitation, a parameter can be introduced in the model that corresponds to the neighborhood effect during the course of metabolic network evolution.</p>
<p>Consider two networks <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e035" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e036" xlink:type="simple"/></inline-formula> which differ at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e037" xlink:type="simple"/></inline-formula>. The hybrid model combines the independent edge model where edges are added or deleted independently, and the neighbor-dependent model summarized above such that the rate of going from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e038" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e039" xlink:type="simple"/></inline-formula> is the sum of the rates under the two models based on a parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e040" xlink:type="simple"/></inline-formula>, which specifies the probability of being in the neighbor-dependent model. The rate from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e041" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e042" xlink:type="simple"/></inline-formula> is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e043" xlink:type="simple"/></disp-formula>where the term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e044" xlink:type="simple"/></inline-formula> is the rate under the neighbor-dependent model given by Equation 1 and the term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e045" xlink:type="simple"/></inline-formula> is the rate under the independent edge model corresponding to the appropriate entry from the rate matrix Q given by Equation 2. Substituting the value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e046" xlink:type="simple"/></inline-formula> from Equation 1, the above equation can be simplified as follows.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e047" xlink:type="simple"/><label>(4)</label></disp-formula>where the term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e048" xlink:type="simple"/></inline-formula> corresponds to the neighborhood component given by Equation 3.</p>
<p>It can been seen from (4) that the model behaves under the independent edge model when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e049" xlink:type="simple"/></inline-formula> equals 0 and under the neighbor-dependent model described in the previous section when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e050" xlink:type="simple"/></inline-formula> equals 1. For example, consider the toy network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e051" xlink:type="simple"/></inline-formula> shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1A</xref>. The reference network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e052" xlink:type="simple"/></inline-formula> containing all allowed hyperedges for this example system is also shown in the figure. The system behavior for different values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e053" xlink:type="simple"/></inline-formula> is illustrated in <xref ref-type="supplementary-material" rid="pcbi.1000868.s001">Figure S1</xref> for the toy network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e054" xlink:type="simple"/></inline-formula> when simulated under the hybrid model along with the number of neighbors for each hyperedge. The rates were calculated at each step using (4). An edge was then selected based on these rates and was inserted if absent from the current network and deleted otherwise. As expected, hyperedges evolve independently when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e055" xlink:type="simple"/></inline-formula>, resulting in similar insertion frequencies for all hyperedges and increasingly reflecting their neighborhood as the value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e056" xlink:type="simple"/></inline-formula> goes up to unity. The fitness of the model is discussed in the Section ‘Fitness of the hybrid model’ below.</p>
<fig id="pcbi-1000868-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g001</object-id><label>Figure 1</label><caption>
<title>Toy networks connected by a phylogeny.</title>
<p>(A) Toy networks consisting of 13 nodes. The nodes are labeled from A to M (blue) and the hyperedges are labeled from 1 to 10 (red). The reference network consists of all allowed hyperedges for this example system. Networks <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e057" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e058" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e059" xlink:type="simple"/></inline-formula> consist of subsets of the hyperedges from the reference network. (B) A phylogeny connecting the networks <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e060" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e061" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e062" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g001" xlink:type="simple"/></fig></sec><sec id="s2c">
<title>Evolution on a phylogeny</title>
<p>Biological networks are connected over a phylogenetic tree which is known through sequence analysis. Calculating the likelihood over a phylogeny requires a sum, over all possible networks that may have existed at the interior nodes of the tree, of the probabilities of each scenario of events. For example, <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1A</xref> shows an example system containing three networks <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e063" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e064" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e065" xlink:type="simple"/></inline-formula> with a phylogeny connecting the three networks shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1B</xref>. Let the phylogenetic tree be denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e066" xlink:type="simple"/></inline-formula>. The likelihood of the tree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e067" xlink:type="simple"/></inline-formula> is given as follows.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e068" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p>Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e069" xlink:type="simple"/></inline-formula> denotes the parameters of the model, which is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e070" xlink:type="simple"/></inline-formula> in the case of the neighbor-dependent model and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e071" xlink:type="simple"/></inline-formula> in the case of the hybrid model. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e072" xlink:type="simple"/></inline-formula> is the marginal probability of observing the root and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e073" xlink:type="simple"/></inline-formula> denotes the pairwise likelihood of evolving from the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e074" xlink:type="simple"/></inline-formula> to the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e075" xlink:type="simple"/></inline-formula> conditioned on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e076" xlink:type="simple"/></inline-formula> in time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e077" xlink:type="simple"/></inline-formula> for the given parameters.</p>
<p>In general, the likelihood of a tree with more than three networks can be calculated using the recursion described by Felsenstein <xref ref-type="bibr" rid="pcbi.1000868-Felsenstein2">[17]</xref>. The likelihood at an internal node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e078" xlink:type="simple"/></inline-formula> of the tree is given by the following recurrence relation<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e079" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e080" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e081" xlink:type="simple"/></inline-formula> are left and right descendants of the node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e082" xlink:type="simple"/></inline-formula>. The likelihood of the complete tree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e083" xlink:type="simple"/></inline-formula> is then given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e084" xlink:type="simple"/><label>(7)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e085" xlink:type="simple"/></inline-formula> is the marginal probability of observing the root and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e086" xlink:type="simple"/></inline-formula> is given by Equation 6.</p>
<p>Evaluating Equations 5 and 7 requires an algorithm to systematically and efficiently sample networks at the internal nodes of a tree and a method to calculate the pairwise likelihood of network evolution. A Metropolis-Hastings algorithm to calculate the pairwise likelihood based on sampling paths between network pairs was described by Mithani <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref>, which calculates the likelihood by summing over paths between the given network pairs. To sample networks at the internal node of a tree, a Markov chain can be constructed where states correspond to networks at the internal nodes. The networks can then be sampled using a Gibbs sampler <xref ref-type="bibr" rid="pcbi.1000868-Gelfand1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1000868-Geman1">[16]</xref> as described in the next section.</p>
</sec><sec id="s2d">
<title>Sampling internal nodes</title>
<p>Given a set of networks related by a phylogenetic tree, the networks at the internal nodes of the tree can be sampled using a Gibbs sampler. The general idea is to sample each internal network by conditioning on its three neighbors (one parent and two children). This approach for sampling internal networks is similar to the one used by Holmes and Bruno <xref ref-type="bibr" rid="pcbi.1000868-Holmes1">[18]</xref> for DNA sequence alignment. However, instead of using linear sequences, the sampler takes into account the network structure when calculating the new state. The procedure is described below.</p>
<p>Consider a network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e087" xlink:type="simple"/></inline-formula> with its three neighbors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e088" xlink:type="simple"/></inline-formula> with branch lengths <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e089" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e090" xlink:type="simple"/></inline-formula>. The new network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e091" xlink:type="simple"/></inline-formula> is selected as follows.</p>
<list list-type="order"><list-item>
<p>For each hyperedge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e092" xlink:type="simple"/></inline-formula>, calculate the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e093" xlink:type="simple"/></inline-formula> rate matrix<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e094" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e095" xlink:type="simple"/></inline-formula> is the neighbor-dependence probability, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e096" xlink:type="simple"/></inline-formula> is the rate matrix given by Equation 2 and the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e097" xlink:type="simple"/></inline-formula> corresponds to the neighborhood component given by Equation 3.</p>
</list-item><list-item>
<p>Calculate, for each neighbor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e098" xlink:type="simple"/></inline-formula>, the transition probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e099" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Sample the new state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e100" xlink:type="simple"/></inline-formula> for hyperedge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e101" xlink:type="simple"/></inline-formula> from the distribution<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e102" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e103" xlink:type="simple"/></inline-formula> is the vector equilibrium probabilities and can be obtained by solving the equation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e104" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
<p><bold>Example</bold> Consider the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e105" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1000868-g002">Figure 2</xref> for which new state is to be calculated. Denote the network by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e106" xlink:type="simple"/></inline-formula>. The three neighboring networks of the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e107" xlink:type="simple"/></inline-formula> are the networks <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e108" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e109" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e110" xlink:type="simple"/></inline-formula> labeled as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e111" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e112" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e113" xlink:type="simple"/></inline-formula> respectively. If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e114" xlink:type="simple"/></inline-formula> denotes the neighborhood component for hyperedge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e115" xlink:type="simple"/></inline-formula> then for the given rate parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e116" xlink:type="simple"/></inline-formula> (insertion) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e117" xlink:type="simple"/></inline-formula> (deletion), and the neighbor-dependence probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e118" xlink:type="simple"/></inline-formula> the rate matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e119" xlink:type="simple"/></inline-formula> is written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e120" xlink:type="simple"/></disp-formula>For simplicity, assume that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e121" xlink:type="simple"/></inline-formula>. The system then behaves under the neighbor-dependent model and the rate matrix simplifies to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e122" xlink:type="simple"/></disp-formula>The transition probability matrix of transforming <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e123" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e124" xlink:type="simple"/></inline-formula> is then given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e125" xlink:type="simple"/></disp-formula>The transition probability matrices <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e126" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e127" xlink:type="simple"/></inline-formula> can be calculated in the similar fashion.</p>
<fig id="pcbi-1000868-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g002</object-id><label>Figure 2</label><caption>
<title>A sample phylogenetic tree for the toy networks shown in <xref ref-type="fig" rid="pcbi-1000868-g001"><bold>Figure 1</bold></xref>.</title>
<p>The tree contains arbitrary networks assigned at the internal nodes. Also shown are the proportion of insertion and deletion events and the proportion of allowed insertion and deletion events while going from various ancestral networks to descendant networks.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g002" xlink:type="simple"/></fig>
<p>Once the transition probability matrices have been obtained, the sample for the new network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e128" xlink:type="simple"/></inline-formula> can be drawn using Equation 8. For example, if the current configuration of the networks are taken as shown in <xref ref-type="fig" rid="pcbi-1000868-g002">Figure 2</xref>, then the sample for the new state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e129" xlink:type="simple"/></inline-formula>, for hyperedge 1 is drawn from the following distribution:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e130" xlink:type="simple"/></disp-formula></p>
<p>The samples for hyperedges labeled 2 to 10 can be drawn in a similar fashion to obtain the new network.</p>
</sec><sec id="s2e">
<title>Estimation of parameters</title>
<p>The Gibbs sampler described above samples the internal networks on a phylogenetic tree for given parameter values. This can be extended to estimate the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e131" xlink:type="simple"/></inline-formula> of evolution where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e132" xlink:type="simple"/></inline-formula> equals (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e133" xlink:type="simple"/></inline-formula>) in case of the neighbor-dependent model and (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e134" xlink:type="simple"/></inline-formula>) in case of the hybrid model. One way is to nest it within another Gibbs Sampler which iteratively samples internal networks and parameters from the distributions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e135" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e136" xlink:type="simple"/></inline-formula> respectively. The general outline of the Gibbs sampler is as follows:</p>
<list list-type="bullet"><list-item>
<p>Choose initial values for the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e137" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Generate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e138" xlink:type="simple"/></inline-formula> by using the procedure described in Section ‘Sampling internal nodes’ using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e139" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e140" xlink:type="simple"/></inline-formula> to generate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e141" xlink:type="simple"/></inline-formula> by drawing from the distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e142" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Repeat <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e143" xlink:type="simple"/></inline-formula> times to get subset of points <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e144" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e145" xlink:type="simple"/></inline-formula>, are the simulated estimates from the joint distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e146" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
<p>The samples for parameters can be drawn using a Metropolis-Hastings algorithm <xref ref-type="bibr" rid="pcbi.1000868-Metropolis1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1000868-Hastings1">[20]</xref> as described next. Since the Metropolis-Hastings algorithm is a well-established method, it suffices here to give details about how a proposal for new parameters can be generated. Readers interested in the general details of the algorithm are referred to Chapter 1 of Gilks <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Gilks1">[21]</xref>. The performance of the Gibbs sampler is discussed in <xref ref-type="supplementary-material" rid="pcbi.1000868.s018">Text S1</xref>.</p>
</sec><sec id="s2f">
<title>Parameter proposal</title>
<sec id="s2f1">
<title>Rates proposal</title>
<p>For a given tree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e147" xlink:type="simple"/></inline-formula>, a proposal for the rate parameters can be generated from a gamma distribution<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e148" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e149" xlink:type="simple"/></inline-formula> is the shape parameter and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e150" xlink:type="simple"/></inline-formula> is the scale parameter. The hyper-parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e151" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e152" xlink:type="simple"/></inline-formula> can be calculated from the given tree as described next.</p>
<p>Starting from root, calculate the proportion of insertion events <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e153" xlink:type="simple"/></inline-formula> and the proportion of deletion events <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e154" xlink:type="simple"/></inline-formula> between the parent network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e155" xlink:type="simple"/></inline-formula> and the child network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e156" xlink:type="simple"/></inline-formula> in the given tree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e157" xlink:type="simple"/></inline-formula> by dividing the number of insertion and deletion events by the total number of alterable hyperedges <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e158" xlink:type="simple"/></inline-formula> in the system. Also, calculate the proportion of allowed insertion and deletion events between these pairs. Let these be denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e159" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e160" xlink:type="simple"/></inline-formula>. The hyper-parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e161" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e162" xlink:type="simple"/></inline-formula> for sampling insertion rate can then be given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e163" xlink:type="simple"/><label>(9)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e164" xlink:type="simple"/><label>(10)</label></disp-formula>Similarly, the hyper-parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e165" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e166" xlink:type="simple"/></inline-formula> for sampling deletion rate are given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e167" xlink:type="simple"/><label>(11)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e168" xlink:type="simple"/><label>(12)</label></disp-formula></p>
</sec><sec id="s2f2">
<title>Example</title>
<p>The calculation of hyper-parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e169" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e170" xlink:type="simple"/></inline-formula> is demonstrated on the tree shown in <xref ref-type="fig" rid="pcbi-1000868-g002">Figure 2</xref> connecting the toy networks shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1</xref>. The number of hyperedges in the reference network is 10. If no core or prohibited hyperedges are assumed, then the number of alterable hyperedges <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e171" xlink:type="simple"/></inline-formula> is also 10, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e172" xlink:type="simple"/></inline-formula>. Going from the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e173" xlink:type="simple"/></inline-formula> to the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e174" xlink:type="simple"/></inline-formula> there is one insertion event and one deletion event out of 2 and 8 allowed insertion and deletion events respectively resulting in the following values:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e175" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e176" xlink:type="simple"/></disp-formula>The same is true for going from the network pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e177" xlink:type="simple"/></inline-formula>. Values for other network pairs can be calculated in a similar fashion. The values for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e178" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e179" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e180" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e181" xlink:type="simple"/></inline-formula> for all parent-child pairs in the example tree are listed in <xref ref-type="fig" rid="pcbi-1000868-g002">Figure 2</xref>. Using Equations 9 and 10, the hyper-parameters for sampling the insertion rate are calculated as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e182" xlink:type="simple"/></disp-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e183" xlink:type="simple"/></inline-formula>Similarly, using Equations 11 and 12 the hyper-parameters for sampling the deletion rate become<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e184" xlink:type="simple"/></disp-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e185" xlink:type="simple"/></inline-formula></p>
</sec><sec id="s2f3">
<title>Dependence probability proposal</title>
<p>The hybrid model for metabolic network evolution described above allows estimation of the neighborhood effect shaping the evolution of given set of networks. The proposal for the parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e186" xlink:type="simple"/></inline-formula> measuring the probability of being in the neighbor-dependent model can be generated from a beta distribution<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e187" xlink:type="simple"/></disp-formula>where the hyper-parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e188" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e189" xlink:type="simple"/></inline-formula> are the shape parameters and are calculated as follows.</p>
<p>Calculate the average number of neighbors present in the networks present at the leaves of the phylogeny. For example, if the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e190" xlink:type="simple"/></inline-formula> is a leaf network, i.e. it occurs at the tip of the given phylogenetic tree, then calculate<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e191" xlink:type="simple"/></disp-formula>The parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e192" xlink:type="simple"/></inline-formula> is then given as the mean of the average number of neighbors present in all the networks present at the leaves of the given phylogenetic tree. For a tree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e193" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e194" xlink:type="simple"/></inline-formula> leaves, this can be written as follows.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e195" xlink:type="simple"/><label>(13)</label></disp-formula></p>
<p>The shape parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e196" xlink:type="simple"/></inline-formula> corresponds to the average number of neighbors in the reference network (REF) and is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e197" xlink:type="simple"/><label>(14)</label></disp-formula></p>
</sec></sec><sec id="s2g">
<title>Proposal probability</title>
<sec id="s2g1">
<title>Rates proposal</title>
<p>The proposal probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e198" xlink:type="simple"/></inline-formula> for the rate parameters is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e199" xlink:type="simple"/></disp-formula>such that<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e200" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e201" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e202" xlink:type="simple"/></inline-formula> are the hyper-parameters of the gamma distribution given by Equations 9 and 10 respectively when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e203" xlink:type="simple"/></inline-formula> and by Equations 11 and 12 otherwise.</p>
</sec><sec id="s2g2">
<title>Dependence probability proposal</title>
<p>The proposal probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e204" xlink:type="simple"/></inline-formula> for the dependence probability parameters is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e205" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e206" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e207" xlink:type="simple"/></inline-formula> are the shape parameters of the beta distribution calculated using Equations 13 and 14 respectively.</p>
</sec></sec><sec id="s2h">
<title>Pairwise likelihood</title>
<p>The Metropolis-Hastings procedure described above to sample parameters requires the likelihood of the tree when moving in the parameter space. The likelihood can be calculated using Equation 5 which in turn requires calculation of the pairwise likelihood between network pairs. The pairwise likelihood can be calculated using the Metropolis-Hastings algorithm described in Mithani <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref> which calculates the likelihood by summing over all paths between the given network pair. However, for the Gibbs sampler described above in Section ‘Estimation of parameters’ this seems impractical since it will require running the Metropolis-Hastings sampler for all network pairs. An alternate way is to use a pseudo-likelihood value when calculating the acceptance probability for parameters. We calculate the pseudo-likelihood for a given network pair by dividing the network into smaller sub-networks and multiplying the pairwise likelihoods of the individual sub-networks.</p>
<p>Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e208" xlink:type="simple"/></inline-formula> denote the pseudo-likelihood from the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e209" xlink:type="simple"/></inline-formula> to the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e210" xlink:type="simple"/></inline-formula> in time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e211" xlink:type="simple"/></inline-formula> for the given parameter values. This is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e212" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e213" xlink:type="simple"/></inline-formula> is the pairwise likelihood of evolving sub-network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e214" xlink:type="simple"/></inline-formula> into <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e215" xlink:type="simple"/></inline-formula> calculated by solving the exponential <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e216" xlink:type="simple"/></inline-formula>. The procedure to obtain sub-networks <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e217" xlink:type="simple"/></inline-formula> containing at most <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e218" xlink:type="simple"/></inline-formula> hyperedges is outlined below.</p>
<list list-type="order"><list-item>
<p>Initialize <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e219" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Select the hyperedge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e220" xlink:type="simple"/></inline-formula> with highest number of neighbors and add it to the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e221" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Add the top <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e222" xlink:type="simple"/></inline-formula> neighbors of hyperedge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e223" xlink:type="simple"/></inline-formula> based on the number of neighbors to the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e224" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e225" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Remove the hyperedges present in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e226" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e227" xlink:type="simple"/></inline-formula> and calculate the number of neighbors based on the remaining hyperedges in the network.</p>
</list-item><list-item>
<p>Repeat steps 2–4 until <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e228" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Increment <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e229" xlink:type="simple"/></inline-formula> and repeat steps 2–5 until the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e230" xlink:type="simple"/></inline-formula> is exhausted.</p>
</list-item></list>
<p>An example is given in <xref ref-type="supplementary-material" rid="pcbi.1000868.s002">Figure S2</xref>, which shows the sub-networks for the toy network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e231" xlink:type="simple"/></inline-formula> shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1</xref> for different values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e232" xlink:type="simple"/></inline-formula>. The above procedure was used to calculate the pseudo-likelihood of evolution of the toy network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e233" xlink:type="simple"/></inline-formula> to the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e234" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1A</xref>) for different subnetwork sizes, and the results were compared against the likelihood obtained by the MCMC approach described in Mithani <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref> and the true likelihood values obtained by evaluating <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e235" xlink:type="simple"/></inline-formula>. All likelihood values were conditioned on the starting network. The average CPU time taken by different approaches is shown in <xref ref-type="fig" rid="pcbi-1000868-g003">Figure 3</xref> and the pseudo-likelihood values are listed in <xref ref-type="supplementary-material" rid="pcbi.1000868.s014">Table S1</xref>. The sub-network approach provides a reasonable approximation of the likelihood with a significant time advantage over the MCMC approach.</p>
<fig id="pcbi-1000868-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g003</object-id><label>Figure 3</label><caption>
<title>Average CPU time taken for calculating the pseudo-likelihood on toy networks.</title>
<p>The pseudo-likelihood of going from the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e236" xlink:type="simple"/></inline-formula> to the network <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e237" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1</xref>) was calculated conditioned on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e238" xlink:type="simple"/></inline-formula> for different sub-network sizes. The times taken for calculating the pseudo-likelihood averaged across three runs are shown in red. The horizontal lines show the average CPU time taken using the MCMC approach based on path sampling described in Mithani <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref> with 11,000 iterations including first 1,000 iteration as burn-in period (blue dashed line) and by exponentiating the full network (brown dotted line).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g003" xlink:type="simple"/></fig></sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Fitness of the hybrid model</title>
<p>To see if the hybrid model fitted the metabolic network data better than the neighbor-dependent model, a likelihood ratio test was performed using the metabolic data for the bacteria belonging to the genus <italic>Pseudomonas</italic>. The results show that the hybrid model fits the metabolic data better than the neighbor-dependent model. For example, consider the metabolic networks in <italic>Pseudomonas fluorescens</italic> Pf0-1. The maximum likelihood estimates (MLEs) for the evolution of glycolysis/gluconeogenesis map <xref ref-type="bibr" rid="pcbi.1000868-Kanehisa1">[22]</xref> from <italic>Pseudomonas fluorescens</italic> Pf-5 to <italic>P. fluorescens</italic> Pf0-1 obtained using the Gibbs sampler described by Mithani <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref> were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e239" xlink:type="simple"/></inline-formula> under the neighbor-dependent model and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e240" xlink:type="simple"/></inline-formula> under the hybrid model. Using the MLEs, the likelihood of observing the data under each model was calculated. Assuming that evolution has been taking place for a long time, it is reasonable to use the equilibrium probability of a network to approximate the probability of observing the network. The equilibrium probabilities were calculated using the procedure described by Mithani <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref>. The maximum log likelihood obtained under the neighbor-dependent model equaled −76.53 whereas the maximum log likelihood obtained under the hybrid model equaled −63.47. The likelihood ratio test statistic <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e241" xlink:type="simple"/></inline-formula> was calculated as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e242" xlink:type="simple"/></inline-formula> under <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e243" xlink:type="simple"/></inline-formula> degree of freedom. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e244" xlink:type="simple"/></inline-formula>-value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e245" xlink:type="simple"/></inline-formula> on 1 degree of freedom suggests that the hybrid model fits the data better than the neighbor-dependent model. The MLEs, maximum log-likelihoods and the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e246" xlink:type="simple"/></inline-formula>-values for different pathway maps in <italic>P. fluorescens</italic> Pf0-1 used in this analysis are listed in <xref ref-type="table" rid="pcbi-1000868-t001">Table 1</xref>. The low <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e247" xlink:type="simple"/></inline-formula>-values for all the pathway maps suggest a better fit for the hybrid model compared to the neighbor-dependent model. Likelihood ratio tests for other genome-sequenced <italic>Pseudomonas</italic> strains used in this analysiss showed similar results (data not shown).</p>
<table-wrap id="pcbi-1000868-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.t001</object-id><label>Table 1</label><caption>
<title>Likelihood ratio test between the neighbor-dependent and hybrid models of metabolic evolution.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000868-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Pathway map</td>
<td align="left" colspan="2" rowspan="1">Neighbor-dependent model</td>
<td align="left" colspan="2" rowspan="1">Hybrid model</td>
<td align="left" colspan="1" rowspan="1">LH ratio</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e248" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e249" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">Log LH</td>
<td align="left" colspan="1" rowspan="1">(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e250" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">Log LH</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Glycolysis/Gluconeogenesis</td>
<td align="left" colspan="1" rowspan="1">(2.6177, 0.4229)</td>
<td align="left" colspan="1" rowspan="1">−76.53</td>
<td align="left" colspan="1" rowspan="1">(0.4989, 0.1598, 0.2152)</td>
<td align="left" colspan="1" rowspan="1">−63.47</td>
<td align="left" colspan="1" rowspan="1">26.13</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e251" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pentose phosphate pathway</td>
<td align="left" colspan="1" rowspan="1">(0.5680, 0.7144)</td>
<td align="left" colspan="1" rowspan="1">−60.13</td>
<td align="left" colspan="1" rowspan="1">(0.4762, 0.2953, 0.4259)</td>
<td align="left" colspan="1" rowspan="1">−53.42</td>
<td align="left" colspan="1" rowspan="1">13.41</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e252" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Lysine degradation</td>
<td align="left" colspan="1" rowspan="1">(0.0127, 1.0780)</td>
<td align="left" colspan="1" rowspan="1">−59.43</td>
<td align="left" colspan="1" rowspan="1">(0.0063, 0.2926, 0.0159)</td>
<td align="left" colspan="1" rowspan="1">−52.40</td>
<td align="left" colspan="1" rowspan="1">14.05</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e253" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Histidine metabolism</td>
<td align="left" colspan="1" rowspan="1">(0.7669, 0.3895)</td>
<td align="left" colspan="1" rowspan="1">−54.22</td>
<td align="left" colspan="1" rowspan="1">(0.1852, 0.1643, 0.1370)</td>
<td align="left" colspan="1" rowspan="1">−47.28</td>
<td align="left" colspan="1" rowspan="1">13.89</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e254" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Phenylalanine metabolism</td>
<td align="left" colspan="1" rowspan="1">(1.1035, 0.6856)</td>
<td align="left" colspan="1" rowspan="1">−62.40</td>
<td align="left" colspan="1" rowspan="1">(1.0299, 1.0297, 0.0038)</td>
<td align="left" colspan="1" rowspan="1">−49.91</td>
<td align="left" colspan="1" rowspan="1">24.97</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e255" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pyruvate metabolism</td>
<td align="left" colspan="1" rowspan="1">(0.1648, 0.5656)</td>
<td align="left" colspan="1" rowspan="1">−88.64</td>
<td align="left" colspan="1" rowspan="1">(0.0897, 0.1913, 0.1194)</td>
<td align="left" colspan="1" rowspan="1">−81.74</td>
<td align="left" colspan="1" rowspan="1">13.81</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e256" xlink:type="simple"/></inline-formula></td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>The maximum likelihood estimates (MLEs) of the parameter values (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e257" xlink:type="simple"/></inline-formula>: insertion rate, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e258" xlink:type="simple"/></inline-formula>: deletion rate and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e259" xlink:type="simple"/></inline-formula>: neighbor dependence probability), maximum log-likelihoods, likelihood (LH) ratios, and the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e260" xlink:type="simple"/></inline-formula>-values for different pathway maps in <italic>P. fluorescens</italic> Pf0-1 used in this analysis. The MLEs were obtained using the Gibbs sampler described by Mithani <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref> by evolving the networks from <italic>P. fluorescens</italic> Pf-5 to <italic>P. fluorescens</italic> Pf0-1. The equilibrium probability of a network was used as the likelihood of observing the network. The low <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e261" xlink:type="simple"/></inline-formula>-values for all the pathway maps suggest a better fit for the hybrid model compared to the neighbor-dependent model.</p></fn></table-wrap-foot></table-wrap>
<p>The fit of the data was further tested by comparing the degree distributions of the nodes obtained by simulating network evolution under the neighbor-dependent and hybrid models. The MLEs for the evolution of networks obtained under the two models were used as the simulation parameters. For example, when evolving the pathway maps in <italic>P. fluorescens</italic> Pf0-1, the parameter values listed in <xref ref-type="table" rid="pcbi-1000868-t001">Table 1</xref> were used. A total of 60,000 iterations were run with the first 10,000 iteration regarded as burn-in period. Samples were collected every <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e262" xlink:type="simple"/></inline-formula> iteration and degree distributions were calculated. The results for the six pathway maps used in this analysis are shown in <xref ref-type="fig" rid="pcbi-1000868-g004">Figure 4</xref> for <italic>P. fluorescens</italic> Pf0-1 as an example which suggest a better fit for the hybrid model than the neighbor-dependent model. Similar results (data not shown) were obtained for the other genome sequenced <italic>Pseudomonas</italic> strains used in this analysis.</p>
<fig id="pcbi-1000868-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g004</object-id><label>Figure 4</label><caption>
<title>Degree distributions of nodes under the neighbor-dependent and hybrid models.</title>
<p>Boxplots showing the degree distributions of nodes obtained by simulating the evolution for the pentose phosphate pathway, lysine degradation and phenylalanine metabolism maps in <italic>P. fluorescens</italic> Pf0-1 under (A) the neighbor-dependent model and (B) the hybrid model. The red line plots the actual degree distributions observed in the corresponding pathway map in <italic>P. fluorescens</italic> Pf0-1.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g004" xlink:type="simple"/></fig></sec><sec id="s3b">
<title>Toy networks</title>
<p>To test the Gibbs sampler described in Section ‘Sampling internal nodes’, the three network phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1</xref> was used. The networks were sampled at the internal nodes for different rate combinations with the neighbor-dependence probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e263" xlink:type="simple"/></inline-formula> kept constant at 1. The likelihood value was then calculated using Equation 5 by summing over the networks visited by the sampler at each internal node for each rate combination. When calculating the likelihood over the phylogeny, the pairwise likelihood was calculated using matrix exponentiation. A total of 25,000 iterations were run for each rate combination with the first 10,000 iterations regarded as burn-in period. The exact likelihood of the phylogeny was also calculated by matrix exponentiation using all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e264" xlink:type="simple"/></inline-formula> networks at each internal node. The likelihood values estimated using the networks visited by the Gibbs sampler were comparable to those obtained by summing over all 1024 networks. The true and estimated likelihood surfaces for a range of parameter values are shown in <xref ref-type="supplementary-material" rid="pcbi.1000868.s003">Figure S3</xref>.</p>
<p>We also ran the Gibbs sampler for parameter estimation for the toy networks. The sampler was run from a random starting value for 60,000 iterations with the first 10,000 iterations regarded as burn-in period. The samples were collected every <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e265" xlink:type="simple"/></inline-formula> iteration to reduce computational overhead relating to storage as well as the correlation between samples. A sample MCMC trace for the first 1,000 iterations of the sampler for the rate parameters is shown in <xref ref-type="supplementary-material" rid="pcbi.1000868.s004">Figure S4</xref>. The autocorrelation of parameters is plotted in <xref ref-type="fig" rid="pcbi-1000868-g005">Figure 5</xref> suggesting an exponential decrease in the correlation as the lag between the samples increases. To test the performance of the sampler, the likelihood of evolution for different rate combinations visited by the sampler was also calculated using Equation 5 by summing over networks visited by the sampler with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e266" xlink:type="simple"/></inline-formula>. As before, the pairwise likelihood was evaluated by calculating the exponential of the rate matrix. The maximum likelihood averaged over three runs was found to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e267" xlink:type="simple"/></inline-formula> for parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e268" xlink:type="simple"/></inline-formula> which is very close to the true likelihood obtained by matrix exponentiation (<xref ref-type="supplementary-material" rid="pcbi.1000868.s003">Figure S3</xref>).</p>
<fig id="pcbi-1000868-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g005</object-id><label>Figure 5</label><caption>
<title>Autocorrelation of rate parameters.</title>
<p>Parameters were estimated for the toy network phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1</xref> using the Gibbs sampler described in Section ‘Estimation of parameters’. The values are averaged across three runs containing 60,000 iterations each.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g005" xlink:type="simple"/></fig></sec><sec id="s3c">
<title>Parameter estimation for metabolic networks in <italic>Pseudomonas</italic></title>
<p>To study the metabolic evolution in bacteria, we used the Gibbs sampler to estimate the evolution parameters for the metabolic networks of bacteria belonging to the genus <italic>Pseudomonas</italic>. The diversity of pseudomonads, and the availability of genome-sequence data for multiple plant-associated <italic>Pseudomonas fluorescens</italic>, <italic>Pseudomonas mendocina</italic>, <italic>Pseudomonas putida</italic>, <italic>Pseudomonas stutzeri</italic> and <italic>Pseudomonas syringae</italic> strains, along with genome data for clinical isolates of <italic>Pseudomonas aeruginosa</italic> and for the insect pathogen <italic>Pseudomonas entomophila</italic> provide an excellent opportunity to use comparative genomic approaches to develop insight into the evolution of metabolic networks. The phylogeny connecting the seventeen genome-sequenced strains of <italic>Pseudomonas</italic> is shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref>. The phylogeny was generated using multilocus sequencing analysis of conserved housekeeping genes ( <italic>gltA</italic>, <italic>gapA</italic>, <italic>rpoD</italic>, <italic>gyrB</italic>) <xref ref-type="bibr" rid="pcbi.1000868-Sarkar1">[23]</xref>. The metabolic network data was extracted from the KEGG database <xref ref-type="bibr" rid="pcbi.1000868-Kanehisa1">[22]</xref> on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e269" xlink:type="simple"/></inline-formula> January 2010 for pathway maps across the seventeen <italic>Pseudomonas</italic> strains shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref> using the Rahnuma tool <xref ref-type="bibr" rid="pcbi.1000868-Mithani2">[24]</xref>. The evolution parameters were also compared between two <italic>Pseudomonas</italic> species: <italic>P. fluorescens</italic>, a saprotroph that colonizes the soil environment, and <italic>P. syringae</italic>, a plant-pathogen that is found on leaf surfaces and in plant tissues. The phylogenetic relationships between these species is shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figures 6B and C</xref>. The results are discussed here for the six pathway maps listed in <xref ref-type="table" rid="pcbi-1000868-t002">Table 2</xref> as they provide a representative set of different neighborhood characteristics observed across the <italic>Pseudomonas</italic> strains used in this analysis. The basic information for each network across the seventeen <italic>Pseudomonas</italic> strains is given in <xref ref-type="supplementary-material" rid="pcbi.1000868.s015">Table S2</xref>.</p>
<fig id="pcbi-1000868-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g006</object-id><label>Figure 6</label><caption>
<title>Phylogenies connecting bacteria belonging to the genus <italic>Pseudomonas</italic>.</title>
<p>The phylogenies were generated using multi-locus sequence analysis of conserved housekeeping genes (<italic>gapA</italic>, <italic>gltA</italic>, <italic>rpoD</italic> and <italic>gyrB</italic>). (A) Phylogeny relating the seventeen genome-sequenced <italic>Pseudomonas</italic> strains. (B) Phylogeny relating the three strains of non pathogenic <italic>P. fluorescens</italic>. (C) Phylogeny relating the three strains of plant pathogenic <italic>P. syringae</italic>. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g006" xlink:type="simple"/></fig><table-wrap id="pcbi-1000868-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.t002</object-id><label>Table 2</label><caption>
<title>Posterior expectation and variance of evolution parameters estimated using the Gibbs sampler under the hybrid model.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000868-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Pathway Map</td>
<td align="left" colspan="1" rowspan="1">Phylogeny</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e270" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">var(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e271" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e272" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">var(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e273" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e274" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">var(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e275" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e276" xlink:type="simple"/></inline-formula></td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Glycolysis/Gluconeogenesis</td>
<td align="left" colspan="1" rowspan="1">((pfs,pfo),pfl)</td>
<td align="left" colspan="1" rowspan="1">0.2276</td>
<td align="left" colspan="1" rowspan="1">0.0054</td>
<td align="left" colspan="1" rowspan="1">2.0552</td>
<td align="left" colspan="1" rowspan="1">1.0280</td>
<td align="left" colspan="1" rowspan="1">1.2228</td>
<td align="left" colspan="1" rowspan="1">0.2653</td>
<td align="left" colspan="1" rowspan="1">1.6807</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">(MAP00010)</td>
<td align="left" colspan="1" rowspan="1">(pst,(psb,psp))</td>
<td align="left" colspan="1" rowspan="1">0.2404</td>
<td align="left" colspan="1" rowspan="1">0.0070</td>
<td align="left" colspan="1" rowspan="1">1.8645</td>
<td align="left" colspan="1" rowspan="1">3.3775</td>
<td align="left" colspan="1" rowspan="1">0.7280</td>
<td align="left" colspan="1" rowspan="1">0.2891</td>
<td align="left" colspan="1" rowspan="1">2.5611</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">17 pseudomonads</td>
<td align="left" colspan="1" rowspan="1">0.1506</td>
<td align="left" colspan="1" rowspan="1">0.0034</td>
<td align="left" colspan="1" rowspan="1">0.7610</td>
<td align="left" colspan="1" rowspan="1">0.0117</td>
<td align="left" colspan="1" rowspan="1">0.7329</td>
<td align="left" colspan="1" rowspan="1">0.0114</td>
<td align="left" colspan="1" rowspan="1">1.0383</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pentose phosphate pathway</td>
<td align="left" colspan="1" rowspan="1">((pfs,pfo),pfl)</td>
<td align="left" colspan="1" rowspan="1">0.2785</td>
<td align="left" colspan="1" rowspan="1">0.0057</td>
<td align="left" colspan="1" rowspan="1">2.1103</td>
<td align="left" colspan="1" rowspan="1">0.5582</td>
<td align="left" colspan="1" rowspan="1">1.7194</td>
<td align="left" colspan="1" rowspan="1">0.3227</td>
<td align="left" colspan="1" rowspan="1">1.2273</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">(MAP00030)</td>
<td align="left" colspan="1" rowspan="1">(pst,(psb,psp))</td>
<td align="left" colspan="1" rowspan="1">0.3251</td>
<td align="left" colspan="1" rowspan="1">0.0071</td>
<td align="left" colspan="1" rowspan="1">1.8490</td>
<td align="left" colspan="1" rowspan="1">1.6921</td>
<td align="left" colspan="1" rowspan="1">1.0172</td>
<td align="left" colspan="1" rowspan="1">0.3212</td>
<td align="left" colspan="1" rowspan="1">1.8178</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">17 pseudomonads</td>
<td align="left" colspan="1" rowspan="1">0.1863</td>
<td align="left" colspan="1" rowspan="1">0.0042</td>
<td align="left" colspan="1" rowspan="1">0.6762</td>
<td align="left" colspan="1" rowspan="1">0.0029</td>
<td align="left" colspan="1" rowspan="1">0.7462</td>
<td align="left" colspan="1" rowspan="1">0.0126</td>
<td align="left" colspan="1" rowspan="1">0.9062</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Lysine degradation</td>
<td align="left" colspan="1" rowspan="1">((pfs,pfo),pfl)</td>
<td align="left" colspan="1" rowspan="1">0.0802</td>
<td align="left" colspan="1" rowspan="1">0.0032</td>
<td align="left" colspan="1" rowspan="1">0.9662</td>
<td align="left" colspan="1" rowspan="1">0.2795</td>
<td align="left" colspan="1" rowspan="1">1.6567</td>
<td align="left" colspan="1" rowspan="1">1.5943</td>
<td align="left" colspan="1" rowspan="1">0.5832</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">(MAP00310)</td>
<td align="left" colspan="1" rowspan="1">(pst,(psb,psp))</td>
<td align="left" colspan="1" rowspan="1">0.0637</td>
<td align="left" colspan="1" rowspan="1">0.0025</td>
<td align="left" colspan="1" rowspan="1">0.6986</td>
<td align="left" colspan="1" rowspan="1">0.1030</td>
<td align="left" colspan="1" rowspan="1">2.7245</td>
<td align="left" colspan="1" rowspan="1">2.8663</td>
<td align="left" colspan="1" rowspan="1">0.2564</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">17 pseudomonads</td>
<td align="left" colspan="1" rowspan="1">0.0473</td>
<td align="left" colspan="1" rowspan="1">0.0030</td>
<td align="left" colspan="1" rowspan="1">0.4706</td>
<td align="left" colspan="1" rowspan="1">0.3492</td>
<td align="left" colspan="1" rowspan="1">0.6443</td>
<td align="left" colspan="1" rowspan="1">0.7188</td>
<td align="left" colspan="1" rowspan="1">0.7304</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Histidine metabolism</td>
<td align="left" colspan="1" rowspan="1">((pfs,pfo),pfl)</td>
<td align="left" colspan="1" rowspan="1">0.1833</td>
<td align="left" colspan="1" rowspan="1">0.0065</td>
<td align="left" colspan="1" rowspan="1">1.6829</td>
<td align="left" colspan="1" rowspan="1">1.2133</td>
<td align="left" colspan="1" rowspan="1">1.0507</td>
<td align="left" colspan="1" rowspan="1">0.3456</td>
<td align="left" colspan="1" rowspan="1">1.6017</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">(MAP00340)</td>
<td align="left" colspan="1" rowspan="1">(pst,(psb,psp))</td>
<td align="left" colspan="1" rowspan="1">0.1749</td>
<td align="left" colspan="1" rowspan="1">0.0064</td>
<td align="left" colspan="1" rowspan="1">1.5321</td>
<td align="left" colspan="1" rowspan="1">0.9479</td>
<td align="left" colspan="1" rowspan="1">1.0735</td>
<td align="left" colspan="1" rowspan="1">0.3082</td>
<td align="left" colspan="1" rowspan="1">1.4272</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">17 pseudomonads</td>
<td align="left" colspan="1" rowspan="1">0.0986</td>
<td align="left" colspan="1" rowspan="1">0.0022</td>
<td align="left" colspan="1" rowspan="1">0.8685</td>
<td align="left" colspan="1" rowspan="1">0.0203</td>
<td align="left" colspan="1" rowspan="1">0.6795</td>
<td align="left" colspan="1" rowspan="1">0.0057</td>
<td align="left" colspan="1" rowspan="1">1.2781</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Phenylalanine metabolism</td>
<td align="left" colspan="1" rowspan="1">((pfs,pfo),pfl)</td>
<td align="left" colspan="1" rowspan="1">0.0783</td>
<td align="left" colspan="1" rowspan="1">0.0029</td>
<td align="left" colspan="1" rowspan="1">1.1686</td>
<td align="left" colspan="1" rowspan="1">0.2072</td>
<td align="left" colspan="1" rowspan="1">1.8255</td>
<td align="left" colspan="1" rowspan="1">0.9345</td>
<td align="left" colspan="1" rowspan="1">0.6402</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">(MAP00360)</td>
<td align="left" colspan="1" rowspan="1">(pst,(psb,psp))</td>
<td align="left" colspan="1" rowspan="1">0.0678</td>
<td align="left" colspan="1" rowspan="1">0.0024</td>
<td align="left" colspan="1" rowspan="1">1.0573</td>
<td align="left" colspan="1" rowspan="1">0.1448</td>
<td align="left" colspan="1" rowspan="1">2.2334</td>
<td align="left" colspan="1" rowspan="1">1.1112</td>
<td align="left" colspan="1" rowspan="1">0.4734</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">17 pseudomonads</td>
<td align="left" colspan="1" rowspan="1">0.0617</td>
<td align="left" colspan="1" rowspan="1">0.0017</td>
<td align="left" colspan="1" rowspan="1">0.6004</td>
<td align="left" colspan="1" rowspan="1">0.0061</td>
<td align="left" colspan="1" rowspan="1">1.0723</td>
<td align="left" colspan="1" rowspan="1">0.0682</td>
<td align="left" colspan="1" rowspan="1">0.5599</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pyruvate metabolism</td>
<td align="left" colspan="1" rowspan="1">((pfs,pfo),pfl)</td>
<td align="left" colspan="1" rowspan="1">0.1413</td>
<td align="left" colspan="1" rowspan="1">0.0018</td>
<td align="left" colspan="1" rowspan="1">1.6497</td>
<td align="left" colspan="1" rowspan="1">0.3362</td>
<td align="left" colspan="1" rowspan="1">1.7913</td>
<td align="left" colspan="1" rowspan="1">0.4424</td>
<td align="left" colspan="1" rowspan="1">0.9210</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">(MAP00620)</td>
<td align="left" colspan="1" rowspan="1">(pst,(psb,psp))</td>
<td align="left" colspan="1" rowspan="1">0.1559</td>
<td align="left" colspan="1" rowspan="1">0.0020</td>
<td align="left" colspan="1" rowspan="1">1.5542</td>
<td align="left" colspan="1" rowspan="1">0.5376</td>
<td align="left" colspan="1" rowspan="1">1.2840</td>
<td align="left" colspan="1" rowspan="1">0.2888</td>
<td align="left" colspan="1" rowspan="1">1.2105</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">17 pseudomonads</td>
<td align="left" colspan="1" rowspan="1">0.1119</td>
<td align="left" colspan="1" rowspan="1">0.0007</td>
<td align="left" colspan="1" rowspan="1">0.7668</td>
<td align="left" colspan="1" rowspan="1">0.0099</td>
<td align="left" colspan="1" rowspan="1">0.6838</td>
<td align="left" colspan="1" rowspan="1">0.0142</td>
<td align="left" colspan="1" rowspan="1">1.1213</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt102"><label/><p>Posterior expectation and variance of parameter values (<inline-formula><inline-graphic mimetype="image" xlink:href="pcbi.1000868.e277.tif" xlink:type="simple"/></inline-formula>: neighbor dependence probability, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e278" xlink:type="simple"/></inline-formula>: insertion rate and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e279" xlink:type="simple"/></inline-formula>: deletion rate) estimated using the Gibbs sampler under the hybrid model for the phylogenies relating the bacteria belonging to genus <italic>Pseudomonas</italic> (<xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6</xref>). Hyperedges common to all seventeen genome-sequenced strains were defined as core and hyperedges missing in all seventeen strains were defined as prohibited hyperedges. The values are averaged over three runs of 60,000 iterations for <italic>P. fluorescens</italic> and <italic>P. syringae</italic> phylogenies, and 110,000 iterations for the phylogeny connecting the seventeen <italic>Pseudomonas</italic> strains with the first 10,000 iterations regarded as burn-in period in each case. Samples were collected every <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e280" xlink:type="simple"/></inline-formula> iteration. The codes MAPxxxxx correspond to the respective KEGG pathway codes <xref ref-type="bibr" rid="pcbi.1000868-Kanehisa1">[22]</xref>. Strain abbreviations: pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p></fn></table-wrap-foot></table-wrap>
<p>When estimating the parameters, the hyperedges corresponding to the reactions that were common to all seventeen <italic>Pseudomonas</italic> strains were defined as core edges and the hyperedges corresponding to the reactions not present in any of these seventeen species were defined as prohibited edges. Three independent replicates of the sampler were run from random starting values for 60,000 iterations for <italic>P. fluorescens</italic> and <italic>P. syringae</italic> phylogenies, and 110,000 iterations for the phylogeny connecting the seventeen <italic>Pseudomonas</italic> strains with the first 10,000 iterations regarded as burn-in period in each case. The samples were collected every <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e281" xlink:type="simple"/></inline-formula> iteration to calculate the posterior expectations and variances of the parameters. These are listed in <xref ref-type="table" rid="pcbi-1000868-t002">Table 2</xref> and the ESS used for parameter estimation are listed in <xref ref-type="supplementary-material" rid="pcbi.1000868.s016">Table S3</xref>. The convergence of the algorithm was tested by checking the trace of the MCMC runs initiated from different starting values. An example is shown in <xref ref-type="supplementary-material" rid="pcbi.1000868.s005">Figure S5</xref>, which shows the trace for the sampler run on <italic>P. fluorescens</italic> phylogeny (<xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6B</xref>). The running times and the acceptance percentages of the algorithm are listed in <xref ref-type="supplementary-material" rid="pcbi.1000868.s017">Table S4</xref> for all three phylogenies. We also calculated the number of insertion and deletion events for each reaction as well as at each branch of the <italic>Pseudomonas</italic> phylogeny for all six pathway maps. These are shown in <xref ref-type="supplementary-material" rid="pcbi.1000868.s006">Figures S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000868.s007">S7</xref>.</p>
<p>The high insertion to deletion ratio (<xref ref-type="table" rid="pcbi-1000868-t002">Table 2</xref>) for all three phylogenies for the glycolysis/gluconeogenesis map, pentose phosphate pathway map and pyruvate metabolism map, which are defined as a part of the carbohydrate metabolism of the bacteria in KEGG <xref ref-type="bibr" rid="pcbi.1000868-Kanehisa1">[22]</xref> and for the histidine metabolism map, which is a part of amino acid metabolism, suggests that very few reactions are missing from these networks in one or more <italic>Pseudomonas</italic> strains used in the analysis, resulting in a highly conserved network. Lysine and phenylalanine pathway maps, on the other hand, have higher deletion rates compared to the insertion rates suggesting a variable reaction distribution across the <italic>Pseudomonas</italic> phylogeny and instability of these functionalities. The results obtained in this study are consistent with the previous observation that the histidine metabolism map shows conservation of reactions across pseudomonads (Mithani, Hein and Preston, submitted) and that many <italic>Pseudomonas</italic> strains are able to use histidine as sole carbon and nitrogen source <xref ref-type="bibr" rid="pcbi.1000868-Rico1">[25]</xref> whereas lysine and phenylalanine pathway maps have few conserved reactions across pseudomonads (Mithani, Hein and Preston, submitted) and are poor nutrient sources for these bacteria <xref ref-type="bibr" rid="pcbi.1000868-Rico1">[25]</xref>. The results also indicate that the pathway maps which are highly conserved across the seventeen <italic>Pseudomonas</italic> strains, i.e. glycolysis/gluconeogenesis map, pentose phosphate pathway map, pyruvate metabolism map and histidine metabolism map, also have higher neighbor dependence probabilities compared to the other two pathway maps, which have variable reaction distribution across the <italic>Pseudomonas</italic> phylogeny. This might suggest a relationship between the neighborhood structure and the conservation of networks.</p>
<p>The comparison of the evolution parameters between <italic>P. fluorescens</italic> and <italic>P. syringae</italic> provides interesting insights into the evolution of the metabolic networks of these bacteria. For example, the insertion and deletion rates are generally higher in <italic>P. fluorescens</italic> than those in <italic>P. syringae</italic> suggesting a higher number of insertion and deletion events in <italic>P. fluorescens</italic> networks compared to <italic>P. syringae</italic> networks. This was expected since the evolutionary distance between the <italic>P. fluorescens</italic> strains is greater as compared to <italic>P. syringae</italic> strains (<xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6</xref>) allowing more time for the networks in <italic>P. fluorescens</italic> to evolve. A higher deletion rate for lysine and phenylalanine pathway maps in <italic>P. syringae</italic> compared to <italic>P. fluorescens</italic>, however, suggests that <italic>P. syringae</italic> have had a higher number of deletion events than <italic>P. fluorescens</italic> during the course of evolution. This supports the finding that <italic>P. syringae</italic> have gone through a high number of deletion events than expected based on the comparison between observed and expected distribution of reactions across the <italic>Pseudomonas</italic> phylogeny, and the identification of reactions that are uniquely present or absent from a single lineage (Mithani, Hein and Preston, submitted). In addition, a very low insertion to deletion ratio (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000868.e282" xlink:type="simple"/></inline-formula>) for lysine metabolism in <italic>P. syringae</italic> suggests a high number of deletion events in the lineage and consequently the loss of the ability of these bacteria to assimilate lysine. This is in agreement with nutrient utilization assays, which have reported that bacteria belonging to the species <italic>P. syringae</italic> do not assimilate lysine as a nutrient source <xref ref-type="bibr" rid="pcbi.1000868-Rico1">[25]</xref>. Phenylalanine metabolism also has a higher deletion rate as compared to insertion rate in both <italic>P. fluorescens</italic> and <italic>P. syringae</italic> lineages. This in conjunction with experimental data reporting the weak ability of these bacteria to utilize phenylalanine as a nutrient source might lead to a hypothesis that both <italic>P. fluorescens</italic> and <italic>P. syringae</italic> are drifting towards losing their ability to assimilate phenylalanine. Overall, the results show that genome reduction is taking place in plant pathogenic bacteria belonging to the species <italic>P. syringae</italic> at a higher rate than their non-pathogenic counterparts in the species <italic>P. fluorescens</italic>.</p>
</sec><sec id="s3d">
<title>Ancestral network reconstruction</title>
<p>The final aim of this study was to infer reactions present in the common ancestor of <italic>Pseudomonas</italic> spp. and of individual species of <italic>Pseudomonas</italic>. One way to address this is to predict that the common ancestor contained all the reactions that are common to existing <italic>Pseudomonas</italic>. The variable reactions can then be assigned using a parsimonious approach which generates a conservative model of network evolution in which a minimum number of events occur. However, the results above suggest that some lineages, particularly <italic>P. syringae</italic>, have undergone deletion events relative to the common ancestor and that some reactions absent in one or more modern pseudomonads might be present in the ancestral strain. To take this into account, stochastic approaches such as the Gibbs sampler described in Section ‘Estimation of parameters’ can be used to sample ancestral networks from the posterior distribution of networks and the likelihood of reactions being present at various levels of the phylogeny can be calculated.</p>
<p>To demonstrate this, the Gibbs sampler was run on the pathway maps listed in <xref ref-type="table" rid="pcbi-1000868-t002">Table 2</xref>. The Gibbs sampler was run with the same settings that were used for parameter estimation and samples for the networks at internal nodes of the <italic>Pseudomonas</italic> phylogeny (<xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref>) were collected. The degree distributions of nodes at the ancestral levels of the phylogeny are given in <xref ref-type="supplementary-material" rid="pcbi.1000868.s008">Figures S8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000868.s009">S9</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000868.s010">S10</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000868.s011">S11</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000868.s012">S12</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000868.s013">S13</xref>. The likelihood of reactions being present at each level was obtained by calculating the proportion of times each hyperedge was present in the sampled networks. The results are shown in <xref ref-type="fig" rid="pcbi-1000868-g007">Figures 7A</xref>–<xref ref-type="fig" rid="pcbi-1000868-g008"/><xref ref-type="fig" rid="pcbi-1000868-g009"/><xref ref-type="fig" rid="pcbi-1000868-g010"/><xref ref-type="fig" rid="pcbi-1000868-g011"/><xref ref-type="fig" rid="pcbi-1000868-g012">12A</xref>. Only alterable reactions, that is the reactions which were neither defined as core nor were defined as prohibited in the networks, are shown.</p>
<fig id="pcbi-1000868-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g007</object-id><label>Figure 7</label><caption>
<title>Ancestral network reconstruction for the glycolysis/gluconeogenesis map.</title>
<p>The ancestral networks were reconstructed over the <italic>Pseudomonas</italic> phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref>. Also shown in the bottom panel is the distribution of reactions across different <italic>Pseudomonas</italic> strains. (A) Likelihood of being present for alterable reactions at various levels of <italic>Pseudomonas</italic> phylogeny obtained by calculating the proportion of times each hyperedge was present in the networks sampled by the Gibbs sampler. (B) Reaction status obtained under maximum parsimony calculated using the Fitch algorithm <xref ref-type="bibr" rid="pcbi.1000868-Fitch1">[26]</xref>. When assigning the reactions at the ancestral nodes the ties were resolved in favor of presence of reactions. Reactions for which parsimony failed to resolve ancestral predictions at the root are marked with an asterisk (*). Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g007" xlink:type="simple"/></fig><fig id="pcbi-1000868-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g008</object-id><label>Figure 8</label><caption>
<title>Ancestral network reconstruction for the pentose phosphate pathway map.</title>
<p>The ancestral networks were reconstructed over the <italic>Pseudomonas</italic> phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref>. Also shown in the bottom panel is the distribution of reactions across different <italic>Pseudomonas</italic> strains. (A) Likelihood of being present for alterable reactions at various levels of <italic>Pseudomonas</italic> phylogeny obtained by calculating the proportion of times each hyperedge was present in the networks sampled by the Gibbs sampler. (B) Reaction status obtained under maximum parsimony calculated using the Fitch algorithm <xref ref-type="bibr" rid="pcbi.1000868-Fitch1">[26]</xref>. When assigning the reactions at the ancestral nodes the ties were resolved in favor of presence of reactions. Reactions for which parsimony failed to resolve ancestral predictions at the root are marked with an asterisk (*). Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g008" xlink:type="simple"/></fig><fig id="pcbi-1000868-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g009</object-id><label>Figure 9</label><caption>
<title>Ancestral network reconstruction for the lysine degradation map.</title>
<p>The ancestral networks were reconstructed over the <italic>Pseudomonas</italic> phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref>. Also shown in the bottom panel is the distribution of reactions across different <italic>Pseudomonas</italic> strains. (A) Likelihood of being present for alterable reactions at various levels of <italic>Pseudomonas</italic> phylogeny obtained by calculating the proportion of times each hyperedge was present in the networks sampled by the Gibbs sampler. (B) Reaction status obtained under maximum parsimony calculated using the Fitch algorithm <xref ref-type="bibr" rid="pcbi.1000868-Fitch1">[26]</xref>. When assigning the reactions at the ancestral nodes the ties were resolved in favor of presence of reactions. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g009" xlink:type="simple"/></fig><fig id="pcbi-1000868-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g010</object-id><label>Figure 10</label><caption>
<title>Ancestral network reconstruction for the histidine metabolism map.</title>
<p>The ancestral networks were reconstructed over the <italic>Pseudomonas</italic> phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref>. Also shown in the bottom panel is the distribution of reactions across different <italic>Pseudomonas</italic> strains. (A) Likelihood of being present for alterable reactions at various levels of <italic>Pseudomonas</italic> phylogeny obtained by calculating the proportion of times each hyperedge was present in the networks sampled by the Gibbs sampler. (B) Reaction status obtained under maximum parsimony calculated using the Fitch algorithm <xref ref-type="bibr" rid="pcbi.1000868-Fitch1">[26]</xref>. When assigning the reactions at the ancestral nodes the ties were resolved in favor of presence of reactions. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g010" xlink:type="simple"/></fig><fig id="pcbi-1000868-g011" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g011</object-id><label>Figure 11</label><caption>
<title>Ancestral network reconstruction for the phenylalanine metabolism map.</title>
<p>The ancestral networks were reconstructed over the <italic>Pseudomonas</italic> phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref>. Also shown in the bottom panel is the distribution of reactions across different <italic>Pseudomonas</italic> strains. (A) Likelihood of being present for alterable reactions at various levels of <italic>Pseudomonas</italic> phylogeny obtained by calculating the proportion of times each hyperedge was present in the networks sampled by the Gibbs sampler. (B) Reaction status obtained under maximum parsimony calculated using the Fitch algorithm <xref ref-type="bibr" rid="pcbi.1000868-Fitch1">[26]</xref>. When assigning the reactions at the ancestral nodes the ties were resolved in favor of presence of reactions. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g011" xlink:type="simple"/></fig><fig id="pcbi-1000868-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000868.g012</object-id><label>Figure 12</label><caption>
<title>Ancestral network reconstruction for the pyruvate metabolism map.</title>
<p>The ancestral networks were reconstructed over the <italic>Pseudomonas</italic> phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref>. Also shown in the bottom panel is the distribution of reactions across different <italic>Pseudomonas</italic> strains. (A) Likelihood of being present for alterable reactions at various levels of <italic>Pseudomonas</italic> phylogeny obtained by calculating the proportion of times each hyperedge was present in the networks sampled by the Gibbs sampler. (B) Reaction status obtained under maximum parsimony calculated using the Fitch algorithm <xref ref-type="bibr" rid="pcbi.1000868-Fitch1">[26]</xref>. When assigning the reactions at the ancestral nodes the ties were resolved in favor of presence of reactions. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.g012" xlink:type="simple"/></fig>
<p>The ancestral network reconstruction using the Gibbs sampler reported high likelihood values for reactions which are present in all the networks down a lineage and low likelihood values for reactions which show variable distributions across the <italic>Pseudomonas</italic> phylogeny. For example, in the pentose phosphate pathway map (<xref ref-type="fig" rid="pcbi-1000868-g008">Figure 8A</xref>), the reaction R01066, which is present only in the three <italic>P. syringae</italic> strains, was assigned a very high likelihood of being present in the common ancestor of <italic>P. syringae</italic> pv. phaseolicola 1448A and <italic>P. syringae</italic> pv. syringae B728a as well as in the common ancestor for all the tree <italic>P. syringae</italic> strains but a very low likelihood of being present for all other internal networks. In contrast, R06836, which is present in sixteen out of the seventeen <italic>Pseudomonas</italic> strains (absent in <italic>P. fluorescens</italic> Pf-5), is reported to have high likelihood values of being present in all internal networks of the phylogeny.</p>
<p>Ancestral predictions were also generated under the parsimony model for these networks using the Fitch Algorithm <xref ref-type="bibr" rid="pcbi.1000868-Fitch1">[26]</xref>. When assigning the reactions at the ancestral nodes the ties were resolved in favor of presence of reactions. The results are shown in <xref ref-type="fig" rid="pcbi-1000868-g007">Figures 7B</xref>–<xref ref-type="fig" rid="pcbi-1000868-g008"/><xref ref-type="fig" rid="pcbi-1000868-g009"/><xref ref-type="fig" rid="pcbi-1000868-g010"/><xref ref-type="fig" rid="pcbi-1000868-g011"/><xref ref-type="fig" rid="pcbi-1000868-g012">12B</xref>. Reactions for which parsimony failed to resolve ancestral predictions at the root are marked with asterisks (*). Predictions generated for the <italic>Pseudomonas</italic> common ancestor using parsimony analysis are nearly identical to predictions generated for the <italic>P. aeruginosa</italic> common ancestor, which would be expected as parsimony assumes minimum evolution. In addition, parsimony generated a conservative model of network evolution in which a minimum number of events occur, but the stochastic approach takes network information into account when predicting ancestral networks. For example, in the case of the lysine degradation map (<xref ref-type="fig" rid="pcbi-1000868-g009">Figure 9</xref>), six out of the ten variable reactions are reported to be absent from all the ancestral networks of the <italic>Pseudomonas</italic> phylogeny using the parsimony approach whereas the stochastic approach taking the reaction neighborhood data into account assigns non-zero likelihood values to these reactions for being present in the ancestral pseudomonads. Similarly, all four reactions which are predicted to be absent from all ancestral pseudomonads in the histidine metabolism map under the parsimony model have non-zero likelihoods of being present in the ancestral networks using the stochastic approach (<xref ref-type="fig" rid="pcbi-1000868-g010">Figure 10</xref>). The results for ancestral network reconstruction for phenylalanine metabolism (<xref ref-type="fig" rid="pcbi-1000868-g011">Figure 11</xref>), on the other hand, suggested a very low level of conservation of reactions across the <italic>Pseudomonas</italic> phylogeny using both approaches and most of the variable reactions were predicted to be absent from the common ancestor. The variable distribution of these reactions across the seventeen <italic>Pseudomonas</italic> strains along with the results of ancestral network reconstruction suggests that these reactions might have been gained independently at organism level.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>In this study, we have used a Bayesian approach to study the evolution of metabolic networks. We extended the neighbor-dependent model described by Mithani <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref> by introducing a parameter that estimates the probability of being present in the neighbor-dependent model. This not only provides a better fit for the data but also has an advantage over the existing model since it allows one to estimate the strength of neighborhood structure affecting the evolution of given networks. It must, however, be kept in mind that inferring the neighborhood effect solely on the basis of the neighbor-dependence probability might bias the results due to the fact that a high proportion of reactions involved in central metabolism of an organism will always be present due to their functional importance. Using ortholog and synteny data in conjunction with neighbor-dependence probability would lead to better inference of the role of network structure on metabolic evolution. The idea being that if a reaction is present in most of the species that are evolutionarily close to the one being considered then it has a higher chance of being added, and if it is genetically linked to other reactions then they have a greater chance of being consecutively added or deleted.</p>
<p>The neighbor-dependent model <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref> and the hybrid model described here define reaction neighborhood as reactions sharing at least one metabolite. Alternate definitions of reaction neighborhood are also possible. For example, one possible alternate is to consider the reaction directions when calculating the neighborhood and to regard two reactions as neighbors only if the metabolite connecting the two reactions is a substrate of one and the product of the other. Similarly, it is also possible to use other measures such as sequence similarity <xref ref-type="bibr" rid="pcbi.1000868-Forst1">[27]</xref>–<xref ref-type="bibr" rid="pcbi.1000868-Kelley2">[29]</xref> or network distance measures <xref ref-type="bibr" rid="pcbi.1000868-Heymans1">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1000868-Forst2">[31]</xref> in conjunction with the network structure to model the evolution of metabolic networks. There are, however, limitations associated with the models of metabolic evolution solely based on network structure and sequence similarity. There are a number of other factors affecting metabolic evolution. These include substrate availability (for example, availability of a new nutrient in the environment may favor the insertion of reactions which bring this new metabolite into the mainstream metabolism), gene expression (for example, a decrease in the gene expression relating to an enzyme catalyzing a reaction may force the metabolic network to find alternate routes) and reaction mechanism (for example, a reaction which is chemically inefficient may be favored for deletion compared to an efficient reaction). Factors such as these must be taken into account when modeling the evolution of metabolic networks to depict a more realistic picture of evolution.</p>
<p>We also presented a Gibbs sampler to sample the networks at internal nodes of a phylogenetic tree where the internal networks were sampled by conditioning on three neighbors (one parent and two children) in an approach similar to the one used by Holmes and Bruno <xref ref-type="bibr" rid="pcbi.1000868-Holmes1">[18]</xref> for DNA sequence alignment. The sampler considered the network structure surrounding the hyperedge being sampled in addition to the state of the hyperedge in the three neighboring networks when calculating the new state thus resulting in an informed sampling procedure. When sampling ancestral networks, it was assumed that all sampled networks were valid networks. However, not all networks may be functionally viable. For example, a network might not be able to produce a key metabolite which is required or may result in disconnected components that compromise network functionality. Checking for validity of networks occurring at ancestral nodes is an important area for further research.</p>
<p>A Gibbs sampler to estimate the evolution parameters was also presented. Standard distributions were used to generate proposals for parameters. The standard distributions provide satisfactory mixing of the MCMC sampler with appropriate scaling <xref ref-type="bibr" rid="pcbi.1000868-Koskinen1">[32]</xref>. The rate parameters were sampled from a gamma distribution where scale and shape parameters were calculated from the current network and the proposals for neighbor dependence probability were generated using a beta distribution with its scale parameters calculated from the networks present at the leaves of the given phylogenetic tree. A uniform prior was used when estimating the parameters, which assigns equal probability to each point in the parameter space. It might be useful to explore the dependence between the number of insertions and deletions on the given phylogeny and to investigate the use of other prior distributions. Besides this, when calculating the likelihood of evolution, it was assumed that the phylogenetic tree was known through sequence analysis. This simplified the problem by not requiring a sum over all possible branch lengths. However, when calculating the tree using sequence data, the branch lengths depend on the set of genes used for generating the tree and their evolutionary distances. Thus, different set of genes used could result in different branch lengths. To be able to make useful inferences using an evolutionary model such as the one described here, this uncertainty in the tree must be taken into account by summing over all possible branch lengths. In addition, the effects of using a phylogenetic tree constructed <italic>de novo</italic> from metabolic networks <xref ref-type="bibr" rid="pcbi.1000868-Heymans1">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1000868-Forst2">[31]</xref> on the model need to be further explored.</p>
<p>The evolution parameters were estimated on a phylogeny connecting the metabolic networks of bacteria belonging to the genus <italic>Pseudomonas</italic> using the Gibbs sampler. The likelihood values for reactions to be present at various levels of the <italic>Pseudomonas</italic> phylogeny were also calculated using the networks visited by the Gibbs sampler and the results were compared to those obtained using parsimony. The stochastic assignment of reactions in ancestral networks offers an edge over deterministic approaches like parsimony which provides the minimum number of transformations required to explain the evolution of a reaction of the tree and can, therefore, underestimate the total number of changes. In addition, using the MCMC approach based on neighbor dependence takes network structure into account, and may be particularly useful in resolving ancestral predictions at the root of phylogenies, or in situations where parsimony is unable to assign states unambiguously (see <xref ref-type="fig" rid="pcbi-1000868-g007">Figures 7</xref> and <xref ref-type="fig" rid="pcbi-1000868-g008">8</xref>).</p>
<p>An important factor affecting the results when estimating the evolution parameters and reconstructing the ancestral networks relates to the use of individual pathway maps. Although computationally tractable, individual pathway maps do not take a complete network perspective and may, therefore, lead to incorrect results by ignoring a part of the reaction neighborhood, the so-called border effect. This is particularly true for reactions which occur at the boundary of a metabolic pathway map, which may have a large number of their neighbors not included in that pathway map. The calculation of reaction neighborhood solely using the pathway map under consideration ignores all neighboring reactions that are not present in the pathway map thus affecting the likelihood values. For example, consider R01424 in phenylalanine metabolism. This reaction is present in thirteen out of seventeen pseudomonads including all three <italic>P. syringae</italic> strains, all four <italic>P. putida</italic> strains and two out of the three <italic>P. fluorescens</italic> strains. It was, therefore, expected that the reaction would have a high likelihood of being present in the common ancestor of <italic>P. fluorescens</italic>, <italic>P. syringae</italic> and <italic>P. putida</italic> but, on contrary, was reported to have a relatively low likelihood at this level (<xref ref-type="fig" rid="pcbi-1000868-g011">Figure 11</xref>). Closer inspection of the reaction revealed that it links the phenylalanine metabolism to the pathway map relating to benzoate degradation via coenzyme A and has neighbors spanning across multiple pathway maps. Phenylalanine pathway map contains only 2 neighboring reactions of the reaction R01424 whereas using the data from all pathway maps relating to metabolism results in 53 neighbors. Thus, evaluating the likelihood of R01424 at ancestral levels of the <italic>Pseudomonas</italic> phylogeny solely on the basis of reactions involved in phenylalanine metabolism leads to a very poor neighborhood surrounding the reaction and, consequently, weights down the presence of the reaction in the common ancestor resulting in a low likelihood value. A possible solution to overcome this border effect is to use the full network structure when calculating reaction neighborhoods. However, the computational feasibility of using full network structure when calculating reaction neighborhoods requires further investigation.</p>
<p>When performing the analyses the hyperedges present in all seventeen <italic>Pseudomonas</italic> strains were defined as core and the hyperedges missing from all the strains were defined as prohibited hyperedges. However, the results presented in this analysis suggest that pathogenic bacteria belonging to species <italic>P. syringae</italic> have gone through a high number of deletion events compared to other species. Assigning core edges solely on the basis of intersection model may, therefore, bias the results towards the loss of reactions which might be essential in non-pathogenic bacteria. Similarly, prohibiting reactions that are not present in any one of the seventeen genome-sequenced strains would prevent the common ancestor from having reactions which might have been lost very early during the course of evolution. To model scenarios like these the provision of having a lineage specific core and prohibited hyperedges must be explored. Alternatively, it might be useful to assign core and prohibited hyperedges using the ortholog data from closely related bacteria, or by incorporating metabolic information from organisms sharing the same environment in the set of permitted reactions. Comparing ancestral network predictions generated using different set of core and prohibited hyperedges might provide clues about the functionality of the common ancestors of the bacteria and the environment the ancestors might have colonized.</p>
<p>Finally, the analysis presented here uses data from the KEGG database. The metabolic annotations available for the majority of genome-sequenced organisms are generated using automated annotation tools based on the similarity of predicted genes to genes of known function and therefore contain a substantial amount of noise. For example, some genes predicted to have a broad enzymatic function are linked to multiple reactions, while others fail to meet the detection threshold for annotation and are therefore recorded as absent. Nevertheless, networks deposited in databases like KEGG are commonly treated as if they are as certain as sequence data, which is a serious error that undermines many present investigations. It would be desirable to take this noise into account while modeling the evolution of metabolic networks. One way would be to use hidden states to model experimentally validate metabolisms which are observed though predicted metabolisms. This will not only enable one to model the noise in the data but also allow correct prediction of a metabolism for an organism using homologous information similar to comparative genome annotation <xref ref-type="bibr" rid="pcbi.1000868-Behr1">[33]</xref>.</p>
<p>In summary, evolutionary modeling of metabolic network is an important area. Using statistical models of network evolution such as the one described here not only allow one to investigate how the metabolic networks evolve in closely related organisms but also enable testing of biological hypotheses such as specialization of genomes and identification of regions of metabolic networks that are under high selection.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000868.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s001" xlink:type="simple"><label>Figure S1</label><caption>
<p>Simulation results for insertion frequencies for the toy network H<sub>1</sub> shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1</xref> using hybrid model for different values of δ. Also shown in the top panel are the number of neighbors for each hyperedge based on the reference network.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s002" xlink:type="simple"><label>Figure S2</label><caption>
<p>Sub-networks of the toy network H<sub>1</sub> shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1</xref> for different sub-network sizes (N) obtained by iteratively dividing the network on the basis of neighborhood. The hyperedges which were originally absent from H<sub>1</sub> but present in the sub-network are shown in gray.</p>
<p>(0.05 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s003" xlink:type="simple"><label>Figure S3</label><caption>
<p>Likelihood surfaces calculated by matrix exponentiation using all 1024 networks (True Likelihood) and using the networks visited by the Gibbs sampler (Estimated Likelihood) for different insertion and deletion rates for the toy networks phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1</xref>. The true and estimated maximum likelihood values are marked with asterisks. The maximum likelihood value was estimated using the Gibbs sampler for parameter estimation.</p>
<p>(0.11 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s004" xlink:type="simple"><label>Figure S4</label><caption>
<p>An example MCMC trace showing the rate parameters for the first 1,000 iterations of the Gibbs sampler for the toy networks phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1</xref>.</p>
<p>(0.04 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s005" xlink:type="simple"><label>Figure S5</label><caption>
<p>Example MCMC traces showing the rate parameters for the first 1,000 iterations of the Gibbs sampler initiated from different starting values. The sampler was run on the <italic>Pseudomonas fluorescens</italic> phylogeny shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6B</xref> for different metabolic networks.</p>
<p>(0.22 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s006" xlink:type="simple"><label>Figure S6</label><caption>
<p>Number of insertion and deletion events for the alterable reactions, that is the reactions which were neither defined as core nor were defined as prohibited in the network obtained using the Gibbs sampler run under the hybrid model. The sampler was run for the six pathway maps used in this analysis over the phylogeny connecting the seventeen <italic>Pseudomonas</italic> strains shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref> for 110,000 iterations with the first 10,000 iterations regarded as burn-in period. Samples were collected every 10<sup>th</sup> iteration.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s007" xlink:type="simple"><label>Figure S7</label><caption>
<p>Number of insertion and deletion events at each branch of the phylogeny connecting the seventeen <italic>Pseudomonas</italic> strains shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref> obtained using the Gibbs sampler run under the hybrid model. The sampler was run for 110,000 iterations with the first 10,000 iterations regarded as burn-in period. Samples were collected every 10<sup>th</sup> iteration. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s008" xlink:type="simple"><label>Figure S8</label><caption>
<p>Degree distributions of nodes at the ancestral levels of the <italic>Pseudomonas</italic> phylogney shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref> for the glycolysis/gluconeogenesis map obtained using the Gibbs sampler. The actual degree distributions observed for the seventeen genome-sequenced <italic>Pseudomonas</italic> strains are shown in red. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
<p>(0.04 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s009" xlink:type="simple"><label>Figure S9</label><caption>
<p>Degree distributions of nodes at the ancestral levels of the <italic>Pseudomonas</italic> phylogney shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref> for the pentose phosphate pathway map obtained using the Gibbs sampler. The actual degree distributions observed for the seventeen genome-sequenced <italic>Pseudomonas</italic> strains are shown in red. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
<p>(0.07 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s010" xlink:type="simple"><label>Figure S10</label><caption>
<p>Degree distributions of nodes at the ancestral levels of the <italic>Pseudomonas</italic> phylogney shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref> for the lysine degradation map obtained using the Gibbs sampler. The actual degree distributions observed for the seventeen genome-sequenced <italic>Pseudomonas</italic> strains are shown in red. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
<p>(0.08 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s011" xlink:type="simple"><label>Figure S11</label><caption>
<p>Degree distributions of nodes at the ancestral levels of the <italic>Pseudomonas</italic> phylogney shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref> for the histidine metabolism map obtained using the Gibbs sampler. The actual degree distributions observed for the seventeen genome-sequenced <italic>Pseudomonas</italic> strains are shown in red. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
<p>(0.04 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s012" xlink:type="simple"><label>Figure S12</label><caption>
<p>Degree distributions of nodes at the ancestral levels of the <italic>Pseudomonas</italic> phylogney shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref> for the phenylalanine metabolism map obtained using the Gibbssampler. The actual degree distributions observed for the seventeen genome-sequenced <italic>Pseudomonas</italic> strains are shown in red. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
<p>(0.03 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s013" xlink:type="simple"><label>Figure S13</label><caption>
<p>Degree distributions of nodes at the ancestral levels of the <italic>Pseudomonas</italic> phylogney shown in <xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6A</xref> for the pyruvate metabolism map obtained using the Gibbs sampler. The actual degree distributions observed for the seventeen genome-sequenced <italic>Pseudomonas</italic> strains are shown in red. Strain abbreviations: pae: <italic>P. aeruginosa</italic> PAO1, pap: <italic>P. aeruginosa</italic> PA7, pau: <italic>P. aeruginosa</italic> PA14, pag: <italic>P. aeruginosa</italic> LESB58, pen: <italic>P. entomophila</italic> L48, pfl: <italic>P. fluorescens</italic> Pf-5, pfo: <italic>P. fluorescens</italic> Pf0-1, pfs: <italic>P. fluorescens</italic> SBW25, pmy: <italic>P. mendocina</italic> ymp, ppf: <italic>P. putida</italic> F1, ppg: <italic>P. putida</italic> GB-1 ppu: <italic>P. putida</italic> KT2440, ppw: <italic>P. putida</italic> W619, psa: <italic>P. stutzeri</italic> A1501, psb: <italic>P. syringae</italic> pv. syringae B728a, psp: <italic>P. syringae</italic> pv. phaseolicola 1448A, and pst: <italic>P. syringae</italic> pv. tomato DC3000.</p>
<p>(0.08 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s014" xlink:type="simple"><label>Table S1</label><caption>
<p>Pseudo-likelihood P<sup>*</sup>(H<sub>2</sub>|H<sub>1</sub>) conditioned on H for the toy networks shown in <xref ref-type="fig" rid="pcbi-1000868-g001">Figure 1</xref> using different sub-network sizes. Also shown are the exact values calculated by full network exponentiation and by using the MCMC approach based on path sampling described in Mithani <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000868-Mithani1">[9]</xref> with 11,000 iterations including the first 1,000 iteration as burn-in period.</p>
<p>(0.03 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s015" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s015" xlink:type="simple"><label>Table S2</label><caption>
<p>Basic information of the metabolic networks for the seventeen genome-sequenced strains of <italic>Pseudomonas</italic> used in this study. A reversible reaction was represented by two hyperedges (one in either direction) in this study. The codes MAPxxxxx correspond to the respective KEGG pathway codes <xref ref-type="bibr" rid="pcbi.1000868-Kanehisa1">[22]</xref>.</p>
<p>(0.04 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s016" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s016" xlink:type="simple"><label>Table S3</label><caption>
<p>Effective sample sizes (ESS) for the estimated parameters (δ: neighbor dependence probability, λ: insertion rate and μ: deletion rate) using the Gibbs sampler run under the hybrid model for the evolution of metabolic networks over the phylogeny connecting different <italic>Pseudomonas</italic> strains (<xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6</xref>). Hyperedges that were common to all seventeen strains were regarded as core edges and hyperedges missing in all seventeen strains were regarded as prohibited edges. The values are averaged across three runs of 60,000 iterations for <italic>P. fluorescens</italic> and <italic>P. syringae</italic> phylogenies, and 110,000 iterations for the phylogeny connecting the seventeen <italic>Pseudomonas</italic> strains with the first 10,000 iterations regarded as burn-in period in each case. Samples were collected every 10<sup>th</sup> iteration. Strain abbreviations: pfl: <italic>Pseudomonas fluorescens</italic> Pf-5, pfo: <italic>Pseudomonas fluorescens</italic> Pf0-1, pfs: <italic>Pseudomonas fluorescens</italic> SBW25, psb: <italic>Pseudomonas syringae</italic> pv. syringae B728a, psp: <italic>Pseudomonas syringae</italic> pv. phaseolicola 1448A, and pst: <italic>Pseudomonas syringae</italic> pv. tomato DC3000.</p>
<p>(0.03 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s017" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s017" xlink:type="simple"><label>Table S4</label><caption>
<p>Running time and the acceptance percentage of the Gibbs sampler for the estimation of evolution parameters (δ: neighbor dependence probability, λ: insertion rate and μ: deletion rate) run under the hybrid model for different metabolic networks over the phylogeny connecting different <italic>Pseudomonas</italic> strains (<xref ref-type="fig" rid="pcbi-1000868-g006">Figure 6</xref>). Hyperedges that were common to all seventeen strains were regarded as core edges and hyperedges missing in all seventeen strains were regarded as prohibited edges. The values are averaged across three runs of 60,000 iterations for <italic>P. fluorescens</italic> and <italic>P. syringae</italic> phylogenies, and 110,000 iterations for the phylogeny connecting the seventeen <italic>Pseudomonas</italic> strains with the first 10,000 iterations regarded as burn-in period in each case. Samples were collected every 10<sup>th</sup> iteration. Strain abbreviations: pfl: <italic>Pseudomonas fluorescens</italic> Pf-5, pfo: <italic>Pseudomonas fluorescens</italic> Pf0-1, pfs: <italic>Pseudomonas fluorescens</italic> SBW25, psb: <italic>Pseudomonas syringae</italic> pv. syringae B728a, psp: <italic>Pseudomonas syringae</italic> pv. phaseolicola 1448A, and pst: <italic>Pseudomonas syringae</italic> pv. tomato DC3000.</p>
<p>(0.03 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000868.s018" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000868.s018" xlink:type="simple"><label>Text S1</label><caption>
<p>Testing of the Gibbs sampler for parameter estimation.</p>
<p>(0.04 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We would like to thank Dr. Thomas Mailund for providing valuable comments on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000868-Dorogovtsev1"><label>1</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dorogovtsev</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Mendes</surname><given-names>J</given-names></name>
</person-group>             <year>2003</year>             <source>Evolution of networks: From biological nets to the Internet and WWW</source>             <publisher-name>Oxford University Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000868-Berg1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berg</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Lässig</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Wagner</surname><given-names>A</given-names></name>
</person-group>             <year>2004</year>             <article-title>Structure and evolution of protein interaction networks: a statistical model for link dynamics and gene duplications.</article-title>             <source>BMC Evol Biol</source>             <volume>4</volume>             <fpage>51</fpage>          </element-citation></ref>
<ref id="pcbi.1000868-Ueda1"><label>3</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ueda</surname><given-names>HR</given-names></name>
<name name-style="western"><surname>Hogenesch</surname><given-names>JB</given-names></name>
</person-group>             <year>2005</year>             <article-title>Principles in the Evolution of Metabolic Networks.</article-title>             <comment>eprint arXiv:q-bio/0503038</comment>          </element-citation></ref>
<ref id="pcbi.1000868-Boccaletti1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Boccaletti</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Latora</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Moreno</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Chavez</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hwang</surname><given-names>D</given-names></name>
</person-group>             <year>2006</year>             <article-title>Complex networks: Structure and dynamics.</article-title>             <source>Phys Rep</source>             <volume>424</volume>             <fpage>175</fpage>             <lpage>308</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Wiuf1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wiuf</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Brameier</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hagberg</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Stumpf</surname><given-names>M</given-names></name>
</person-group>             <year>2006</year>             <article-title>A likelihood approach to analysis of network data.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>103</volume>             <fpage>7566</fpage>             <lpage>7570</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Ratmann1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ratmann</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Jørgensen</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Hinkley</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Stumpf</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Richardson</surname><given-names>S</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Using likelihood-free inference to compare evolutionary dynamics of the protein networks of <italic>H. pylori</italic> and <italic>P. falciparum</italic>.</article-title>             <source>PLoS Comp Biol</source>             <volume>3</volume>             <fpage>e230</fpage>          </element-citation></ref>
<ref id="pcbi.1000868-Pl1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pál</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Papp</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Lercher</surname><given-names>M</given-names></name>
</person-group>             <year>2005</year>             <article-title>Adaptive evolution of bacterial metabolic networks by horizontal gene transfer.</article-title>             <source>Nat Genet</source>             <volume>37</volume>             <fpage>1372</fpage>             <lpage>1375</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Stumpf1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stumpf</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Ingram</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Nouvel</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Wiuf</surname><given-names>C</given-names></name>
</person-group>             <year>2005</year>             <article-title>Statistical model selection methods applied to biological networks.</article-title>             <source>Lecture Notes Comput Sc</source>             <volume>3737</volume>             <fpage>65</fpage>             <lpage>77</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Mithani1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mithani</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Preston</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <year>2009</year>             <article-title>A stochastic model for the evolution of metabolic networks with neighbor dependence.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>1528</fpage>             <lpage>1535</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Zeigarnik1"><label>10</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zeigarnik</surname><given-names>A</given-names></name>
</person-group>             <year>2000</year>             <article-title>On hypercycles and hypercircuits in hypergraphs.</article-title>             <comment>In: Discrete Mathematical Chemistry: DIMACS Workshop, Discrete Mathematical Chemistry, March 23–24, 1998, Rutgers University. Amer Mathematical Society</comment> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">377</size>           </element-citation></ref>
<ref id="pcbi.1000868-Yeung1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yeung</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Palsson</surname><given-names>B</given-names></name>
</person-group>             <year>2007</year>             <article-title>Estimation of the number of extreme pathways for metabolic networks.</article-title>             <source>BMC Bioinformat</source>             <volume>8</volume>             <fpage>363</fpage>          </element-citation></ref>
<ref id="pcbi.1000868-Dandekar1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dandekar</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Schuster</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Snel</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Huynen</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Bork</surname><given-names>P</given-names></name>
</person-group>             <year>1999</year>             <article-title>Pathway alignment: application to the comparative analysis of glycolytic enzymes.</article-title>             <source>Biochem J</source>             <volume>343</volume>             <fpage>115</fpage>          </element-citation></ref>
<ref id="pcbi.1000868-PeregrinAlvarez1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Peregrin-Alvarez</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Tsoka</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Ouzounis</surname><given-names>C</given-names></name>
</person-group>             <year>2003</year>             <article-title>The phylogenetic extent of metabolic enzymes and pathways.</article-title>             <source>Genome Res</source>             <volume>13</volume>             <fpage>422</fpage>          </element-citation></ref>
<ref id="pcbi.1000868-Felsenstein1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>
</person-group>             <year>1981</year>             <article-title>Evolutionary trees from DNA sequences: A maximum likelihood approach.</article-title>             <source>J Mol Evol</source>             <volume>17</volume>             <fpage>368</fpage>             <lpage>376</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Gelfand1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gelfand</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>A</given-names></name>
</person-group>             <year>1990</year>             <article-title>Sampling-based approaches to calculating marginal densities.</article-title>             <source>J Am Stat Assoc</source>             <volume>85</volume>             <fpage>398</fpage>             <lpage>409</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Geman1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Geman</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Geman</surname><given-names>D</given-names></name>
</person-group>             <year>1984</year>             <article-title>Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images.</article-title>             <source>IEEE T Pattern Anal</source>             <volume>6</volume>             <fpage>721</fpage>             <lpage>741</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Felsenstein2"><label>17</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>
</person-group>             <year>2004</year>             <source>Inferring phylogenies</source>             <publisher-loc>Sunderland (MA)</publisher-loc>             <publisher-name>Sinauer Associates</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000868-Holmes1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Bruno</surname><given-names>W</given-names></name>
</person-group>             <year>2001</year>             <article-title>Evolutionary HMMs: a Bayesian approach to multiple alignment.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>803</fpage>             <lpage>820</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Metropolis1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Metropolis</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Rosenbluth</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Rosenbluth</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Teller</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Teller</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>1953</year>             <article-title>Equation of state calculations by fast computing machines.</article-title>             <source>J Chem Phys</source>             <volume>21</volume>             <fpage>1087</fpage>          </element-citation></ref>
<ref id="pcbi.1000868-Hastings1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hastings</surname><given-names>W</given-names></name>
</person-group>             <year>1970</year>             <article-title>Monte Carlo sampling methods using Markov chains and their applications.</article-title>             <source>Biometrika</source>             <volume>57</volume>             <fpage>97</fpage>             <lpage>109</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Gilks1"><label>21</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gilks</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Richardson</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Spiegelhalter</surname><given-names>D</given-names></name>
</person-group>             <year>1996</year>             <source>Markov chain Monte Carlo in practice</source>             <publisher-name>Chapman &amp; Hall/CRC</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000868-Kanehisa1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Araki</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Goto</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Hattori</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hirakawa</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>KEGG for linking genomes to life and the environment.</article-title>             <source>Nucleic Acids Res</source>             <volume>36</volume>             <fpage>D480</fpage>             <lpage>D484</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Sarkar1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sarkar</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Guttman</surname><given-names>D</given-names></name>
</person-group>             <year>2004</year>             <article-title>Evolution of the core genome of <italic>Pseudomonas syringae</italic>, a highly clonal, endemic plant pathogen.</article-title>             <source>Appl Environ Microbiol</source>             <volume>70</volume>             <fpage>1999</fpage>             <lpage>2012</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Mithani2"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mithani</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Preston</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <year>2009</year>             <article-title>Rahnuma: Hypergraph based tool for metabolic pathway prediction and network comparison.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>1831</fpage>             <lpage>1832</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Rico1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rico</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Preston</surname><given-names>G</given-names></name>
</person-group>             <year>2008</year>             <article-title><italic>Pseudomonas syringae</italic> pv. tomato DC3000 uses constitutive and apoplast-induced nutrient assimilation pathways to catabolize nutrients that are abundant in the tomato apoplast.</article-title>             <source>Mol Plant-Microbe Interact</source>             <volume>21</volume>             <fpage>269</fpage>             <lpage>282</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Fitch1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fitch</surname><given-names>W</given-names></name>
</person-group>             <year>1971</year>             <article-title>Toward defining the course of evolution: minimum change for a specific tree topology.</article-title>             <source>Syst Zool</source>             <volume>20</volume>             <fpage>406</fpage>             <lpage>416</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Forst1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Forst</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Schulten</surname><given-names>K</given-names></name>
</person-group>             <year>1999</year>             <article-title>Evolution of metabolisms: a new method for the comparison of metabolic pathways using genomics information.</article-title>             <source>J Comp Biol</source>             <volume>6</volume>             <fpage>343</fpage>             <lpage>360</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Kelley1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kelley</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Sharan</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Karp</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Sittler</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Root</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2003</year>             <article-title>Conserved pathways within bacteria and yeast as revealed by global protein network alignment.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>100</volume>             <fpage>11394</fpage>             <lpage>11399</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Kelley2"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kelley</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Yuan</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Lewitter</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Sharan</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Stockwell</surname><given-names>B</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>PathBLAST: a tool for alignment of protein interaction networks.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>W83</fpage>             <lpage>W88</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Heymans1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Heymans</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Singh</surname><given-names>A</given-names></name>
</person-group>             <year>2003</year>             <article-title>Deriving phylogenetic trees from the similarity analysis of metabolic pathways.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>i138</fpage>             <lpage>i146</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Forst2"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Forst</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Flamm</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Hofacker</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Stadler</surname><given-names>P</given-names></name>
</person-group>             <year>2006</year>             <article-title>Algebraic comparison of metabolic networks, phylogenetic inference, and metabolic innovation.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <fpage>67</fpage>          </element-citation></ref>
<ref id="pcbi.1000868-Koskinen1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Koskinen</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Snijders</surname><given-names>T</given-names></name>
</person-group>             <year>2007</year>             <article-title>Bayesian inference for dynamic social network data.</article-title>             <source>J Stat Plan Infer</source>             <volume>137</volume>             <fpage>3930</fpage>             <lpage>3938</lpage>          </element-citation></ref>
<ref id="pcbi.1000868-Behr1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Behr</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Wilson</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Gill</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Salamon</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Schoolnik</surname><given-names>G</given-names></name>
<etal/></person-group>             <year>1999</year>             <article-title>Comparative genomics of BCG vaccines by whole-genome DNA microarray.</article-title>             <source>Science</source>             <volume>284</volume>             <fpage>1520</fpage>             <lpage>1523</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>