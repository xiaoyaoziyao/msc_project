<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-11-15184</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0025190</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Computerized simulations</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied mathematics</subject>
            <subj-group>
              <subject>Game theory</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Medicine</subject>
          <subj-group>
            <subject>Mental health</subject>
            <subj-group>
              <subject>Psychology</subject>
              <subj-group>
                <subject>Behavior</subject>
                <subject>Social psychology</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Social and behavioral sciences</subject>
          <subj-group>
            <subject>Psychology</subject>
            <subj-group>
              <subject>Behavior</subject>
              <subject>Social psychology</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Sociology</subject>
            <subj-group>
              <subject>Social networks</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Mental Health</subject>
          <subject>Computer Science</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories><title-group><article-title>Clustering in Large Networks Does Not Promote Upstream Reciprocity</article-title><alt-title alt-title-type="running-head">Clustering Does Not Promote Upstream Reciprocity</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Masuda</surname>
            <given-names>Naoki</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Mathematical Informatics, The University of Tokyo, Bunkyo, Tokyo, Japan</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>PRESTO, Japan Science and Technology Agency, Kawaguchi, Saitama, Japan</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Holme</surname>
            <given-names>Petter</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Umeå University, Sweden</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">masuda@mist.i.u-tokyo.ac.jp</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: NM. Performed the experiments: NM. Analyzed the data: NM. Contributed reagents/materials/analysis tools: NM. Wrote the paper: NM.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <year>2011</year>
      </pub-date><pub-date pub-type="epub">
        <day>5</day>
        <month>10</month>
        <year>2011</year>
      </pub-date><volume>6</volume><issue>10</issue><elocation-id>e25190</elocation-id><history>
        <date date-type="received">
          <day>5</day>
          <month>8</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>26</day>
          <month>8</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Naoki Masuda</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Upstream reciprocity (also called generalized reciprocity) is a putative mechanism for cooperation in social dilemma situations with which players help others when they are helped by somebody else. It is a type of indirect reciprocity. Although upstream reciprocity is often observed in experiments, most theories suggest that it is operative only when players form short cycles such as triangles, implying a small population size, or when it is combined with other mechanisms that promote cooperation on their own. An expectation is that real social networks, which are known to be full of triangles and other short cycles, may accommodate upstream reciprocity. In this study, I extend the upstream reciprocity game proposed for a directed cycle by Boyd and Richerson to the case of general networks. The model is not evolutionary and concerns the conditions under which the unanimity of cooperative players is a Nash equilibrium. I show that an abundance of triangles or other short cycles in a network does little to promote upstream reciprocity. Cooperation is less likely for a larger population size even if triangles are abundant in the network. In addition, in contrast to the results for evolutionary social dilemma games on networks, scale-free networks lead to less cooperation than networks with a homogeneous degree distribution.</p>
      </abstract><funding-group><funding-statement>The present work is financially supported by Grants-in-Aid for Scientific Research (Grant Nos. 20760258 and 23681033, and Innovative Areas “Systems Molecular Ethology”) from MEXT, Japan. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="8"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Several mechanisms govern cooperation among individuals in social dilemma situations such as the prisoner's dilemma game. Upstream reciprocity, also called generalized reciprocity, is one such mechanism in which players help others when they themselves are helped by other players. It is a form of indirect reciprocity, in which individuals are helped by unknown others and vice versa <xref ref-type="bibr" rid="pone.0025190-Nowak1">[1]</xref>, <xref ref-type="bibr" rid="pone.0025190-Sigmund1">[2]</xref>.</p>
      <p>Cooperation based on upstream reciprocity has been observed in various laboratory experiments. Examples include human subjects in variants of the trust game, which is a social dilemma game <xref ref-type="bibr" rid="pone.0025190-Dufwenberg1">[3]</xref>–<xref ref-type="bibr" rid="pone.0025190-Stanca1">[5]</xref>, human subjects participating in filling out tedious surveys <xref ref-type="bibr" rid="pone.0025190-Bartlett1">[6]</xref>, and rats pulling a lever to deliver food to a conspecific <xref ref-type="bibr" rid="pone.0025190-Rutte1">[7]</xref>. Even more experimental evidence is available in the field of sociology in the context of social exchange <xref ref-type="bibr" rid="pone.0025190-Yamagishi1">[8]</xref>, <xref ref-type="bibr" rid="pone.0025190-Molm1">[9]</xref> (also see <xref ref-type="bibr" rid="pone.0025190-Malinowski1">[10]</xref>, <xref ref-type="bibr" rid="pone.0025190-Ziegler1">[11]</xref> for classical examples of the Kula ring).</p>
      <p>Nevertheless, theory and numerical simulations have revealed that upstream reciprocity in isolation does not promote cooperation (but see Barta et al. <xref ref-type="bibr" rid="pone.0025190-Barta1">[12]</xref> for an exception). Upstream reciprocity usually supports cooperation only when combined with another mechanism that can yield cooperation on its own. Cooperation appears when the population size is small <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref>, <xref ref-type="bibr" rid="pone.0025190-Pfeiffer1">[14]</xref>, upstream reciprocity is combined with direct reciprocity or spatial reciprocity <xref ref-type="bibr" rid="pone.0025190-Nowak2">[15]</xref>, players move across groups <xref ref-type="bibr" rid="pone.0025190-Hamilton1">[16]</xref>, players interact assortatively <xref ref-type="bibr" rid="pone.0025190-Rankin1">[17]</xref>, or players inhabit heterogeneous networks <xref ref-type="bibr" rid="pone.0025190-Iwagami1">[18]</xref>.</p>
      <p>In their seminal study, Boyd and Richerson analyzed an upstream reciprocity game on a directed cycle and showed that it yields cooperation only when the cycle is small <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref>. The shortest possible cycle with indirect reciprocity consists of three players ( <xref ref-type="fig" rid="pone-0025190-g001">Fig. 1</xref>) because a cycle composed of two players only involves direct reciprocity. Cooperation is intuitively less likely for longer cycles because a player that helps a unique downstream neighbor on the cycle has to “trust” too many intermediary players for their tendency to cooperate before the player eventually receives help.</p>
      <fig id="pone-0025190-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0025190.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Directed cycle with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e001" xlink:type="simple"/></inline-formula> nodes.</title>
        </caption>
        <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.g001" xlink:type="simple"/>
      </fig>
      <p>Real social networks are full of short cycles represented by triangles, a feature known as transitivity <xref ref-type="bibr" rid="pone.0025190-Wasserman1">[19]</xref> or clustering <xref ref-type="bibr" rid="pone.0025190-Albert1">[20]</xref>–<xref ref-type="bibr" rid="pone.0025190-Newman2">[22]</xref>. Therefore, a natural expectation is that larger networks with a high level of clustering (i.e., many triangles) may facilitate cooperation based on upstream reciprocity <xref ref-type="bibr" rid="pone.0025190-Yamagishi1">[8]</xref>. In the present study, I address this issue theoretically. I extend the model of Boyd and Richerson <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref> to general networks and derive the condition under which the unanimity of players using upstream reciprocity is resistant to invasion of defectors. Then, I apply the condition to model networks to show that clustering does little to promote cooperation except in an unrealistic network. This conclusion holds true for both homogeneous and heterogeneous networks, where heterogeneity concerns that in the degree, i.e., the number of neighbors for a player.</p>
      <p>My results seem to contradict previous results for spatial reciprocity in which clustering enhances cooperation in the prisoner's dilemma game <xref ref-type="bibr" rid="pone.0025190-Nowak3">[23]</xref> and those for heterogeneous networks in which heterogeneity enhances cooperation in various two-person social dilemma games <xref ref-type="bibr" rid="pone.0025190-Santos1">[24]</xref>–<xref ref-type="bibr" rid="pone.0025190-Durn1">[27]</xref> and in the upstream reciprocity game <xref ref-type="bibr" rid="pone.0025190-Iwagami1">[18]</xref>. These previous models are evolutionary, however, whereas mine and the original model by Boyd and Richerson <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref> are nonevolutionary and based on the Nash equilibrium. I opted to use a nonevolutionary setting in this study because interpretation of evolutionary games seems elusive for heterogeneous networks <xref ref-type="bibr" rid="pone.0025190-Tomassini1">[28]</xref>, <xref ref-type="bibr" rid="pone.0025190-Masuda1">[29]</xref> (see <xref ref-type="sec" rid="s3">Discussion</xref> for a more detailed explanation).</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>Preliminary: upstream reciprocity on a directed cycle</title>
        <p>Boyd and Richerson proposed a model of upstream reciprocity on the directed cycle <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref>. By analyzing the stability of a unanimous population of cooperative players, they showed that cooperation is unlikely unless the number of players, denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e002" xlink:type="simple"/></inline-formula>, is small.</p>
        <p>In their model, the players are involved in a type of donation game. Each player may donate to a unique downstream neighbor on a directed cycle at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e003" xlink:type="simple"/></inline-formula> by paying cost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e004" xlink:type="simple"/></inline-formula>. The recipient of the donation gains benefit <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e005" xlink:type="simple"/></inline-formula>. Among the recipients of the donation at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e006" xlink:type="simple"/></inline-formula>, those who comply with upstream reciprocity donate to a unique downstream neighbor at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e007" xlink:type="simple"/></inline-formula> by paying cost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e008" xlink:type="simple"/></inline-formula>. Chains of donation are then carried over to downstream players, who may donate to their downstream neighbors at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e009" xlink:type="simple"/></inline-formula>. At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e010" xlink:type="simple"/></inline-formula>, defectors that have received a donation at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e011" xlink:type="simple"/></inline-formula> terminate the chain of donation. Such defectors receive benefit <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e012" xlink:type="simple"/></inline-formula> at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e013" xlink:type="simple"/></inline-formula> and lose nothing at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e014" xlink:type="simple"/></inline-formula>. This procedure is repeated for all players until all the chains of donation terminate. If all the players perfectly comply with upstream reciprocity, the chains never terminate. In contrast, if there is at least one defector, all the chains terminate in finite time.</p>
        <p>As in iterated games <xref ref-type="bibr" rid="pone.0025190-Trivers1">[30]</xref>, <xref ref-type="bibr" rid="pone.0025190-Axelrod1">[31]</xref>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e015" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e016" xlink:type="simple"/></inline-formula>) is the probability that the next time step occurs. We can also interpret <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e017" xlink:type="simple"/></inline-formula> as the probability that players complying with upstream reciprocity do donate to their downstream neighbors, such that they erroneously defect with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e018" xlink:type="simple"/></inline-formula> in each time step. Each player's payoff is defined as the discounted sum of the payoff over the time horizon. In other words, the payoff obtained at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e019" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e020" xlink:type="simple"/></inline-formula>) contributes to the summed payoff with weight <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e021" xlink:type="simple"/></inline-formula>.</p>
        <p>It may be advantageous for a player not to donate to the downstream neighbor to gain benefit <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e022" xlink:type="simple"/></inline-formula> without paying cost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e023" xlink:type="simple"/></inline-formula> over the time course. However, a player that complies with upstream reciprocity may enjoy a large summed payoff if chains of donation persist in the network for a long time.</p>
        <p>Each player is assumed to be of either classical defector (CD; termed unconditional defection in <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref>) or generous cooperator (GC; termed upstream tit-for-tat in <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref>). By definition, a CD does not donate to the downstream neighbor at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e024" xlink:type="simple"/></inline-formula> and refuses to relay the chain of donation received from the upstream neighbor to the downstream neighbor at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e025" xlink:type="simple"/></inline-formula>. A GC donates at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e026" xlink:type="simple"/></inline-formula> and donates to the downstream neighbor if the GC received a donation from the upstream neighbor in the previous time step.</p>
        <p>For this model, Boyd and Richerson obtained the condition under which the unanimity of GCs is robust against the invasion of a CD (i.e., conversion of one GC into CD). When all players are GC, the summed payoff to one GC is equal to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e027" xlink:type="simple"/><label>(1)</label></disp-formula>If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e028" xlink:type="simple"/></inline-formula> players are GC and one player is CD, the unique CD's summed payoff is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e029" xlink:type="simple"/><label>(2)</label></disp-formula>Therefore, GC is stable against the invasion of CD if the right-hand side of Eq. (1) is larger than that of Eq. (2), that is,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e030" xlink:type="simple"/><label>(3)</label></disp-formula>Equation (3) generalizes the result for direct reciprocity <xref ref-type="bibr" rid="pone.0025190-Trivers1">[30]</xref>, <xref ref-type="bibr" rid="pone.0025190-Axelrod1">[31]</xref>, which corresponds to the case where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e031" xlink:type="simple"/></inline-formula>. Equation (3) also implies that cooperation is likely if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e032" xlink:type="simple"/></inline-formula> is large. However, maintaining cooperation is increasingly difficult as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e033" xlink:type="simple"/></inline-formula> increases.</p>
      </sec>
      <sec id="s2b">
        <title>Model</title>
        <p>I generalize the Boyd-Richerson model on a directed cycle to the case of general networks. Consider a network of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e034" xlink:type="simple"/></inline-formula> players in which links may be directed or weighted. I denote the weight of the link from player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e035" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e036" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e037" xlink:type="simple"/></inline-formula>. I assume that the network is strongly connected, i.e., any player is reacheable from any other player along directed links. Otherwise, chains of donation starting from some playes never return to them because of the purely structural reason. In such a network, it would be more difficult to maintain cooperation than in strongly connected networks. Even for strongly connected networks that might accommodate upstream reciprocity, I will show that cooperation is not likely for realistic network structure.</p>
        <p>Assume that all the players are GC and that each GC starts a chain of donation of unit size at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e038" xlink:type="simple"/></inline-formula>. Therefore, the total amount of donation flowing in the network in each time step is equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e039" xlink:type="simple"/></inline-formula>. In the steady state, the total amount of donation that each player receives from upstream neighbors is equal to that each player gives to downstream neighbors in each time step. I denote the total amount of donation that reaches and leaves player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e040" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e041" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e042" xlink:type="simple"/></inline-formula>. In this situation, the amount of donation that player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e043" xlink:type="simple"/></inline-formula> imparts to player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e044" xlink:type="simple"/></inline-formula> in each time step is equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e045" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e046" xlink:type="simple"/></inline-formula> is the outdegree of player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e047" xlink:type="simple"/></inline-formula>. Player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e048" xlink:type="simple"/></inline-formula> receives payoff <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e049" xlink:type="simple"/></inline-formula> in each time step.</p>
        <p>In our previous work <xref ref-type="bibr" rid="pone.0025190-Iwagami1">[18]</xref>, we assumed that each GC starts a unit flow of donation at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e050" xlink:type="simple"/></inline-formula>. In the present study, however, I wait until the flow reaches the steady state before starting the game at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e051" xlink:type="simple"/></inline-formula>.</p>
        <p>The definition of CD for general networks is straightforward; a CD donates to nobody for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e052" xlink:type="simple"/></inline-formula>. I extend the concept of GC to the case of general networks as follows. On a directed cycle, a GC quits helping its downstream neighbor once the GC is not helped by the upstream neighbor <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref>. On a general network, the total amount of donation that GC <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e053" xlink:type="simple"/></inline-formula> receives per unit time in the absence of a CD is equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e054" xlink:type="simple"/></inline-formula>. If there is a CD, the total amount of donation that GC <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e055" xlink:type="simple"/></inline-formula> receives may be smaller than the amount that player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e056" xlink:type="simple"/></inline-formula> would receive in the absence of a CD. By definition, the GC responds to this situation by relaying the total amount of the incoming donation proportionally to all its downstream neighbors in accordance with the weights of the links outgoing from player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e057" xlink:type="simple"/></inline-formula>.</p>
        <p>As an example, suppose that one upstream neighbor of GC <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e058" xlink:type="simple"/></inline-formula>, denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e059" xlink:type="simple"/></inline-formula>, is CD and all the other <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e060" xlink:type="simple"/></inline-formula> players, including player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e061" xlink:type="simple"/></inline-formula>, are GC. At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e062" xlink:type="simple"/></inline-formula>, the total amount of donation that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e063" xlink:type="simple"/></inline-formula> receives is equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e064" xlink:type="simple"/></inline-formula>, which is smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e065" xlink:type="simple"/></inline-formula>. Player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e066" xlink:type="simple"/></inline-formula> donates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e067" xlink:type="simple"/></inline-formula> in total. Therefore, player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e068" xlink:type="simple"/></inline-formula>'s payoff at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e069" xlink:type="simple"/></inline-formula> is equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e070" xlink:type="simple"/></inline-formula>. In response to the amount of donation that player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e071" xlink:type="simple"/></inline-formula> received at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e072" xlink:type="simple"/></inline-formula>, player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e073" xlink:type="simple"/></inline-formula> adjusts the total amount of donation that it gives the downstream neighbors from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e074" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e075" xlink:type="simple"/></inline-formula> at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e076" xlink:type="simple"/></inline-formula>. Therefore, player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e077" xlink:type="simple"/></inline-formula> donates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e078" xlink:type="simple"/></inline-formula> to its downstream neighbor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e079" xlink:type="simple"/></inline-formula>. This quantity is smaller than the donation that player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e080" xlink:type="simple"/></inline-formula> would give player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e081" xlink:type="simple"/></inline-formula> in the absence of CD <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e082" xlink:type="simple"/></inline-formula>, which would be equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e083" xlink:type="simple"/></inline-formula>.</p>
        <p>An implicit assumption is that the GC cannot identify the incoming links along which less donation is received as compared to the case without a CD. In other words, even if a GC is defected by the CD in the upstream, the GC cannot directly retaliate. Instead, the GC distributes the retaliation equally (i.e., proportionally to the weight of the link) to its downstream neighbors.</p>
      </sec>
      <sec id="s2c">
        <title>Stability of upstream reciprocity in networks</title>
        <p>In this section, I derive the condition under which no player is motivated to convert from GC to CD when all the players are initially GC.</p>
        <p>The steady state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e084" xlink:type="simple"/></inline-formula> is equivalent to the stationary density of the simple random walk in discrete time. It is given as the solution of<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e085" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e086" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e087" xlink:type="simple"/></inline-formula>-by-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e088" xlink:type="simple"/></inline-formula> adjacency matrix, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e089" xlink:type="simple"/></inline-formula> represents the weight of the link from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e090" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e091" xlink:type="simple"/></inline-formula>, and the diagonal matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e092" xlink:type="simple"/></inline-formula> is defined as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e093" xlink:type="simple"/></inline-formula>. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e094" xlink:type="simple"/></inline-formula> element of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e095" xlink:type="simple"/></inline-formula> is equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e096" xlink:type="simple"/></inline-formula>, that is, the probability that a walker at node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e097" xlink:type="simple"/></inline-formula> transits to node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e098" xlink:type="simple"/></inline-formula> in one time step. If the network is undirected, the solution of Eq. (4) is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e099" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e100" xlink:type="simple"/></inline-formula>.</p>
        <p>The summed payoff to player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e101" xlink:type="simple"/></inline-formula> is equal to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e102" xlink:type="simple"/><label>(5)</label></disp-formula></p>
        <p>To examine the Nash stability of the unanimity of GC, I analyze the situation in which player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e103" xlink:type="simple"/></inline-formula> is CD and the other <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e104" xlink:type="simple"/></inline-formula> players are GC. At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e105" xlink:type="simple"/></inline-formula>, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e106" xlink:type="simple"/></inline-formula> GCs pay <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e107" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e108" xlink:type="simple"/></inline-formula>), and player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e109" xlink:type="simple"/></inline-formula> pays nothing. Therefore, the benefits to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e110" xlink:type="simple"/></inline-formula> players, including player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e111" xlink:type="simple"/></inline-formula>, at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e112" xlink:type="simple"/></inline-formula> are given in vector form by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e113" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e114" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e115" xlink:type="simple"/></inline-formula>-by-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e116" xlink:type="simple"/></inline-formula> identity matrix, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e117" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e118" xlink:type="simple"/></inline-formula>-by-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e119" xlink:type="simple"/></inline-formula> matrix whose <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e120" xlink:type="simple"/></inline-formula> element is equal to one and all the other elements are equal to zero. The benefit to player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e121" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e122" xlink:type="simple"/></inline-formula>) at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e123" xlink:type="simple"/></inline-formula> is equal to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e124" xlink:type="simple"/></inline-formula>th element of the row vector given by Eq. (6).</p>
        <p>At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e125" xlink:type="simple"/></inline-formula>, the downstream neighbors of player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e126" xlink:type="simple"/></inline-formula> donate less because player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e127" xlink:type="simple"/></inline-formula> defects at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e128" xlink:type="simple"/></inline-formula>. The amount of donation given to player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e129" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e130" xlink:type="simple"/></inline-formula> is not necessarily a neighbor of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e131" xlink:type="simple"/></inline-formula>, at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e132" xlink:type="simple"/></inline-formula> is equal to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e133" xlink:type="simple"/></inline-formula>th element of the row vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e134" xlink:type="simple"/></inline-formula>. Therefore, the total amount that GC <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e135" xlink:type="simple"/></inline-formula> donates to its downstream neighbors at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e136" xlink:type="simple"/></inline-formula> is equal to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e137" xlink:type="simple"/></inline-formula>th element of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e138" xlink:type="simple"/></inline-formula>. Player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e139" xlink:type="simple"/></inline-formula>, who is CD, does not donate to others at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e140" xlink:type="simple"/></inline-formula>. Therefore, the amount of the donation issued by the players at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e141" xlink:type="simple"/></inline-formula> is represented in vector form as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e142" xlink:type="simple"/></inline-formula>. The discounted benefits that the players receive at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e143" xlink:type="simple"/></inline-formula> are given in vector form by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e144" xlink:type="simple"/><label>(7)</label></disp-formula>By repeating the same procedure, we can obtain the summed benefits to the players in vector form as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e145" xlink:type="simple"/><label>(8)</label></disp-formula>To derive Eq. (8), I used the fact that the spectral radius of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e146" xlink:type="simple"/></inline-formula> is smaller than unity (that of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e147" xlink:type="simple"/></inline-formula> is equal to unity). The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e148" xlink:type="simple"/></inline-formula>th element of Eq. (8) is equal to the summed payoff to player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e149" xlink:type="simple"/></inline-formula> because player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e150" xlink:type="simple"/></inline-formula> does not pay the cost to donate at any <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e151" xlink:type="simple"/></inline-formula>.</p>
        <p>If the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e152" xlink:type="simple"/></inline-formula>th element of Eq. (8) is smaller than the quantity given by Eq. (5), player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e153" xlink:type="simple"/></inline-formula> is not motivated to turn from GC to CD. Therefore, the unanimity of GC is stable if and only if<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e154" xlink:type="simple"/><label>(9)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e155" xlink:type="simple"/></inline-formula> indicates the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e156" xlink:type="simple"/></inline-formula>th element of a vector. By rearranging terms of Eq. (9), I obtain<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e157" xlink:type="simple"/><label>(10)</label></disp-formula>Because <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e158" xlink:type="simple"/></inline-formula>, Eq. (10) can be reduced to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e159" xlink:type="simple"/><label>(11)</label></disp-formula></p>
        <p>Equation (11) is never satisfied when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e160" xlink:type="simple"/></inline-formula> because <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e161" xlink:type="simple"/></inline-formula>. It is always satisfied when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e162" xlink:type="simple"/></inline-formula> because the left-hand side of Eq. (10) tends to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e163" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e164" xlink:type="simple"/></inline-formula>.</p>
        <p>For a directed cycle having <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e165" xlink:type="simple"/></inline-formula> nodes, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e166" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e167" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e168" xlink:type="simple"/></inline-formula>), and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e169" xlink:type="simple"/></inline-formula> is equal to 1 if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e170" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e171" xlink:type="simple"/></inline-formula> otherwise. Owing to the symmetry with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e172" xlink:type="simple"/></inline-formula>, we only have to consider the condition (i.e., Eq. (9) or Eq. (11)) for player 1 and obtain the following:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e173" xlink:type="simple"/><label>(12)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e174" xlink:type="simple"/><label>(13)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e175" xlink:type="simple"/><label>(14)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e176" xlink:type="simple"/><label>(15)</label></disp-formula>Therefore, Eq. (11) can be read as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e177" xlink:type="simple"/></inline-formula>, which reproduces the result by Boyd and Richerson <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref>.</p>
      </sec>
      <sec id="s2d">
        <title>Numerical results for various networks</title>
        <p>For general networks, calculating <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e178" xlink:type="simple"/></inline-formula>, which is used in Eqs. (9) and (11), is technically difficult because this matrix may have nondiagonal Jordan blocks. Standard formulae for decomposing matrices under independence of different eigenmodes do not simply apply. The method for efficiently calculating <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e179" xlink:type="simple"/></inline-formula> is described in the <xref ref-type="sec" rid="s4">Methods</xref> section.</p>
        <p>I conducted numerical simulations for different networks to determine the threshold value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e180" xlink:type="simple"/></inline-formula>, denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e181" xlink:type="simple"/></inline-formula>, above which the unanimity of GC is stable against invasion of CD. The conclusions derived from the following numerical simulations are summarized as follows: (a) abundance of triangles (and other short cycles) hardly promotes cooperation, and (b) networks with heterogeneous degree distributions yield less cooperation than those with homogeneous degree distributions.</p>
        <sec id="s2d1">
          <title>Network models</title>
          <p>I use five types of undirected networks generated from four network models. It would be even more difficult to obtain cooperation in directed networks because undirected networks generally allow more direct reciprocity than directed networks (see <xref ref-type="sec" rid="s3">Discussion</xref> for a more detailed explanation).</p>
          <p>The regular random graph (RRG) is defined as a completely randomly wired network under the restriction that all nodes (i.e., players) have the same degree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e182" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pone.0025190-Newman1">[21]</xref>, <xref ref-type="bibr" rid="pone.0025190-Newman2">[22]</xref>. The RRG has low clustering (i.e., low triangle density) and is homogeneous in degree <xref ref-type="bibr" rid="pone.0025190-Newman1">[21]</xref>, <xref ref-type="bibr" rid="pone.0025190-Newman2">[22]</xref>, <xref ref-type="bibr" rid="pone.0025190-Watts1">[32]</xref>.</p>
          <p>To construct a network from the Watts-Strogatz (WS) model <xref ref-type="bibr" rid="pone.0025190-Watts1">[32]</xref>, nodes are placed in a circle and connected such that each one is adjacent to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e183" xlink:type="simple"/></inline-formula> closest nodes on each side on the circle. In this way, each node has degree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e184" xlink:type="simple"/></inline-formula>. A fraction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e185" xlink:type="simple"/></inline-formula> of the links is then rewired, and a selected link preserves one of its end nodes and abandons the other end node. Then, I randomly select a node from the network as the new destination of the rewired link such that self-loops and multiple links are avoided. I use two cases, one in which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e186" xlink:type="simple"/></inline-formula> and the other in which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e187" xlink:type="simple"/></inline-formula> is small but greater than zero. In both cases, the network has a high amount of clustering. When <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e188" xlink:type="simple"/></inline-formula>, the network is homogeneous in degree and unrealistic because it has a large average distance between nodes. When <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e189" xlink:type="simple"/></inline-formula> is positive and appropriately small, the degree is narrowly distributed and the network has a small average distance <xref ref-type="bibr" rid="pone.0025190-Watts1">[32]</xref>.</p>
          <p>As an example of networks with heterogeneous degree distribution, I use the Barabási-Albert (BA) model. It has a power-law (scale-free) degree distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e190" xlink:type="simple"/></inline-formula>, a small average distance, and low level of clustering <xref ref-type="bibr" rid="pone.0025190-Albert1">[20]</xref>, <xref ref-type="bibr" rid="pone.0025190-Barabsi1">[33]</xref>.</p>
          <p>To probe the effect of triangles in scale-free networks, I use a variant of the Klemm-Eguluz (KE) model <xref ref-type="bibr" rid="pone.0025190-Klemm1">[34]</xref>, <xref ref-type="bibr" rid="pone.0025190-Klemm2">[35]</xref>. For appropriate parameter values, my variant of the KE model generates scale-free networks with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e191" xlink:type="simple"/></inline-formula>, small average distances, and a high level of clustering.</p>
        </sec>
        <sec id="s2d2">
          <title>The effect of clustering</title>
          <p>For a fixed network and a fixed value of cost-to-benefit ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e192" xlink:type="simple"/></inline-formula>, the threshold value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e193" xlink:type="simple"/></inline-formula> above which the unanimity of GC is stable against conversion of player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e194" xlink:type="simple"/></inline-formula> into CD depends on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e195" xlink:type="simple"/></inline-formula>. I denote this value by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e196" xlink:type="simple"/></inline-formula>. I determine <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e197" xlink:type="simple"/></inline-formula> as the largest value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e198" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e199" xlink:type="simple"/></inline-formula>). This is true because once a certain player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e200" xlink:type="simple"/></inline-formula> turns from GC to CD, other players may be also inclined to turn to CD. It is straightforward to extend the condition shown in Eq. (9) to the case of multiple CD players. For example, we can similarly derive the condition under which player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e201" xlink:type="simple"/></inline-formula> turns from GC to CD when player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e202" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e203" xlink:type="simple"/></inline-formula>) is CD and all the other <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e204" xlink:type="simple"/></inline-formula> players are GC. For example, on the left-hand side of Eq. (9), we just need to replace <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e205" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e206" xlink:type="simple"/></inline-formula>. I confirmed for all the following numerical results that once a player turns from GC to CD, some others are also elicited to turn from GC to CD according to the Nash criterion and that such a transition from GC to CD cascades until all players are CD. In loose terms, this phenomenon is reminiscent of models of cascading failure of overloaded networks, which mimic, for example, blackouts on power grids <xref ref-type="bibr" rid="pone.0025190-Motter1">[36]</xref>.</p>
          <p>The relationship between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e207" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e208" xlink:type="simple"/></inline-formula> is shown in <xref ref-type="fig" rid="pone-0025190-g002">Fig. 2(a)</xref> for the five networks with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e209" xlink:type="simple"/></inline-formula> and mean degree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e210" xlink:type="simple"/></inline-formula>. The parameter values for the networks are explained in the caption of <xref ref-type="fig" rid="pone-0025190-g002">Fig. 2</xref>. A small <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e211" xlink:type="simple"/></inline-formula> value results in a small <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e212" xlink:type="simple"/></inline-formula> value, indicating that cooperation is facilitated. This is generally the case for various mechanisms for cooperation <xref ref-type="bibr" rid="pone.0025190-Sigmund1">[2]</xref>, <xref ref-type="bibr" rid="pone.0025190-Nowak4">[37]</xref>.</p>
          <fig id="pone-0025190-g002" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0025190.g002</object-id>
            <label>Figure 2</label>
            <caption>
              <title>Relationship between threshold discount factor (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e213" xlink:type="simple"/></inline-formula>) and cost-to-benefit ratio (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e214" xlink:type="simple"/></inline-formula>).</title>
              <p>I use the five types of networks and set (a) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e215" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e216" xlink:type="simple"/></inline-formula>, and (b) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e217" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e218" xlink:type="simple"/></inline-formula>. The results for direct reciprocity (i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e219" xlink:type="simple"/></inline-formula>) and upstream reciprocity on the directed triangle (i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e220" xlink:type="simple"/></inline-formula>) are also shown by thin black lines for comparison. In (a), I set the rewiring probability for the WS model to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e221" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e222" xlink:type="simple"/></inline-formula>. For the BA model, there are initially <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e223" xlink:type="simple"/></inline-formula> nodes (i.e., dyad), and the number of links that each added node has is set to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e224" xlink:type="simple"/></inline-formula>. For my variant of the KE model, the initial number of nodes and the number of links that each added node has are set to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e225" xlink:type="simple"/></inline-formula>, and an active node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e226" xlink:type="simple"/></inline-formula> is deactivated with probability proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e227" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e228" xlink:type="simple"/></inline-formula>. After constructing the network based on the original KE model <xref ref-type="bibr" rid="pone.0025190-Klemm1">[34]</xref>, I rewire fraction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e229" xlink:type="simple"/></inline-formula> of randomly selected links to make the average distance small. In (b), I set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e230" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e231" xlink:type="simple"/></inline-formula> for the WS model, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e232" xlink:type="simple"/></inline-formula> for the BA model, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e233" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e234" xlink:type="simple"/></inline-formula> for the KE model.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.g002" xlink:type="simple"/>
          </fig>
          <p>For reference, the results for direct reciprocity (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e235" xlink:type="simple"/></inline-formula>) and upstream reciprocity on the directed triangle (<xref ref-type="fig" rid="pone-0025190-g001">Fig. 1</xref>; <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e236" xlink:type="simple"/></inline-formula>) are also shown in <xref ref-type="fig" rid="pone-0025190-g002">Fig. 2(a)</xref> by thin black lines. Except for small <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e237" xlink:type="simple"/></inline-formula> values, the five networks with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e238" xlink:type="simple"/></inline-formula> possess higher <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e239" xlink:type="simple"/></inline-formula> values as compared to these reference cases.</p>
          <p>The two networks generated from the WS model yield smaller values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e240" xlink:type="simple"/></inline-formula> than those obtained from the RRG, indicating that the WS model allows more cooperation than the RRG. Because the degree distributions of these networks are almost the same and the average distances of the RRG and the WS model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e241" xlink:type="simple"/></inline-formula> do not differ by much <xref ref-type="bibr" rid="pone.0025190-Watts1">[32]</xref>, I ascribe this difference to clustering. An abundance of triangles and short cycles in networks (i.e., the WS model) enhances cooperation. However, the difference in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e242" xlink:type="simple"/></inline-formula> is not very large. In quantitative terms, clustering does little to promote cooperation.</p>
          <p>The same conclusion is supported for heterogeneous networks (the BA and KE models). Values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e243" xlink:type="simple"/></inline-formula> for the KE model, which yields a high level of clustering are smaller than those for the BA model, which yields a low level of clustering. However, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e244" xlink:type="simple"/></inline-formula> values for the KE model are considerably larger than those for the RRG and the WS model, and the differences between the results for the BA and KE models are small.</p>
          <p>To summarize, clustering promotes cooperation but only to a small extent. To further substantiate this finding, I looked at different cases. <xref ref-type="fig" rid="pone-0025190-g002">Figure 2(b)</xref> compares <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e245" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e246" xlink:type="simple"/></inline-formula> values for the networks with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e247" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e248" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pone-0025190-g003">Figure 3(a)</xref> shows the dependence of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e249" xlink:type="simple"/></inline-formula> on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e250" xlink:type="simple"/></inline-formula> when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e251" xlink:type="simple"/></inline-formula>. These cases also suggest that clustering hardly promotes cooperation.</p>
          <fig id="pone-0025190-g003" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0025190.g003</object-id>
            <label>Figure 3</label>
            <caption>
              <title>Effects of network size (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e252" xlink:type="simple"/></inline-formula>).</title>
              <p>(a) Dependence of the threshold discount factor (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e253" xlink:type="simple"/></inline-formula>) on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e254" xlink:type="simple"/></inline-formula>. (b) Dependence of the clustering coefficient (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e255" xlink:type="simple"/></inline-formula>) on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e256" xlink:type="simple"/></inline-formula>. I use the five types of networks and set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e257" xlink:type="simple"/></inline-formula>. The parameter values for the networks are the same as those used in <xref ref-type="fig" rid="pone-0025190-g002">Fig. 2(b)</xref>. In (a), the results for the BA and KE models heavily overlap.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.g003" xlink:type="simple"/>
          </fig>
        </sec>
        <sec id="s2d3">
          <title>Scale-free versus homogeneous networks</title>
          <p><xref ref-type="fig" rid="pone-0025190-g002">Figure 2</xref> indicates that scale-free networks (i.e., the BA and KE models) allow less cooperation than networks with a homogeneous degree distribution (i.e., the RRG and WS model). This is in contrast with the results for the evolutionary two-person social dilemma games <xref ref-type="bibr" rid="pone.0025190-Santos1">[24]</xref>–<xref ref-type="bibr" rid="pone.0025190-Durn1">[27]</xref> and those for the evolutionary upstream reciprocity game <xref ref-type="bibr" rid="pone.0025190-Iwagami1">[18]</xref> on heterogeneous networks in which scale-free networks promote cooperation. The difference stems from the fact that players in evolutionary games mimic successful neighbors, whereas in my Nash equilibrium model, players judge whether GC or CD is more profitable when the other players do not change the strategies (see <xref ref-type="sec" rid="s3">Discussion</xref> for a more detailed explanation).</p>
          <p>To probe the reason why cooperation is reduced on scale-free networks, I examine the dependence of the player-wise threshold value, i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e258" xlink:type="simple"/></inline-formula> for player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e259" xlink:type="simple"/></inline-formula>, on node degree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e260" xlink:type="simple"/></inline-formula>. I generate a single network from each of the RRG, the BA model, and the KE model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e261" xlink:type="simple"/></inline-formula> using the same parameter values as those used in <xref ref-type="fig" rid="pone-0025190-g002">Fig. 2(b)</xref>. For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e262" xlink:type="simple"/></inline-formula>, the relationship between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e263" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e264" xlink:type="simple"/></inline-formula> is shown in <xref ref-type="fig" rid="pone-0025190-g004">Fig. 4</xref> for all nodes in the three networks. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e265" xlink:type="simple"/></inline-formula> decreases with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e266" xlink:type="simple"/></inline-formula> in the BA and KE models. In the RRG, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e267" xlink:type="simple"/></inline-formula> is equal to 6 for all the nodes, and the value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e268" xlink:type="simple"/></inline-formula> is approximately the same for all the nodes.</p>
          <fig id="pone-0025190-g004" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0025190.g004</object-id>
            <label>Figure 4</label>
            <caption>
              <title>Relationship between threshold discount factor (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e269" xlink:type="simple"/></inline-formula>) and node degree (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e270" xlink:type="simple"/></inline-formula>).</title>
              <p>I use the RRG, the BA model, and the KE model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e271" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e272" xlink:type="simple"/></inline-formula>, and set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e273" xlink:type="simple"/></inline-formula>. The parameter values for the networks are the same as those used in <xref ref-type="fig" rid="pone-0025190-g002">Fig. 2(b)</xref>.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.g004" xlink:type="simple"/>
          </fig>
          <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e274" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e275" xlink:type="simple"/></inline-formula> are negatively correlated because the amount of donation flow that a putative CD <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e276" xlink:type="simple"/></inline-formula> stops is strongly correlated with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e277" xlink:type="simple"/></inline-formula>. At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e278" xlink:type="simple"/></inline-formula>, it is equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e279" xlink:type="simple"/></inline-formula>. At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e280" xlink:type="simple"/></inline-formula>, it is generally smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e281" xlink:type="simple"/></inline-formula>, but player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e282" xlink:type="simple"/></inline-formula> having a large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e283" xlink:type="simple"/></inline-formula> value tends to receive a large inflow of donation, which player <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e284" xlink:type="simple"/></inline-formula> stops in the next time step. For undirected networks, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e285" xlink:type="simple"/></inline-formula> holds true. Players with small degrees are therefore tempted to convert to CD because the impact of the player's behavior (i.e., to donate or not to donate) on the entire network is small. Therefore, a small <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e286" xlink:type="simple"/></inline-formula> leads to a large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e287" xlink:type="simple"/></inline-formula>. Even for directed networks, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e288" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e289" xlink:type="simple"/></inline-formula> are often strongly correlated <xref ref-type="bibr" rid="pone.0025190-Fortunato1">[38]</xref>–<xref ref-type="bibr" rid="pone.0025190-Ghoshal1">[40]</xref>. Because the minimum degree in a scale-free network is smaller than that in a homogeneous network if the mean degree of the two networks is equal, scale-free networks have larger <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e290" xlink:type="simple"/></inline-formula> as compared to homogeneous networks.</p>
        </sec>
        <sec id="s2d4">
          <title>Cooperation in large networks</title>
          <p>A comparison of <xref ref-type="fig" rid="pone-0025190-g002">Figs. 2(a) and 2(b)</xref> suggests that a large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e291" xlink:type="simple"/></inline-formula> makes cooperation unlikely. To examine this point further, I set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e292" xlink:type="simple"/></inline-formula>, generated 100 networks for each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e293" xlink:type="simple"/></inline-formula> value and each network type, calculated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e294" xlink:type="simple"/></inline-formula>, and obtained the mean and the standard deviation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e295" xlink:type="simple"/></inline-formula>. Because the WS model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e296" xlink:type="simple"/></inline-formula> is unique for a given <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e297" xlink:type="simple"/></inline-formula>, the mean and standard deviation are not relevant in this network.</p>
          <p>The mean and standard deviation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e298" xlink:type="simple"/></inline-formula> for the five networks of various sizes are shown in <xref ref-type="fig" rid="pone-0025190-g003">Fig. 3(a)</xref>. The results for the BA and KE models heavily overlap. Cooperation is less likely as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e299" xlink:type="simple"/></inline-formula> increases in all models, except for the WS model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e300" xlink:type="simple"/></inline-formula>. This result is consistent with that for a directed cycle <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref>.</p>
          <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e301" xlink:type="simple"/></inline-formula> increases with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e302" xlink:type="simple"/></inline-formula> not entirely owing to the decreased level of clustering in the network. To show this, I plot the mean and standard deviation of the clustering coefficient <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e303" xlink:type="simple"/></inline-formula>, which quantifies the abundance of triangles in a network <xref ref-type="bibr" rid="pone.0025190-Watts1">[32]</xref>, in <xref ref-type="fig" rid="pone-0025190-g003">Fig. 3(b)</xref>. The clustering coefficient is defined as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e304" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pone-0025190-g003">Figure 3(b)</xref> indicates that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e305" xlink:type="simple"/></inline-formula> decreases with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e306" xlink:type="simple"/></inline-formula> for the RRG and the BA model. Therefore, the effect of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e307" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e308" xlink:type="simple"/></inline-formula> on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e309" xlink:type="simple"/></inline-formula> may be mixed in these two network models. However, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e310" xlink:type="simple"/></inline-formula> stays almost constant for the WS and KE models. At least for these models, an increase in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e311" xlink:type="simple"/></inline-formula> is considered to originate primarily from an increase in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e312" xlink:type="simple"/></inline-formula>, not from changes in the level of clustering.</p>
          <p>In <xref ref-type="fig" rid="pone-0025190-g003">Fig. 3(a)</xref>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e313" xlink:type="simple"/></inline-formula> seems to approach unity as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e314" xlink:type="simple"/></inline-formula> increases except for the WS model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e315" xlink:type="simple"/></inline-formula>. As previously stated, the WS model with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e316" xlink:type="simple"/></inline-formula> is unrealistic because it has a large average distance between pairs of nodes <xref ref-type="bibr" rid="pone.0025190-Albert1">[20]</xref>–<xref ref-type="bibr" rid="pone.0025190-Newman2">[22]</xref>, <xref ref-type="bibr" rid="pone.0025190-Watts1">[32]</xref>. Therefore, I conclude that cooperation based on upstream reciprocity is not likely for homogeneous and heterogeneous networks in general.</p>
        </sec>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>I generalized the upstream reciprocity model proposed for a directed cycle <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref> to general networks and reached two primary conclusions.</p>
      <p>First, cooperation based on upstream reciprocity is not likely in general networks regardless of the abundance of triangles and heterogeneity in the node degree. Because the networks that I examined are undirected, some amount of direct reciprocity is relevant; GC neighbors partially retaliate directly against a CD. My result that cooperation is unlikely for undirected networks implies that cooperation would be even more difficult for directed networks in which direct reciprocity is less available. In directed networks, direct reciprocity occurs only on reciprocal links between a pair of players.</p>
      <p>Second, I showed that scale-free network models allow less cooperation (i.e., large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e317" xlink:type="simple"/></inline-formula>) as compared to networks with homogeneous degree distributions. This result is opposite of those for two-person social dilemma games <xref ref-type="bibr" rid="pone.0025190-Santos1">[24]</xref>–<xref ref-type="bibr" rid="pone.0025190-Durn1">[27]</xref> and the upstream reciprocity game <xref ref-type="bibr" rid="pone.0025190-Iwagami1">[18]</xref>. The difference stems from the fact that the previous studies assumed evolutionary games and the present study (and the original model by Boyd and Richerson <xref ref-type="bibr" rid="pone.0025190-Boyd1">[13]</xref>) is based on nonevolutionary analysis.</p>
      <p>I adopted a nonevolutionary setup and examined the condition for the Nash equilibrium because the concept of the evolutionary game on heterogeneous networks seems elusive. Evolutionary games on heterogeneous networks imply that a player imitates the strategy of a successful neighbor that is likely to have a different node degree. However, players with different degrees are involved in essentially different games because the number of times that each player plays the game per generation necessarily depends on the degree. Therefore, for example, a small-degree player cannot generally expect a large payoff by mimicking a successful neighbor with a large degree. In this situation, defining the game and payoff for players with various degrees is complicated <xref ref-type="bibr" rid="pone.0025190-Santos3">[26]</xref>, <xref ref-type="bibr" rid="pone.0025190-Tomassini1">[28]</xref>, <xref ref-type="bibr" rid="pone.0025190-Masuda1">[29]</xref>. Use of the Nash criterion does not incur this type of problem.</p>
      <p>The overall conclusions of the present study are negative. To explain the occurrence of upstream reciprocity in real societies, it may be advantageous to combine upstream reciprocity with other non-network mechanisms, such as the ones mentioned in the <xref ref-type="sec" rid="s1">Introduction</xref>.</p>
    </sec>
    <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <sec id="s4a">
        <title>Numerical methods for calculating Eqs. (9) and (11)</title>
        <p>I determined <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e318" xlink:type="simple"/></inline-formula> by applying the bisection method to Eq. (9) or (11). To calculate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e319" xlink:type="simple"/></inline-formula> for different values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e320" xlink:type="simple"/></inline-formula>, it is beneficial to use the expansion of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e321" xlink:type="simple"/></inline-formula> in terms of independent modes. This is possible when the adjacency matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e322" xlink:type="simple"/></inline-formula> for the subnetwork composed of the GCs is diagonalizable, as shown below.</p>
        <p>I assume that there are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e323" xlink:type="simple"/></inline-formula> GCs and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e324" xlink:type="simple"/></inline-formula> CDs. In the main text, I focused on the case <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e325" xlink:type="simple"/></inline-formula>. However, the case <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e326" xlink:type="simple"/></inline-formula> is also relevant because I verified in the main text that the appearance of a single CD leads to the further emergence of CDs. Without loss of generality, I assume that players 1, 2, …, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e327" xlink:type="simple"/></inline-formula> are GC and players <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e328" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e329" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e330" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e331" xlink:type="simple"/></inline-formula> are CD, and that the network is strongly connected. We need to identify all the (generalized) eigenmodes of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e332" xlink:type="simple"/></inline-formula>, where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e333" xlink:type="simple"/><label>(16)</label></disp-formula>I first partition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e334" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e335" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e336" xlink:type="simple"/></inline-formula> into two-by-two blocks, each partition corresponding to the set of GC and that of CD. For a candidate of a left eigenvector of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e337" xlink:type="simple"/></inline-formula>, denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e338" xlink:type="simple"/></inline-formula>,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e339" xlink:type="simple"/><label>(17)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e340" xlink:type="simple"/></inline-formula> is the identity matrix of size <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e341" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e342" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e343" xlink:type="simple"/></inline-formula> are diagonal matrices whose diagonal entries are equal to the outdegrees of the GCs and CDs, respectively; <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e344" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e345" xlink:type="simple"/></inline-formula>-by-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e346" xlink:type="simple"/></inline-formula> matrix corresponding to the adjacent matrix within the GCs; and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e347" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e348" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e349" xlink:type="simple"/></inline-formula> are similarly defined blocks of the original adjacency matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e350" xlink:type="simple"/></inline-formula>. Note that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e351" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e352" xlink:type="simple"/></inline-formula> are absent on the right-hand side of Eq. (17) and as such are not relevant to the following discussion.</p>
        <p>First of all, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e353" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e354" xlink:type="simple"/></inline-formula>) is a trivial zero left eigenvector of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e355" xlink:type="simple"/></inline-formula>. Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e356" xlink:type="simple"/></inline-formula> denotes transpose, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e357" xlink:type="simple"/></inline-formula> is the unit column vector in which the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e358" xlink:type="simple"/></inline-formula>th element is equal to unity and all the other elements are equal to zero.</p>
        <p>To obtain the other <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e359" xlink:type="simple"/></inline-formula> generalized eigenmodes of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e360" xlink:type="simple"/></inline-formula>, I consider the case in which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e361" xlink:type="simple"/></inline-formula> is diagonalizable. Otherwise, efficiently calculating <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e362" xlink:type="simple"/></inline-formula> via matrix decomposition is difficult. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e363" xlink:type="simple"/></inline-formula> is diagonalizable if the network is undirected. A diagonalizable <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e364" xlink:type="simple"/></inline-formula> possesses <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e365" xlink:type="simple"/></inline-formula> nondegenerate left eigenvector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e366" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e367" xlink:type="simple"/></inline-formula>) with the corresponding eigenvalue <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e368" xlink:type="simple"/></inline-formula>. It is possible that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e369" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e370" xlink:type="simple"/></inline-formula>.</p>
        <p>If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e371" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e372" xlink:type="simple"/></inline-formula> is an eigenvalue of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e373" xlink:type="simple"/></inline-formula>, and the corresponding left eigenvector is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e374" xlink:type="simple"/></inline-formula>, where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e375" xlink:type="simple"/><label>(18)</label></disp-formula></p>
        <p>If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e376" xlink:type="simple"/></inline-formula>, Eq. (17) implies that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e377" xlink:type="simple"/></inline-formula> is not a left eigenvector of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e378" xlink:type="simple"/></inline-formula>. An example network with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e379" xlink:type="simple"/></inline-formula> that has nontrivial zero eigenvalues is presented in the next section for a pedagogical purpose. When <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e380" xlink:type="simple"/></inline-formula>, I set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e381" xlink:type="simple"/></inline-formula> such that<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e382" xlink:type="simple"/><label>(19)</label></disp-formula>Because <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e383" xlink:type="simple"/></inline-formula> can be represented as a linear sum of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e384" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e385" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e386" xlink:type="simple"/></inline-formula> is a type of generalized eigenvector corresponding to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e387" xlink:type="simple"/></inline-formula>.</p>
        <p>I denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e388" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e389" xlink:type="simple"/></inline-formula>) the nontrivial generalized right eigenmodes of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e390" xlink:type="simple"/></inline-formula> corresponding to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e391" xlink:type="simple"/></inline-formula>. To obtain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e392" xlink:type="simple"/></inline-formula>, I denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e393" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e394" xlink:type="simple"/></inline-formula>) the normalized right eigenvectors of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e395" xlink:type="simple"/></inline-formula> with eigenvalue <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e396" xlink:type="simple"/></inline-formula>. Then,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e397" xlink:type="simple"/><label>(20)</label></disp-formula>are right eigenvectors of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e398" xlink:type="simple"/></inline-formula> that respect the orthogonality <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e399" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e400" xlink:type="simple"/></inline-formula> is the Kronecker delta.</p>
        <p>For completeness, I obtain the expression of the other <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e401" xlink:type="simple"/></inline-formula> right eigenvectors of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e402" xlink:type="simple"/></inline-formula> corresponding to the trivial zero eigenvalue as follows. I align <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e403" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e404" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e405" xlink:type="simple"/></inline-formula>) such that nonzero eigenvectors correspond to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e406" xlink:type="simple"/></inline-formula> and generalized zero eigenmodes correspond to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e407" xlink:type="simple"/></inline-formula>. Then, the orthogonality condition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e408" xlink:type="simple"/></inline-formula> reads<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e409" xlink:type="simple"/><label>(21)</label></disp-formula>for an <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e410" xlink:type="simple"/></inline-formula>-by-<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e411" xlink:type="simple"/></inline-formula> matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e412" xlink:type="simple"/></inline-formula>. Equation (21) yields<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e413" xlink:type="simple"/><label>(22)</label></disp-formula></p>
        <p>Finally, the decomposition of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e414" xlink:type="simple"/></inline-formula> is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e415" xlink:type="simple"/><label>(23)</label></disp-formula>Combining Eq. (23) and the orthogonality condition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e416" xlink:type="simple"/></inline-formula>, I obtain<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e417" xlink:type="simple"/><label>(24)</label></disp-formula></p>
        <p>Using Eqs. (16), (23), and (24), we can express the quantities appearing on the left-hand sides of Eqs. (9) and (11) as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e418" xlink:type="simple"/><label>(25)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e419" xlink:type="simple"/><label>(26)</label></disp-formula></p>
        <p>If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e420" xlink:type="simple"/></inline-formula> is symmetric, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e421" xlink:type="simple"/></inline-formula> is also symmetric and therefore diagonalizable by a unitary matrix. Denote the eigenvalue and the right eigenvector of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e422" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e423" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e424" xlink:type="simple"/></inline-formula>, respectively. Note that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e425" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e426" xlink:type="simple"/></inline-formula> are both real and can be computed relatively easily. Then, we can obtain the relationships <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e427" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e428" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e429" xlink:type="simple"/></inline-formula>. We can also obtain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e430" xlink:type="simple"/></inline-formula> when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e431" xlink:type="simple"/></inline-formula>.</p>
      </sec>
      <sec id="s4b">
        <title>Example network yielding nontrivial zero eigenmodes</title>
        <p>Consider the undirected network having <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e432" xlink:type="simple"/></inline-formula> nodes as shown in <xref ref-type="fig" rid="pone-0025190-g005">Fig. 5</xref>. For this network I obtain<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e433" xlink:type="simple"/><label>(27)</label></disp-formula>By turning player 3 from GC to CD, I obtain<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.e434" xlink:type="simple"/><label>(28)</label></disp-formula>All of the eigenvalues of matrix (28) are equal to zero, one trivial and two nontrivial. The one trivial zero eigenvalue originates from removing player 3 from the network of GCs. The trivial zero left eigenvector is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e435" xlink:type="simple"/></inline-formula>. I select the two generalized zero left eigenmodes to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e436" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e437" xlink:type="simple"/></inline-formula>). The choice of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e438" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e439" xlink:type="simple"/></inline-formula> is not unique. The right eigenmodes are given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e440" xlink:type="simple"/></inline-formula>.</p>
        <fig id="pone-0025190-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0025190.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>A network yielding nontrivial zero eigenvalues.</title>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025190.g005" xlink:type="simple"/>
        </fig>
        <p>Equation (19), for example, then reads <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e441" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025190.e442" xlink:type="simple"/></inline-formula>.</p>
      </sec>
    </sec>
  </body>
  <back>
    <ack>
      <p>I thank Hisashi Ohtsuki and Kazuo Murota for the helpful discussions.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pone.0025190-Nowak1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>MA</given-names></name><name name-style="western"><surname>Sigmund</surname><given-names>K</given-names></name></person-group>             <year>2005</year>             <article-title>Evolution of indirect reciprocity.</article-title>             <source>Nature</source>             <volume>437</volume>             <fpage>1291</fpage>             <lpage>1298</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Sigmund1">
        <label>2</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sigmund</surname><given-names>K</given-names></name></person-group>             <year>2010</year>             <source>The Calculus of Selfishness</source>             <publisher-loc>Princeton, NJ</publisher-loc>             <publisher-name>Princeton University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025190-Dufwenberg1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dufwenberg</surname><given-names>M</given-names></name><name name-style="western"><surname>Gneezy</surname><given-names>U</given-names></name><name name-style="western"><surname>Güth</surname><given-names>W</given-names></name><name name-style="western"><surname>van Damme</surname><given-names>E</given-names></name></person-group>             <year>2001</year>             <article-title>Direct vs indirect reciprocity: an experiment.</article-title>             <source>Homo Oecono</source>             <volume>18</volume>             <fpage>19</fpage>             <lpage>30</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Greiner1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Greiner</surname><given-names>B</given-names></name><name name-style="western"><surname>Levati</surname><given-names>MV</given-names></name></person-group>             <year>2005</year>             <article-title>Indirect reciprocity in cyclical networks—an experimental study.</article-title>             <source>J Econ Psych</source>             <volume>26</volume>             <fpage>711</fpage>             <lpage>731</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Stanca1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stanca</surname><given-names>L</given-names></name></person-group>             <year>2009</year>             <article-title>Measuring indirect reciprocity: whose back do we scratch?</article-title>             <source>J Econ Psych</source>             <volume>30</volume>             <fpage>190</fpage>             <lpage>202</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Bartlett1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bartlett</surname><given-names>MY</given-names></name><name name-style="western"><surname>DeSteno</surname><given-names>D</given-names></name></person-group>             <year>2006</year>             <article-title>Gratitude and prosocial behavior.</article-title>             <source>Psych Sci</source>             <volume>17</volume>             <fpage>319</fpage>             <lpage>325</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Rutte1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rutte</surname><given-names>C</given-names></name><name name-style="western"><surname>Taborsky</surname><given-names>M</given-names></name></person-group>             <year>2007</year>             <article-title>Generalized reciprocity in rats.</article-title>             <source>Plos Biol</source>             <volume>5</volume>             <fpage>e196</fpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Yamagishi1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yamagishi</surname><given-names>T</given-names></name><name name-style="western"><surname>Cook</surname><given-names>KS</given-names></name></person-group>             <year>1993</year>             <article-title>Generalized exchange and social dilemmas.</article-title>             <source>Social Psychology Quarterly</source>             <volume>56</volume>             <fpage>235</fpage>             <lpage>248</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Molm1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Molm</surname><given-names>LD</given-names></name><name name-style="western"><surname>Collett</surname><given-names>JL</given-names></name><name name-style="western"><surname>Schaefer</surname><given-names>DR</given-names></name></person-group>             <year>2007</year>             <article-title>Building solidarity through generalized exchange: a theory of reciprocity.</article-title>             <source>Am J Sociol</source>             <volume>113</volume>             <fpage>205</fpage>             <lpage>242</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Malinowski1">
        <label>10</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Malinowski</surname><given-names>B</given-names></name></person-group>             <year>1922</year>             <source>Argonauts of the Western Pacific</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>E. P. Dutton</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025190-Ziegler1">
        <label>11</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ziegler</surname><given-names>R</given-names></name></person-group>             <year>1990</year>             <article-title>The kula: social order, barter, and ceremonial exchange.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Hechter</surname><given-names>M</given-names></name><name name-style="western"><surname>Opp</surname><given-names>KD</given-names></name><name name-style="western"><surname>Wippler</surname><given-names>R</given-names></name></person-group>             <source>Social Institutions: Their Emergence, Maintenance, and Effects</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Aldine de Gruyter</publisher-name>             <fpage>141</fpage>             <lpage>170</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Barta1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Barta</surname><given-names>Z</given-names></name><name name-style="western"><surname>McNamara</surname><given-names>JM</given-names></name><name name-style="western"><surname>Huszár</surname><given-names>DB</given-names></name><name name-style="western"><surname>Taborsky</surname><given-names>M</given-names></name></person-group>             <year>2011</year>             <article-title>Cooperation among non-relatives evolves by state-dependent generalized reciprocity.</article-title>             <source>Proc R Soc B</source>             <volume>278</volume>             <fpage>843</fpage>             <lpage>848</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Boyd1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Boyd</surname><given-names>R</given-names></name><name name-style="western"><surname>Richerson</surname><given-names>PJ</given-names></name></person-group>             <year>1989</year>             <article-title>The evolution of indirect reciprocity.</article-title>             <source>Soc Netw</source>             <volume>11</volume>             <fpage>213</fpage>             <lpage>236</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Pfeiffer1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pfeiffer</surname><given-names>T</given-names></name><name name-style="western"><surname>Rutte</surname><given-names>C</given-names></name><name name-style="western"><surname>Killingback</surname><given-names>T</given-names></name><name name-style="western"><surname>Taborsky</surname><given-names>M</given-names></name><name name-style="western"><surname>Bonhoeffer</surname><given-names>S</given-names></name></person-group>             <year>2005</year>             <article-title>Evolution of cooperation by generalized reciprocity.</article-title>             <source>Proc R Soc B</source>             <volume>272</volume>             <fpage>1115</fpage>             <lpage>1120</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Nowak2">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>MA</given-names></name><name name-style="western"><surname>Roch</surname><given-names>S</given-names></name></person-group>             <year>2007</year>             <article-title>Upstream reciprocity and the evolution of gratitude.</article-title>             <source>Proc R Soc Lond B</source>             <volume>274</volume>             <fpage>605</fpage>             <lpage>610</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Hamilton1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hamilton</surname><given-names>IM</given-names></name><name name-style="western"><surname>Taborsky</surname><given-names>M</given-names></name></person-group>             <year>2005</year>             <article-title>Contingent movement and cooperation evolve under generalized reciprocity.</article-title>             <source>Proc R Soc B</source>             <volume>272</volume>             <fpage>2259</fpage>             <lpage>2267</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Rankin1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rankin</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Taborsky</surname><given-names>M</given-names></name></person-group>             <year>2009</year>             <article-title>Assortment and the evolution of generalized reciprocity.</article-title>             <source>Evolution</source>             <volume>63</volume>             <fpage>1913</fpage>             <lpage>1922</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Iwagami1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Iwagami</surname><given-names>A</given-names></name><name name-style="western"><surname>Masuda</surname><given-names>N</given-names></name></person-group>             <year>2010</year>             <article-title>Upstream reciprocity in heterogeneous networks.</article-title>             <source>J Theor Biol</source>             <volume>265</volume>             <fpage>297</fpage>             <lpage>305</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Wasserman1">
        <label>19</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wasserman</surname><given-names>S</given-names></name><name name-style="western"><surname>Faust</surname><given-names>K</given-names></name></person-group>             <year>1994</year>             <source>Social network analysis</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025190-Albert1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Albert</surname><given-names>R</given-names></name><name name-style="western"><surname>Barabási</surname><given-names>AL</given-names></name></person-group>             <year>2002</year>             <article-title>Statistical mechanics of complex networks.</article-title>             <source>Rev Mod Phys</source>             <volume>74</volume>             <fpage>47</fpage>             <lpage>97</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Newman1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Newman</surname><given-names>MEJ</given-names></name></person-group>             <year>2003</year>             <article-title>The structure and function of complex networks.</article-title>             <source>SIAM Rev</source>             <volume>45</volume>             <fpage>167</fpage>             <lpage>256</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Newman2">
        <label>22</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Newman</surname><given-names>MEJ</given-names></name></person-group>             <year>2010</year>             <source>Networks — An introduction</source>             <publisher-loc>Oxford</publisher-loc>             <publisher-name>Oxford University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025190-Nowak3">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>MA</given-names></name><name name-style="western"><surname>May</surname><given-names>RM</given-names></name></person-group>             <year>1992</year>             <article-title>Evolutionary games and spatial chaos.</article-title>             <source>Nature</source>             <volume>359</volume>             <fpage>826</fpage>             <lpage>829</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Santos1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Santos</surname><given-names>FC</given-names></name><name name-style="western"><surname>Pacheco</surname><given-names>JM</given-names></name></person-group>             <year>2005</year>             <article-title>Scale-free networks provide a unifying framework for the emergence of cooperation.</article-title>             <source>Phys Rev Lett</source>             <volume>95</volume>             <fpage>098104</fpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Santos2">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Santos</surname><given-names>FC</given-names></name><name name-style="western"><surname>Pacheco</surname><given-names>JM</given-names></name><name name-style="western"><surname>Lenaerts</surname><given-names>T</given-names></name></person-group>             <year>2006</year>             <article-title>Evolutionary dynamics of social dilemmas in structured heterogeneous populations.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>103</volume>             <fpage>3490</fpage>             <lpage>3494</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Santos3">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Santos</surname><given-names>FC</given-names></name><name name-style="western"><surname>Pacheco</surname><given-names>JM</given-names></name></person-group>             <year>2006</year>             <article-title>A new route to the evolution of cooperation.</article-title>             <source>J Evol Biol</source>             <volume>19</volume>             <fpage>726</fpage>             <lpage>733</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Durn1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Durán</surname><given-names>O</given-names></name><name name-style="western"><surname>Mulet</surname><given-names>R</given-names></name></person-group>             <year>2005</year>             <article-title>Evolutionary prisoner's dilemma in random graphs.</article-title>             <source>Physica D</source>             <volume>208</volume>             <fpage>257</fpage>             <lpage>265</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Tomassini1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tomassini</surname><given-names>M</given-names></name><name name-style="western"><surname>Pestelacci</surname><given-names>E</given-names></name><name name-style="western"><surname>Luthi</surname><given-names>L</given-names></name></person-group>             <year>2007</year>             <article-title>Social dilemmas and cooperation in complex networks.</article-title>             <source>Int J Mod Phys C</source>             <volume>18</volume>             <fpage>1173</fpage>             <lpage>1185</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Masuda1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Masuda</surname><given-names>N</given-names></name></person-group>             <year>2007</year>             <article-title>Participation costs dismiss the advantage of heterogeneous networks in evolution of cooperation.</article-title>             <source>Proc R Soc Lond B</source>             <volume>274</volume>             <fpage>1815</fpage>             <lpage>1821</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Trivers1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Trivers</surname><given-names>RL</given-names></name></person-group>             <year>1971</year>             <article-title>The evolution of reciprocal altruism.</article-title>             <source>Q Rev Biol</source>             <volume>46</volume>             <fpage>35</fpage>             <lpage>57</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Axelrod1">
        <label>31</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Axelrod</surname><given-names>R</given-names></name></person-group>             <year>1984</year>             <source>Evolution of Cooperation</source>             <publisher-loc>NY</publisher-loc>             <publisher-name>Basic Books</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025190-Watts1">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Watts</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Strogatz</surname><given-names>SH</given-names></name></person-group>             <year>1998</year>             <article-title>Collective dynamics of ‘small-world’ networks.</article-title>             <source>Nature</source>             <volume>393</volume>             <fpage>440</fpage>             <lpage>442</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Barabsi1">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Barabási</surname><given-names>AL</given-names></name><name name-style="western"><surname>Albert</surname><given-names>R</given-names></name></person-group>             <year>1999</year>             <article-title>Emergence of scaling in random networks.</article-title>             <source>Science</source>             <volume>286</volume>             <fpage>509</fpage>             <lpage>512</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Klemm1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Klemm</surname><given-names>K</given-names></name><name name-style="western"><surname>Eguíluz</surname><given-names>VM</given-names></name></person-group>             <year>2002</year>             <article-title>Highly clustered scale-free networks.</article-title>             <source>Phys Rev E</source>             <volume>65</volume>             <fpage>036123</fpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Klemm2">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Klemm</surname><given-names>K</given-names></name><name name-style="western"><surname>Eguíluz</surname><given-names>VM</given-names></name></person-group>             <year>2002</year>             <article-title>Growing scale-free networks with small-world behavior.</article-title>             <source>Phys Rev E</source>             <volume>65</volume>             <fpage>057102</fpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Motter1">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Motter</surname><given-names>AE</given-names></name><name name-style="western"><surname>Lai</surname><given-names>YC</given-names></name></person-group>             <year>2002</year>             <article-title>Cascade-based attacks on complex networks.</article-title>             <source>Phys Rev E</source>             <volume>66</volume>             <fpage>065102</fpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Nowak4">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>MA</given-names></name></person-group>             <year>2006</year>             <article-title>Five rules for the evolution of cooperation.</article-title>             <source>Science</source>             <volume>314</volume>             <fpage>1560</fpage>             <lpage>1563</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Fortunato1">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fortunato</surname><given-names>S</given-names></name><name name-style="western"><surname>Boguñá</surname><given-names>M</given-names></name><name name-style="western"><surname>Flammini</surname><given-names>A</given-names></name><name name-style="western"><surname>Menczer</surname><given-names>F</given-names></name></person-group>             <year>2006</year>             <article-title>How to make the top ten: approximating pagerank from in-degree.</article-title>             <source>Proc 4th Workshop on Algorithms and Models for the Web Graph (WAW 2006)</source>             <fpage>59</fpage>             <lpage>71</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Masuda2">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Masuda</surname><given-names>N</given-names></name><name name-style="western"><surname>Kawamura</surname><given-names>Y</given-names></name><name name-style="western"><surname>Kori</surname><given-names>H</given-names></name></person-group>             <year>2009</year>             <article-title>Impact of hierarchical modular structure on ranking of individual nodes in directed networks.</article-title>             <source>New J Phys</source>             <volume>11</volume>             <fpage>113002</fpage>          </element-citation>
      </ref>
      <ref id="pone.0025190-Ghoshal1">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ghoshal</surname><given-names>G</given-names></name><name name-style="western"><surname>Barabási</surname><given-names>AL</given-names></name></person-group>             <year>2011</year>             <article-title>Ranking stability and super-stable nodes in complex networks.</article-title>             <source>Nat Comm</source>             <volume>2</volume>             <fpage>394</fpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>