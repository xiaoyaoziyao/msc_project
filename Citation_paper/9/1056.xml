<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-16-02793</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0162259</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Neurology</subject><subj-group><subject>Neurodegenerative diseases</subject><subj-group><subject>Movement disorders</subject><subj-group><subject>Parkinson disease</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Geometry</subject><subj-group><subject>Radii</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Myoclonus</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Myoclonus</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Clustering algorithms</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Clustering algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical data</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Head</subject><subj-group><subject>Eyes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Head</subject><subj-group><subject>Eyes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Ocular system</subject><subj-group><subject>Eyes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Ocular system</subject><subj-group><subject>Eyes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>What to Do When <italic>K</italic>-Means Clustering Fails: A Simple yet Principled Alternative Algorithm</article-title>
<alt-title alt-title-type="running-head">MAP-DP: <italic>K</italic>-Means Alternative</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Raykov</surname> <given-names>Yordan P.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Boukouvalas</surname> <given-names>Alexis</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Baig</surname> <given-names>Fahd</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Little</surname> <given-names>Max A.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>School of Mathematics, Aston University, Birmingham, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Molecular Sciences, University of Manchester, Manchester, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Nuffield Department of Clinical Neurosciences, Oxford University, Oxford, United Kingdom</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Media Lab, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Yoon</surname> <given-names>Byung-Jun</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Texas A&amp;M University College Station, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple">
<list-item><p><bold>Conceptualization:</bold> YR AB ML.</p></list-item>
<list-item><p><bold>Data curation:</bold> YR.</p></list-item>
<list-item><p><bold>Formal analysis:</bold> YR AB FB.</p></list-item>
<list-item><p><bold>Funding acquisition:</bold> ML.</p></list-item>
<list-item><p><bold>Investigation:</bold> YR AB.</p></list-item>
<list-item><p><bold>Methodology:</bold> YR AB ML.</p></list-item>
<list-item><p><bold>Project administration:</bold> ML.</p></list-item>
<list-item><p><bold>Resources:</bold> ML.</p></list-item>
<list-item><p><bold>Software:</bold> YR AB ML.</p></list-item>
<list-item><p><bold>Supervision:</bold> ML.</p></list-item>
<list-item><p><bold>Validation:</bold> YR AB.</p></list-item>
<list-item><p><bold>Visualization:</bold> YR.</p></list-item>
<list-item><p><bold>Writing – original draft:</bold> YR AB.</p></list-item>
<list-item><p><bold>Writing – review &amp; editing:</bold> YR AB FB ML.</p></list-item>
</list></p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">yordan.raykov@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>26</day>
<month>9</month>
<year>2016</year>
</pub-date>
<volume>11</volume>
<issue>9</issue>
<elocation-id>e0162259</elocation-id>
<history>
<date date-type="received">
<day>21</day>
<month>1</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>8</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Raykov et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0162259"/>
<abstract>
<p>The <italic>K</italic>-means algorithm is one of the most popular clustering algorithms in current use as it is relatively fast yet simple to understand and deploy in practice. Nevertheless, its use entails certain restrictive assumptions about the data, the negative consequences of which are not always immediately apparent, as we demonstrate. While more flexible algorithms have been developed, their widespread use has been hindered by their computational and technical complexity. Motivated by these considerations, we present a flexible alternative to <italic>K</italic>-means that relaxes most of the assumptions, whilst remaining almost as fast and simple. This novel algorithm which we call MAP-DP (<italic>maximum a-posteriori Dirichlet process mixtures</italic>), is statistically rigorous as it is based on nonparametric Bayesian Dirichlet process mixture modeling. This approach allows us to overcome most of the limitations imposed by <italic>K</italic>-means. The number of clusters <italic>K</italic> is estimated from the data instead of being fixed <italic>a-priori</italic> as in <italic>K</italic>-means. In addition, while <italic>K</italic>-means is restricted to continuous data, the MAP-DP framework can be applied to many kinds of data, for example, binary, count or ordinal data. Also, it can efficiently separate outliers from the data. This additional flexibility does not incur a significant computational overhead compared to <italic>K</italic>-means with MAP-DP convergence typically achieved in the order of seconds for many practical problems. Finally, in contrast to <italic>K</italic>-means, since the algorithm is based on an underlying statistical model, the MAP-DP framework can deal with missing data and enables model testing such as cross validation in a principled way. We demonstrate the simplicity and effectiveness of this algorithm on the health informatics problem of clinical sub-typing in a cluster of diseases known as parkinsonism.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Aston research centre for healthy ageing</institution>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Boukouvalas</surname> <given-names>Alexis</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Little</surname> <given-names>Max A.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by Aston research centre for healthy ageing and National Institutes of Health. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="6"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Analyzed data has been collected from PD-DOC organizing centre which has now closed down. Researchers would need to contact Rochester University in order to access the database. For more information about the PD-DOC data, please contact: Karl D. Kieburtz, M.D., M.P.H. (<ext-link ext-link-type="uri" xlink:href="https://www.urmc.rochester.edu/people/20120238-karl-d-kieburtz" xlink:type="simple">https://www.urmc.rochester.edu/people/20120238-karl-d-kieburtz</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>1 Introduction</title>
<p>The rapid increase in the capability of automatic data acquisition and storage is providing a striking potential for innovation in science and technology. However, extracting meaningful information from complex, ever-growing data sources poses new challenges. This motivates the development of automated ways to discover underlying structure in data. The key information of interest is often obscured behind redundancy and noise, and grouping the data into clusters with similar features is one way of efficiently summarizing the data for further analysis [<xref ref-type="bibr" rid="pone.0162259.ref001">1</xref>]. Cluster analysis has been used in many fields [<xref ref-type="bibr" rid="pone.0162259.ref001">1</xref>, <xref ref-type="bibr" rid="pone.0162259.ref002">2</xref>], such as information retrieval [<xref ref-type="bibr" rid="pone.0162259.ref003">3</xref>], social media analysis [<xref ref-type="bibr" rid="pone.0162259.ref004">4</xref>], neuroscience [<xref ref-type="bibr" rid="pone.0162259.ref005">5</xref>], image processing [<xref ref-type="bibr" rid="pone.0162259.ref006">6</xref>], text analysis [<xref ref-type="bibr" rid="pone.0162259.ref007">7</xref>] and bioinformatics [<xref ref-type="bibr" rid="pone.0162259.ref008">8</xref>].</p>
<p>Despite the large variety of flexible models and algorithms for clustering available, <italic>K</italic>-means remains the preferred tool for most real world applications [<xref ref-type="bibr" rid="pone.0162259.ref009">9</xref>]. <italic>K</italic>-means was first introduced as a method for <italic>vector quantization</italic> in communication technology applications [<xref ref-type="bibr" rid="pone.0162259.ref010">10</xref>], yet it is still one of the most widely-used clustering algorithms. For example, in discovering <italic>sub-types</italic> of parkinsonism, we observe that most studies have used <italic>K</italic>-means algorithm to find sub-types in patient data [<xref ref-type="bibr" rid="pone.0162259.ref011">11</xref>]. It is also the preferred choice in the <italic>visual bag of words</italic> models in automated image understanding [<xref ref-type="bibr" rid="pone.0162259.ref012">12</xref>]. Perhaps the major reasons for the popularity of <italic>K</italic>-means are <italic>conceptual simplicity</italic> and <italic>computational scalability</italic>, in contrast to more flexible clustering methods. Bayesian probabilistic models, for instance, require complex <italic>sampling schedules</italic> or <italic>variational inference</italic> algorithms that can be difficult to implement and understand, and are often not computationally tractable for large data sets.</p>
<p>For the ensuing discussion, we will use the following mathematical notation to describe <italic>K</italic>-means clustering, and then also to introduce our novel clustering algorithm. Let us denote the data as <italic>X</italic> = (<italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>N</italic></sub>) where each of the <italic>N</italic> data points <italic>x</italic><sub><italic>i</italic></sub> is a <italic>D</italic>-dimensional vector. We will denote the <italic>cluster assignment</italic> associated to each data point by <italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub>, where if data point <italic>x</italic><sub><italic>i</italic></sub> belongs to cluster <italic>k</italic> we write <italic>z</italic><sub><italic>i</italic></sub> = <italic>k</italic>. The number of observations assigned to cluster <italic>k</italic>, for <italic>k</italic> ∈ 1, …, <italic>K</italic>, is <italic>N</italic><sub><italic>k</italic></sub> and <inline-formula id="pone.0162259.e001"><alternatives><graphic id="pone.0162259.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the number of points assigned to cluster <italic>k</italic> excluding point <italic>i</italic>. The parameter <italic>ϵ</italic> &gt; 0 is a small threshold value to assess when the algorithm has converged on a good solution and should be stopped (typically <italic>ϵ</italic> = 10<sup>−6</sup>). Using this notation, <italic>K</italic>-means can be written as in Algorithm 1.</p>
<p>To paraphrase this algorithm: it alternates between updating the assignments of data points to clusters while holding the estimated cluster <italic>centroids</italic>, <italic>μ</italic><sub><italic>k</italic></sub>, fixed (lines 5-11), and updating the cluster centroids while holding the assignments fixed (lines 14-15). It can be shown to find <italic>some</italic> minimum (not necessarily the <italic>global</italic>, i.e. smallest of all possible minima) of the following <italic>objective function</italic>:
<disp-formula id="pone.0162259.e014"><alternatives><graphic id="pone.0162259.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:mi>E</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>:</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:munder> <mml:mo>|</mml:mo><mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow>
</mml:math></alternatives> <label>(1)</label></disp-formula>
with respect to the set of all cluster assignments <italic>z</italic> and cluster centroids <italic>μ</italic>, where <inline-formula id="pone.0162259.e015"><alternatives><graphic id="pone.0162259.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mo>.</mml:mo> <mml:mo>|</mml:mo> <mml:msubsup><mml:mo>|</mml:mo> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></inline-formula> denotes the <italic>Euclidean distance</italic> (distance measured as the sum of the square of differences of coordinates in each direction). In fact, the value of <italic>E</italic> <italic>cannot increase</italic> on each iteration, so, eventually <italic>E</italic> will stop changing (tested on line 17).</p>
<p>Perhaps unsurprisingly, the simplicity and computational scalability of <italic>K</italic>-means comes at a high cost. In particular, the algorithm is based on quite restrictive assumptions about the data, often leading to severe limitations in accuracy and interpretability:</p>
<table-wrap id="pone.0162259.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.t001</object-id>
<label>Table 1</label>
<caption>
<title/>
</caption>
<alternatives>
<graphic id="pone.0162259.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="left">Algorithm 1: <italic>K</italic>-means</th>
<th align="center"/>
<th align="left">Algorithm 2: MAP-DP(spherical Gaussian)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>Input</bold></td>
<td align="left"><italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>N</italic></sub>: <italic>D</italic>-dimensional data<break/> <italic>ϵ</italic> &gt; 0: convergence threshold<break/> <italic>K</italic>: number of clusters</td>
<td align="center"/>
<td align="left"><italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>N</italic></sub>: <italic>D</italic>-dimensional data<break/> <italic>ϵ</italic> &gt; 0: convergence threshold<break/> <italic>N</italic><sub>0</sub>: prior count<break/> <inline-formula id="pone.0162259.e002"><alternatives><graphic id="pone.0162259.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>: spherical cluster variance<break/> <inline-formula id="pone.0162259.e003"><alternatives><graphic id="pone.0162259.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>: prior centroid variance<break/> <italic>μ</italic><sub>0</sub>: prior centroid location</td>
</tr>
<tr>
<td align="left"><bold>Output</bold></td>
<td align="left"><italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub>: cluster assignments<break/> <italic>μ</italic><sub>1</sub>, …, <italic>μ</italic><sub><italic>K</italic></sub>: cluster centroids</td>
<td align="left"/>
<td align="left"><italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub>: cluster assignments<break/> <italic>K</italic>: number of clusters</td>
</tr>
<tr>
<td align="right"><bold>1</bold></td>
<td align="left">Set <italic>μ</italic><sub><italic>k</italic></sub> for all <italic>k</italic> ∈ 1, …, <italic>K</italic></td>
<td align="left"><bold>1</bold></td>
<td align="left"><italic>K</italic> = 1, <italic>z</italic><sub><italic>i</italic></sub> = 1 for all <italic>i</italic> ∈ 1, …, <italic>N</italic></td>
</tr>
<tr>
<td align="right"><bold>2</bold></td>
<td align="left"><italic>E</italic><sub>new</sub> = ∞</td>
<td align="left"><bold>2</bold></td>
<td align="left"><italic>E</italic><sub>new</sub> = ∞</td>
</tr>
<tr>
<td align="right"><bold>3</bold></td>
<td align="left"><bold>repeat</bold></td>
<td align="left"><bold>3</bold></td>
<td align="left"><bold>repeat</bold></td>
</tr>
<tr>
<td align="right"><bold>4</bold></td>
<td align="left"> <italic>E</italic><sub>old</sub> = <italic>E</italic><sub>new</sub></td>
<td align="left"><bold>4</bold></td>
<td align="left"> <italic>E</italic><sub>old</sub> = <italic>E</italic><sub>new</sub></td>
</tr>
<tr>
<td align="right"><bold>5</bold></td>
<td align="left"> <bold>for</bold> <italic>i</italic> ∈ 1, …, <italic>N</italic></td>
<td align="left"><bold>5</bold></td>
<td align="left"> <bold>for</bold> <italic>i</italic> ∈ 1, …, <italic>N</italic></td>
</tr>
<tr>
<td align="right"><bold>6</bold></td>
<td align="left">  <bold>for</bold> <italic>k</italic> ∈ 1, …, <italic>K</italic></td>
<td align="left"><bold>6</bold></td>
<td align="left">  <bold>for</bold> <italic>k</italic> ∈ 1, …, <italic>K</italic></td>
</tr>
<tr>
<td align="right"><bold>7</bold></td>
<td align="left"/>
<td align="left"><bold>7</bold></td>
<td align="left">   
<inline-formula id="pone.0162259.e004">
<alternatives>
<graphic id="pone.0162259.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e004" xlink:type="simple"/>
<mml:math display="inline" id="M4">
<mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msubsup><mml:mi>N</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="right"><bold>8</bold></td>
<td align="left"/>
<td align="left"><bold>8</bold></td>
<td align="left">   
<inline-formula id="pone.0162259.e005">
<alternatives>
<graphic id="pone.0162259.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e005" xlink:type="simple"/>
<mml:math display="inline" id="M5">
<mml:mrow>
<mml:msubsup>
<mml:mi>μ</mml:mi>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mi>σ</mml:mi>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:msubsup>
<mml:mi>σ</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msubsup>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:msup>
<mml:mover accent="true">
<mml:mi>σ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mfrac>
<mml:msub>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi>
<mml:mo>:</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
<mml:mo>≠</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="right"><bold>9</bold></td>
<td align="left">   
<inline-formula id="pone.0162259.e006">
<alternatives>
<graphic id="pone.0162259.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e006" xlink:type="simple"/>
<mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mo>|</mml:mo> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left"><bold>9</bold></td>
<td align="left">   
<inline-formula id="pone.0162259.e007">
<alternatives>
<graphic id="pone.0162259.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e007" xlink:type="simple"/>
<mml:math display="inline" id="M7">
<mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mo>|</mml:mo> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>D</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mtext>ln</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="right"><bold>10</bold></td>
<td align="left"/>
<td align="left"><bold>10</bold></td>
<td align="left">  
<inline-formula id="pone.0162259.e008">
<alternatives>
<graphic id="pone.0162259.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e008" xlink:type="simple"/>
<mml:math display="inline" id="M8">
<mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mo>|</mml:mo> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>D</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mtext>ln</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="right"><bold>11</bold></td>
<td align="left">  
<inline-formula id="pone.0162259.e009">
<alternatives>
<graphic id="pone.0162259.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e009" xlink:type="simple"/>
<mml:math display="inline" id="M9">
<mml:mrow>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mo form="prefix">arg min</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>∈</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>,</mml:mo><mml:mo>…</mml:mo>
<mml:mo>,</mml:mo>
<mml:mi>K</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>d</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left"><bold>11</bold></td>
<td align="left">  
<inline-formula id="pone.0162259.e010">
<alternatives>
<graphic id="pone.0162259.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e010" xlink:type="simple"/>
<mml:math display="inline" id="M10">
<mml:mrow>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mo form="prefix">arg min</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>∈</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>,</mml:mo><mml:mo>…</mml:mo>
<mml:mo>,</mml:mo>
<mml:mi>K</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>[</mml:mo>
<mml:msub>
<mml:mi>d</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:mtext>ln</mml:mtext>
<mml:msubsup>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="right"><bold>12</bold></td>
<td align="left"/>
<td align="left"><bold>12</bold></td>
<td align="left">  <bold>if</bold> <italic>z</italic><sub><italic>i</italic></sub> = <italic>K</italic> + 1</td>
</tr>
<tr>
<td align="right"><bold>13</bold></td>
<td align="left"/>
<td align="left"><bold>13</bold></td>
<td align="left">   <italic>K</italic> = <italic>K</italic> + 1</td>
</tr>
<tr>
<td align="right"><bold>14</bold></td>
<td align="left">  <bold>for</bold> <italic>k</italic> ∈ 1, …, <italic>K</italic></td>
<td align="left"><bold>14</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="right"><bold>15</bold></td>
<td align="left">   
<inline-formula id="pone.0162259.e011">
<alternatives>
<graphic id="pone.0162259.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e011" xlink:type="simple"/>
<mml:math display="inline" id="M11">
<mml:mrow>
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfrac>
<mml:msub>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi>
<mml:mo>:</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left"><bold>15</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="right"><bold>16</bold></td>
<td align="left">  
<inline-formula id="pone.0162259.e012">
<alternatives>
<graphic id="pone.0162259.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e012" xlink:type="simple"/>
<mml:math display="inline" id="M12">
<mml:mrow>
<mml:msub>
<mml:mi>E</mml:mi>
<mml:mtext>new</mml:mtext>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:msubsup>
<mml:msub>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>:</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>d</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left"><bold>16</bold></td>
<td align="left"> 
<inline-formula id="pone.0162259.e013">
<alternatives>
<graphic id="pone.0162259.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e013" xlink:type="simple"/>
<mml:math display="inline" id="M13">
<mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>e</mml:mi> <mml:mi>w</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo> <mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>K</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mstyle> <mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo> <mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>i</mml:mi> <mml:mo>:</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mstyle> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mi>K</mml:mi> <mml:mtext>ln</mml:mtext> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>−</mml:mo> <mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mtext>log</mml:mtext> <mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="right"><bold>17</bold></td>
<td align="left"><bold>until</bold> <italic>E</italic><sub>old</sub> − <italic>E</italic><sub>new</sub> &lt; <italic>ϵ</italic></td>
<td align="left"><bold>17</bold></td>
<td align="left"><bold>until</bold> <italic>E</italic><sub>old</sub> − <italic>E</italic><sub>new</sub> &lt; <italic>ϵ</italic></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<list list-type="order">
<list-item>
<p>By use of the Euclidean distance (algorithm line 9) <italic>K</italic>-means treats the data space as <italic>isotropic</italic> (distances unchanged by translations and rotations). This means that data points in each cluster are modeled as lying within a <italic>sphere</italic> around the cluster centroid. A sphere has the same radius in each dimension. Furthermore, as clusters are modeled only by the position of their centroids, <italic>K</italic>-means implicitly assumes all clusters have the same radius. When this implicit equal-radius, spherical assumption is violated, <italic>K</italic>-means can behave in a non-intuitive way, even when clusters are very clearly identifiable by eye (see Figs <xref ref-type="fig" rid="pone.0162259.g001">1</xref> and <xref ref-type="fig" rid="pone.0162259.g002">2</xref> and discussion in Sections 5.1, 5.4).</p>
</list-item>
<list-item>
<p>The Euclidean distance entails that the average of the coordinates of data points in a cluster is the centroid of that cluster (algorithm line 15). Euclidean space is <italic>linear</italic> which implies that small changes in the data result in proportionately small changes to the position of the cluster centroid. This is problematic when there are <italic>outliers</italic>, that is, points which are unusually far away from the cluster centroid by comparison to the rest of the points in that cluster. Such outliers can dramatically impair the results of <italic>K</italic>-means (see <xref ref-type="fig" rid="pone.0162259.g003">Fig 3</xref> and discussion in Section 5.3).</p>
</list-item>
<list-item>
<p><italic>K</italic>-means clusters data points purely on their (Euclidean) <italic>geometric closeness</italic> to the cluster centroid (algorithm line 9). Therefore, it does not take into account the different <italic>densities</italic> of each cluster. So, because <italic>K</italic>-means implicitly assumes each cluster occupies the same volume in data space, each cluster must contain the same number of data points. We will show later that even when all other implicit geometric assumptions of <italic>K</italic>-means are satisfied, it will fail to learn a correct, or even meaningful, clustering when there are significant differences in cluster density (see <xref ref-type="fig" rid="pone.0162259.g004">Fig 4</xref> and Section 5.2).</p>
</list-item>
<list-item>
<p>The number <italic>K</italic> of groupings in the data is fixed and assumed known; this is rarely the case in practice. Thus, <italic>K</italic>-means is quite inflexible and degrades badly when the assumptions upon which it is based are even mildly violated by e.g. a tiny number of outliers (see <xref ref-type="fig" rid="pone.0162259.g003">Fig 3</xref> and discussion in Section 5.3).</p>
</list-item>
</list>
<fig id="pone.0162259.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Clustering performed by <italic>K</italic>-means and MAP-DP for spherical, synthetic Gaussian data, with unequal cluster radii and density.</title>
<p>The clusters are well-separated. Data is equally distributed across clusters. Here, unlike MAP-DP, <italic>K</italic>-means fails to find the correct clustering. Instead, it splits the data into three equal-volume regions because it is insensitive to the differing cluster density. Different colours indicate the different clusters.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.g001" xlink:type="simple"/>
</fig>
<fig id="pone.0162259.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Clustering solution obtained by <italic>K</italic>-means and MAP-DP for synthetic elliptical Gaussian data.</title>
<p>All clusters share exactly the same volume and density, but one is rotated relative to the others. There is no appreciable overlap. <italic>K</italic>-means fails because the objective function which it attempts to minimize measures the true clustering solution as worse than the manifestly poor solution shown here.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.g002" xlink:type="simple"/>
</fig>
<fig id="pone.0162259.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Clustering performed by <italic>K</italic>-means and MAP-DP for spherical, synthetic Gaussian data, with outliers.</title>
<p>All clusters have the same radii and density. There are two outlier groups with two outliers in each group. <italic>K</italic>-means fails to find a good solution where MAP-DP succeeds; this is because <italic>K</italic>-means puts some of the outliers in a separate cluster, thus inappropriately using up one of the <italic>K</italic> = 3 clusters. This happens even if all the clusters are spherical, equal radii and well-separated.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.g003" xlink:type="simple"/>
</fig>
<fig id="pone.0162259.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Clustering performed by <italic>K</italic>-means and MAP-DP for spherical, synthetic Gaussian data.</title>
<p>Cluster radii are equal and clusters are well-separated, but the data is unequally distributed across clusters: 69% of the data is in the blue cluster, 29% in the yellow, 2% is orange. <italic>K</italic>-means fails to find a meaningful solution, because, unlike MAP-DP, it cannot adapt to different cluster densities, even when the clusters are spherical, have equal radii and are well-separated.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.g004" xlink:type="simple"/>
</fig>
<p>Some of the above limitations of <italic>K</italic>-means have been addressed in the literature. Regarding outliers, variations of <italic>K</italic>-means have been proposed that use more “robust” estimates for the cluster centroids. For example, the <italic>K-medoids</italic> algorithm uses the point in each cluster which is most centrally located. By contrast, in <italic>K-medians</italic> the median of coordinates of all data points in a cluster is the centroid. However, both approaches are far more computationally costly than <italic>K</italic>-means. <italic>K</italic>-medoids, requires computation of a pairwise similarity matrix between data points which can be prohibitively expensive for large data sets. In <italic>K</italic>-medians, the coordinates of cluster data points in each dimension need to be sorted, which takes much more effort than computing the mean.</p>
<p>Provided that a transformation of the entire data space can be found which “spherizes” each cluster, then the spherical limitation of <italic>K</italic>-means can be mitigated. However, for most situations, finding such a transformation will not be trivial and is usually as difficult as finding the clustering solution itself. Alternatively, by using the <italic>Mahalanobis distance</italic>, <italic>K</italic>-means can be adapted to non-spherical clusters [<xref ref-type="bibr" rid="pone.0162259.ref013">13</xref>], but this approach will encounter problematic computational singularities when a cluster has only one data point assigned.</p>
<p>Addressing the problem of the fixed number of clusters <italic>K</italic>, note that it is not possible to choose <italic>K</italic> simply by clustering with a range of values of <italic>K</italic> and choosing the one which minimizes <italic>E</italic>. This is because <italic>K</italic>-means is <italic>nested</italic>: we can always decrease <italic>E</italic> by increasing <italic>K</italic>, even when the true number of clusters is much smaller than <italic>K</italic>, since, all other things being equal, <italic>K</italic>-means tries to create an equal-volume partition of the data space. Therefore, data points find themselves ever closer to a cluster centroid as <italic>K</italic> increases. In the extreme case for <italic>K</italic> = <italic>N</italic> (the number of data points), then <italic>K</italic>-means will assign each data point to its own separate cluster and <italic>E</italic> = 0, which has no meaning as a “clustering” of the data. Various extensions to <italic>K</italic>-means have been proposed which circumvent this problem by <italic>regularization</italic> over <italic>K</italic>, e.g. <italic>Akaike</italic>(AIC) or <italic>Bayesian information criteria</italic> (BIC), and we discuss this in more depth in Section 3).</p>
<p>So far, we have presented <italic>K</italic>-means from a geometric viewpoint. However, it can also be profitably understood from a probabilistic viewpoint, as a restricted case of the (<italic>finite</italic>) <italic>Gaussian mixture model</italic> (GMM). This is the starting point for us to introduce a new algorithm which overcomes most of the limitations of <italic>K</italic>-means described above.</p>
<p>This new algorithm, which we call <italic>maximum a-posteriori Dirichlet process</italic> mixtures (MAP-DP), is a more flexible alternative to <italic>K</italic>-means which can quickly provide interpretable clustering solutions for a wide array of applications.</p>
<p>By contrast to <italic>K</italic>-means, MAP-DP can perform cluster analysis without specifying the number of clusters. In order to model <italic>K</italic> we turn to a probabilistic framework where <italic>K</italic> grows with the data size, also known as <italic>Bayesian non-parametric</italic>(BNP) models [<xref ref-type="bibr" rid="pone.0162259.ref014">14</xref>]. In particular, we use <italic>Dirichlet process mixture models</italic>(DP mixtures) where the number of clusters can be estimated from data. To date, despite their considerable power, applications of DP mixtures are somewhat limited due to the computationally expensive and technically challenging inference involved [<xref ref-type="bibr" rid="pone.0162259.ref015">15</xref>, <xref ref-type="bibr" rid="pone.0162259.ref016">16</xref>, <xref ref-type="bibr" rid="pone.0162259.ref017">17</xref>]. Our new MAP-DP algorithm is a computationally scalable and simple way of performing inference in DP mixtures. Additionally, MAP-DP is model-based and so provides a consistent way of inferring missing values from the data and making predictions for unknown data.</p>
<p>As a prelude to a description of the MAP-DP algorithm in full generality later in the paper, we introduce a special (simplified) case, Algorithm 2, which illustrates the key similarities and differences to <italic>K</italic>-means (for the case of spherical Gaussian data with known cluster variance; in Section 4 we will present the MAP-DP algorithm in full generality, removing this spherical restriction):</p>
<list list-type="bullet">
<list-item>
<p>The number of clusters <italic>K</italic> is not fixed but inferred from the data. The algorithm is initialized with <italic>K</italic> = 1 and all data points assigned to one cluster (MAP-DP algorithm line 1). In the assignment step (algorithm line 11), a choice is made between assigning the current data point to one of the existing clusters (algorithm line 9) or assigning it to a <italic>prior cluster</italic> located at <italic>μ</italic><sub>0</sub> with variance <inline-formula id="pone.0162259.e016"><alternatives><graphic id="pone.0162259.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> (algorithm line 10). When <inline-formula id="pone.0162259.e017"><alternatives><graphic id="pone.0162259.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>≈</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and the current data point is the same distance from <italic>μ</italic><sub>0</sub> and from the current most likely cluster centroid <inline-formula id="pone.0162259.e018"><alternatives><graphic id="pone.0162259.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, a new cluster is created (algorithm lines 12, 13) only if the <italic>prior count</italic> (<italic>concentration</italic>) parameter <inline-formula id="pone.0162259.e019"><alternatives><graphic id="pone.0162259.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>&gt;</mml:mo> <mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. In other words, all other things being geometrically similar, only the <italic>relative counts</italic> of the number of data points in each cluster, and the prior count, determines whether a new cluster is created or not. By contrast, if <inline-formula id="pone.0162259.e020"><alternatives><graphic id="pone.0162259.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is very different from <inline-formula id="pone.0162259.e021"><alternatives><graphic id="pone.0162259.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, then the geometry largely determines the creation of new clusters: if a data point is closer to the prior location <italic>μ</italic><sub>0</sub> than to any other most likely existing cluster centroid, <inline-formula id="pone.0162259.e022"><alternatives><graphic id="pone.0162259.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msubsup><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, then a new cluster is created.</p>
</list-item>
<list-item>
<p>In this spherical variant of MAP-DP, as with <italic>K</italic>-means, the Euclidean metric <inline-formula id="pone.0162259.e023"><alternatives><graphic id="pone.0162259.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mo>.</mml:mo> <mml:mo>|</mml:mo> <mml:msubsup><mml:mo>|</mml:mo> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></inline-formula> is used to compute distances to cluster centroids (algorithm lines 9, 10). However, in MAP-DP, the log of <inline-formula id="pone.0162259.e024"><alternatives><graphic id="pone.0162259.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is subtracted from this distance when updating assignments (algorithm line 11). Also, the composite variance <inline-formula id="pone.0162259.e025"><alternatives><graphic id="pone.0162259.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> features in the distance calculations such that the smaller <inline-formula id="pone.0162259.e026"><alternatives><graphic id="pone.0162259.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> becomes, the less important the number of data points in the cluster <inline-formula id="pone.0162259.e027"><alternatives><graphic id="pone.0162259.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> becomes to the assignment. In that case, the algorithm behaves much like <italic>K</italic>-means. But, if <inline-formula id="pone.0162259.e028"><alternatives><graphic id="pone.0162259.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> becomes large, then, if a cluster already has many data points assigned to it, it is more likely that the current data point is assigned to that cluster (in other words, clusters exhibit a “<italic>rich-get-richer</italic>” effect). MAP-DP thereby takes into account the density of clusters, unlike <italic>K</italic>-means. We can see <inline-formula id="pone.0162259.e029"><alternatives><graphic id="pone.0162259.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> as controlling the “balance” between geometry and density.</p>
</list-item>
<list-item>
<p>MAP-DP directly estimates only cluster assignments, while <italic>K</italic>-means also finds the most likely cluster centroids given the current cluster assignments. But, since the cluster assignment estimates may be significantly in error, this error will propagate to the most likely cluster centroid locations. By contrast, MAP-DP never explicitly estimates cluster centroids, they are treated as appropriately uncertain quantities described by a most likely cluster location <inline-formula id="pone.0162259.e030"><alternatives><graphic id="pone.0162259.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msubsup><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and variance <inline-formula id="pone.0162259.e031"><alternatives><graphic id="pone.0162259.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (the centroid <italic>hyper parameters</italic>). This means that MAP-DP does not need explicit values of the cluster centroids on initialization (<italic>K</italic>-means algorithm line 1). Indeed, with <italic>K</italic>-means, poor choices of these initial cluster centroids can cause the algorithm to fall into sub-optimal configurations from which it cannot recover, and there is, generally, no known universal way to pick “good” initial centroids. At the same time, during iterations of the algorithm, MAP-DP can bypass sub-optimal, erroneous configurations that <italic>K</italic>-means cannot avoid. This also means that MAP-DP often converges in many fewer iterations than <italic>K</italic>-means. As we discuss in Appendix C cluster centroids and variances can be obtained in MAP-DP if needed after the algorithm has converged.</p>
</list-item>
<list-item>
<p>The cluster hyper parameters are updated explicitly for each data point in turn (algorithm lines 7, 8). This updating is a <italic>weighted sum</italic> of <italic>prior location</italic> <italic>μ</italic><sub>0</sub> and the mean of the data currently assigned to each cluster. If the <italic>prior variance</italic> parameter <inline-formula id="pone.0162259.e032"><alternatives><graphic id="pone.0162259.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> is large or the known cluster variance <inline-formula id="pone.0162259.e033"><alternatives><graphic id="pone.0162259.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula> is small, then <italic>μ</italic><sub><italic>k</italic></sub> is just the mean of the data in cluster <italic>k</italic>, as with <italic>K</italic>-means. By contrast, if the prior variance is small (or the known cluster variance <inline-formula id="pone.0162259.e034"><alternatives><graphic id="pone.0162259.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula> is large), then <italic>μ</italic><sub><italic>k</italic></sub> ≈ <italic>μ</italic><sub>0</sub>, the prior centroid location. So, intuitively, the most likely location of the cluster centroid is based on an appropriate “balance” between the confidence we have in the data in each cluster and our prior information about the cluster centroid location.</p>
</list-item>
<list-item>
<p>While <italic>K</italic>-means estimates only the cluster centroids, this spherical Gaussian variant of MAP-DP has an additional cluster variance parameter <inline-formula id="pone.0162259.e035"><alternatives><graphic id="pone.0162259.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>, effectively determining the radius of the clusters. If the prior variance <inline-formula id="pone.0162259.e036"><alternatives><graphic id="pone.0162259.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> or the cluster variance <inline-formula id="pone.0162259.e037"><alternatives><graphic id="pone.0162259.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula> are small, then <inline-formula id="pone.0162259.e038"><alternatives><graphic id="pone.0162259.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> becomes small. This is the situation where we have high confidence in the most likely cluster centroid <italic>μ</italic><sub><italic>k</italic></sub>. If, on the other hand, the prior variance <inline-formula id="pone.0162259.e039"><alternatives><graphic id="pone.0162259.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> is large, then <inline-formula id="pone.0162259.e040"><alternatives><graphic id="pone.0162259.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>≈</mml:mo> <mml:mfrac><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. Intuitively, if we have little trust in the prior location <italic>μ</italic><sub>0</sub>, the more data in each cluster, the better the estimate of the most likely cluster centroid. Finally, for large cluster variance <inline-formula id="pone.0162259.e041"><alternatives><graphic id="pone.0162259.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>, then <inline-formula id="pone.0162259.e042"><alternatives><graphic id="pone.0162259.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>≈</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, so that the uncertainty in the most likely cluster centroid defaults to that of the prior.</p>
</list-item>
</list>
<p>A summary of the paper is as follows. In Section 2 we review the <italic>K</italic>-means algorithm and its derivation as a constrained case of a GMM. Section 3 covers alternative ways of choosing the number of clusters. In Section 4 the novel MAP-DP clustering algorithm is presented, and the performance of this new algorithm is evaluated in Section 5 on synthetic data. In Section 6 we apply MAP-DP to explore phenotyping of parkinsonism, and we conclude in Section 8 with a summary of our findings and a discussion of limitations and future directions.</p>
</sec>
<sec id="sec002">
<title>2 A probabilistic interpretation of <italic>K</italic>-means</title>
<p>In order to improve on the limitations of <italic>K</italic>-means, we will invoke an interpretation which views it as an inference method for a specific kind of <italic>mixture model</italic>. While <italic>K</italic>-means is essentially geometric, mixture models are inherently <italic>probabilistic</italic>, that is, they involve fitting a probability density model to the data. The advantage of considering this probabilistic framework is that it provides a <italic>mathematically</italic> <italic>principled</italic> way to understand and address the limitations of <italic>K</italic>-means. It is well known that <italic>K</italic>-means can be derived as an approximate inference procedure for a special kind of finite mixture model. For completeness, we will rehearse the derivation here.</p>
<sec id="sec003">
<title>2.1 Finite mixture models</title>
<p>In the GMM (p. 430-439 in [<xref ref-type="bibr" rid="pone.0162259.ref018">18</xref>]) we assume that data points are drawn from a <italic>mixture</italic> (a weighted sum) of Gaussian distributions with density <inline-formula id="pone.0162259.e043"><alternatives><graphic id="pone.0162259.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:msub><mml:mi>π</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Σ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo/><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>K</italic> is the fixed number of components, <italic>π</italic><sub><italic>k</italic></sub> &gt; 0 are the weighting coefficients with <inline-formula id="pone.0162259.e044"><alternatives><graphic id="pone.0162259.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:msub><mml:mi>π</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>μ</italic><sub><italic>k</italic></sub>, <italic>Σ</italic><sub><italic>k</italic></sub> are the parameters of each Gaussian in the mixture. So, to produce a data point <italic>x</italic><sub><italic>i</italic></sub>, the model first draws a cluster assignment <italic>z</italic><sub><italic>i</italic></sub> = <italic>k</italic>. The distribution over each <italic>z</italic><sub><italic>i</italic></sub> is known as a <italic>categorical distribution</italic> with <italic>K</italic> parameters <italic>π</italic><sub><italic>k</italic></sub> = <italic>p</italic>(<italic>z</italic><sub><italic>i</italic></sub> = <italic>k</italic>). Then, given this assignment, the data point is drawn from a Gaussian with mean <italic>μ</italic><sub><italic>z</italic><sub><italic>i</italic></sub></sub> and covariance <italic>Σ</italic><sub><italic>z</italic><sub><italic>i</italic></sub></sub>.</p>
<p>Under this model, the conditional probability of each data point is <inline-formula id="pone.0162259.e045"><alternatives><graphic id="pone.0162259.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi> <mml:mo/><mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Σ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo/><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which is just a Gaussian. But an equally important quantity is the probability we get by reversing this conditioning: the probability of an assignment <italic>z</italic><sub><italic>i</italic></sub> given a data point <italic>x</italic> (sometimes called the <italic>responsibility</italic>), <italic>p</italic>(<italic>z</italic><sub><italic>i</italic></sub> = <italic>k</italic>|<italic>x</italic>, <italic>μ</italic><sub><italic>k</italic></sub>, <italic>Σ</italic><sub><italic>k</italic></sub>). This raises an important point: in the GMM, a data point has a finite probability of belonging to <italic>every</italic> cluster, whereas, for <italic>K</italic>-means each point belongs to only one cluster. This is because the GMM is <italic>not</italic> a partition of the data: the assignments <italic>z</italic><sub><italic>i</italic></sub> are treated as random draws from a distribution.</p>
<p>One of the most popular algorithms for estimating the unknowns of a GMM from some data (that is the variables <italic>z</italic>, <italic>μ</italic>, <italic>Σ</italic> and <italic>π</italic>) is the <italic>Expectation-Maximization</italic> (E-M) algorithm. This iterative procedure alternates between the <italic>E</italic> (<italic>expectation</italic>) step and the <italic>M</italic> (<italic>maximization</italic>) steps. The E-step uses the responsibilities to compute the cluster assignments, holding the cluster parameters fixed, and the M-step re-computes the cluster parameters holding the cluster assignments fixed:</p>
<p><bold>E-step:</bold> Given the current estimates for the cluster parameters, compute the responsibilities:
<disp-formula id="pone.0162259.e046">
<alternatives>
<graphic id="pone.0162259.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e046" xlink:type="simple"/>
<mml:math display="block" id="M46">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:msub>
<mml:mi>γ</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
<mml:mfenced close="" open="|" separators="">
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>Σ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfenced>
</mml:mfenced>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mi>π</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mi mathvariant="script">N</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mfenced close="" open="|" separators="">
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>Σ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfenced>
</mml:mfenced>
</mml:mrow>
<mml:mrow>
<mml:msubsup>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:msubsup>
<mml:msub>
<mml:mi>π</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mi mathvariant="script">N</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mfenced close="" open="|" separators="">
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>Σ</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
</mml:mfenced>
</mml:mfenced>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p><bold>M-step:</bold> Compute the parameters that maximize the <italic>likelihood</italic> of the data set <italic>p</italic>(<italic>X</italic>|<italic>π</italic>, <italic>μ</italic>, <italic>Σ</italic>, <italic>z</italic>), which is the probability of all of the data under the GMM [<xref ref-type="bibr" rid="pone.0162259.ref019">19</xref>]:
<disp-formula id="pone.0162259.e047">
<alternatives>
<graphic id="pone.0162259.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e047" xlink:type="simple"/>
<mml:math display="block" id="M47">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:mi>X</mml:mi>
<mml:mfenced close="" open="|" separators="">
<mml:mi>π</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>μ</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>Σ</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>z</mml:mi>
</mml:mfenced>
</mml:mfenced>
<mml:mo>=</mml:mo>
<mml:munderover>
<mml:mo>∏</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:munderover>
<mml:msub>
<mml:mi>π</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mi mathvariant="script">N</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mfenced close="" open="|" separators="">
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>Σ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfenced>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>Maximizing this with respect to each of the parameters can be done in closed form:
<disp-formula id="pone.0162259.e048">
<alternatives>
<graphic id="pone.0162259.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e048" xlink:type="simple"/>
<mml:math display="block" id="M48">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mtable>
<mml:mtr>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mi>S</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
<mml:msub>
<mml:mi>γ</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mi>π</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:msub>
<mml:mi>S</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mi>N</mml:mi>
</mml:mfrac>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:msub>
<mml:mi>S</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfrac>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
<mml:msub>
<mml:mi>γ</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mi>Σ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:msub>
<mml:mi>S</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfrac>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
<mml:msub>
<mml:mi>γ</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfenced>
<mml:msup>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfenced>
<mml:mi>T</mml:mi>
</mml:msup>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula></p>
<p>Each E-M iteration is guaranteed not to decrease the likelihood function <italic>p</italic>(<italic>X</italic>|<italic>π</italic>, <italic>μ</italic>, <italic>Σ</italic>, <italic>z</italic>). So, as with <italic>K</italic>-means, convergence is guaranteed, but not necessarily to the global maximum of the likelihood. We can, alternatively, say that the E-M algorithm attempts to minimize the GMM objective function:
<disp-formula id="pone.0162259.e049">
<alternatives>
<graphic id="pone.0162259.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e049" xlink:type="simple"/>
<mml:math display="block" id="M49">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>E</mml:mi>
<mml:mo>=</mml:mo>
<mml:mo>-</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
<mml:mtext>ln</mml:mtext>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:munderover>
<mml:msub>
<mml:mi>π</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mi mathvariant="script">N</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mfenced close="" open="|" separators="">
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>Σ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfenced>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula></p>
<p>When changes in the likelihood are sufficiently small the iteration is stopped.</p>
</sec>
<sec id="sec004">
<title>2.2 Connection to <italic>K</italic>-means</title>
<p>We can derive the <italic>K</italic>-means algorithm from E-M inference in the GMM model discussed above. Consider a special case of a GMM where the covariance matrices of the mixture components are spherical and shared across components. That means <italic>Σ</italic><sub><italic>k</italic></sub> = <italic>σI</italic> for <italic>k</italic> = 1, …, <italic>K</italic>, where <italic>I</italic> is the <italic>D</italic> × <italic>D</italic> identity matrix, with the variance <italic>σ</italic> &gt; 0. We will also assume that <italic>σ</italic> is a known constant. Then the E-step above simplifies to:
<disp-formula id="pone.0162259.e050">
<alternatives>
<graphic id="pone.0162259.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e050" xlink:type="simple"/>
<mml:math display="block" id="M50">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:msub>
<mml:mi>γ</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mi>π</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo form="prefix">exp</mml:mo>
<mml:mfenced close=")" open="(" separators="">
<mml:mo>-</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>σ</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msubsup>
<mml:mfenced close="||" open="||" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfenced>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msubsup>
</mml:mfenced>
</mml:mrow>
<mml:mrow>
<mml:msubsup>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:msubsup>
<mml:msub>
<mml:mi>π</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mo form="prefix">exp</mml:mo>
<mml:mfenced close=")" open="(" separators="">
<mml:mo>-</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>σ</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msubsup>
<mml:mfenced close="||" open="||" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
</mml:mfenced>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msubsup>
</mml:mfenced>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula></p>
<p>The M-step no longer updates the values for <italic>Σ</italic><sub><italic>k</italic></sub> at each iteration, but otherwise it remains unchanged.</p>
<p>Now, let us further consider shrinking the constant variance term to 0: <italic>σ</italic> → 0. At this limit, the responsibility probability <xref ref-type="disp-formula" rid="pone.0162259.e050">Eq (6)</xref> takes the value 1 for the component which is closest to <italic>x</italic><sub><italic>i</italic></sub>. That is, of course, the component for which the (squared) Euclidean distance <inline-formula id="pone.0162259.e051"><alternatives><graphic id="pone.0162259.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mo>|</mml:mo> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup>
</mml:math></alternatives></inline-formula> is minimal. So, all other components have responsibility 0. Also at the limit, the categorical probabilities <italic>π</italic><sub><italic>k</italic></sub> cease to have any influence. In effect, the E-step of E-M behaves exactly as the assignment step of <italic>K</italic>-means. Similarly, since <italic>π</italic><sub><italic>k</italic></sub> has no effect, the M-step re-estimates only the mean parameters <italic>μ</italic><sub><italic>k</italic></sub>, which is now just the sample mean of the data which is closest to that component.</p>
<p>To summarize, if we assume a probabilistic GMM model for the data with fixed, identical spherical covariance matrices across all clusters and take the limit of the cluster variances <italic>σ</italic> → 0, the E-M algorithm becomes equivalent to <italic>K</italic>-means. This has, more recently, become known as the <italic>small variance asymptotic</italic> (SVA) derivation of <italic>K</italic>-means clustering [<xref ref-type="bibr" rid="pone.0162259.ref020">20</xref>].</p>
</sec>
</sec>
<sec id="sec005">
<title>3 Inferring <italic>K</italic>, the number of clusters</title>
<p>The GMM (Section 2.1) and mixture models in their full generality, are a principled approach to modeling the data beyond purely geometrical considerations. As such, mixture models are useful in overcoming the equal-radius, equal-density spherical cluster limitation of <italic>K</italic>-means. Nevertheless, it still leaves us empty-handed on choosing <italic>K</italic> as in the GMM this is a fixed quantity.</p>
<p>The choice of <italic>K</italic> is a well-studied problem and many approaches have been proposed to address it. As discussed above, the <italic>K</italic>-means objective function <xref ref-type="disp-formula" rid="pone.0162259.e014">Eq (1)</xref> cannot be used to select <italic>K</italic> as it will always favor the larger number of components. Probably the most popular approach is to run <italic>K</italic>-means with different values of <italic>K</italic> and use a regularization principle to pick the best <italic>K</italic>. For instance in Pelleg and Moore [<xref ref-type="bibr" rid="pone.0162259.ref021">21</xref>], BIC is used. Bischof et al. [<xref ref-type="bibr" rid="pone.0162259.ref022">22</xref>] use <italic>minimum description length</italic>(MDL) regularization, starting with a value of <italic>K</italic> which is larger than the expected true value for <italic>K</italic> in the given application, and then removes centroids until changes in description length are minimal. By contrast, Hamerly and Elkan [<xref ref-type="bibr" rid="pone.0162259.ref023">23</xref>] suggest starting <italic>K</italic>-means with one cluster and splitting clusters until points in each cluster have a Gaussian distribution. An obvious limitation of this approach would be that the Gaussian distributions for each cluster need to be spherical. In Gao et al. [<xref ref-type="bibr" rid="pone.0162259.ref024">24</xref>] the choice of <italic>K</italic> is explored in detail leading to the <italic>deviance information criterion</italic> (DIC) as regularizer. DIC is most convenient in the probabilistic framework as it can be readily computed using <italic>Markov chain Monte Carlo</italic> (MCMC). In addition, DIC can be seen as a hierarchical generalization of BIC and AIC.</p>
<p>All these regularization schemes consider ranges of values of <italic>K</italic> and must perform exhaustive restarts for each value of <italic>K</italic>. This increases the computational burden. By contrast, our MAP-DP algorithm is based on a model in which the number of clusters is just another random variable in the model (such as the assignments <italic>z</italic><sub><italic>i</italic></sub>). So, <italic>K</italic> is estimated as an intrinsic part of the algorithm in a more computationally efficient way.</p>
<p>As argued above, the likelihood function in GMM <xref ref-type="disp-formula" rid="pone.0162259.e047">Eq (3)</xref> and the sum of Euclidean distances in <italic>K</italic>-means <xref ref-type="disp-formula" rid="pone.0162259.e014">Eq (1)</xref> cannot be used to compare the fit of models for different <italic>K</italic>, because this is an ill-posed problem that cannot detect overfitting. A natural way to regularize the GMM is to assume priors over the uncertain quantities in the model, in other words to turn to <italic>Bayesian models</italic>. Placing priors over the cluster parameters smooths out the cluster shape and penalizes models that are too far away from the expected structure [<xref ref-type="bibr" rid="pone.0162259.ref025">25</xref>]. Also, placing a prior over the cluster weights provides more control over the distribution of the cluster densities. The key in dealing with the uncertainty about <italic>K</italic> is in the prior distribution we use for the cluster weights <italic>π</italic><sub><italic>k</italic></sub>, as we will show.</p>
<p>In MAP-DP, instead of fixing the number of components, we will assume that the more data we observe the more clusters we will encounter. For many applications this is a reasonable assumption; for example, if our aim is to extract different variations of a disease given some measurements for each patient, the expectation is that with more patient records more subtypes of the disease would be observed. As another example, when extracting topics from a set of documents, as the number and length of the documents increases, the number of topics is also expected to increase. When clustering similar companies to construct an efficient financial portfolio, it is reasonable to assume that the more companies are included in the portfolio, a larger variety of company clusters would occur.</p>
<p>Formally, this is obtained by assuming that <italic>K</italic> → ∞ as <italic>N</italic> → ∞, but with <italic>K</italic> growing more slowly than <italic>N</italic> to provide a meaningful clustering. But, for any finite set of data points, the number of clusters is always some unknown but finite <italic>K</italic><sup>+</sup> that can be inferred from the data. The parametrization of <italic>K</italic> is avoided and instead the model is controlled by a new parameter <italic>N</italic><sub>0</sub> called the <italic>concentration parameter</italic> or <italic>prior count</italic>. This controls the rate with which <italic>K</italic> grows with respect to <italic>N</italic>. Additionally, because there is a consistent probabilistic model, <italic>N</italic><sub>0</sub> may be estimated from the data by standard methods such as maximum likelihood and cross-validation as we discuss in Appendix F.</p>
</sec>
<sec id="sec006">
<title>4 Generalized MAP-DP algorithm</title>
<p>Before presenting the model underlying MAP-DP (Section 4.2) and detailed algorithm (Section 4.3), we give an overview of a key probabilistic structure known as the <italic>Chinese restaurant process</italic>(CRP). The latter forms the theoretical basis of our approach allowing the treatment of <italic>K</italic> as an unbounded random variable.</p>
<sec id="sec007">
<title>4.1 The Chinese restaurant process (CRP)</title>
<p>In clustering, the essential discrete, combinatorial structure is a <italic>partition</italic> of the data set into a finite number of groups, <italic>K</italic>. The CRP is a probability distribution on these partitions, and it is parametrized by the prior count parameter <italic>N</italic><sub>0</sub> and the number of data points <italic>N</italic>. For a partition example, let us assume we have data set <italic>X</italic> = (<italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>N</italic></sub>) of just <italic>N</italic> = 8 data points, one particular partition of this data is the set {{<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>}, {<italic>x</italic><sub>3</sub>, <italic>x</italic><sub>5</sub>, <italic>x</italic><sub>7</sub>}, {<italic>x</italic><sub>4</sub>, <italic>x</italic><sub>6</sub>}, {<italic>x</italic><sub>8</sub>}}. In this partition there are <italic>K</italic> = 4 clusters and the cluster assignments take the values <italic>z</italic><sub>1</sub> = <italic>z</italic><sub>2</sub> = 1, <italic>z</italic><sub>3</sub> = <italic>z</italic><sub>5</sub> = <italic>z</italic><sub>7</sub> = 2, <italic>z</italic><sub>4</sub> = <italic>z</italic><sub>6</sub> = 3 and <italic>z</italic><sub>8</sub> = 4. So, we can also think of the CRP as a distribution over cluster assignments.</p>
<p>The CRP is often described using the metaphor of a restaurant, with data points corresponding to customers and clusters corresponding to tables. Customers arrive at the restaurant one at a time. The first customer is seated alone. Each subsequent customer is either seated at one of the already occupied tables with probability proportional to the number of customers already seated there, or, with probability proportional to the parameter <italic>N</italic><sub>0</sub>, the customer sits at a new table. We use <italic>k</italic> to denote a cluster index and <italic>N</italic><sub><italic>k</italic></sub> to denote the number of customers sitting at table <italic>k</italic>. With this notation, we can write the probabilistic rule characterizing the CRP:
<disp-formula id="pone.0162259.e052">
<alternatives>
<graphic id="pone.0162259.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e052" xlink:type="simple"/>
<mml:math display="block" id="M52">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:mtext>customer</mml:mtext>
<mml:mrow>
<mml:mspace width="0.277778em"/>
<mml:mi>i</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mspace width="0.277778em"/>
</mml:mrow>
<mml:mtext>joins</mml:mtext>
<mml:mspace width="4.pt"/>
<mml:mtext>table</mml:mtext>
<mml:mrow>
<mml:mspace width="0.166667em"/>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:mfenced>
<mml:mo>=</mml:mo>
<mml:mfenced close="" open="{" separators="">
<mml:mtable>
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mfrac>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mtext>if</mml:mtext>
<mml:mspace width="4.pt"/>
<mml:mi>k</mml:mi>
<mml:mspace width="4.pt"/>
<mml:mtext>is</mml:mtext>
<mml:mspace width="4.pt"/>
<mml:mtext>an</mml:mtext>
<mml:mspace width="4.pt"/>
<mml:mtext>existing</mml:mtext>
<mml:mspace width="4.pt"/>
<mml:mtext>table</mml:mtext>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mfrac>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mtext>if</mml:mtext>
<mml:mspace width="4.pt"/>
<mml:mi>k</mml:mi>
<mml:mspace width="4.pt"/>
<mml:mtext>is</mml:mtext>
<mml:mspace width="4.pt"/>
<mml:mtext>a</mml:mtext>
<mml:mspace width="4.pt"/>
<mml:mtext>new</mml:mtext>
<mml:mspace width="4.pt"/>
<mml:mtext>table</mml:mtext>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula></p>
<p>After <italic>N</italic> customers have arrived and so <italic>i</italic> has increased from 1 to <italic>N</italic>, their seating pattern defines a set of clusters that have the CRP distribution. This partition is random, and thus the CRP is a distribution on partitions and we will denote a draw from this distribution as:
<disp-formula id="pone.0162259.e053">
<alternatives>
<graphic id="pone.0162259.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e053" xlink:type="simple"/>
<mml:math display="block" id="M53">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mo>…</mml:mo>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>N</mml:mi>
</mml:msub>
</mml:mfenced>
<mml:mo>∼</mml:mo>
<mml:mtext>CRP</mml:mtext>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>N</mml:mi>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula></p>
<p>Further, we can compute the probability over all cluster assignment variables, given that they are a draw from a CRP: 
<disp-formula id="pone.0162259.e054">
<alternatives>
<graphic id="pone.0162259.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e054" xlink:type="simple"/>
<mml:math display="block" id="M54">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mo>…</mml:mo>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>N</mml:mi>
</mml:msub>
</mml:mfenced>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:msubsup>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:msubsup>
<mml:msubsup>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mfenced close=")" open="(">
<mml:mi>N</mml:mi>
</mml:mfenced>
</mml:msubsup>
</mml:mfrac>
<mml:munderover>
<mml:mo>∏</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:munderover>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mfenced>
<mml:mo>!</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
where <inline-formula id="pone.0162259.e055"><alternatives><graphic id="pone.0162259.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>×</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>N</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow>
</mml:math></alternatives></inline-formula>. This probability is obtained from a product of the probabilities in <xref ref-type="disp-formula" rid="pone.0162259.e052">Eq (7)</xref>. If there are exactly <italic>K</italic> tables, customers have sat on a new table exactly <italic>K</italic> times, explaining the term <inline-formula id="pone.0162259.e056"><alternatives><graphic id="pone.0162259.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> in the expression. The probability of a customer sitting on an existing table <italic>k</italic> has been used <italic>N</italic><sub><italic>k</italic></sub> − 1 times where each time the numerator of the corresponding probability has been increasing, from 1 to <italic>N</italic><sub><italic>k</italic></sub> − 1. This is how the term <inline-formula id="pone.0162259.e057"><alternatives><graphic id="pone.0162259.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:mo>(</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>!</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> arises. The <inline-formula id="pone.0162259.e058"><alternatives><graphic id="pone.0162259.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup>
</mml:math></alternatives></inline-formula> is the product of the denominators when multiplying the probabilities from <xref ref-type="disp-formula" rid="pone.0162259.e052">Eq (7)</xref>, as <italic>N</italic> = 1 at the start and increases to <italic>N</italic> − 1 for the last seated customer.</p>
<p>Notice that the CRP is <italic>solely</italic> parametrized by the number of customers (data points) <italic>N</italic> and the concentration parameter <italic>N</italic><sub>0</sub> that controls the probability of a customer sitting at a new, unlabeled table. We can see that the parameter <italic>N</italic><sub>0</sub> controls the rate of increase of the number of tables in the restaurant as <italic>N</italic> increases. It is usually referred to as the concentration parameter because it controls the typical density of customers seated at tables.</p>
<p>We can think of there being an infinite number of unlabeled tables in the restaurant at any given point in time, and when a customer is assigned to a new table, one of the unlabeled ones is chosen arbitrarily and given a numerical label. We can think of the number of unlabeled tables as <italic>K</italic>, where <italic>K</italic> → ∞ and the number of labeled tables would be some random, but finite <italic>K</italic><sup>+</sup> &lt; <italic>K</italic> that could increase each time a new customer arrives.</p>
</sec>
<sec id="sec008">
<title>4.2 The underlying probabilistic model</title>
<p>First, we will model the distribution over the cluster assignments <italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub> with a CRP (in fact, we can derive the CRP from the assumption that the mixture weights <italic>π</italic><sub>1</sub>, …, <italic>π</italic><sub><italic>K</italic></sub> of the finite mixture model, Section 2.1, have a <italic>DP prior</italic>; see Teh [<xref ref-type="bibr" rid="pone.0162259.ref026">26</xref>] for a detailed exposition of this fascinating and important connection). We will also place priors over the other random quantities in the model, the cluster parameters. We will restrict ourselves to assuming <italic>conjugate priors</italic> for computational simplicity (however, this assumption is not essential and there is extensive literature on using non-conjugate priors in this context [<xref ref-type="bibr" rid="pone.0162259.ref016">16</xref>, <xref ref-type="bibr" rid="pone.0162259.ref027">27</xref>, <xref ref-type="bibr" rid="pone.0162259.ref028">28</xref>]).</p>
<p>As we are mainly interested in clustering applications, i.e. we are only interested in the cluster assignments <italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub>, we can gain computational efficiency [<xref ref-type="bibr" rid="pone.0162259.ref029">29</xref>] by <italic>integrating out</italic> the cluster parameters (this process of eliminating random variables in the model which are not of explicit interest is known as <italic>Rao-Blackwellization</italic> [<xref ref-type="bibr" rid="pone.0162259.ref030">30</xref>]). The resulting probabilistic model, called the <italic>CRP mixture model</italic> by Gershman and Blei [<xref ref-type="bibr" rid="pone.0162259.ref031">31</xref>], is:
<disp-formula id="pone.0162259.e059">
<alternatives>
<graphic id="pone.0162259.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e059" xlink:type="simple"/>
<mml:math display="block" id="M59">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mtable>
<mml:mtr>
<mml:mtd>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo><mml:mo>…</mml:mo>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>N</mml:mi>
</mml:msub>
</mml:mfenced>
</mml:mtd>
<mml:mtd>
<mml:mo>∼</mml:mo>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mtext>CRP</mml:mtext>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>N</mml:mi>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
</mml:mtd>
<mml:mtd>
<mml:mo>∼</mml:mo>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mi>f</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>θ</mml:mi>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
</mml:msub>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
where <italic>θ</italic> are the hyper parameters of the <italic>predictive distribution</italic> <italic>f</italic>(<italic>x</italic>|<italic>θ</italic>). Detailed expressions for this model for some different data types and distributions are given in (<xref ref-type="supplementary-material" rid="pone.0162259.s003">S1 Material</xref>). To summarize: we will assume that data is described by some random <italic>K</italic><sup>+</sup> number of predictive distributions describing each cluster where the randomness of <italic>K</italic><sup>+</sup> is parametrized by <italic>N</italic><sub>0</sub>, and <italic>K</italic><sup>+</sup> increases with <italic>N</italic>, at a rate controlled by <italic>N</italic><sub>0</sub>.</p>
</sec>
<sec id="sec009">
<title>4.3 MAP-DP algorithm</title>
<p>Much as <italic>K</italic>-means can be derived from the more general GMM, we will derive our novel clustering algorithm based on the model <xref ref-type="disp-formula" rid="pone.0162259.e059">Eq (10)</xref> above. The likelihood of the data <italic>X</italic> is:
<disp-formula id="pone.0162259.e060">
<alternatives>
<graphic id="pone.0162259.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e060" xlink:type="simple"/>
<mml:math display="block" id="M60">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:mrow>
<mml:mi>X</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mfenced>
<mml:mo>=</mml:mo>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo><mml:mo>…</mml:mo>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>N</mml:mi>
</mml:msub>
</mml:mfenced>
<mml:munderover>
<mml:mo>∏</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
<mml:munderover>
<mml:mo>∏</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:munderover>
<mml:mi>f</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mrow>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:msubsup>
<mml:mi>θ</mml:mi>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msubsup>
</mml:mfenced>
<mml:msup>
<mml:mrow/>
<mml:mrow>
<mml:mi>δ</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mfenced>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
where <italic>δ</italic>(<italic>x</italic>, <italic>y</italic>) = 1 if <italic>x</italic> = <italic>y</italic> and 0 otherwise. The distribution <italic>p</italic>(<italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub>) is the CRP <xref ref-type="disp-formula" rid="pone.0162259.e054">Eq (9)</xref>. For ease of subsequent computations, we use the negative log of <xref ref-type="disp-formula" rid="pone.0162259.e060">Eq (11)</xref>:
<disp-formula id="pone.0162259.e061">
<alternatives>
<graphic id="pone.0162259.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e061" xlink:type="simple"/>
<mml:math display="block" id="M61">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>E</mml:mi>
<mml:mo>=</mml:mo>
<mml:mo>-</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:munderover>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>:</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:munder>
<mml:mtext>ln </mml:mtext>
<mml:mi>f</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mrow>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:msubsup>
<mml:mi>θ</mml:mi>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msubsup>
</mml:mfenced>
<mml:mo>-</mml:mo>
<mml:mi>K</mml:mi>
<mml:mspace width="0.166667em"/>
<mml:mtext>ln</mml:mtext>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:munderover>
<mml:mtext>ln</mml:mtext>
<mml:mo>Γ</mml:mo>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfenced>
<mml:mo>-</mml:mo>
<mml:mi>C</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>N</mml:mi>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
where <inline-formula id="pone.0162259.e062"><alternatives><graphic id="pone.0162259.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:mi>C</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mtext>ln</mml:mtext> <mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> is a function which depends upon only <italic>N</italic><sub>0</sub> and <italic>N</italic>. This can be omitted in the MAP-DP algorithm because it does not change over iterations of the main loop but should be included when estimating <italic>N</italic><sub>0</sub> using the methods proposed in Appendix F. The quantity <xref ref-type="disp-formula" rid="pone.0162259.e061">Eq (12)</xref> plays an analogous role to the objective function <xref ref-type="disp-formula" rid="pone.0162259.e014">Eq (1)</xref> in <italic>K</italic>-means. We wish to maximize <xref ref-type="disp-formula" rid="pone.0162259.e060">Eq (11)</xref> over the only remaining random quantity in this model: the cluster assignments <italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub>, which is equivalent to minimizing <xref ref-type="disp-formula" rid="pone.0162259.e061">Eq (12)</xref> with respect to <italic>z</italic>. This minimization is performed iteratively by optimizing over each cluster indicator <italic>z</italic><sub><italic>i</italic></sub>, holding the rest, <italic>z</italic><sub><italic>j</italic>:<italic>j</italic>≠<italic>i</italic></sub>, fixed. This is our MAP-DP algorithm, described in Algorithm 3 below.</p>
<p>For each data point <italic>x</italic><sub><italic>i</italic></sub>, given <italic>z</italic><sub><italic>i</italic></sub> = <italic>k</italic>, we first update the posterior cluster hyper parameters <inline-formula id="pone.0162259.e063"><alternatives><graphic id="pone.0162259.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> based on all data points assigned to cluster <italic>k</italic>, but excluding the data point <italic>x</italic><sub><italic>i</italic></sub> [<xref ref-type="bibr" rid="pone.0162259.ref016">16</xref>]. This update allows us to compute the following quantities for each existing cluster <italic>k</italic> ∈ 1, … <italic>K</italic>, and for a new cluster <italic>K</italic> + 1:
<disp-formula id="pone.0162259.e064">
<alternatives>
<graphic id="pone.0162259.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e064" xlink:type="simple"/>
<mml:math display="block" id="M64">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:msub>
<mml:mi>d</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mo>=</mml:mo>
</mml:mtd>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mtext>ln</mml:mtext>
<mml:mspace width="0.166667em"/>
<mml:mi>f</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mrow>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:msubsup>
<mml:mi>θ</mml:mi>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msubsup>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="right">
<mml:msub>
<mml:mi>d</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>K</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mo>=</mml:mo>
</mml:mtd>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mtext>ln</mml:mtext>
<mml:mspace width="0.166667em"/>
<mml:mi>f</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mrow>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mi>θ</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula></p>
<p>Now, the quantity <inline-formula id="pone.0162259.e065"><alternatives><graphic id="pone.0162259.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mtext>ln </mml:mtext> <mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the negative log of the probability of assigning data point <italic>x</italic><sub><italic>i</italic></sub> to cluster <italic>k</italic>, or if we abuse notation somewhat and define <inline-formula id="pone.0162259.e066"><alternatives><graphic id="pone.0162259.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>≡</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, assigning instead to a new cluster <italic>K</italic> + 1. Therefore, the MAP assignment for <italic>x</italic><sub><italic>i</italic></sub> is obtained by computing <inline-formula id="pone.0162259.e067"><alternatives><graphic id="pone.0162259.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mrow><mml:msub><mml:mi>z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo form="prefix">arg</mml:mo> <mml:msub><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>[</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mtext>ln </mml:mtext> <mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Then the algorithm moves on to the next data point <italic>x</italic><sub><italic>i</italic>+1</sub>. Detailed expressions for different data types and corresponding predictive distributions <italic>f</italic> are given in (<xref ref-type="supplementary-material" rid="pone.0162259.s003">S1 Material</xref>), including the spherical Gaussian case given in Algorithm 2.</p>
<p>The objective function <xref ref-type="disp-formula" rid="pone.0162259.e061">Eq (12)</xref> is used to assess convergence, and when changes between successive iterations are smaller than <italic>ϵ</italic>, the algorithm terminates. MAP-DP is guaranteed not to increase <xref ref-type="disp-formula" rid="pone.0162259.e061">Eq (12)</xref> at each iteration and therefore the algorithm will converge [<xref ref-type="bibr" rid="pone.0162259.ref025">25</xref>]. By contrast to SVA-based algorithms, the closed form likelihood <xref ref-type="disp-formula" rid="pone.0162259.e060">Eq (11)</xref> can be used to estimate hyper parameters, such as the concentration parameter <italic>N</italic><sub>0</sub> (see Appendix F), and can be used to make predictions for new <italic>x</italic> data (see Appendix D). In contrast to <italic>K</italic>-means, there exists a well founded, model-based way to infer <italic>K</italic> from data.</p>
<p>We summarize all the steps in Algorithm 3. The issue of randomisation and how it can enhance the robustness of the algorithm is discussed in Appendix B. During the execution of both K-means and MAP-DP empty clusters may be allocated and this can effect the computational performance of the algorithms; we discuss this issue in Appendix A.</p>
<p>For multivariate data a particularly simple form for the predictive density is to assume independent features. This means that the predictive distributions <italic>f</italic>(<italic>x</italic>|<italic>θ</italic>) over the data will factor into products with <italic>M</italic> terms, <inline-formula id="pone.0162259.e068"><alternatives><graphic id="pone.0162259.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mi>m</mml:mi></mml:msup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi>θ</mml:mi> <mml:mi>m</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> where <italic>x</italic><sup><italic>m</italic></sup>, <italic>θ</italic><sup><italic>m</italic></sup> denotes the data and parameter vector for the <italic>m</italic>-th feature respectively. We term this the elliptical model. Including different types of data such as counts and real numbers is particularly simple in this model as there is no dependency between features. We demonstrate its utility in Section 6 where a multitude of data types is modeled.</p>
<table-wrap id="pone.0162259.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.t002</object-id>
<label>Table 2</label>
<caption>
<title/>
</caption>
<alternatives>
<graphic id="pone.0162259.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="left">Algorithm 3: MAP-DP (generalized algorithm)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><bold>Input</bold></td>
<td align="left"><italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>N</italic></sub>: data<break/> <italic>ϵ</italic> &gt; 0: convergence threshold<break/> <italic>N</italic><sub>0</sub>: prior count<break/> <italic>θ</italic><sub>0</sub>: prior hyper parameters</td>
</tr>
<tr>
<td align="right"><bold>Output</bold></td>
<td align="left"><italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub>: cluster assignments<break/> <italic>K</italic>: number of clusters</td>
</tr>
<tr>
<td align="right"><bold>1</bold></td>
<td align="left"><italic>K</italic> = 1, <italic>z</italic><sub><italic>i</italic></sub> = 1 for all <italic>i</italic> ∈ 1, …, <italic>N</italic></td>
</tr>
<tr>
<td align="right"><bold>2</bold></td>
<td align="left"><italic>E</italic><sub>new</sub> = ∞</td>
</tr>
<tr>
<td align="right"><bold>3</bold></td>
<td align="left"><bold>repeat</bold></td>
</tr>
<tr>
<td align="right"><bold>4</bold></td>
<td align="left"> <italic>E</italic><sub>old</sub> = <italic>E</italic><sub>new</sub></td>
</tr>
<tr>
<td align="right"><bold>5</bold></td>
<td align="left"> <bold>for</bold> <italic>i</italic> ∈ 1, …, <italic>N</italic></td>
</tr>
<tr>
<td align="right"><bold>6</bold></td>
<td align="left">  <bold>for</bold> <italic>k</italic> ∈ 1, …, <italic>K</italic></td>
</tr>
<tr>
<td align="right"><bold>7</bold></td>
<td align="left">   Update cluster hyper parameters <inline-formula id="pone.0162259.e069"><alternatives><graphic id="pone.0162259.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (see (<xref ref-type="supplementary-material" rid="pone.0162259.s003">S1 Material</xref>))</td>
</tr>
<tr>
<td align="right"><bold>8</bold></td>
<td align="left">   
<inline-formula id="pone.0162259.e070">
<alternatives>
<graphic id="pone.0162259.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e070" xlink:type="simple"/>
<mml:math display="inline" id="M70">
<mml:mrow>
<mml:msub>
<mml:mi>d</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mo>-</mml:mo>
<mml:mtext>ln </mml:mtext>
<mml:mi>f</mml:mi>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mrow>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:msubsup>
<mml:mi>θ</mml:mi>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="right"><bold>9</bold></td>
<td align="left">  <italic>d</italic><sub><italic>i</italic>,<italic>K</italic>+1</sub> = −ln <italic>f</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>θ</italic><sub>0</sub>)</td>
</tr>
<tr>
<td align="right"><bold>10</bold></td>
<td align="left">  
<inline-formula id="pone.0162259.e071">
<alternatives>
<graphic id="pone.0162259.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e071" xlink:type="simple"/>
<mml:math display="inline" id="M71">
<mml:mrow>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mo form="prefix">arg min</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>∈</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>,</mml:mo><mml:mo>…</mml:mo>
<mml:mo>,</mml:mo>
<mml:mi>K</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>[</mml:mo>
<mml:msub>
<mml:mi>d</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:mtext>ln </mml:mtext>
<mml:msubsup>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="right"><bold>11</bold></td>
<td align="left">  <bold>if</bold> <italic>z</italic><sub><italic>i</italic></sub> = <italic>K</italic> + 1</td>
</tr>
<tr>
<td align="right"><bold>12</bold></td>
<td align="left">   <italic>K</italic> = <italic>K</italic> + 1</td>
</tr>
<tr>
<td align="right"><bold>13</bold></td>
<td align="left"> 
<inline-formula id="pone.0162259.e072">
<alternatives>
<graphic id="pone.0162259.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e072" xlink:type="simple"/>
<mml:math display="inline" id="M72">
<mml:mrow>
<mml:msub>
<mml:mi>E</mml:mi>
<mml:mtext>new</mml:mtext>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:msubsup>
<mml:msub>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>:</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>d</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:mi>K</mml:mi>
<mml:mtext> ln </mml:mtext>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:msubsup>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>K</mml:mi>
</mml:msubsup>
<mml:mo form="prefix">log</mml:mo>
<mml:mtext> </mml:mtext>
<mml:mo>Γ</mml:mo>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="right"><bold>14</bold></td>
<td align="left"><bold>until</bold> <italic>E</italic><sub>old</sub> − <italic>E</italic><sub>new</sub> &lt; <italic>ϵ</italic></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="sec010">
<title>5 Study of synthetic data</title>
<p>In this section we evaluate the performance of the MAP-DP algorithm on six different synthetic Gaussian data sets with <italic>N</italic> = 4000 points. All these experiments use multivariate normal distribution with multivariate Student-t predictive distributions <italic>f</italic>(<italic>x</italic>|<italic>θ</italic>) (see (<xref ref-type="supplementary-material" rid="pone.0162259.s003">S1 Material</xref>)). The data sets have been generated to demonstrate some of the non-obvious problems with the <italic>K</italic>-means algorithm. Comparisons between MAP-DP, <italic>K</italic>-means, E-M and the Gibbs sampler demonstrate the ability of MAP-DP to overcome those issues with minimal computational and conceptual “overhead”. Both the E-M algorithm and the Gibbs sampler can also be used to overcome most of those challenges, however both aim to estimate the posterior density rather than clustering the data and so require significantly more computational effort.</p>
<p>The true clustering assignments are known so that the performance of the different algorithms can be objectively assessed. For the purpose of illustration we have generated two-dimensional data with three, visually separable clusters, to highlight the specific problems that arise with <italic>K</italic>-means. To ensure that the results are stable and reproducible, we have performed multiple restarts for <italic>K</italic>-means, MAP-DP and E-M to avoid falling into obviously sub-optimal solutions. MAP-DP restarts involve a random permutation of the ordering of the data.</p>
<p><italic>K</italic>-means and E-M are restarted with randomized parameter initializations. Note that the initialization in MAP-DP is trivial as all points are just assigned to a single cluster, furthermore, the clustering output is less sensitive to this type of initialization. At the same time, <italic>K</italic>-means and the E-M algorithm require setting initial values for the cluster centroids <italic>μ</italic><sub>1</sub>, …, <italic>μ</italic><sub><italic>K</italic></sub>, the number of clusters <italic>K</italic> and in the case of E-M, values for the cluster covariances <italic>Σ</italic><sub>1</sub>, …, <italic>Σ</italic><sub><italic>K</italic></sub> and cluster weights <italic>π</italic><sub>1</sub>, …, <italic>π</italic><sub><italic>K</italic></sub>. The clustering output is quite sensitive to this initialization: for the <italic>K</italic>-means algorithm we have used the seeding heuristic suggested in [<xref ref-type="bibr" rid="pone.0162259.ref032">32</xref>] for initialiazing the centroids (also known as the <italic>K</italic>-means++ algorithm); herein the E-M has been given an advantage and is initialized with the true generating parameters leading to quicker convergence. In all of the synthethic experiments, we fix the prior count to <italic>N</italic><sub>0</sub> = 3 for both MAP-DP and Gibbs sampler and the prior hyper parameters <italic>θ</italic><sub>0</sub> are evaluated using <italic>empirical bayes</italic> (see Appendix F).</p>
<p>To evaluate algorithm performance we have used <italic>normalized mutual information</italic> (NMI) between the true and estimated partition of the data (<xref ref-type="table" rid="pone.0162259.t003">Table 3</xref>). The NMI between two random variables is a measure of mutual dependence between them that takes values between 0 and 1 where the higher score means stronger dependence. NMI scores close to 1 indicate good agreement between the estimated and true clustering of the data.</p>
<table-wrap id="pone.0162259.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.t003</object-id>
<label>Table 3</label>
<caption>
<title>Comparing the clustering performance of MAP-DP (multivariate normal variant), <italic>K</italic>-means, E-M and Gibbs sampler in terms of NMI which has range [0, 1] on synthetic Gaussian data generated using a GMM with <italic>K</italic> = 3.</title>
<p>NMI closer to 1 indicates better clustering.</p>
</caption>
<alternatives>
<graphic id="pone.0162259.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Geometry</th>
<th align="center">Shared geometry?</th>
<th align="center">Shared population?</th>
<th align="center">Section</th>
<th align="center">NMI <italic>K</italic>-means</th>
<th align="center">NMI MAP-DP</th>
<th align="center">NMI E-M</th>
<th align="center">NMI Gibbs</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Spherical</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="char" char=".">5.1</td>
<td align="char" char=".">0.57</td>
<td align="char" char=".">0.97</td>
<td align="char" char=".">0.89</td>
<td align="char" char=".">0.92</td>
</tr>
<tr>
<td align="center">Spherical</td>
<td align="center">Yes</td>
<td align="center">No</td>
<td align="char" char=".">5.2</td>
<td align="char" char=".">0.48</td>
<td align="char" char=".">0.98</td>
<td align="char" char=".">0.98</td>
<td align="char" char=".">0.86</td>
</tr>
<tr>
<td align="center">Spherical</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
<td align="char" char=".">5.3</td>
<td align="char" char=".">0.67</td>
<td align="char" char=".">0.93</td>
<td align="char" char=".">0.65</td>
<td align="char" char=".">0.91</td>
</tr>
<tr>
<td align="center">Elliptical</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="char" char=".">5.4</td>
<td align="char" char=".">0.56</td>
<td align="char" char=".">0.98</td>
<td align="char" char=".">0.93</td>
<td align="char" char=".">0.90</td>
</tr>
<tr>
<td align="center">Elliptical</td>
<td align="center">No</td>
<td align="center">No</td>
<td align="char" char=".">5.5</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">0.99</td>
<td align="char" char=".">1.00</td>
</tr>
<tr>
<td align="center">Elliptical</td>
<td align="center">No</td>
<td align="center">No</td>
<td align="char" char=".">5.6</td>
<td align="char" char=".">0.56</td>
<td align="char" char=".">0.88</td>
<td align="char" char=".">0.86</td>
<td align="char" char=".">0.84</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>We also test the ability of regularization methods discussed in Section 3 to lead to sensible conclusions about the underlying number of clusters <italic>K</italic> in <italic>K</italic>-means. We use the BIC as a representative and popular approach from this class of methods. For all of the data sets in Sections 5.1 to 5.6, we vary <italic>K</italic> between 1 and 20 and repeat <italic>K</italic>-means 100 times with randomized initializations. That is, we estimate BIC score for <italic>K</italic>-means at convergence for <italic>K</italic> = 1, …, 20 and repeat this cycle 100 times to avoid conclusions based on sub-optimal clustering results. The theory of BIC suggests that, on each cycle, the value of <italic>K</italic> between 1 and 20 that maximizes the BIC score is the optimal <italic>K</italic> for the algorithm under test. We report the value of <italic>K</italic> that maximizes the BIC score over all cycles.</p>
<p>We also report the number of iterations to convergence of each algorithm in <xref ref-type="table" rid="pone.0162259.t004">Table 4</xref> as an indication of the relative computational cost involved, where the iterations include only a single run of the corresponding algorithm and ignore the number of restarts. The Gibbs sampler was run for 600 iterations for each of the data sets and we report the number of iterations until the draw from the chain that provides the best fit of the mixture model. Running the Gibbs sampler for a longer number of iterations is likely to improve the fit. Due to its stochastic nature, random restarts are not common practice for the Gibbs sampler.</p>
<table-wrap id="pone.0162259.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.t004</object-id>
<label>Table 4</label>
<caption>
<title>Number of iterations to convergence of MAP-DP, <italic>K</italic>-means, E-M and Gibbs sampling where one iteration consists of a full sweep through the data and the model parameters.</title>
<p>The computational cost per iteration is not exactly the same for different algorithms, but it is comparable. The number of iterations due to randomized restarts have not been included.</p>
</caption>
<alternatives>
<graphic id="pone.0162259.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Section</th>
<th align="center">Convergence <italic>K</italic>-means</th>
<th align="center">Convergence MAP-DP</th>
<th align="center">Convergence E-M</th>
<th align="center">Convergence Gibbs sampler 1</th>
</tr>
</thead>
<tbody>
<tr>
<td align="char" char=".">5.1</td>
<td align="center">6</td>
<td align="center">11</td>
<td align="center">10</td>
<td align="center">299</td>
</tr>
<tr>
<td align="char" char=".">5.2</td>
<td align="center">13</td>
<td align="center">5</td>
<td align="center">21</td>
<td align="center">403</td>
</tr>
<tr>
<td align="char" char=".">5.3</td>
<td align="center">5</td>
<td align="center">5</td>
<td align="center">32</td>
<td align="center">292</td>
</tr>
<tr>
<td align="char" char=".">5.4</td>
<td align="center">15</td>
<td align="center">11</td>
<td align="center">6</td>
<td align="center">330</td>
</tr>
<tr>
<td align="char" char=".">5.5</td>
<td align="center">6</td>
<td align="center">7</td>
<td align="center">21</td>
<td align="center">459</td>
</tr>
<tr>
<td align="char" char=".">5.6</td>
<td align="center">9</td>
<td align="center">11</td>
<td align="center">7</td>
<td align="center">302</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<sec id="sec011">
<title>5.1 Spherical data, unequal cluster radius and density</title>
<p>In this example we generate data from three spherical Gaussian distributions with different radii. The data is well separated and there is an equal number of points in each cluster. In <xref ref-type="fig" rid="pone.0162259.g001">Fig 1</xref> we can see that <italic>K</italic>-means separates the data into three almost <italic>equal-volume</italic> clusters. In <italic>K</italic>-means clustering, volume is not measured in terms of the density of clusters, but rather the geometric volumes defined by hyper-planes separating the clusters. The algorithm does not take into account cluster density, and as a result it splits large radius clusters and merges small radius ones. This would obviously lead to inaccurate conclusions about the structure in the data. It is unlikely that this kind of clustering behavior is desired in practice for this dataset. The poor performance of <italic>K</italic>-means in this situation reflected in a low NMI score (0.57, <xref ref-type="table" rid="pone.0162259.t003">Table 3</xref>). By contrast, MAP-DP takes into account the density of each cluster and learns the true underlying clustering almost perfectly (NMI of 0.97). This shows that <italic>K</italic>-means can fail even when applied to spherical data, provided only that the cluster radii are different. Assuming the number of clusters <italic>K</italic> is unknown and using <italic>K</italic>-means with BIC, we can estimate the true number of clusters <italic>K</italic> = 3, but this involves defining a range of possible values for <italic>K</italic> and performing multiple restarts for each value in that range. Considering a range of values of <italic>K</italic> between 1 and 20 and performing 100 random restarts for each value of <italic>K</italic>, the estimated value for the number of clusters is <italic>K</italic> = 2, an underestimate of the true number of clusters <italic>K</italic> = 3. The highest BIC score occurred after 15 cycles of <italic>K</italic> between 1 and 20 and as a result, <italic>K</italic>-means with BIC required significantly longer run time than MAP-DP, to correctly estimate <italic>K</italic>.</p>
</sec>
<sec id="sec012">
<title>5.2 Spherical data, equal cluster radius, unequal density</title>
<p>In this next example, data is generated from three spherical Gaussian distributions with equal radii, the clusters are well-separated, but with a different number of points in each cluster. In <xref ref-type="fig" rid="pone.0162259.g004">Fig 4</xref> we observe that the most populated cluster containing 69% of the data is split by <italic>K</italic>-means, and a lot of its data is assigned to the smallest cluster. So, despite the unequal density of the true clusters, <italic>K</italic>-means divides the data into three almost equally-populated clusters. Again, this behaviour is non-intuitive: it is unlikely that the <italic>K</italic>-means clustering result here is what would be desired or expected, and indeed, <italic>K</italic>-means scores badly (NMI of 0.48) by comparison to MAP-DP which achieves near perfect clustering (NMI of 0.98. <xref ref-type="table" rid="pone.0162259.t003">Table 3</xref>). The reason for this poor behaviour is that, if there is <italic>any</italic> overlap between clusters, <italic>K</italic>-means will attempt to resolve the ambiguity by dividing up the data space into equal-volume regions. This will happen even if all the clusters are spherical with equal radius. Again, assuming that <italic>K</italic> is unknown and attempting to estimate using BIC, after 100 runs of <italic>K</italic>-means across the whole range of <italic>K</italic>, we estimate that <italic>K</italic> = 2 maximizes the BIC score, again an underestimate of the true number of clusters <italic>K</italic> = 3.</p>
</sec>
<sec id="sec013">
<title>5.3 Spherical data, equal cluster radius and density, with outliers</title>
<p>Next we consider data generated from three spherical Gaussian distributions with equal radii and equal density of data points. However, we add two pairs of outlier points, marked as stars in <xref ref-type="fig" rid="pone.0162259.g003">Fig 3</xref>. We see that <italic>K</italic>-means groups together the top right outliers into a cluster of their own. As a result, one of the pre-specified <italic>K</italic> = 3 clusters is wasted and there are only two clusters left to describe the actual spherical clusters. So, <italic>K</italic>-means merges two of the underlying clusters into one and gives misleading clustering for at least a third of the data. For this behavior of <italic>K</italic>-means to be avoided, we would need to have information not only about how many groups we would expect in the data, but also how many outlier points might occur. By contrast, since MAP-DP estimates <italic>K</italic>, it can adapt to the presence of outliers. MAP-DP assigns the two pairs of outliers into separate clusters to estimate <italic>K</italic> = 5 groups, and correctly clusters the remaining data into the three true spherical Gaussians. Again, <italic>K</italic>-means scores poorly (NMI of 0.67) compared to MAP-DP (NMI of 0.93, <xref ref-type="table" rid="pone.0162259.t003">Table 3</xref>). From this it is clear that <italic>K</italic>-means is not “robust” to the presence of even a trivial number of outliers, which can severely degrade the quality of the clustering result. For many applications, it is infeasible to remove all of the outliers before clustering, particularly when the data is high-dimensional. If we assume that <italic>K</italic> is unknown for <italic>K</italic>-means and estimate it using the BIC score, we estimate <italic>K</italic> = 4, an overestimate of the true number of clusters <italic>K</italic> = 3. We further observe that even the E-M algorithm with Gaussian components does not handle outliers well and the nonparametric MAP-DP and Gibbs sampler are clearly the more robust option in such scenarios.</p>
</sec>
<sec id="sec014">
<title>5.4 Elliptical data with equal cluster volumes and densities, rotated</title>
<p>So far, in all cases above the data is spherical. By contrast, we next turn to non-spherical, in fact, elliptical data. This next experiment demonstrates the inability of <italic>K</italic>-means to correctly cluster data which is trivially separable by eye, even when the clusters have negligible overlap and exactly equal volumes and densities, but simply because the data is non-spherical and some clusters are rotated relative to the others. <xref ref-type="fig" rid="pone.0162259.g002">Fig 2</xref> shows that <italic>K</italic>-means produces a very misleading clustering in this situation. 100 random restarts of <italic>K</italic>-means fail to find any better clustering, with <italic>K</italic>-means scoring badly (NMI of 0.56) by comparison to MAP-DP (0.98, <xref ref-type="table" rid="pone.0162259.t003">Table 3</xref>). In fact, for this data, we find that even if <italic>K</italic>-means is initialized with the <italic>true</italic> cluster assignments, this is not a fixed point of the algorithm and <italic>K</italic>-means will continue to degrade the true clustering and converge on the poor solution shown in <xref ref-type="fig" rid="pone.0162259.g002">Fig 2</xref>. So, this clustering solution obtained at <italic>K</italic>-means convergence, as measured by the objective function value <italic>E</italic> <xref ref-type="disp-formula" rid="pone.0162259.e014">Eq (1)</xref>, appears to actually be better (i.e. lower) than the true clustering of the data. Essentially, for some non-spherical data, the objective function which <italic>K</italic>-means attempts to minimize is fundamentally incorrect: even if <italic>K</italic>-means can find a small value of <italic>E</italic>, it is solving the wrong problem. Furthermore, BIC does not provide us with a sensible conclusion for the correct underlying number of clusters, as it estimates <italic>K</italic> = 9 after 100 randomized restarts.</p>
<p>It should be noted that in some rare, non-spherical cluster cases, global transformations of the entire data can be found to “spherize” it. For example, if the data is elliptical and all the cluster covariances are the same, then there is a global linear transformation which makes all the clusters spherical. However, finding such a transformation, if one exists, is likely at least as difficult as first correctly clustering the data.</p>
</sec>
<sec id="sec015">
<title>5.5 Elliptical data with different cluster volumes, geometries and densities, no cluster overlap</title>
<p>This data is generated from three elliptical Gaussian distributions with different covariances and different number of points in each cluster. In this case, despite the clusters not being spherical, equal density and radius, the clusters are so well-separated that <italic>K</italic>-means, as with MAP-DP, can perfectly separate the data into the correct clustering solution (see <xref ref-type="fig" rid="pone.0162259.g005">Fig 5</xref>). So, for data which is trivially separable by eye, <italic>K</italic>-means can produce a meaningful result. However, it is questionable how often in practice one would expect the data to be so clearly separable, and indeed, whether computational cluster analysis is actually necessary in this case. Even in this trivial case, the value of <italic>K</italic> estimated using BIC is <italic>K</italic> = 4, an overestimate of the true number of clusters <italic>K</italic> = 3.</p>
<fig id="pone.0162259.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Clustering solution obtained by <italic>K</italic>-means and MAP-DP for synthetic elliptical Gaussian data.</title>
<p>The clusters are trivially well-separated, and even though they have different densities (12% of the data is blue, 28% yellow cluster, 60% orange) and elliptical cluster geometries, <italic>K</italic>-means produces a near-perfect clustering, as with MAP-DP. This shows that <italic>K</italic>-means can in some instances work when the clusters are not equal radii with shared densities, but only when the clusters are so well-separated that the clustering can be trivially performed by eye.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec016">
<title>5.6 Elliptical data with different cluster volumes and densities, significant overlap</title>
<p>Having seen that MAP-DP works well in cases where <italic>K</italic>-means can fail badly, we will examine a clustering problem which should be a challenge for MAP-DP. The data is generated from three elliptical Gaussian distributions with different covariances and different number of points in each cluster. There is significant overlap between the clusters. MAP-DP manages to correctly learn the number of clusters in the data and obtains a good, meaningful solution which is close to the truth (<xref ref-type="fig" rid="pone.0162259.g006">Fig 6</xref>, NMI score 0.88, <xref ref-type="table" rid="pone.0162259.t003">Table 3</xref>). The small number of data points mislabeled by MAP-DP are all in the overlapping region. By contrast, <italic>K</italic>-means fails to perform a meaningful clustering (NMI score 0.56) and mislabels a large fraction of the data points that are outside the overlapping region. This shows that MAP-DP, unlike <italic>K</italic>-means, can easily accommodate departures from sphericity even in the context of significant cluster overlap. As the cluster overlap increases, MAP-DP degrades but always leads to a much more interpretable solution than <italic>K</italic>-means. In this example, the number of clusters can be correctly estimated using BIC.</p>
<fig id="pone.0162259.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Clustering solution obtained by <italic>K</italic>-means and MAP-DP for overlapping, synthetic elliptical Gaussian data.</title>
<p>All clusters have different elliptical covariances, and the data is unequally distributed across different clusters (30% blue cluster, 5% yellow cluster, 65% orange). The significant overlap is challenging even for MAP-DP, but it produces a meaningful clustering solution where the only mislabelled points lie in the overlapping region. <italic>K</italic>-means does not produce a clustering result which is faithful to the actual clustering.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.g006" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec017">
<title>6 Example application: sub-typing of parkinsonism and Parkinson’s disease</title>
<p><italic>Parkinsonism</italic> is the clinical syndrome defined by the combination of bradykinesia (slowness of movement) with tremor, rigidity or postural instability. This clinical syndrome is most commonly caused by <italic>Parkinson’s disease</italic>(PD), although can be caused by drugs or other conditions such as multi-system atrophy. Because of the common clinical features shared by these other causes of parkinsonism, the clinical diagnosis of PD in vivo is only 90% accurate when compared to post-mortem studies. This diagnostic difficulty is compounded by the fact that PD itself is a heterogeneous condition with a wide variety of clinical phenotypes, likely driven by different disease processes. These include wide variations in both the <italic>motor</italic> (movement, such as tremor and gait) and <italic>non-motor</italic> symptoms (such as cognition and sleep disorders). While the motor symptoms are more specific to parkinsonism, many of the non-motor symptoms associated with PD are common in older patients which makes clustering these symptoms more complex. Despite significant advances, the aetiology (underlying cause) and pathogenesis (how the disease develops) of this disease remain poorly understood, and no disease
modifying treatment has yet been found.</p>
<p>The diagnosis of PD is therefore likely to be given to some patients with other causes of their symptoms. Also, even with the correct diagnosis of PD, they are likely to be affected by different disease mechanisms which may vary in their response to treatments, thus reducing the power of clinical trials. Despite numerous attempts to classify PD into sub-types using empirical or data-driven approaches (using mainly <italic>K</italic>-means cluster analysis), there is no widely accepted consensus on classification.</p>
<p>One approach to identifying PD and its subtypes would be through appropriate clustering techniques applied to comprehensive data sets representing many of the physiological, genetic and behavioral features of patients with parkinsonism. We expect that a clustering technique should be able to identify PD subtypes as distinct from other conditions. In that context, using methods like <italic>K</italic>-means and finite mixture models would severely limit our analysis as we would need to fix a-priori the number of sub-types <italic>K</italic> for which we are looking. Estimating that <italic>K</italic> is still an open question in PD research. Potentially, the number of sub-types is not even fixed, instead, with increasing amounts of clinical data on patients being collected, we might expect a growing number of variants of the disease to be observed. A natural probabilistic model which incorporates that assumption is the DP mixture model. Here we make use of MAP-DP clustering as a computationally convenient alternative to fitting the DP mixture.</p>
<p>We have analyzed the data for 527 patients from the <italic>PD data and organizing center</italic> (PD-DOC) clinical reference database, which was developed to facilitate the planning, study design, and statistical analysis of PD-related data [<xref ref-type="bibr" rid="pone.0162259.ref033">33</xref>]. The subjects consisted of patients referred with suspected parkinsonism thought to be caused by PD. Each patient was rated by a specialist on a percentage probability of having PD, with 90-100% considered as probable PD (this variable was not included in the analysis). This data was collected by several independent clinical centers in the US, and organized by the University of Rochester, NY. Ethical approval was obtained by the independent ethical review boards of each of the participating centres. From that database, we use the PostCEPT data.</p>
<p>For each patient with parkinsonism there is a comprehensive set of features collected through various questionnaires and clinical tests, in total 215 features per patient. The features are of different types such as yes/no questions, finite ordinal numerical rating scales, and others, each of which can be appropriately modeled by e.g. Bernoulli (yes/no), binomial (ordinal), categorical (nominal) and Poisson (count) random variables (see (<xref ref-type="supplementary-material" rid="pone.0162259.s003">S1 Material</xref>)). For simplicity and interpretability, we assume the different features are independent and use the elliptical model defined in Section 4.</p>
<p>A common problem that arises in health informatics is missing data. When using <italic>K</italic>-means this problem is usually separately addressed prior to clustering by some type of <italic>imputation</italic> method. However, in the MAP-DP framework, we can simultaneously address the problems of clustering and missing data. In the CRP mixture model <xref ref-type="disp-formula" rid="pone.0162259.e059">Eq (10)</xref> the missing values are treated as an additional set of random variables and MAP-DP proceeds by updating them at every iteration. As a result, the missing values and cluster assignments will depend upon each other so that they are consistent with the observed feature data and each other.</p>
<p>We initialized MAP-DP with 10 randomized permutations of the data and iterated to convergence on each randomized restart. The results (Tables <xref ref-type="table" rid="pone.0162259.t005">5</xref> and <xref ref-type="table" rid="pone.0162259.t006">6</xref>) suggest that the PostCEPT data is clustered into 5 groups with 50%, 43%, 5%, 1.6% and 0.4% of the data in each cluster. We then performed a Student’s t-test at <italic>α</italic> = 0.01 significance level to identify features that differ significantly between clusters. As with most hypothesis tests, we should always be cautious when drawing conclusions, particularly considering that not all of the mathematical assumptions underlying the hypothesis test have necessarily been met. Nevertheless, this analysis suggest that there are 61 features that differ significantly between the two largest clusters. Note that if, for example, none of the features were significantly different between clusters, this would call into question the extent to which the clustering is meaningful at all. We assume that the features differing the most among clusters are the same features that lead the patient data to cluster. By contrast, features that have indistinguishable distributions across the different groups should not have significant influence on the clustering.</p>
<table-wrap id="pone.0162259.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.t005</object-id>
<label>Table 5</label>
<caption>
<title>Significant features of parkinsonism from the PostCEPT/PD-DOC clinical reference data across clusters (groups) obtained using MAP-DP with appropriate distributional models for each feature.</title>
<p>Each entry in the table is the probability of PostCEPT parkinsonism patient answering “yes” in each cluster (group).</p>
</caption>
<alternatives>
<graphic id="pone.0162259.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.t005" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center">Group 1</th>
<th align="center">Group 2</th>
<th align="center">Group 3</th>
<th align="center">Group 4</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Resting tremor (present and typical)</td>
<td align="char" char=".">0.81</td>
<td align="char" char=".">0.91</td>
<td align="char" char=".">0.42</td>
<td align="char" char=".">0.78</td>
</tr>
<tr>
<td align="center">Resting tremor (absent)</td>
<td align="char" char=".">0.14</td>
<td align="char" char=".">0.06</td>
<td align="char" char=".">0.42</td>
<td align="char" char=".">0.11</td>
</tr>
<tr>
<td align="center">Symptoms in the past week</td>
<td align="char" char=".">0.58</td>
<td align="char" char=".">0.94</td>
<td align="char" char=".">1.00</td>
<td align="char" char=".">0.67</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pone.0162259.t006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0162259.t006</object-id>
<label>Table 6</label>
<caption>
<title>Significant features of parkinsonism from the PostCEPT/PD-DOC clinical reference data across clusters obtained using MAP-DP with appropriate distributional models for each feature.</title>
<p>Each entry in the table is the mean score of the ordinal data in each row. Lower numbers denote condition closer to healthy. Note that the Hoehn and Yahr stage is re-mapped from {0, 1.0, 1.5, 2, 2.5, 3, 4, 5} to {0, 1, 2, 3, 4, 5, 6, 7} respectively.</p>
</caption>
<alternatives>
<graphic id="pone.0162259.t006g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.t006" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Mean score</th>
<th align="center">Scale</th>
<th align="center">Group1</th>
<th align="center">Group 2</th>
<th align="center">Group 3</th>
<th align="center">Group 4</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Facial expression</td>
<td align="center">0-4</td>
<td align="char" char=".">1.42</td>
<td align="char" char=".">1.47</td>
<td align="char" char=".">0.42</td>
<td align="char" char=".">2.33</td>
</tr>
<tr>
<td align="center">Tremor at rest (face, lips and chin)</td>
<td align="center">0-4</td>
<td align="char" char=".">0.05</td>
<td align="char" char=".">0.32</td>
<td align="char" char=".">0.23</td>
<td align="char" char=".">1.00</td>
</tr>
<tr>
<td align="center">Rigidity (right upper extremity)</td>
<td align="center">0-4</td>
<td align="char" char=".">0.90</td>
<td align="char" char=".">1.30</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">2.11</td>
</tr>
<tr>
<td align="center">Rigidity (left upper extremity)</td>
<td align="center">0-4</td>
<td align="char" char=".">0.62</td>
<td align="char" char=".">1.33</td>
<td align="char" char=".">0.19</td>
<td align="char" char=".">2.00</td>
</tr>
<tr>
<td align="center">Rigidity (right lower extremity)</td>
<td align="center">0-4</td>
<td align="char" char=".">0.46</td>
<td align="char" char=".">0.97</td>
<td align="char" char=".">0.04</td>
<td align="char" char=".">2.56</td>
</tr>
<tr>
<td align="center">Rigidity (left lower extremity)</td>
<td align="center">0-4</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">1.06</td>
<td align="char" char=".">0.04</td>
<td align="char" char=".">2.67</td>
</tr>
<tr>
<td align="center">Finger taps (left hand)</td>
<td align="center">0-4</td>
<td align="char" char=".">0.65</td>
<td align="char" char=".">1.41</td>
<td align="char" char=".">0.50</td>
<td align="char" char=".">2.33</td>
</tr>
<tr>
<td align="center">PD state during exam</td>
<td align="center">1-4</td>
<td align="char" char=".">2.65</td>
<td align="char" char=".">3.85</td>
<td align="char" char=".">4.00</td>
<td align="char" char=".">3.00</td>
</tr>
<tr>
<td align="center">Modified Hoehn and Yahr stage</td>
<td align="center">0-7</td>
<td align="char" char=".">2.46</td>
<td align="char" char=".">3.19</td>
<td align="char" char=".">1.62</td>
<td align="char" char=".">6.33</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>We applied the significance test to each pair of clusters excluding the smallest one as it consists of only 2 patients. Exploring the full set of multilevel correlations occurring between 215 features among 4 groups would be a challenging task that would change the focus of this work. We therefore concentrate only on the pairwise-significant features between Groups 1-4, since the hypothesis test has higher power when comparing larger groups of data. The clustering results suggest many other features not reported here that differ significantly between the different pairs of clusters that could be further explored. Individual analysis on Group 5 shows that it consists of 2 patients with advanced parkinsonism but are unlikely to have PD itself (both were thought to have &lt;50% probability of having PD).</p>
<p>Due to the nature of the study and the fact that very little is yet known about the sub-typing of PD, direct numerical validation of the results is not feasible. The purpose of the study is to learn in a completely unsupervised way, an interpretable clustering on this comprehensive set of patient data, and then interpret the resulting clustering by reference to other sub-typing studies.</p>
<p>Our analysis successfully clustered almost all the patients thought to have PD into the 2 largest groups. Only 4 out of 490 patients (which were thought to have Lewy-body dementia, multi-system atrophy and essential tremor) were included in these 2 groups, each of which had phenotypes very similar to PD. Because the unselected population of parkinsonism included a number of patients with phenotypes very different to PD, it may be that the analysis was therefore unable to distinguish the subtle differences in these cases. The fact that a few cases were not included in these group could be due to: an extreme phenotype of the condition; variance in how subjects filled in the self-rated questionnaires (either comparatively under or over stating symptoms); or that these patients were misclassified by the clinician. The inclusion of patients thought not to have PD in these two groups could also be explained by the above reasons.</p>
<p>Comparing the two groups of PD patients (Groups 1 &amp; 2), group 1 appears to have less severe symptoms across most motor and non-motor measures. Group 2 is consistent with a more aggressive or rapidly progressive form of PD, with a lower ratio of tremor to rigidity symptoms. van Rooden et al. [<xref ref-type="bibr" rid="pone.0162259.ref011">11</xref>] combined the conclusions of some of the most prominent, large-scale studies. Of these studies, 5 distinguished rigidity-dominant and tremor-dominant profiles [<xref ref-type="bibr" rid="pone.0162259.ref034">34</xref>, <xref ref-type="bibr" rid="pone.0162259.ref035">35</xref>, <xref ref-type="bibr" rid="pone.0162259.ref036">36</xref>, <xref ref-type="bibr" rid="pone.0162259.ref037">37</xref>]. Pathological correlation provides further evidence of a difference in disease mechanism between these two phenotypes. Our analysis, identifies a two subtype solution most consistent with a less severe tremor dominant group and more severe non-tremor dominant group most consistent with Gasparoli et al. [<xref ref-type="bibr" rid="pone.0162259.ref037">37</xref>].</p>
<p>These results demonstrate that even with small datasets that are common in studies on parkinsonism and PD sub-typing, MAP-DP is a useful exploratory tool for obtaining insights into the structure of the data and to formulate useful hypothesis for further research.</p>
<p>Although the clinical heterogeneity of PD is well recognized across studies [<xref ref-type="bibr" rid="pone.0162259.ref038">38</xref>], comparison of clinical sub-types is a challenging task. Studies often concentrate on a limited range of more specific clinical features. For instance, some studies concentrate only on cognitive features or on motor-disorder symptoms [<xref ref-type="bibr" rid="pone.0162259.ref005">5</xref>]. In addition, typically the cluster analysis is performed with the <italic>K</italic>-means algorithm and fixing <italic>K</italic> a-priori might seriously distort the analysis.</p>
<p>It is important to note that the clinical data itself in PD (and other neurodegenerative diseases) has inherent inconsistencies between individual cases which make sub-typing by these methods difficult: the clinical diagnosis of PD is only 90% accurate; medication causes inconsistent variations in the symptoms; clinical assessments (both self rated and clinician administered) are subjective; delayed diagnosis and the (variable) slow progression of the disease makes disease duration inconsistent. Therefore, any kind of partitioning of the data has inherent limitations in how it can be interpreted with respect to the known PD disease process. It may therefore be more appropriate to use the fully statistical DP mixture model to find the distribution of the joint data instead of focusing on the modal point estimates for each cluster. Our analysis presented here has the additional layer of complexity due to the inclusion of patients with parkinsonism without a clinical diagnosis of PD. This makes differentiating further subtypes of PD more difficult as these are likely to be far more subtle than the differences between the different causes of parkinsonism.</p>
</sec>
<sec id="sec018">
<title>7 Limitations and extensions</title>
<p>Despite the broad applicability of the <italic>K</italic>-means and MAP-DP algorithms, their simplicity limits their use in some more complex clustering tasks. When facing such problems, devising a more application-specific approach that incorporates additional information about the data may be essential. For example, in cases of high dimensional data (<italic>M</italic> &gt; &gt; <italic>N</italic>) neither <italic>K</italic>-means, nor MAP-DP are likely to be appropriate clustering choices. Methods have been proposed that specifically handle such problems, such as a family of Gaussian mixture models that can efficiently handle high dimensional data [<xref ref-type="bibr" rid="pone.0162259.ref039">39</xref>]. Since MAP-DP is derived from the nonparametric mixture model, by incorporating subspace methods into the MAP-DP mechanism, an efficient high-dimensional clustering approach can be derived using MAP-DP as a building block. We leave the detailed exposition of such extensions to MAP-DP for future work.</p>
<p>Another issue that may arise is where the data cannot be described by an exponential family distribution. Clustering such data would involve some additional approximations and steps to extend the MAP approach. Fortunately, the exponential family is a rather rich set of distributions and is often flexible enough to achieve reasonable performance even where the data cannot be exactly described by an exponential family distribution.</p>
<p>We may also wish to cluster sequential data. In this scenario <italic>hidden Markov models</italic> [<xref ref-type="bibr" rid="pone.0162259.ref040">40</xref>] have been a popular choice to replace the simpler mixture model, in this case the MAP approach can be extended to incorporate the additional time-ordering assumptions [<xref ref-type="bibr" rid="pone.0162259.ref041">41</xref>].</p>
</sec>
<sec id="sec019" sec-type="conclusions">
<title>8 Conclusion</title>
<p>This paper has outlined the major problems faced when doing clustering with <italic>K</italic>-means, by looking at it as a restricted version of the more general finite mixture model. We have presented a less restrictive procedure that retains the key properties of an underlying probabilistic model, which itself is more flexible than the finite mixture model. Making use of Bayesian nonparametrics, the new MAP-DP algorithm allows us to learn the number of clusters in the data and model more flexible cluster geometries than the spherical, Euclidean geometry of <italic>K</italic>-means. Additionally, it gives us tools to deal with missing data and to make predictions about new data points outside the training data set. At the same time, by avoiding the need for sampling and variational schemes, the complexity required to find good parameter estimates is almost as low as <italic>K</italic>-means with few conceptual changes. Like <italic>K</italic>-means, MAP-DP iteratively updates assignments of data points to clusters, but the distance in data space can be more flexible than the Euclidean distance. Unlike <italic>K</italic>-means where the number of clusters must be set <italic>a-priori</italic>, in MAP-DP, a specific parameter (the prior count) controls the rate of creation of new clusters. Hence, by a small increment in algorithmic complexity, we obtain a major increase in clustering performance and applicability, making MAP-DP a useful clustering tool for a wider range of applications than <italic>K</italic>-means.</p>
<p>MAP-DP is motivated by the need for more flexible and principled clustering techniques, that at the same time are easy to interpret, while being computationally and technically affordable for a wide range of problems and users. With recent rapid advancements in probabilistic modeling, the gap between technically sophisticated but complex models and simple yet scalable inference approaches that are usable in practice, is increasing. This is why in this work, we posit a flexible probabilistic model, yet pursue inference in that model using a straightforward algorithm that is easy to implement and interpret.</p>
<p>The generality and the simplicity of our principled, MAP-based approach makes it reasonable to adapt to many other flexible structures, that have, so far, found little practical use because of the computational complexity of their inference algorithms. Some BNP models that are somewhat related to the DP but add additional flexibility are the <italic>Pitman-Yor process</italic> which generalizes the CRP [<xref ref-type="bibr" rid="pone.0162259.ref042">42</xref>] resulting in a similar infinite mixture model but with faster cluster growth; <italic>hierarchical DPs</italic> [<xref ref-type="bibr" rid="pone.0162259.ref043">43</xref>], a principled framework for multilevel clustering; <italic>infinite Hidden Markov models</italic> [<xref ref-type="bibr" rid="pone.0162259.ref044">44</xref>] that give us machinery for clustering time-dependent data without fixing the number of states a priori; and <italic>Indian buffet processes</italic> [<xref ref-type="bibr" rid="pone.0162259.ref045">45</xref>] that underpin <italic>infinite latent feature</italic> models, which are used to model clustering problems where observations are allowed to be assigned to multiple groups.</p>
</sec>
<sec id="sec020">
<title>Appendix</title>
<sec id="sec021">
<title>A Implementation practicalities</title>
<p>As with all algorithms, implementation details can matter in practice. We discuss a few observations here:</p>
<list list-type="bullet">
<list-item>
<p><italic>Empty clusters</italic>. In MAP-DP, as with <italic>K</italic>-means, it is always possible that a cluster ceases to have any data points assigned to it. In that case, since <inline-formula id="pone.0162259.e073"><alternatives><graphic id="pone.0162259.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, then it will be impossible in future iterations for data points to be assigned to that cluster label. So, it is reasonable to drop that label and re-assign the remaining non-empty clusters because the additional empty clusters are merely a wasted computational overhead. The MAP-DP algorithm (Algorithm 3) can be readily modified to do this; the most sensible place to do this is immediately after lines 12 or 13.</p>
</list-item>
<list-item>
<p><italic>Dominating reinforcement</italic> <italic>on initialization</italic>. Collapsing out the cluster parameters causes the cluster geometry to be very robust, for example, largely insensitive to outliers. However, there is an unwanted side-effect of this robustness: because MAP-DP (Algorithm 3) is initialized with one single large cluster, the reinforcement (rich-get-richer) effect of the DP can dominate over the geometry to cause MAP-DP to become trapped in the undesirable configuration where no new clusters can be generated. (Note that this is a problem for Gibbs sampling as well, but in theory at least, Gibbs can escape local minima after sufficient iterations, whereas MAP-DP cannot). Overcoming this reinforcement requires a prior count <italic>N</italic><sub>0</sub> on the order of the magnitude of <italic>N</italic>, but this would usually create many spurious small clusters. To avoid this side-effect, a practical solution removes the reinforcement effect due to this particular initialization scheme by inserting <inline-formula id="pone.0162259.e074"><alternatives><graphic id="pone.0162259.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> in between lines 9 and 10 (Algorithm 3), only on the first iteration.</p>
</list-item>
<list-item>
<p><italic>Numerical computation of negative log likelihood</italic>. Computing the NLL (Algorithm 3 line 13) requires evaluating ln <italic>Γ</italic>(<italic>N</italic><sub><italic>k</italic></sub>) terms which are difficult to estimate with high precision for large values of <italic>N</italic><sub><italic>k</italic></sub>. As a result the NLL can develop small numerical errors which can cause the NLL to increase slightly over iterations. A simple practical fix is to replace the convergence test with absolute values, i.e. |<italic>E</italic><sub>old</sub> − <italic>E</italic><sub>new</sub>| &lt; <italic>ϵ</italic> in line 14.</p>
</list-item>
</list>
</sec>
<sec id="sec022">
<title>B Randomized restarts</title>
<p>As MAP-DP is a completely deterministic algorithm, if applied to the same data set with the same choice of input parameters, it will always produce the same clustering result. However, since the algorithm is not guaranteed to find the global maximum of the likelihood <xref ref-type="disp-formula" rid="pone.0162259.e060">Eq (11)</xref>, it is important to attempt to restart the algorithm from different initial conditions to gain confidence that the MAP-DP clustering solution is a good one. Since there are no random quantities at the start of the MAP-DP algorithm, one viable approach is to perform a random permutation of the order in which the data points are visited by the algorithm. The quantity <italic>E</italic> <xref ref-type="disp-formula" rid="pone.0162259.e061">Eq (12)</xref> at convergence can be compared across many random permutations of the ordering of the data, and the clustering partition with the lowest <italic>E</italic> chosen as the best estimate.</p>
</sec>
<sec id="sec023">
<title>C Obtaining cluster centroids</title>
<p>As explained in the introduction, MAP-DP does not explicitly compute estimates of the cluster centroids, but this is easy to do after convergence if required. The cluster posterior hyper parameters <italic>θ</italic><sub><italic>k</italic></sub> can be estimated using the appropriate Bayesian updating formulae for each data type, given in (<xref ref-type="supplementary-material" rid="pone.0162259.s003">S1 Material</xref>). For example, for spherical normal data with known variance:
<disp-formula id="pone.0162259.e075">
<alternatives>
<graphic id="pone.0162259.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e075" xlink:type="simple"/>
<mml:math display="block" id="M75">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:msub>
<mml:mi>σ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mtd>
<mml:mtd>
<mml:mo>=</mml:mo>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:msup>
<mml:mfenced close=")" open="(" separators="">
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:msubsup>
<mml:mi>σ</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msubsup>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:msup>
<mml:mover accent="true">
<mml:mi>σ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mfrac>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mfenced>
<mml:mrow>
<mml:mo>-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="right">
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mtd>
<mml:mtd>
<mml:mo>=</mml:mo>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:msub>
<mml:mi>σ</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mfenced close=")" open="(" separators="">
<mml:mfrac>
<mml:msub>
<mml:mi>μ</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:msubsup>
<mml:mi>σ</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msubsup>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:msup>
<mml:mover accent="true">
<mml:mi>σ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mfrac>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>:</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:munder>
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula></p>
<p>Using these parameters, useful properties of the posterior predictive distribution <italic>f</italic>(<italic>x</italic>|<italic>θ</italic><sub><italic>k</italic></sub>) can be computed, for example, in the case of spherical normal data, the posterior predictive distribution is itself normal, with mode <italic>μ</italic><sub><italic>k</italic></sub>. Indeed, this quantity plays an analogous role to the cluster means estimated using <italic>K</italic>-means.</p>
</sec>
<sec id="sec024">
<title>D Out-of-sample predictions</title>
<p>To make out-of-sample predictions we suggest two approaches to compute the out-of-sample likelihood for a new observation <italic>x</italic><sub><italic>N</italic>+1</sub>, approaches which differ in the way the indicator <italic>z</italic><sub><italic>N</italic>+1</sub> is estimated.</p>
<list list-type="order">
<list-item>
<p><italic>Mixture predictive density</italic>. The unknown indicator <italic>z</italic><sub><italic>N</italic>+1</sub> can be integrated out resulting in a mixture density:
<disp-formula id="pone.0162259.e076">
<alternatives>
<graphic id="pone.0162259.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e076" xlink:type="simple"/>
<mml:math display="block" id="M76">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mrow>
<mml:mi>N</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>X</mml:mi>
</mml:mfenced>
<mml:mo>=</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>K</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mrow>
<mml:mi>N</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>X</mml:mi>
</mml:mfenced>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mrow>
<mml:mi>N</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>|</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>X</mml:mi>
<mml:mo>,</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mrow>
<mml:mi>N</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula></p>
<p>The assignment probability <italic>p</italic>(<italic>z</italic><sub><italic>N</italic>+1</sub> = <italic>k</italic>|<italic>z</italic><sub><italic>N</italic></sub>, <italic>N</italic><sub>0</sub>) is <inline-formula id="pone.0162259.e077"><alternatives><graphic id="pone.0162259.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mfrac><mml:msub><mml:mi>N</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> for an existing cluster and <inline-formula id="pone.0162259.e078"><alternatives><graphic id="pone.0162259.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mfrac><mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> for a new cluster. The second term corresponds to the predictive distribution of <italic>N</italic> + 1 point <inline-formula id="pone.0162259.e079"><alternatives><graphic id="pone.0162259.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>z</mml:mi> <mml:mo>,</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo></mml:mrow> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo/><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p><italic>MAP predictive density</italic>. We can also use a point estimate for <italic>z</italic><sub><italic>N</italic>+1</sub> by picking the minimum negative log posterior of the indicator <italic>p</italic>(<italic>z</italic><sub><italic>N</italic>+1</sub>|<italic>x</italic><sub><italic>N</italic>+1</sub>, <italic>N</italic><sub>0</sub>) or equivalently:<disp-formula id="pone.0162259.e080">
<alternatives>
<graphic id="pone.0162259.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e080" xlink:type="simple"/>
<mml:math display="block" id="M80">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:msubsup>
<mml:mi>z</mml:mi>
<mml:mrow>
<mml:mi>N</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mtext>MAP</mml:mtext>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:munder>
<mml:mo form="prefix">arg min</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>∈</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>,</mml:mo><mml:mo>…</mml:mo>
<mml:mo>,</mml:mo>
<mml:mi>K</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>K</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:munder>
<mml:mfenced close="]" open="[" separators="">
<mml:mo>-</mml:mo>
<mml:mtext>ln </mml:mtext>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mrow>
<mml:mi>N</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>|</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>X</mml:mi>
<mml:mo>,</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mrow>
<mml:mi>N</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
</mml:mfenced>
<mml:mo>-</mml:mo>
<mml:mtext>ln </mml:mtext>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mrow>
<mml:mi>N</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>=</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>X</mml:mi>
</mml:mfenced>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula>
where <italic>p</italic>(<italic>x</italic><sub><italic>N</italic>+1</sub>|<italic>z</italic>, <italic>X</italic>, <italic>z</italic><sub><italic>N</italic>+1</sub> = <italic>k</italic>) and <italic>p</italic>(<italic>z</italic><sub><italic>N</italic>+1</sub> = <italic>k</italic>|<italic>N</italic><sub>0</sub>, <italic>z</italic>, <italic>X</italic>)
are computed as in the approach above. Once we have evaluated the
MAP assignment for point <italic>N</italic> + 1, <inline-formula id="pone.0162259.e081"><alternatives><graphic id="pone.0162259.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mtext>MAP</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> we
model <italic>x</italic><sub><italic>N</italic>+1</sub> with predictive density <inline-formula id="pone.0162259.e082"><alternatives><graphic id="pone.0162259.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>z</mml:mi> <mml:mo>,</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo></mml:mrow> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mi>A</mml:mi> <mml:mi>P</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo/><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
</list>
<p>The first (marginalization) approach is used in Blei and Jordan [<xref ref-type="bibr" rid="pone.0162259.ref015">15</xref>] and is more robust as it incorporates the probability mass of all cluster components while the second (modal) approach can be useful in cases where only a point prediction is needed.</p>
</sec>
<sec id="sec025">
<title>E Missing data</title>
<p>In MAP-DP, we can learn missing data as a natural extension of the algorithm due to its derivation from Gibbs sampling: MAP-DP can be seen as a simplification of Gibbs sampling where the sampling step is replaced with maximization. The Gibbs sampler provides us with a general, consistent and natural way of learning missing values in the data without making further assumptions, as a part of the learning algorithm. That is, we can treat the missing values from the data as latent variables and sample them iteratively from the corresponding posterior one at a time, holding the other random quantities fixed. In this framework, Gibbs sampling remains consistent as its convergence on the target distribution is still ensured. (Note that this approach is related to the ignorability assumption of Rubin [<xref ref-type="bibr" rid="pone.0162259.ref046">46</xref>] where the missingness mechanism can be safely ignored in the modeling. Molenberghs et al. [<xref ref-type="bibr" rid="pone.0162259.ref047">47</xref>] have shown that more complex models which model the missingness mechanism cannot be distinguished from the ignorable model on an empirical basis.)</p>
<p>Coming from that end, we suggest the MAP equivalent of that approach. We treat the missing values from the data set as latent variables and so update them by maximizing the corresponding posterior distribution one at a time, holding the other unknown quantities fixed. In MAP-DP, the only random quantity is the cluster indicators <italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub> and we learn those with the iterative MAP procedure given the observations <italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>N</italic></sub>. Consider some of the variables of the <italic>M</italic>-dimensional <italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>N</italic></sub> are missing, then we will denote the vectors of missing values from each observations as <inline-formula id="pone.0162259.e083"><alternatives><graphic id="pone.0162259.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> with <inline-formula id="pone.0162259.e084"><alternatives><graphic id="pone.0162259.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> where <inline-formula id="pone.0162259.e085"><alternatives><graphic id="pone.0162259.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is empty if feature <italic>m</italic> of the observation <italic>x</italic><sub><italic>i</italic></sub> has been observed. MAP-DP for missing data proceeds as follows:</p>
<list list-type="order">
<list-item>
<p>For each feature <italic>m</italic> = 1, …, <italic>M</italic>, sample all of the missing values <inline-formula id="pone.0162259.e086"><alternatives><graphic id="pone.0162259.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> from the likelihood for that variable given the prior parameters <italic>f</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>θ</italic><sub>0,<italic>m</italic></sub>). Note that we assume independent priors and that the likelihood for the different variables can take different forms, as in the case study 6.</p>
</list-item>
<list-item>
<p>Combine the sampled missing variables with the observed ones and proceed to update the cluster indicators <italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub>, treating all of the variables as known. The indicators <italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub> are updated as above, by computing for each point <italic>i</italic>, the <italic>K</italic> + 1 quantities <italic>d</italic><sub><italic>i</italic>,1</sub>, …, <italic>d</italic><sub><italic>iK</italic></sub>, <italic>d</italic><sub><italic>i</italic>,<italic>K</italic>+1</sub> and computing <inline-formula id="pone.0162259.e087"><alternatives><graphic id="pone.0162259.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:mrow><mml:msub><mml:mi>z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo form="prefix">arg</mml:mo> <mml:msub><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>[</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mtext>ln </mml:mtext> <mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>Once all of the indicators <italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>N</italic></sub> are updated, update the missing variables <inline-formula id="pone.0162259.e088"><alternatives><graphic id="pone.0162259.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. For each point <italic>i</italic>, update <inline-formula id="pone.0162259.e089"><alternatives><graphic id="pone.0162259.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> by taking the mode of the corresponding likelihood <inline-formula id="pone.0162259.e090"><alternatives><graphic id="pone.0162259.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mo form="prefix">arg max</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mspace width="0.166667em"/><mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:msub><mml:mi>z</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo/><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. For the elliptical model we can take the mode of each dimension independently <inline-formula id="pone.0162259.e091"><alternatives><graphic id="pone.0162259.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mo form="prefix">arg max</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mspace width="0.166667em"/><mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:msub><mml:mi>z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msubsup> <mml:mo/><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. After all <inline-formula id="pone.0162259.e092"><alternatives><graphic id="pone.0162259.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are updated, go back to step 2 and update the cluster indicators <italic>z</italic><sub>1</sub>, … <italic>z</italic><sub><italic>N</italic></sub>, now using the observations and the updated missing variables.</p>
</list-item>
</list>
</sec>
<sec id="sec026">
<title>F Estimating the model hyper parameters (<italic>θ</italic><sub>0</sub>, <italic>N</italic><sub>0</sub>)</title>
<p>In Bayesian models, ideally we would like to choose our hyper parameters (<italic>θ</italic><sub>0</sub>, <italic>N</italic><sub>0</sub>) from some additional information that we have for the data. This could be related to the way data is collected, the nature of the data or expert knowledge about the particular problem at hand. For instance when there is prior knowledge about the expected number of clusters, the relation <italic>E</italic>[<italic>K</italic><sup>+</sup>] = <italic>N</italic><sub>0</sub> log <italic>N</italic> could be used to set <italic>N</italic><sub>0</sub>.</p>
<p>In cases where this is not feasible, we have considered the following
alternatives:</p>
<list list-type="order">
<list-item>
<p><italic>Empirical Bayes</italic> (EB). Set the hyper parameters to their corresponding maximum marginal likelihood values. The maximum marginal likelihood expression for <italic>θ</italic><sub>0</sub> will be different for the different data types and will not always be available in closed form. Usually they can be obtained from the parameter updates in (<xref ref-type="supplementary-material" rid="pone.0162259.s003">S1 Material</xref>) by omitting the prior terms. In MAP-DP, the maximum likelihood estimates for the hyper parameters <italic>θ</italic><sub>0</sub> coincide with EB estimates as the cluster parameters <italic>θ</italic> have already been integrated out. In fact, in the simple case of conjugate exponential family models, the EB estimates and the maximum likelihood estimates for the model hyper parameters are quite similar. That is why it is common to use the maximum likelihood estimates as a simple approximation to the EB estimate. This approach is referred to as <italic>parametric EB point estimation</italic> [<xref ref-type="bibr" rid="pone.0162259.ref048">48</xref>]. Note that using EB to learn the hyper parameter <italic>N</italic><sub>0</sub> would not be efficient because there is no closed form expression for the marginal likelihood (see point 3 below, and <xref ref-type="disp-formula" rid="pone.0162259.e093">Eq (17)</xref>.</p>
</list-item>
<list-item>
<p><italic>Multiple restarts</italic>. Run MAP-DP with different starting values for each of the hyper parameters (<italic>θ</italic><sub>0</sub>, <italic>N</italic><sub>0</sub>), compute the NLL from <xref ref-type="disp-formula" rid="pone.0162259.e061">Eq (12)</xref> including the <italic>C</italic>(<italic>N</italic><sub>0</sub>, <italic>N</italic>) term at convergence, change one of the hyper parameters holding the rest fixed and then restart MAP-DP with the prior parameter. Set that hyper parameter to the value resulting in smallest NLL and proceed in the same way for the next hyper parameter of the model. <italic>Bayesian optimisation</italic> [<xref ref-type="bibr" rid="pone.0162259.ref049">49</xref>] has also been proposed to fit model hyper parameters but requires the specification of a Gaussian Process and associated priors that may be challenging in practice. We have therefore not utilised this approach and prefer the simpler greedy search approach. However in certain cases BO may be more efficient in terms of the number of MAP-DP runs required.</p>
</list-item>
<list-item>
<p><italic>MAP estimate</italic>. Place a prior on the hyper parameter of interest and numerically compute the mode of the posterior. For instance, by using a gamma prior on <italic>N</italic><sub>0</sub>, <italic>p</italic>(<italic>N</italic><sub>0</sub>) = Gamma(<italic>a</italic><sub><italic>N</italic><sub>0</sub></sub>, <italic>b</italic><sub><italic>N</italic><sub>0</sub></sub>), the posterior is proportional to:<disp-formula id="pone.0162259.e093">
<alternatives>
<graphic id="pone.0162259.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0162259.e093" xlink:type="simple"/>
<mml:math display="block" id="M93">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mrow>
<mml:mo>|</mml:mo>
<mml:mi>N</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>K</mml:mi>
</mml:mrow>
</mml:mfenced>
<mml:mo>∝</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mo>Γ</mml:mo>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mfenced>
</mml:mrow>
<mml:mrow>
<mml:mo>Γ</mml:mo>
<mml:mfenced close=")" open="(" separators="">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mi>N</mml:mi>
</mml:mfenced>
</mml:mrow>
</mml:mfrac>
<mml:msubsup>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>K</mml:mi>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>a</mml:mi>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo form="prefix">exp</mml:mo>
<mml:mfenced close="]" open="[" separators="">
<mml:mo>-</mml:mo>
<mml:msub>
<mml:mi>b</mml:mi>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:msub>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mfenced>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula></p>
<p>We can numerically minimize the negative log of this posterior using e.g. Newton’s method. To ensure the solution is positive we can compute the gradient with respect to ln <italic>N</italic><sub>0</sub>: as Rasmussen [<xref ref-type="bibr" rid="pone.0162259.ref050">50</xref>] notes <italic>p</italic>(ln <italic>N</italic><sub>0</sub>|<italic>N</italic>, <italic>K</italic><sup>+</sup>) is log-concave and therefore has a unique maximum.</p>
</list-item>
<list-item>
<p><italic>Cross-validation</italic>. By considering a finite set of values for (<italic>θ</italic><sub>0</sub>, <italic>N</italic><sub>0</sub>), choose the value corresponding to the minimum, average, out-of-sample likelihood across all cross-validation repetitions (see Appendix D). This approach is taken in Blei and Jordan [<xref ref-type="bibr" rid="pone.0162259.ref015">15</xref>] to compare different inference methods.</p>
</list-item>
</list>
<p>We have found the second approach to be the most effective where empirical Bayes can be used to obtain the values of the hyper parameters at the first run of MAP-DP. For small datasets we recommend using the cross-validation approach as it can be less prone to overfitting.</p>
</sec>
</sec>
<sec id="sec027">
<title>Supporting Information</title>
<supplementary-material id="pone.0162259.s001" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.s001" xlink:type="simple">
<label>S1 Function</label>
<caption>
<title>This is an example function in MATLAB implementing MAP-DP algorithm for Gaussian data with unknown mean and precision.</title>
<p>(M)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0162259.s002" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.s002" xlink:type="simple">
<label>S1 Script</label>
<caption>
<title>This is a script evaluating the <xref ref-type="supplementary-material" rid="pone.0162259.s001">S1 Function</xref> on synthetic data.</title>
<p>(M)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0162259.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0162259.s003" xlink:type="simple">
<label>S1 Material</label>
<caption>
<title>We include detailed expressions for how to update cluster hyper parameters and other probabilities whenever the analyzed data type is changed.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pone.0162259.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jain</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Murty</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Flynn</surname> <given-names>PJ</given-names></name>. <article-title>Data clustering: a review</article-title>. <source>ACM Computing Surveys</source>. <year>1999</year>;<volume>31</volume>(<issue>3</issue>):<fpage>264</fpage>–<lpage>323</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1145/331499.331504" xlink:type="simple">10.1145/331499.331504</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Celebi</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Kingravi</surname> <given-names>HA</given-names></name>, <name name-style="western"><surname>Vela</surname> <given-names>PA</given-names></name>. <article-title>A comparative study of efficient initialization methods for the K-means clustering algorithm</article-title>. <source>Expert Systems with Applications</source>. <year>2013</year>;<volume>40</volume>(<issue>1</issue>):<fpage>200</fpage>–<lpage>210</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.eswa.2012.07.021" xlink:type="simple">10.1016/j.eswa.2012.07.021</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bordogna</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Pasi</surname> <given-names>G</given-names></name>. <article-title>A quality driven hierarchical data divisive soft clustering for information retrieval</article-title>. <source>Knowledge-Based Systems</source>. <year>2012</year>;<volume>26</volume>:<fpage>9</fpage>–<lpage>19</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.knosys.2011.06.012" xlink:type="simple">10.1016/j.knosys.2011.06.012</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Luo</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Z</given-names></name>. <article-title>Semi-supervised clustering on heterogeneous information networks</article-title>. In: <source>Advances in Knowledge Discovery and Data Mining</source>; <year>2014</year>. p. <fpage>548</fpage>–<lpage>559</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>YE</given-names></name>, <name name-style="western"><surname>Yun</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Jeon</surname> <given-names>BS</given-names></name>. <article-title>Identifying the clusters within nonmotor manifestations in early Parkinson’s disease by using unsupervised cluster analysis</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>3</issue>):<fpage>e91906</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0091906" xlink:type="simple">10.1371/journal.pone.0091906</ext-link></comment> <object-id pub-id-type="pmid">24643014</object-id></mixed-citation>
</ref>
<ref id="pone.0162259.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bogner</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Trancón y Widemann</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lange</surname> <given-names>H</given-names></name>. <article-title>Characterising flow patterns in soils by feature extraction and multiple consensus clustering</article-title>. <source>Ecological Informatics</source>. <year>2013</year>;<volume>15</volume>:<fpage>44</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ecoinf.2013.03.001" xlink:type="simple">10.1016/j.ecoinf.2013.03.001</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Yoshida</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Q</given-names></name>. <article-title>Text clustering using frequent itemsets</article-title>. <source>Knowledge-Based Systems</source>. <year>2010</year>;<volume>23</volume>(<issue>5</issue>):<fpage>379</fpage>–<lpage>388</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.knosys.2010.01.011" xlink:type="simple">10.1016/j.knosys.2010.01.011</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Saeed</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Salim</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Abdo</surname> <given-names>A</given-names></name>. <article-title>Information theory and voting based consensus clustering for combining multiple clusterings of chemical structures</article-title>. <source>Molecular Informatics</source>. <year>2013</year>;<volume>32</volume>(<issue>7</issue>):<fpage>591</fpage>–<lpage>598</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/minf.201300004" xlink:type="simple">10.1002/minf.201300004</ext-link></comment> <object-id pub-id-type="pmid">27481767</object-id></mixed-citation>
</ref>
<ref id="pone.0162259.ref009">
<label>9</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Berkhin</surname> <given-names>P</given-names></name>. <chapter-title>A survey of clustering data mining techniques</chapter-title>. In: <source>Grouping Multidimensional Data</source>. <publisher-name>Springer-Verlag</publisher-name>, <publisher-loc>Heidelberg</publisher-loc>; <year>2006</year>. p. <fpage>25</fpage>–<lpage>71</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lloyd</surname> <given-names>SP</given-names></name>. <article-title>Least squares quantization in PCM</article-title>. <source>IEEE Transactions on Information Theory</source>. <year>1982</year>;<volume>28</volume>(<issue>2</issue>):<fpage>129</fpage>–<lpage>137</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TIT.1982.1056489" xlink:type="simple">10.1109/TIT.1982.1056489</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Rooden</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Heiser</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Kok</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Verbaan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>van Hilten</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Marinus</surname> <given-names>J</given-names></name>. <article-title>The identification of Parkinson’s disease subtypes using cluster analysis: a systematic review</article-title>. <source>Movement Disorders</source>. <year>2010</year>;<volume>25</volume>(<issue>8</issue>):<fpage>969</fpage>–<lpage>978</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/mds.23116" xlink:type="simple">10.1002/mds.23116</ext-link></comment> <object-id pub-id-type="pmid">20535823</object-id></mixed-citation>
</ref>
<ref id="pone.0162259.ref012">
<label>12</label>
<mixed-citation publication-type="other" xlink:type="simple">Fei-Fei L, Perona P. A Bayesian hierarchical model for learning natural scene categories. In: IEEE Computer Society Conference Computer Vision and Pattern Recognition, CVPR 2005. vol. 2; 2005. p. 524–531.</mixed-citation>
</ref>
<ref id="pone.0162259.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sung</surname> <given-names>KK</given-names></name>, <name name-style="western"><surname>Poggio</surname> <given-names>T</given-names></name>. <article-title>Example-based learning for view-based human face detection</article-title>. <source>IEEE Transactions on Pattern Analysis and Machine Intelligence</source>. <year>1998</year>;<volume>20</volume>(<issue>1</issue>):<fpage>39</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/34.655648" xlink:type="simple">10.1109/34.655648</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref014">
<label>14</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hjort</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Müller</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Walker</surname> <given-names>SG</given-names></name>. <source>Bayesian nonparametrics</source>. <volume>vol. 28</volume>. <publisher-name>Cambridge University Press</publisher-name>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref015">
<label>15</label>
<mixed-citation publication-type="other" xlink:type="simple">Blei DM, Jordan MI. Variational methods for the Dirichlet process. In: The 21st International Conference on Machine Learning, ICML 2004. ACM; 2004. p. 12.</mixed-citation>
</ref>
<ref id="pone.0162259.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Neal</surname> <given-names>RM</given-names></name>. <article-title>Markov chain sampling methods for Dirichlet process mixture models</article-title>. <source>Journal of Computational and Graphical Statistics</source>. <year>2000</year>;<volume>9</volume>(<issue>2</issue>):<fpage>249</fpage>–<lpage>265</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/1390653" xlink:type="simple">10.2307/1390653</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Neal</surname> <given-names>RM</given-names></name>. <article-title>Slice sampling</article-title>. <source>Annals of Statistics</source>. <year>2003</year>;<volume>31</volume>(<issue>3</issue>):<fpage>705</fpage>–<lpage>767</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/aos/1056562461" xlink:type="simple">10.1214/aos/1056562461</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref018">
<label>18</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bishop</surname> <given-names>CM</given-names></name>. <source>Pattern Recognition and Machine Learning</source>. <publisher-name>Springer-Verlag</publisher-name>, <publisher-loc>New York</publisher-loc>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dempster</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Laird</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>Journal of the Royal Statistical Society: Series B</source>. <year>1977</year>;<volume>39</volume>:<fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref020">
<label>20</label>
<mixed-citation publication-type="other" xlink:type="simple">
<name name-style="western"><surname>Jiang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kulis</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>. <article-title>Small-variance asymptotics for exponential family Dirichlet process mixture models</article-title>. In: <source>Advances in Neural Information Processing Systems</source>; <year>2012</year>. p. <fpage>3158</fpage>–<lpage>3166</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref021">
<label>21</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Pelleg</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>AW</given-names></name>. <source>X-means: extending K-means with efficient estimation of the number of clusters</source>. In: <publisher-name>ICML</publisher-name> <year>2000</year>; 2000. p. <fpage>727</fpage>–<lpage>734</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bischof</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Leonardis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Selb</surname> <given-names>A</given-names></name>. <article-title>MDL principle for robust vector quantisation</article-title>. <source>Pattern Analysis &amp; Applications</source>. <year>1999</year>;<volume>2</volume>(<issue>1</issue>):<fpage>59</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s100440050015" xlink:type="simple">10.1007/s100440050015</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hamerly</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Elkan</surname> <given-names>C</given-names></name>. <article-title>Learning the K in K-means</article-title>. In: <source>Advances in Neural Information Processing Systems</source>; <year>2003</year>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gao</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bryc</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Bustamante</surname> <given-names>CD</given-names></name>. <article-title>On identifying the optimal number of population clusters via the deviance information criterion</article-title>. <source>PLoS One</source>. <year>2011</year>;<volume>6</volume>(<issue>6</issue>):<fpage>e21014</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0021014" xlink:type="simple">10.1371/journal.pone.0021014</ext-link></comment> <object-id pub-id-type="pmid">21738600</object-id></mixed-citation>
</ref>
<ref id="pone.0162259.ref025">
<label>25</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Welling</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kurihara</surname> <given-names>K</given-names></name>. <source>Bayesian K-means as a “Maximization-Expectation” Algorithm</source>. In: <collab>SDM</collab>. <publisher-name>SIAM</publisher-name>; <year>2006</year>. p. <fpage>474</fpage>–<lpage>478</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref026">
<label>26</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Teh</surname> <given-names>YW</given-names></name>. <article-title>Dirichlet process</article-title>. In: <source>Encyclopedia of Machine Learning</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>US</publisher-loc>; <year>2010</year>. p. <fpage>280</fpage>–<lpage>287</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>MacEachern</surname> <given-names>SN</given-names></name>, <name name-style="western"><surname>Müller</surname> <given-names>P</given-names></name>. <article-title>Estimating mixture of Dirichlet process models</article-title>. <source>Journal of Computational and Graphical Statistics</source>. <year>1998</year>;<volume>7</volume>(<issue>2</issue>):<fpage>223</fpage>–<lpage>238</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/10618600.1998.10474772" xlink:type="simple">10.1080/10618600.1998.10474772</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jain</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Neal</surname> <given-names>RM</given-names></name>. <article-title>Splitting and merging components of a nonconjugate Dirichlet process mixture model</article-title>. <source>Bayesian Analysis</source>. <year>2007</year>;<volume>2</volume>(<issue>3</issue>):<fpage>445</fpage>–<lpage>472</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/07-BA219" xlink:type="simple">10.1214/07-BA219</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Casella</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Robert</surname> <given-names>CP</given-names></name>. <article-title>Rao-Blackwellisation of sampling schemes</article-title>. <source>Biometrika</source>. <year>1996</year>;<volume>83</volume>(<issue>1</issue>):<fpage>81</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/83.1.81" xlink:type="simple">10.1093/biomet/83.1.81</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Blackwell</surname> <given-names>D</given-names></name>. <article-title>Conditional expectation and unbiased sequential estimation</article-title>. <source>The Annals of Mathematical Statistics</source>. <year>1947</year>; p. <fpage>105</fpage>–<lpage>110</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/aoms/1177730497" xlink:type="simple">10.1214/aoms/1177730497</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Blei</surname> <given-names>DM</given-names></name>. <article-title>A tutorial on Bayesian nonparametric models</article-title>. <source>Journal of Mathematical Psychology</source>. <year>2012</year>;<volume>56</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmp.2011.08.004" xlink:type="simple">10.1016/j.jmp.2011.08.004</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref032">
<label>32</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Arthur</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Vassilvitskii</surname> <given-names>S</given-names></name>. <article-title>k++-means The advantages of careful seeding</article-title>. In: <source>Proceedings of the eighteenth annual ACM-SIAM symposium on Discrete algorithms</source>. <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>; <year>2007</year>. p. <fpage>1027</fpage>–<lpage>1035</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kurlan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>D</given-names></name>. <article-title>Parkinson’s disease data and organizing center</article-title>. <source>Movement Disorders</source>. <year>2007</year>;<volume>22</volume>(<issue>6</issue>):<fpage>904</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/mds.21415" xlink:type="simple">10.1002/mds.21415</ext-link></comment> <object-id pub-id-type="pmid">17343272</object-id></mixed-citation>
</ref>
<ref id="pone.0162259.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reijnders</surname> <given-names>JSAM</given-names></name>, <name name-style="western"><surname>Ehrt</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Lousberg</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Aarsland</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Leentjens</surname> <given-names>AFG</given-names></name>. <article-title>The association between motor subtypes and psychopathology in Parkinson’s disease</article-title>. <source>Parkinsonism &amp; Related Disorders</source>. <year>2009</year>;<volume>15</volume>(<issue>5</issue>):<fpage>379</fpage>–<lpage>382</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.parkreldis.2008.09.003" xlink:type="simple">10.1016/j.parkreldis.2008.09.003</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lewis</surname> <given-names>SJG</given-names></name>, <name name-style="western"><surname>Foltynie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Blackwell</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Robbins</surname> <given-names>TW</given-names></name>, <name name-style="western"><surname>Owen</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Barker</surname> <given-names>RA</given-names></name>. <article-title>Heterogeneity of Parkinson’s disease in the early clinical stages using a data driven approach</article-title>. <source>Journal of Neurology, Neurosurgery &amp; Psychiatry</source>. <year>2005</year>;<volume>76</volume>(<issue>3</issue>):<fpage>343</fpage>–<lpage>348</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1136/jnnp.2003.033530" xlink:type="simple">10.1136/jnnp.2003.033530</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>YJ</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>B</given-names></name>. <article-title>Clinical heterogeneity in patients with early-stage Parkinson’s disease: a cluster analysis</article-title>. <source>Journal of Zhejiang University Science B</source>. <year>2011</year>;<volume>12</volume>(<issue>9</issue>):<fpage>694</fpage>–<lpage>703</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1631/jzus.B1100069" xlink:type="simple">10.1631/jzus.B1100069</ext-link></comment> <object-id pub-id-type="pmid">21887844</object-id></mixed-citation>
</ref>
<ref id="pone.0162259.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gasparoli</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Delibori</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Polesello</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Santelli</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ermani</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Battistin</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Clinical predictors in Parkinson’s disease</article-title>. <source>Neurological Sciences</source>. <year>2002</year>;<volume>23</volume>(<issue>2</issue>):<fpage>s77</fpage>–<lpage>s78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s100720200078" xlink:type="simple">10.1007/s100720200078</ext-link></comment> <object-id pub-id-type="pmid">12548352</object-id></mixed-citation>
</ref>
<ref id="pone.0162259.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hoehn</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Yahr</surname> <given-names>MD</given-names></name>. <article-title>Parkinsonism: onset, progression and mortality</article-title>. <source>Neurology</source>. <year>1967</year>;<volume>50</volume>(<issue>2</issue>):<fpage>318</fpage>–<lpage>318</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bouveyron</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Girard</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schmid</surname> <given-names>C</given-names></name>. <article-title>High-dimensional data clustering</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2007</year>;<volume>52</volume>(<issue>1</issue>):<fpage>502</fpage>–<lpage>519</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.csda.2007.02.009" xlink:type="simple">10.1016/j.csda.2007.02.009</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rabiner</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Juang</surname> <given-names>B</given-names></name>. <article-title>An introduction to hidden Markov models</article-title>. <source>ieee assp magazine</source>. <year>1986</year>;<volume>3</volume>(<issue>1</issue>):<fpage>4</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/MASSP.1986.1165342" xlink:type="simple">10.1109/MASSP.1986.1165342</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref041">
<label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Raykov, YP, Boukouvalas, A, Little, MA. Iterative collapsed MAP inference for Bayesian nonparametrics;.</mixed-citation>
</ref>
<ref id="pone.0162259.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pitman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yor</surname> <given-names>M</given-names></name>. <article-title>The two-parameter Poisson-Dirichlet distribution derived from a stable subordinator</article-title>. <source>The Annals of Probability</source>. <year>1997</year>; p. <fpage>855</fpage>–<lpage>900</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Teh</surname> <given-names>YW</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Beal</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Blei</surname> <given-names>DM</given-names></name>. <article-title>Hierarchical dirichlet processes</article-title>. <source>Journal of the American Statistical Association</source>. <year>2006</year>;<volume>101</volume>(<issue>476</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/016214506000000302" xlink:type="simple">10.1198/016214506000000302</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref044">
<label>44</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Beal</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Ghahramani</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Rasmussen</surname> <given-names>CE</given-names></name>. <chapter-title>The infinite hidden Markov model</chapter-title>. In: <source>Advances in Neural Information Processing Systems</source>. <volume>vol. 14</volume>. <publisher-name>MIT Press</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Griffiths</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Ghahramani</surname> <given-names>Z</given-names></name>. <article-title>The Indian buffet process: an introduction and review</article-title>. <source>The Journal of Machine Learning Research</source>. <year>2011</year>;<volume>12</volume>:<fpage>1185</fpage>–<lpage>1224</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <article-title>Inference and missing data</article-title>. <source>Biometrika</source>. <year>1976</year>;<volume>63</volume>(<issue>3</issue>):<fpage>581</fpage>–<lpage>592</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/63.3.581" xlink:type="simple">10.1093/biomet/63.3.581</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Molenberghs</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Beunckens</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sotto</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kenward</surname> <given-names>MG</given-names></name>. <article-title>Every missingness not at random model has a missingness at random counterpart with equal fit</article-title>. <source>Journal of the Royal Statistical Society: Series B</source>. <year>2008</year>;<volume>70</volume>(<issue>2</issue>):<fpage>371</fpage>–<lpage>388</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-9868.2007.00640.x" xlink:type="simple">10.1111/j.1467-9868.2007.00640.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morris</surname> <given-names>CN</given-names></name>. <article-title>Parametric empirical Bayes inference: theory and applications</article-title>. <source>Journal of the American Statistical Association</source>. <year>1983</year>;<volume>78</volume>(<issue>381</issue>):<fpage>47</fpage>–<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1983.10477920" xlink:type="simple">10.1080/01621459.1983.10477920</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0162259.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Snoek</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Larochelle</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>RP</given-names></name>. <article-title>Practical Bayesian optimization of machine learning algorithms</article-title>. In: <source>Advances in Neural Information Processing Systems</source>; <year>2012</year>. p. <fpage>2951</fpage>–<lpage>2959</lpage>.</mixed-citation>
</ref>
<ref id="pone.0162259.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rasmussen</surname> <given-names>CE</given-names></name>. <article-title>The infinite Gaussian mixture model</article-title>. In: <source>Advances in Neural Information Processing Systems</source>. <volume>vol. 12</volume>; <year>1999</year>. p. <fpage>554</fpage>–<lpage>560</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>