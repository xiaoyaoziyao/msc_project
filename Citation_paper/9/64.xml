<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0030149</article-id><article-id pub-id-type="publisher-id">06-PLCB-RA-0482R3</article-id><article-id pub-id-type="sici">plcb-03-08-07</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Evolutionary Biology</subject><subject>Genetics and Genomics</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Vertebrates</subject></subj-group></article-categories><title-group><article-title>SimulFold: Simultaneously Inferring RNA Structures Including Pseudoknots, Alignments, and Trees Using a Bayesian MCMC Framework</article-title><alt-title alt-title-type="running-head">Bayesian MCMC RNA Folding</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Meyer</surname><given-names>Irmtraud M</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Miklós</surname><given-names>István</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> UBC Bioinformatics Centre, University of British Columbia, Vancouver, British Columbia, Canada
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Department of Computer Science, University of British Columbia, Vancouver, British Columbia, Canada
			</addr-line></aff><aff id="aff3">
				<label>3</label><addr-line> Alfréd Rényi Institute of Mathematics, Hungarian Academy of Sciences, Budapest, Hungary
			</addr-line></aff><aff id="aff4">
				<label>4</label><addr-line> Computer and Automation Research Institute (MTA-SZTAKI), Hungarian Academy of Sciences, Budapest, Hungary
			</addr-line></aff><aff id="aff5">
				<label>5</label><addr-line> eScience Regional Knowledge Centre, Eötvös Loránd University, Budapest, Hungary
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Mattick</surname><given-names>John S</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of Queensland, Australia</aff><author-notes><fn fn-type="con" id="ack1"><p>IMM and IM conceived and designed the experiments, performed the experiments, analyzed the data, contributed reagents/materials/analysis tools, and wrote the paper.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">irmtraud.meyer@cantab.net</email></corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>8</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>10</day><month>8</month><year>2007</year></pub-date><volume>3</volume><issue>8</issue><elocation-id>e149</elocation-id><history><date date-type="received"><day>15</day><month>11</month><year>2006</year></date><date date-type="accepted"><day>14</day><month>6</month><year>2007</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Meyer and Miklós</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Computational methods for predicting evolutionarily conserved rather than thermodynamic RNA structures have recently attracted increased interest. These methods are indispensable not only for elucidating the regulatory roles of known RNA transcripts, but also for predicting RNA genes. It has been notoriously difficult to devise them to make the best use of the available data and to predict high-quality RNA structures that may also contain pseudoknots. We introduce a novel theoretical framework for co-estimating an RNA secondary structure including pseudoknots, a multiple sequence alignment, and an evolutionary tree, given several RNA input sequences. We also present an implementation of the framework in a new computer program, called SimulFold, which employs a Bayesian Markov chain Monte Carlo method to sample from the joint posterior distribution of RNA structures, alignments, and trees. We use the new framework to predict RNA structures, and comprehensively evaluate the quality of our predictions by comparing our results to those of several other programs. We also present preliminary data that show SimulFold's potential as an alignment and phylogeny prediction method. SimulFold overcomes many conceptual limitations that current RNA structure prediction methods face, introduces several new theoretical techniques, and generates high-quality predictions of conserved RNA structures that may include pseudoknots. It is thus likely to have a strong impact, both on the field of RNA structure prediction and on a wide range of data analyses.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><sec id="st1"><title/><p>Not only is the prediction of evolutionarily conserved RNA structures important for elucidating the potential functions of RNA sequences and the mechanisms by which these functions are exerted, but it also lies at the core of RNA gene prediction. To get an accurate prediction of the conserved RNA structure, we need a high-quality sequence alignment and an evolutionary tree relating several evolutionarily related sequences. These are two strong requirements that are typically difficult to fulfill unless the encoded RNA structure is already known. We present what is to our knowledge the first method that solves this chicken-and-egg problem by co-estimating all three quantities simultaneously. We show that our novel method, called SimulFold, can be successfully applied over a wide range of sequence similarities to detect conserved RNA structures, including those with pseudoknots. We also show its potential as an alignment and phylogeny prediction method. Our method overcomes several significant limitations of existing methods and has the potential to be used for a very diverse range of tasks.</p></sec></abstract><funding-group><funding-statement>IMM is supported by a Natural Sciences and Engineering Research Council of Canada discovery grant. IM is supported by a Bolyai postdoctoral fellowship, the Hungarian National Office for Research and Technology (grant RET-14/2005), and the Hungarian Scientific Research Fund (grant F61730).</funding-statement></funding-group><counts><page-count count="14"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Meyer IM, Miklós I (2007) SimulFold: Simultaneously inferring RNA structures including pseudoknots, alignments, and trees using a Bayesian MCMC framework. PLoS Comput Biol 3(8): e149. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030149" xlink:type="simple">10.1371/journal.pcbi.0030149</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Many RNA genes function by assuming a distinct three-dimensional structure in which the molecule folds back onto itself. Contacts are formed by hydrogen bonds between non-consecutive nucleotides that are complementary to each other. These hydrogen bonds are weak compared with covalent bonds. The three possible consensus pairs of complementary nucleotides are {A, U}, {G, C}, and {G, U}. It turns out that many properties of the three-dimensional RNA molecule can already be studied even if we know only the positions in the RNA sequence that form base-pairs. This is the level of abstraction that is predominantly chosen for studying RNA structure. For our purposes, an RNA structure is unambiguously defined by the set of base-pairing positions in the RNA sequence. This set of base-pairing sequence positions defines the RNA secondary structure. We count pseudoknotted structures, i.e., structures that contain non-nested base-pairs (e.g., two pairs <italic>i</italic>–<italic>j</italic> and <italic>i′</italic>–<italic>j′</italic> whose sequence positions are in order <italic>i</italic> &lt; <italic>i′</italic> &lt; <italic>j</italic> &lt; <italic>j′</italic>) as secondary structures. The RNA structure allows us to draw conclusions about the molecule's potential function and often even the mechanism by which it acts. It is therefore of fundamental importance to be able to predict an RNA's structure from its sequence alone.</p><p>Most RNA structure prediction programs investigate only secondary structures that do not contain pseudoknots. In addition, most of the structure prediction programs aim to predict the pseudoknot-free secondary structure that minimizes the free energy of the entire RNA molecule. The first empirical and theoretical investigations of the free energies of RNA secondary structures were conducted by Tinoco and his colleges in the early 1970s [<xref ref-type="bibr" rid="pcbi-0030149-b001">1</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b002">2</xref>]. Because the number of possible secondary structures grows exponentially with the length of the RNA sequence, algorithmic tricks have to be employed to render the calculation of the minimum free energy (MFE) secondary structure tractable. The first fast algorithm—based on a primitive scoring scheme—for finding the pseudoknot-free MFE secondary structure was proposed by Nussinov and Jacobson [<xref ref-type="bibr" rid="pcbi-0030149-b003">3</xref>]. A few years later, Zuker and Sankoff [<xref ref-type="bibr" rid="pcbi-0030149-b004">4</xref>] showed how similar ideas can be used to define an algorithm that calculates the pseudoknot-free MFE secondary structure using the Tinoco energy model. This algorithm still forms the basis of several of today's best MFE secondary structure prediction programs, e.g., Mfold [<xref ref-type="bibr" rid="pcbi-0030149-b005">5</xref>–<xref ref-type="bibr" rid="pcbi-0030149-b007">7</xref>] and the programs RNAfold and RNAalifold of the Vienna package [<xref ref-type="bibr" rid="pcbi-0030149-b007">7</xref>–<xref ref-type="bibr" rid="pcbi-0030149-b011">11</xref>].</p><p>The MFE approach has, however, a number of limitations. One conceptual limitation is the underlying assumption that a given RNA sequence will assume its MFE structure in the cell, i.e., its thermodynamic RNA structure. This assumption is not well supported in the general case. Theoretical, comparative studies of RNA molecules [<xref ref-type="bibr" rid="pcbi-0030149-b012">12</xref>] show that the thermodynamic structure of even moderately long RNA molecules need not correspond to the “functional RNA structure,” i.e., the RNA structure that confers the observed functionality to the molecule and that is conserved during evolution. This may, for example, be due to co-transcriptional folding [<xref ref-type="bibr" rid="pcbi-0030149-b013">13</xref>–<xref ref-type="bibr" rid="pcbi-0030149-b015">15</xref>], i.e., the folding of the RNA molecule as it is being transcribed. During co-transcriptional folding, a succession of kinetic RNA structures forms along a folding pathway. None of these kinetic RNA structures needs to correspond to the MFE structure. The observed discrepancies between the observed functional structure and the predicted MFE structure may also be due to other molecules binding the RNA molecule, which can obviously influence the structure formation process. The functional secondary structure may also differ from the MFE structure by having unstructured regions that do not comprise any base-pairs. As we are interested in investigating the functional roles of RNA molecules in the cell, we therefore focus on predicting the evolutionarily conserved RNA structure rather than the thermodynamic one.</p><p>There exist several programs that aim to simulate the dynamic folding process of an RNA molecule in the cell to predict RNA structures that may contain pseudoknots [<xref ref-type="bibr" rid="pcbi-0030149-b016">16</xref>–<xref ref-type="bibr" rid="pcbi-0030149-b019">19</xref>]. However, these programs study only a single RNA sequence at a time, and their predictive power decreases with increasing sequence length because the error is multiplicative.</p><p>Another conceptual limitation of the MFE approach is that the Zuker–Sankoff algorithm cannot handle pseudoknotted secondary structures, i.e., structures with non-nesting base-pairs. However, pseudoknotted RNA structures are known to fulfill diverse and important functional roles in the cell [<xref ref-type="bibr" rid="pcbi-0030149-b020">20</xref>]. We should thus aim to include them in RNA structure predictions. The prediction of pseudoknots has received more attention in the last few years, but remains very difficult. Pseudoknot prediction is, in the most general case, NP-hard even for binary strings [<xref ref-type="bibr" rid="pcbi-0030149-b021">21</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b022">22</xref>]. For special classes of pseudoknots, structure predictions can be made more efficient from <italic>O</italic>(<italic>L</italic><sup>4</sup>) to <italic>O</italic>(<italic>L</italic><sup>6</sup>) for an RNA sequence of length <italic>L</italic> [<xref ref-type="bibr" rid="pcbi-0030149-b023">23</xref>–<xref ref-type="bibr" rid="pcbi-0030149-b030">30</xref>]. However, these algorithms are still too slow for practical purposes.</p><p>The best information for predicting the functional RNA structure can be derived from functionally equivalent RNA sequences of evolutionarily related organisms. This is due to the fact that evolutionarily related RNA sequences that serve the same purpose in the cell are likely to employ the same mechanism for exerting this function. In particular, if the function of these RNA sequences depends on their structure, this RNA structure (but not necessarily the RNA sequences themselves) should be highly conserved. If we therefore align the RNA sequences such that structurally equivalent parts are grouped together, we can detect pairs of columns in the sequence alignment where the primary sequence conservation may be low, but the functional conservation in terms of base-pairs is high. These base-pairing columns in the alignment where compensatory mutations occur in a correlated way are called co-varying or co-evolving columns. They provide the main sequence signal that many comparative structure prediction programs detect to predict the base-pairs of evolutionarily conserved RNA secondary structures. RNAalifold [<xref ref-type="bibr" rid="pcbi-0030149-b010">10</xref>] of the Vienna package combines this type of information with a traditional MFE structure prediction, whereas Pfold [<xref ref-type="bibr" rid="pcbi-0030149-b031">31</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b032">32</xref>] incorporates it in a score-based approach that also takes the known evolutionary relationship of the sequences in the input alignment explicitly into account. RNA-Decoder [<xref ref-type="bibr" rid="pcbi-0030149-b033">33</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b034">34</xref>] uses an approach similar to Pfold's, but allows for extra evolutionary constraints due to known protein-coding regions in the input alignment and is the only one of the three programs capable of explicitly modeling unstructured regions. However, none of these three programs can predict pseudoknotted secondary structures.</p><p>There already exist comparative programs that attempt pseudoknot prediction. These programs use the maximum weighted matching algorithm (MWM algorithm) [<xref ref-type="bibr" rid="pcbi-0030149-b035">35</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b036">36</xref>] to extract an RNA secondary structure that may contain pseudoknots from a given set of base-pairs with different weights. Tabaska et al. [<xref ref-type="bibr" rid="pcbi-0030149-b037">37</xref>] use a non-comparative approach to obtain these weighted base-pairs, whereas Witwer [<xref ref-type="bibr" rid="pcbi-0030149-b038">38</xref>] analyzes a fixed input alignment with the comparative RNA structure prediction program RNAalifold [<xref ref-type="bibr" rid="pcbi-0030149-b010">10</xref>] (which cannot predict pseudoknotted secondary structures) to obtain weighted base-pairs. The MWM algorithm requires <italic>O</italic>(<italic>L</italic><sup>3</sup>) time to analyze an RNA sequence of length <italic>L,</italic> but requires a post-processing step to extract a bi-secondary structure [<xref ref-type="bibr" rid="pcbi-0030149-b039">39</xref>]. Both programs have the same problems as the underlying algorithms and often have a low prediction accuracy [<xref ref-type="bibr" rid="pcbi-0030149-b037">37</xref>]. Ruan et al. [<xref ref-type="bibr" rid="pcbi-0030149-b040">40</xref>] developed a program that can utilize thermodynamic or comparative information or both. The overall accuracy is 80% for identifying base-pairs. However, this performance is achieved only with input alignments of very high quality that cannot be established without already knowing the conserved RNA secondary structure.</p><p>The fundamental conceptual problem that all of these comparative programs face is that they require an input alignment of high quality to be able to predict the conserved RNA secondary structure. However, such an alignment can often only be established if we already know the conserved RNA secondary structure. These comparative structure prediction programs thus face a major chicken-and-egg problem. If the sequences are very well conserved and easy to align based on primary sequence similarity, the resulting alignment may contain no or few co-varying columns. If, at the other extreme, the sequences are only distantly related, a trustworthy sequence alignment that would exhibit many co-varying columns is impossible to establish based on primary sequence similarity alone. Comparative RNA structure prediction methods that take a fixed alignment as input can therefore analyze only a very limited range of available data successfully.</p><p>This chicken-and-egg problem has been addressed by several comparative structure prediction programs that do not require a fixed input alignment, Dynalign [<xref ref-type="bibr" rid="pcbi-0030149-b041">41</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b042">42</xref>], Foldalign [<xref ref-type="bibr" rid="pcbi-0030149-b043">43</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b044">44</xref>], CARNAC [<xref ref-type="bibr" rid="pcbi-0030149-b045">45</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b046">46</xref>], ComRNA [<xref ref-type="bibr" rid="pcbi-0030149-b047">47</xref>], Stemloc [<xref ref-type="bibr" rid="pcbi-0030149-b048">48</xref>], and CONSAN [<xref ref-type="bibr" rid="pcbi-0030149-b049">49</xref>]. However, these programs find only very conserved local structures and do not model the evolutionary relationship between the sequences. ComRNA, CARNAC, and Stemloc can analyze several input sequences (Stemloc achieves this by calculating progressive pairwise alignments), whereas Dynalign, Foldalign, and CONSAN are limited to only two input sequences. ComRNA is the only one of these programs that can predict pseudoknotted secondary structures. The predictions of ComRNA rely on the calculation of maximal cliques, a problem that is known to be NP-complete. In the general case, it thus requires exponential time to run analyses, but it may be fast enough to analyze short sequences.</p><p>To summarize, all of the existing RNA structure prediction programs face at least one of the following challenges: (1) the MFE structure rather than the evolutionarily conserved structure that is likely to correspond to the functional structure is predicted, (2) unstructured regions of the RNA are not explicitly modeled, (3) input alignments are fixed and cannot be altered and improved, (4) pseudoknotted structures are either completely ignored or computationally too expensive to predict, (5) only two evolutionarily related RNA sequences are used as input, or (6) the evolutionary relationship between the RNA sequences is not explicitly modeled.</p><p>There are several good reasons to convince ourselves that many of these problems can be best solved simultaneously. For example, a good structure prediction should improve the prediction of a good alignment, and vice versa. Likewise, the prediction of a good alignment should improve the prediction of the correct evolutionary relationship of the RNA sequences, and vice versa.</p><p>The idea of co-estimating RNA secondary structures, multiple sequence alignments, and evolutionary trees was first suggested in a theory paper by David Sankoff in 1985 [<xref ref-type="bibr" rid="pcbi-0030149-b050">50</xref>]. As the proposed strategy is computationally very demanding, this approach did not receive much attention until the mid-1990s, when Eddy and Durbin [<xref ref-type="bibr" rid="pcbi-0030149-b051">51</xref>] and Sakakibara et al. [<xref ref-type="bibr" rid="pcbi-0030149-b052">52</xref>] introduced covariance models (CMs). CMs employ stochastic context-free grammars (SCFGs) [<xref ref-type="bibr" rid="pcbi-0030149-b052">52</xref>] to align a given RNA sequence to a fixed multiple sequence alignment via a consensus RNA secondary structure that may not contain pseudoknots. CMs do not explicitly model the evolution of the sequences in the alignment, but only consider different nucleic acids. Such a model can also be used for pseudoknot-free secondary structure prediction [<xref ref-type="bibr" rid="pcbi-0030149-b032">32</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b034">34</xref>]. Modeling the insertion–deletion process with constraints on a pseudoknot-free consensus RNA secondary structure is a much harder problem, and, so far, only a few studies [<xref ref-type="bibr" rid="pcbi-0030149-b053">53</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b054">54</xref>] have tried to address the problem. By considering both alignment and secondary structure, other studies extended the pioneering work of Sankoff without explicitly considering an evolutionary model [<xref ref-type="bibr" rid="pcbi-0030149-b055">55</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b056">56</xref>]. As pseudoknots are context-dependent structures that cannot be modeled with SCFGs, CMs cannot be used to model pseudoknotted RNA structures.</p><p>We here propose a novel theoretical framework for solving the problem of co-estimating RNA secondary structures including pseudoknots, multiple sequence alignments, and evolutionary trees. We introduce a joint distribution of RNA structures, alignments, and trees in a Bayesian framework. As it is not feasible to analytically calculate any interesting statistics in this model in reasonable computational time, we propose a Markov chain Monte Carlo (MCMC) method with which we can sample from the posterior distribution.</p></sec><sec id="s2" sec-type="methods"><title>Methods</title><sec id="s2a"><title>Bayesian Considerations</title><p>According to elementary probability theory, the following equation holds:
					<disp-formula id="pcbi-0030149-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:math> --></disp-formula>where <italic>D</italic> stands for data, i.e., the individual, un-aligned RNA sequences, <italic>Z</italic> := <italic>P</italic>(<italic>D</italic>) denotes the so-called partition function, <italic>S</italic> is a consensus RNA secondary structure that may contain pseudoknots, <italic>A</italic> is a multiple sequence alignment, and <italic>T</italic> is an evolutionary tree relating the sequences. Equation 1 is also called Bayes' theorem. The aim of the MCMC algorithm is to sample from the posterior probability distribution, i.e., from <italic>P</italic>(<italic>S, A, T</italic>|<italic>D</italic>), using the terms on the right hand side of Equation 1. For the sampling, we need to know only the ratio of the probabilities, <italic>P</italic>(<italic>S</italic><sub>1</sub>, <italic>A</italic><sub>1</sub>, <italic>T</italic><sub>1</sub>|<italic>D</italic>)/<italic>P</italic>(<italic>S</italic><sub>2</sub>, <italic>A</italic><sub>2</sub>, <italic>T</italic><sub>2</sub>|<italic>D</italic>). We thus have to be able to calculate <italic>P</italic>(<italic>S, A, T</italic>|<italic>D</italic>) and <italic>P</italic>(<italic>S, A, T</italic>) only up to a constant factor and can, for example, omit the calculation of <italic>Z</italic>.
				</p></sec><sec id="s2b"><title>Decomposing the Posterior</title><p>We now explain how we calculate the different terms on the right hand side of Equation 1. We also introduce models and explain how to employ them to calculate the terms on the right hand side of the equation. The definitions that we propose for the prior probabilities merit a detailed discussion as there is currently no widely accepted consensus on how to define these prior distributions. Concerning the calculation of the likelihood, we make a conscious decision to use the widely known Felsenstein likelihood.</p><sec id="s2b1"><title>The likelihood.</title><p>The likelihood, <italic>P</italic>(<italic>D</italic>|<italic>S, A, T</italic>), is the probability of observing the individual sequences, namely <italic>D,</italic> as the leaves of the evolutionary tree <italic>T</italic> in multiple sequence alignment <italic>A</italic> and with the consensus RNA secondary structure <italic>S</italic>. We calculate the likelihood in a computationally efficient way using the Felsenstein algorithm [<xref ref-type="bibr" rid="pcbi-0030149-b057">57</xref>], whose time requirement scales linearly with the number of sequences in the alignment and the length of the alignment. The main idea of the Felsenstein algorithm is to model the evolution of nucleotides in the alignment along the evolutionary tree <italic>T</italic>. For this, we partition the alignment into single, unpaired columns and pairs of base-paired columns according to the RNA secondary structure <italic>S</italic>. We then model the evolution along the tree with two reversible, time-continuous Markov chain models. One chain models the substitution process in every unpaired column of nucleotides involving four characters. The other chain models the substitution process of base-paired nucleotides in every pair of columns involving 16 characters [<xref ref-type="bibr" rid="pcbi-0030149-b031">31</xref>]. For both chains, we use the same rate matrices and equilibrium distributions as the program Pfold [<xref ref-type="bibr" rid="pcbi-0030149-b032">32</xref>]. Each of the two rate matrices, <bold>Q</bold>, is in diagonalized format. Transition probabilities for arbitrary evolutionary times <italic>t</italic> can thus be easily calculated using
						<disp-formula id="pcbi-0030149-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mstyle mathvariant='bold' mathsize='normal'><mml:mi>Q</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>&equals;</mml:mo><mml:mstyle mathvariant='bold' mathsize='normal'><mml:mi>V</mml:mi></mml:mstyle><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mstyle mathvariant='bold' mathsize='normal'><mml:mi>&Lambda;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant='bold' mathsize='normal'><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math> --></disp-formula>where <bold>Λ</bold> is a diagonal matrix containing the eigenvalues of <bold>Q</bold>, and <bold>V</bold> is the matrix containing the normalized eigenvectors of <bold>Q</bold>. We adhere to the computationally convenient custom [<xref ref-type="bibr" rid="pcbi-0030149-b031">31</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b034">34</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b058">58</xref>] of treating gaps as missing information.
					</p></sec><sec id="s2b2"><title>The prior.</title><p>We write the prior, <italic>P</italic>(<italic>S, A, T</italic>), as the product of the following terms:
						<disp-formula id="pcbi-0030149-e003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mfrac><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:math> --></disp-formula>where <italic>C</italic> denotes an unknown normalization constant that does not depend on <italic>S, A,</italic> or <italic>T</italic>. The decomposition into the three functions <italic>F</italic><sub>1</sub>, <italic>F</italic><sub>2</sub>, and <italic>F</italic><sub>3</sub> is, to a certain extent, arbitrary and reflects our understanding of the underlying biological problem. We now explain in detail our reasons for choosing this decomposition. The consensus secondary structure, <italic>S,</italic> clearly depends on the alignment, <italic>A,</italic> e.g., its length. We cannot, for example, have a hairpin spanning 40 bases if the alignment itself is shorter than this. The alignment, <italic>A,</italic> is the result of an evolutionary process of insertions and deletions (indels). We describe the prior as the product of the three functions <italic>F</italic><sub>1</sub>, <italic>F</italic><sub>2</sub>, and <italic>F</italic><sub>3</sub>, which we now introduce in detail.
					</p></sec><sec id="s2b3"><title>The tree prior, <italic>F</italic><sub>1</sub>(<italic>T</italic>).</title><p>The likelihood function, <italic>P</italic>(<italic>D</italic>|<italic>S, A, T</italic>), does not converge to zero for increasing branch lengths in the tree, i.e., for evolutionarily independent sequences. The integral of the likelihood function over all possible trees would therefore be infinite without a properly chosen prior for trees. We thus set <italic>F</italic><sub>1</sub>(<italic>T</italic>) equal to <italic>P</italic>(<italic>T</italic>), i.e., to the prior probability for trees. One straightforward choice for the tree prior would have been Kingman's coalescent [<xref ref-type="bibr" rid="pcbi-0030149-b059">59</xref>]; however, it assumes a molecular clock. Instead, we chose the standard exponential distribution on edge lengths as a less informative prior, <inline-formula id="pcbi-0030149-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030149.ex001" xlink:type="simple"/></inline-formula>
						, where each <italic>t<sub>i</sub></italic> corresponds to the length of edge <italic>i</italic> in the tree.
					</p></sec><sec id="s2b4"><title>The structure prior, <italic>F</italic><sub>2</sub>(<italic>S, A</italic>).</title><p>The consensus secondary structure, <italic>S,</italic> clearly depends at least on the length of the alignment, <italic>A</italic>. In addition, we penalize indels occurring asymmetrically in helices. Such gaps indicate bulges in some sequences, and each bulge gets a penalty of one per nucleotide. We set <italic>F</italic><sub>2</sub>(<italic>S, A</italic>) equal to the prior probability of the RNA structure, <italic>S</italic>. By definition, the structure prior does not depend on the nucleotides in the sequences. Rather, it is the probability of observing the structure independent of the sequence itself. We use a free-energy-based model that scores the RNA structure <italic>S</italic> according to purely entropy-based free energies, i.e., δ<italic>G</italic>(<italic>S</italic>) = δ<italic>S</italic>(<italic>S</italic>) · <italic>t,</italic> where δ<italic>S</italic> is the entropy, which depends only on the topology of the RNA structure <italic>S</italic> [<xref ref-type="bibr" rid="pcbi-0030149-b060">60</xref>], and <italic>t</italic> is the temperature in degrees Kelvin. <italic>F</italic><sub>2</sub>(<italic>S, A</italic>) is given by
						<disp-formula id="pcbi-0030149-e004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>2</mml:mtext></mml:msub><mml:mtext>(</mml:mtext><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mtext>)</mml:mtext><mml:mo>&equals;</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&minus;</mml:mo><mml:mfrac><mml:mrow><mml:mi>&delta;</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>&equals;</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&minus;</mml:mo><mml:mfrac><mml:mrow><mml:mi>&delta;</mml:mi><mml:mi>S</mml:mi><mml:mtext>(</mml:mtext><mml:mi>S</mml:mi><mml:mtext>)</mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>&equals;</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&minus;</mml:mo><mml:mfrac><mml:mrow><mml:mi>&delta;</mml:mi><mml:mi>S</mml:mi><mml:mtext>(</mml:mtext><mml:mi>S</mml:mi><mml:mtext>)</mml:mtext></mml:mrow><mml:mi>R</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math> --></disp-formula>where <italic>R</italic> is the universal gas constant.
					</p><p>The entropy of a pseudoknot-free secondary structure can be calculated by decomposing it into loops [<xref ref-type="bibr" rid="pcbi-0030149-b004">4</xref>], where the entropy contribution for each loop of length <italic>L</italic> is
						<disp-formula id="pcbi-0030149-e005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>&delta;</mml:mi><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&equals;</mml:mo><mml:mn>1.75</mml:mn><mml:mo>&sdot;</mml:mo><mml:mi>R</mml:mi><mml:mo>&sdot;</mml:mo><mml:mi>ln</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>
					</p><p>For pseudoknotted secondary structures, the calculation of the structure's entropy becomes more complicated. We use a simple model where each stretch of unpaired nucleotides of length <italic>L</italic><italic>˜</italic> (which is neither a loop nor a stretch of sequence outside base-pairs) in a pseudoknot gets an entropy contribution of
						<disp-formula id="pcbi-0030149-e006"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>&delta;</mml:mi><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&equals;</mml:mo><mml:mn>1.75</mml:mn><mml:mo>&sdot;</mml:mo><mml:mi>R</mml:mi><mml:mo>&sdot;</mml:mo><mml:mi>ln</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent='true'><mml:mi>L</mml:mi><mml:mo>&tilde;</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>
					</p><p>The structure prior, <italic>F</italic><sub>2</sub>(<italic>S, A</italic>), therefore does not depend on the ambient temperature of the investigated RNA structures.</p><p>Other structure priors for pseudoknotted structures have, for example, been developed by Isambert and Siggia [<xref ref-type="bibr" rid="pcbi-0030149-b018">18</xref>] and Rivas and Eddy [<xref ref-type="bibr" rid="pcbi-0030149-b023">23</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b024">24</xref>]. While developing and testing SimulFold, we also implemented a structure prior that is equivalent to the one proposed by Rivas and Eddy, but found no improvement with respect to the prior described here (unpublished data).</p></sec><sec id="s2b5"><title>The alignment prior, <italic>F</italic><sub>3</sub>(<italic>A</italic>).</title><p>The alignment, <italic>A,</italic> is a result of an evolutionary indel process along the tree, <italic>T</italic>. We define <italic>F</italic><sub>3</sub>(<italic>A</italic>) to model the gap contribution to the likelihood. We are not aware of any stochastic evolutionary model for indels that can handle an additional constraint on RNA secondary structure and that allows computationally efficient likelihood computations. We therefore use prior probabilities on alignments to incorporate indel events into our model. We choose <italic>F</italic><sub>3</sub>(<italic>A</italic>) as the exponentiated penalty scores of gaps in the alignment, <italic>A</italic>. We decompose the alignment into homogeneous groups as shown in <xref ref-type="fig" rid="pcbi-0030149-g001">Figure 1</xref>. This decomposition considers only the location of gaps in the alignment and does not take the RNA secondary structure, the tree, or the different types of nucleotides in the alignment explicitly into account. Log(<italic>F</italic><sub>3</sub>(<italic>A</italic>)) is the sum of terms for each column in the alignment. The contribution by each column is the sum of one or more of the following terms (which are not mutually exclusive): gap opening penalty if at least one new gap is opened in the column, gap closing penalty if at least one gap is closed in the column, and gap penalty if there is at least one gap in the column. A gap opening gets a penalty of six, a gap closing gets a penalty of six, and a gap extension gets a penalty of three. Gap opening penalties are reduced by two if there are sequences where gaps have already been opened in other alignment columns. These penalty scores are similar to the standard gap penalties commonly used in alignment programs, e.g., Clustal-X [<xref ref-type="bibr" rid="pcbi-0030149-b061">61</xref>]. Gap opening and closing penalties are omitted at the beginning and the end of the alignment.</p><fig id="pcbi-0030149-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030149.g001</object-id><label>Figure 1</label><caption><title>Alignment Prior</title><p>For calculating the gap contribution to the prior, <italic>F</italic><sub>3</sub>(<italic>A</italic>), we decompose the alignment into homogeneous groups based only on the pattern of the gaps in the alignment. Each asterisk represents a nucleotide in the alignment, and each dash denotes a gap in the alignment.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030149.g001" xlink:type="simple"/></fig></sec></sec><sec id="s2c"><title>Sampling from the Posterior Distribution</title><p>The analytical calculation of the posterior distribution is computationally too expensive. Instead, we employ a Bayesian MCMC method [<xref ref-type="bibr" rid="pcbi-0030149-b062">62</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b063">63</xref>] to sample from the posterior distribution. This corresponds to a random walk on the possible states (<italic>S, A, T</italic>), whose stationary distribution is the posterior distribution, <italic>P</italic>(<italic>S, A, T</italic>|<italic>D</italic>). The random walk is constructed in two steps. In the first step, a new state, <italic>X</italic><sub>new</sub> := (<italic>S, A, T</italic>)<sub>new</sub> in our case, is drawn from a proposal distribution, <italic>P</italic>, and in the second step, the discrepancy between the proposal and the target distribution, π, is corrected by accepting the proposal with probability
					<disp-formula id="pcbi-0030149-e007"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e007" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>accept</mml:mtext></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>&equals;</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo stretchy="true">&lcub;</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mtext>new</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mi>&pi;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mtext>new</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mtext>new</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mi>&pi;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">&rcub;</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>where <italic>X</italic> = (<italic>S, A, T</italic>) is the actual state of the chain. The chain remains in state <italic>X</italic> with probability 1 − <italic>P</italic><sub>accept</sub> [<xref ref-type="bibr" rid="pcbi-0030149-b062">62</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b064">64</xref>].
				</p><p>The mixing of the Markov chain depends on how closely the proposal distribution resembles the target distribution. Gibbs sampling is a special case of MCMC sampling, where each state <italic>X</italic> can be described as a multidimensional vector <bold><italic>X</italic></bold> = (<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>,...<italic>x<sub>n</sub></italic>) and where it is possible to draw a new random coordinate <italic>x<sub>i</sub></italic> from the conditional distribution <italic>P</italic>(<italic>x<sub>i</sub></italic>|<italic>X</italic>[−<italic>i</italic>]) for any state <italic>X</italic> and any coordinate <italic>i</italic>. <bold><italic>X</italic></bold>[−<italic>i</italic>] denotes the vector of coordinates without coordinate <italic>i</italic>. As the newly drawn coordinate is always accepted, the Gibbs sampler is an MCMC method with an acceptance probability of one.</p><p>As it is generally not possible to sample from an arbitrary conditional distribution, the Gibbs sampling strategy can only rarely be used. However, it is possible to mimic the conditional distribution with an auxiliary distribution. This strategy is employed in partial importance sampling; see MacKay [<xref ref-type="bibr" rid="pcbi-0030149-b065">65</xref>] for an overview of different sampling strategies. Importance sampling has been successfully used to model different distributions that occur in the context of bioinformatics [<xref ref-type="bibr" rid="pcbi-0030149-b066">66</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b067">67</xref>], and we employ it for proposing alignments and RNA secondary structures. We define a Markov chain that converges to the desired distribution and then use this chain to sample from the posterior. As we have seen in the section before, the posterior distribution is a joint distribution on RNA structures, multiple sequence alignments, and trees. The challenge is to define moves on this joint distribution that are reversible and ergodic, and that satisfy detailed balance [<xref ref-type="bibr" rid="pcbi-0030149-b063">63</xref>].</p><p>It is possible to define tree moves that are independent from the actual alignment and RNA structure. However, it is generally impossible to alter the alignment without disturbing the RNA structure. We therefore use the following three types of moves: changing the length of an edge in the tree, changing the tree topology, and using a complex move that alters both the RNA structure and the alignment.</p><sec id="s2c1"><title>Tree moves and tree sampling.</title><p>We use the Metropolis-Hastings algorithm [<xref ref-type="bibr" rid="pcbi-0030149-b064">64</xref>] for sampling tree moves. The tree sampling is divided into two steps, one to change the length of an edge and one to change the tree's topology. We use standard moves for changing the edge lengths [<xref ref-type="bibr" rid="pcbi-0030149-b068">68</xref>], and nearest neighbour interchange [<xref ref-type="bibr" rid="pcbi-0030149-b069">69</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b070">70</xref>] for changing the tree topology. For sampling the edge length, we first pick an edge of the tree at random and then choose a new edge length, <italic>L</italic><sub>new</sub>, from the interval [max{0, <italic>L −</italic> δ, <italic>L</italic> + δ}] where <italic>L</italic> is the old edge length and δ := 0.1, the fixed span for sampling edge lengths. Using the Felsenstein algorithm [<xref ref-type="bibr" rid="pcbi-0030149-b057">57</xref>], we then calculate the loglikelihood of the alignment given the old tree, log(<italic>P</italic>(<italic>D</italic>|<italic>S, A, T</italic>)), and the loglikelihood of the alignment given the new tree with the new edge length, log(<italic>P</italic>(<italic>D</italic>|<italic>S, A, T</italic><sub>new</sub>)). We accept the new edge length if a random number <italic>r</italic> ∈ [0, 1] is smaller than the following Metropolis-Hastings ratio, i.e., if
						<disp-formula id="pcbi-0030149-e008"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e008" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>new</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo><mml:mi>&delta;</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>new</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>&delta;</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math> --></disp-formula>where δ<italic>L</italic><sub>new</sub> is the length of interval [max {0, <italic>L</italic><sub>new</sub> − δ}, <italic>L</italic><sub>new</sub> + δ] and δ<italic>L</italic> is the length of interval [max {0, <italic>L</italic> − δ}, <italic>L</italic> + δ], and we reject the new edge length otherwise.
					</p><p>For changing the topology of the tree, we pick a tree node at random and swap this node and its aunt node to alter its topology (see <xref ref-type="fig" rid="pcbi-0030149-g002">Figure 2</xref>). These moves have been shown [<xref ref-type="bibr" rid="pcbi-0030149-b068">68</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b071">71</xref>] to be ergodic, i.e., any tree topology can be transformed into any other tree topology using these moves. We then calculate the loglikelihood of the alignment given the old tree, log(<italic>P</italic>(<italic>D</italic>|<italic>S, A, T</italic>)), and the loglikelihood of the alignment given the new tree with the new tree topology, log(<italic>P</italic>(<italic>D</italic>|<italic>S, A, T</italic><sub>new</sub>)). We accept the new tree topology if a random number <italic>r</italic> ∈ [0, 1] is smaller than the following Metropolis-Hastings ratio, i.e., if
						<disp-formula id="pcbi-0030149-e009"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e009" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>new</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>and reject the new tree topology otherwise.
					</p><fig id="pcbi-0030149-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030149.g002</object-id><label>Figure 2</label><caption><title>Sampling of Tree Topologies</title><p>The topology of the tree on the left gets modified into the tree on the right by swapping an aunt (A) and its niece (B). Nice–aunt swapping has been shown to be ergodic.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030149.g002" xlink:type="simple"/></fig></sec><sec id="s2c2"><title>Structure and alignment moves and sampling.</title><p>Simultaneously changing the structure and alignment is more sophisticated and merits a detailed discussion. The challenge is to define moves that can significantly change the actual state, that can be calculated efficiently, and that have a high probability of being accepted. <xref ref-type="fig" rid="pcbi-0030149-g003">Figure 3</xref> gives a symbolic description of our sampling strategy.</p><fig id="pcbi-0030149-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030149.g003</object-id><label>Figure 3</label><caption><title>Sampling Alignment and Structure</title><p>We sample a new alignment by choosing a random window of the alignment that is devoid of base-pairs and by realigning it (step 1). We then sample a new RNA structure by removing a random set of helices from the given structure (step 2) and by adding a set of new helices (step 3).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030149.g003" xlink:type="simple"/></fig><p>The alignment is sampled in the following way while keeping the RNA structure and tree fixed. We first find intervals in the alignment that do not contain any base-paired positions and that cannot be further extended. We then choose one of these intervals at random and propose a new alignment for this interval. This alignment is created using a stochastic version of iterative alignment along the fixed tree [<xref ref-type="bibr" rid="pcbi-0030149-b067">67</xref>], where two alignments are merged at each internal tree node into a new one by forward–backward sampling from the posterior of a pair hidden Markov model [<xref ref-type="bibr" rid="pcbi-0030149-b072">72</xref>]. The resulting new overall alignment is the proposal alignment. We accept it if the following Metropolis-Hastings ratio is larger than a random number <italic>r</italic> ∈ [0, 1]:
						<disp-formula id="pcbi-0030149-e010"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e010" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mtext>new</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>backproposal</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>proposal</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>and reject it otherwise. <italic>P</italic>(<italic>D</italic>|<italic>S, A</italic><sub>new</sub>, <italic>T</italic>) denotes the likelihood given the new alignment and <italic>P</italic>(<italic>D</italic>|<italic>S, A, T</italic>) the likelihood given the old alignment, calculated as described above. <italic>P</italic><sub>proposal</sub> and <italic>P</italic><sub>backproposal</sub> denote the proposal and backproposal probabilities, respectively. The backproposal probability is defined as the probability of choosing the old state from the proposal distribution given that we are in the new state of the Markov chain.
					</p><p>Once the alignment has been sampled, we sample the RNA structure while keeping the alignment and the tree fixed. The challenge is to devise a unique way of proposing a new structure; otherwise we cannot easily calculate the proposal and backproposal probabilities. We propose a new structure in the following way. We first decide on the number of helices to be removed from the given set of helices by drawing a random number from the truncated Poisson distribution with parameter λ = 3. We then remove this number of helices from a weighted distribution, where the weight of each helix is the log-odds ratio of its Felsenstein likelihoods (i.e., the likelihood of the RNA without any base-pairs and the likelihood of the RNA with the helix). The set of removed helices is denoted <italic>R</italic>. We then propose a new set of helices, <italic>N</italic>. Before starting the MCMC, we calculate two matrices for each RNA sequence in <italic>D,</italic> denoted <bold>H</bold> and <bold>E</bold>, which remain unchanged during the MCMC run. <bold>H</bold> is a two-dimensional matrix where matrix element <italic>H</italic>(<italic>i, j</italic>) is the score of the best helix whose outer base-pair is at sequence positions {<italic>i, j</italic>}. The elements in the matrix are calculated using dynamic programming. <bold><italic>E</italic></bold> is a one-dimensional vector where entry <italic>E</italic>(<italic>i</italic>) = Σ<italic><sub>j</sub> H</italic>(<italic>i, j</italic>) is the score for starting a helix at sequence position <italic>i</italic> on the 5′ side. Each new helix in set <italic>N</italic> is sampled in the following way. We scan the alignment from left to right and make a random decision where to start the helix. We choose the 5′ start of the new helix proportional to the sum of <italic>E</italic> values in that column of the alignment, i.e., we use importance sampling. Once the 5′ start of the new helix has been fixed, we choose the 3′ end of the helix proportional to the sum of <italic>H</italic> values in the corresponding column of the alignment. Now that both ends of the new helix are fixed, we choose the number of consecutive base-pairs in the helix based on the quality of the resulting helix. The quality of a helix is defined as the log-odds ratio of its Felsenstein likelihoods (i.e., the likelihood of the RNA without the helix and the likelihood of the RNA with the helix). Using this procedure, we can sample a reasonable new helix in a computationally very efficient way that requires only linear rather than cubic time. We accept the new RNA structure that differs from the old RNA structure by the set of removed helices, <italic>N,</italic> if the following Metropolis-Hastings ratio is larger than a random number <italic>r</italic> ∈ [0, 1]:
						<disp-formula id="pcbi-0030149-e011"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e011" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mtext>new</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>backproposal</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>proposal</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math> --></disp-formula>where <italic>P</italic>(<italic>S</italic><sub>new</sub>, <italic>A, T</italic>|<italic>D</italic>) is the posterior probability given the new RNA structure and <italic>P</italic><sub>proposal</sub> and <italic>P</italic><sub>backproposal</sub> are the proposal and backproposal probabilities, respectively.
					</p></sec></sec><sec id="s2d"><title>Analyzing the MCMC Results</title><p>The primary result of an MCMC run is a large set of simulated (<italic>S, T, A</italic>) triples that are distributed according to the posterior distribution. This data needs post-processing to characterize and visualize the posterior distribution. As we are interested in deriving the RNA structure that is best supported by the posterior distribution, we therefore marginalize with respect to the RNA structure.</p><p>We project the RNA structure, <italic>S,</italic> of each sampled (<italic>S, T, A</italic>) triple onto the RNA sequences in <italic>D</italic> and thereby obtain a set of RNA structures for each individual RNA sequence. The challenge is to combine these structures into a single RNA structure that captures the prominent features of the set of structures.</p><p>There already exist a number of programs that determine a consensus structure for a given set of RNA structures, e.g., RNAdistance of the Vienna package [<xref ref-type="bibr" rid="pcbi-0030149-b007">7</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b073">73</xref>] and RNA-Forester [<xref ref-type="bibr" rid="pcbi-0030149-b074">74</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b075">75</xref>]. RNA-Forester computes a global structural alignment for several unaligned sequences with known secondary structures using a dynamic programming procedure that depends on scores with combined information on structure and sequence similarity. However, RNA-Forester and RNAdistance both require the input RNA structures to be secondary structures and cannot handle pseudoknots.</p><sec id="s2d1"><title>Deriving a consensus RNA structure including pseudoknots.</title><p>We use the following procedure for deriving a consensus bi-secondary structure for each individual sequence. For each simulated (<italic>S, T, A</italic>) triple, we project the RNA structure, <italic>S,</italic> onto the individual sequences in <italic>D</italic>. For each RNA sequence, we then transform the set of its structures into a table of base-pairing probabilities by converting the relative frequency of base-pairs in the RNA structures into estimates of base-pairing probabilities. The set of base-pairs with pairing probabilities larger than zero is then used as input to the MWM algorithm [<xref ref-type="bibr" rid="pcbi-0030149-b035">35</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b036">36</xref>]. We use the algorithm in its implementation by Rothberg [<xref ref-type="bibr" rid="pcbi-0030149-b076">76</xref>], which requires <italic>O</italic>(<italic>L</italic><sup>3</sup>) time and <italic>O</italic>(<italic>L</italic><sup>2</sup>) memory to analyze a sequence in which <italic>L</italic> positions can be base-paired. The MWM algorithm operates on an undirected, weighted graph where each node represents a sequence position and each edge between two nodes represents a base-pair between the two corresponding sequence positions. We set the weight of each edge to the weight of the helix to which this base-pair belongs, and define the weight of a helix as the sum of the probabilities of its base-pairs. The MWM algorithm determines the highest-scoring subset of mutually compatible base-pairs that, in mathematical terms, corresponds to a maximum weighted matching in the graph. Two base-pairs are defined as compatible if they do not share a sequence position. In the general case, the base-pairs of the maximum weighted matching need not correspond to a bi-secondary structure. Bi-secondary structures [<xref ref-type="bibr" rid="pcbi-0030149-b039">39</xref>] are planar structures that can be visualized as the superposition of at most two disjoint secondary structures. The class of bi-secondary structures comprises secondary structures and a wide variety of pseudoknots, but excludes true knots. The α-operon mRNA structure is one of the very few examples that is not a bi-secondary structure; refer to Condon et al. [<xref ref-type="bibr" rid="pcbi-0030149-b077">77</xref>] for an overview of the different classes of pseudoknots and their relationships to each other. As there is yet no variant of the MWM algorithm with a constraint on bi-secondary structures, we need a post-processing step to extract a high-scoring bi-secondary structure from the base-pairs of the maximum weighted matching. We do this in the following way. We order the helices by decreasing weight and assign colour 1 to the first and highest-scoring helix. The next uncoloured helix in the list gets the same colour as the first set of already coloured helices with which it can form a secondary structure (the sets of already coloured helices are ordered by increasing colour-number). If the uncoloured helix cannot form a valid secondary structure with any set of already coloured helices, it is assigned to the next available new colour. Once all helices have been coloured, the helices of colours 1 and 2 (if any helices of colour 2 exist) form the final bi-secondary structure. This RNA structure is the RNA structure that is predicted by SimulFold for that individual RNA sequence. We implemented the structure post-processing step in a dedicated program, called bp2bistruc, which takes an upper-triangle matrix of base-pairing probabilities as input and calculates a high-scoring bi-secondary RNA structure. This predicted structure is accompanied by posterior probabilities, which are useful to highlight the more and the less reliably estimated parts of the predicted structure (see <xref ref-type="fig" rid="pcbi-0030149-g004">Figure 4</xref>).</p><fig id="pcbi-0030149-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030149.g004</object-id><label>Figure 4</label><caption><title>RNA Structure with Pseudoknot Predicted by SimulFold for the HDV Sequence of Organism AJ309880 Using the MCMC Results Generated with Parallel Tempering</title><p>The pairing probabilities estimated by SimulFold are colour-coded and range from bright green (high probability) to bright red (low probability). The pairing probabilities for this structure range from 0.62 for the pair at sequence positions {4, 38} to one for most of the base-pairs, e.g., the one at sequence positions {6, 36}. For this figure, we have adopted a nonlinear colouring scheme; otherwise, all base-pairs would simply come in slightly different shades of green.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030149.g004" xlink:type="simple"/></fig></sec></sec></sec><sec id="s3"><title>Results</title><sec id="s3a"><title>Features of Available Secondary Structure Prediction Programs</title><p>SimulFold is to our knowledge the first program that predicts an RNA structure including pseudoknots while simultaneously estimating an alignment as well as an evolutionary tree for several, evolutionarily related input RNA sequences. It was therefore not possible to present a comparison to a truly equivalent program. Instead, we compare the RNA structures predicted by SimulFold to those predicted by RNAalifold [<xref ref-type="bibr" rid="pcbi-0030149-b010">10</xref>], Hxmatch [<xref ref-type="bibr" rid="pcbi-0030149-b078">78</xref>], Pfold [<xref ref-type="bibr" rid="pcbi-0030149-b031">31</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b032">32</xref>], and CARNAC [<xref ref-type="bibr" rid="pcbi-0030149-b045">45</xref>,<xref ref-type="bibr" rid="pcbi-0030149-b046">46</xref>].</p><p>RNAalifold takes a fixed alignment as input and predicts a consensus RNA secondary structure without pseudoknots. It extends the MFE algorithm employed by the non-comparative MFE methods Mfold and RNAfold by interpreting the fixed input alignment as a hyper-sequence and by simultaneously minimizing the overall free energy while taking the primary sequence conservation and co-varying columns in the fixed alignment into account. The optimization is implemented in a dynamic programming procedure that combines free energy parameters with conservation scores.</p><p>Hxmatch is an extension of RNAalifold. Like RNAalifold, it takes a fixed alignment as the only input and predicts a consensus RNA secondary structure. However, unlike RNAalifold, it is capable of predicting secondary structures with pseudoknots. Hxmatch employs a two-step procedure. In the first step, the fixed input alignment is analyzed with RNAalifold [<xref ref-type="bibr" rid="pcbi-0030149-b010">10</xref>] of the Vienna package, which calculates the base-pairing probability for each possible pair of columns in the alignment by considering all possible secondary structures without pseudoknots. In the second step, these weighted base-pairs are used as input to the MWM algorithm. The MWM algorithm derives the highest-scoring subset of mutually compatible base-pairs, requiring <italic>O</italic>(<italic>L</italic><sup>3</sup>) time and <italic>O</italic>(<italic>L</italic><sup>2</sup>) memory to analyze an input alignment of length <italic>L</italic>. As these base-pairs need not correspond to a bi-secondary structure, a heuristic, greedy algorithm is then employed to extract a bi-secondary structure. The MWM algorithm and the greedy algorithm are repeatedly used until the resulting bi-secondary structure remains unchanged or 30 iterations have been completed. Hxmatch does not take the evolutionary relationship of the input RNA sequences explicitly into account.</p><p>Pfold takes as input not only a fixed alignment, but also an evolutionary tree relating the sequences, and predicts a consensus secondary structure which does not contain pseudoknots, as Pfold cannot handle pseudoknots. Pfold employs an SCFG, i.e., a probabilistic rather than an MFE model, to derive the consensus secondary structure. Similar to RNAalifold, it takes the primary sequence conservation and co-varying columns in the fixed input alignment into account. Unlike RNAalifold, Pfold also takes the known evolutionary relationship of the input sequences, i.e., the input tree, explicitly into account. Both, Pfold, and RNAalifold require <italic>O</italic>(<italic>L</italic><sup>3</sup>) time and <italic>O</italic>(<italic>L</italic><sup>2</sup>) memory to analyze an input alignment of length <italic>L</italic>.</p><p>CARNAC is also a comparative RNA structure prediction method. It takes several unaligned RNA sequences as input and predicts an RNA structure for each individual RNA sequence which does not contain pseudoknots, as CARNAC cannot handle pseudoknots. Similarly to Hxmatch and RNAalifold, it does not take the evolutionary relationship of the input sequences explicitly into account. CARNAC employs a multi-step procedure for generating predictions. In the first step, potential helices are predicted for each RNA sequence separately. In the second step, an optimal consensus secondary structure is extracted from these helices for every possible pair of RNA sequences. In the third and last step, the different secondary structures that were predicted in a pairwise fashion for each individual RNA sequence are combined into one secondary structure using graph theoretical techniques. This is the final RNA structure reported by CARNAC for that RNA sequence. In the most general case, the algorithms underlying CARNAC would require <italic>O</italic>(<italic>L</italic><sup>6</sup>) time and <italic>O</italic>(<italic>L</italic><sup>4</sup>) memory to analyze input sequences of length <italic>L</italic> [<xref ref-type="bibr" rid="pcbi-0030149-b045">45</xref>]. These requirements can be reduced by a number of computational tricks. For the data investigated by Perriquet et al. [<xref ref-type="bibr" rid="pcbi-0030149-b045">45</xref>], the empirically observed requirements were approximately <italic>O</italic>(<italic>L</italic><sup>2</sup>) time and memory.</p></sec><sec id="s3b"><title>Dataset</title><p>We compiled a large and diverse dataset from previously published data [<xref ref-type="bibr" rid="pcbi-0030149-b078">78</xref>–<xref ref-type="bibr" rid="pcbi-0030149-b080">80</xref>] to thoroughly investigate SimulFold's ability to correctly predict RNA structures. Our dataset consists of 16 sets of evolutionarily related sequences that cover a wide range of average pairwise sequence identities (pids) and sequence lengths. Half of the sets contain a pseudoknotted reference structure; the other half contain a reference structure without pseudoknots. The number of sequences in each set ranges from five to 15 sequences. We automatically generated Clustal-W alignments for all 16 sets to serve as input alignment for those programs that take a fixed input alignment. The resulting alignments are 74–1,601 nucleotides long, and their average pid ranges from 40% to 91%. <xref ref-type="table" rid="pcbi-0030149-t001">Table 1</xref> summarizes the main characteristics of each set (see the columns “Structure” and “Alignment” and the caption of the table).</p><table-wrap content-type="2col" id="pcbi-0030149-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030149.t001</object-id><label>Table 1</label><caption><p>Performance of CARNAC, Hxmatch, RNAalifold, Pfold, and SimulFold for Predicting RNA Structures</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030149.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="left" charoff="0" char=""/><col id="tb1col3" align="left" charoff="0" char=""/><col id="tb1col4" align="left" charoff="0" char=""/><col id="tb1col5" align="char" charoff="0" char="."/><col id="tb1col6" align="char" charoff="0" char="."/><col id="tb1col7" align="char" charoff="0" char="."/><col id="tb1col8" align="char" charoff="0" char="."/><col id="tb1col9" align="char" charoff="0" char="."/><col id="tb1col10" align="char" charoff="0" char="."/></colgroup><thead><tr><td align="left" rowspan="2"><hr/>Sequence Set</td><td rowspan="2"><hr/>Structure</td><td rowspan="2"><hr/>Alignment</td><td rowspan="2"><hr/>Performance Measure</td><td colspan="6"><hr/>Program</td></tr><tr><td><hr/>CARNAC</td><td><hr/>Hxmatch</td><td><hr/>RNAalifold</td><td><hr/>Pfold</td><td><hr/>SimulFold</td><td><hr/>SimulFold PT</td></tr></thead><tbody><tr><td><bold>U5 (low)</bold></td><td><bold>30 bp, no pk</bold></td><td><bold>60&percnt;, 123, 5</bold></td><td>TP</td><td>19</td><td>8</td><td>18</td><td>10</td><td>25</td><td>&mdash;</td></tr><tr><td>FP</td><td>1</td><td>16</td><td>7</td><td>5</td><td>1</td><td>&mdash;</td></tr><tr><td>FN</td><td>11</td><td>7</td><td>8</td><td>11</td><td>5</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.68</td><td>0.23</td><td>0.55</td><td>0.44</td><td><bold>0.84</bold></td><td>&mdash;</td></tr><tr><td><bold>U5 (high)</bold></td><td><bold>30 bp, no pk</bold></td><td><bold>88&percnt;, 116, 5</bold></td><td>TP</td><td>0</td><td>28</td><td>30</td><td>30</td><td>29</td><td>&mdash;</td></tr><tr><td>FP</td><td>0</td><td>2</td><td>3</td><td>0</td><td>0</td><td>&mdash;</td></tr><tr><td>FN</td><td>30</td><td>0</td><td>0</td><td>0</td><td>1</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.00</td><td>0.95</td><td>0.93</td><td><bold>1.00</bold></td><td>0.97</td><td>&mdash;</td></tr><tr><td><bold>Group II intron (low)</bold></td><td><bold>19 bp, no pk</bold></td><td><bold>73&percnt;, 144, 5</bold></td><td>TP</td><td>0</td><td>8</td><td>8</td><td>8</td><td>12</td><td>&mdash;</td></tr><tr><td>FP</td><td>0</td><td>27</td><td>28</td><td>8</td><td>0</td><td>&mdash;</td></tr><tr><td>FN</td><td>19</td><td>2</td><td>1</td><td>5</td><td>7</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.00</td><td>0.31</td><td>0.34</td><td>0.49</td><td><bold>0.77</bold></td><td>&mdash;</td></tr><tr><td><bold>Group II intron (high)</bold></td><td><bold>18 bp, no pk</bold></td><td><bold>75&percnt;, 80, 5</bold></td><td>TP</td><td>11</td><td>11</td><td>12</td><td>13</td><td>19</td><td>&mdash;</td></tr><tr><td>FP</td><td>7</td><td>13</td><td>12</td><td>10</td><td>1</td><td>&mdash;</td></tr><tr><td>FN</td><td>6</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.42</td><td>0.55</td><td>0.58</td><td>0.64</td><td><bold>0.96</bold></td><td>&mdash;</td></tr><tr><td><bold>tRNA (low)</bold></td><td><bold>20 bp, no pk</bold></td><td><bold>40&percnt;, 89, 5</bold></td><td>TP</td><td>9</td><td>0</td><td>11</td><td>8</td><td>18</td><td>&mdash;</td></tr><tr><td>FP</td><td>0</td><td>15</td><td>4</td><td>4</td><td>3</td><td>&mdash;</td></tr><tr><td>FN</td><td>11</td><td>3</td><td>4</td><td>6</td><td>2</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.61</td><td>&minus;0.11</td><td>0.66</td><td>0.53</td><td><bold>0.82</bold></td><td>&mdash;</td></tr><tr><td><bold>tRNA (high)</bold></td><td><bold>21 bp, no pk</bold></td><td><bold>75&percnt;, 74, 5</bold></td><td>TP</td><td>12</td><td>21</td><td>21</td><td>21</td><td>20</td><td>&mdash;</td></tr><tr><td>FP</td><td>3</td><td>2</td><td>0</td><td>0</td><td>1</td><td>&mdash;</td></tr><tr><td>FN</td><td>8</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.53</td><td>0.92</td><td><bold>1.00</bold></td><td><bold>1.00</bold></td><td>0.96</td><td>&mdash;</td></tr><tr><td><bold>rRNA (low)</bold></td><td><bold>32 bp, no pk</bold></td><td><bold>49&percnt;, 124, 5</bold></td><td>TP</td><td>13</td><td>9</td><td>9</td><td>9</td><td>22</td><td>&mdash;</td></tr><tr><td>FP</td><td>1</td><td>4</td><td>6</td><td>3</td><td>1</td><td>&mdash;</td></tr><tr><td>FN</td><td>19</td><td>20</td><td>18</td><td>21</td><td>11</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.50</td><td>0.31</td><td>0.27</td><td>0.33</td><td><bold>0.71</bold></td><td>&mdash;</td></tr><tr><td><bold>rRNA (high)</bold></td><td><bold>34 bp, no pk</bold></td><td><bold>76&percnt;, 119, 5</bold></td><td>TP</td><td>12</td><td>25</td><td>27</td><td>24</td><td>23</td><td>&mdash;</td></tr><tr><td>FP</td><td>1</td><td>11</td><td>9</td><td>7</td><td>1</td><td>&mdash;</td></tr><tr><td>FN</td><td>22</td><td>5</td><td>4</td><td>8</td><td>11</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.45</td><td>0.59</td><td>0.67</td><td>0.60</td><td><bold>0.71</bold></td><td>&mdash;</td></tr><tr><td><bold>RNaseP (medium)</bold></td><td><bold>122 bp, pk</bold></td><td><bold>66&percnt;, 436, 11</bold></td><td>TP</td><td>53</td><td>9</td><td>37</td><td>58</td><td>29</td><td>&mdash;</td></tr><tr><td>FP</td><td>13</td><td>46</td><td>28</td><td>19</td><td>26</td><td>&mdash;</td></tr><tr><td>FN</td><td>60</td><td>59</td><td>54</td><td>45</td><td>55</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.42</td><td>&minus;0.11</td><td>0.24</td><td><bold>0.47</bold></td><td>0.23</td><td>&mdash;</td></tr><tr><td><bold>RNase P (high)</bold></td><td><bold>110 bp, no pk</bold></td><td><bold>81&percnt;, 385, 9</bold></td><td>TP</td><td>26</td><td>41</td><td>40</td><td>48</td><td>20</td><td>&mdash;</td></tr><tr><td>FP</td><td>8</td><td>49</td><td>57</td><td>18</td><td>84</td><td>&mdash;</td></tr><tr><td>FN</td><td>74</td><td>36</td><td>28</td><td>50</td><td>17</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.31</td><td>0.24</td><td>0.25</td><td><bold>0.42</bold></td><td>0.11</td><td>&mdash;</td></tr><tr><td><bold>SSU (medium)</bold></td><td><bold>478 bp, no pk</bold></td><td><bold>80&percnt;, 1601, 11</bold></td><td>TP</td><td>213</td><td>157</td><td>366</td><td>0</td><td>82</td><td>&mdash;</td></tr><tr><td>FP</td><td>27</td><td>131</td><td>69</td><td>0</td><td>106</td><td>&mdash;</td></tr><tr><td>FN</td><td>244</td><td>177</td><td>67</td><td>478</td><td>277</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.59</td><td>0.43</td><td><bold>0.81</bold></td><td>0</td><td>0.24</td><td>&mdash;</td></tr><tr><td><bold>SSU (high)</bold></td><td><bold>478 bp, no pk</bold></td><td><bold>91&percnt;, 1551, 11</bold></td><td>TP</td><td>173</td><td>139</td><td>274</td><td>322</td><td>50</td><td>&mdash;</td></tr><tr><td>FP</td><td>27</td><td>201</td><td>202</td><td>53</td><td>163</td><td>&mdash;</td></tr><tr><td>FN</td><td>281</td><td>122</td><td>51</td><td>111</td><td>235</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.52</td><td>0.39</td><td>0.64</td><td><bold>0.76</bold></td><td>0.11</td><td>&mdash;</td></tr><tr><td><bold>Corona</bold></td><td><bold>18 bp, pk</bold></td><td><bold>95&percnt;, 66, 9</bold></td><td>TP</td><td>SF</td><td>16</td><td>0</td><td>9</td><td>14</td><td>&mdash;</td></tr><tr><td>FP</td><td>SF</td><td>4</td><td>14</td><td>0</td><td>7</td><td>&mdash;</td></tr><tr><td>FN</td><td>SF</td><td>1</td><td>2</td><td>9</td><td>2</td><td>&mdash;</td></tr><tr><td>MCC</td><td>SF</td><td><bold>0.70</bold></td><td>&minus;0.19</td><td>0.57</td><td>0.41</td><td>&mdash;</td></tr><tr><td><bold>Entero</bold></td><td><bold>38 bp, pk</bold></td><td><bold>88&percnt;, 104, 12</bold></td><td>TP</td><td>12</td><td>25</td><td>23</td><td>19</td><td>32</td><td>&mdash;</td></tr><tr><td>FP</td><td>0</td><td>4</td><td>4</td><td>1</td><td>5</td><td>&mdash;</td></tr><tr><td>FN</td><td>26</td><td>10</td><td>9</td><td>18</td><td>2</td><td>&mdash;</td></tr><tr><td>MCC</td><td>0.35</td><td>0.47</td><td>0.55</td><td>0.44</td><td><bold>0.71</bold></td><td>&mdash;</td></tr><tr><td><bold>HDV</bold></td><td><bold>27 bp, pk</bold></td><td><bold>91&percnt;, 91, 15</bold></td><td>TP</td><td>13</td><td>11</td><td>15</td><td>15</td><td>16</td><td>23</td></tr><tr><td>FP</td><td>2</td><td>10</td><td>14</td><td>4</td><td>14</td><td>15</td></tr><tr><td>FN</td><td>13</td><td>4</td><td>3</td><td>8</td><td>1</td><td>0</td></tr><tr><td>MCC</td><td>0.47</td><td>0.45</td><td>0.37</td><td>0.54</td><td>0.50</td><td><bold>0.68</bold></td></tr><tr><td><bold>RNase P8</bold></td><td><bold>124 bp, pk</bold></td><td><bold>57&percnt;, 472, 8</bold></td><td>TP</td><td>SF</td><td>0</td><td>55</td><td>66</td><td>64</td><td>80</td></tr><tr><td>FP</td><td>SF</td><td>16</td><td>10</td><td>12</td><td>62</td><td>36</td></tr><tr><td>FN</td><td>SF</td><td>108</td><td>61</td><td>52</td><td>10</td><td>20</td></tr><tr><td>MCC</td><td>SF</td><td>&minus;0.43</td><td><bold>0.27</bold></td><td><bold>0.27</bold></td><td>0.16</td><td>0.20</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt101"><p> We analyze 16 sets of sequences whose features are described in the columns &ldquo;Structure&rdquo; and &ldquo;Alignment.&rdquo; &ldquo;Structure&rdquo; gives the number of base-pairs in the known structure and indicates whether the structure contains a pseudoknot (&ldquo;pk&rdquo;) or not (&ldquo;no pk&rdquo;). &ldquo;Alignment&rdquo; gives more information on the Clustal-W alignment: the average percent identity, the length of the alignment in nucleotides, and the number of sequences in the alignment. We measure performance in terms of the number of correctly predicted base-pairs (true positive base-pairs, or TP), the number of incorrectly predicted base-pairs (false positives, or FP), and the number of known base-pairs that have not been correctly predicted (false negatives, or FN). We also measure the structure performance in terms of the MCC (values in bold in the &ldquo;Program&rdquo; columns indicate the best MCC value for each set). Some job runs of CARNAC resulted in a segmentation fault, denoted &ldquo;SF.&rdquo; The HDV and the RNase P8 sets were analyzed twice with SimulFold: once with the default version and once using parallel tempering, denoted &ldquo;SimulFold PT.&rdquo;</p></fn></table-wrap-foot> --></table-wrap></sec><sec id="s3c"><title>Performance Evaluation</title><p><xref ref-type="table" rid="pcbi-0030149-t001">Table 1</xref> shows the performance values for the RNA structures predicted by SimulFold, RNAalifold, Hxmatch, Pfold, and CARNAC for all 16 sets. We used the Clustal-W alignments as fixed input alignments for Hxmatch and Pfold. The same alignments were also used as initial alignments for SimulFold.</p><p>To evaluate the structure prediction performance, we compared the known RNA structure of the reference organism in each set with the corresponding predicted RNA structure. We measured the quality of the structure predictions in terms of the number of correctly predicted base-pairs (true positive base-pairs, or TP, see <xref ref-type="table" rid="pcbi-0030149-t001">Table 1</xref>), the number of incorrectly predicted base-pairs (false positives, or FP), and the number of known base-pairs that have not been correctly predicted (false negatives, or FN). We also calculated Mathews's correlation coefficient (MCC) (see <xref ref-type="table" rid="pcbi-0030149-t001">Table 1</xref>), which is defined as
					<disp-formula id="pcbi-0030149-e012"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030149.e012" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mtext>MCC</mml:mtext><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>&sdot;</mml:mo><mml:mtext>TN</mml:mtext><mml:mo>&minus;</mml:mo><mml:mtext>FP</mml:mtext><mml:mo>&sdot;</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mtext>TP</mml:mtext><mml:mo>&plus;</mml:mo><mml:mtext>FP</mml:mtext><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mtext>TP</mml:mtext><mml:mo>&plus;</mml:mo><mml:mtext>FN</mml:mtext><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mtext>TN</mml:mtext><mml:mo>&plus;</mml:mo><mml:mtext>FP</mml:mtext><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mtext>TN</mml:mtext><mml:mo>&plus;</mml:mo><mml:mtext>FN</mml:mtext><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>
				</p><p>CARNAC generally shows a high specificity, i.e., a low number of incorrectly predicted base-pairs, often in combination with a low sensitivity, i.e., a low number of true positive base-pairs. This low sensitivity can even be found for sets whose average pid is fairly high, e.g., set U5 (high) with an average pid of 88%. CARNAC's performance is naturally limited by the fact that it cannot predict pseudoknotted structures.</p><p>Besides SimulFold, Hxmatch is the only other investigated program that is capable of predicting pseudoknotted secondary structures. Hxmatch has the tendency to over-predict base-pairs, as indicated by the high number of false positive base-pairs. This happens for low average pids (e.g., set tRNA [low]) and for high pids (e.g., set SSU [high]). It is interesting to note that RNAalifold often does better than Hxmatch at predicting the base-pairs of pseudoknotted reference structures, e.g., the results for RNaseP (medium), RNase P8, SSU (medium), and SSU (high). However, there are also examples, see the corona set, where the reverse holds.</p><p>Like RNAalifold and Hxmatch, Pfold is a program that takes a fixed alignment as input. Its performance tends to be low for the low average pid range, e.g., the U5 (low), tRNA (low), and rRNA (low) sets, which all have average pids below 50%. For the high pid range, its performance can be limited because of the fact that Pfold cannot model pseudoknots, e.g., in the corona, entero, and hepatitis delta virus (HDV) sets. Its performance for the RNaseP (medium) set constitutes a notable exception to this trend.</p><p>SimulFold is the only program that simultaneously co-estimates alignments, structures, and trees. It clearly outperforms all other programs in terms of overall performance for eight out of 16 sets: U5 (low), group II intron (low and high), tRNA (low), rRNA (low and high), entero, and HDV. It also shows a competitive performance for the sets U5 (high) and tRNA (high). These sets cover a wide range of average pids, from 40% to 91%. The results for the two SSU sets show that SimulFold has problems analyzing these two sets, whose reference alignments span more than 1,500 nucleotides. However, the results for the RNase P8 set show that SimulFold can successfully predict structures with high sensitivity even for comparatively long sequences (the reference alignment of the RNase P8 set has a length of 472 nucleotides). The results for the RNase P8 and the HDV sets show the benefits of parallel tempering. When investigating the predictions for the HDV set, we concluded from the loglikelihood plot (see <xref ref-type="fig" rid="pcbi-0030149-g005">Figure 5</xref>) that the MCMC chain got stuck in local minima. We therefore implemented a more sophisticated version of SimulFold that employs the MCMC technique of parallel tempering [<xref ref-type="bibr" rid="pcbi-0030149-b081">81</xref>] to address the problem. As the grey line in <xref ref-type="fig" rid="pcbi-0030149-g005">Figure 5</xref> shows, parallel tempering solves the mixing problem for the HDV set and significantly improved the sensitivity, while at the same time reducing the number of incorrectly predicted base-pairs.</p><fig id="pcbi-0030149-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030149.g005</object-id><label>Figure 5</label><caption><title>Loglikelihood as a Function of the Steps in the MCMC Chain for the HDV set with and without Parallel Tempering</title><p>With parallel tempering (grey) and without parallel tempering (black). Without parallel tempering, the MCMC chain gets stuck in local minima.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030149.g005" xlink:type="simple"/></fig></sec><sec id="s3d"><title>Potential of SimulFold as an Alignment and Phylogeny Prediction Program</title><p>Our initial motivation for devising a novel method that simultaneously co-estimates RNA structures, alignments, and evolutionary trees was to improve the prediction of RNA structures, in particular those with pseudoknots. A very interesting additional benefit of our approach is that SimulFold can also be used as an alignment and phylogeny prediction program.</p><p>We here present preliminary results for sequences from the HDV set that show SimulFold's potential as an alignment and phylogeny prediction program. By the same argument that we made above for RNA structure prediction, we should also be able to derive better alignments and trees if we co-estimate all three, interdependent quantities together rather than in isolation.</p><p>The HDV dataset contains 15 sequences of HDV ribozymes from several strains (their NCBI accession numbers are shown on the figures showing the alignments and the consensus networks). The ribozyme contains one pseudoknot and a variable helix. We calculated posterior probabilities of alignment columns from the multiple alignments that the MCMC method sampled, i.e., the probability of seeing a particular alignment column in a sampled multiple alignment.</p><p>We calculated the maximum posterior decoding (MPD) alignment using a dynamic programming procedure [<xref ref-type="bibr" rid="pcbi-0030149-b072">72</xref>]. It has been shown [<xref ref-type="bibr" rid="pcbi-0030149-b067">67</xref>] that MPD yields better estimates than maximum a posteriori alignment estimation from an MCMC sample.</p><p>The MPD alignment is shown in <xref ref-type="fig" rid="pcbi-0030149-g006">Figure 6</xref>, together with the estimated posterior probabilities for each column as well as the reference secondary structure that includes a pseudoknot. The figure clearly highlights three regions in the alignment where lower posterior probabilities are due to an ambiguity in the estimation. The first region overlaps a hairpin loop. Even though the MPD alignment contains no gaps in this region, the sequences vary a lot and there exist several plausible explanations that relate the sequences in this region in terms of evolutionary indel events. The remaining two regions overlap the two base-paired sides of a variable helix. The low posterior probabilities indicate that several plausible alignments exist for these regions. These observations are in line with our difficulty to correctly predict these parts of this helix. We conjecture that this helix may be shorter or contain bulges in some of the sequences of the HDV set.</p><fig id="pcbi-0030149-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030149.g006</object-id><label>Figure 6</label><caption><title>MPD Alignment for the HDV Dataset Consisting of 15 Sequences of HDV Ribozymes</title><p>The name of each sequence indicates the NCBI accession number of the strain. The ribozyme contains one pseudoknot and a variable helix as shown in the line above the alignment, which denotes the known reference structure in dot-bracket, or Vienna, notation. The posterior probabilities for each alignment column were derived from the multiple sequence alignments that the MCMC method sampled and are indicated at the top of the figure.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030149.g006" xlink:type="simple"/></fig><p>If we compare our MPD alignment to the alignment generated by Clustal-X [<xref ref-type="bibr" rid="pcbi-0030149-b061">61</xref>] shown in <xref ref-type="fig" rid="pcbi-0030149-g007">Figure 7</xref>, we observe two main differences. First, Clustal-X does not take secondary structure into account when predicting the alignment. This yields several nonsense base-pairs with respect to the known reference structure (highlighted in green in <xref ref-type="fig" rid="pcbi-0030149-g007">Figure 7</xref>). Second, Clustal-X does not evaluate the reliability of the different regions in the predicted alignment. We thus do not know which parts of the predicted alignment are particularly well or poorly supported by the data.</p><fig id="pcbi-0030149-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030149.g007</object-id><label>Figure 7</label><caption><title>Clustal-X Alignment for the HDV Dataset Consisting of 15 Sequences of HDV Ribozymes</title><p>Some parts of the AB037948 and L22063 sequences are misaligned (red characters), which causes nonsense base-pairs (highlighted in green) when mapping the known reference structure onto these sequences.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030149.g007" xlink:type="simple"/></fig><p>We calculated consensus networks based on the evolutionary trees sampled from the posterior distribution by the MCMC using the method of Holland and Moulton [<xref ref-type="bibr" rid="pcbi-0030149-b082">82</xref>] implemented in the SplitsTree4 program [<xref ref-type="bibr" rid="pcbi-0030149-b083">83</xref>]. We set the threshold for splits to 0.1, i.e., we retained only splits that were present in at least 10% of the sampled trees, and generated the two networks shown in <xref ref-type="fig" rid="pcbi-0030149-g008">Figure 8</xref>. The two networks have the same topology, but differ in the lengths of their edges, which represent different kinds of information. In the left network, the length of each edge is proportional to the probability of the split that is represented by the edge in the posterior distribution (the unit in the top left corner shows 1,000 occurrences in 2,000 sampled trees). In the right network, the length of each edge is equal to the average length of the edge in the sampled trees that contain that edge. There are five groups of strains: the lone strain AJ309873; a group containing U81988, M28267, X77627, and M92448; another group containing U81989, AF104263, AF104264, and X85253; and finally two relatively close groups containing AB088679, AF018077, and AF309420, and L22063, AB03748, and AJ309880. There is not enough phylogenetic signal to infer the relationship between the union of the two last groups and the other three groups. As <xref ref-type="fig" rid="pcbi-0030149-g008">Figure 8</xref> indicates, there are several plausible explanations for how strains in the first two groups could have evolved.</p><fig id="pcbi-0030149-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030149.g008</object-id><label>Figure 8</label><caption><title>Two Consensus Networks for the HDV Dataset Consisting of 15 Sequences of HDV Ribozymes</title><p>The name of each sequence indicates the NCBI accession number of the strain (see also <xref ref-type="fig" rid="pcbi-0030149-g006">Figure 6</xref>)<bold>.</bold> The edge lengths in the left network correspond to the probability of the corresponding split in the posterior distribution, whereas the edge lengths in the right network correspond to the average length of the edge in the sampled trees.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030149.g008" xlink:type="simple"/></fig><p>These preliminary results show that SimulFold not only allows us to derive consensus multiple alignments and evolutionary trees, but even enables us to highlight particularly well or poorly estimated parts of these alignments and trees.</p><p>It is easy to think of situations where one does not want to simultaneously co-estimate RNA structures, alignments, and trees, e.g., because a high-confidence RNA structure (or alignment or tree) has already been established. It is straightforward to employ SimulFold in these situations, as the program can be easily told to keep the input RNA structure or alignment or tree (or any combination thereof) fixed.</p></sec><sec id="s3e"><title>Evaluation of the MCMC's Efficiency</title><p>An MCMC can suffer from a low efficiency for three main reasons: (1) the acceptance ratio is low, (2) the Markov chain gets stuck in local optima, or (3) the computational time to perform each step is large. We introduced partial Metropolis importance sampling to quickly propose moves that replace only part of the data and to keep the rejection probability and autocorrelation low. For the HDV set, the initial loglikelihood plot shows poor mixing (see <xref ref-type="fig" rid="pcbi-0030149-g005">Figure 5</xref>). We therefore implemented the more sophisticated MCMC technique of parallel tempering in SimulFold. This option can be switched on whenever the mixing properties need to be improved. <xref ref-type="fig" rid="pcbi-0030149-g005">Figure 5</xref> shows, for the HDV set, how parallel tempering can considerably improve the mixing properties. The parallel tempering run took 1.5 d and used 50 MB of memory on an Intel Xeon dual 3 GHz machine for the HDV set, involving seven parallel chains, 10,000 steps for burn-in, and 2,000 samples, and making 100 steps between two samplings. Shorter sequences, multiple alignments with fewer sequences, and MCMC runs without parallel chains took proportionally less time. In terms of computational complexity, SimulFold takes <italic>O</italic>(<italic>N</italic> · <italic>L</italic>) time to propose a change in phylogeny for <italic>N</italic> sequences and an alignment of length <italic>L</italic>. Changing the alignment takes <italic>O</italic>(<italic>N</italic> · <italic>W</italic><sup>2</sup>) time, where <italic>W</italic> is the length of the window that is re-sampled. Changing the structure takes <italic>O</italic>(<italic>K</italic> · <italic>N</italic> · <italic>L</italic>) time, where <italic>K</italic> is the number of changed helices. In its current implementation, SimulFold uses the same number of moves to update trees, alignments, and structures. The mixing of the chain decreases with the length and number of sequences. We did not investigate this behaviour in detail, but know that for multiple sequence alignments, the mixing time is proportional to <italic>N</italic> · <italic>L</italic>.</p></sec></sec><sec id="s4"><title>Discussion</title><p>We propose here a novel theoretical framework for co-estimating an RNA structure including pseudoknots, <italic>S,</italic> a multiple-sequence alignment, <italic>A,</italic> and an evolutionary tree, <italic>T,</italic> given several evolutionarily related RNA sequences, <italic>D,</italic> as input. We also present an implementation of this framework in a new computer program, called SimulFold, and evaluate the quality of the predicted RNA structures relative to those predicted by existing programs.</p><p>Our novel theoretical framework allows us to sample (<italic>S, T, A</italic>) triples from the posterior distribution, <italic>P</italic>(<italic>S, A, T</italic>|<italic>D</italic>), in a computationally very efficient way using a Bayesian MCMC. For every RNA sequence in <italic>D,</italic> we then extract the RNA structure that is best supported by the posterior distribution using the MWM algorithm and a post-processing step implemented in an auxiliary program called bp2bistruc.</p><p>Our work is significant in a number of ways. SimulFold overcomes several limitations of existing RNA structure prediction methods, in particular the conceptual limitations of SCFG-based methods. SimulFold does not rely on a fixed input alignment or tree, it can predict pseudoknotted RNA structures, it can take any number of related RNA sequences as input, it aims to predict the evolutionarily conserved RNA structure rather than the thermodynamic or MFE structure, it explicitly models the evolutionary relationship between the RNA sequences, it is a fully probabilistic method that is capable of quantifying the reliability of its predictions, and, most important for the majority of users, it works in a computationally efficient way and can be used on any standard desktop computer. Furthermore, SimulFold derives the RNA structure that is best supported by the posterior distribution, rather than the RNA structure that maximizes the likelihood, which is what SCFG-based structure prediction methods do.</p><p>We use a number of novel theoretical and computational tricks to achieve the above. We devised a new expression for the prior <italic>P</italic>(<italic>S, A, T</italic>), in particular a function that models the contribution of trees, a function that incorporates information on structures and alignments, and a function that quantifies the contribution of gaps in the alignment. For sampling from the posterior distribution, we propose a new way of sampling trees and a fairly sophisticated new way of jointly sampling structures and alignments in a computationally very efficient way. After <italic>O</italic>(<italic>N</italic> · <italic>L</italic><sup>2</sup>) pre-processing time, we do an MCMC step modifying the base-pairs that requires <italic>O</italic>(<italic>N</italic> · <italic>L</italic>) time, where <italic>N</italic> is the number of sequences and <italic>L</italic> is the average length of the sequences. We also introduce a new type of MCMC sampler that we call a partial Metropolis importance sampler. We implemented the sophisticated MCMC technique of parallel tempering into SimulFold, which can be switched on whenever the loglikelihood plot indicates poor mixing properties. Finally, we introduce a new program, bp2bistruc, that derives an RNA structure that may include pseudoknots (a bi-secondary structure, to be precise) from an input table of base-pairing probabilities.</p><p>The performance of SimulFold in predicting RNA secondary structures with and without pseudoknots compares very well to the performance of RNAalifold, Hxmatch, Pfold, and CARNAC across a wide range of average pids and sequence lengths. We also present encouraging preliminary results that show SimulFold's potential as an alignment and phylogeny prediction program. It is not only possible to derive a consensus alignment and tree, but also to highlight those parts of the alignment and tree that can be particularly well or poorly estimated. This information is very valuable for interpreting the results in great detail.</p><p>It is easy to think of situations where one does not want to simultaneously co-estimate RNA structures, alignments, and trees, e.g., because a high-confidence RNA structure (or alignment or tree) has already been established. We therefore implemented special flags in SimulFold that allow the user to keep the input RNA structure or alignment or tree (or any combination thereof) fixed. We hope that this feature will make SimulFold a useful program for a wide range of interesting tasks and data analyses.</p><p>In the future, we intend to investigate different models and priors for use in SimulFold, e.g., a co-transcriptional folding prior. We also hope to further improve the properties of the sampling, e.g., partial importance sampling of tree or an even better structure sampler, to improve the performance for very long sequences.</p><p>SimulFold opens up a large number of possibilities for exciting data analysis. Most importantly, we can now start analyzing data whose low primary sequence conservation has so far prevented their analysis with methods that require a high-quality input alignment. We hope that our work inspires other researchers to also develop methods that predict or investigate the functional structure of RNA sequences so that we learn more about how RNA sequences play their diverse functional roles in the cell.</p><p>SimulFold as well as information on the input and output files of this analysis can be found at <ext-link ext-link-type="uri" xlink:href="http://www.cs.ubc.ca/~irmtraud/simulfold/" xlink:type="simple">http://www.cs.ubc.ca/∼irmtraud/simulfold/</ext-link>.</p></sec></body><back><ack><p>IMM would like to thank Elena Rivas, Eric Westhof, and the participants of the computational RNA workshop in Benasque, Spain, for many inspiring discussions. IM would like to thank Péter Ittzés for discussing consensus networks. We would both like to thank Bjarne Knudsen for providing us with the diagonalized rate matrices of Pfold and Paul Gardner for help with the dataset. Last, but not least, we would like to thank the three anonymous referees for their constructive comments.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>CM</term><def><p>covariance model</p></def></def-item><def-item><term>FN</term><def><p>false negative</p></def></def-item><def-item><term>FP</term><def><p>false positive</p></def></def-item><def-item><term>HDV</term><def><p>hepatitis delta virus</p></def></def-item><def-item><term>indel;</term><def><p>insertion and deletion</p></def></def-item><def-item><term>MCC</term><def><p>Mathews's correlation coefficient</p></def></def-item><def-item><term>MCMC</term><def><p>Markov chain Monte Carlo</p></def></def-item><def-item><term>MFE</term><def><p>minimum free energy</p></def></def-item><def-item><term>MPD</term><def><p>maximum posterior decoding</p></def></def-item><def-item><term>MWM algorithm</term><def><p>maximum weighted matching algorithm</p></def></def-item><def-item><term>pid</term><def><p>pairwise sequence identity</p></def></def-item><def-item><term>SCFG</term><def><p>stochastic context-free grammar</p></def></def-item><def-item><term>TP</term><def><p>true positive</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0030149-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tinoco</surname><given-names>I</given-names><suffix>Jr</suffix></name><name name-style="western"><surname>Uhlenbeck</surname><given-names>OC</given-names></name><name name-style="western"><surname>Levine</surname><given-names>MD</given-names></name></person-group>
					<year>1971</year>
					<article-title>Estimation of secondary structure in ribonucleic acids.</article-title>
					<source>Nature</source>
					<volume>230</volume>
					<fpage>362</fpage>
					<lpage>367</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tinoco</surname><given-names>I</given-names><suffix>Jr</suffix></name><name name-style="western"><surname>Borer</surname><given-names>PN</given-names></name><name name-style="western"><surname>Dengler</surname><given-names>B</given-names></name><name name-style="western"><surname>Levine</surname><given-names>MD</given-names></name><name name-style="western"><surname>Uhlenbeck</surname><given-names>OC</given-names></name><etal/></person-group>
					<year>1973</year>
					<article-title>Improved estimation of secondary structure in ribonucleic acids.</article-title>
					<source>Nature New Biol</source>
					<volume>246</volume>
					<fpage>40</fpage>
					<lpage>41</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Nussinov</surname><given-names>R</given-names></name><name name-style="western"><surname>Jacobson</surname><given-names>A</given-names></name></person-group>
					<year>1980</year>
					<article-title>Fast algorithm for predicting the secondary structure of single-stranded RNA.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>77</volume>
					<fpage>6309</fpage>
					<lpage>6313</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zuker</surname><given-names>M</given-names></name><name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name></person-group>
					<year>1984</year>
					<article-title>RNA secondary structures and their prediction.</article-title>
					<source>Bull Math Biol</source>
					<volume>46</volume>
					<fpage>591</fpage>
					<lpage>621</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mathews</surname><given-names>D</given-names></name><name name-style="western"><surname>Sabina</surname><given-names>J</given-names></name><name name-style="western"><surname>Zuker</surname><given-names>M</given-names></name><name name-style="western"><surname>Turner</surname><given-names>D</given-names></name></person-group>
					<year>1999</year>
					<article-title>Expanded sequence dependence of thermodynamic parameters improves prediction of RNA secondary structure.</article-title>
					<source>J Mol Biol</source>
					<volume>288</volume>
					<fpage>911</fpage>
					<lpage>940</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zuker</surname><given-names>M</given-names></name></person-group>
					<year>2003</year>
					<article-title>Mfold web server for nucleic acid folding and hybridization prediction.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3406</fpage>
					<lpage>3415</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hofacker</surname><given-names>IL</given-names></name><name name-style="western"><surname>Fontana</surname><given-names>W</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name><name name-style="western"><surname>Bonhoeffer</surname><given-names>S</given-names></name><name name-style="western"><surname>Tacker</surname><given-names>M</given-names></name><etal/></person-group>
					<year>1994</year>
					<article-title>Fast folding and comparison of RNA secondary structures.</article-title>
					<source>Monatsh Chem</source>
					<volume>125</volume>
					<fpage>167</fpage>
					<lpage>188</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zuker</surname><given-names>M</given-names></name><name name-style="western"><surname>Stiegler</surname><given-names>P</given-names></name></person-group>
					<year>1981</year>
					<article-title>Optimal computer folding of large RNA sequences using thermodynamic and auxiliary information.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>9</volume>
					<fpage>133</fpage>
					<lpage>148</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wuchty</surname><given-names>S</given-names></name><name name-style="western"><surname>Fontana</surname><given-names>W</given-names></name><name name-style="western"><surname>Hofacker</surname><given-names>I</given-names></name><name name-style="western"><surname>Schuster</surname><given-names>P</given-names></name></person-group>
					<year>1999</year>
					<article-title>Complete suboptimal folding of RNA and the stability of secondary structures.</article-title>
					<source>Biopolymers</source>
					<volume>49</volume>
					<fpage>145</fpage>
					<lpage>165</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hofacker</surname><given-names>I</given-names></name><name name-style="western"><surname>Fekete</surname><given-names>M</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>P</given-names></name></person-group>
					<year>2002</year>
					<article-title>Secondary structure prediction for aligned RNA sequences.</article-title>
					<source>J Mol Biol</source>
					<volume>319</volume>
					<fpage>1059</fpage>
					<lpage>1066</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b011"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hofacker</surname><given-names>IL</given-names></name></person-group>
					<year>2003</year>
					<article-title>Vienna RNA secondary structure server.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3429</fpage>
					<lpage>3431</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Morgan</surname><given-names>SR</given-names></name><name name-style="western"><surname>Higgs</surname><given-names>PG</given-names></name></person-group>
					<year>1996</year>
					<article-title>Evidence for kinetic effects in the folding of large RNA molecules.</article-title>
					<source>J Chem Phys</source>
					<volume>105</volume>
					<fpage>7152</fpage>
					<lpage>7157</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Boyle</surname><given-names>J</given-names></name><name name-style="western"><surname>Robillard</surname><given-names>G</given-names></name><name name-style="western"><surname>Kim</surname><given-names>S</given-names></name></person-group>
					<year>1980</year>
					<article-title>Sequential folding of transfer RNA. A nuclear magnetic resonance study of successively longer tRNA fragments with a common 5′ end.</article-title>
					<source>J Mol Biol</source>
					<volume>139</volume>
					<fpage>601</fpage>
					<lpage>625</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kramer</surname><given-names>F</given-names></name><name name-style="western"><surname>Mills</surname><given-names>D</given-names></name></person-group>
					<year>1981</year>
					<article-title>Secondary structure formation during RNA-synthesis.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>9</volume>
					<fpage>5109</fpage>
					<lpage>5124</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Meyer</surname><given-names>IM</given-names></name><name name-style="western"><surname>Miklós</surname><given-names>I</given-names></name></person-group>
					<year>2004</year>
					<article-title>Co-transcriptional folding is encoded within RNA genes.</article-title>
					<source>BMC Mol Biol</source>
					<volume>5</volume>
					<fpage>10</fpage>
				</element-citation></ref><ref id="pcbi-0030149-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gultyaev</surname><given-names>A</given-names></name></person-group>
					<year>1991</year>
					<article-title>The computer-simulation of RNA folding involving pseudoknot formation.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>19</volume>
					<fpage>2489</fpage>
					<lpage>2493</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gultyaev</surname><given-names>A</given-names></name><name name-style="western"><surname>von Batenburg</surname><given-names>F</given-names></name><name name-style="western"><surname>Pleij</surname><given-names>C</given-names></name></person-group>
					<year>1995</year>
					<article-title>The computer-simulation of RNA folding pathways using a genetic algorithm.</article-title>
					<source>J Mol Biol</source>
					<volume>250</volume>
					<fpage>37</fpage>
					<lpage>51</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Isambert</surname><given-names>H</given-names></name><name name-style="western"><surname>Siggia</surname><given-names>E</given-names></name></person-group>
					<year>2000</year>
					<article-title>Modeling RNA folding paths with pseudoknots: Application to hepatitis delta virus ribozyme.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>97</volume>
					<fpage>6515</fpage>
					<lpage>6520</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Xayaphoummine</surname><given-names>A</given-names></name><name name-style="western"><surname>Bucher</surname><given-names>T</given-names></name><name name-style="western"><surname>Thalmann</surname><given-names>F</given-names></name><name name-style="western"><surname>Isambert</surname><given-names>H</given-names></name></person-group>
					<year>2003</year>
					<article-title>Prediction and statistics of pseudoknots in RNA structures using exactly clustered stochastic simulations.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>100</volume>
					<fpage>15310</fpage>
					<lpage>15315</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Staple</surname><given-names>DW</given-names></name><name name-style="western"><surname>Butcher</surname><given-names>SE</given-names></name></person-group>
					<year>2005</year>
					<article-title>Pseudoknots: RNA structures with diverse functions.</article-title>
					<source>PLoS Biology</source>
					<volume>3</volume>
					<elocation-id>e213.</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0030213" xlink:type="simple">10.1371/journal.pbio.0030213</ext-link></comment>
				</element-citation></ref><ref id="pcbi-0030149-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lyngsø</surname><given-names>R</given-names></name><name name-style="western"><surname>Pedersen</surname><given-names>C</given-names></name></person-group>
					<year>2000</year>
					<article-title>RNA pseudoknot prediction in energy based models.</article-title>
					<source>J Comp Biol</source>
					<volume>7</volume>
					<fpage>409</fpage>
					<lpage>428</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b022"><label>22</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lyngsø</surname><given-names>R</given-names></name></person-group>
					<year>2004</year>
					<article-title>Complexity of pseudoknot prediction in simple models.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Diaz</surname><given-names>J</given-names></name><name name-style="western"><surname>Karhumäki</surname><given-names>J</given-names></name><name name-style="western"><surname>Lepistö</surname><given-names>A</given-names></name><name name-style="western"><surname>Sannella</surname><given-names>D</given-names></name></person-group>
					<source>Proceedings of the 31st International Colloquium on Automata, Languages, and Programming (ICALP)</source>
					<conf-date>12–16 July 2004;</conf-date>
					<conf-loc>Turku, Finland.</conf-loc>
					<fpage>919</fpage>
					<lpage>931</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rivas</surname><given-names>E</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>1999</year>
					<article-title>A dynamic programming algorithm for RNA structure prediction including pseudoknots.</article-title>
					<source>J Mol Biol</source>
					<volume>285</volume>
					<fpage>2053</fpage>
					<lpage>2068</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rivas</surname><given-names>E</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>2000</year>
					<article-title>The language of RNA: A formal grammar that includes pseudoknots.</article-title>
					<source>Bioinformatics</source>
					<volume>16</volume>
					<fpage>334</fpage>
					<lpage>340</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b025"><label>25</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lyngso</surname><given-names>R</given-names></name><name name-style="western"><surname>Pedersen</surname><given-names>C</given-names></name></person-group>
					<year>2000</year>
					<article-title>Pseudoknots in RNA secondary structures.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Shamir</surname><given-names>R</given-names></name><name name-style="western"><surname>Miyano</surname><given-names>S</given-names></name><name name-style="western"><surname>Istrail</surname><given-names>S</given-names></name><name name-style="western"><surname>Pevzner</surname><given-names>P</given-names></name><name name-style="western"><surname>Waterman</surname><given-names>M</given-names></name></person-group>
					<source>Proceedings of the Fourth Annual International Conference on Computational Molecular Viology</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>ACM Press</publisher-name>
					<fpage>201</fpage>
					<lpage>209</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b026"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Akutsu</surname><given-names>T</given-names></name></person-group>
					<year>2000</year>
					<article-title>Dynamic programming algorithms for RNA secondary prediction with pseudoknots.</article-title>
					<source>Discrete Appl Math</source>
					<volume>104</volume>
					<fpage>45</fpage>
					<lpage>62</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Dirks</surname><given-names>RM</given-names></name><name name-style="western"><surname>Pierce</surname><given-names>NA</given-names></name></person-group>
					<year>2003</year>
					<article-title>A partition function algorithm for nucleic acid secondary structure including pseudoknots.</article-title>
					<source>J Comput Chem</source>
					<volume>24</volume>
					<fpage>1664</fpage>
					<lpage>1677</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b028"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cai</surname><given-names>L</given-names></name><name name-style="western"><surname>Malmberg</surname><given-names>R</given-names></name><name name-style="western"><surname>Wu</surname><given-names>Y</given-names></name></person-group>
					<year>2003</year>
					<article-title>Stochastic modeling of RNA pseudoknotted structures: A grammatical approach.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<fpage>66</fpage>
					<lpage>73</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b029"><label>29</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Deogun</surname><given-names>J</given-names></name><name name-style="western"><surname>Donis</surname><given-names>E</given-names></name><name name-style="western"><surname>Komina</surname><given-names>O</given-names></name><name name-style="western"><surname>Ma</surname><given-names>F</given-names></name></person-group>
					<year>2004</year>
					<article-title>RNA secondary structure prediction with simple pseudoknots.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Chen</surname><given-names>YP</given-names></name></person-group>
					<source>Proceedings of the Second Asia Pacific Bioinformatics Conference</source>
					<conf-date>18–22 January 2004;</conf-date>
					<conf-loc>Dunedin, New Zealand.</conf-loc>
					<fpage>239</fpage>
					<lpage>246</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b030"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Reeder</surname><given-names>J</given-names></name><name name-style="western"><surname>Giegerich</surname><given-names>R</given-names></name></person-group>
					<year>2004</year>
					<article-title>Design, implementation and evaluation of a practical pseudoknot folding algorithm based on thermodynamics.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>5</volume>
					<fpage>104</fpage>
				</element-citation></ref><ref id="pcbi-0030149-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Knudsen</surname><given-names>B</given-names></name><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>
					<year>1999</year>
					<article-title>RNA secondary structure prediction using stochastic context-free grammars and evolutionary history.</article-title>
					<source>Bioinformatics</source>
					<volume>15</volume>
					<fpage>446</fpage>
					<lpage>454</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b032"><label>32</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Knudsen</surname><given-names>B</given-names></name><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>
					<year>2003</year>
					<article-title>Pfold: RNA secondary structure prediction using stochastic context-free grammars.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3423</fpage>
					<lpage>3428</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b033"><label>33</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pedersen</surname><given-names>JS</given-names></name><name name-style="western"><surname>Forsberg</surname><given-names>R</given-names></name><name name-style="western"><surname>Meyer</surname><given-names>IM</given-names></name><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>
					<year>2004</year>
					<article-title>An evolutionary model for protein-coding regions with conserved RNA structure.</article-title>
					<source>Mol Biol Evol</source>
					<volume>21</volume>
					<fpage>1913</fpage>
					<lpage>1922</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pedersen</surname><given-names>JS</given-names></name><name name-style="western"><surname>Meyer</surname><given-names>IM</given-names></name><name name-style="western"><surname>Forsberg</surname><given-names>R</given-names></name><name name-style="western"><surname>Simmonds</surname><given-names>P</given-names></name><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>
					<year>2004</year>
					<article-title>A comparative method for finding and folding RNA secondary structures within protein-coding regions.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>4925</fpage>
					<lpage>4936</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b035"><label>35</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gabow</surname><given-names>HN</given-names></name></person-group>
					<year>1973</year>
					<source>Implementation of algorithms for maximum matching on nonbipartite graphs</source>
					<comment>[dissertation].</comment>
					<publisher-loc>Stanford (California)</publisher-loc>
					<publisher-name>Stanford University</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">248</size>
				</element-citation></ref><ref id="pcbi-0030149-b036"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gabow</surname><given-names>HN</given-names></name></person-group>
					<year>1976</year>
					<article-title>An efficient implementation of Edmonds' algorithm for maximum matching on graphs.</article-title>
					<source>J ACM</source>
					<volume>23</volume>
					<fpage>221</fpage>
					<lpage>234</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b037"><label>37</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tabaska</surname><given-names>J</given-names></name><name name-style="western"><surname>Cary</surname><given-names>R</given-names></name><name name-style="western"><surname>Gabow</surname><given-names>H</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name></person-group>
					<year>1998</year>
					<article-title>An RNA folding method capable of identifying pseudoknots and base triples.</article-title>
					<source>Bioinformatics</source>
					<volume>14</volume>
					<fpage>691</fpage>
					<lpage>699</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b038"><label>38</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Witwer</surname><given-names>C</given-names></name></person-group>
					<year>2003</year>
					<source>Prediction of conserved and consensus RNA structures</source>
					<comment>[dissertation].</comment>
					<publisher-loc>Vienna</publisher-loc>
					<publisher-name>Universität Wien</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">187</size>
				</element-citation></ref><ref id="pcbi-0030149-b039"><label>39</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Haslinger</surname><given-names>C</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name></person-group>
					<year>1999</year>
					<article-title>RNA structures with pseudo-knots: Graph-theoretical, combinatorical, and statistical properties.</article-title>
					<source>Bull Math Biol</source>
					<volume>61</volume>
					<fpage>437</fpage>
					<lpage>467</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b040"><label>40</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ruan</surname><given-names>J</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>W</given-names></name></person-group>
					<year>2004</year>
					<article-title>An iterated loop matching approach to the prediction of RNA secondary structures with pseudoknots.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>58</fpage>
					<lpage>66</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b041"><label>41</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mathews</surname><given-names>DH</given-names></name><name name-style="western"><surname>Turner</surname><given-names>DH</given-names></name></person-group>
					<year>2002</year>
					<article-title>Dynalign: An algorithm for finding the secondary structure common to two RNA sequences.</article-title>
					<source>J Mol Biol</source>
					<volume>317</volume>
					<fpage>191</fpage>
					<lpage>203</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b042"><label>42</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mathews</surname><given-names>DH</given-names></name></person-group>
					<year>2005</year>
					<article-title>Predicting a set of minimal free energy RNA secondary structures common to two sequences.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>2246</fpage>
					<lpage>2253</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b043"><label>43</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Havgaard</surname><given-names>JH</given-names></name><name name-style="western"><surname>Lyngsø</surname><given-names>RB</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name></person-group>
					<year>2005</year>
					<article-title>Pairwise local structural alignment of RNA sequences with sequence similarity less than 40%.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>1815</fpage>
					<lpage>1824</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b044"><label>44</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Havgaard</surname><given-names>JH</given-names></name><name name-style="western"><surname>Lyngsø</surname><given-names>RB</given-names></name><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name></person-group>
					<year>2005</year>
					<article-title>The FOLDALIGN web server for pairwise structural RNA alignment and mutual motif search.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>W650</fpage>
					<lpage>W653</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b045"><label>45</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Perriquet</surname><given-names>O</given-names></name><name name-style="western"><surname>Touzet</surname><given-names>H</given-names></name><name name-style="western"><surname>Dauchet</surname><given-names>M</given-names></name></person-group>
					<year>2003</year>
					<article-title>Finding the common structure shared by two homologous RNAs.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<fpage>108</fpage>
					<lpage>116</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b046"><label>46</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Touzet</surname><given-names>H</given-names></name><name name-style="western"><surname>Perriquet</surname><given-names>O</given-names></name></person-group>
					<year>2004</year>
					<article-title>CARNAC: Folding families of related RNAs.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>W142</fpage>
					<lpage>W145</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b047"><label>47</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ji</surname><given-names>Y</given-names></name><name name-style="western"><surname>Xu</surname><given-names>X</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name></person-group>
					<year>2004</year>
					<article-title>A graph theoretical approach for predicting common RNA secondary structure motifs including pseudoknots in unaligned sequences.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>1591</fpage>
					<lpage>1602</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b048"><label>48</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name></person-group>
					<year>2005</year>
					<article-title>Accelerated probabilistic inference of RNA structure evolution.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>6</volume>
					<fpage>73</fpage>
				</element-citation></ref><ref id="pcbi-0030149-b049"><label>49</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Dowell</surname><given-names>RD</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>2006</year>
					<article-title>Efficient pairwise RNA structure prediction and alignment using sequence alignment constraints.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>7</volume>
					<fpage>400</fpage>
				</element-citation></ref><ref id="pcbi-0030149-b050"><label>50</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name></person-group>
					<year>1985</year>
					<article-title>Simultaneous solution of the RNA folding, alignment and protosequence problems.</article-title>
					<source>SIAM J Appl Math</source>
					<volume>45</volume>
					<fpage>810</fpage>
					<lpage>825</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b051"><label>51</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name></person-group>
					<year>1994</year>
					<article-title>RNA sequence analysis using covariance models.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>22</volume>
					<fpage>2079</fpage>
					<lpage>2088</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b052"><label>52</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sakakibara</surname><given-names>Y</given-names></name><name name-style="western"><surname>Brown</surname><given-names>M</given-names></name><name name-style="western"><surname>Underwood</surname><given-names>R</given-names></name><name name-style="western"><surname>Mian</surname><given-names>IS</given-names></name><name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name></person-group>
					<year>1994</year>
					<article-title>Stochastic context-free grammars for modeling RNA.</article-title>
					<comment>In:</comment>
					<source>Proceedings of the 27th Hawaii International Conference on System Sciences</source>
					<publisher-loc>Honolulu</publisher-loc>
					<publisher-name>IEEE Computer Society Press</publisher-name>
					<fpage>284</fpage>
					<lpage>283</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b053"><label>53</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name><name name-style="western"><surname>Rubin</surname><given-names>G</given-names></name></person-group>
					<year>2002</year>
					<article-title>Pairwise RNA structure comparison with stochastic context-free grammars.</article-title>
					<source>Pac Symp Biocomput</source>
					<volume>2002</volume>
					<fpage>163</fpage>
					<lpage>174</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b054"><label>54</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name></person-group>
					<year>2004</year>
					<article-title>A probabilistic model for the evolution of RNA structure.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>5</volume>
					<fpage>166</fpage>
				</element-citation></ref><ref id="pcbi-0030149-b055"><label>55</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Corpet</surname><given-names>F</given-names></name><name name-style="western"><surname>Michot</surname><given-names>B</given-names></name></person-group>
					<year>1994</year>
					<article-title>RNAlign program: Alignment of RNA sequences using both primary and secondary structures.</article-title>
					<source>Comput Appl Biosci</source>
					<volume>10</volume>
					<fpage>389</fpage>
					<lpage>399</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b056"><label>56</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lanhof</surname><given-names>H</given-names></name><name name-style="western"><surname>Reinert</surname><given-names>K</given-names></name><name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name></person-group>
					<year>1998</year>
					<article-title>A polyhedral approach to RNA sequence structural alignment.</article-title>
					<source>J Comp Biol</source>
					<volume>5</volume>
					<fpage>517</fpage>
					<lpage>530</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b057"><label>57</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name></person-group>
					<year>1981</year>
					<article-title>Evolutionary trees from DNA sequences: A maximum likelihood approach.</article-title>
					<source>J Mol Evol</source>
					<volume>17</volume>
					<fpage>368</fpage>
					<lpage>376</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b058"><label>58</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Löytynoja</surname><given-names>A</given-names></name><name name-style="western"><surname>Goldman</surname><given-names>N</given-names></name></person-group>
					<year>2005</year>
					<article-title>An algorithm for progressive multiple alignment of sequences with insertions.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>102</volume>
					<fpage>10557</fpage>
					<lpage>10562</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b059"><label>59</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kingman</surname><given-names>JFC</given-names></name></person-group>
					<year>1982</year>
					<article-title>The coalescent.</article-title>
					<source>Stoch Process Appl</source>
					<volume>13</volume>
					<fpage>235</fpage>
					<lpage>248</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b060"><label>60</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zuker</surname><given-names>M</given-names></name><name name-style="western"><surname>Mathews</surname><given-names>DH</given-names></name><name name-style="western"><surname>Turner</surname><given-names>DH</given-names></name></person-group>
					<year>1999</year>
					<article-title>Algorithms and thermodynamics for RNA secondary structure prediction: A practical guide.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Barciszewski</surname><given-names>J</given-names></name><name name-style="western"><surname>Clark</surname><given-names>BFC</given-names></name></person-group>
					<source>RNA biochemistry and biotechnology</source>
					<publisher-loc>Dordrecht (The Netherlands)</publisher-loc>
					<publisher-name>Kluwer</publisher-name>
					<fpage>11</fpage>
					<lpage>43</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b061"><label>61</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Chenna</surname><given-names>R</given-names></name><name name-style="western"><surname>Sugawara</surname><given-names>H</given-names></name><name name-style="western"><surname>Koike</surname><given-names>T</given-names></name><name name-style="western"><surname>Lopez</surname><given-names>R</given-names></name><name name-style="western"><surname>Gibson</surname><given-names>T</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Multiple sequence alignment with the Clustal series of programs.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3497</fpage>
					<lpage>3500</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b062"><label>62</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Metropolis</surname><given-names>N</given-names></name><name name-style="western"><surname>Rosenbluth</surname><given-names>AN</given-names></name><name name-style="western"><surname>Rosenbluth</surname><given-names>MN</given-names></name><name name-style="western"><surname>Teller</surname><given-names>AH</given-names></name><name name-style="western"><surname>Teller</surname><given-names>E</given-names></name></person-group>
					<year>1953</year>
					<article-title>Equation of state calculation by fast computing machines.</article-title>
					<source>J Chem Phys</source>
					<volume>21</volume>
					<fpage>1087</fpage>
					<lpage>1092</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b063"><label>63</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name></person-group>
					<year>2001</year>
					<source>Monte Carlo strategies in scientific computing</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Springer</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">343</size>
				</element-citation></ref><ref id="pcbi-0030149-b064"><label>64</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hastings</surname><given-names>WK</given-names></name></person-group>
					<year>1970</year>
					<article-title>Monte Carlo sampling methods using Markov chains and their applications.</article-title>
					<source>Biometrika</source>
					<volume>57</volume>
					<fpage>97</fpage>
					<lpage>109</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b065"><label>65</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>MacKay</surname><given-names>D</given-names></name></person-group>
					<year>2003</year>
					<source>Information theory, inference, and learning algorithms</source>
					<publisher-loc>Cambridge</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">628</size>
				</element-citation></ref><ref id="pcbi-0030149-b066"><label>66</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Miklos</surname><given-names>I</given-names></name><name name-style="western"><surname>Ittzes</surname><given-names>P</given-names></name><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>
					<year>2005</year>
					<article-title>ParIS Genome Rearrangement server.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>817</fpage>
					<lpage>820</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b067"><label>67</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lunter</surname><given-names>G</given-names></name><name name-style="western"><surname>Miklós</surname><given-names>I</given-names></name><name name-style="western"><surname>Drummond</surname><given-names>A</given-names></name><name name-style="western"><surname>Jensen</surname><given-names>J</given-names></name><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>
					<year>2005</year>
					<article-title>Bayesian coestimation of phylogeny and sequence alignment.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>6</volume>
					<fpage>83</fpage>
				</element-citation></ref><ref id="pcbi-0030149-b068"><label>68</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name><name name-style="western"><surname>Nicholls</surname><given-names>GK</given-names></name><name name-style="western"><surname>Rodrigo</surname><given-names>AG</given-names></name><name name-style="western"><surname>Solomon</surname><given-names>W</given-names></name></person-group>
					<year>2002</year>
					<article-title>Estimating mutation parameters, population history and genealogy simultaneously from temporally spaced sequence data.</article-title>
					<source>Genetics</source>
					<volume>161</volume>
					<fpage>1307</fpage>
					<lpage>1320</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b069"><label>69</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Day</surname><given-names>W</given-names></name></person-group>
					<year>1983</year>
					<article-title>Properties of the nearest neighbor interchange metric for trees of small size.</article-title>
					<source>J Theor Biol</source>
					<volume>101</volume>
					<fpage>275</fpage>
					<lpage>288</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b070"><label>70</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Vinh</surname><given-names>L</given-names></name><name name-style="western"><surname>von Haeseler</surname><given-names>A</given-names></name></person-group>
					<year>2004</year>
					<article-title>Shortest triplet clustering: Reconstructing large phylogenies using representative sets.</article-title>
					<source>Mol Biol Evol</source>
					<volume>21</volume>
					<fpage>1565</fpage>
					<lpage>1571</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b071"><label>71</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ronquist</surname><given-names>F</given-names></name><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name></person-group>
					<year>2003</year>
					<article-title>MrBayes 3: Bayesian phylogenetic inference under mixed models.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<fpage>1572</fpage>
					<lpage>1574</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b072"><label>72</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><name name-style="western"><surname>Mitchison</surname><given-names>G</given-names></name></person-group>
					<year>1998</year>
					<source>Biological sequence analysis: Probabilistic models of proteins and nucleic acids</source>
					<publisher-loc>Cambridge</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">356</size>
				</element-citation></ref><ref id="pcbi-0030149-b073"><label>73</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fontana</surname><given-names>W</given-names></name><name name-style="western"><surname>Konings</surname><given-names>DAM</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name><name name-style="western"><surname>Schuster</surname><given-names>P</given-names></name></person-group>
					<year>1993</year>
					<article-title>Statistics of RNA secondary structures.</article-title>
					<source>Biopolymers</source>
					<volume>33</volume>
					<fpage>1389</fpage>
					<lpage>1404</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b074"><label>74</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Höchsmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Töller</surname><given-names>T</given-names></name><name name-style="western"><surname>Giegerich</surname><given-names>R</given-names></name><name name-style="western"><surname>Kurtz</surname><given-names>S</given-names></name></person-group>
					<year>2003</year>
					<article-title>Local similarity in RNA secondary structures.</article-title>
					<source>Proc IEEE Comput Soc Bioinform Conf</source>
					<volume>2003</volume>
					<fpage>159</fpage>
					<lpage>168</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b075"><label>75</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Höchsmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Voss</surname><given-names>B</given-names></name><name name-style="western"><surname>Giegerich</surname><given-names>R</given-names></name></person-group>
					<year>2004</year>
					<article-title>Pure multiple RNA secondary structure alignments: A progressive profile approach.</article-title>
					<source>IEEE/ACM Trans Comput Biol Bioinform</source>
					<volume>1</volume>
					<fpage>53</fpage>
					<lpage>62</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b076"><label>76</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rothberg</surname><given-names>E</given-names></name></person-group>
					<year>1985</year>
					<source>Solver-1 [computer program]</source>
					<comment>Available: <ext-link ext-link-type="ftp" xlink:href="ftp://dimacs.rutgers.edu/pub/netflow/matching/weighted/." xlink:type="simple">ftp://dimacs.rutgers.edu/pub/netflow/matching/weighted/</ext-link>. Accessed 9 July 2007.</comment>
				</element-citation></ref><ref id="pcbi-0030149-b077"><label>77</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Condon</surname><given-names>A</given-names></name><name name-style="western"><surname>Davy</surname><given-names>B</given-names></name><name name-style="western"><surname>Rastegari</surname><given-names>B</given-names></name><name name-style="western"><surname>Tarrant</surname><given-names>F</given-names></name><name name-style="western"><surname>Zhao</surname><given-names>S</given-names></name></person-group>
					<year>2004</year>
					<article-title>Classifying RNA pseudoknotted structures.</article-title>
					<source>Theor Comput Sci</source>
					<volume>320</volume>
					<fpage>35</fpage>
					<lpage>50</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b078"><label>78</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Witwer</surname><given-names>C</given-names></name><name name-style="western"><surname>Hofacker</surname><given-names>IL</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name></person-group>
					<year>2004</year>
					<article-title>Prediction of consensus RNA structures including pseudoknots.</article-title>
					<source>IEEE/ACM Trans Comput Biol Bioinform</source>
					<volume>1</volume>
					<fpage>66</fpage>
					<lpage>77</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b079"><label>79</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gardner</surname><given-names>PP</given-names></name><name name-style="western"><surname>Giegerich</surname><given-names>R</given-names></name></person-group>
					<year>2004</year>
					<article-title>A comprehensive comparison of comparative RNA structure prediction approaches.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>5</volume>
					<fpage>140</fpage>
				</element-citation></ref><ref id="pcbi-0030149-b080"><label>80</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gardner</surname><given-names>P</given-names></name><name name-style="western"><surname>Wilm</surname><given-names>A</given-names></name><name name-style="western"><surname>Washietl</surname><given-names>S</given-names></name></person-group>
					<year>2005</year>
					<article-title>A benchmark of multiple sequence alignment programs upon structural RNAs.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>2433</fpage>
					<lpage>2439</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b081"><label>81</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Geyer</surname><given-names>CJ</given-names></name></person-group>
					<year>1991</year>
					<article-title>Markov chain Monte Carlo maximum likelihood.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Keramigas</surname><given-names>E</given-names></name></person-group>
					<source>Computing science and statistics: Proceedings of the 23rd Symposium on the Interface</source>
					<conf-date>21–24 April 1991;</conf-date>
					<conf-loc>Seattle, Washington.</conf-loc>
					<publisher-loc>Fairfax (Virginia)</publisher-loc>
					<publisher-name>Interface Foundation of North America</publisher-name>
					<fpage>156</fpage>
					<lpage>163</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b082"><label>82</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Holland</surname><given-names>B</given-names></name><name name-style="western"><surname>Moulton</surname><given-names>V</given-names></name></person-group>
					<year>2003</year>
					<article-title>Consensus networks: A method for visualising incompatibilities in collections of trees.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Benson</surname><given-names>G</given-names></name><name name-style="western"><surname>Page</surname><given-names>R</given-names></name></person-group>
					<conf-name>Third International Workshop, WABI 2003;</conf-name>
					<conf-date>September 15–20, 2003;</conf-date>
					<conf-loc>Budapest, Hungary.</conf-loc>
					<source>Algorithms in Bioinformatics</source>
					<publisher-loc>Berlin</publisher-loc>
					<publisher-name>Springer</publisher-name>
					<fpage>165</fpage>
					<lpage>176</lpage>
				</element-citation></ref><ref id="pcbi-0030149-b083"><label>83</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Huson</surname><given-names>DH</given-names></name><name name-style="western"><surname>Bryant</surname><given-names>D</given-names></name></person-group>
					<year>2006</year>
					<article-title>Application of phylogenetic networks in evolutionary studies.</article-title>
					<source>Mol Biol Evol</source>
					<volume>23</volume>
					<fpage>254</fpage>
					<lpage>267</lpage>
				</element-citation></ref></ref-list></back></article>