<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01358</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005292</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Chromosome biology</subject><subj-group><subject>Chromosomes</subject><subj-group><subject>Chromosome structure and function</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Chromosome biology</subject><subj-group><subject>Chromosomes</subject><subj-group><subject>Sex chromosomes</subject><subj-group><subject>X chromosomes</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Structural genomics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Chromosome biology</subject><subj-group><subject>Chromatin</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Epigenetics</subject><subj-group><subject>Chromatin</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject><subj-group><subject>Chromatin</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Chromosome biology</subject><subj-group><subject>Chromosomes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genetic loci</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Inferential Structure Determination of Chromosomes from Single-Cell Hi-C Data</article-title>
<alt-title alt-title-type="running-head">Inferential Structure Determination of Chromosomes from Single-Cell Hi-C Data</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5658-9043</contrib-id>
<name name-style="western">
<surname>Carstens</surname> <given-names>Simeon</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Nilges</surname> <given-names>Michael</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2188-5667</contrib-id>
<name name-style="western">
<surname>Habeck</surname> <given-names>Michael</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Unité de Bioinformatique Structurale, Department of Structural Biology and Chemistry, Institut Pasteur, Paris, France</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Statistical Inverse Problems in Biophysics, Max Planck Institute for Biophysical Chemistry, Göttingen, Germany</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Felix Bernstein Institute for Mathematical Statistics in the Biosciences, University of Göttingen, Göttingen, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Morozov</surname> <given-names>Alexandre V</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Rutgers University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> MN MH.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> SC MH.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> SC MH.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> SC MN MH.</p>
</list-item>
</list>
</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label><p>Current Address: Center for Soft Matter Research, Department of Physics, New York University, New York, United States of America</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">mhabeck@gwdg.de</email> (MH); <email xlink:type="simple">nilges@pasteur.fr</email> (MN)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>12</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>27</day>
<month>12</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>12</issue>
<elocation-id>e1005292</elocation-id>
<history>
<date date-type="received">
<day>22</day>
<month>8</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>7</day>
<month>12</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Carstens et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005292"/>
<abstract>
<p>Chromosome conformation capture (3C) techniques have revealed many fascinating insights into the spatial organization of genomes. 3C methods typically provide information about chromosomal contacts in a large population of cells, which makes it difficult to draw conclusions about the three-dimensional organization of genomes in individual cells. Recently it became possible to study single cells with Hi-C, a genome-wide 3C variant, demonstrating a high cell-to-cell variability of genome organization. In principle, restraint-based modeling should allow us to infer the 3D structure of chromosomes from single-cell contact data, but suffers from the sparsity and low resolution of chromosomal contacts. To address these challenges, we adapt the Bayesian Inferential Structure Determination (ISD) framework, originally developed for NMR structure determination of proteins, to infer statistical ensembles of chromosome structures from single-cell data. Using ISD, we are able to compute structural error bars and estimate model parameters, thereby eliminating potential bias imposed by <italic>ad hoc</italic> parameter choices. We apply and compare different models for representing the chromatin fiber and for incorporating singe-cell contact information. Finally, we extend our approach to the analysis of diploid chromosome data.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Spatial interactions between distant genomic regions are of fundamental importance in gene regulation and other nuclear processes. Recent chromatin crosslinking (“Hi-C”) experiments probe the spatial organization of chromosomes on a genome-wide scale to an extent that was previously unattainable. These experiments report on contacting loci and thus provide information about the three-dimensional structure of the genome. Unfortunately, the data are noisy and do not determine the structure uniquely. There is also little quantitative prior knowledge about the large-scale organization of chromosomes. Here, we address these challenges by developing a Bayesian statistical approach that combines a minimalist polymer model with chromosome size measurements and conformation capture data. Our method generates statistical ensembles of chromosome structures from extremely sparse single-cell Hi-C data. We remove potential bias by learning modeling parameters from the experimental data and apply model comparison techniques to investigate which among a set of alternative models is most supported by the Hi-C data. Our method also allows for modeling with ambiguous contact data obtained on polyploid chromosomes, which is an important step towards three-dimensional modeling of whole genomes.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001665</institution-id>
<institution>Agence Nationale de la Recherche</institution>
</institution-wrap>
</funding-source>
<award-id>ANR-11-MONU-0020</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Nilges</surname> <given-names>Michael</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>SFB 860, Project B09</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2188-5667</contrib-id>
<name name-style="western">
<surname>Habeck</surname> <given-names>Michael</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>SC and MN acknowledge funding from the Agence National de la Recherche (ANR-11-MONU-0020). MH acknowledges funding from the German Research Foundation (DFG) (SFB 860, Project B09). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="33"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-01-11</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All singe-cell Hi-C files are available from GEO (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE48262" xlink:type="simple">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE48262</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The rapid development of chromosome conformation capture techniques such as 3C [<xref ref-type="bibr" rid="pcbi.1005292.ref001">1</xref>], chromosome conformation capture-on-chip [<xref ref-type="bibr" rid="pcbi.1005292.ref002">2</xref>], the closely related circular chromosome conformation capture [<xref ref-type="bibr" rid="pcbi.1005292.ref003">3</xref>] (both named 4C) and 5C [<xref ref-type="bibr" rid="pcbi.1005292.ref004">4</xref>] culminated in a genome-wide variant, Hi-C [<xref ref-type="bibr" rid="pcbi.1005292.ref005">5</xref>], which provides all-against-all contact information. Hi-C experiments confirmed previously established hallmarks of genome organization including the existence of chromosome territories [<xref ref-type="bibr" rid="pcbi.1005292.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref006">6</xref>] and led to important new findings such as the partitioning of chromosomes into alternating active and passive, megabase-sized compartments [<xref ref-type="bibr" rid="pcbi.1005292.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref007">7</xref>] and in non-tissue-specific topologically associating domains (TADs) on the sub-megabase scale [<xref ref-type="bibr" rid="pcbi.1005292.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1005292.ref010">10</xref>].</p>
<p>Chromosome conformation capture experiments typically analyze populations of millions of cells, thereby only providing a population-averaged view. Recently, however, Nagano <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>] pioneered Hi-C on single cells by executing all of the steps of the original Hi-C protocol within permeabilized cells and selecting individual cells for further analysis. Although the single-cell Hi-C approach provided only very sparse contact data, the structural information was sufficient to reveal unprecedented insights into genome organization including a high cell-to-cell variability of interdomain and <italic>trans</italic>-chromosomal contacts as well as the persistence of TADs across single cells.</p>
<p>Many structural insights such as the existence of TADs or the scaling behavior of contact probabilities with genomic distance can be found by analyzing genome-wide contact matrices. Nevertheless, it seems attractive to obtain a more direct view of the 3D architecture of genomes by structural modeling based on the experimental contact information. To compute representative 3D structures of genomes, various approaches have been explored.</p>
<p>There is a growing array of computational methods for calculating consensus structures from population Hi-C data. Typically, these methods first derive distances from the experimental contact frequencies by using different heuristics. In the early work by Duan <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref012">12</xref>], a model of the yeast genome was computed based on data from a 4C-related experiment. Bau <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref013">13</xref>] mapped inverse log Z-scores from 5C data to distances and used the Integrated Modeling Platform (IMP) [<xref ref-type="bibr" rid="pcbi.1005292.ref014">14</xref>] to compute structural models. PASTIS [<xref ref-type="bibr" rid="pcbi.1005292.ref015">15</xref>] addresses chromosome structure determination by means of maximum likelihood, whereas ChromSDE [<xref ref-type="bibr" rid="pcbi.1005292.ref016">16</xref>] relies on semi-definite programming. Along with the structure, both PASTIS and ChromSDE optimize an additional free parameter, which is used to translate contact counts into distances. Trieu <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref017">17</xref>] used an optimization-based approach, but modeled contact counts explicitly. Also Zhang <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref018">18</xref>] avoided the conversion of contact counts to distances, but instead of a consenus structure, they obtain structure ensembles by simulating from an approximate energy landscape for chromosomes.</p>
<p>Two major challenges complicate the adaptation of methods for chromsome structure inference from population Hi-C to single-cell data. First, single-cell Hi-C measures only the formation of a contact rather than contact frequencies. Second, only a small subset of all chromosomal contacts is measured such that the contact information is very sparse. Therefore, specialized methods for the analysis of single-cell Hi-C contacts need to be developed. Multidimensional scaling (MDS) is a popular method to obtain three-dimensional structures from incomplete and noisy distance information and was already used in the first publication on chromosome conformation capture [<xref ref-type="bibr" rid="pcbi.1005292.ref001">1</xref>]. A major limitation of MDS is that with dwindling number of data serious artifacts are introduced, which eventually leads to a complete break-down of the procedure. Shortest-path reconstruction in 3D (ShRec3D) [<xref ref-type="bibr" rid="pcbi.1005292.ref019">19</xref>] and an approach employing manifold-based optimization (MBO) [<xref ref-type="bibr" rid="pcbi.1005292.ref020">20</xref>] are two recent variants of MDS that aim to overcome these challenges for single-cell Hi-C data. Both methods define a contact distance between loci that show a contact in the Hi-C experiment and introduce a similar distance between neighboring loci along the chromatin fiber. The missing entries of the distance matrix are imputed by shortest-path distances, which are computed for a graph derived from the experimental contacts and the fiber connectivity. ShRec3D applies MDS directly to the completed distance matrix, whereas Paulsen <italic>et al.</italic> downweigh the shortest-path distances and utilize optimization techniques on matrix manifolds [<xref ref-type="bibr" rid="pcbi.1005292.ref021">21</xref>]. Nagano <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>] used restraint-based modeling to obtain structures of the X chromosome from their single-cell data. They derived distances from the contact data and combined the restraint energy with a simple polymer model. To find chromosome structures that fit the restraints, they used simulated annealing (SA) combined with molecular dynamics.</p>
<p>However, the application of optimization approaches such as SA or MDS to chromosome structure determination suffers from the same conceptual problems described by Rieping <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref022">22</xref>] in the context of protein structure calculations from NMR data. First, the scoring function typically involves model parameters that are unknown and set to <italic>ad hoc</italic> values. An example is provided by the weighting factors that define the “strictness” of the restraints [<xref ref-type="bibr" rid="pcbi.1005292.ref023">23</xref>]. Second, structure ensembles generated by minimization approaches lack a sound statistical foundation. These ensembles are computed by running multiple minimizations from randomly varying initial structures. Although this practice seems plausible, the variability of the ensemble is not a valid “structural error bar”, because it does not only reflect the quality and amount of the data, but also the power of the optimization procedure, to mention but one reason. Third, minimization approaches fail to clearly separate model parameters from algorithmic parameters, again blurring the meaning of the structure ensemble.</p>
<p>To address these issues, Rieping <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref022">22</xref>] introduced Inferential Structure Determination (ISD) as an unbiased and parameter-free alternative to minimization approaches to biomolecular structure determination. ISD is a Bayesian probabilistic framework that views biomolecular structure determination as an inference problem. At the core of the ISD approach is a probability distribution over conformational space representing and combining both noisy and possibly incomplete data as well as prior knowledge about the unknown structure. Several Bayesian approaches have been developed to model the structure of chromosomes based on ensemble Hi-C data [<xref ref-type="bibr" rid="pcbi.1005292.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref025">25</xref>]. These methods try to infer a consensus structure of the population data, which is only of limited use. Moreover these approaches have not fully benefited from the Bayesian approach to chromosome structure inference. Wang <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref026">26</xref>] calculate structural ensembles using a Bayesian approach, but only optimize the posterior probability and do not apply the full Bayesian inference machinery, which allows for the quantification of parameter uncertainties and the comparison of alternative models.</p>
<p>Here we report on the application of ISD to infer statistically well-defined ensembles of chromosome structures from single-cell Hi-C data. We show that Markov chain Monte Carlo (MCMC) sampling allows us to compute diverse ensembles of coarse-grained chromosome conformations that reflect the sparsity of single-cell Hi-C contacts. MCMC techniques and the flexibility of our Bayesian approach also allow us to compare different models of the chromatin fiber as well as alternative models for Hi-C contacts. We use the conformational ensembles to map epigenetic marks into three-dimensional space. Furthermore, we demonstrate that ISD outperforms alternative methods on simulated data. Finally, we show how to extend the approach to diploid chromosomes and infer the structures of two chromosome copies simultaneously.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Chromosome models</title>
<p>We model the chromatin fiber with a beads-on-a-string representation. Owing to the sparsity of single-cell Hi-C contacts, we use a highly coarse-grained model in which every bead represents 500 kb of chromatin and has a radius of approximately 215 nm. Beads are connected such that they form a linear chain. The connectivity is enforced by a harmonic backbone potential, which penalizes distances between consecutive beads as soon as they exceed the bead diameter <italic>a</italic>. Beads are soft and allowed to overlap to some extent. We investigated two volume exclusion terms: a purely repulsive potential under which two beads that are closer than their diameter repel each other, and a Lennard-Jones potential with repulsive and attractive contributions. The sum of the backbone and nonbonded potential are part of the prior distribution (see <xref ref-type="sec" rid="sec012">Materials and Methods</xref> for details).</p>
<p>We first studied the properties of our model for the single-copy X chromosome of male mouse, which measures 166 Mb in length, and which we represent using 333 beads. We generated structures from the prior distribution and reconstructed the distribution of the radius of gyration <italic>R</italic><sub>g</sub> as a measure for the compactness of the fiber. Because there are no or only weak attractive interactions between the beads, the vast majority of structures generated from the prior showed an extended conformation. <xref ref-type="fig" rid="pcbi.1005292.g001">Fig 1A</xref> displays the density of states (or equivalently the microcanonical entropy) as a function of the radius of gyration. The density of states counts how many chromosome conformations map to a particular <italic>R</italic><sub>g</sub> value. There is a strong entropic force that pushes the fiber into an extended state characterized by a large radius of gyration. For the repulsive excluded volume term we found <italic>R</italic><sub>g</sub> = 11.2 ± 1.1 μm; for the Lennard-Jones potential we have <italic>R</italic><sub>g</sub> = 8.6 ± 1.3 μm. Due to the attractive contribution in the excluded volume term, the Lennard-Jones potential shows a higher preference for compact structures. Yet for both potentials, the fraction of compact structures with <italic>R</italic><sub>g</sub> smaller than 2 μm, say, is vanishingly small: 1.8 × 10<sup>−24</sup> for the quartic repulsion potential and 7.8 × 10<sup>−21</sup> for the Lennard-Jones term.</p>
<fig id="pcbi.1005292.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005292.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Overall properties of the chromosome model.</title>
<p><bold>(A)</bold> Density of states (microcanonical entropy) of the radius of gyration for both excluded volume potentials. <bold>(B)</bold> Relation between the radius of gyration and the size of the X chromosome.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>Incorporation of FISH measurements</title>
<p>The preference of the prior probability for extended structures with large average radii of gyration is incompatible with fact that chromosomes localize in chromosome territories, i.e. relatively compact subcompartments of the nucleus [<xref ref-type="bibr" rid="pcbi.1005292.ref006">6</xref>]. To good approximation, the size of the chromosome is a function of the radius of gyration. Empirically, we found that <inline-formula id="pcbi.1005292.e001"><alternatives><graphic id="pcbi.1005292.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>21</mml:mn> <mml:mo>×</mml:mo> <mml:msubsup><mml:mi>R</mml:mi> <mml:mi mathvariant="normal">g</mml:mi> <mml:mrow><mml:mspace width="0.166667em"/><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>11</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> gives a good estimate of the size of the X chromosome for relatively compact structures (<xref ref-type="fig" rid="pcbi.1005292.g001">Fig 1B</xref>); a simpler, yet precise enough relation is 2.58 × <italic>R</italic><sub>g</sub>. Using this approximation, the experimental chromosome size measurement of 3.7 ± 0.3 μm obtained with X-chromosome paint FISH [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>] corresponds roughly to <italic>R</italic><sub>g</sub> ≈ 1.43 ± 0.12 μm. Therefore, the average radii of gyration reported above are an order of magnitude too large compared to the experimental finding.</p>
<p>To incorporate the information from FISH into our probabilistic chromosome model and thereby inform the prior probability about the expected chromosome size, we assume a Gaussian error model for the chromosome size measurements. Based on our approximate relation between chromosome size and <italic>R</italic><sub>g</sub>, this term corresponds to a harmonic radius of gyration restraint with an experimental <italic>R</italic><sub>g</sub> value of 1.43 ± 0.12 μm.</p>
</sec>
<sec id="sec005">
<title>Inferential structure determination of the X chromosome from single-cell Hi-C contacts</title>
<p>By using probability calculus, it is possible to combine single-cell Hi-C contacts with the FISH data and our chromosome models (see <xref ref-type="sec" rid="sec012">Materials and Methods</xref>). Nagano <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>] analyzed Th1 cells of male mouse and selected ten cells that passed various quality criteria. We first focused on the most promising data set from cell 1 showing 616 X-chromosomal <italic>cis</italic>-contacts, which represents the highest number of contacts among all ten cells. We mapped these contacts onto the 500 kb beads; the removal of intra-bead contacts (“self-contacts”) resulted in 438 contacts, out of which 399 were unique (some contacts mapped onto identical pairs of beads).</p>
<p>We used a logistic model to quantify the probability that a <italic>cis</italic>-chromosomal contact is observed in a Hi-C experiment. The logistic function is a smooth version of a step function and has probability close to one if the contact is formed in the model structure of the fiber, and vanishes if the beads are too far apart. Consistent with other approaches [<xref ref-type="bibr" rid="pcbi.1005292.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref028">28</xref>], we chose a distance cutoff <italic>d</italic><sub>c</sub> = 1.5 × <italic>a</italic> ≈ 650 nm to decide whether two beads <italic>i</italic> and <italic>j</italic> are in contact. The smoothness of the logistic function was chosen such that a distance violation of 2.5% of the contact distance <italic>d</italic><sub>c</sub> has a probability smaller than 10<sup>−6</sup>.</p>
<p>We generated ensembles of X-chromosome structures for both excluded volume potentials, both without and with the additional model for FISH data introduced in the previous section. To sample chromosome conformations we used Hamiltonian Monte Carlo (HMC) [<xref ref-type="bibr" rid="pcbi.1005292.ref029">29</xref>], a stochastic variant of molecular dynamics. We started the HMC simulation from a fully extended X-chromosome structure. To ensure correct conformational sampling, we used replica exchange Monte Carlo [<xref ref-type="bibr" rid="pcbi.1005292.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref031">31</xref>] which runs multiple HMC simulations at different temperatures in parallel and exchanges conformations between the different simulations (see <xref ref-type="sec" rid="sec012">Materials and Methods</xref>). Replica exchange simulations are among the most powerful Monte Carlo methods to simulate complex probability distributions but computationally demanding. It is also possible to generate X-chromosome conformations that satisfy the experimental contacts by only running HMC at a fixed temperature. The HMC sampler rapidly finds a compact structure that fits the contact data very well without producing significant violations. Nevertheless, the following results were obtained by running replica exchange simulations.</p>
<p>As a first validation of our inference approach we studied whether all experimental contacts can be satisfied in the 3D model of the X chromosome. <xref ref-type="fig" rid="pcbi.1005292.g002">Fig 2A</xref> shows that this is indeed the case. For all four prior distributions the number of violations fluctuates about a small percentage of less than 3% (see also <xref ref-type="supplementary-material" rid="pcbi.1005292.s001">S1 Fig</xref>). By increasing the steepness of the logistic function, we could decrease this number to exactly zero.</p>
<fig id="pcbi.1005292.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005292.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Inferential structure determination of the mouse X chromosome from single-cell data.</title>
<p><bold>(A)</bold> Pooled histogram of all distances involved in an experimentally observed contact. The left peak corresponds to experimental contacts between consecutive beads that are neighbors in the chromosome fiber. The red dashed line marks the contact distance <italic>d</italic><sub>c</sub>. <bold>(B)</bold> <italic>Cis</italic>-chromosomal contacts from single-cell Hi-C and <bold>(C)</bold> distance matrix obtained with the Lennard-Jones potential. <bold>(D)</bold> Model evidence for both excluded volume potentials without and with FISH data shown as a function of the replica temperature. <bold>(E)</bold> Distribution of the radius of gyration for the Lennard-Jones prior without and with FISH data. <bold>(F)</bold> Matrix of standard deviations of pairwise distances reflecting the spread of the sampled X-chromosome conformations. Shown is the result for the Lennard-Jones potential with additional FISH data. The color palette ranges from black to yellow indicating small to large standard deviations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.g002" xlink:type="simple"/>
</fig>
<p>As a further validation we analyzed the average pairwise distance matrix computed from the sampled X-chromosome structures. <xref ref-type="fig" rid="pcbi.1005292.g002">Fig 2B and 2C</xref> compare the experimental contacts with the average distance matrix. We observe that loci with a high number of <italic>cis</italic>-chromosomal contacts correspond to patches of small pairwise distances in the distance matrices. Using a diagonal permutation test, we found that the average distance matrices based on the different prior probabilities agree to a large extent, which underlines the fact that the prior does not have a strong influence on the average properties of the structure ensemble. The correlation of the distance matrices ranges between 93% and 95% (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s001">S1 Fig</xref> for details).</p>
<p>Nevertheless, we can use Bayesian model comparison to study whether the data show any preference for one of the prior probabilities. To do so, we estimated the model evidence (also known as marginal likelihood) from the MCMC simulations. The model evidence quantifies how likely a probabilistic model is in the light of the data. <xref ref-type="fig" rid="pcbi.1005292.g002">Fig 2D</xref> shows that the contact data prefer the Lennard-Jones term over the quartic repulsion term. The incorporation of the information from FISH raises the model evidence further (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s002">S1 Table</xref>).</p>
<p>
<xref ref-type="fig" rid="pcbi.1005292.g002">Fig 2E</xref> shows the radii of gyration obtained without and with FISH data when using the Lennard-Jones potential. The structures generated with the <italic>cis</italic>-chromosomal contacts only, without additional FISH data are already quite compact with an average <italic>R</italic><sub>g</sub> of 1.32 μm. Due to the strong forces exerted by the logistic contact restraints, the ensemble is slightly more compact than suggested by the FISH data. When incorporating the FISH term, the average <italic>R</italic><sub>g</sub> shifts towards larger values with an average of 1.38 μm, corresponding to a chromosome size of ∼3.6 μm. The FISH data do not compromise the fit with the contact restraints: the number of violations does not change upon incorporation of the <italic>R</italic><sub>g</sub> model (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s001">S1 Fig</xref>). However, because the additional radius of gyration term helps to focus the conformational sampling on reasonably compact chromosome structures, the model evidence of the FISH based posterior is higher than without FISH data.</p>
<p>By looking at the variance of the pairwise distances in the structure ensembles (<xref ref-type="fig" rid="pcbi.1005292.g002">Fig 2F</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005292.s001">S1 Fig</xref>), we find that the regions at the start of the X chromosome and around the centromere show the highest degree of conformational diversity. It is unclear, however, if this increased variability reflects true conformational fluctuations or simply the fact that these regions are unmappable. Nonetheless, we also observe an overall rise in the distance fluctuations towards the telomeric region, which might indicate that this part is indeed more dynamic.</p>
</sec>
<sec id="sec006">
<title>Modeling single-cell Hi-C data as distance measurements</title>
<p>Many approaches to infer chromosome conformation from Hi-C data resort to modeling based on distance restraints. To this end, pairwise distances need to be derived from the experimental contact information. For example, the contact frequencies measured in ensemble Hi-C experiments were converted to distances by assuming a power law that relates the contact probability to the inter-bead distance, which is motivated by results from polymer physics (see e.g. [<xref ref-type="bibr" rid="pcbi.1005292.ref015">15</xref>]). In case of single-cell data, this is more challenging because only single contacts are observed and not contact frequencies.</p>
<p>To interpret the observation of a single-cell Hi-C contact as a distance measurement, we introduce an unknown distance <italic>δ</italic> between two loci that will be crosslinked. For the unknown chromosome conformation <italic>X</italic> it should therefore hold that <italic>δ</italic> ≈ <italic>d</italic><sub><italic>ij</italic></sub>(<italic>X</italic>) where <italic>d</italic><sub><italic>ij</italic></sub>(<italic>X</italic>) is the model distance between beads <italic>i</italic> and <italic>j</italic> representing both loci. Because <italic>δ</italic> is unknown, we estimate this model parameter simultaneously with the chromosome structure. In contrast, Nagano <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>] used <inline-formula id="pcbi.1005292.e002"><alternatives><graphic id="pcbi.1005292.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi>a</mml:mi> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> as experimental distance where <italic>a</italic> denotes the bead diameter and <italic>n</italic><sub><italic>ij</italic></sub> counts how often beads <italic>i</italic> and <italic>j</italic> form a contact after mapping the high-resolution contacts onto the coarse-grained representation of the fiber. At 500 kb resolution <italic>n</italic><sub><italic>ij</italic></sub> ranges from 1 to 3. In our approach, the repeated occurrence of a contact (<italic>n</italic><sub><italic>ij</italic></sub> &gt; 1) does not lead to a shortening of the contact distance, but rather to an enforcement of the distance restraint, which is duplicated <italic>n</italic><sub><italic>ij</italic></sub> times.</p>
<p>Due to experimental errors and shortcomings of our model, we have to account for discrepancies between the unknown experimental distance and the model distances. This is achieved by introducing a probabilistic model for the distribution of the discrepancy between <italic>δ</italic> and <italic>d</italic><sub><italic>ij</italic></sub>(<italic>X</italic>). We studied two error distributions: The first assumes a Gaussian shape with a flat plateau for distances between <italic>δ</italic> ± 0.2 × <italic>a</italic> in accordance with the approach by Nagano <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>]. The second model is a lognormal distribution [<xref ref-type="bibr" rid="pcbi.1005292.ref032">32</xref>]. Both error models depend on an additional unknown error parameter <italic>σ</italic>, which reflects how well the experimental distance agrees with the model distance. The inverse variance <italic>w</italic> = 1/<italic>σ</italic><sup>2</sup> can be interpreted as the weight of the distance restraint potential [<xref ref-type="bibr" rid="pcbi.1005292.ref023">23</xref>]. We set <italic>w</italic> to relatively large values to reflect our assumption that all observed contacts are correct (which we also assumed in the logistic contact model). We used <italic>w</italic> = 100 for the Gaussian with flat plateau and <italic>w</italic> = 500 for the lognormal model, because it has a softer shape than the harmonic restraint resulting from the Gaussian model.</p>
<p>To estimate the experimental distance using ISD, we rewrite <italic>δ</italic> = <italic>a</italic>/γ where γ &gt; 0 is an unknown scaling parameter such that ideally <italic>a</italic> = <italic>γd</italic><sub><italic>ij</italic></sub>(<italic>X</italic>). <xref ref-type="fig" rid="pcbi.1005292.g003">Fig 3A</xref> shows histograms of the estimated distance scale γ. The distance scale γ attains similar values for both error models. The average values are 0.724 ± 0.003 for the Gaussian with a flat plateau and γ = 0.744 ± 0.018 for the lognormal model. These values translate into an estimated inter-locus distance of ∼1.4 × <italic>a</italic>, which is comparable to the contact distance <italic>d</italic><sub>c</sub> assumed in the logistic contact model. The distances involved in an experimental contact (shown in <xref ref-type="fig" rid="pcbi.1005292.g002">Fig 2A</xref> for the contact model) are less restrained in the distance-based models (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s003">S2 Fig</xref>). Nevertheless the agreement between the structure ensembles generated with both distance-based models is fairly high. The correlation between the average distance matrices is 95% (<xref ref-type="fig" rid="pcbi.1005292.g003">Fig 3B</xref>), and both ensembles also agree well with the ensemble based on the logistic contact model (with a correlation coefficient of 96% between the average distances matrices generated by each of the distance-based models and the contact model).</p>
<fig id="pcbi.1005292.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005292.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Distance based modeling of the X chromosome.</title>
<p><bold>(A)</bold> Histogram of sampled distance scale estimates γ. <bold>(B)</bold> Average distance matrix for the Gaussian error model with a flat plateau (upper diagonal) and for the lognormal model (lower diagonal). <bold>(C)</bold> Log evidence log Pr(<italic>D</italic>|<italic>I</italic>) for different data weighting parameters λ (the inverse temperature λ is varied from 10<sup>−4</sup> to 1 in a replica exchange simulation to facilitate sampling of the posterior distribution).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.g003" xlink:type="simple"/>
</fig>
<p>Using Bayesian model comparison, we can also answer which of the two error models, Gaussian with a flat plateau or lognormal model, is preferred by the experimental data. <xref ref-type="fig" rid="pcbi.1005292.g003">Fig 3C</xref> shows the model evidence Pr(<italic>D</italic>|<italic>I</italic>) as a function of the replica temperature parameter λ. The values for λ = 1 indicate that the data tell us to prefer the Gaussian model with a flat plateau over the lognormal error model.</p>
<p>By running calculations in which we varied the error parameter <italic>σ</italic>, we found that the exact value of the distance scale γ depends on the assumption that we make about the reliability of the Hi-C data to some extent (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s004">S3 Fig</xref>). However, for reasonably small <italic>σ</italic>/large <italic>w</italic> this dependence is less strong and the distance scale γ reaches a plateau. Bayesian inference also allows us to estimate both model parameters, γ and <italic>σ</italic>, simultaneously, but this results in rather broad ensembles that do not adopt a well-defined structure (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s005">S1 Appendix</xref>). The failure to generate well-defined structure ensembles, if <italic>w</italic> is allowed to vary is due to the sparsity of the data: The intrinsic tendency of the chromatin fiber to adopt a disordered state is stronger than the forces exert by the distance restraints with variable weight. Only with a large enough weight it is possible to counter-balance the entropic forces. Another remedy is to improve the model of the chromatin fiber [<xref ref-type="bibr" rid="pcbi.1005292.ref033">33</xref>], but this is beyond the scope of this article.</p>
<p>Our results show that it is possible, in principle, to model single-cell Hi-C contacts as distance measurements. However, we will use the logistic contact model in the remainder of this article, because single-cell Hi-C observes binary contacts rather than continuous distances.</p>
</sec>
<sec id="sec007">
<title>Detailed analysis of the X-chromosome structure ensemble at 500 kb resolution</title>
<p>We now take a closer look at the ensembles generated with the ISD approach and compare them to the published ensemble by Nagano <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>]. The structure of the X chromosome adopts a bipartite conformation formed by two super-domains that approximately span the centromeric half (∼1–100 Mb) and the telomeric half (∼100–166 Mb) of the chromatin fiber. This large-scale domain structure is readily apparent from both the experimental contacts and the average distance matrix (<xref ref-type="fig" rid="pcbi.1005292.g002">Fig 2C</xref>) and becomes immediately visible in an explicit representation of the structure ensemble (<xref ref-type="fig" rid="pcbi.1005292.g004">Fig 4A</xref>).</p>
<fig id="pcbi.1005292.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005292.g004</object-id>
<label>Fig 4</label>
<caption>
<title>X-chromosome structure ensemble at 500 kb resolution.</title>
<p><bold>(A)</bold> Four principal conformers representing the posterior ensemble. Top: Trace plots showing all members of each cluster. The color palette indicates chromosome position ranging from centromere (blue) to telomere (red). Bottom: “Sausage representation” with the tube thickness indicating the local precision of bead positions. Unmappable beads 1–10 (1–5 Mb) and 48–66 (24–33 Mb) have been omitted for clarity. <bold>(B)</bold> Root mean square fluctuations (RMSF) within each cluster of the ISD ensemble and within clusters of the ensemble from the original single-cell Hi-C publication. <bold>(C)</bold> Three-dimensional feature maps for the first structural cluster. Regions involved in <italic>trans</italic>-chromosomal contacts are shown as red density. Lamin-B1 enriched regions are shown in yellow. H3K4me3 enriched regions are shown as blue volume. The overall shape of the cluster is shown in mesh representation. The orientation of the maps shown on the left is identical to the orientation of the ensemble shown in panel <bold>(A)</bold>. The maps shown on the right are rotated by 180° about a vertical axis.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.g004" xlink:type="simple"/>
</fig>
<p>Cluster analysis reveals that the ISD ensemble comprises multiple principal conformations about which the structures fluctuate. Closer inspection shows that the cluster centers are partial mirror images of each other. None of the likelihood and prior factors contributing to the posterior distribution distinguishes between a particular bead configuration and its mirror image, because all factors depend on distances only. Moreover, since there are only few contacts between the super-domains, each super-domain can show two conformations which are mirror images of each other. This results in at least four possible chromosome conformations which all achieve a similar goodness of fit of the Hi-C contacts.</p>
<p>Our cluster analysis finds that the eight most dominating structural clusters produced by ISD cover ∼90% of all states sampled from the posterior (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s006">S4 Fig</xref> for further details). The four most highly populated clusters are shown in <xref ref-type="fig" rid="pcbi.1005292.g004">Fig 4A</xref>. These are approximate mirror images of each other. We applied the same type of cluster analysis also to an ensemble of 200 X-chromosome structures computed by Nagano <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>] (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s007">S5 Fig</xref>). We found similar structural clusters that are partial mirror images of each other and have corresponding structural clusters in our ensemble (details given in Supplementary Information). However, overall the ISD ensemble seems to be more diverse, showing more clusters than the ensemble by Nagano <italic>et al.</italic></p>
<p>Visual inspection of the structural clusters suggests that the overall variability in the ISD ensemble is quite high and comparable to the fluctuations in the ensemble by Nagano <italic>et al.</italic> But each cluster of the ISD ensemble appears to be slightly better defined than the clusters in the ensemble by Nagano <italic>et al.</italic> This might be due to the more exhaustive sampling achieved by our Monte Carlo algorithm, the attractive contributions in the excluded volume term and the fact that we model Hi-C measurements as contacts with a steep sigmoidal contact probability rather than distance restraints.</p>
<p>For each cluster, we studied the local variability of the beads by using standard techniques for the analysis of NMR structure ensembles. We estimated the local precision of the bead positions by the root mean square fluctuation (RMSF) after superposition of the cluster members onto the cluster center. <xref ref-type="fig" rid="pcbi.1005292.g004">Fig 4B</xref> shows RMSF curves for both ensembles. The RMSF curves from the four major clusters of the ISD ensemble correlate almost perfectly, the same is true for the clusters of the previously published X chromosome ensemble. We also find a high agreement between the RMSF fluctuations in the ISD clusters and the fluctuations within the clusters of the ensemble by Nagano <italic>et al</italic>. The average Pearson correlation coefficient of the RMSF profiles is 91%, showing that the ensembles obtained with both approaches agree strongly in their conformational heterogeneity. Together with the high correlation of 85% between the average distance matrices of the ISD ensemble and the ensemble by Nagano <italic>et al.</italic> (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s008">S2 Table</xref>), these findings indicate that both ensembles show many similar properties. A tube representation of the local variability of the four principal conformers is shown in panel 4A. Again, we find a higher conformational diversity towards the telemore, which was already apparent from the standard deviation of pairwise bead distances (<xref ref-type="fig" rid="pcbi.1005292.g002">Fig 2F</xref>).</p>
<p>We also ran ISD simulations on contact data from 5 additional Th1 cells. The average distance matrices indicate that the ensembles are significantly different, indicating the cell-to-cell variability of chromosome conformations found by Nagano <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>] (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s010">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005292.s011">S7</xref> Figs). A comparison of the ensembles obtained with data from cell 1 to cell 6 is reported in <xref ref-type="supplementary-material" rid="pcbi.1005292.s008">S2 Table</xref>. This comparison shows that there is an overall agreement between the X-chromosome conformations obtained with the ISD approach and the restraint-based modeling approach by Nagano <italic>et al.</italic> also for the data sets from other cells.</p>
<p>By comparing the average distance matrices (<xref ref-type="supplementary-material" rid="pcbi.1005292.s010">S6 Fig</xref>), we conclude that chromosome structures from different cells share some common features, such as the partitioning into more or less well-defined domains, which appear as blocks of small distances along the diagonal. The size and location of these domains can differ significantly from cell to cell. While in cells 1, 4, 5 and 6, a well-defined telomeric domain is visible as a block between ∼130 − 166 Mb, it is much less pronounced in cells 2 and 3. This difference is also evident in the structural models (<xref ref-type="supplementary-material" rid="pcbi.1005292.s011">S7 Fig</xref>), in which the telomeric domain appears as a separated structural domain (colored in red). In the models for cell 4, the telomeric domain is on average ∼10 Mb shorter than in the models for cell 1, 5 and 6. The six different models also exhibit considerable differences in the spatial proximity of loci that are far apart in sequence. An example involves the centromeric region on the lower left of the average distance matrices. In the ensemble representing the X chromosome in cell 6, this region is spatially close to many loci that are up to ∼100 Mb distant in sequence, while in cell 5, this region shows significantly larger distances to most other loci. <xref ref-type="supplementary-material" rid="pcbi.1005292.s011">S7 Fig</xref> confirms this by showing that the blue and cyan parts of the X chromosome structure are much more exposed in cell 5 than in cell 6. Taken together, a picture of highly variable, presumably stochastic chromosome organization emerges, in which conformations nevertheless share large-scale properties across different cells.</p>
<p>A problem with current Hi-C based chromosome modeling is that it is difficult to validate the calculated structures. However, there are some independent sources of information, not used during modeling, that should be consistent with a meaningful structure ensemble. One is the information provided by population Hi-C. Although population Hi-C looks at a large pool of cells, the information about the <italic>absence</italic> of contacts should also hold for the chromosome structure based on single-cell data. As can be seen from <xref ref-type="supplementary-material" rid="pcbi.1005292.s012">S8 Fig</xref> by comparing the contact probabilities derived from the ISD ensemble with population Hi-C data, the ISD ensemble based on single-cell data indeed avoids contacts between loci that have a low contact probability in the population Hi-C map. Another validation is provided by the location of beads involved in <italic>trans</italic>-chromosomal contacts. <xref ref-type="fig" rid="pcbi.1005292.g004">Fig 4C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005292.s013">S9A Fig</xref> show that beads which are engaged in contacts with loci on other chromosomes tend to accumulate on the periphery of the structure ensemble, which is indirect evidence in support of our chromosome ensembles.</p>
<p>Based on the inferred structure ensemble it becomes possible to generate three–dimensional maps of genomic and epigenetic features and to correlate the features spatially. <xref ref-type="fig" rid="pcbi.1005292.g004">Fig 4C</xref> shows a volume representation of chromosomal regions that are enriched in H3K4me3 and lamin-B1 associated domains in the first structural cluster. Loci that are enriched in these epigenetic marks tend to aggregate in three-dimensional space. The lamin associated domains as well as H3K4me3-enriched regions both show a tendency to locate in the periphery of the X chromosome, where they occupy distinct regions. In accord with previous findings by Nagano <italic>et al.</italic>, we also find that H3K4me3 is enriched in some parts of the interior of the X chromosome (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s013">S9C Fig</xref>).</p>
</sec>
<sec id="sec008">
<title>Modeling X chromosome at 50 kb resolution</title>
<p>Due to the sparsity of the chromosomal contacts, we have used a very coarse-grained representation of the chromatin fiber. At this resolution, we can only study large-scale chromosomal organization. Higher resolution representations are typically needed to gain biologically relevant insights into 3D chromosome organization. We therefore also applied the ISD approach using a ten-fold higher resolved chromatin fiber. Each bead now represents 50 kb of chromatin, thereby matching the finest resolution used by Nagano <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>]. At this resolution the radius of a bead amounts to ∼100 nm.</p>
<p>At 50 kb resolution, we represent the X chromosome with 3330 spherical beads. We generated structure ensembles based on the Lennard-Jones volume exclusion term and the additional FISH restraint. We modeled the intra-chromosomal contacts with the logistic model; in contrast to Nagano <italic>et al.</italic> no additional “anti-contact” restraints from the ensemble Hi-C matrix were introduced.</p>
<p>To compare the overall properties of the structure ensembles generated at 500 kb and 50 kb resolution, we downsampled the distance matrices from the 50 kb models to match the resolution of the coarse-grained models. Downsampling was achieved by averaging 10 × 10 patches of the average distance matrix at 50 kb resolution. The downsampled average distance matrix and the average distance matrix of the low-resolution model show a correlation of 86%, indicating that the overall shape of the X chromosome at both levels of resolution is similar (see also <xref ref-type="supplementary-material" rid="pcbi.1005292.s014">S10 Fig</xref>).</p>
<p>
<xref ref-type="fig" rid="pcbi.1005292.g005">Fig 5A</xref> shows a representative conformation from the structure ensemble generated at 50 kb resolution. As with the models obtained at 500 kb resolution, the X chromosome adopts a bipartite conformation where two major domains corresponding to the centromeric and telomeric regions adopt a slightly kinked conformation. Moreover, the centromeric superdomain appears to be more densely packed. <italic>Trans</italic>-chromosomal contacts and epigenetic features show a similar distribution in the high-resolution ensemble in comparison with the chromosome ensemble at 500 kb resolution (see <xref ref-type="fig" rid="pcbi.1005292.g005">Fig 5B</xref>).</p>
<fig id="pcbi.1005292.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005292.g005</object-id>
<label>Fig 5</label>
<caption>
<title>X-chromosome structure at 50 kb resolution.</title>
<p><bold>(A)</bold> Representative structure of the X chromosome at 50 kb resolution where the tube thickness and color encodes the local packing density (dense packing: red, thick; low packing: blue, thin). <bold>(B)</bold> Representative structure of the X chromosome with beads involved in <italic>trans</italic>-chromosomal contacts highlighted as red spheres. <bold>(C)</bold> Contact probability between beads in the ISD ensemble as a function of the genomic distance <italic>s</italic>. Predictions made by various polymer models are shown as dashed lines: <italic>s</italic><sup>−3/2</sup> ideal chain/equilibrium globule, <italic>s</italic><sup>−1</sup> fractal globule.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.g005" xlink:type="simple"/>
</fig>
<p>
<xref ref-type="fig" rid="pcbi.1005292.g005">Fig 5C</xref> shows the contact frequency between beads in the ISD ensemble as a function of the genomic distance <italic>s</italic> (separation between beads along the fiber). In the region from 200 kb to 2000 kb genomic distance, the contact frequency shows random coil behavior. It has been argued on the basis of ensemble Hi-C data [<xref ref-type="bibr" rid="pcbi.1005292.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref034">34</xref>] that chromosomes adopt a fractal globule packing. The fractal globule shows <italic>s</italic><sup>−1</sup> dependence of the contact frequency, in contrast to the equilibrium globule which is expected to show a scaling behavior of <italic>s</italic><sup>−3/2</sup> until it reaches a constant value. Our 50 kb ensemble shows a mixed packing supporting a more complicated packing than the fractal globule also in single cells.</p>
</sec>
<sec id="sec009">
<title>Probabilistic inference of diploid chromosome structure</title>
<p>Because Th1 cells of male mice are diploid, most <italic>cis</italic>-chromosomal contacts of the single-cell Hi-C data from Nagano <italic>et al.</italic> show contacts involving two-copy chromosomes. The difficulty with these data is that we do not know whether a particular contact is formed in the first or the second copy of the chromosome. Therefore, we have to disentangle the contacts to use them for structural modeling. A naive approach to achieve this kind of demixing is to fit the contacts with a single chromosome structure and consider the violated restraints as contacts specifying the structure of the second copy. This approach is problematic because the first structure will try to explain as many contacts as possible, which results in a strong strain. Because the model of the fiber is very generic and flexible, it will be possible to fit a large fraction of all contacts with a single structure. This is shown in <xref ref-type="fig" rid="pcbi.1005292.g006">Fig 6A</xref> where we used a single structure to compute models from the single-cell <italic>cis</italic>-contacts of chromosome 1. Only a small fraction of less than 10% of all 1662 experimental contacts is strongly violated in the single-copy ensemble. It is hard to imagine that this small fraction of contacts is sufficient to determine a meaningful structure of the second copy. Furthermore, the number of restraints per copy would be highly unbalanced, for which there is no plausible physical reason.</p>
<fig id="pcbi.1005292.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005292.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Inference of chromosome 1 structure.</title>
<p><bold>(A)</bold> Distance violations in a probabilistic calculation using a single copy of chromosome 1. The contact distance is shown as dashed red line. <bold>(B)</bold> Distances of contacting beads in copy 1 against distances in copy 2. <bold>(C)</bold> Experimental contacts classified into restraints formed in both copies (green) and contacts seen only in one of the two copies (dark blue: copy 1, light blue: copy 2). <bold>(D, E)</bold> Average structures of both copies of chromosome 1. <bold>(F)</bold> Average distance matrix with upper half showing the first copy of chromosome 1 and the lower half showing the second copy.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.g006" xlink:type="simple"/>
</fig>
<p>A reason for the failure of the naive approach is that it tries to assign contacts to either of the two copies similar to an <italic>exclusive-or</italic> operation. The more appropriate operation would be a logical <italic>or</italic>: A contact is either formed in both chromosome copies or in only one of the two copies. To implement this approach efficiently, we can again benefit from concepts developed in NMR structure calculation. Ambiguous NMR crosspeaks showing inter-proton contacts are routinely modeled using ambiguous distance restraints (ADRs) [<xref ref-type="bibr" rid="pcbi.1005292.ref035">35</xref>]. The reason is that due to the chemical shift degeneracy a peak can often be explained by multiple alternative contacts. Which of the alternatives is the correct one, is not known at the beginning of the structure calculation. An ADR combines all alternative distances into a single average distance that has to match the experimental distance. The trick of ADRs is to average the distances not arithmetically, but by summing the inverse sixth powers of the distances followed by taking the inverse sixth root of this sum (<italic>r</italic><sup>−6</sup> averaging). In case of NMR structure calculation, this type of averaging can be motivated by the physical nature of the NMR signal. But we can also use it in different applications to implement some kind of <italic>or</italic> operation [<xref ref-type="bibr" rid="pcbi.1005292.ref036">36</xref>]: Due to the strong decay of the inverse sixth power large distances contribute only very weakly to the ADR. Therefore all configurations that could have led to the observation of the contact (contact formed in only one of the two copies and contact formed in both copies), approximately result in the same average distance.</p>
<p>To model two-copy chromosomes with ISD, we use two independent chromatin fibers and describe the observation of Hi-C contacts using a logistic model. However, in contrast to the single-copy approach, the logistic function is evaluated for the ADR computed by <italic>r</italic><sup>−6</sup> averaging of the corresponding distance in each copy. We only introduce intra-fiber distance restraints, although contacts could in principle arise also from inter-fiber contacts between the two copies. We exclude this possibility and assume that homologous chromosomes segregate into distinct territories that have no physical contact [<xref ref-type="bibr" rid="pcbi.1005292.ref037">37</xref>]. <xref ref-type="fig" rid="pcbi.1005292.g006">Fig 6B</xref> plots the restrained distances in the final structure of copy 1, <inline-formula id="pcbi.1005292.e003"><alternatives><graphic id="pcbi.1005292.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, against the distances in copy 2, <inline-formula id="pcbi.1005292.e004"><alternatives><graphic id="pcbi.1005292.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Since there are no distance pairs that are both significantly larger than the contact distance <italic>d</italic><sub>c</sub>, all contacts can be satisfied in only one of the two copies or in both. There is a cluster of contacts that are found in both structures (<inline-formula id="pcbi.1005292.e005"><alternatives><graphic id="pcbi.1005292.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005292.e006"><alternatives><graphic id="pcbi.1005292.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>). Other contacts are only formed in one of the two copies (copy 1: <inline-formula id="pcbi.1005292.e007"><alternatives><graphic id="pcbi.1005292.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005292.e008"><alternatives><graphic id="pcbi.1005292.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, copy 2: <inline-formula id="pcbi.1005292.e009"><alternatives><graphic id="pcbi.1005292.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005292.e010"><alternatives><graphic id="pcbi.1005292.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>). A classification of the contacts into these three classes is shown in <xref ref-type="fig" rid="pcbi.1005292.g006">Fig 6C</xref>. Note that the fraction of contacts that is either assigned to copy 1 or 2 is quite balanced: 42% of the contacts are assigned to copy 1, 41% are assigned to copy 2; the shared contacts are mostly found close to the diagonal. <xref ref-type="fig" rid="pcbi.1005292.g006">Fig 6D and 6E</xref> shows the average structure for both copies of chromosome 1. Again, we observe a bipartite domain architecture where the first copy is less compact than the second copy. Another way of looking at the structural differences between the two copies are the average distance matrices shown in <xref ref-type="fig" rid="pcbi.1005292.g006">Fig 6F</xref>.</p>
<p>Our model of the two-copy chromosome 1 suggests that homologous chromosomes exhibit a degree of structural variability within the same cell that is similar to the cell-to-cell variability across different cells. With a correlation coefficient of 51%, the difference between the distance matrices of both chromosomal copies is similar to the difference between structures of the X chromosome from different cells (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s008">S2 Table</xref>). This finding agrees with FISH images of chromosome territories showing that homologous chromosomes can adapt very different shapes (see, for example, chromosome paint images of mouse lymphocytes [<xref ref-type="bibr" rid="pcbi.1005292.ref038">38</xref>] or human fibroblasts [<xref ref-type="bibr" rid="pcbi.1005292.ref039">39</xref>]).</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>This article introduces a Bayesian probabilistic approach to infer the three-dimensional structure of chromosomes from sparse 3C contacts measured in single cells. Our approach builds on the ISD framework, which was originally developed for NMR structure determination of proteins. It is based on a posterior probability distribution over the space of chromosome conformations and model parameters. The posterior probability distribution integrates the information from single-cell Hi-C contacts and FISH measurements with a coarse-grained model of the chromatin fiber. We demonstrate the strengths of the ISD approach for single-cell Hi-C measurements on Th1 cells of male mouse [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>].</p>
<p>Using Markov chain Monte Carlo algorithms, we can generate statistically valid structure ensembles that represent the posterior probability. The ensembles can be used to compute a local error bar for the bead positions or the distribution of other structural parameters such as the radius of gyration and indicates which chromosomal regions are well-defined by the input data. Along with the chromosome structure, ISD also estimates model parameters such as the distance between two contacting loci.</p>
<p>The Bayesian framework allows us to not only estimate bead positions and model parameters but also to compare alternative descriptions of the chromosome fiber. Here we compared two different volume exclusion potentials, a purely repulsive potential and a potential with both attractive and repulsive contributions, and showed that the latter is preferred by the experimental data. Our approach can also quantify the information content of individual data sets. We showed that the incorporation of FISH data helps to define the chromosome conformation. Bayesian model comparison can also be used to select the best among alternative models of the experimental contacts in a data-driven fashion. This is demonstrated here for two distance-based restraint potentials.</p>
<p>All of these findings are shown in detail for the single-copy X chromosome at 500 kb and 50 kb resolution as well as demonstrated on synthetic data. It is also possible to analyze contact data for diploid chromosomes. By using ambiguous distance restraints, again a concept from protein NMR, we can also infer the structures of both chromosome copies simultaneously and thereby disentangle intra-chromosomal contacts that stem from either of the two copies. These features are beyond the scope of previous methods such as restraint-based modeling [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>], MDS approaches [<xref ref-type="bibr" rid="pcbi.1005292.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref020">20</xref>] and a recent embedding method based on semidefinite programming [<xref ref-type="bibr" rid="pcbi.1005292.ref016">16</xref>].</p>
<p>There are many possibilities for future applications and extensions of ISD to chromosome conformation capture data. An important aspect will concern the implementation and testing of more elaborate models of the chromatin fiber. Here we worked with a homopolymer model according to which the fiber is composed of equally sized beads that all interact by means of a single volume exclusion potential. This model ignores many known properties of chromosomes such as the existence of hetero- and euchromatin. Nucleosome positioning and other epigenetic data could be used to define a more realistic model of the fiber. Moreover, it might be required to introduce additional prior terms that control the persistence length and local flexibility. More realistic chromosome models have been proposed such as the Strings and Binders Switch (SBS) model [<xref ref-type="bibr" rid="pcbi.1005292.ref040">40</xref>]. These models could replace our current coarse-grained prior representation. By using Bayesian model comparison, we could then quantify whether the data support a more elaborate model of the chromatin fiber. Moreover, it should be possible to estimate the optimal resolution of the fiber from the data.</p>
<p>Here we focused on the use of single-cell Hi-C data. It is straightforward to also incorporate contacts from ensemble Hi-C experiments into our Bayesian modeling framework. One possibility would be to model scarcely populated contacts in the ensemble Hi-C matrix as “anti-contacts”, although the absence of contacts has to be interpreted with caution [<xref ref-type="bibr" rid="pcbi.1005292.ref041">41</xref>]. ISD can also be used to generate consensus structures using contact or distance restraints from ensemble Hi-C data comparable in spirit to the approach by Trieu <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref017">17</xref>] or other probabilistic approaches to compute consensus structures. However, these ensembles will only be of limited use, because a consensus shows the average of many structural states and can give a misleading picture of genome organization [<xref ref-type="bibr" rid="pcbi.1005292.ref041">41</xref>]. In future work, we will therefore try to generalize the ISD approach to properly treat ensemble Hi-C data.</p>
<sec id="sec011">
<title>Conclusion</title>
<p>In conclusion, our work shows that ISD provides a statistically sound and viable alternative to restraint minimization or embedding approaches for single-cell Hi-C data and produces less biased and statistically valid ensembles of chromosome conformations.</p>
</sec>
</sec>
<sec id="sec012" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec013">
<title>Inferential Structure Determination</title>
<p>The Inferential Structure Determination (ISD) approach [<xref ref-type="bibr" rid="pcbi.1005292.ref022">22</xref>] views the determination of macromolecular structures as a problem of statistical inference and asks how likely a structure <italic>X</italic> is in the light of incomplete and noisy data <italic>D</italic> as well as prior information <italic>I</italic>. In the language of probability theory, the answer is provided by the probability distribution Pr(<italic>X</italic>|<italic>D</italic>, <italic>I</italic>) defined over the entire conformation space. ISD uses Bayes’ theorem to compute the posterior probability Pr(<italic>X</italic>|<italic>D</italic>, <italic>I</italic>):
<disp-formula id="pcbi.1005292.e011"><alternatives><graphic id="pcbi.1005292.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>|</mml:mo> <mml:mi>D</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>|</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where Pr(<italic>D</italic>|<italic>X</italic>, <italic>I</italic>) is the likelihood, Pr(<italic>X</italic>|<italic>I</italic>) the prior probability and Pr(<italic>D</italic>|<italic>I</italic>) the model evidence or marginal likelihood.</p>
<p>The likelihood Pr(<italic>D</italic>|<italic>X</italic>, <italic>I</italic>) quantifies the agreement between the data and the structural model. To construct the likelihood, we typically choose a <italic>forward model</italic> for calculating mock data from a structure <italic>X</italic> and an <italic>error model</italic> that assesses the agreement between experimental and mock data. The forward model may involve unknown parameters such as scaling factors; the error model depends on unknown noise levels. Therefore, the 3D structure <italic>X</italic> is not the only unknown parameter in our inference problem. Additional model parameters <italic>θ</italic> need to be inferred from the data along with the conformational degrees of freedom. This is accomplished with the augmented posterior distribution
<disp-formula id="pcbi.1005292.e012"><alternatives><graphic id="pcbi.1005292.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>D</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
After specifying the prior distributions reflecting our background knowledge (e.g. a force field for the conformational parameters or the positivity of a scaling parameter), the problem of inferring the unknown structure and additional model parameters is formally solved. Because the posterior distribution is typically of a nonstandard form and exhibits multiple modes, we have to use powerful random sampling techniques such as Markov Chain Monte Carlo (MCMC) [<xref ref-type="bibr" rid="pcbi.1005292.ref042">42</xref>] to generate representative structures and model parameters (see below).</p>
</sec>
<sec id="sec014">
<title>Chromosome models and conformational prior probabilities</title>
<p>We represent a chromosome by <italic>N</italic> spherical beads of diameter <italic>a</italic>, which determines the length scale of the model (<xref ref-type="fig" rid="pcbi.1005292.g007">Fig 7</xref>). A typical value for the density of a chromosome is 12 Mb/ μm<sup>3</sup> [<xref ref-type="bibr" rid="pcbi.1005292.ref043">43</xref>]. Our coarse-grained model uses beads representing 500 kb of chromatin such that the volume occupied by a single bead is 1/24 μm<sup>3</sup>. Therefore the radius of a bead is approximately 215 nm. At a resolution of 50kb, the bead radius is approximately 100 nm.</p>
<fig id="pcbi.1005292.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005292.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Coarse-grained chromosome model.</title>
<p><bold>(A)</bold> The chromatin fiber is composed of beads representing 500 kb of chromatin. Every bead is modeled as a spherical shape of size <italic>a</italic>. Configurations with overlapping beads are penalized using a nonbonded force field accounting for volume exclusion. The beads are arranged as a linear chain where the spacing between the beads is chosen such that two neighboring beads touch each other in the equilibrium configuration. <bold>(B)</bold> Effective potential between consecutive beads along the chromatin fiber. The dashed vertical line indicates the size of the spherical bead <italic>a</italic> = 430 nm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.g007" xlink:type="simple"/>
</fig>
<p>The distance <italic>d</italic><sub><italic>i</italic>, <italic>i</italic>+1</sub> between two consecutive beads <italic>i</italic>, <italic>i</italic> + 1 is restrained to an upper limit of <italic>a</italic> above which deviations are penalized quadratically with a force constant <italic>k</italic><sub>bb</sub> = 250/<italic>a</italic><sup>2</sup>. Overlaps between two beads are penalized using an excluded volume term <italic>E</italic><sub>nb</sub> with force constant <italic>k</italic><sub>nb</sub>. The conformational prior distribution defined over bead positions <italic>X</italic> = (<italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>N</italic></sub>) is given by the canonical ensemble:
<disp-formula id="pcbi.1005292.e013"><alternatives><graphic id="pcbi.1005292.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>|</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>nb</mml:mtext></mml:msub> <mml:msub><mml:mi>E</mml:mi> <mml:mtext>nb</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>bb</mml:mtext></mml:msub> <mml:msub><mml:mi>E</mml:mi> <mml:mtext>bb</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
with
<disp-formula id="pcbi.1005292.e014"><alternatives><graphic id="pcbi.1005292.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:msub><mml:mi>E</mml:mi> <mml:mtext>bb</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mo>θ</mml:mo><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where <italic>I</italic> denotes all prior assumptions, i.e. specific values for <italic>a</italic>, <italic>k</italic><sub>bb</sub>, etc. Here and in <xref ref-type="disp-formula" rid="pcbi.1005292.e015">Eq 5</xref>, θ(<italic>x</italic>) denotes the Heaviside step function; θ(<italic>x</italic> ≥ 0) = 1 and θ(<italic>x</italic> &lt; 0) = 0.</p>
<p>Here we study two nonbonded force fields to account for volume exclusion effects. The first force field consists only of a repulsive term that is activated as soon as two beads come closer than their diameter <italic>a</italic>. A repellent force resulting from a quartic repulsion energy pushes the beads apart:
<disp-formula id="pcbi.1005292.e015"><alternatives><graphic id="pcbi.1005292.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:msub><mml:mi>E</mml:mi> <mml:mtext>nb</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:mo>θ</mml:mo><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>4</mml:mn></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
The strength of the force is determined by the force constant, which we set <italic>k</italic><sub>nb</sub> = 5/<italic>a</italic><sup>4</sup>. The second excluded volume term is a Lennard-Jones potential with linear asymptotes:
<disp-formula id="pcbi.1005292.e016"><alternatives><graphic id="pcbi.1005292.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>L</mml:mi> <mml:mi>J</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>13</mml:mn> <mml:mo>-</mml:mo> <mml:mn>14</mml:mn> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>s</mml:mi> <mml:mn>6</mml:mn></mml:msup></mml:mrow> <mml:msup><mml:mi>s</mml:mi> <mml:mn>12</mml:mn></mml:msup></mml:mfrac> <mml:mo>-</mml:mo> <mml:mn>12</mml:mn> <mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mn>6</mml:mn></mml:msup></mml:mrow> <mml:msup><mml:mi>s</mml:mi> <mml:mn>13</mml:mn></mml:msup></mml:mfrac> <mml:mfrac><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mi>a</mml:mi></mml:mfrac></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>;</mml:mo> <mml:mspace width="1.em"/><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>s</mml:mi> <mml:mo>·</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>a</mml:mi> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced> <mml:mn>12</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>a</mml:mi> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced> <mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>;</mml:mo> <mml:mspace width="1.em"/><mml:mi>s</mml:mi> <mml:mo>·</mml:mo> <mml:mi>a</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:mi>l</mml:mi> <mml:mo>·</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>l</mml:mi> <mml:mn>6</mml:mn></mml:msup></mml:mrow> <mml:msup><mml:mi>l</mml:mi> <mml:mn>12</mml:mn></mml:msup></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mtext>cut</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mtext>cut</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi> <mml:mo>·</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>;</mml:mo> <mml:mspace width="1.em"/><mml:mi>l</mml:mi> <mml:mo>·</mml:mo> <mml:mi>a</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mtext>cut</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>;</mml:mo> <mml:mspace width="1.em"/><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mtext>cut</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
with <italic>s</italic> = 0.6, <italic>l</italic> = 1.25, <italic>d</italic><sub>cut</sub> = 1.375 × <italic>a</italic>. The effective potentials between successive beads are shown in <xref ref-type="fig" rid="pcbi.1005292.g007">Fig 7B</xref>.</p>
</sec>
<sec id="sec015">
<title>Probabilistic model for FISH data</title>
<p>FISH experiments measure the size of chromosome territories and show that the chromatin fiber adopts a compact conformation during interphase. To incorporate FISH data into our model, we first need to measure the size of a chromosome given the bead positions <italic>X</italic>. The squared radius of gyration is defined as:
<disp-formula id="pcbi.1005292.e017"><alternatives><graphic id="pcbi.1005292.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mi mathvariant="normal">g</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo>∥</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mover><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>∥</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
where <inline-formula id="pcbi.1005292.e018"><alternatives><graphic id="pcbi.1005292.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mover><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:msub> <mml:mtext> </mml:mtext><mml:msub><mml:mi>x</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the center of mass of all beads. For compact chromosome conformations we can define the size of a chromosome as the maximum extent of a bounding box circumscribing all beads. Empirically we found that the chromosome size is proportional to the radius of gyration where the proportionality factor is ∼2.58.</p>
<p>Let us now assume that FISH experiments result in a list of chromosome size measurements <italic>s</italic><sub>1</sub>, …, <italic>s</italic><sub><italic>M</italic></sub>. We model each observation using a Gaussian error model such that the probability of observing the <italic>m</italic>-th size measurement is:
<disp-formula id="pcbi.1005292.e019"><alternatives><graphic id="pcbi.1005292.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt> <mml:msub><mml:mi>σ</mml:mi> <mml:msub><mml:mrow/><mml:mtext>FISH</mml:mtext></mml:msub></mml:msub></mml:mrow></mml:mfrac> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:msub><mml:mrow/><mml:mtext>FISH</mml:mtext></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac> <mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mspace width="0.166667em"/><mml:msub><mml:mi>s</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo>.</mml:mo> <mml:mn>58</mml:mn> <mml:mo>×</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi mathvariant="normal">g</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>σ</italic><sub>FISH</sub> is the error of the FISH measurements. The complete probability of all FISH measurements is:
<disp-formula id="pcbi.1005292.e020"><alternatives><graphic id="pcbi.1005292.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>m</mml:mi></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt> <mml:msub><mml:mi>σ</mml:mi> <mml:msub><mml:mrow/><mml:mtext>FISH</mml:mtext></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>M</mml:mi></mml:msup></mml:mfrac> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:mfrac><mml:mi>M</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:msub><mml:mrow/><mml:mtext>FISH</mml:mtext></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac> <mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mspace width="0.166667em"/><mml:mover><mml:mi>s</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo>.</mml:mo> <mml:mn>58</mml:mn> <mml:mo>×</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi mathvariant="normal">g</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <inline-formula id="pcbi.1005292.e021"><alternatives><graphic id="pcbi.1005292.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mover><mml:mi>s</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>M</mml:mi></mml:mfrac> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>m</mml:mi></mml:msub> <mml:mtext> </mml:mtext><mml:msub><mml:mi>s</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the average chromosome size and Δ<italic>s</italic> is the standard deviation. For the X chromosome of Th1 cells we have <inline-formula id="pcbi.1005292.e022"><alternatives><graphic id="pcbi.1005292.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mover><mml:mi>s</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mrow><mml:mn>3</mml:mn> <mml:mo>.</mml:mo> <mml:mn>7</mml:mn></mml:mrow> <mml:mrow/></mml:mrow></mml:math></alternatives></inline-formula> μm and Δ<italic>s</italic> = 0.3 μm [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>].</p>
</sec>
<sec id="sec016">
<title>Probabilistic models for single-cell Hi-C data</title>
<p>We studied three probabilistic models to measure the compatibility of a chromosome structure <italic>X</italic> with single-cell Hi-C data <italic>D</italic>. The data is a list of experimental contacts <italic>C</italic> between pairs of loci <italic>i</italic> and <italic>j</italic>. Two of the three models that we used to analyze the Hi-C contacts are based on distance restraints similar to the approach by Nagano <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>]. To account for inaccuracies in the data and the model, we use an error model that describes the likelihood of a mismatch between the experimental and back-calculated distances. The third model is based on sigmoidal contact probability and prefers conformations satisfying all observed contacts similar to Trieu et al. [<xref ref-type="bibr" rid="pcbi.1005292.ref017">17</xref>]. Due to coarse graining, we might observe multiple contacts between two beads; <italic>n</italic><sub><italic>ij</italic></sub> denotes the corresponding number of counts in the binned contact matrix. Distance / contact restraints between beads <italic>i</italic>, <italic>j</italic> with <italic>n</italic><sub><italic>ij</italic></sub> &gt; 1 are duplicated <italic>n</italic><sub><italic>ij</italic></sub> times.</p>
<sec id="sec017">
<title>Distance-based modeling of single-cell Hi-C contacts</title>
<p>The distance-based likelihoods assume that the observation of a single-cell Hi-C contact between loci <italic>i</italic> and <italic>j</italic> can be interpreted as the observation of an unknown distance <italic>δ</italic>. Ideally, it should hold that <italic>δ</italic> = <italic>d</italic><sub><italic>ij</italic></sub>(<italic>X</italic>) where <italic>d</italic><sub><italic>ij</italic></sub>(<italic>X</italic>) = ‖<italic>x</italic><sub><italic>i</italic></sub> − <italic>x</italic><sub><italic>j</italic></sub>‖ is the Euclidean distance between the corresponding beads. Since <italic>δ</italic> is not observed directly, we will treat it as an unknown model parameter.</p>
<p>To do this, we take the unknown distance <italic>δ</italic> as proportional to the bead diameter <italic>a</italic>, introducing a scaling factor γ via <italic>δ</italic> = <italic>a</italic>/γ. We thus assume that our single-cell experiment gives distance measurements <italic>a</italic> for pairs of loci (<italic>i</italic>, <italic>j</italic>) ∈ <italic>C</italic> and that ideally <italic>a</italic> = <italic>γd</italic><sub><italic>ij</italic></sub>(<italic>X</italic>) for these pairs.</p>
<p>An error model accounts for deviations from the ideal relationship <italic>a</italic> = <italic>γd</italic><sub><italic>ij</italic></sub>. These deviations are captured with a probability distribution <italic>p</italic>(<italic>a</italic>|γ, <italic>X</italic>, <italic>I</italic>) such that the complete probability of all contacts is:
<disp-formula id="pcbi.1005292.e023"><alternatives><graphic id="pcbi.1005292.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>|</mml:mo> <mml:mo>γ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
Our first choice for the error model is a Gaussian distribution with a flat plateau within an upper/lower limit of ±0.2 × <italic>a</italic> about the ideal distance <italic>γd</italic><sub><italic>ij</italic></sub>(<italic>X</italic>):
<disp-formula id="pcbi.1005292.e024"><alternatives><graphic id="pcbi.1005292.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:msub><mml:mrow/><mml:mtext>Gauss</mml:mtext></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>|</mml:mo> <mml:mo>γ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt> <mml:mi>σ</mml:mi> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>4</mml:mn> <mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>×</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>8</mml:mn> <mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mo>γ</mml:mo> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>;</mml:mo> <mml:mspace width="1.em"/><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>8</mml:mn> <mml:mi>a</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mo>γ</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>;</mml:mo> <mml:mspace width="1.em"/><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>8</mml:mn> <mml:mi>a</mml:mi> <mml:mo>≤</mml:mo> <mml:mo>γ</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:mi>a</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mo>γ</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>;</mml:mo> <mml:mspace width="1.em"/><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:mi>a</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mo>γ</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula></p>
<p>The second error model is a lognormal distribution, which was introduced by Rieping <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref032">32</xref>] to describe errors of inherently positive quantities such as distance measurements:
<disp-formula id="pcbi.1005292.e025"><alternatives><graphic id="pcbi.1005292.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:msub><mml:mrow/><mml:mtext>LN</mml:mtext></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>|</mml:mo> <mml:mo>γ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt> <mml:mi>σ</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:mfrac> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msup><mml:mo form="prefix">log</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>a</mml:mi> <mml:mo>/</mml:mo> <mml:mo>γ</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mfenced> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
In both error models, <italic>σ</italic> quantifies the error of the Hi-C distance measurements.</p>
</sec>
<sec id="sec018">
<title>Modeling single-cell Hi-C contacts with a logistic function</title>
<p>As an alternative to distance-based modeling, approaches directly based on the contact information have been proposed [<xref ref-type="bibr" rid="pcbi.1005292.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref017">17</xref>]. Whenever two beads come closer than a distance threshold <italic>d</italic><sub>c</sub>, the corresponding loci are in contact; we set <italic>d</italic><sub>c</sub> = 1.5 × <italic>a</italic>. Because we employ gradient-based methods in our sampling approach, we need to transform the binary contact constraints into a smooth function of the distance. We use a logistic function with steepness <italic>α</italic> to measure to which extent a contact is formed:
<disp-formula id="pcbi.1005292.e026"><alternatives><graphic id="pcbi.1005292.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:munder> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>{</mml:mo> <mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi mathvariant="normal">c</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
For large <italic>α</italic>, the logistic function approaches a step function. We set <italic>α</italic> = 200/<italic>a</italic> in our simulations.</p>
<p>Our model is reminiscent of logistic regression, a technique to fit linear models to binary data arising in classification problems. Here, the two classes correspond to contacts and non-contacts between two loci. However, in contrast to standard applications of logistic regression, only the first of the two classes is observed, because single-cell Hi-C gives us only information about contacting loci; the absence of a contact cannot be interpreted as the observation of a non-contact. With this degenerate data set, the regression parameters themselves remain undefined. Therefore, we have to fix the regression parameters <italic>α</italic> and <italic>d</italic><sub>c</sub>. One possibility to estimate these parameters would be to combine single-cell with ensemble Hi-C data: the absence of ensemble Hi-C counts for pairs of mappable loci could, with some caution [<xref ref-type="bibr" rid="pcbi.1005292.ref041">41</xref>], serve as an observation of a non-contact. However, we have not explored this possibility further in the paper.</p>
</sec>
<sec id="sec019">
<title>Modeling two-copy chromosome contacts using ambiguous distance restraints (ADRs)</title>
<p>When modeling the structure of diploid chromosomes, an observed single-cell Hi-C contact is ambiguous in the sense that it could be formed in either of the two copies. To deal with this ambiguity, we adopt an idea from NMR which is commonly used to work with distances that are ambiguous due to chemical shift degeneracy. Ambiguous distance restraints (ADR) compute an effective distance resulting form all alternative possibilities [<xref ref-type="bibr" rid="pcbi.1005292.ref035">35</xref>]. In the context of chromosome structure inference, we have two copies of the chromosome with conformations <italic>X</italic><sub>1</sub> and <italic>X</italic><sub>2</sub>. The effective distance between beads <italic>i</italic> and <italic>j</italic> is computed as an <italic>r</italic><sup>−6</sup>-average:
<disp-formula id="pcbi.1005292.e027"><alternatives><graphic id="pcbi.1005292.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mrow><mml:msub><mml:mover><mml:mi>d</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mspace width="0.166667em"/><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>6</mml:mn></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>6</mml:mn></mml:mrow></mml:msup> <mml:mspace width="0.166667em"/></mml:mfenced> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>6</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
where <italic>d</italic><sub><italic>ij</italic></sub>(<italic>X</italic><sub><italic>k</italic></sub>) is the distance between loci <italic>i</italic> and <italic>j</italic> in the <italic>k</italic>-th copy of the chromosome. The effective distance <xref ref-type="disp-formula" rid="pcbi.1005292.e027">Eq (14)</xref> is fed into the logistic <xref ref-type="disp-formula" rid="pcbi.1005292.e026">model (13)</xref> for Hi-C contacts such that the resulting likelihood function for diploid chromosomes is
<disp-formula id="pcbi.1005292.e028"><alternatives><graphic id="pcbi.1005292.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:munder> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>{</mml:mo> <mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>d</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi mathvariant="normal">c</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula>
This model implements a soft version of a logical <italic>OR</italic>: If both <italic>d</italic><sub><italic>ij</italic></sub>(<italic>X</italic><sub>1</sub>) and <italic>d</italic><sub><italic>ij</italic></sub>(<italic>X</italic><sub>2</sub>) are smaller than the cutoff <italic>d</italic><sub>c</sub>, the effective distance <inline-formula id="pcbi.1005292.e029"><alternatives><graphic id="pcbi.1005292.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msub><mml:mover><mml:mi>d</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is also smaller than the contact distance. If the contact is formed in only one of both structures, the contribution from the large distance is negligible such that the effective distance roughly corresponds to the inter-bead distance in the structure that forms the contact. If none of the structures forms the contact, the effective distance will be larger than <italic>d</italic><sub>c</sub> and the contact will be violated.</p>
<p>For single-cell Hi-C data of diploid chromosomes it makes sense to use an <italic>OR</italic> rather than an <italic>XOR</italic> operation to explain the contacts. This is again a consequence of the fact that the absence of a single-cell Hi-C contact is not necessarily indicative of the loci being further apart than the contact distance <italic>d</italic><sub>c</sub>. This is demonstrated by structures of the X chromosome calculated with contacts from six different cells. <xref ref-type="supplementary-material" rid="pcbi.1005292.s009">S3 Table</xref> shows that even though the structure ensembles differ in many aspects (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s006">S4 Fig</xref>) there is a fraction of contacts (∼30%) that is formed across different cells. The possibility that a contact might be formed in only one of the two copies is captured by both <italic>OR</italic> and <italic>XOR</italic>. However, it could be that a contact which is observed for one of the copies is also compatible with the structure of the other copy, but not observed due to the limited coverage of single-cell experiments. An <italic>XOR</italic> operation would not allow for this possibility.</p>
<p><italic><monospace>Test calculation with incomplete distance information.</monospace></italic> To get a better understanding of the strengths and shortcomings of our approach to model two-copy chromosomes, we ran test calculations on small protein structures that have the same size, but different topology. We used ubiquitin (PDB code 1ubq) and an NMR structure of the HRDC domain (PDB code 2ma1) as test systems. Ubiquitin is 76 amino acids in length, the HRDC domain is 75 amino acids long. By ignoring the last amino acid of ubiquitin, both structures can be represented by 75 beads located at the C<italic>α</italic> positions.</p>
<p>As a first test, we ran calculations with distance data. For both protein structures, we used all distances smaller than 10Å as input resulting in 547 distances for ubiquitin and 504 distances for the HRDC domain. ISD calculations for the invidual proteins showed that this incomplete distance information is sufficient to obtain a highly accuracte structure model. For ubiquitin, the mean structure achieved an RMSD of 0.6 Å to the correct structure. For the HRDC domain, we obtained a model of even higher accuracy with an RMSD of 0.4 Å.</p>
<p>Next we combined both sets of distances and tried to reconstruct the structure of ubiquitin and the HRDC domain simultaneously by the use of ambiguous distance restraints. Indeed, ISD was able to disentangle the distance and to obtain fairly accurate models of ubiquitin and the HRDC domain. <xref ref-type="supplementary-material" rid="pcbi.1005292.s017">S13A–S13D Fig</xref> show the ISD models in comparison with the correct structures. For ubiquitin, we achieved an overall RMSD of 2.1 Å. For the HRDC domain, the RMSD is 2.5 Å. The accuracy of the models is compromised by mixing the distance data, but it is clearly possible to reconstruct models of moderate accuracy by the use of ADRs.</p>
<p><italic><monospace>Test calculation with sparse contact data.</monospace></italic> Next, we investigated whether also sparse contact information is sufficient to reconstruct two structural models from mixed experimental contacts. We computed contact data by keeping those pairs of C<italic>α</italic> positions whose distance is smaller than 4 times the van der Waals radius, which resulted in 323 contacts for ubiquitin and 313 contacts for the HRDC domain.</p>
<p>First, we ran ISD on the individual contact data. In both cases, we obtained ensembles that were close to the correct structure, but which also contained mirror images. The RMSD of the average structures is 2.2 Å (ubiquitin) and 1.9 Å (HRDC domain). To test if the use of ADRs is capable of disentangling mixed contact data, we combined the contacts from ubiquitin and the HRDC domain into a single set of 636 contacts, which we modeled in the same way as the diploid chromosome data. <xref ref-type="supplementary-material" rid="pcbi.1005292.s015">S11E–S11H Fig</xref> shows the average structures that we obtained by using the ambiguous contact model. Although the accuracy of the models is highly reduced (RMSD: ubiquitin 5.2 Å, HRDC domain 4.5 Å) the topology of the models is still correct. This illustrates that in principle contact data for diploid chromosomes can be separated into two sets of contacts that encode the single chromosome structures. When increasing sparsity of the contact data, this demixing becomes more and more challenging.</p>
</sec>
</sec>
<sec id="sec020">
<title>Posterior sampling</title>
<p>Because the full posterior probability Pr(<italic>X</italic>, <italic>θ</italic>|<italic>D</italic>, <italic>I</italic>) (or Pr(<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, <italic>θ</italic>|<italic>D</italic>, <italic>I</italic>) in case of diploidy) is of a non-standard form, we have to use Markov chain Monte Carlo (MCMC) sampling to draw representative chromosome conformations and model parameters that we can then use to compute average values and error bars. Gibbs sampling [<xref ref-type="bibr" rid="pcbi.1005292.ref044">44</xref>] is an iterative MCMC algorithm that draws from the posterior probability by cycling over successive steps that alternate between sampling of the conformational degrees of freedom and the model parameters:
<disp-formula id="pcbi.1005292.e030"><alternatives><graphic id="pcbi.1005292.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>∼</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>|</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>∼</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
This permits the use of adequate samplers for each model parameter.</p>
<sec id="sec021">
<title>Sampling of chromosome structures</title>
<p>An essential step in simulating Pr(<italic>X</italic>, <italic>θ</italic>|<italic>D</italic>, <italic>I</italic>) is to draw the conformational degrees of freedom <italic>X</italic> for fixed model parameters <italic>θ</italic>. This is challenging because we need to generate a random sample from a 3<italic>N</italic> dimensional distribution over all bead positions <italic>x</italic><sub><italic>n</italic></sub>, which influence each other in a non-trivial way.</p>
<p>If there are multiple structures that are consistent with the distance restraints and the prior information, the conditional posterior distribution Pr(<italic>X</italic>|<italic>θ</italic>, <italic>D</italic>, <italic>I</italic>) will exhibit multiple peaks. Furthermore, the bead positions are highly correlated, because a displacement of one bead will exert forces not only on its direct neighbors along the fiber, but on all spatially close-by particles because of the volume exclusion term and the Hi-C contact restraints.</p>
<p>A large class of methods for sampling from general probability distributions are Markov Chain Monte Carlo (MCMC) algorithms, which construct a Markov chain whose unique limiting distribution is the distribution one aims to simulate. Simple MCMC methods such as the Metropolis-Hastings algorithm [<xref ref-type="bibr" rid="pcbi.1005292.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref046">46</xref>] produce highly correlated samples. We therefore use Hamiltonian Monte Carlo (HMC, [<xref ref-type="bibr" rid="pcbi.1005292.ref029">29</xref>]), which uses the gradient of the log-probability to produce efficient proposals with high acceptance probability. HMC runs a short molecular dynamics (MD) simulation to efficiently produce proposal conformations of the chromosome.</p>
<p>Three parameters have to be set when using HMC for sampling. First, since HMC introduces fictitious momenta for each conformational degree of freedom, a mass matrix has to be specified. Second, the equations of motion solved during the short MD simulation are usually not analytically integrable and have to be solved by numerical integration schemes that require a discretization timestep. Third, the length of the MD trajectory needs to be chosen.</p>
<p>Rules-of-thumb to set these parameters exist [<xref ref-type="bibr" rid="pcbi.1005292.ref047">47</xref>], but require previous knowledge about the sampled probability distribution. We thus resort to heuristics. We set the mass matrix to unity, the trajectory length to 250 MD steps and determine an integration timestep such that an average acceptance rate of 50% is achieved.</p>
</sec>
<sec id="sec022">
<title>Sampling of model parameters</title>
<p><italic><monospace>Sampling the distance scaling factor.</monospace></italic> If we model the Hi-C contacts as distances, we need to estimate an unknown scaling factor γ that relates the experimental distance to the bead diameter: <italic>δ</italic> = <italic>a</italic>/γ. Because the distance scale is a positive quantity, we use a Jeffreys’ prior for γ (i.e. the prior over the distance scale is uniform in logγ). When using the Gaussian error model with a flat plateau, the one-dimensional sampling distribution for γ is of a non-standard form; we employ the Metropolis-Hastings algorithm to sample this parameter from its posterior distribution. In the case of the lognormal error model, the sampling distribution for γ is a lognormal distribution, from which sampling can be performed by using built-in random number generators.</p>
<p><italic><monospace>Sampling of error parameters.</monospace></italic> How error parameters are best sampled again depends on the error model. For the lognormal error model, the conditional distribution of the data weight <italic>w</italic> = <italic>σ</italic><sup>−2</sup> is a Gamma distribution for which sampling routines are readily available in many programming languages. In case of the Gaussian error model with a flat plateau, we use the Metropolis-Hastings algorithm to generate samples of <italic>σ</italic>.</p>
</sec>
<sec id="sec023">
<title>Replica exchange Monte Carlo</title>
<p>Because the Gibbs sampler (<xref ref-type="disp-formula" rid="pcbi.1005292.e030">Eq 16</xref>) can get trapped in a peak of the posterior distribution, we embed the Gibbs sampler in a replica exchange (RE) algorithm [<xref ref-type="bibr" rid="pcbi.1005292.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref031">31</xref>]. RE introduces a fictitious temperature λ<sup>−1</sup> that facilitates posterior sampling. A family of tempered posteriors is introduced:
<disp-formula id="pcbi.1005292.e031"><alternatives><graphic id="pcbi.1005292.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>λ</mml:mo></mml:msup> <mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>|</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula>
We let the inverse temperature λ vary from 0 (prior) to 1 (posterior). The λ-schedule is designed such that with increasing replica index, the likelihood is more and more downweighted, that is, in the “high-temperature” replicas, there is only a weak influence of the data and the prior distributions dominate. This prevents the simulation from getting trapped in high-probability regions, but typically requires parallel computing resources.</p>
</sec>
</sec>
<sec id="sec024">
<title>Model comparison and estimation of marginal likelihoods</title>
<p>The normalizing constant Pr(<italic>D</italic>|<italic>I</italic>) in <xref ref-type="disp-formula" rid="pcbi.1005292.e012">Eq 2</xref> is the marginal likelihood or <italic>model evidence</italic>. It is generally hard to calculate Pr(<italic>D</italic>|<italic>I</italic>), which is a high-dimensional integral over all unknown parameters <italic>X</italic> and <italic>θ</italic>. A great advantage of MCMC methods is that they can sample from <italic>unnormalized</italic> probability distributions. Therefore, the evidence Pr(<italic>D</italic>|<italic>I</italic>) does not need to be known when applying MCMC to sample from the ISD posterior. Although knowledge of Pr(<italic>D</italic>|<italic>I</italic>) is not necessary for parameter estimation (i.e. sampling of <italic>X</italic> and <italic>θ</italic>), the model evidence is crucial, if we want to do <italic>model comparison</italic>, i.e. if we want to quantify, for example, if the chromatin beads should exhibit only repulsive forces or both repulsive and attractive forces. The model evidence Pr(<italic>D</italic>|<italic>I</italic>) reflects how well the chosen likelihood and prior distributions describe the Hi-C data <italic>D</italic> and allows us to rank different modeling assumptions in the light of the data. To calculate the evidence, we use histogram reweighting techniques [<xref ref-type="bibr" rid="pcbi.1005292.ref048">48</xref>–<xref ref-type="bibr" rid="pcbi.1005292.ref050">50</xref>], which allow to use all samples from a RE simulation to estimate the model evidence in replica with high accuracy.</p>
<p>We used similar techniques to study the properties of the chromosome model (see Chromosome models). Because the prior alone prefers extended chromosome conformations, we imposed an additional radius of gyration term whose strength is varied smoothly via the inverse temperature λ of the replicas:
<disp-formula id="pcbi.1005292.e032"><alternatives><graphic id="pcbi.1005292.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>|</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>{</mml:mo> <mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi mathvariant="normal">g</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>bb</mml:mtext></mml:msub> <mml:msub><mml:mi>E</mml:mi> <mml:mtext>bb</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>nb</mml:mtext></mml:msub> <mml:msub><mml:mi>E</mml:mi> <mml:mtext>nb</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
This RE simulation allowed us to explore all degrees of compactness of the chromatin fiber by varying λ between λ = 0 and λ = 500 using 64 replicas. The same histogram reweighting techniques that we used to calculate model evidences allowed us to obtain a precise estimate of the entropy as a function of <italic>R</italic><sub>g</sub>. The entropy measures the number of conformations with a certain radius of gyration and is shown in <xref ref-type="fig" rid="pcbi.1005292.g001">Fig 1A</xref>.</p>
</sec>
<sec id="sec025">
<title>Analysis of structure ensembles</title>
<p>Structure ensembles reconstructed from single-cell Hi-C contacts are typically less well defined than NMR structure ensembles. Therefore traditional measures to characterize and compare structure ensembles such as RMSDs are of limited use.</p>
<sec id="sec026">
<title>Comparison of distance matrices</title>
<p>The structural properties of an ensemble of chromosome conformations can be assessed by analyzing the distances matrices computed for all members of the ensemble. This does not require a structural superposition of the ensemble members and also works in the presence of mirror images. We mainly use the sample mean and standard deviation over all distances matrices from one ensemble for comparison with another ensemble. More formally, let a posterior ensemble contain <italic>M</italic> chromosome structures <inline-formula id="pcbi.1005292.e033"><alternatives><graphic id="pcbi.1005292.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn> <mml:mi>m</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>n</mml:mi> <mml:mi>m</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with <italic>m</italic> = 1, …, <italic>M</italic>. We first calculate the distance matrix <italic>D</italic><sub><italic>m</italic></sub> for every ensemble member. The elements of <italic>D</italic><sub><italic>m</italic></sub> are:
<disp-formula id="pcbi.1005292.e034"><alternatives><graphic id="pcbi.1005292.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfenced close="∥" open="∥" separators=""><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mi>m</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>j</mml:mi> <mml:mi>m</mml:mi></mml:msubsup></mml:mfenced> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
We compute the entry-wise arithmetic means and standard deviations by
<disp-formula id="pcbi.1005292.e035"><alternatives><graphic id="pcbi.1005292.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mrow><mml:mover><mml:mi>D</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>M</mml:mi></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover></mml:mstyle> <mml:msub><mml:mi>D</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mspace width="4pt"/><mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>σ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>M</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mover><mml:mi>D</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></disp-formula>
where the squaring and the square-root are understood as element-wise operations.</p>
<p>For a pair of beads <italic>i</italic> and <italic>j</italic> that show an experimental contact, we expect that the entries of the average distance matrix <inline-formula id="pcbi.1005292.e036"><alternatives><graphic id="pcbi.1005292.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mover><mml:mi>D</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> that are close to (<italic>i</italic>, <italic>j</italic>) are small compared to the average distance between pairs for which no contact was observed. The standard deviation <italic>σ</italic>(<italic>D</italic>) indicates how well the distance between all pairs of beads is determined by the data and the prior information. In regions without any data, for example beads close to the centromere, we expect a high standard deviation.</p>
</sec>
<sec id="sec027">
<title>Diagonal permutation test on distance matrix correlations</title>
<p>The agreement of two structure ensembles can be assessed by comparing the corresponding average distances matrices. The cross-correlation coefficient of two distance matrices provides a measure of the similarity of the structure ensembles, but since the entries in the distance matrices are highly dependent, it is unclear if the correlation is statistically significant. The Mantel test [<xref ref-type="bibr" rid="pcbi.1005292.ref051">51</xref>, <xref ref-type="bibr" rid="pcbi.1005292.ref052">52</xref>] aims to assess the statistical significance of the correlation between two distance matrices. The Mantel test relies on random permutations of rows (and corresponding columns) of one matrix to generate null models whose correlation with the other matrix is calculated. From the resulting set of correlations, a P-value is derived. The P-value indicates how likely it is to obtain the correlation coefficient between the original matrices by chance. However, recently Guillot <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref053">53</xref>] showed that the Mantel test is only of limited use, because permutations of rows and columns destroy the autocorrelation within a matrix, which results in an underestimation of the P-value. Underwood <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005292.ref054">54</xref>] proposed a diagonal permutation test which permutes matrix entries only within the diagonal they are part of. In our context, this procedure boils down to permuting entries only within the set of pairwise distances between beads with a genomic distance of at most <italic>i</italic> beads. Sequential correlations are preserved by this permutation procedure, which allows us to compute meaningful P-values. All reported correlations between average distance matrices are significant with at most <italic>p</italic> &lt; 0.0001 (based on 10<sup>4</sup> random shufflings of one of the distance matrices). <xref ref-type="supplementary-material" rid="pcbi.1005292.s018">S14 Fig</xref> confirms that the cross-correlation between two distance matrices is indeed an adequate measure of structural similarity.</p>
</sec>
<sec id="sec028">
<title>Cluster analysis</title>
<p>Structural ensembles were clustered using spectral clustering [<xref ref-type="bibr" rid="pcbi.1005292.ref055">55</xref>]. For every pair of chromosome conformations in the ensemble we computed the standard RMSD (excluding the unmappable regions). The RMSD matrix was then transformed to a similarity matrix using an exponential transform, i.e.
<disp-formula id="pcbi.1005292.e037"><alternatives><graphic id="pcbi.1005292.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005292.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mo>-</mml:mo> <mml:mi>β</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>R</italic><sub><italic>ij</italic></sub> is the RMSD between conformations <italic>i</italic> and <italic>j</italic>, <italic>β</italic> &gt; 0 is a scaling factor which we set to <italic>β</italic> = 1/<italic>a</italic>. We run spectral clustering for various choices of the number <italic>K</italic> of clusters. The clustering that achieves the highest silhouette score [<xref ref-type="bibr" rid="pcbi.1005292.ref056">56</xref>] is then inspected further.</p>
</sec>
</sec>
<sec id="sec029">
<title>Test calculations for a three-dimensional Hilbert curve</title>
<p>To validate our structure calculation method, we ran several test calculations for a three-dimensional Hilbert curve comprised of 512 beads. We assumed a cutoff distance of 1.5 × bead radius, which resulted in a maximum of 3696 contacts (∼2.8% of the full distance matrix, which has 512 × 511/2 = 130816 elements in total).</p>
<p>With the complete set of observable contacts, we obtained an ensemble that comprised two principal conformers which are mirror images of each other. The first cluster shows an average RMSD of 0.09 bead radii from the correct model and is populated by 48% of all sampled structures. The second cluster achieves the same RMSD to the mirror image of the ground truth and is populated by the remaining 52% of all structures. This shows that ISD is capable of drawing correct samples from the posterior distribution: Distance data alone cannot distinguish between a 3D structure and its mirror image. Therefore, we expect that the original structure of the Hilbert curve and its mirror image should be present in the ISD ensemble with identical probability.</p>
<p>We also computed structures with sparsified versions of the full set of contacts by randomly selecting a smaller number of contacts. In the sparsified data sets, the number of contacts ranged from 3326 to 578 contacts corresponding to 2.8% to 0.44% of all distances (the sparsity of the contact data in case of the ISD bead model of the X chromosome at 500 kb resolution is 0.68%). For all data sets, we obtained an ensemble of structures that comprised two major conformers: an approximate version of the input structure and its mirror image. The average structures of both clusters are shown in <xref ref-type="supplementary-material" rid="pcbi.1005292.s015">S11 Fig</xref>. Even with as few as 0.44% of all distances, ISD inferred structures that showed the correct domain architecture. The RMSD ranged from 0.13 to 1.46 bead radii for both the cluster approximating the ground truth and the cluster showing its mirror image (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s016">S12A and S12B Fig</xref>). Also the spread and population of the clusters were almost identical (<xref ref-type="supplementary-material" rid="pcbi.1005292.s016">S12C and S12D Fig</xref>).</p>
<p>These tests show that (1) ISD is capable of generating statistically valid ensembles, which is indicated by the fact that we obtained a bimodal posterior ensemble, in which the peaks corresponding to the original structure and its mirror image have identical spread and population (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s016">S12 Fig</xref>). (2) ISD generates structure ensembles that reflect the quality/completeness of the data, because the precision of the ensemble decreases with increasing sparsity of the contact data (see <xref ref-type="supplementary-material" rid="pcbi.1005292.s016">S12C and S12D Fig</xref>).</p>
</sec>
<sec id="sec030">
<title>Comparison with existing methods for chromosome structure inference</title>
<p>To better judge the performance of ISD, we also computed structural models with other methods for chromosome structure inference for the Hilbert curve data.</p>
<sec id="sec031">
<title>Shortest-path reconstruction in 3D (ShRec3D)</title>
<p>We implemented the ShRec3D [<xref ref-type="bibr" rid="pcbi.1005292.ref019">19</xref>] algorithm in Python and applied it to the Hilbert curve data. With the complete set of observable contacts (3696 contacts, 2.8% of all distances) ShRec3D obtained a structure of reasonable accuracy with an RMSD of 0.53 bead radii to the ground truth. However, with increasing sparsity of the contact data the structure becomes increasingly inaccurate (see <xref ref-type="fig" rid="pcbi.1005292.g008">Fig 8A</xref>). At the sparsity level of the single-cell Hi-C data by Nagano <italic>et al.</italic> at 500 kb resolution (0.68% of all distances) the RMSD is 1.8 bead radii (for comparison, ISD achieves an RMSD of 0.9 bead radii).</p>
<fig id="pcbi.1005292.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005292.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Comparison of ISD to existing methods for chromosome structure inference from single-cell Hi-C data.</title>
<p>ShRec3D, MBO and the simulated annealing procedure (SA) by Nagano <italic>et al.</italic> (two versions of SA were tested: a long version based on the default annealing protocol and a short version with ten-fold faster annealing). <bold>(A)</bold>: Accuracy (RMSD to ground truth) achieved with all four methods. <bold>(B)</bold>: Precision (spread of structural ensemble) for MBO, SA and ISD (ShRec3D produces only a single model, therefore it is not possible to assess the precision of the ShRec3D model). Both accuracy and precision are quantified by RMSDs and increase when the RMSDs decrease.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.g008" xlink:type="simple"/>
</fig>
<p>An advantage of embedding algorithms such as ShRec3D is that the structural model is obtained by computing an eigendecomposition, which is very fast. However, the speed of the method comes at the prize of being quite restrictive in the prior assumptions that can be imposed on the chromosome fiber. Another serious limitation is that only a single structure is obtained (modulo reflections and rigid transformations). Therefore, it is not possible to make statements about the precision of the reconstructed chromosome structure.</p>
</sec>
<sec id="sec032">
<title>Manifold-based optimization (MBO)</title>
<p>Manifold-based optimization (MBO) [<xref ref-type="bibr" rid="pcbi.1005292.ref020">20</xref>] can be viewed as a refined and more robust version of ShRec3D. MBO produces reconstructions of the Hilbert curve that are systematically more accurate than the models produced by ShRec3D (see <xref ref-type="fig" rid="pcbi.1005292.g008">Fig 8A</xref>). However, the structures found by ISD are still more accurate than the MBO models for most data sets. Only for the most complete data set (100% of all contacts, 2.8% of all distances), MBO produces a slightly more accurate model of the Hilbert curve with an RMSD of 0.05 bead radii, whereas the ISD structure achieves an RMSD of 0.09 bead radii. For all other data sets, ISD produces a more accurate model of the Hilbert curve.</p>
<p>In contrast to classical MDS, the optimization problem that MBO solves is no longer convex due to a rank constraint, which guarantees that the solutions live in 3D space. As a consequence, there are multiple minima which the optimizer locates. By running the optimization procedure multiple times from randomized initial structures, MBO produces a set of possible chromosome structures. However, the MBO ensemble does not have the same statistical foundation as the ISD ensemble. Because ISD uses a sampling algorithm to explore the posterior distribution, it produces a faithful representation of the information content of the data. This is reflected by a high correlation between the <italic>precision</italic> of the ensemble as measured by the average RMSD to the average structure and the <italic>accuracy</italic> (RMSD between ground truth and average structure), which reaches 99.7% in case of the ISD ensemble and drops to 86.3% for MBO.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005292.g008">Fig 8B</xref> also shows that the absolute value of the spread of the MBO ensemble totally underestimates the inaccuracy of the structure. For data sets that do not suffer too much from a lack of data (number of observed contacts &gt; 1% of all distances), there is almost no variability in the MBO ensemble (the ensemble spread is ∼10<sup>−4</sup> bead radii): MBO is over confident about the reliability of the chromosome structure. The reason is that at this moderate level of data sparsity the optimization problem is still well-defined, such that the optimizer always finds the same minimum structure (and its mirror image). As the completeness of the data dwindles, MBO starts to produce slightly more heterogeneous ensembles, but the ensemble spread is still more than an order of magnitude smaller than the accuracy. For the sparsest data set (0.44% of all distances), the spread of the MBO ensemble is still only 0.14 bead radii. Therefore, the spread of the MBO ensemble is not a meaningful indicator of the reliability of the reconstructed chromosome structure and seems to mostly reflect the difficulty of the optimization problem. The spread of the ISD ensemble, on the other hand, gives a reasonable estimate of the true accuracy of the ensemble.</p>
</sec>
<sec id="sec033">
<title>Simulated annealing approach by Nagano <italic>et al.</italic> (SA)</title>
<p>We also applied the simulated annealing approach by [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>] to the Hilbert curve data. We tested two versions of the SA approach: one using the default temperature schedule and a second simulation with a 10-fold faster annealing protocol. With sparse contact data, both versions of SA achieve a similar accuracy as MBO (see <xref ref-type="fig" rid="pcbi.1005292.g008">Fig 8A</xref>). With more complete data, SA performs similar to ShRec3D. For all data sets, both versions of SA are systematically less accurate than ISD. Similar to ISD and MBO, SA finds both the input Hilbert curve and the mirror image with equal probability.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005292.g008">Fig 8B</xref> shows that the precision of the SA ensembles is a good indicator of the reliability of the reconstructed structure. However, the exact spread of the SA ensemble depends on the length of the annealing schedule. With the 10-fold longer schedule, the SA ensembles are systematically tighter than with the short schedule. The reason is that SA is an optimization method that aims to locate the minimum of the objective function and not to adequately represent the uncertainty of the structure. With a longer annealing schedule, the chance of finding a structure that is close to the minimum increases, and thus the spread of the ensemble decreases. Therefore, the precision of SA ensemble does not only reflect the quality of the data, but is to some extent also determined by the computational effort that is spent on the minimization.</p>
</sec>
<sec id="sec034">
<title>Computation times</title>
<p>One great advantage of embedding methods is that they are many orders of magnitude faster than a full ISD simulation. To give a rough estimate: A single HMC proposal generated by a trajectory of 250 MD steps takes ∼70% of the computation time of running ShRec3D. A typical ISD simulation consists of 50 replicas each of which executes many HMC sampling steps (10 × 250 MD steps between two replica transitions). We typically sample 1000 replica transitions, which amounts to a total number of 50 × 10 × 250 × 1000 = 1.25 × 10<sup>8</sup> gradient evaluations / MD steps. On a single CPU this would take approximately 3.5 × 10<sup>5</sup> the running time of ShRec3D. However, one has to keep in mind that running ShRec3D takes less than half a second at 500 kb resolution. Moreover, convergence of the replica simulation is usually very fast (in the order of 20 to 50 replica transitions), such that on a computer cluster a full ISD calculation can be run in one or two hours. If one is only interested in a single structure and does not aim to sample the posterior distribution exhaustively, structural models can be obtained by running only the HMC algorithm (without the overhead introduced by parallel tempering / replica exchange simulation), which takes only a few minutes and is of similar speed as the SA implementation by Nagano <italic>et al</italic>. A table listing the computation times for the different modes of running ISD can be found in <xref ref-type="supplementary-material" rid="pcbi.1005292.s019">S4 Table</xref>.</p>
</sec>
</sec>
<sec id="sec035">
<title>Software</title>
<p>Simulations were performed using an extended version of the ISD library [<xref ref-type="bibr" rid="pcbi.1005292.ref057">57</xref>]. Analyses were carried out with Python scripts that rely only on widely used additional packages and the CSB toolbox [<xref ref-type="bibr" rid="pcbi.1005292.ref058">58</xref>]. Code and scripts for analysis are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/michaelhabeck/isdhic" xlink:type="simple">https://github.com/michaelhabeck/isdhic</ext-link>.</p>
</sec>
</sec>
<sec id="sec036">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005292.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Comparison of distance matrices for different prior distributions.</title>
<p>Pooled histogram of all distances involved in an experimentally observed contact <bold>(A,D,G,J)</bold>, average distance matrices <bold>(B,E,H,K)</bold> and standard deviations <bold>(C,F,I,L)</bold> for the contact model combined with various prior probabilities. <bold>(A,B,C)</bold> repulsive volume exclusion term; <bold>(D,E,F)</bold> repulsive term and FISH data; <bold>(G,H,I)</bold> Lennard-Jones potential; <bold>(J,K,L)</bold> Lennard-Jones potential and FISH data.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s002" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Estimated model evidence.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Pooled histogram of all distances involved in an experimentally observed contact.</title>
<p><bold>(A)</bold> contact model; <bold>(B)</bold> Gaussian with flat plateau; <bold>(C)</bold> lognormal model.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Relation between the weight of the lognormal restraint <italic>w</italic> = <italic>σ</italic><sup>−2</sup> and the estimated distance scale γ.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s005" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Full inference of distance-based models.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s006" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Cluster analysis of the ISD ensemble.</title>
<p>For details see caption of <xref ref-type="supplementary-material" rid="pcbi.1005292.s007">S5 Fig</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s007" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Cluster analysis of the ensemble calculated by [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>].</title>
<p><bold>(A)</bold> The left heatmap shows the raw RMSD matrix for all 200 ensemble members (blue: small pairwise RMSD, red: large pairwise RMSD). The right heatmap shows the same matrix with sorted rows and columns according to cluster membership where the clusters themselves are sorted by cluster size. Homogeneous blue squares along the diagonal indicate that the clusters are well defined and tighter than the off-diagonal rectangles whose color tends towards red, if the clustering is well-defined (high silhouette score). The ensemble is comprised of four principal clusters of approximately equal size (populations: 28, 26, 24, and 24%). The color bar indicates the RMSD in microns. <bold>(B)</bold> Silhouette score as a function of the number of clusters. <bold>(C)</bold> Members of the four clusters are shown in the top row (blue centromere to red telomere). The bottom row show tube representations of the cluster centers. The tube thickness indicates the positional uncertainty of the corresponding beads.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s008" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Correlation between average distance matrices for six Th1 cells.</title>
<p>Shown are the correlation coefficients between the average distance matrices (in %) for structure ensembles obtained from cell 1 to cell 6. Lower diagonal: ISD ensemble vs ISD ensemble. Upper diagonal: ISD ensemble vs ensemble by Nagano <italic>et al.</italic> Diagonal (shown in bold face): ISD ensemble vs ensemble by Nagano <italic>et al.</italic></p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s009" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Restraint violations in six Th1 cells.</title>
<p>Percentage of restraints from different cells (columns) that are violated in structure ensembles (rows) with a tolerance of <italic>a</italic>/8.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s010" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Average distance matrices calculated from structure ensembles reconstructed from six Th1 cells.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s011" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s011" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Average X-chromosome structures from structure ensembles reconstructed from six Th1 cells.</title>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s012" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Comparison of population Hi-C maps with contact frequencies derived from the ISD ensemble.</title>
<p>Left: population Hi-C map from [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>]. Right: Contact frequencies derived from the ISD ensemble based on single-cell data from cell 1.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s013" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Spatial distribution of epigenetic marks in the X chromosome.</title>
<p>The cumulative number of <italic>trans</italic>-chromosomal contacts <bold>(A)</bold>, lamin B1 <bold>(B)</bold> interaction scores, H3K4me3 <bold>(C)</bold> and gene density <bold>(D)</bold> are calculated as a function of depth for the prior ensemble based on chain connectivity, volume exclusion and the radius of gyration term (blue histogram) and the posterior ensemble incorporating the contact restraints (red histogram). Lamin B1 scores, H3K4me3 and gene density were obtained from the Supplementary Data in Nagano et al. [<xref ref-type="bibr" rid="pcbi.1005292.ref011">11</xref>].</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s014" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Average distance matrices calculated from structure ensembles reconstructed at 50 kb (A) and 500 kb resolution (B).</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s015" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s015" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Average structures of the 512-Hilbert curve reconstructed from incomplete contact information.</title>
<p>Top two rows show the original structure <bold>(A)</bold> and conformers inferred from contact data of different levels of sparsity <bold>(B-H)</bold>. Corresponding mirror images are shown in the bottom rows <bold>(I-P)</bold>. In all cases, both conformers are almost equally populated. Number of contacts used in reconstruction 3696 <bold>(B,J)</bold>, 3326 <bold>(C,K)</bold>, 1848 <bold>(D,L)</bold>, 1478 <bold>(E,M)</bold>, 1108 <bold>(F,N)</bold>, 889 <bold>(G,O)</bold>, 578 <bold>(H,P)</bold>.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s016" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s016" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Accuracy and precision of the ISD ensemble as a function of the completeness of the input data.</title>
<p>Tests were run on the 512-Hilbert curve with dwindling number of input data. Each ISD ensemble comprised two major clusters corresponding to the input curve and its mirror image. For each cluster, the accuracy was assessed by computing the RMSD to the input structure <bold>(A)</bold> / its mirror image <bold>(B)</bold>. The precision or ensemble spread is defined as the average RMSD to the cluster center and shown in panels <bold>(C,D)</bold>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s017" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s017" xlink:type="simple">
<label>S13 Fig</label>
<caption>
<title>Disentangling mixed distance data from two protein structures.</title>
<p>Ubiquitin is shown in the left panels, the HRDC domain is shown in the right panels. The top row shows the average bead models obtained from the mixed set of distances. The bottom row shows the average bead models obtained from mixed sets of sparse contacts. Ubiquitin models obtained with distance / sparse contact information are shown in panels <bold>(A)</bold> and <bold>(E)</bold>. The ground truth is shown in panels <bold>(B)</bold> and <bold>(F)</bold>. Models of the HRDC domain obtained with distance / sparse contact information are shown in panels <bold>(C)</bold> and <bold>(G)</bold>. The ground truth is shown in panels <bold>(D)</bold> and <bold>(H)</bold>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s018" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s018" xlink:type="simple">
<label>S14 Fig</label>
<caption>
<title>Significance of distance correlations.</title>
<p>Structure ensembles were calculated with a reduced set of contacts where the <italic>n</italic> longest range contacts have been ignored. The ISD ensembles based on the reduced set of data were compared with the ensemble obtained with the full data set to study the robustness of the ISD approach and the significance of the distance correlations. <bold>(A)</bold> Cross-correlation between average distance matrices as a function of the number of missing long-range contacts. <bold>(B)</bold> RMSD between the average structures of the ensemble obtained with all contacts and reduced number of contacts. <bold>(C)</bold> Correlation between correlation of distance matrices and RMSD.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005292.s019" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005292.s019" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Computation times.</title>
<p>Tests for the calculation of a single structure were done on a standard laptop with 2.90GHz Core i7 8-core processor with 16 GB memory. At a resolution of 500 kb, the test consisted of 1000 steps of HMC starting from an extended structure. At a resolution 50 kb, 10000 steps of HMC were run starting from an extended structure. To compute the posterior ensemble of the X chromosome, we ran the replica-exchange algorithm on a computer cluster using 50 CPUs. At a resolution of 500 kb, we simulated 200 replica transitions where each transition consisted of 10 steps of HMC each using 250 leapfrog integration steps. At a resolution of 50 kb, we ran 1000 replica transitions on 50 CPUs. It is possible to shortcut the computation of the high-resolution structure by starting from a low resolution model. The initial structure of the high-resolution model is obtained by using a 3D spline interpolation with 10-fold higher sampling. For the single structure calculation, it is sufficient to reduce the number of HMC steps to 1000. In case of the replica simulation, the correct ensemble is obtained after 200 replica transitions. The corresponding computation times are indicated by “500 kb + 50 kb” in the S4 Table.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Ernest Laue and Tim Stevens (University of Cambridge) for useful discussions and sharing data. We also thank Jonas Paulsen (University of Oslo) for help with the MBO code.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005292.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dekker</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rippe</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dekker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kleckner</surname> <given-names>N</given-names></name>. <article-title>Capturing Chromosome Conformation</article-title>. <source>Science</source>. <year>2002</year>;<volume>295</volume>(<issue>5558</issue>):<fpage>1306</fpage>–<lpage>1311</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1067799" xlink:type="simple">10.1126/science.1067799</ext-link></comment> <object-id pub-id-type="pmid">11847345</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Simonis</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Klous</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Splinter</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Moshkin</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Willemsen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>de Wit</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Nuclear organization of active and inactive chromatin domains uncovered by chromosome conformation capture-on-chip (4C)</article-title>. <source>Nat Genet</source>. <year>2006</year>;<volume>38</volume>(<issue>11</issue>):<fpage>1348</fpage>–<lpage>1354</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng1896" xlink:type="simple">10.1038/ng1896</ext-link></comment> <object-id pub-id-type="pmid">17033623</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Tavoosidana</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sjolinder</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gondor</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mariano</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Circular chromosome conformation capture (4C) uncovers extensive networks of epigenetically regulated intra- and interchromosomal interactions</article-title>. <source>Nat Genet</source>. <year>2006</year>;<volume>38</volume>(<issue>11</issue>):<fpage>1341</fpage>–<lpage>1347</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng1891" xlink:type="simple">10.1038/ng1891</ext-link></comment> <object-id pub-id-type="pmid">17033624</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dostie</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Richmond</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Arnaout</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Selzer</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>WL</given-names></name>, <name name-style="western"><surname>Honan</surname> <given-names>TA</given-names></name>, <etal>et al</etal>. <article-title>Chromosome Conformation Capture Carbon Copy (5C): A massively parallel solution for mapping interactions between genomic elements</article-title>. <source>Genome Research</source>. <year>2006</year>;<volume>16</volume>(<issue>10</issue>):<fpage>1299</fpage>–<lpage>1309</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.5571506" xlink:type="simple">10.1101/gr.5571506</ext-link></comment> <object-id pub-id-type="pmid">16954542</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lieberman-Aiden</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>van Berkum</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Imakaev</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ragoczy</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Telling</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Comprehensive Mapping of Long-Range Interactions Reveals Folding Principles of the Human Genome</article-title>. <source>Science</source>. <year>2009</year>;<volume>326</volume>(<issue>5950</issue>):<fpage>289</fpage>–<lpage>293</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1181369" xlink:type="simple">10.1126/science.1181369</ext-link></comment> <object-id pub-id-type="pmid">19815776</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cremer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cremer</surname> <given-names>M</given-names></name>. <article-title>Chromosome Territories</article-title>. <source>Cold Spring Harbor Perspectives in Biology</source>. <year>2010</year>;<volume>2</volume>(<issue>3</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/cshperspect.a003889" xlink:type="simple">10.1101/cshperspect.a003889</ext-link></comment> <object-id pub-id-type="pmid">20300217</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kalhor</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Tjong</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Jayathilaka</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Alber</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>L</given-names></name>. <article-title>Genome architectures revealed by tethered chromosome conformation capture and population-based modeling</article-title>. <source>Nat Biotech</source>. <year>2012</year>;<volume>30</volume>(<issue>1</issue>):<fpage>90</fpage>–<lpage>98</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2057" xlink:type="simple">10.1038/nbt.2057</ext-link></comment> <object-id pub-id-type="pmid">22198700</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dixon</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Selvaraj</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yue</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>. <source>Nature</source>. <year>2012</year>;<volume>485</volume>(<issue>7398</issue>):<fpage>376</fpage>–<lpage>380</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11082" xlink:type="simple">10.1038/nature11082</ext-link></comment> <object-id pub-id-type="pmid">22495300</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nora</surname> <given-names>EP</given-names></name>, <name name-style="western"><surname>Lajoie</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Schulz</surname> <given-names>EG</given-names></name>, <name name-style="western"><surname>Giorgetti</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Okamoto</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Servant</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Spatial partitioning of the regulatory landscape of the X-inactivation centre</article-title>. <source>Nature</source>. <year>2012</year>;<volume>485</volume>(<issue>7398</issue>):<fpage>381</fpage>–<lpage>385</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11049" xlink:type="simple">10.1038/nature11049</ext-link></comment> <object-id pub-id-type="pmid">22495304</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sexton</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yaffe</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kenigsberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bantignies</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Leblanc</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hoichman</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Three-Dimensional Folding and Functional Organization Principles of the Drosophila Genome</article-title>. <source>Cell</source>. <year>2012</year>;<volume>148</volume>(<issue>3</issue>):<fpage>458</fpage>–<lpage>472</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2012.01.010" xlink:type="simple">http://dx.doi.org/10.1016/j.cell.2012.01.010</ext-link>. <object-id pub-id-type="pmid">22265598</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nagano</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lubling</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Stevens</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Schoenfelder</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yaffe</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dean</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Single-cell Hi-C reveals cell-to-cell variability in chromosome structure</article-title>. <source>Nature</source>. <year>2013</year>;<volume>502</volume>(<issue>7469</issue>):<fpage>59</fpage>–<lpage>64</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12593" xlink:type="simple">10.1038/nature12593</ext-link></comment> <object-id pub-id-type="pmid">24067610</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Duan</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Andronescu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schutz</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>McIlwain</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>YJ</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A three-dimensional model of the yeast genome</article-title>. <source>Nature</source>. <year>2010</year>;<volume>465</volume>(<issue>7296</issue>):<fpage>363</fpage>–<lpage>367</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08973" xlink:type="simple">10.1038/nature08973</ext-link></comment> <object-id pub-id-type="pmid">20436457</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baù</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sasnyal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lajoie</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Capriotti</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Byron</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>JB</given-names></name>, <etal>et al</etal>. <article-title>The three-dimensional folding of the <italic>α</italic>-globin gene domain reveals formation of chromatin globules</article-title>. <source>Nature structural &amp; molecular biology</source>. <year>2011</year>;<volume>18</volume>(<issue>1</issue>):<fpage>107</fpage>–<lpage>114</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nsmb.1936" xlink:type="simple">10.1038/nsmb.1936</ext-link></comment> <object-id pub-id-type="pmid">21131981</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Russel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lasker</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Webb</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Velázquez-Muriel</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tjioe</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Schneidman-Duhovny</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Putting the Pieces Together: Integrative Modeling Platform Software for Structure Determination of Macromolecular Assemblies</article-title>. <source>PLoS Biol</source>. <year>2012</year>;<volume>10</volume>(<issue>1</issue>):<fpage>e1001244</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1001244" xlink:type="simple">10.1371/journal.pbio.1001244</ext-link></comment> <object-id pub-id-type="pmid">22272186</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Varoquaux</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ay</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Noble</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Vert</surname> <given-names>JP</given-names></name>. <article-title>A statistical approach for inferring the 3D structure of the genome</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>12</issue>):<fpage>i26</fpage>–<lpage>i33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu268" xlink:type="simple">10.1093/bioinformatics/btu268</ext-link></comment> <object-id pub-id-type="pmid">24931992</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>ZZ</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Toh</surname> <given-names>KC</given-names></name>, <name name-style="western"><surname>Sung</surname> <given-names>WK</given-names></name>. <article-title>3D chromosome modeling with semi-definite programming and Hi-C data</article-title>. <source>Journal of computational biology</source>. <year>2013</year>;<volume>20</volume>(<issue>11</issue>):<fpage>831</fpage>–<lpage>846</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2013.0076" xlink:type="simple">10.1089/cmb.2013.0076</ext-link></comment> <object-id pub-id-type="pmid">24195706</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trieu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>J</given-names></name>. <article-title>Large-scale reconstruction of 3D structures of human chromosomes from chromosomal contact data</article-title>. <source>Nucleic acids research</source>. <year>2014</year>;<volume>42</volume>(<issue>7</issue>):<fpage>e52</fpage>–<lpage>e52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt1411" xlink:type="simple">10.1093/nar/gkt1411</ext-link></comment> <object-id pub-id-type="pmid">24465004</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wolynes</surname> <given-names>PG</given-names></name>. <article-title>Topology, structures, and energy landscapes of human chromosomes</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2015</year>;<volume>112</volume>(<issue>19</issue>):<fpage>6062</fpage>–<lpage>6067</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1506257112" xlink:type="simple">10.1073/pnas.1506257112</ext-link></comment> <object-id pub-id-type="pmid">25918364</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lesne</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Riposo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Roger</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cournac</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mozziconacci</surname> <given-names>J</given-names></name>. <article-title>3D genome reconstruction from chromosomal contacts</article-title>. <source>Nat Meth</source>. <year>2014</year>;<volume>11</volume>(<issue>11</issue>):<fpage>1141</fpage>–<lpage>1143</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3104" xlink:type="simple">10.1038/nmeth.3104</ext-link></comment> <object-id pub-id-type="pmid">25240436</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Paulsen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gramstad</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Collas</surname> <given-names>P</given-names></name>. <article-title>Manifold Based Optimization for Single-Cell 3D Genome Reconstruction</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>8</issue>):<fpage>e1004396</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004396" xlink:type="simple">10.1371/journal.pcbi.1004396</ext-link></comment> <object-id pub-id-type="pmid">26262780</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref021">
<label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Mishra B, Meyer G, Sepulchre R. Low-rank optimization for distance matrix completion. In: 2011 50th IEEE Conference on Decision and Control and European Control Conference. IEEE; 2011. p. 4455–4460.</mixed-citation>
</ref>
<ref id="pcbi.1005292.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rieping</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Habeck</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nilges</surname> <given-names>M</given-names></name>. <article-title>Inferential Structure Determination</article-title>. <source>Science</source>. <year>2005</year>;<volume>309</volume>(<issue>5732</issue>):<fpage>303</fpage>–<lpage>306</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1110428" xlink:type="simple">10.1126/science.1110428</ext-link></comment> <object-id pub-id-type="pmid">16002620</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Habeck</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rieping</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Nilges</surname> <given-names>M</given-names></name>. <article-title>Weighting of experimental evidence in macromolecular structure determination</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2006</year>;<volume>103</volume>(<issue>6</issue>):<fpage>1756</fpage>–<lpage>1761</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0506412103" xlink:type="simple">10.1073/pnas.0506412103</ext-link></comment> <object-id pub-id-type="pmid">16446450</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rousseau</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ferraiuolo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dostie</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Blanchette</surname> <given-names>M</given-names></name>. <article-title>Three-dimensional modeling of chromatin structure from interaction frequency data using Markov chain Monte Carlo sampling</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>414</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-414" xlink:type="simple">10.1186/1471-2105-12-414</ext-link></comment> <object-id pub-id-type="pmid">22026390</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Qin</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Dixon</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Selvaraj</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fang</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Bayesian Inference of Spatial Organizations of Chromosomes</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>e1002893</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002893" xlink:type="simple">10.1371/journal.pcbi.1002893</ext-link></comment> <object-id pub-id-type="pmid">23382666</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>J</given-names></name>. <article-title>Inferential modeling of 3D chromatin structure</article-title>. <source>Nucleic Acids Research</source>. <year>2015</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkv100" xlink:type="simple">10.1093/nar/gkv100</ext-link></comment> <object-id pub-id-type="pmid">25690896</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meluzzi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Arya</surname> <given-names>G</given-names></name>. <article-title>Recovering ensembles of chromatin conformations from contact probabilities</article-title>. <source>Nucleic Acids Research</source>. <year>2013</year>;<volume>41</volume>(<issue>1</issue>):<fpage>63</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks1029" xlink:type="simple">10.1093/nar/gks1029</ext-link></comment> <object-id pub-id-type="pmid">23143266</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Giorgetti</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Galupa</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Nora</surname> <given-names>EP</given-names></name>, <name name-style="western"><surname>Piolot</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lam</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Dekker</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Predictive Polymer Modeling Reveals Coupled Fluctuations in Chromosome Conformation and Transcription</article-title>. <source>Cell</source>. <year>2015</year>;<volume>157</volume>(<issue>4</issue>):<fpage>950</fpage>–<lpage>963</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2014.03.025" xlink:type="simple">10.1016/j.cell.2014.03.025</ext-link></comment> <object-id pub-id-type="pmid">24813616</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Duane</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kennedy</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Pendleton</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Roweth</surname> <given-names>D</given-names></name>. <article-title>Hybrid Monte Carlo</article-title>. <source>Physics Letters B</source>. <year>1987</year>;<volume>195</volume>(<issue>2</issue>):<fpage>216</fpage>–<lpage>222</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0370-2693(87)91197-X" xlink:type="simple">10.1016/0370-2693(87)91197-X</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Swendsen</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>JS</given-names></name>. <article-title>Replica Monte Carlo Simulation of Spin-Glasses</article-title>. <source>Phys Rev Lett</source>. <year>1986</year>;<volume>57</volume>:<fpage>2607</fpage>–<lpage>2609</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.57.2607" xlink:type="simple">10.1103/PhysRevLett.57.2607</ext-link></comment> <object-id pub-id-type="pmid">10033814</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Habeck</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nilges</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rieping</surname> <given-names>W</given-names></name>. <article-title>Replica-Exchange Monte Carlo Scheme for Bayesian Data Analysis</article-title>. <source>Phys Rev Lett</source>. <year>2005</year>;<volume>94</volume>:<fpage>018105</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.94.018105" xlink:type="simple">10.1103/PhysRevLett.94.018105</ext-link></comment> <object-id pub-id-type="pmid">15698139</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rieping</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Habeck</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nilges</surname> <given-names>M</given-names></name>. <article-title>Modeling Errors in NOE Data with a Log-normal Distribution Improves the Quality of NMR Structures</article-title>. <source>Journal of the American Chemical Society</source>. <year>2005</year>;<volume>127</volume>(<issue>46</issue>):<fpage>16026</fpage>–<lpage>16027</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ja055092c" xlink:type="simple">10.1021/ja055092c</ext-link></comment> <object-id pub-id-type="pmid">16287280</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Habeck</surname> <given-names>M</given-names></name>. <article-title>Statistical mechanics analysis of sparse data</article-title>. <source>J Struct Biol</source>. <year>2011</year>;<volume>173</volume>:<fpage>541</fpage>–<lpage>548</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jsb.2010.09.016" xlink:type="simple">10.1016/j.jsb.2010.09.016</ext-link></comment> <object-id pub-id-type="pmid">20869444</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mirny</surname> <given-names>LA</given-names></name>. <article-title>The fractal globule as a model of chromatin architecture in the cell</article-title>. <source>Chromosome research</source>. <year>2011</year>;<volume>19</volume>(<issue>1</issue>):<fpage>37</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10577-010-9177-0" xlink:type="simple">10.1007/s10577-010-9177-0</ext-link></comment> <object-id pub-id-type="pmid">21274616</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nilges</surname> <given-names>M</given-names></name>. <article-title>Calculation of Protein Structures with Ambiguous Distance Restraints. Automated Assignment of Ambiguous {NOE} Crosspeaks and Disulphide Connectivities</article-title>. <source>Journal of Molecular Biology</source>. <year>1995</year>;<volume>245</volume>(<issue>5</issue>):<fpage>645</fpage>–<lpage>660</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.1994.0053" xlink:type="simple">http://dx.doi.org/10.1006/jmbi.1994.0053</ext-link>. <object-id pub-id-type="pmid">7844833</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nilges</surname> <given-names>M</given-names></name>. <article-title>Ambiguous distance data in the calculation of {NMR} structures</article-title>. <source>Folding and Design</source>. <year>1997</year>;<volume>2</volume>, <issue>Supplement 1</issue>:<fpage>S53</fpage>–<lpage>S57</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1359-0278(97)00064-3" xlink:type="simple">http://dx.doi.org/10.1016/S1359-0278(97)00064-3</ext-link>. <object-id pub-id-type="pmid">9269569</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Madan Babu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Janga</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>de Santiago</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Pombo</surname> <given-names>A</given-names></name>. <article-title>Eukaryotic gene regulation in three dimensions and its impact on genome evolution</article-title>. <source>Current Opinion in Genetics &amp; Development</source>. <year>2008</year>;<volume>18</volume>(<issue>6</issue>):<fpage>571</fpage>–<lpage>582</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.gde.2008.10.002" xlink:type="simple">http://dx.doi.org/10.1016/j.gde.2008.10.002</ext-link>. <object-id pub-id-type="pmid">19007886</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Parada</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Misteli</surname> <given-names>T</given-names></name>. <article-title>Chromosome positioning in the interphase nucleus</article-title>. <source>Trends in cell biology</source>. <year>2002</year>;<volume>12</volume>(<issue>9</issue>):<fpage>425</fpage>–<lpage>432</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0962-8924(02)02351-6" xlink:type="simple">10.1016/S0962-8924(02)02351-6</ext-link></comment> <object-id pub-id-type="pmid">12220863</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bolzer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kreth</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Solovei</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Koehler</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Saracoglu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Fauth</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Three-dimensional maps of all chromosomes in human male fibroblast nuclei and prometaphase rosettes</article-title>. <source>PLoS Biol</source>. <year>2005</year>;<volume>3</volume>(<issue>5</issue>):<fpage>e157</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0030157" xlink:type="simple">10.1371/journal.pbio.0030157</ext-link></comment> <object-id pub-id-type="pmid">15839726</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barbieri</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chotalia</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lavitas</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Dostie</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pombo</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Complexity of chromatin folding is captured by the strings and binders switch model</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>40</issue>):<fpage>16173</fpage>–<lpage>16178</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1204799109" xlink:type="simple">10.1073/pnas.1204799109</ext-link></comment> <object-id pub-id-type="pmid">22988072</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Sullivan</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Hendy</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Pichugina</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wake</surname> <given-names>GC</given-names></name>, <name name-style="western"><surname>Langowski</surname> <given-names>J</given-names></name>. <article-title>The statistical-mechanics of chromosome conformation capture</article-title>. <source>Nucleus</source>. <year>2013</year>;<volume>4</volume>(<issue>5</issue>):<fpage>390</fpage>–<lpage>398</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4161/nucl.26513" xlink:type="simple">10.4161/nucl.26513</ext-link></comment> <object-id pub-id-type="pmid">24051548</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>. <source>Monte Carlo strategies in scientific computing</source>. <publisher-name>Springer</publisher-name>; <year>2001</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-0-387-76371-2" xlink:type="simple">10.1007/978-0-387-76371-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosa</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Everaers</surname> <given-names>R</given-names></name>. <article-title>Structure and Dynamics of Interphase Chromosomes</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>(<issue>8</issue>):<fpage>e1000153</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000153" xlink:type="simple">10.1371/journal.pcbi.1000153</ext-link></comment> <object-id pub-id-type="pmid">18725929</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Geman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Geman</surname> <given-names>D</given-names></name>. <article-title>Stochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images</article-title>. <source>Pattern Analysis and Machine Intelligence, IEEE Transactions on</source>. <year>1984</year>;<volume>PAMI-6</volume>(<issue>6</issue>):<fpage>721</fpage>–<lpage>741</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TPAMI.1984.4767596" xlink:type="simple">10.1109/TPAMI.1984.4767596</ext-link></comment> <object-id pub-id-type="pmid">22499653</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Metropolis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Teller</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Teller</surname> <given-names>E</given-names></name>. <article-title>Equation of State Calculations by Fast Computing Machines</article-title>. <source>Journal of Chemical Physics</source>. <year>1953</year>;<volume>21</volume>:<fpage>1087</fpage>–<lpage>1092</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.1699114" xlink:type="simple">10.1063/1.1699114</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hastings</surname> <given-names>WK</given-names></name>. <article-title>Monte Carlo sampling methods using Markov chains and their applications</article-title>. <source>Biometrika</source>. <year>1970</year>;<volume>57</volume>(<issue>1</issue>):<fpage>97</fpage>–<lpage>109</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/57.1.97" xlink:type="simple">10.1093/biomet/57.1.97</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref047">
<label>47</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Neal</surname> <given-names>RM</given-names></name>. <article-title>MCMC using Hamiltonian dynamics</article-title>. <source>Handbook of Markov Chain Monte Carlo</source>. <year>2011</year>;<volume>2</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1201/b10905-6" xlink:type="simple">10.1201/b10905-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ferrenberg</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Swendsen</surname> <given-names>RH</given-names></name>. <article-title>New Monte Carlo technique for studying phase transitions</article-title>. <source>Physical review letters</source>. <year>1988</year>;<volume>61</volume>(<issue>23</issue>):<fpage>2635</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.61.2635" xlink:type="simple">10.1103/PhysRevLett.61.2635</ext-link></comment> <object-id pub-id-type="pmid">10039183</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chodera</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Swope</surname> <given-names>WC</given-names></name>, <name name-style="western"><surname>Pitera</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Seok</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Dill</surname> <given-names>KA</given-names></name>. <article-title>Use of the Weighted Histogram Analysis Method for the Analysis of Simulated and Parallel Tempering Simulations</article-title>. <source>Journal of Chemical Theory and Computation</source>. <year>2007</year>;<volume>3</volume>(<issue>1</issue>):<fpage>26</fpage>–<lpage>41</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ct0502864" xlink:type="simple">10.1021/ct0502864</ext-link></comment> <object-id pub-id-type="pmid">26627148</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref050">
<label>50</label>
<mixed-citation publication-type="other" xlink:type="simple">
Habeck M. Evaluation of marginal likelihoods via the density of states. In: International Conference on Artificial Intelligence and Statistics; 2012. p. 486–494.</mixed-citation>
</ref>
<ref id="pcbi.1005292.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mantel</surname> <given-names>N</given-names></name>. <article-title>The detection of disease clustering and a generalized regression approach</article-title>. <source>Cancer research</source>. <year>1967</year>;<volume>27</volume>(<issue>2 Part 1</issue>):<fpage>209</fpage>–<lpage>220</lpage>. <object-id pub-id-type="pmid">6018555</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Diniz-Filho</surname> <given-names>JAF</given-names></name>, <name name-style="western"><surname>Soares</surname> <given-names>TN</given-names></name>, <name name-style="western"><surname>Lima</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Dobrovolski</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Landeiro</surname> <given-names>VL</given-names></name>, <name name-style="western"><surname>Telles</surname> <given-names>MPdC</given-names></name>, <etal>et al</etal>. <article-title>Mantel test in population genetics</article-title>. <source>Genetics and Molecular Biology</source>. <year>2013</year>;<volume>36</volume>:<fpage>475</fpage>–<lpage>485</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1590/S1415-47572013000400002" xlink:type="simple">10.1590/S1415-47572013000400002</ext-link></comment> <object-id pub-id-type="pmid">24385847</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Guillot</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rousset</surname> <given-names>F</given-names></name>. <article-title>Dismantling the Mantel tests</article-title>. <source>Methods in Ecology and Evolution</source>. <year>2013</year>;<volume>4</volume>(<issue>4</issue>):<fpage>336</fpage>–<lpage>344</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/2041-210x.12018" xlink:type="simple">10.1111/2041-210x.12018</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref054">
<label>54</label>
<mixed-citation publication-type="other" xlink:type="simple">Underwood T, Long H, So RJ, Zhu Y. type [; 2016]<ext-link ext-link-type="uri" xlink:href="http://tedunderwood.com/2016/02/07/you-say-you-found-a-revolution/" xlink:type="simple">http://tedunderwood.com/2016/02/07/you-say-you-found-a-revolution/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005292.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Von Luxburg</surname> <given-names>U</given-names></name>. <article-title>A tutorial on spectral clustering</article-title>. <source>Statistics and computing</source>. <year>2007</year>;<volume>17</volume>(<issue>4</issue>):<fpage>395</fpage>–<lpage>416</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11222-007-9033-z" xlink:type="simple">10.1007/s11222-007-9033-z</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rousseeuw</surname> <given-names>PJ</given-names></name>. <article-title>Silhouettes: A graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>Journal of Computational and Applied Mathematics</source>. <year>1987</year>;<volume>20</volume>:<fpage>53</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-6-35" xlink:type="simple">10.1186/1471-2164-6-35</ext-link></comment> <object-id pub-id-type="pmid">15760469</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rieping</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Nilges</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Habeck</surname> <given-names>M</given-names></name>. <article-title>ISD: a software package for Bayesian NMR structure calculation</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>:<fpage>1104</fpage>–<lpage>1105</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn062" xlink:type="simple">10.1093/bioinformatics/btn062</ext-link></comment> <object-id pub-id-type="pmid">18310055</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005292.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kalev</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Mechelke</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kopec</surname> <given-names>KO</given-names></name>, <name name-style="western"><surname>Holder</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Carstens</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Habeck</surname> <given-names>M</given-names></name>. <article-title>CSB: a Python framework for structural bioinformatics</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>22</issue>):<fpage>2996</fpage>–<lpage>2997</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts538" xlink:type="simple">10.1093/bioinformatics/bts538</ext-link></comment> <object-id pub-id-type="pmid">22942023</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>