<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-15-30177</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0146253</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Parameterizing Spatial Models of Infectious Disease Transmission that Incorporate Infection Time Uncertainty Using Sampling-Based Likelihood Approximations</article-title>
<alt-title alt-title-type="running-head">Parameterizing ILMs Using Sampling-Based Likelihood Approximations</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Malik</surname> <given-names>Rajat</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Deardon</surname> <given-names>Rob</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Kwong</surname> <given-names>Grace P. S.</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Mathematics &amp; Statistics, University of Guelph, Guelph, Ontario, Canada</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Faculty of Veterinary Medicine, University of Calgary, Calgary, Alberta, Canada</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Mathematics &amp; Statistics, University of Calgary, Calgary, Alberta, Canada</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Sun</surname> <given-names>Gui-Quan</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Shanxi University, CHINA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: RM RD. Performed the experiments: RM. Analyzed the data: RM RD GPSK. Wrote the paper: RM RD.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">rmalik@uoguelph.ca</email> (RM); <email xlink:type="simple">robert.deardon@ucalgary.ca</email> (RD); <email xlink:type="simple">grace.kwong@ucalgary.ca</email> (GPSK)</corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>5</day>
<month>1</month>
<year>2016</year>
</pub-date>
<volume>11</volume>
<issue>1</issue>
<elocation-id>e0146253</elocation-id>
<history>
<date date-type="received">
<day>9</day>
<month>7</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>15</day>
<month>12</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Malik et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0146253"/>
<abstract>
<p>A class of discrete-time models of infectious disease spread, referred to as individual-level models (ILMs), are typically fitted in a Bayesian Markov chain Monte Carlo (MCMC) framework. These models quantify probabilistic outcomes regarding the risk of infection of susceptible individuals due to various susceptibility and transmissibility factors, including their spatial distance from infectious individuals. The infectious pressure from infected individuals exerted on susceptible individuals is intrinsic to these ILMs. Unfortunately, quantifying this infectious pressure for data sets containing many individuals can be computationally burdensome, leading to a time-consuming likelihood calculation and, thus, computationally prohibitive MCMC-based analysis. This problem worsens when using data augmentation to allow for uncertainty in infection times. In this paper, we develop sampling methods that can be used to calculate a fast, approximate likelihood when fitting such disease models. A simple random sampling approach is initially considered followed by various spatially-stratified schemes. We test and compare the performance of our methods with both simulated data and data from the 2001 foot-and-mouth disease (FMD) epidemic in the U.K. Our results indicate that substantial computation savings can be obtained—albeit, of course, with some information loss—suggesting that such techniques may be of use in the analysis of very large epidemic data sets.</p>
</abstract>
<funding-group>
<funding-statement>This research was funded by the Ontario Ministry of Agriculture, Food and Rural Affairs (OMAFRA) and by the Natural Sciences and Engineering Research Council of Canada (NSERC). Computer equipment was provided by the Canada Foundation for Innovation via the Leading Edge Fund grant, “Centre for Public Health and Zoonoses (CPHAZ).”</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="2"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The data we utilized, called the 2001 UK foot and mouth disease farm-level data set, was obtained from the United Kingdom Government Department of Environment, Food and Rural Affairs (DEFRA), and were given permission by them to use the data for our paper. We do not, however, have permission to redistribute the data. If any readers wish to obtain the data, they may contact Dr. Deardon or DEFRA directly at <email xlink:type="simple">defra.helpline@defra.gsi.gov.uk</email>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Modeling the spread of infectious diseases is a research area of great importance to public health and agriculture. Particularly, studies involving data-driven spatial models have recently been used in a number of applications. Work by [<xref ref-type="bibr" rid="pone.0146253.ref001">1</xref>], for example, illustrate the importance of incorporating spatial and temporal data in the mathematical modeling of infectious diseases. Studies have also investigated factors that influence disease persistence/extinction such as infection rate (e.g., [<xref ref-type="bibr" rid="pone.0146253.ref002">2</xref>]). In addition, disease control policies and vaccination policies can be better developed as a result of the understanding of the spread of infectious disease gained from using such models [<xref ref-type="bibr" rid="pone.0146253.ref003">3</xref>]. The increase in computational power over the last several years and the availability of spatio-temporal data have been key factors driving growth in this area of statistics [<xref ref-type="bibr" rid="pone.0146253.ref004">4</xref>].</p>
<p>Significant computational prowess is required for models utilizing large-scale spatial data, such as recent studies performed on the 2001 foot-and-mouth disease (FMD) epidemic in the U.K. (e.g., [<xref ref-type="bibr" rid="pone.0146253.ref005">5</xref>–<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>]). These can all be considered examples of modeling infectious disease dynamics at the individual-level, although the individuals of concern may vary between studies (e.g., plants, humans, farms, etc.). [<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>] describe a framework of discrete-time individual-level models (ILMs) that are capable of modeling the spread of infectious diseases in such disease systems. These models can incorporate various heterogeneities within a population; for example, [<xref ref-type="bibr" rid="pone.0146253.ref009">9</xref>] consider the spread of human influenza allowing for vaccination status, age, and the disease status of fellow household occupants in the model. Although ILMs are flexible and intuitive, inference for these and other similar models, especially when dealing with large data sets, can be computationally prohibitive. In fact, even for moderately sized populations, obtaining meaningful results can require running these models for a considerable amount of time.</p>
<p>For such models, parameter estimation is typically carried out in a Bayesian framework via Markov chain Monte Carlo (MCMC) methods (e.g., [<xref ref-type="bibr" rid="pone.0146253.ref010">10</xref>]), wherein the likelihood function (a primary source of the computational problem) is calculated numerous times. An obvious way to reduce the extent of this problem would be to make a simplifying assumption, such as homogeneous mixing (e.g., [<xref ref-type="bibr" rid="pone.0146253.ref011">11</xref>]). However, by allowing for heterogeneity within the population, we hope to draw more sound inferences.</p>
<p>Numerous studies have focused on speeding up the likelihood calculation to reduce the time required to carry out parameter estimation in such models. For example, [<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>] introduce an approach using a Taylor series expansion of the non-linear spatial infection kernel, allowing for the decomposition of a substantial part of the likelihood function into a small parameter-dependent part and a larger data-dependent part. [<xref ref-type="bibr" rid="pone.0146253.ref012">12</xref>] expand on this by exploring the use of a piecewise linear kernel to carry out the linearization. In both cases, time-saving ensues from the fact that the data-intensive component of the likelihood does not require re-calculation at each step of the MCMC algorithm. However, the resulting model is an approximation of the true model we might actually want to fit. These approaches are also limited to situations where infection event histories of individuals are assumed known.</p>
<p>[<xref ref-type="bibr" rid="pone.0146253.ref013">13</xref>] explore several variations of a random-walk Metropolis algorithm to achieve computational efficiency in the context of infectious disease modeling. Their approach involves pre-calculating and storing quantities that are used repeatedly (something vital to the approaches of [<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>] and [<xref ref-type="bibr" rid="pone.0146253.ref012">12</xref>]), performing calculations in parallel, and refining the calculation of the likelihood ratio in the Metropolis-Hastings MCMC algorithm.</p>
<p>Other approaches to decreasing computation time in the context of fitting infectious disease models to data—in these cases, homogeneous-mixing models—are based around so-called approximate Bayesian computations, as explored in [<xref ref-type="bibr" rid="pone.0146253.ref014">14</xref>] and [<xref ref-type="bibr" rid="pone.0146253.ref015">15</xref>], and pseudo-marginal approaches, as discussed by [<xref ref-type="bibr" rid="pone.0146253.ref016">16</xref>]. In such approaches, explicit likelihood calculation is completely avoided. An alternative approach is given by [<xref ref-type="bibr" rid="pone.0146253.ref017">17</xref>], not within the context of inference for infectious disease transmission models, but for mixture models. They explore methods basing inference on carefully selected subsamples of data, constructed to provide the most relevant information to the parameters of interest.</p>
<p>In this paper, we consider an approach similar in nature to that of [<xref ref-type="bibr" rid="pone.0146253.ref017">17</xref>] that replaces the likelihood calculation with a faster likelihood approximation based upon data sampling. We also include infection time uncertainty in our modeling via a data augmented Bayesian analysis. The method works by selecting samples from the infected set of individuals at every discrete time point when calculating the infection rate for susceptible individuals, thereby avoiding the need to use the entire infectious set. We show how the resulting approximated likelihood function-based analysis can require significantly less time to carry out and compare the approximate posterior inference to the full Bayesian analysis. Whereas the aforementioned approximate methods of [<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>] and [<xref ref-type="bibr" rid="pone.0146253.ref012">12</xref>] for parameterizing ILMs cannot be used in a data augmented framework in which infection times are considered unknown, we show how our approach, with careful algorithm development, can allow such uncertainty in the analysis. This is of obvious importance in infectious disease systems because infection event times are very rarely observed with any certainty in practice [<xref ref-type="bibr" rid="pone.0146253.ref018">18</xref>]. We begin by considering a simple random sampling (SRS) approach, followed by a series of spatially-stratified sampling schemes. As a proof of concept, we test our methodology through the use of both simulated data and a relatively small subset of the 2001 UK FMD epidemic data. Note that we consider infectious disease models in a susceptible-infectious-removed (SIR) framework, although extension of the methods to other frameworks (e.g., <inline-formula id="pone.0146253.e001"><alternatives><graphic id="pone.0146253.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mtext mathvariant="script">SEIR</mml:mtext></mml:math></alternatives></inline-formula>) would be relatively straight forward.</p>
<p>Our paper is structured as follows. The <italic>Methodology</italic> section summarizes the general ILM framework of [<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>], the specific models used in this paper, and the MCMC algorithm used to carry out a full Bayesian MCMC analysis. Our algorithms are presented in the <italic>Sampling-Based Likelihood Approximations</italic> section. The <italic>Epidemic Data</italic> section describes the data used to test our methods and the <italic>Results</italic> section presents our findings. The <italic>Discussion</italic> section concludes this paper and presents possible avenues of future work.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methodology</title>
<sec id="sec003">
<title>General Model</title>
<p>We utilize the modeling framework of [<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>], which defines a class of flexible discrete-time disease transmission models that include covariate information at the individual level. With a finite population of a total of <italic>n</italic> individuals (each individual represented as <italic>i</italic> = 1, …, <italic>n</italic>), we observe epidemic data at discrete time points, <italic>t</italic> = 1, …, <italic>t</italic><sub>max</sub>, where <italic>t</italic><sub>max</sub> is the last observation time. Under a susceptible-infectious-removed <inline-formula id="pone.0146253.e002"><alternatives><graphic id="pone.0146253.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mi mathvariant="script">I</mml:mi> <mml:mi mathvariant="script">R</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> framework, each individual <italic>i</italic> is in only one of these three states at any given time <italic>t</italic>. If <inline-formula id="pone.0146253.e003"><alternatives><graphic id="pone.0146253.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, then <italic>i</italic> is susceptible to the disease and has not yet contracted it at time <italic>t</italic>; if <inline-formula id="pone.0146253.e004"><alternatives><graphic id="pone.0146253.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, then <italic>i</italic> has contracted the disease and can now infect others at time <italic>t</italic>; and if <inline-formula id="pone.0146253.e005"><alternatives><graphic id="pone.0146253.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, then <italic>i</italic> has been removed from the population at time <italic>t</italic>; e.g., due to recovery combined with acquiring immunity. Once an individual is in this final state, they cannot become infected again or transmit the disease to others. Over the course of the epidemic, individuals move through the three states in the order <inline-formula id="pone.0146253.e006"><alternatives><graphic id="pone.0146253.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi mathvariant="script">S</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>As described by [<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>], the general ILM calculates the probability a susceptible individual <italic>i</italic> will become infectious to the disease at time <italic>t</italic>, and this is given by
<disp-formula id="pone.0146253.e007"><alternatives><graphic id="pone.0146253.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>Ω</italic><sub><italic>S</italic></sub>(<italic>i</italic>) is a susceptibility function that includes risk factors for individual <italic>i</italic> contracting the disease; <italic>Ω</italic><sub><italic>T</italic></sub>(<italic>j</italic>) is a transmissibility function describing risk factors for individual <italic>j</italic> transmitting the disease to others; <italic>κ</italic>(<italic>i</italic>, <italic>j</italic>) is an infection kernel describing shared risk factors between susceptible and infectious individuals; <italic>ϵ</italic>(<italic>i</italic>, <italic>t</italic>) describes external infectious pressure not explained by the rest of the model and is commonly referred to as the ‘sparks term’; and <bold><italic>θ</italic></bold> is the set of ILM parameters we want to estimate.</p>
</sec>
<sec id="sec004">
<title>Spatial ILM</title>
<p>In this section, we present a simplified version of the general ILM such that <italic>Ω</italic><sub><italic>S</italic></sub>(<italic>i</italic>) = <italic>α</italic>, <italic>Ω</italic><sub><italic>T</italic></sub>(<italic>j</italic>) = 1, and <inline-formula id="pone.0146253.e008"><alternatives><graphic id="pone.0146253.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>β</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Here, <italic>d</italic><sub><italic>ij</italic></sub> represents the Euclidean distance between susceptible <italic>i</italic> and infectious <italic>j</italic> and <italic>β</italic> represents the power law rate of decay. We also set the sparks term, <italic>ϵ</italic>(<italic>i</italic>, <italic>t</italic>) = 0. We refer to this model as the Spatial ILM. Under this model, the probability of infection for susceptible <italic>i</italic> at time <italic>t</italic> is given by
<disp-formula id="pone.0146253.e009"><alternatives><graphic id="pone.0146253.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mo>-</mml:mo> <mml:mi>α</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>β</mml:mi></mml:mrow></mml:msubsup></mml:mfenced> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>α</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
</sec>
<sec id="sec005">
<title>FMD-ILM</title>
<p>We also modify the general ILM in order to model data from the 2001 U.K. FMD epidemic. Using a simplified version of the model found in [<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>] and by modeling at the farm-level, we can determine the probability that susceptible farm <italic>i</italic> is infected at time <italic>t</italic> using
<disp-formula id="pone.0146253.e010"><alternatives><graphic id="pone.0146253.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>α</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:msubsup><mml:mi>N</mml:mi> <mml:mi>i</mml:mi> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:msubsup><mml:mi>N</mml:mi> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi></mml:msubsup></mml:mfenced> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:msubsup><mml:mi>N</mml:mi> <mml:mi>j</mml:mi> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:msubsup><mml:mi>N</mml:mi> <mml:mi>j</mml:mi> <mml:mi>c</mml:mi></mml:msubsup></mml:mfenced> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>β</mml:mi></mml:mrow></mml:msubsup></mml:mfenced> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>α</italic><sub><italic>s</italic></sub> and <italic>α</italic><sub><italic>c</italic></sub> are susceptibility parameters and <italic>ϕ</italic><sub><italic>s</italic></sub> and <italic>ϕ</italic><sub><italic>c</italic></sub> are transmissibility parameters, for sheep and cattle, respectively. The terms <inline-formula id="pone.0146253.e011"><alternatives><graphic id="pone.0146253.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0146253.e012"><alternatives><graphic id="pone.0146253.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>x</mml:mi> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> represent the number of sheep and cattle on farm <italic>x</italic>, respectively. To avoid identifiability issues, we set <italic>α</italic><sub><italic>s</italic></sub> = 1 × 10<sup>−7</sup>, which is an arbitrary constant reference level and is not estimated. Once again, the power-law kernel, <inline-formula id="pone.0146253.e013"><alternatives><graphic id="pone.0146253.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>β</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, is used with <italic>d</italic><sub><italic>ij</italic></sub> being the Euclidean distance between farms. The sparks terms is set as a constant such that <italic>ϵ</italic>(<italic>i</italic>, <italic>t</italic>) = <italic>ϵ</italic>, which represents a constant infectious pressure from outside the study area. We refer to Model 3 as our FMD-ILM.</p>
</sec>
<sec id="sec006">
<title>Bayesian Computation</title>
<p>Our parameter estimation is here carried out under a Bayesian framework. Assuming known infection and removal times, the likelihood function for ILMs is the product of all infection and non-infection events over the entire observed epidemic period (<italic>t</italic> = 1, …, <italic>t</italic><sub>max</sub>), and is given by
<disp-formula id="pone.0146253.e014"><alternatives><graphic id="pone.0146253.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>t</mml:mi> <mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:msub></mml:munderover> <mml:mfenced close="]" open="[" separators=""><mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>\</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <bold>x</bold> is the observed epidemic data set (including the infection times), <inline-formula id="pone.0146253.e015"><alternatives><graphic id="pone.0146253.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the set of all susceptible individuals at time <italic>t</italic> + 1, and <inline-formula id="pone.0146253.e016"><alternatives><graphic id="pone.0146253.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>\</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the set of newly infectious individuals at time <italic>t</italic> + 1. Using our likelihood function and by placing a prior, <italic>π</italic>(<bold><italic>θ</italic></bold>), on our parameter set, <bold><italic>θ</italic></bold>, we can obtain the posterior distribution, <italic>π</italic>(<bold><italic>θ</italic></bold>|<bold>x</bold>), up to a constant of proportionality. To explore the posterior distribution, we can use the random-walk Metropolis Hastings (RWMH) algorithm [<xref ref-type="bibr" rid="pone.0146253.ref019">19</xref>–<xref ref-type="bibr" rid="pone.0146253.ref021">21</xref>].</p>
<p>We assume here a disease system such as foot-and-mouth as seen in the U.K. in 2001, in which the disease is reported after infection and then individuals are later removed from the population through some intervention (see <xref ref-type="fig" rid="pone.0146253.g001">Fig 1</xref>). Thus, we assume that removal times are known and fixed (although this assumption could quite easily be relaxed—see <xref ref-type="sec" rid="sec019">Discussion</xref>). However, we do not assume to know when individuals become infectious and so utilize Bayesian data augmentation, treating the infection times as unknown nuisance parameters (see also sections <italic>MCMC Algorithm</italic> and <italic>Data Augmentation</italic>). We determine the infection time indirectly by inferring the incubation period (the time between infection and disease reporting/diagnosis/observation) of each individual. Given the aforementioned assumption that removal times are known, the incubation period thus defines the infection time for each individual. The incubation period, plus a further delay until removal (e.g., through quarantine or animal culling), thus define the infectious period.</p>
<fig id="pone.0146253.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0146253.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Average infectious period under the simulation study.</title>
<p>Illustration of the average infectious period under the simulation study. The average incubation period is 3 days, and the average delay to disease recovery and removal from the population is 4 days. The ‘S’ symbol indicates the individual is susceptible to the disease at that time point and the ‘R’ symbol indicates the individual has recovered from the disease and has been removed from the population at that time point.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0146253.g001" xlink:type="simple"/>
</fig>
<p>We denote the unknown incubation periods <inline-formula id="pone.0146253.e017"><alternatives><graphic id="pone.0146253.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mi mathvariant="bold-script">Z</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="script">Z</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="script">Z</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>v</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>v</italic> is the number of infected individuals in [1, <italic>t</italic><sub>max</sub>], and assume <inline-formula id="pone.0146253.e018"><alternatives><graphic id="pone.0146253.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mover><mml:mo>∼</mml:mo> <mml:mtext>i.i.d.</mml:mtext></mml:mover> <mml:mtext>DExp</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (discretized exponential distribution), where the rate parameter, <italic>λ</italic><sub><italic>z</italic></sub>, is also to be estimated. We augment the model parameter set to include <inline-formula id="pone.0146253.e019"><alternatives><graphic id="pone.0146253.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mi mathvariant="bold-script">Z</mml:mi></mml:math></alternatives></inline-formula>. Under the spatial ILM, our parameter vector is thus <inline-formula id="pone.0146253.e020"><alternatives><graphic id="pone.0146253.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mi>α</mml:mi> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>z</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-script">Z</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>; and under the FMD-ILM, the parameter set is <inline-formula id="pone.0146253.e021"><alternatives><graphic id="pone.0146253.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>z</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-script">Z</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>In general, we define an augmented parameter set, <inline-formula id="pone.0146253.e022"><alternatives><graphic id="pone.0146253.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-script">Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and assuming independence between <bold><italic>θ</italic></bold> and <inline-formula id="pone.0146253.e023"><alternatives><graphic id="pone.0146253.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mi mathvariant="bold-script">Z</mml:mi></mml:math></alternatives></inline-formula> derive the posterior distribution up to proportionality as
<disp-formula id="pone.0146253.e024"><alternatives><graphic id="pone.0146253.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>∝</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow> <mml:mo>+</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow> <mml:mo>+</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-script">Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-script">Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-script">Z</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <bold>x</bold><sup>−</sup> is the epidemic data not including infection times and <italic>π</italic>(<bold><italic>θ</italic></bold><sup>+</sup>|<bold>x</bold><sup>−</sup>) is sampled from using Metropolis-Hastings MCMC. Here, we use an independence sampler to update <italic>λ</italic><sub><italic>z</italic></sub> and <inline-formula id="pone.0146253.e025"><alternatives><graphic id="pone.0146253.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mi mathvariant="bold-script">Z</mml:mi></mml:math></alternatives></inline-formula> and random-walk updates for other model parameters. Note that we are only indirectly estimating the infectious period distribution and not using any prior information on the infectious period. This framework could easily be changed, of course, to fit the requirements of other disease systems.</p>
</sec>
<sec id="sec007">
<title>MCMC Algorithm</title>
<p>Here, we outline our MCMC algorithm to update the data augmented parameter set, <bold><italic>θ</italic></bold><sup>+</sup>, and obtain realizations from the posterior distribution, <italic>π</italic>(<bold><italic>θ</italic></bold><sup>+</sup>|<bold>x</bold><sup>−</sup>), in order to carry out a full gold-standard Bayesian analysis. For our MCMC procedure, we break down our augmented parameter set and let Θ contain the same set of parameters as <bold><italic>θ</italic></bold> but without rate parameter <italic>λ</italic><sub><italic>z</italic></sub>; i.e., Θ = {<italic>θ</italic><sub>1</sub>, …, <italic>θ</italic><sub><italic>b</italic></sub>}, where <italic>b</italic> = |Θ| (the number of parameters in Θ). Hence, for our MCMC algorithm below, we specify our augmented parameter set as <inline-formula id="pone.0146253.e026"><alternatives><graphic id="pone.0146253.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:mo>Φ</mml:mo> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>z</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-script">Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. There are a total of <inline-formula id="pone.0146253.e027"><alternatives><graphic id="pone.0146253.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>=</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-script">Z</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> parameters in <inline-formula id="pone.0146253.e028"><alternatives><graphic id="pone.0146253.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mi mathvariant="bold-script">Z</mml:mi></mml:math></alternatives></inline-formula>, and a total of <italic>d</italic> = <italic>b</italic> + <italic>v</italic> + 1 parameters in Φ. We define <italic>θ</italic><sub><italic>w</italic></sub> as the <italic>w</italic><sup>th</sup> parameter in Θ and <inline-formula id="pone.0146253.e029"><alternatives><graphic id="pone.0146253.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msub><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:math></alternatives></inline-formula> as the <italic>c</italic><sup>th</sup> parameter in <inline-formula id="pone.0146253.e030"><alternatives><graphic id="pone.0146253.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mi mathvariant="bold-script">Z</mml:mi></mml:math></alternatives></inline-formula>. Let <italic>r</italic> be a counter for the number of MCMC iterations and let <inline-formula id="pone.0146253.e031"><alternatives><graphic id="pone.0146253.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mi>r</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> represent the <italic>r</italic><sup>th</sup> iteration of <italic>λ</italic><sub><italic>z</italic></sub>. The MCMC algorithm is as follows:</p>
<list list-type="order">
<list-item>
<p>Let <italic>r</italic> = <italic>r</italic> + 1.</p>
</list-item>
<list-item>
<p>Update <inline-formula id="pone.0146253.e032"><alternatives><graphic id="pone.0146253.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mi mathvariant="bold-script">Z</mml:mi></mml:math></alternatives></inline-formula>:
<list list-type="alpha-lower">
<list-item>
<p>Let <italic>c</italic> = 1.</p>
</list-item>
<list-item>
<p>Given the current position, <inline-formula id="pone.0146253.e033"><alternatives><graphic id="pone.0146253.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>c</mml:mi> <mml:mi>r</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, generate a new value, <inline-formula id="pone.0146253.e034"><alternatives><graphic id="pone.0146253.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mtext>DExp</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, using the inverse transform method.</p>
</list-item>
<list-item>
<p>Calculate the acceptance probability,
<disp-formula id="pone.0146253.e035"><alternatives><graphic id="pone.0146253.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mfrac><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>Θ</mml:mo></mml:mrow> <mml:mi>r</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mrow><mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>v</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>Θ</mml:mo></mml:mrow> <mml:mi>r</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mrow><mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>c</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>v</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</list-item>
<list-item>
<p>With probability <inline-formula id="pone.0146253.e036"><alternatives><graphic id="pone.0146253.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula>, accept <inline-formula id="pone.0146253.e037"><alternatives><graphic id="pone.0146253.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Otherwise, set <inline-formula id="pone.0146253.e038"><alternatives><graphic id="pone.0146253.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi mathvariant="script">Z</mml:mi> <mml:mi>c</mml:mi> <mml:mi>r</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>Let <italic>c</italic> = <italic>c</italic> + 1.</p>
</list-item>
<list-item>
<p>If <italic>c</italic> ≤ <italic>v</italic>, then repeat from step 2b.</p>
</list-item>
<list-item>
<p>If <italic>c</italic> &gt; <italic>v</italic>, then continue to step 3.</p>
</list-item>
</list></p>
</list-item>
<list-item>
<p>Update Θ:
<list list-type="alpha-lower">
<list-item>
<p>Let <italic>w</italic> = 1.</p>
</list-item>
<list-item>
<p>Given the current position, <inline-formula id="pone.0146253.e039"><alternatives><graphic id="pone.0146253.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>w</mml:mi> <mml:mi>r</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, generate a new value such that <inline-formula id="pone.0146253.e040"><alternatives><graphic id="pone.0146253.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>w</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>w</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>s</italic> ∼ <italic>U</italic>[−<italic>g</italic><sub><italic>w</italic></sub>, <italic>g</italic><sub><italic>w</italic></sub>], <inline-formula id="pone.0146253.e041"><alternatives><graphic id="pone.0146253.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0146253.e042"><alternatives><graphic id="pone.0146253.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>w</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>Calculate the acceptance probability,
<disp-formula id="pone.0146253.e043"><alternatives><graphic id="pone.0146253.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mfrac><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>w</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>b</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-script">Z</mml:mi></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>w</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>b</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-script">Z</mml:mi></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</list-item>
<list-item>
<p>With probability <inline-formula id="pone.0146253.e044"><alternatives><graphic id="pone.0146253.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula>, accept <inline-formula id="pone.0146253.e045"><alternatives><graphic id="pone.0146253.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>w</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Otherwise, set <inline-formula id="pone.0146253.e046"><alternatives><graphic id="pone.0146253.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>w</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>w</mml:mi> <mml:mi>r</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>Let <italic>w</italic> = <italic>w</italic>+1.</p>
</list-item>
<list-item>
<p>If <italic>w</italic> ≤ <italic>b</italic>, then repeat from step 3b.</p>
</list-item>
<list-item>
<p>If <italic>w</italic> &gt; <italic>b</italic>, then continue to step 4.</p>
</list-item>
</list></p>
</list-item>
<list-item>
<p>Update <italic>λ</italic><sub><italic>z</italic></sub> via the independence sampler:
<list list-type="alpha-lower">
<list-item>
<p>Given the current position, <inline-formula id="pone.0146253.e047"><alternatives><graphic id="pone.0146253.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mi>r</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, generate a new value such that <inline-formula id="pone.0146253.e048"><alternatives><graphic id="pone.0146253.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mi>Γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>f</italic><sub>1</sub> is a shape parameter and <italic>f</italic><sub>2</sub> is a rate parameter.</p>
</list-item>
<list-item>
<p>Calculate the acceptance probability,
<disp-formula id="pone.0146253.e049"><alternatives><graphic id="pone.0146253.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mfrac><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>Θ</mml:mo></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-script">Z</mml:mi></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>Θ</mml:mo></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-script">Z</mml:mi></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</list-item>
<list-item>
<p>With probability <inline-formula id="pone.0146253.e050"><alternatives><graphic id="pone.0146253.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula>, accept <inline-formula id="pone.0146253.e051"><alternatives><graphic id="pone.0146253.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Otherwise, set <inline-formula id="pone.0146253.e052"><alternatives><graphic id="pone.0146253.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi> <mml:mi>r</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
</list></p>
</list-item>
<list-item>
<p>Repeat from step 1 until a sufficiently large sample of realizations has been obtained.</p>
</list-item>
</list>
</sec>
</sec>
<sec id="sec008">
<title>Sampling-Based Likelihood Approximations</title>
<p>As stated previously, the full likelihood calculation for ILMs can be computationally taxing. Our focus here is on the key problem of calculating the infectious pressure,
<disp-formula id="pone.0146253.e053"><alternatives><graphic id="pone.0146253.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">X</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
for each individual <inline-formula id="pone.0146253.e054"><alternatives><graphic id="pone.0146253.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0146253.e055"><alternatives><graphic id="pone.0146253.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>\</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> at each time point for which data are observed. The problem worsens when we attempt to incorporate infection time (or incubation period) parameters via data augmentation. In doing so, we increase the number of parameters and, thus, the number of parameter updates in each MCMC iteration.</p>
<p>We propose to alleviate this problem by estimating <inline-formula id="pone.0146253.e056"><alternatives><graphic id="pone.0146253.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msub><mml:mi mathvariant="script">X</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> by sampling from the infectious set <inline-formula id="pone.0146253.e057"><alternatives><graphic id="pone.0146253.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> at each time point that data are observed. We begin this section by outlining the need to organize all infectious individuals into a matrix that can be updated in an efficient manner as the incubation period (and, thus, infection time) parameters are updated as part of the data-augmented MCMC. We then detail our sampling algorithms in such a data-augmented context. The two algorithms considered here allow for an SRS approach and a spatially-stratified sampling scheme, respectively, for sampling from the <inline-formula id="pone.0146253.e058"><alternatives><graphic id="pone.0146253.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> sets.</p>
<sec id="sec009">
<title>Simple Random Sampling Algorithm</title>
<p>For the SRS method, calculating each <italic>P</italic><sub><italic>it</italic></sub>(<bold><italic>θ</italic></bold>) (or 1 − <italic>P</italic><sub><italic>it</italic></sub>(<bold><italic>θ</italic></bold>)) in the likelihood is achieved by replacing the full set of infectious individuals <inline-formula id="pone.0146253.e059"><alternatives><graphic id="pone.0146253.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> with a set <inline-formula id="pone.0146253.e060"><alternatives><graphic id="pone.0146253.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> obtained through SRS with replacement from the set <inline-formula id="pone.0146253.e061"><alternatives><graphic id="pone.0146253.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, and scaling by the empirical sampling proportion, <inline-formula id="pone.0146253.e062"><alternatives><graphic id="pone.0146253.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:msub><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. This method is shown to severely reduce the computational time required to calculate <italic>P</italic><sub><italic>it</italic></sub> in the likelihood function. When <inline-formula id="pone.0146253.e063"><alternatives><graphic id="pone.0146253.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is ‘small’ (i.e., <inline-formula id="pone.0146253.e064"><alternatives><graphic id="pone.0146253.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>≤</mml:mo> <mml:mi>q</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>), we do not sample and use the entire infectious set. Here, we set <italic>q</italic> = 10 because the time savings would be negligible for <italic>q</italic> ≤ 10 simply due to the overhead associated with sampling. The infectious pressure is approximated as
<disp-formula id="pone.0146253.e065"><alternatives><graphic id="pone.0146253.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e065" xlink:type="simple"/><mml:math display="block" id="M65"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">X</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>≃</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mphantom><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mphantom> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>≤</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>&gt;</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and thus the approximation of our original probability of infection is
<disp-formula id="pone.0146253.e066"><alternatives><graphic id="pone.0146253.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e066" xlink:type="simple"/><mml:math display="block" id="M66"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≃</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
which we refer to as the SRS-ILM. Initially, we will assume that all infection times (as well as removal times) are known.</p>
<p>We now define notation relevant to our infection matrix, <inline-formula id="pone.0146253.e067"><alternatives><graphic id="pone.0146253.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mi mathvariant="script">M</mml:mi></mml:math></alternatives></inline-formula>, of dimension <italic>n</italic> × <italic>t</italic><sub>max</sub>. The elements of <inline-formula id="pone.0146253.e068"><alternatives><graphic id="pone.0146253.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mi mathvariant="script">M</mml:mi></mml:math></alternatives></inline-formula> take the form of integer identification numbers for each farm and thus, each column, <inline-formula id="pone.0146253.e069"><alternatives><graphic id="pone.0146253.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:mi mathvariant="script">M</mml:mi> <mml:mo>[</mml:mo> <mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> consists of an arbitrary ordering of farm IDs indicating their infection times, followed by a series of zeros in the remaining elements of the column. We also store the length of each column of the matrix up until the presence of empty cells, defined as <inline-formula id="pone.0146253.e070"><alternatives><graphic id="pone.0146253.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="script">M</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We use the notation <inline-formula id="pone.0146253.e071"><alternatives><graphic id="pone.0146253.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mrow><mml:mi mathvariant="script">M</mml:mi> <mml:mo>[</mml:mo> <mml:mi>B</mml:mi> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to represent the farm ID located in row <italic>B</italic> and time column <italic>C</italic> in matrix <inline-formula id="pone.0146253.e072"><alternatives><graphic id="pone.0146253.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mi mathvariant="script">M</mml:mi></mml:math></alternatives></inline-formula>. We also use the notation <inline-formula id="pone.0146253.e073"><alternatives><graphic id="pone.0146253.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:mtext mathvariant="script">DU</mml:mtext> <mml:mo>[</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to refer to a discrete uniform on [<italic>a</italic>, <italic>b</italic>], <inline-formula id="pone.0146253.e074"><alternatives><graphic id="pone.0146253.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, i.e., a distribution consisting of equally sized point masses on all integers within the interval [<italic>a</italic>, <italic>b</italic>]. To calculate the likelihood function, we then use the following algorithm:</p>
<list list-type="order">
<list-item>
<p>Let <inline-formula id="pone.0146253.e075"><alternatives><graphic id="pone.0146253.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mspace width="3.33333pt"/><mml:mo>∀</mml:mo> <mml:mspace width="3.33333pt"/><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and set <italic>t</italic> = 1.</p>
</list-item>
<list-item>
<p>If ℓ<sub><italic>t</italic></sub> ≤ <italic>q</italic>, calculate the full likelihood component for time <italic>t</italic>,
<disp-formula id="pone.0146253.e076"><alternatives><graphic id="pone.0146253.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e076" xlink:type="simple"/><mml:math display="block" id="M76"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>\</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and go to step 6.</p>
<p>Else, if ℓ<sub><italic>t</italic></sub> &gt; <italic>q</italic>, let <italic>ξ</italic> = <italic>ρ</italic><sub><italic>t</italic></sub>ℓ<sub><italic>t</italic></sub> and continue to step 2.</p>
</list-item>
<list-item>
<p>Let <italic>c</italic> = 0 and <inline-formula id="pone.0146253.e077"><alternatives><graphic id="pone.0146253.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> be a set of “empty” vectors of length to be determined by the algorithm.</p>
</list-item>
<list-item>
<p>Let <italic>c</italic> = <italic>c</italic> + 1.</p>
</list-item>
<list-item>
<p>If <italic>c</italic> ≤ <italic>ξ</italic>, then simulate <inline-formula id="pone.0146253.e078"><alternatives><graphic id="pone.0146253.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mrow><mml:mi>U</mml:mi> <mml:mo>∼</mml:mo> <mml:mtext mathvariant="script">DU</mml:mtext> <mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ℓ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, let <inline-formula id="pone.0146253.e079"><alternatives><graphic id="pone.0146253.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>c</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">M</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>U</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and return to step 3.</p>
<p>If <italic>c</italic> &gt; <italic>ξ</italic>, then let <inline-formula id="pone.0146253.e080"><alternatives><graphic id="pone.0146253.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> be the set containing all <italic>c</italic> − 1 elements of <inline-formula id="pone.0146253.e081"><alternatives><graphic id="pone.0146253.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and continue to step 5.</p>
</list-item>
<list-item>
<p>Calculate the approximated likelihood component for time <italic>t</italic>,
<disp-formula id="pone.0146253.e082"><alternatives><graphic id="pone.0146253.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e082" xlink:type="simple"/><mml:math display="block" id="M82"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>×</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mphantom><mml:mo>=</mml:mo></mml:mphantom></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>\</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mfenced close="]" open="[" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pone.0146253.e083"><alternatives><graphic id="pone.0146253.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, as before, and <inline-formula id="pone.0146253.e084"><alternatives><graphic id="pone.0146253.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>c</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>ℓ</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>Let <italic>t</italic> = <italic>t</italic>+1.</p>
<p>If <italic>t</italic> &lt; <italic>t</italic><sub>max</sub>, then go to step 1.</p>
<p>Else, if <italic>t</italic> = <italic>t</italic><sub>max</sub>, then calculate the approximated likelihood function,
<disp-formula id="pone.0146253.e085"><alternatives><graphic id="pone.0146253.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e085" xlink:type="simple"/><mml:math display="block" id="M85"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>t</mml:mi> <mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:msub></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</list-item>
</list>
</sec>
<sec id="sec010">
<title>Spatially-Stratified Sampling Algorithm</title>
<p>In this section, we consider grouping individuals into strata based on their <italic>x</italic>−<italic>y</italic> coordinates. From here, we sample only a proportion of the infectious set from each stratum at each time point <italic>t</italic> when calculating <inline-formula id="pone.0146253.e086"><alternatives><graphic id="pone.0146253.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Let <italic>k</italic> represent the index for each stratum up to a total of <italic>m</italic> strata and let
<disp-formula id="pone.0146253.e087"><alternatives><graphic id="pone.0146253.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e087" xlink:type="simple"/><mml:math display="block" id="M87"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">Z</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>≃</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mphantom><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mphantom> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>≤</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>&gt;</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
be the estimate of the infectious pressure exerted on susceptible individual <italic>i</italic> from stratum <italic>k</italic> at time <italic>t</italic>. Here, <inline-formula id="pone.0146253.e088"><alternatives><graphic id="pone.0146253.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:msub><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the empirical sampling proportion of the sampled infectious set for the stratum, <inline-formula id="pone.0146253.e089"><alternatives><graphic id="pone.0146253.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the complete set of infectious individuals in strata <italic>k</italic> at time <italic>t</italic>, and <inline-formula id="pone.0146253.e090"><alternatives><graphic id="pone.0146253.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the randomly sampled set of infectious individuals obtained via SRS (with replacement) from strata <italic>k</italic> with empirical sampling proportion <inline-formula id="pone.0146253.e091"><alternatives><graphic id="pone.0146253.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:msub><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. The sum of infectious pressures from each stratum exerted on individual <italic>i</italic> at time <italic>t</italic> is referred to as the total infectious pressure and calculated as
<disp-formula id="pone.0146253.e092"><alternatives><graphic id="pone.0146253.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e092" xlink:type="simple"/><mml:math display="block" id="M92"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">Z</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">Z</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>As before, for small infectious sets, i.e., <inline-formula id="pone.0146253.e093"><alternatives><graphic id="pone.0146253.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>≤</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we use the entire infectious set and do not sample. Under a spatial-stratification scheme, we use <italic>q</italic> = 5. Thus, the approximation of the probability of infection is
<disp-formula id="pone.0146253.e094"><alternatives><graphic id="pone.0146253.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e094" xlink:type="simple"/><mml:math display="block" id="M94"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≃</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">Z</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
which is substituted into our likelihood function. We refer to this model as the SSS-ILM.</p>
<p>We consider a three-dimensional infection matrix, <inline-formula id="pone.0146253.e095"><alternatives><graphic id="pone.0146253.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mi mathvariant="script">Q</mml:mi></mml:math></alternatives></inline-formula>, with dimensions <italic>t</italic><sub>max</sub> × <italic>m</italic> × <italic>n</italic> that contain elements corresponding to integer identification numbers for each farm. We use the notation <inline-formula id="pone.0146253.e096"><alternatives><graphic id="pone.0146253.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi> <mml:mo>[</mml:mo> <mml:mi>B</mml:mi> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to refer to the farm ID located at time <italic>B</italic>, stratum <italic>C</italic>, and cell <italic>D</italic> within matrix <inline-formula id="pone.0146253.e097"><alternatives><graphic id="pone.0146253.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:mi mathvariant="script">Q</mml:mi></mml:math></alternatives></inline-formula>. We also define a two-dimensional matrix, <inline-formula id="pone.0146253.e098"><alternatives><graphic id="pone.0146253.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula>, with dimensions <italic>t</italic><sub>max</sub> × <italic>m</italic> that contain the number of infectious individuals in each stratum at every time point (up until the presence of empty cells). Thus, for each combination of <italic>t</italic> = 1, …, <italic>t</italic><sub>max</sub> and <italic>k</italic> = 1, …, <italic>m</italic>, <inline-formula id="pone.0146253.e099"><alternatives><graphic id="pone.0146253.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:mrow><mml:mi mathvariant="script">W</mml:mi> <mml:mo>[</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">Q</mml:mi> <mml:mo>[</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo> <mml:mo>]</mml:mo> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0146253.e100"><alternatives><graphic id="pone.0146253.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:mrow><mml:mi mathvariant="script">W</mml:mi> <mml:mo>[</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> represents the number of infectious individuals at time <italic>t</italic>, in stratum <italic>k</italic>. We use the following algorithm to calculate the approximated likelihood function under the spatial stratification scheme:</p>
<list list-type="order">
<list-item>
<p>Let <inline-formula id="pone.0146253.e101"><alternatives><graphic id="pone.0146253.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mspace width="3.33333pt"/><mml:mo>∀</mml:mo> <mml:mspace width="3.33333pt"/><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <italic>k</italic> = 1, …, <italic>m</italic>.</p>
<p>Set <italic>t</italic> = 1, <italic>k</italic> = 1 and <inline-formula id="pone.0146253.e102"><alternatives><graphic id="pone.0146253.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">W</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>If ℓ<sub><italic>tk</italic></sub> ≤ <italic>q</italic>, calculate the likelihood component for strata <italic>k</italic> at time <italic>t</italic>,
<disp-formula id="pone.0146253.e103"><alternatives><graphic id="pone.0146253.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e103" xlink:type="simple"/><mml:math display="block" id="M103"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>\</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and go to step 7.</p>
<p>Else, if ℓ<sub><italic>tk</italic></sub> &gt; <italic>q</italic>, let <italic>ξ</italic> = <italic>ρ</italic><sub><italic>tk</italic></sub>ℓ<sub><italic>tk</italic></sub> and continue to step 2.</p>
</list-item>
<list-item>
<p>Let <italic>c</italic> = 0 and <inline-formula id="pone.0146253.e104"><alternatives><graphic id="pone.0146253.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> be a set of “empty” vectors of length to be determined by the algorithm.</p>
</list-item>
<list-item>
<p>Let <italic>c</italic> = <italic>c</italic> + 1.</p>
</list-item>
<list-item>
<p>If <italic>c</italic> ≤ <italic>ξ</italic>, then simulate <inline-formula id="pone.0146253.e105"><alternatives><graphic id="pone.0146253.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:mrow><mml:mi>U</mml:mi> <mml:mo>∼</mml:mo> <mml:mtext mathvariant="script">DU</mml:mtext> <mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, let <inline-formula id="pone.0146253.e106"><alternatives><graphic id="pone.0146253.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>c</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>U</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and return to step 3.</p>
<p>If <italic>c</italic> &gt; <italic>ξ</italic>, then let <inline-formula id="pone.0146253.e107"><alternatives><graphic id="pone.0146253.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> be the set containing all <italic>c</italic> − 1 elements of <inline-formula id="pone.0146253.e108"><alternatives><graphic id="pone.0146253.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and continue to step 5.</p>
</list-item>
<list-item>
<p>Calculate the approximated likelihood component for strata <italic>k</italic> at time <italic>t</italic>,
<disp-formula id="pone.0146253.e109"><alternatives><graphic id="pone.0146253.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e109" xlink:type="simple"/><mml:math display="block" id="M109"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mfenced close="}" open="{" separators=""><mml:mo>-</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">Z</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>×</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mphantom><mml:mo>=</mml:mo></mml:mphantom></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>\</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mfenced close="]" open="[" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="}" open="{" separators=""><mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">Z</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pone.0146253.e110"><alternatives><graphic id="pone.0146253.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">Z</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>≃</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">I</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, as defined earlier, and <inline-formula id="pone.0146253.e111"><alternatives><graphic id="pone.0146253.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>c</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>Let <italic>k</italic> = <italic>k</italic> + 1.</p>
<p>If <italic>k</italic> ≤ <italic>m</italic>, then go to step 1.</p>
<p>Else, if <italic>k</italic> &gt; <italic>m</italic>, continue and calculate the approximated likelihood function for time <italic>t</italic>,
<disp-formula id="pone.0146253.e112"><alternatives><graphic id="pone.0146253.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e112" xlink:type="simple"/><mml:math display="block" id="M112"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</list-item>
<list-item>
<p>Let <italic>t</italic> = <italic>t</italic>+1.</p>
<p>If <italic>t</italic> ≤ <italic>t</italic><sub>max</sub>, then reset <italic>k</italic> = 1 and go to step 1.</p>
<p>Else, if <italic>t</italic> &gt; <italic>t</italic><sub>max</sub>, then calculate the approximated likelihood function:
<disp-formula id="pone.0146253.e113"><alternatives><graphic id="pone.0146253.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e113" xlink:type="simple"/><mml:math display="block" id="M113"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>t</mml:mi> <mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:msub></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</list-item>
</list>
</sec>
<sec id="sec011">
<title>Data Augmentation</title>
<p>Because infection times/incubation periods are unknown and can change during the incubation period MCMC update, their infectious period can become longer or shorter; recall that, in our framework, the removal times remain constant. Thus, as each individual’s infection time changes, we continually need to update our infection matrix to reflect the current infection times. For computational reasons, however, it is vital that the infection matrix, <inline-formula id="pone.0146253.e114"><alternatives><graphic id="pone.0146253.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:mi mathvariant="script">Q</mml:mi></mml:math></alternatives></inline-formula>, be updated in as efficient a manner as possible (and certainly not reconstructed from scratch) as these data-augmented parameters change.</p>
<p>As an example, say individual <italic>i</italic><sub>3</sub>’s current infectious period is from <italic>t</italic><sub>2</sub> → <italic>t</italic><sub>4</sub>, and we are carrying out simple random sampling (i.e., no stratification). During the update process, the infection time increases by one and now <italic>i</italic><sub>3</sub> is only infectious during the period of <italic>t</italic><sub>3</sub> → <italic>t</italic><sub>4</sub>. Below, we illustrates the matrix update process, and use 0s to represent empty cells. Each column represents a time point and the number of individuals infected at each time is displayed underneath the matrix. The first matrix shows the current infection times (before the update) for all individuals, including <italic>i</italic><sub>3</sub>. The second matrix shows that at time column <italic>t</italic><sub>2</sub>, <italic>i</italic><sub>3</sub> is removed from its current position and replaced with a temporarily empty cell. The final matrix shows that <italic>i</italic><sub>5</sub>, which is the <italic>last</italic> individual in the <italic>t</italic><sub>2</sub> column, is moved to <italic>i</italic><sub>3</sub>’s old position (now <italic>i</italic><sub>5</sub>’s new position) and <italic>i</italic><sub>5</sub>’s old position is replaced with an empty cell. At each state, the number of elements in each column is also updated.</p>
<p><underline>State before update</underline>:
<disp-formula id="pone.0146253.e115"><alternatives><graphic id="pone.0146253.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e115" xlink:type="simple"/><mml:math display="block" id="M115"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mtext>t</mml:mtext></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mtd> <mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">3</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">4</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">5</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mo mathvariant="bold">t</mml:mo> <mml:mrow><mml:mtext mathvariant="bold">max</mml:mtext></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mo mathvariant="bold">t</mml:mo> <mml:mrow><mml:mtext mathvariant="bold">max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn mathvariant="bold">1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mn mathvariant="bold">5</mml:mn></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">6</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">6</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">5</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">2</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula></p>
<p><underline>Intermediate step</underline>: (removing <italic>i</italic><sub>3</sub> from the <italic>t</italic><sub>2</sub> column)
<disp-formula id="pone.0146253.e116"><alternatives><graphic id="pone.0146253.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e116" xlink:type="simple"/><mml:math display="block" id="M116"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mtext>t</mml:mtext></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mtd> <mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">3</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">4</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">5</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mo mathvariant="bold">t</mml:mo> <mml:mrow><mml:mtext mathvariant="bold">max</mml:mtext></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mo mathvariant="bold">t</mml:mo> <mml:mrow><mml:mtext mathvariant="bold">max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mn>0</mml:mn></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn mathvariant="bold">1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mo>*</mml:mo></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">6</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">6</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">5</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">2</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula></p>
<p><underline>Final state of the matrix</underline>: (following movement of last element of <italic>t</italic><sub>2</sub> column)
<disp-formula id="pone.0146253.e117"><alternatives><graphic id="pone.0146253.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e117" xlink:type="simple"/><mml:math display="block" id="M117"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mtext>t</mml:mtext></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mtd> <mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">3</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">4</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">5</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mo mathvariant="bold">t</mml:mo> <mml:mrow><mml:mtext mathvariant="bold">max</mml:mtext></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mo mathvariant="bold">t</mml:mo> <mml:mrow><mml:mtext mathvariant="bold">max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mn>0</mml:mn></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn mathvariant="bold">1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mn mathvariant="bold">4</mml:mn></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">6</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">6</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">5</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">2</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>Then, if the change in infection time results in an individual being infected at a time point at which they were not previously, then they are simply added at the first zero in the particular column. So, for example in this case, if at the next MCMC iteration <italic>i</italic><sub>3</sub>’s infection time changed such that they returned to having an infectious period from <italic>t</italic><sub>2</sub> → <italic>t</italic><sub>4</sub>, then a new matrix would be formed:</p>
<p><underline>New state of the matrix</underline>:
<disp-formula id="pone.0146253.e118"><alternatives><graphic id="pone.0146253.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e118" xlink:type="simple"/><mml:math display="block" id="M118"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mtext>t</mml:mtext></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mtd> <mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">3</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">4</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">5</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mo mathvariant="bold">t</mml:mo> <mml:mrow><mml:mtext mathvariant="bold">max</mml:mtext></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo mathvariant="bold">t</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mo mathvariant="bold">t</mml:mo> <mml:mrow><mml:mtext mathvariant="bold">max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi> <mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn mathvariant="bold">1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mn mathvariant="bold">5</mml:mn></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">6</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">6</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">5</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">2</mml:mn></mml:mtd> <mml:mtd><mml:mn mathvariant="bold">1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>By following these methods, we avoid the problem of ending up with zeros in the middle of columns representing each time point (which would require searching, keeping track of where non-zeros are, or recompiling the matrix), and we only require sampling from the first <inline-formula id="pone.0146253.e119"><alternatives><graphic id="pone.0146253.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi mathvariant="bold">t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of each column of the matrix. In our MCMC update, infection times, and thus periods, increment or decrement only by one time point at each MCMC iteration, and are considered in single parameter updates. However, this scheme can easily be extended to allow for updates of larger magnitude, or indeed block updates.</p>
<p>Under the spatial stratification sampling schemes, the same method of adding to the first non-zero of a column, and switching a zero in the middle of a non-zero section of a column with the last non-zero of said column, is used. However, we are of course now working with columns in the 3-dimensional rather than 2-dimensional <inline-formula id="pone.0146253.e120"><alternatives><graphic id="pone.0146253.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:mi mathvariant="script">Q</mml:mi></mml:math></alternatives></inline-formula>.</p>
</sec>
</sec>
<sec id="sec012">
<title>Epidemic Data</title>
<p>To demonstrate the effectiveness of our sampling methods, we apply them to real and simulated data. Here, we describe these data in some detail, beginning with the simulated epidemic data and followed by the 2001 U.K. FMD epidemic.</p>
<sec id="sec013">
<title>Simulated Data</title>
<p>Using the Spatial ILM, we generated ten epidemics. The chosen population is of size <italic>n</italic> = 625 spread out evenly on a 25 × 25 grid, 1 unit apart in the <italic>x</italic> and <italic>y</italic> planes. Our susceptibility parameter is set to <italic>α</italic> = 1.4 and our power law spatial parameter is set to <italic>β</italic> = 2.3. We generated the incubation period from an exponential distribution with rate parameter <inline-formula id="pone.0146253.e121"><alternatives><graphic id="pone.0146253.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, giving an average incubation period of 3 days. The period from disease diagnosis to disease recovery and removal from the population was also generated from an exponential distribution with rate parameter <inline-formula id="pone.0146253.e122"><alternatives><graphic id="pone.0146253.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>w</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, resulting in an average delay period of 4 days. Thus, the total infectious period, on average, is 7 days. <xref ref-type="fig" rid="pone.0146253.g001">Fig 1</xref> illustrates the average infectious and non-infectious periods. In our modeling, we assume we know removal times but not the incubation period and thus estimate it via data augmentation. There is also an implicit assumption that the observation time occurs before removal.</p>
</sec>
<sec id="sec014">
<title>FMD Data</title>
<p>We also implement our sampling-based parameterization methods on data from the 2001 U.K. FMD epidemic. We used a subset of the epidemic data, which was from the county of Cumbria located in North West England and consisted of 1,636 individual farms. According to [<xref ref-type="bibr" rid="pone.0146253.ref022">22</xref>], sheep and cattle farms accounted for almost all cases of the FMD outbreak in 2001 in the U.K. We consider farms to be the “individual”-level at which we are modeling and use cattle and sheep populations within farms as covariates in our model. We treat the disease diagnosis times recorded by veterinarians and epidemiologists who were on the ground during the outbreak as observed infection times. The times when animals were culled were also recorded and we treat these as the removal times in our modeling framework. We estimate the incubation periods (and the infection times indirectly) through Bayesian data augmentation. For some farms, disease diagnosis times were not recorded and so we assume these farms transition from state <inline-formula id="pone.0146253.e123"><alternatives><graphic id="pone.0146253.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e123" xlink:type="simple"/><mml:math display="inline" id="M123"><mml:mrow><mml:mi mathvariant="script">S</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> on their cull date. In total, 730 infections were recorded in our data set. Refer to, for example, [<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>], for a more detailed description of the U.K. 2001 data set.</p>
<p>Note that most models for FMD assume an <inline-formula id="pone.0146253.e124"><alternatives><graphic id="pone.0146253.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:mtext mathvariant="script">SEIR</mml:mtext></mml:math></alternatives></inline-formula> framework, with a latent, non-infectious state before infectiousness. We simplify our model for the purposes of illustration of our method, and—as mentioned in the discussion—extension to an <inline-formula id="pone.0146253.e125"><alternatives><graphic id="pone.0146253.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e125" xlink:type="simple"/><mml:math display="inline" id="M125"><mml:mtext mathvariant="script">SEIR</mml:mtext></mml:math></alternatives></inline-formula> framework would be relatively straightforward.</p>
</sec>
<sec id="sec015">
<title>Priors</title>
<p>For both data sets, all ILM parameters, except for <italic>λ</italic><sub><italic>z</italic></sub>, are assigned independent, vague marginal priors under the assumption of weak prior knowledge. The marginal priors chosen here are positive, half-normal distributions with mode 0 and a ‘large’ variance of 10<sup>5</sup>.</p>
<p>The marginal prior choice for <italic>λ</italic><sub><italic>z</italic></sub>, the incubation period rate parameter, is a Gamma distribution such that <italic>λ</italic><sub><italic>z</italic></sub> ∼ Γ(3, 9). This prior suggests an average incubation period of 3 days, which is the same as the incubation period from the simulated data. For the FMD epidemic, this prior may, of course, be misspecified because we do not know the actual incubation period.</p>
</sec>
</sec>
<sec id="sec016" sec-type="results">
<title>Results</title>
<p>In this section, we present the results of our analyses. All computations were performed on an Apple Mac Pro with two 6-core Intel Xeon 2.93 GHz processors with 12 GB of RAM.</p>
<sec id="sec017">
<title>Simulation Study</title>
<p>Figs <xref ref-type="fig" rid="pone.0146253.g002">2</xref> and <xref ref-type="fig" rid="pone.0146253.g003">3</xref> illustrate the posterior means and 95% credible intervals for each ILM parameter, for each of the 10 epidemics simulated. Averages of these results over the ten epidemic data sets are shown in <xref ref-type="supplementary-material" rid="pone.0146253.s001">S1 Table</xref>.</p>
<fig id="pone.0146253.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0146253.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Posterior results for full MCMC and SRS methods.</title>
<p>Posterior means and 95% credible intervals for <italic>α</italic>, <italic>β</italic>, and <italic>λ</italic><sub><italic>z</italic></sub> for the full MCMC and SRS methods for 10 different epidemics simulated from the data augmented spatial ILM with varying sampling proportions. The dashed, horizontal lines represent the true parameter values: <italic>α</italic> = 1.4, <italic>β</italic> = 2.3, and <inline-formula id="pone.0146253.e126"><alternatives><graphic id="pone.0146253.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, with a population of size <italic>n</italic> = 625.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0146253.g002" xlink:type="simple"/>
</fig>
<fig id="pone.0146253.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0146253.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Full posterior results for full MCMC and spatial stratification methods.</title>
<p>Posterior means and 95% credible intervals for <italic>α</italic>, <italic>β</italic>, and <italic>λ</italic><sub><italic>z</italic></sub> for the full MCMC and spatial stratification methods for 10 different epidemics simulated from the data augmented spatial ILM with varying values for <italic>m</italic> and <italic>ρ</italic>. The dashed, horizontal lines represent the true parameter values: <italic>α</italic> = 1.4, <italic>β</italic> = 2.3, and <inline-formula id="pone.0146253.e127"><alternatives><graphic id="pone.0146253.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e127" xlink:type="simple"/><mml:math display="inline" id="M127"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, with a population of size <italic>n</italic> = 625.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0146253.g003" xlink:type="simple"/>
</fig>
<p>As expected, bias for all parameters decreases as the sampling proportion, <italic>ρ</italic>, increases under the SRS technique. Posterior variance also decreases as <italic>ρ</italic> increases, leading to tighter credible intervals. It also appears to be more difficult to estimate the spatial parameter <italic>β</italic> using an SRS scheme with precision approaching that seen under the full MCMC analysis than is the case with <italic>α</italic> and <italic>λ</italic><sub><italic>z</italic></sub>.</p>
<p>Introducing spatial stratification in our sampling scheme appears to lead to increased posterior accuracy (<xref ref-type="fig" rid="pone.0146253.g003">Fig 3</xref>). Under these results (shown for <italic>ρ</italic> = 0.10 and <italic>ρ</italic> = 0.50), as the number of strata, <italic>m</italic>, increases, posterior variance and bias decrease and, thus, credible intervals are tighter. The posterior means also tend to be closer to the true parameter values. We also observe that spatial stratification is less sensitive to different <italic>ρ</italic> values tested and more sensitive to different values for <italic>m</italic>. For example, in <xref ref-type="fig" rid="pone.0146253.g003">Fig 3</xref>, the posterior results for <italic>α</italic> under <italic>m</italic> = 4 show almost no change for <italic>ρ</italic> = 0.10 versus <italic>ρ</italic> = 0.50. However, increasing the number of strata to <italic>m</italic> = 9 does increase posterior accuracy compared to <italic>m</italic> = 4. Under both values of <italic>ρ</italic>, we are able to obtain more posterior accuracy under the spatial stratification scheme than the simple random sampling scheme, demonstrating the advantage that including spatial stratification presents.</p>
<p>However, although spatial stratification appears more desirable in terms of posterior approximation, we must also consider the computation time required for the MCMC to run. <xref ref-type="table" rid="pone.0146253.t001">Table 1</xref> displays the average computation time (in hours) of each of our sampling methods. We observe that it takes approximately 92.64 hours to run 20,000 MCMC iterations of the true model without any data sampling. However, if we introduce SRS and set <italic>ρ</italic> = 0.25, we notice a drastic reduction in computation time; the MCMC takes only 36.48 hours to run. The computation time increases when <italic>ρ</italic> increases, as expected. The same is true if we consider spatial stratification in our sampling scheme. We see that smaller values of <italic>m</italic> yield faster run times, but the posterior approximation improves with larger <italic>m</italic>. Obviously, in practice, a trade off between posterior accuracy and computation time would be required.</p>
<table-wrap id="pone.0146253.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0146253.t001</object-id>
<label>Table 1</label>
<caption>
<title>Average computation time for the simulation studies.</title>
</caption>
<alternatives>
<graphic id="pone.0146253.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0146253.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"><italic>ρ</italic></th>
<th align="center">m</th>
<th align="center">Computation Time (hours)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">—</td>
<td align="center">—</td>
<td align="char" char=".">92.64</td>
</tr>
<tr>
<td align="char" char=".">0.25</td>
<td align="center">—</td>
<td align="char" char=".">36.48</td>
</tr>
<tr>
<td align="char" char=".">0.50</td>
<td align="center">—</td>
<td align="char" char=".">47.76</td>
</tr>
<tr>
<td align="char" char=".">0.75</td>
<td align="center">—</td>
<td align="char" char=".">59.28</td>
</tr>
<tr>
<td align="char" char=".">0.90</td>
<td align="center">—</td>
<td align="char" char=".">75.12</td>
</tr>
<tr>
<td align="char" char=".">0.10</td>
<td align="center">4</td>
<td align="char" char=".">46.88</td>
</tr>
<tr>
<td align="char" char=".">0.50</td>
<td align="center">4</td>
<td align="char" char=".">56.16</td>
</tr>
<tr>
<td align="char" char=".">0.10</td>
<td align="center">9</td>
<td align="char" char=".">66.24</td>
</tr>
<tr>
<td align="char" char=".">0.50</td>
<td align="center">9</td>
<td align="char" char=".">71.52</td>
</tr>
<tr>
<td align="char" char=".">0.10</td>
<td align="center">16</td>
<td align="char" char=".">82.32</td>
</tr>
<tr>
<td align="char" char=".">0.50</td>
<td align="center">16</td>
<td align="char" char=".">88.56</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>Average computation run times (in hours) of fitting the data augmented spatial ILM, SRS-ILM, and the SSS-ILM to 10 different simulated epidemics. These epidemics were simulated using ILM parameters <italic>α</italic> = 1.4, <italic>β</italic> = 2.3, <inline-formula id="pone.0146253.e128"><alternatives><graphic id="pone.0146253.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>n</italic> = 625.</p>
</fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec018">
<title>FMD Model Fitting Results</title>
<p>Figs <xref ref-type="fig" rid="pone.0146253.g004">4</xref> and <xref ref-type="fig" rid="pone.0146253.g005">5</xref> show the results of implementing our sampling methods when fitting the data augmented FMD-ILM (tabulated results are given in <xref ref-type="supplementary-material" rid="pone.0146253.s002">S2 Table</xref>). Under the SRS approach, we see that posterior means for each ILM parameter tend to approach the posterior mean estimate under the full model as <italic>ρ</italic> is increased, similar to the findings of the simulation study. In general, we also observe that posterior variance decreases as <italic>ρ</italic> increases, resulting in tighter credible intervals closer to those under the full full model (which are generally the most narrow). Once again, these results mimic those seen in the simulation study.</p>
<fig id="pone.0146253.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0146253.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Posterior results for FMD-ILM using the SRS method.</title>
<p>Posterior means and 95% credible intervals for all parameters of the data augmented FMD-ILM under the SRS method. The results are compared to the full model to assess accuracy.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0146253.g004" xlink:type="simple"/>
</fig>
<fig id="pone.0146253.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0146253.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Posterior results for FMD-ILM using the spatial stratification method.</title>
<p>Posterior means and 95% credible intervals for all parameters of the data augmented FMD-ILM under the spatial stratification method. We sampled <italic>ρ</italic> = 0.50 from each stratum. The results are compared to the full model.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0146253.g005" xlink:type="simple"/>
</fig>
<p>Considering the spatially stratified schemes, we draw similar conclusions to those seen in the simulation study. Posterior accuracy tends to increase, and posterior variances decrease, as the number of strata, <italic>m</italic>, increases. In fact, for <italic>m</italic> = 16 we obtain posterior estimates that are very close to those seen under the full model for parameters <italic>ϕ</italic><sub><italic>s</italic></sub>, <italic>ϕ</italic><sub><italic>c</italic></sub>, and <italic>λ</italic><sub><italic>z</italic></sub>. Credible interval widths for <italic>ϕ</italic><sub><italic>s</italic></sub> and <italic>β</italic> change negligibly with regards to choice of <italic>m</italic>. Further, although posterior variance decreases as <italic>m</italic> increases, the credible intervals obtained under SRS with <italic>m</italic> = 4 (the lowest number of strata) contain those seen under the full MCMC analysis, suggesting good approximate inference.</p>
<p>Comparing the two sampling schemes, we see that spatial stratification tends to yield more accurate results. For example, if we compare SRS at <italic>ρ</italic> = 0.50 with stratification even at <italic>m</italic> = 4 (also sampled with <italic>ρ</italic> = 0.50), we find that all parameters under the spatial stratification scheme provide very similar, or more accurate, posterior means and tighter credible intervals. As <italic>m</italic> increases, as we have also seen, these SRS-based results improve even further.</p>
<p>Once again, however, a key aspect in addition to modeling accuracy is reduction in computation time. <xref ref-type="table" rid="pone.0146253.t002">Table 2</xref> provides the run times (in hours) for each FMD data analysis. With the full model taking approximately 249.12 hours to run for 20,000 MCMC iterations, we notice significant time savings at <italic>ρ</italic> = 0.25 and <italic>ρ</italic> = 0.50 using SRS and at <italic>m</italic> = 4 using spatial stratification. The time savings are much lower and of more questionable benefit for larger <italic>ρ</italic> and <italic>m</italic>. Further, and once again, time savings achieved using these sampling methods would be expected to be greater for larger data sets (see <xref ref-type="sec" rid="sec019">discussion</xref>).</p>
<table-wrap id="pone.0146253.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0146253.t002</object-id>
<label>Table 2</label>
<caption>
<title>Computation times for the FMD-ILM.</title>
</caption>
<alternatives>
<graphic id="pone.0146253.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0146253.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"><italic>ρ</italic></th>
<th align="center">m</th>
<th align="center">Computation Time (hours)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">—</td>
<td align="center">—</td>
<td align="char" char=".">249.12</td>
</tr>
<tr>
<td align="char" char=".">0.25</td>
<td align="center">—</td>
<td align="char" char=".">60.24</td>
</tr>
<tr>
<td align="char" char=".">0.50</td>
<td align="center">—</td>
<td align="char" char=".">84.72</td>
</tr>
<tr>
<td align="char" char=".">0.75</td>
<td align="center">—</td>
<td align="char" char=".">164.88</td>
</tr>
<tr>
<td align="char" char=".">0.90</td>
<td align="center">—</td>
<td align="char" char=".">227.76</td>
</tr>
<tr>
<td align="char" char=".">0.50</td>
<td align="center">4</td>
<td align="char" char=".">108.24</td>
</tr>
<tr>
<td align="char" char=".">0.50</td>
<td align="center">9</td>
<td align="char" char=".">185.04</td>
</tr>
<tr>
<td align="char" char=".">0.50</td>
<td align="center">16</td>
<td align="char" char=".">232.80</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>Computation run times (in hours) of fitting the data augmented FMD-ILM to the FMD data using various sampling techniques. Models produced 20,000 realizations from the posterior.</p>
</fn>
</table-wrap-foot>
</table-wrap>
</sec>
</sec>
<sec id="sec019" sec-type="conclusions">
<title>Discussion</title>
<p>In this paper, we introduced sampling algorithms to help speed up the likelihood calculation for ILMs in a Bayesian MCMC framework. Unlike other proposed methods (e.g., [<xref ref-type="bibr" rid="pone.0146253.ref008">8</xref>, <xref ref-type="bibr" rid="pone.0146253.ref012">12</xref>]), ours incorporates data augmented MCMC to allow for uncertainty about infection times into our analysis. We test the usefulness of our methods by comparing ILM parameter estimation under the full Bayesian analysis via a simulation study and using data from the 2001 FMD epidemic in the U.K. Our results show that overall, we were able to obtain fairly accurate (though less precise) results using sampling-based likelihood approximations compared to the results obtained under the full likelihood analysis. In terms of computation run times, we found significant savings could be made by using data sampling. Because the problem of repeated likelihood calculations under the full model is increased drastically with the inclusion of data augmentation, this is a result of key importance. However, we found using larger values of <italic>ρ</italic> or <italic>m</italic> can drastically reduce the time saving benefit over the full MCMC analysis.</p>
<p>In our studies, only two sampling techniques were considered. Possible future work could involve investigating other sampling procedures that might provide stronger inferential conclusions. For example, our spatial stratification technique consisted of dividing the population into equally sized cells/strata and then sampling from each cell with equal sampling proportions. This would seem intuitively sensible when the population is spread across a grid, as was the case in our simulation study. This may be reasonable for some crop diseases or perhaps if points on the grid represent regions or cells (e.g., consider the modeling of fire spread by [<xref ref-type="bibr" rid="pone.0146253.ref023">23</xref>]), but such a population layout would be quite unrealistic in most situations. (It was, of course, adequate for the main aim of this paper, which was to illustrate the facilitation of faster likelihood calculations via data sampling).</p>
<p>In most populations, some natural clustering of individuals tends to take place (e.g., there tend to be high density clusters of farms in regions where infrastructural and/or environmental conditions are suitable for the type of farming in question). In such situations, spatial strata could, for example, be based upon some spatial clustering method applied to the population data. Alternatively, for a population in which some sort of contact network, or series of such networks, were being used as a prime risk factor in the model, clustering based on the network(s), using say partitioning around medoids (PAM) [<xref ref-type="bibr" rid="pone.0146253.ref024">24</xref>], could be considered as a way of defining strata from which to sample.</p>
<p>Here, we assumed that the sampling proportion was invariant to time and/or stratum. However, it might be useful to allow the sampling proportion to vary according to one or both. We might also possibly want to place more weight on sampling at times when the epidemic intensity is highest. Alternatively, in the case of spatially stratified sampling, we might want to avoid sampling from some strata with very low epidemic intensity. Such methods could possibly provide faster computation concurrent with more accurate model parameterization.</p>
<p>There are also, of course, many other options for carrying out approximate inference when computational efficiency is a driving factor. For example, [<xref ref-type="bibr" rid="pone.0146253.ref025">25</xref>] use a Gaussian process emulator method based on mapping key summary statistics from model simulations to the parameter space. In a similar vein, the aforementioned so-called approximate Bayesian computational methods used by, for example, [<xref ref-type="bibr" rid="pone.0146253.ref014">14</xref>] and [<xref ref-type="bibr" rid="pone.0146253.ref015">15</xref>], can be employed. These are also based on comparing salient summary statistics from observed and simulated data. A systematic comparison of all of these different approaches would be of obvious interest.</p>
<p>Our study used a <inline-formula id="pone.0146253.e129"><alternatives><graphic id="pone.0146253.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:mtext mathvariant="script">SIR</mml:mtext></mml:math></alternatives></inline-formula> modeling framework. We could extend the analysis presented here to a <inline-formula id="pone.0146253.e130"><alternatives><graphic id="pone.0146253.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e130" xlink:type="simple"/><mml:math display="inline" id="M130"><mml:mtext mathvariant="script">SEIR</mml:mtext></mml:math></alternatives></inline-formula> framework to investigate disease exposure times. In our modeling, we accounted for incubation by treating it as a period when infected individuals have not been diagnosed yet but can pass on the disease to others. Introducing an exposed state would indicate an individual has contracted the disease but cannot pass it on to others until they reach the infectious state, regardless of confirmation of disease diagnosis. Additionally, we assumed knowledge of when individuals were removed from the population; however, this would not be the case for most diseases (e.g., human influenza). In a future study, we can also explore scenarios where removal times are unknown and instead estimated through data augmentation. The modeling framework used in this paper was also set in discrete time. The time saving sampling used here can also be applied in a (more natural, arguably) continuous time modeling framework.</p>
<p>We have demonstrated as a proof of concept that, for these relatively small datasets, our sampling-based likelihood approximations can result in a significant decrease in computation time. The time savings using these sampling algorithms would be even more beneficial in large-scale problems involving massive data sets compared to a full Bayesian analysis. A natural avenue of possible future work would be to apply these techniques to much larger data sets. Of course, these techniques would only really be worth using for large data sets in which a full Bayesian analysis was computationally prohibitive, in which case the priority would likely to be to get some sort of ‘rough and ready’ inference done as quickly as possible, rather than worry too much about the quality of posterior approximation. However, some degree of thought would have to be given to the choice of <italic>ρ</italic> and the stratification methods used in order to achieve parametrization of a reasonable quality in a feasible time frame. Further work on the use of some sort of adaptive scheme, based initially on a quick pilot study over sampling proportions and stratification schemes, might also therefore be of interest.</p>
</sec>
<sec id="sec020">
<title>Supporting Information</title>
<supplementary-material id="pone.0146253.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0146253.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Summary statistics for the simulation studies.</title>
<p>Summary statistics from the simulation studies comparing model parameter estimation across our different sampling schemes. The results are averaged over 10 different epidemics simulated from the data augmented spatial ILM with parameter values <inline-formula id="pone.0146253.e131"><alternatives><graphic id="pone.0146253.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0146253.e131" xlink:type="simple"/><mml:math display="inline" id="M131"><mml:mrow><mml:mi>α</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>4</mml:mn> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>.</mml:mo> <mml:mn>3</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>z</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>n</italic> = 625. Here, CIs are the mean credible interval limits.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0146253.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0146253.s002" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Summary statistics for modeling the FMD-ILM.</title>
<p>Summary of results from fitting the data augmented FMD-ILM to the FMD data. We compare the results across our different sampling methods. Note that for spatial stratification, we sample <italic>ρ</italic> = 0.50 from each stratum.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pone.0146253.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sun</surname> <given-names>GQ</given-names></name>. <article-title>Pattern formation of an epidemic model with diffusion</article-title>. <source>Nonlinear Dynamics</source>. <year>2012</year>;<volume>69</volume>(<issue>3</issue>):<fpage>1097</fpage>–<lpage>1104</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11071-012-0330-5" xlink:type="simple">10.1007/s11071-012-0330-5</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sun</surname> <given-names>GQ</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>QX</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Chakraborty</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>BL</given-names></name>. <article-title>Influence of infection rate and migration on extinction of disease in spatial epidemics</article-title>. <source>Journal of Theoretical Biology</source>. <year>2010</year>;<volume>264</volume>(<issue>1</issue>):<fpage>95</fpage>–<lpage>103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2010.01.006" xlink:type="simple">10.1016/j.jtbi.2010.01.006</ext-link></comment> <object-id pub-id-type="pmid">20085769</object-id></mixed-citation>
</ref>
<ref id="pone.0146253.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Neill</surname> <given-names>PD</given-names></name>. <article-title>Introduction and snapshot review: relating infectious disease transmission models to data</article-title>. <source>Statistics in Medicine</source>. <year>2010</year>;<volume>29</volume>(<issue>20</issue>):<fpage>2069</fpage>–<lpage>2077</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/sim.3968" xlink:type="simple">10.1002/sim.3968</ext-link></comment> <object-id pub-id-type="pmid">20809536</object-id></mixed-citation>
</ref>
<ref id="pone.0146253.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shekhar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Mohan</surname> <given-names>P</given-names></name>. <article-title>Identifying patterns in spatial information: a survey of methods</article-title>. <source>WIREs Data Mining and Knowledge Discovery</source>. <year>2011</year>;<volume>1</volume>:<fpage>193</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/widm.25" xlink:type="simple">10.1002/widm.25</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chis Ster</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Ferguson</surname> <given-names>NM</given-names></name>. <article-title>Transmission parameters of the 2001 foot and mouth epidemic in Great Britain</article-title>. <source>PLoS ONE</source>. <year>2007</year>;<volume>2</volume>(<issue>6</issue>):<fpage>e502</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0000502" xlink:type="simple">10.1371/journal.pone.0000502</ext-link></comment> <object-id pub-id-type="pmid">17551582</object-id></mixed-citation>
</ref>
<ref id="pone.0146253.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chis Ster</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Ferguson</surname> <given-names>NM</given-names></name>. <article-title>Epidemiological inference for partially observed epidemics: the example of the 2001 foot and mouth epidemic in Great Britain</article-title>. <source>Epidemics</source>. <year>2009</year>;<volume>1</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.epidem.2008.09.001" xlink:type="simple">10.1016/j.epidem.2008.09.001</ext-link></comment> <object-id pub-id-type="pmid">21352749</object-id></mixed-citation>
</ref>
<ref id="pone.0146253.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jewell</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Kypraios</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Neal</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Roberts</surname> <given-names>GO</given-names></name>. <article-title>Bayesian analysis for emerging infectious diseases</article-title>. <source>Bayesian Analysis</source>. <year>2009</year>;<volume>4</volume>(<issue>2</issue>):<fpage>191</fpage>–<lpage>222</lpage>.</mixed-citation>
</ref>
<ref id="pone.0146253.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deardon</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Brooks</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Grenfell</surname> <given-names>BT</given-names></name>, <name name-style="western"><surname>Keeling</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Tildesley</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Savill</surname> <given-names>NJ</given-names></name>, <etal>et al</etal>. <article-title>Inference for individual level models of infectious diseases in large populations</article-title>. <source>Statistica Sinica</source>. <year>2010</year>;<volume>20</volume>(<issue>1</issue>):<fpage>239</fpage>–<lpage>261</lpage>. <object-id pub-id-type="pmid">26405426</object-id></mixed-citation>
</ref>
<ref id="pone.0146253.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Malik</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Deardon</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kwong</surname> <given-names>GPS</given-names></name>, <name name-style="western"><surname>Cowling</surname> <given-names>BJ</given-names></name>. <article-title>Individual-level modeling of the spread of influenza within households</article-title>. <source>Journal of Applied Statistics</source>. <year>2014</year>;<volume>41</volume>(<issue>7</issue>):<fpage>1578</fpage>–<lpage>1592</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/02664763.2014.881787" xlink:type="simple">10.1080/02664763.2014.881787</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref010">
<label>10</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gamerman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lopes</surname> <given-names>HF</given-names></name>. <chapter-title>Markov Chain Monte Carlo: Stochastic Simulation for Bayesian Inference</chapter-title>. <edition>2nd ed</edition>. <source>Chapman &amp; Hall/CRC Texts in Statistical Science</source>. <publisher-name>CRC Press</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pone.0146253.ref011">
<label>11</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Daley</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Gani</surname> <given-names>J</given-names></name>. <source>Epidemic Models: An Introduction</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pone.0146253.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kwong</surname> <given-names>GPS</given-names></name>, <name name-style="western"><surname>Deardon</surname> <given-names>R</given-names></name>. <article-title>Linearized forms of individual-level models for large-scale spatial infectious disease systems</article-title>. <source>Bulletin of Mathematical Biology</source>. <year>2012</year>;<volume>74</volume>(<issue>8</issue>):<fpage>1912</fpage>–<lpage>1937</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11538-012-9739-8" xlink:type="simple">10.1007/s11538-012-9739-8</ext-link></comment> <object-id pub-id-type="pmid">22718395</object-id></mixed-citation>
</ref>
<ref id="pone.0146253.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Chimard</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Remorov</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rosenthal</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>X</given-names></name>. <article-title>Statistical inference and computational efficiency for spatial infectious disease models with plantation data</article-title>. <source>Journal of the Royal Statistical Society: Series C (Applied Statistics)</source>. <year>2013</year>.</mixed-citation>
</ref>
<ref id="pone.0146253.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McKinley</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cook</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Deardon</surname> <given-names>R</given-names></name>. <article-title>Inference in epidemic models without likelihoods</article-title>. <source>The International Journal of Biostatistics</source>. <year>2009</year>;<volume>5</volume>(<issue>1</issue>): Article 24. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2202/1557-4679.1171" xlink:type="simple">10.2202/1557-4679.1171</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Toni</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Welch</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Strelkowa</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ipsen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Strumpf</surname> <given-names>MP</given-names></name>. <article-title>Approximate Bayesian computation scheme for parameter inference and model selection in dynamical systems</article-title>. <source>Journal of the Royal Society Interface</source>. <year>2009</year>;<volume>6</volume>:<fpage>187</fpage>–<lpage>202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2008.0172" xlink:type="simple">10.1098/rsif.2008.0172</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McKinley</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Ross</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>Deardon</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Cook</surname> <given-names>AR</given-names></name>. <article-title>Simulation-based Bayesian inference for epidemic models</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2014</year>;<volume>71</volume>:<fpage>434</fpage>–<lpage>447</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S016794731200446X" xlink:type="simple">http://www.sciencedirect.com/science/article/pii/S016794731200446X</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.csda.2012.12.012" xlink:type="simple">10.1016/j.csda.2012.12.012</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Manolopoulou</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>West</surname> <given-names>M</given-names></name>. <article-title>Selection sampling from large data sets for targeted inference in mixture modeling</article-title>. <source>Bayesian Analysis</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):<fpage>429</fpage>–<lpage>450</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/10-BA517" xlink:type="simple">10.1214/10-BA517</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cauchemez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ferguson</surname> <given-names>NM</given-names></name>. <article-title>Methods to infer transmission risk factors in complex outbreak data</article-title>. <source>Journal of the Royal Society Interface</source>. <year>2012</year>;<volume>68</volume>(<issue>9</issue>):<fpage>456</fpage>–<lpage>469</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2011.0379" xlink:type="simple">10.1098/rsif.2011.0379</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Metropolis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Teller</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Teller</surname> <given-names>E</given-names></name>. <article-title>Equations of state calculations by fast computing machines</article-title>. <source>Journal of Chemical Physics</source>. <year>1953</year>;<volume>21</volume>(<issue>6</issue>):<fpage>1087</fpage>–<lpage>1092</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.1699114" xlink:type="simple">10.1063/1.1699114</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hastings</surname> <given-names>WK</given-names></name>. <article-title>Monte Carlo sampling methods using Markov chains and their applications</article-title>. <source>Biometrika</source>. <year>1970</year>;<volume>57</volume>(<issue>1</issue>):<fpage>97</fpage>–<lpage>109</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/57.1.97" xlink:type="simple">10.1093/biomet/57.1.97</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chib</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Greenberg</surname> <given-names>E</given-names></name>. <article-title>Understanding the Metropolis-Hastings algorithm</article-title>. <source>The American Statistician</source>. <year>1995</year>;<volume>49</volume>(<issue>4</issue>):<fpage>327</fpage>–<lpage>335</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/00031305.1995.10476177" xlink:type="simple">10.1080/00031305.1995.10476177</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref022">
<label>22</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>I</given-names></name>. <source>Foot and mouth disease 2001: Lessons to be learned inquiry</source>. <publisher-loc>London</publisher-loc>: <publisher-name>The Stationary Office</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pone.0146253.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vrbik</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Deardon</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Gardner</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Braun</surname> <given-names>J</given-names></name>. <article-title>Using individual-level models for infectious disease spread to model spatio-temporal combustion dynamics</article-title>. <source>Bayesian Analysis</source>. <year>2012</year>;<volume>7</volume>(<issue>3</issue>):<fpage>615</fpage>–<lpage>638</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/12-BA721" xlink:type="simple">10.1214/12-BA721</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Park</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Jun</surname> <given-names>CH</given-names></name>. <article-title>A simple and fast algorithm for K-medoids clustering</article-title>. <source>Expert Systems with Applications</source>. <year>2009</year>;<volume>36</volume>(<issue>2</issue>):<fpage>3336</fpage>–<lpage>3341</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.eswa.2008.01.039" xlink:type="simple">10.1016/j.eswa.2008.01.039</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0146253.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jandarov</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Haran</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bjørnstad</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Grenfell</surname> <given-names>B</given-names></name>. <article-title>Emulating a gravity model to infer the spatiotemporal dynamics of an infectious disease</article-title>. <source>Journal of the Royal Statistical Society: Series C (Applied Statistics)</source>. <year>2014</year>;<volume>63</volume>(<issue>3</issue>):<fpage>423</fpage>–<lpage>444</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/rssc.12042" xlink:type="simple">10.1111/rssc.12042</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>