<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-11-08449</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0025677</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Geoinformatics</subject>
            <subj-group>
              <subject>Geostatistics</subject>
              <subject>Spatial autocorrelation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Earth sciences</subject>
          <subj-group>
            <subject>Geography</subject>
            <subj-group>
              <subject>Geoinformatics</subject>
              <subj-group>
                <subject>Geostatistics</subject>
                <subject>Spatial autocorrelation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Marine and aquatic sciences</subject>
            <subj-group>
              <subject>Freshwater ecology</subject>
              <subject>Water quality</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability theory</subject>
            <subj-group>
              <subject>Bayes theorem</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical methods</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Social and behavioral sciences</subject>
          <subj-group>
            <subject>Geography</subject>
            <subj-group>
              <subject>Geoinformatics</subject>
              <subj-group>
                <subject>Geostatistics</subject>
                <subject>Spatial autocorrelation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Marine and Aquatic Sciences</subject>
          <subject>Computer Science</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories><title-group><article-title>Bayesian Multimodel Inference for Geostatistical Regression Models</article-title><alt-title alt-title-type="running-head">Bayesian Geostatistical Regression Models</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Johnson</surname>
            <given-names>Devin S.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Hoeting</surname>
            <given-names>Jennifer A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>National Oceanic and Atmospheric Administration (NOAA) National Marine Mammal Laboratory, Seattle, Washington, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Statistics, Colorado State University, Fort Collins, Colorado, United States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Schumann</surname>
            <given-names>Guy J.-P.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University of Bristol, United Kingdom</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">devin.johnson@noaa.gov</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: DSJ. Performed the experiments: DSJ JAH. Analyzed the data: DSJ. Contributed reagents/materials/analysis tools: DSJ. Wrote the paper: DSJ JAH.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <year>2011</year>
      </pub-date><pub-date pub-type="epub">
        <day>10</day>
        <month>11</month>
        <year>2011</year>
      </pub-date><volume>6</volume><issue>11</issue><elocation-id>e25677</elocation-id><history>
        <date date-type="received">
          <day>12</day>
          <month>5</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>9</day>
          <month>9</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><license><license-p>This is an open-access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the Creative Commons CC0 public domain dedication.</license-p></license></permissions><abstract>
        <p>The problem of simultaneous covariate selection and parameter inference for spatial regression models is considered. Previous research has shown that failure to take spatial correlation into account can influence the outcome of standard model selection methods. A Markov chain Monte Carlo (MCMC) method is investigated for the calculation of parameter estimates and posterior model probabilities for spatial regression models. The method can accommodate normal and non-normal response data and a large number of covariates. Thus the method is very flexible and can be used to fit spatial linear models, spatial linear mixed models, and spatial generalized linear mixed models (GLMMs). The Bayesian MCMC method also allows <italic>a priori</italic> unequal weighting of covariates, which is not possible with many model selection methods such as Akaike's information criterion (AIC). The proposed method is demonstrated on two data sets. The first is the whiptail lizard data set which has been previously analyzed by other researchers investigating model selection methods. Our results confirmed the previous analysis suggesting that sandy soil and ant abundance were strongly associated with lizard abundance. The second data set concerned pollution tolerant fish abundance in relation to several environmental factors. Results indicate that abundance is positively related to Strahler stream order and a habitat quality index. Abundance is negatively related to percent watershed disturbance.</p>
      </abstract><funding-group><funding-statement>This work was partially funded by STAR Research Assistance Agreement CR-829095 awarded to Colorado State University by the U.S. Environmental Protection Agency. The views expressed here are solely those of authors mentioned here. The research was partially completed while Johnson was at the Department of Mathematical Sciences and Institute of Arctic Biology, University of Alaska Fairbanks. Hoeting's work was also supported by NSF Grant EF-0914489. The funders had no role in the analysis, decision to publish, or preparation of the manuscript. Data were previously collected as part of the U.S. Environmental Protection Agency's EMAP water quality monitoring program conducted prior to the funding of this study.</funding-statement></funding-group><counts>
        <page-count count="8"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Ecologists and other environmental scientists often consider a large number of plausible regression models in an effort to explain ecological relationships between several covariates and a response variable. Model selection procedures, such as Akaike's information criterion (AIC), are routinely employed to help researchers decide upon an appropriate model to describe the environmental system <xref ref-type="bibr" rid="pone.0025677-Burnham1">[1]</xref>.</p>
      <p>In addition to the increase in the use of model selection methods, advancing technology has led to the routine use of global positioning systems (GPS) to collect spatially referenced data. The increase in spatial data collection has led environmental scientists to recognize that there may be substantial spatial correlation present in their data. As a result spatial correlation models have become more popular in recent years. Here we investigate a model selection method for geostatistical regression models. In addition to estimating regression coefficients, a geostatistical regression model involves fitting a spatial correlation function to the regression errors. This function allows correlation between observations to decrease as separation in space increases. These models are traditionally termed universal kriging models <xref ref-type="bibr" rid="pone.0025677-Cressie1">[2]</xref>. The kriging terminology, however, refers to spatial prediction and ecologists are often more interested in inference concerning the covariate portion of the model. Therefore, the term geostatistical regression is used for a spatially correlated regression analysis.</p>
      <p>In most regression model selection methods, spatial correlation is ignored. This can lead to erroneous inference of the importance of some covariates in explaining variation in the response variable <xref ref-type="bibr" rid="pone.0025677-VerHoef1">[3]</xref>. Hoeting et al. <xref ref-type="bibr" rid="pone.0025677-Hoeting1">[4]</xref> explore use of AIC for geostatistical regression models. Thompson <xref ref-type="bibr" rid="pone.0025677-Thompson1">[5]</xref> considers a Bayesian approach to geostatistical regression selection and model averaging predictions using integral approximations to obtain the necessary model weights.</p>
      <p>In this paper a Bayesian selection procedure for geostatistical regression models was investigated using a Markov chain Monte Carlo (MCMC) approach. Bayesian and MCMC methods are becoming increasingly popular in the ecological literature <xref ref-type="bibr" rid="pone.0025677-Link1">[6]</xref>–<xref ref-type="bibr" rid="pone.0025677-Sargeant1">[9]</xref>. Chapter 7 in Givens and Hoeting <xref ref-type="bibr" rid="pone.0025677-Givens1">[10]</xref> provides an introduction to MCMC procedures. Green <xref ref-type="bibr" rid="pone.0025677-Green1">[11]</xref> proposed reversible-jump MCMC (RJMCMC) as a method for traversing model space as well as parameter space. This allows one to make Bayesian inference on the model set in an MCMC setting.</p>
      <p>The RJMCMC method presented in this paper has several advantages. Many covariates can be examined through a stochastic model search. The prior weighting of the coefficients is another benefit over methods such as AIC. Certain covariates can be given more or less weight <italic>a priori</italic>. Methods such as AIC selection weight all covariates equally. The RJMCMC approach has one other major advantage over AIC and Bayesian closed form approximations, it is directly extendable to spatial generalized linear mixed models (GLMMs). This implies the RJMCMC approach can be an all purpose tool for geostatistical regression inference for Gaussian and non-Gaussian data. In order to demonstrate the method in either scenario, we present two example analyses. The first examines the previously analyzed whiptail lizard data set. We chose this data set as a way to assess the accuracy of the method. The whiptail data set has been analyzed several times <xref ref-type="bibr" rid="pone.0025677-VerHoef1">[3]</xref>–<xref ref-type="bibr" rid="pone.0025677-Thompson1">[5]</xref> with spatial regression models each time the same general model has been chosen. Thus, we analyzed it with our method to confirm the results. The second analysis examined fish abundance data using a Poisson spatial GLMM to illustrate the extension to non-normal data.</p>
    </sec>
    <sec id="s2" sec-type="methods">
      <title>Methods</title>
      <sec id="s2a">
        <title>Geostatistical regression models</title>
        <p>The geostatistical model <xref ref-type="bibr" rid="pone.0025677-Cressie1">[2]</xref> is a commonly used model for spatially referenced data in a continuous spatial domain. A general model that allows both normal and non-normal response data is presented so that the method can be applied in a variety of ecological studies. In order to account for spatial correlation in normal and non-normal data <xref ref-type="bibr" rid="pone.0025677-Diggle1">[12]</xref> propose using a spatial GLMM. The spatial GLMM approach uses a traditional GLM with a spatially correlated random effect in order to obtain spatial correlation in the observed data.</p>
        <p>Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e001" xlink:type="simple"/></inline-formula> be a set of spatially referenced measurable observations, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e002" xlink:type="simple"/></inline-formula> denotes a location in a spatial domain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e003" xlink:type="simple"/></inline-formula> (usually a two dimensional region). In a spatial GLMM the response variables, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e004" xlink:type="simple"/></inline-formula> are assumed to be independent given an underlying Gaussian spatial process <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e005" xlink:type="simple"/></inline-formula> and the vector of covariates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e006" xlink:type="simple"/></inline-formula>. That is to say <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e007" xlink:type="simple"/></inline-formula> is distributed according to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e008" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e009" xlink:type="simple"/></inline-formula> is the conditional mean of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e010" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e011" xlink:type="simple"/></inline-formula> is a link function.</p>
        <p>The geostatistical process <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e012" xlink:type="simple"/></inline-formula> is assumed to have the normal distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e013" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e014" xlink:type="simple"/></inline-formula> is a matrix of covariates with each row associated with site <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e015" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e016" xlink:type="simple"/></inline-formula>. The spatial covariance matrix is defined by the spatial covariance function of the form<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.e017" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e018" xlink:type="simple"/></inline-formula> is an isotropic correlation function, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e019" xlink:type="simple"/></inline-formula> is a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e020" xlink:type="simple"/></inline-formula> positive definite matrix that allows for geometric anisotropy <xref ref-type="bibr" rid="pone.0025677-Cressie1">[2]</xref>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e021" xlink:type="simple"/></inline-formula> is the sill parameter, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e022" xlink:type="simple"/></inline-formula> is the nugget parameter. The correlation function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e023" xlink:type="simple"/></inline-formula> may take many forms. Typical choices are the exponential, Matern, or spherical correlation functions <xref ref-type="bibr" rid="pone.0025677-Bailey1">[13]</xref>, <xref ref-type="bibr" rid="pone.0025677-Stein1">[14]</xref>.</p>
        <p>The joint density of the observations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e024" xlink:type="simple"/></inline-formula> and the spatial process <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e025" xlink:type="simple"/></inline-formula> is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e026" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e027" xlink:type="simple"/></inline-formula> is a vector of the five spatial covariance parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e028" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e029" xlink:type="simple"/></inline-formula> and the unique elements of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e030" xlink:type="simple"/></inline-formula>. Hence, the likelihood for the geostatistical regression model is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e031" xlink:type="simple"/></inline-formula>. There is only one common observation model for which this likelihood can be obtained in closed form, the normal distribution. In this case, the resulting likelihood is the multivariate normal <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e032" xlink:type="simple"/></inline-formula> distribution.</p>
      </sec>
      <sec id="s2b">
        <title>Bayesian inference</title>
        <p>As the model is presented in the previous section there are significant difficulties in making Bayesian inference. Previous MCMC analysis of spatial data has noted a high posterior correlation between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e033" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e034" xlink:type="simple"/></inline-formula> making MCMC samplers slow to converge <xref ref-type="bibr" rid="pone.0025677-Christensen1">[15]</xref>. Therefore, we use the alternate parameterization <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e035" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e036" xlink:type="simple"/></inline-formula>. This significantly reduced correlation in the MCMC samples the examples considered herein.</p>
        <p>In addition, because <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e037" xlink:type="simple"/></inline-formula> must remain positive definite (i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e038" xlink:type="simple"/></inline-formula> for all vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e039" xlink:type="simple"/></inline-formula>) there are several awkward constraints on the entries of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e040" xlink:type="simple"/></inline-formula>. To remove the constraints, we reparameterized by factoring the anisotropy parameters as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e041" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e042" xlink:type="simple"/></inline-formula> is a diagonal matrix with positive elements and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e043" xlink:type="simple"/></inline-formula> is a positive definite correlation matrix. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e044" xlink:type="simple"/></inline-formula>. Any <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e045" xlink:type="simple"/></inline-formula> is valid allowing a large range of possible priors. Due to the fact that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e046" xlink:type="simple"/></inline-formula> is a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e047" xlink:type="simple"/></inline-formula> correlation matrix, it has but one parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e048" xlink:type="simple"/></inline-formula> that represents the angle of anisotropy. The valid range of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e049" xlink:type="simple"/></inline-formula> in that case is (−1, 1). The elements of the original anisotropy matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e050" xlink:type="simple"/></inline-formula> can be rewritten as functions of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e051" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e052" xlink:type="simple"/></inline-formula>, so <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e053" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e054" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e055" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e056" xlink:type="simple"/></inline-formula>. The resulting collection of spatial correlation and variance parameters is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e057" xlink:type="simple"/></inline-formula>.</p>
      </sec>
      <sec id="s2c">
        <title>Model uncertainty</title>
        <p>Bayesian inference for the spatial regression model is based on the posterior distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e058" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e059" xlink:type="simple"/></inline-formula> is the parameter prior distribution. Desired quantities for summarization of the density are usually in the form of expected values, for example posterior means, variances, and percentiles or credible intervals. The posterior density is intractable; therefore, these quantities can be approximated from an MCMC sample.</p>
        <p>The Bayesian approach to model uncertainty assumes that the model itself, like the parameter values, is an unknown entity. Therefore, the joint posterior distribution of the parameters and the model is of interest. The joint posterior for model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e060" xlink:type="simple"/></inline-formula> is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.e061" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e062" xlink:type="simple"/></inline-formula> is the prior probability of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e063" xlink:type="simple"/></inline-formula>th model and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e064" xlink:type="simple"/></inline-formula> is a vector of coefficients for the covariates in model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e065" xlink:type="simple"/></inline-formula>. A classic model prior for regression analysis is derived by treating inclusion of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e066" xlink:type="simple"/></inline-formula> coefficients as a series of independent Bernoulli trials with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e067" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pone.0025677-Clyde1">[16]</xref>. The result is the following prior<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.e068" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e069" xlink:type="simple"/></inline-formula> is an indicator that covariate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e070" xlink:type="simple"/></inline-formula> is included in the regression model. This prior includes the uniform prior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e071" xlink:type="simple"/></inline-formula>; obtained by setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e072" xlink:type="simple"/></inline-formula>.</p>
        <p>In most model selection problems the object of inference is not the joint model-parameter posterior, it is the marginal posterior distribution of the model set. This marginal distribution is the posterior model probability (PMP) for model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e073" xlink:type="simple"/></inline-formula>, given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.e074" xlink:type="simple"/><label>(4)</label></disp-formula>The PMP is almost always unobtainable in closed form. Typically, the model with the largest PMP is selected. Alternatively, one may not want to select a specific model, but use all of the models, appropriately weighted by their PMPs, in an ensemble fashion. Hoeting et al. <xref ref-type="bibr" rid="pone.0025677-Hoeting2">[17]</xref> provide a detailed description of this type of inference termed Bayesian Model Averaging (BMA).</p>
        <p>This paper will use both BMA and maximum PMP to make inference concerning the importance of each covariate in explaining an ecological or environmental response. The maximum PMP model provides information on important covariates. Another quantity, the posterior inclusion probability (PIP), is also useful in regression settings. The PIP for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e075" xlink:type="simple"/></inline-formula>th covariate is defined<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.e076" xlink:type="simple"/><label>(5)</label></disp-formula>This is the model averaged posterior probability of inclusion of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e077" xlink:type="simple"/></inline-formula>th covariate. The PIP for each covariate provides a measure of importance of each covariate to the response.</p>
      </sec>
      <sec id="s2d">
        <title>Reversible-Jump MCMC</title>
        <p>Unlike ordinary regression, closed forms of the PMPs and PIPs cannot be obtained for spatial regression models. Green <xref ref-type="bibr" rid="pone.0025677-Green1">[11]</xref> proposed the RJMCMC method for sampling from the joint space of the parameters and model. The key difference between MCMC and RJMCMC is that the parameter space changes as the chain moves between models. This makes the algorithm construction more complex. Sample averages can then be used to approximate expected values of model and parameter functions, such as PMPs and PIPs.</p>
        <p>A major challenge of the general RJMCMC method is that a double proposal is necessary to move to a different model. First, an appropriate model must be proposed, followed by an acceptable proposal for the parameters of the model. If either of these two proposals is inefficient then the chain will fail to mix well and a large number of iterations will be necessary to do posterior model inference. This can make computations very slow in the spatial regression case because the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e078" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e079" xlink:type="simple"/></inline-formula> covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e080" xlink:type="simple"/></inline-formula> that must be inverted at every MCMC iteration.</p>
        <p>In order to avoid long RJMCMC runs with spatial regression models an efficient proposal scheme is necessary. Godsill <xref ref-type="bibr" rid="pone.0025677-Godsill1">[18]</xref> suggested a general proposal method for model classes where some of the parameters are shared among each model. In the spatial regression case, the spatial parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e081" xlink:type="simple"/></inline-formula> are common to all of the models, whereas <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e082" xlink:type="simple"/></inline-formula> differs for each model. If the conditional posterior distribution of the model given the shared parameters is available than a more efficient Partial Analytic RJMCMC (PARJ) algorithm can be constructed. Using the basic idea of Godsill, a PARJ chain was constructed for spatial regression model moves in the following manner. For a current state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e083" xlink:type="simple"/></inline-formula>,</p>
        <list list-type="order">
          <list-item>
            <p>Update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e084" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e085" xlink:type="simple"/></inline-formula> using the full conditional distributions as in a standard Gibbs sampler (details in <xref ref-type="supplementary-material" rid="pone.0025677.s001">File S1</xref>).</p>
          </list-item>
          <list-item>
            <p>Update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e086" xlink:type="simple"/></inline-formula> with PARJ as follows                    <list list-type="alpha-lower"><list-item><p>Propose model move to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e087" xlink:type="simple"/></inline-formula> with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e088" xlink:type="simple"/></inline-formula>,</p></list-item><list-item><p>Propose <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e089" xlink:type="simple"/></inline-formula>,</p></list-item><list-item><p>Set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e090" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e091" xlink:type="simple"/></inline-formula>,</p></list-item><list-item><p>Accept <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e092" xlink:type="simple"/></inline-formula> with probability<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.e093" xlink:type="simple"/><label>(6)</label></disp-formula></p></list-item></list>                </p>
          </list-item>
          <list-item>
            <p>Update the entire vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e094" xlink:type="simple"/></inline-formula> using a Langevin-Hastings proposal <xref ref-type="bibr" rid="pone.0025677-Christensen2">[19]</xref> (See <xref ref-type="supplementary-material" rid="pone.0025677.s001">File S1</xref> for details).</p>
          </list-item>
        </list>
        <p>Upon examination of (6), one can see there is no need to draw <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e095" xlink:type="simple"/></inline-formula> proposal values due to the fact that the conditional distribution<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.e096" xlink:type="simple"/><label>(7)</label></disp-formula>is available in closed form when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e097" xlink:type="simple"/></inline-formula>. Details of the calculation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e098" xlink:type="simple"/></inline-formula> are given in <xref ref-type="supplementary-material" rid="pone.0025677.s001">File S1</xref>. In the present examples we use a discrete random walk for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e099" xlink:type="simple"/></inline-formula>. First, a covariate is chosen with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e100" xlink:type="simple"/></inline-formula>, if it is already in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e101" xlink:type="simple"/></inline-formula>, it is removed in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e102" xlink:type="simple"/></inline-formula> if it is not in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e103" xlink:type="simple"/></inline-formula> it is added. Thus, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e104" xlink:type="simple"/></inline-formula>. <xref ref-type="table" rid="pone-0025677-t001">Table 1</xref> summarizes the steps in the PARJ algorithm. In the following sections we demonstrate the method with the analysis of two separate data sets.</p>
        <table-wrap id="pone-0025677-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0025677.t001</object-id><label>Table 1</label><caption>
            <title>Steps in PARJ algorithm for geostatistical regression models.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0025677-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Step</td>
                <td align="left" colspan="1" rowspan="1">Update type</td>
                <td align="left" colspan="1" rowspan="1">Proposal distribution<xref ref-type="table-fn" rid="nt102">a</xref></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">1. Update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e105" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">Metropolis</td>
                <td align="left" colspan="1" rowspan="1">Gaussian</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">2. Update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e106" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">Metropolis</td>
                <td align="left" colspan="1" rowspan="1">Truncated uniform (−1, 1)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">3. Update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e107" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">Metropolis</td>
                <td align="left" colspan="1" rowspan="1">Gaussian</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">4. Update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e108" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">Metropolis</td>
                <td align="left" colspan="1" rowspan="1">Gaussian</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">5. Update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e109" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">PARJ</td>
                <td align="left" colspan="1" rowspan="1">Discrete random walk</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">6. Update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e110" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">Gibbs</td>
                <td align="left" colspan="1" rowspan="1">Gaussian<xref ref-type="table-fn" rid="nt103">b</xref></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">7<xref ref-type="table-fn" rid="nt104">c</xref>. Update <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e111" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">Langevin-Hastings</td>
                <td align="left" colspan="1" rowspan="1">Gaussian</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>The pollution intolerant fish abundance data were analyzed using the following model and parameter updating scheme. All Metropolis proposal distributions are random walks centered on the current parameter value.</p>
            </fn>
            <fn id="nt102">
              <label>a</label>
              <p>Metropolis proposal distributions are centered on the current parameter value.</p>
            </fn>
            <fn id="nt103">
              <label>b</label>
              <p>Full conditional distribution.</p>
            </fn>
            <fn id="nt104">
              <label>c</label>
              <p>Step 7 is only necessary for spatial GLMMs.</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s2e">
        <title>Example 1: Analysis of Whiptail Lizard Abundance</title>
        <p>The proposed model selection methodology was applied to the previously analyzed whiptail lizard data set in order the compare the RJMCMC method to other more traditional methods. The data were initially analyzed using a stepwise procedure with a spatial correlation correction <xref ref-type="bibr" rid="pone.0025677-VerHoef1">[3]</xref>. The data were subsequently analyzed using a BIC approximation to the PMP <xref ref-type="bibr" rid="pone.0025677-Thompson1">[5]</xref> and finally using AIC <xref ref-type="bibr" rid="pone.0025677-Hoeting1">[4]</xref>. Each of these analyses demonstrate the danger of ignoring spatial correlation when selecting covariates. A larger model is often selected to account for the ignored correlation. We used this data set to determine whether the method and proposed RJMCMC algorithm performed as expected.</p>
        <p>The data set is composed of abundance data of the Orange-throated whiptail lizard in Southern California. At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e112" xlink:type="simple"/></inline-formula> = 149 locations where lizards were observed the average number of lizards trapped during a week long trapping period was recorded. The response variable analyzed is the log transformed value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e113" xlink:type="simple"/></inline-formula> = ln(average no. trapped at location <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e114" xlink:type="simple"/></inline-formula>).</p>
        <p>Several covariates were collected to investigate which environmental conditions explain lizard abundance. The original set of environmental covariates contained 37 variables. After initial screening <xref ref-type="bibr" rid="pone.0025677-Thompson1">[5]</xref> six covariates remained which held potential to explain lizard abundance: Crematogaster ant abundance (3 levels - low, medium, high), log percent sandy soils, elevation, a bare rock indicator, percent cover, and log percent chaparral plants. Using indicators for ant level 1 and 2, there are 128 possible models. All 6 covariates were normalized to have mean zero and variance 1.</p>
        <p>The PARJ approach was used to select covariates with spatial correlation present. Here, the full spatial model is used with nugget and anisotropy. The exponential function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e115" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e116" xlink:type="simple"/></inline-formula> was used to model spatial correlation. None of the previous analyses included anisotropy effects. In addition, a model without spatial correlation was analyzed as well to determine any effects that might occur when correlation is ignored in the selection process.</p>
        <p>Following <xref ref-type="bibr" rid="pone.0025677-Thompson1">[5]</xref> and <xref ref-type="bibr" rid="pone.0025677-Raftery1">[20]</xref>, the mean and variance of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e117" xlink:type="simple"/></inline-formula> normal prior was chosen to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e118" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e119" xlink:type="simple"/></inline-formula> the sample mean of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e120" xlink:type="simple"/></inline-formula>. The prior covariance was chosen to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e121" xlink:type="simple"/></inline-formula>. Priors for the variance parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e122" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e123" xlink:type="simple"/></inline-formula> where chosen to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e124" xlink:type="simple"/></inline-formula>. The sample variance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e125" xlink:type="simple"/></inline-formula>, therefore, a prior variance of 10 on the log variance parameters provided adequate coverage over the set of realistic values of the partial sill and nugget. For each range parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e126" xlink:type="simple"/></inline-formula>, a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e127" xlink:type="simple"/></inline-formula> prior distribution was used. Automatically choosing extremely large variances for the range priors can put an unrealistic amount of mass on ranges well beyond maximum observed distances, which can adversely affect results. A variance of 1 distributed 90% of the prior mass of the correlation range (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e128" xlink:type="simple"/></inline-formula>) less than the maximum observed distance. A uniform distribution can be used for a noninformative prior on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e129" xlink:type="simple"/></inline-formula>, however, a triangular distribution over (−1, 1) and centered on 0 produced a more stable MCMC analysis. This was due to the fact that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e130" xlink:type="simple"/></inline-formula> values near <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e131" xlink:type="simple"/></inline-formula> tended to cause inconsistencies in the covariance structure.</p>
        <p>The PARJ chain was run for 100,000 iterations following a sufficient burn-in period. See <xref ref-type="table" rid="pone-0025677-t002">Table 2</xref> for a list of tuning parameters used in the RJMCMC within model moves. We did not thin the chain as that is primarily a tool to relieve storage issues for high dimensional parameters. The number of parameters in this analysis (and the following example) is not that great as to cause computer storage problems. However, if one would like to monitor model averaged predicted values of the response variable at many sites, thinning may become necessary. In order to judge whether the run length was acceptable, the Heidleberger-Welch diagnostic test <xref ref-type="bibr" rid="pone.0025677-Heidelberger1">[21]</xref> was performed on the parameters common to all models. Visual inspection also confirmed that this was an acceptable chain length. See <xref ref-type="supplementary-material" rid="pone.0025677.s002">File S2</xref> for more details and figures. The analysis was performed using the R statistical package. Code is available in the <xref ref-type="supplementary-material" rid="pone.0025677.s003">File S3</xref>.</p>
        <table-wrap id="pone-0025677-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0025677.t002</object-id><label>Table 2</label><caption>
            <title>Proposal distributions for RJMCMC within model moves of each analysis.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0025677-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.t002" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Parameter</td>
                <td align="left" colspan="1" rowspan="1">Whiptail lizard</td>
                <td align="left" colspan="1" rowspan="1">Fish abundance</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e132" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e133" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e134" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e135" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e136" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e137" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e138" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e139" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e140" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e141" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e142" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e143" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt105">
              <label/>
              <p>Each proposal was a random walk, therefore it is centered on the previous parameter value in the RJMCMC iteration.</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s2f">
        <title>Example 2: Abundance of Pollution Tolerant Fish</title>
        <p>In this section the PARJ approach is demonstrated on a data set of fish counts for several geographically referenced sites. A Poisson model with spatially correlated random effects model is adopted for the observed counts. Model selection analysis is performed to determine which of several environmental factors contribute to overall abundance of pollution-intolerant fish.</p>
        <p>In 1994 and 1995 numerous stream sites in the Mid-Atlantic region of the Unites States (Maryland, Pennsylvania, Virginia, West Virginia) were visited as part of the U.S. Environmental Protection Agency's EMAP water quality monitoring program. Several stream characteristics were measured to assess water quality. At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e144" xlink:type="simple"/></inline-formula> sites fish were sampled and classified according to their pollution tolerance. When assessing water quality the abundance of pollution intolerant fish at a site is often a good index.</p>
        <p>The emphasis of the analysis is the effects of pollution and stream quality variables, however, there are several natural factors which might also influence abundance. The natural covariates include Strahler stream order (ORDER), elevation (ELEV), and watershed area (WSA). The remaining covariates can be modified by human use and, therefore, were considered potential stream quality variables. Stream quality variables included: road density in the watershed (RD) (No./area), percentage of watershed classified as disturbed by human activity (DISTOT), an index of fish habitat quality at the stream site (HAB), concentration of dissolved oxygen in the stream at the sampling site (DO), % areal fish cover at the sampling site (XFC), and percent sand in stream bed substrate (PCT). Strahler order is a measure of how far a particular section of stream is from its headwater sources. For example, headwater streams have order 1. Two order 1 streams merge to form an order 2 stream, etc. Thus ORDER is an index of stream size and relative location in the watershed. The covariates in this analysis have vastly different scales, therefore, to increase MCMC mixing, the covariates were standardized to have mean 0 and variance 1.</p>
        <p>It is believed <italic>a priori</italic> that the natural variables should be included in the final model, but, this is not known with certainty. Therefore, the natural variables will be more heavily weighted in the prior model probabilities. For the natural variables prior inclusion probabilities were set to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e145" xlink:type="simple"/></inline-formula>, while for the remaining disturbance variables <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e146" xlink:type="simple"/></inline-formula>. This <italic>a priori</italic> weighting illustrates one of the advantages of the Bayesian approach to selection. In addition, the data were also analyzed with a flat model prior (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e147" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e148" xlink:type="simple"/></inline-formula>) to examine sensitivity of this prior weighting.</p>
        <p>A Poisson distribution with the canonical log link function is chosen for the abundance model. So, the likelihood is given as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.e149" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e150" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e151" xlink:type="simple"/></inline-formula>.</p>
        <p>Priors for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e152" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e153" xlink:type="simple"/></inline-formula> were chosen to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e154" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e155" xlink:type="simple"/></inline-formula> respectively. Here we chose a flatter prior for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e156" xlink:type="simple"/></inline-formula> than in the previous example in order to have minimal prior influence on the coefficients. This was the first examination of this data in a model selection context, whereas we chose a more informative prior in the whiptail analysis so the results were comparable to previous analyses. As in the previous example, a variance of 10 for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e157" xlink:type="simple"/></inline-formula> prior placed significant mass beyond the scale of the measured data, therefore, it was sufficiently vague, but still proper. An isotropic exponential spatial correlation model was used for covariate selection after initial analysis of the full model suggested no significant anisotropy or nugget effect. The Poisson observation model essentially takes the place of the nugget measurement error variability in the Gaussian process. We assumed that the range parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e158" xlink:type="simple"/></inline-formula> followed a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e159" xlink:type="simple"/></inline-formula> distribution. This prior placed more than 90% of the prior mass below the maximum observed range to maintain stable inference.</p>
        <p>The PARJ chain was run for 300,000 iterations after a sufficient initial burn-in. <xref ref-type="table" rid="pone-0025677-t002">Table 2</xref> presents the proposal distributions used for within model moves. In the Langevin-Hastings updates of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e160" xlink:type="simple"/></inline-formula>, a value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e161" xlink:type="simple"/></inline-formula> was used providing an acceptance rate of approximately 50%. New models were proposed via the random walk approach of randomly selecting a covariate for addition or deletion from the current model. See <xref ref-type="supplementary-material" rid="pone.0025677.s002">File S2</xref> for the convergence diagnostic analysis. Code for analysis within the R statistical language is available in <xref ref-type="supplementary-material" rid="pone.0025677.s003">File S3</xref>.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <sec id="s3a">
        <title>Example 1: Analysis of Whiptail Lizard Abundance</title>
        <p>The top five models in PMP are given in <xref ref-type="table" rid="pone-0025677-t003">Table 3</xref>. The PARJ algorithm visited 114 out of 128 possible models. The top model included Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e162" xlink:type="simple"/></inline-formula> and log percent sandy soil. With only 17.8% posterior model mass, however, there is considerable uncertainty in the best model. Under the independence assumption, the top PMP model includes: Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e163" xlink:type="simple"/></inline-formula>, log percent sandy soil, and log percent chaparral (PMP = 30.8%). The top spatial regression model ranks 5th in order with a PMP of only 5.5% under the independence assumption. <xref ref-type="table" rid="pone-0025677-t004">Table 4</xref> shows the PIPs for each of the covariates. In addition, the table also shows the PIPs for the analysis without spatial correlation. When spatial correlation is included, log percent sandy soil is the only covariate with a PIP greater than 50%. When spatial correlation is ignored during the selection process <xref ref-type="table" rid="pone-0025677-t004">Table 4</xref> illustrates that a different model inference is obtained. Without a spatial model Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e164" xlink:type="simple"/></inline-formula> becomes a virtually certain inclusion and log percent chaparral also enters as an important variable along with log percent sandy soil.</p>
        <table-wrap id="pone-0025677-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0025677.t003</object-id><label>Table 3</label><caption>
            <title>Model selection results for the California lizard data set.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0025677-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.t003" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Variables in model</td>
                <td align="left" colspan="1" rowspan="1">Spatial PMP</td>
                <td align="left" colspan="1" rowspan="1">Independent PMP (rank)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e165" xlink:type="simple"/></inline-formula>, log % Sandy soil</td>
                <td align="left" colspan="1" rowspan="1">17.8</td>
                <td align="left" colspan="1" rowspan="1">5.5 (5)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">log % Sandy soil</td>
                <td align="left" colspan="1" rowspan="1">13.9</td>
                <td align="left" colspan="1" rowspan="1">★</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e166" xlink:type="simple"/></inline-formula>, log % Sandy soil, % Cover</td>
                <td align="left" colspan="1" rowspan="1">11.7</td>
                <td align="left" colspan="1" rowspan="1">★</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">log % Sandy soil, % Cover</td>
                <td align="left" colspan="1" rowspan="1">10.1</td>
                <td align="left" colspan="1" rowspan="1">★</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e167" xlink:type="simple"/></inline-formula>, log % Sandy soil</td>
                <td align="left" colspan="1" rowspan="1">4.5</td>
                <td align="left" colspan="1" rowspan="1">★</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt106">
              <label/>
              <p>The top five models in PMP are shown. The PARJ chain visited 114 out of 128 possible models in the spatial analysis and 90 models were visited in the independence model. The table is ordered by PMP of the spatial regression analysis.</p>
            </fn>
            <fn id="nt107">
              <label>★</label>
              <p>indicates PMP<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e168" xlink:type="simple"/></inline-formula>1.0 and Rank<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e169" xlink:type="simple"/></inline-formula>18.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <table-wrap id="pone-0025677-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0025677.t004</object-id><label>Table 4</label><caption>
            <title>Posterior inclusion probabilities (PIP) for the California lizard data.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0025677-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.t004" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Environmental Covariate</td>
                <td align="left" colspan="1" rowspan="1">Spatial PIP</td>
                <td align="left" colspan="1" rowspan="1">Independent PIP</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e170" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">49.5</td>
                <td align="left" colspan="1" rowspan="1">99.8</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e171" xlink:type="simple"/></inline-formula></td>
                <td align="left" colspan="1" rowspan="1">14.5</td>
                <td align="left" colspan="1" rowspan="1">22.0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">ln % Sandy Soil</td>
                <td align="left" colspan="1" rowspan="1">88.4</td>
                <td align="left" colspan="1" rowspan="1">75.3</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Elevation</td>
                <td align="left" colspan="1" rowspan="1">20.5</td>
                <td align="left" colspan="1" rowspan="1">29.4</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Bare Rock</td>
                <td align="left" colspan="1" rowspan="1">6.1</td>
                <td align="left" colspan="1" rowspan="1">10.7</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">% Cover</td>
                <td align="left" colspan="1" rowspan="1">34.9</td>
                <td align="left" colspan="1" rowspan="1">11.8</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">ln % Chaparral</td>
                <td align="left" colspan="1" rowspan="1">7.0</td>
                <td align="left" colspan="1" rowspan="1">76.6</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt108">
              <label/>
              <p>The first column of probabilities are results from a spatial analysis with nugget and anisotropy parameters present in the model. The second column of probabilities resulted from an independence model.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>The fact that log percent chaparral enters the model in the independence case but is absent in the spatial model could be due to a spurious regional effect. At nearby sites both the response and covariate are likely to have similar values due the spatial correlation of each variable. In the sample, high response values seem to be associated with high covariate values, but it is really the proximity of the sites to one another that is driving the relationship. The same is also no doubt true for the PIP increase in the Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e172" xlink:type="simple"/></inline-formula> covariate.</p>
        <p>The results obtained herein are similar to the previously mentioned analyses of this data. Using an isotropic Matern model with nugget <xref ref-type="bibr" rid="pone.0025677-Thompson1">[5]</xref>, noted that log percent sandy soil seemed to be the most important covariate. Hoeting et al. <xref ref-type="bibr" rid="pone.0025677-Hoeting1">[4]</xref> noted that the highest AIC model contained Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e173" xlink:type="simple"/></inline-formula> and log % sandy soil. While the MCMC analysis did not pick the full model under the independence assumption as AIC does <xref ref-type="bibr" rid="pone.0025677-Hoeting1">[4]</xref>, certainly more weight was placed on the other covariates. Using a spatial stepwise selection <xref ref-type="bibr" rid="pone.0025677-VerHoef1">[3]</xref> also noted that the best model was one that contained ant abundance and log % sandy soil.</p>
        <p>In addition to the model inference obtained through the PARJ method, <xref ref-type="fig" rid="pone-0025677-g001">Figure 1</xref> shows the marginal posterior density estimates for the top four PIP coefficients. Using these distributions direction and magnitude of the covariate effects can be examined after accounting for model uncertainty. Relative to high ant abundance, the presence of low ant abundance negatively influences lizard abundance. This should be expected as the ants are the main prey source. Lizard abundance is positively related to the percent of sandy soil in the substrate. The remaining coefficients, elevation and percent cover, have smaller PIP as can be seen in <xref ref-type="fig" rid="pone-0025677-g001">Figure 1</xref> by the size of the bar relative to the density curve. Elevation seems to have neither strong positive or negative influence as the density curve is centered at zero. There seems to be a positive influence of percent cover, but there is substantial probability (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e174" xlink:type="simple"/></inline-formula>) that it is equal to zero.</p>
        <fig id="pone-0025677-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0025677.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Marginal posterior density estimates for the top 4 PIP regression coefficients in the lizard abundance analysis.</title>
            <p>Included are coefficients are: Ant<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e175" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e176" xlink:type="simple"/></inline-formula>), log % sand (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e177" xlink:type="simple"/></inline-formula>), Elevation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e178" xlink:type="simple"/></inline-formula>), and % cover (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e179" xlink:type="simple"/></inline-formula>). Vertical bars represent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e180" xlink:type="simple"/></inline-formula> and the density curve is a kernel estimate conditioned on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e181" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.g001" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s3b">
        <title>Example 2: Abundance of Pollution Tolerant Fish</title>
        <p>During the analysis, the PARJ chain visited 419 out of 512 possible models. The top five models, as determined by PMP, are given in <xref ref-type="table" rid="pone-0025677-t005">Table 5</xref>. The results indicate that there is considerable uncertainty; the maximum <italic>a posteriori</italic> model accounts for only 12.4% of the total probability mass in the informative model and 17.8% of the mass in the flat prior analysis. The top PMP model coincides in each analysis. The models containing the predictors WSA and ELEV in the informative prior analysis ranked lower and had a smaller PMP than in the flat prior analysis. This suggests that WSA and ELEV are not as important to intolerant fish abundance as was described by the informative prior. This also explains the increase in maximum PMP. The data contradict the informative prior which leads to an increase in model uncertainty. Three covariates stand out as having significant probability (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e182" xlink:type="simple"/></inline-formula>) of inclusion in the regression model, stream order (ORDER), percentage of watershed disturbed by human use (DISTOT), and habitat quality (HAB) (<xref ref-type="table" rid="pone-0025677-t006">Table 6</xref>). The same is true of the flat prior analysis. The PIPs are much smaller for ELEV and WSA than the informative model prior, leading to the conclusion that they are not as important to intolerant fish abundance <italic>a posteriori</italic>. All other covariates remain relatively unchanged with respect to PIP.</p>
        <table-wrap id="pone-0025677-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0025677.t005</object-id><label>Table 5</label><caption>
            <title>Model selection results for the fish tolerance data set.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0025677-t005-5" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.t005" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Variables in model</td>
                <td align="left" colspan="1" rowspan="1">Informative PMP</td>
                <td align="left" colspan="1" rowspan="1">Flat PMP (rank)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">ORDER, DISTOT, HAB</td>
                <td align="left" colspan="1" rowspan="1">12.4</td>
                <td align="left" colspan="1" rowspan="1">17.8 ( 1)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">ORDER, WSA, DISTOT, HAB</td>
                <td align="left" colspan="1" rowspan="1">5.9</td>
                <td align="left" colspan="1" rowspan="1">2.9 ( 6)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">ORDER, RD, HAB,</td>
                <td align="left" colspan="1" rowspan="1">5.4</td>
                <td align="left" colspan="1" rowspan="1">8.9 ( 2)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">ORDER, ELEV, DISTOT, HAB</td>
                <td align="left" colspan="1" rowspan="1">4.8</td>
                <td align="left" colspan="1" rowspan="1">2.4 (10)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">ORDER, RD, DISTOT, HAB</td>
                <td align="left" colspan="1" rowspan="1">3.8</td>
                <td align="left" colspan="1" rowspan="1">5.5 ( 3)</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt109">
              <label/>
              <p>Listed are the explanatory covariates selected using the PMP criterion. The table is ordered according to the PMPs of the informative prior analysis.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <table-wrap id="pone-0025677-t006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0025677.t006</object-id><label>Table 6</label><caption>
            <title>Posterior inclusion probabilities (PIP) for the MAHA pollution intolerant fish data.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0025677-t006-6" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.t006" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Environmental covariate</td>
                <td align="left" colspan="1" rowspan="1">Informative PIP</td>
                <td align="left" colspan="1" rowspan="1">Flat PIP</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">ORDER</td>
                <td align="left" colspan="1" rowspan="1">88.3</td>
                <td align="left" colspan="1" rowspan="1">84.1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">ELEV</td>
                <td align="left" colspan="1" rowspan="1">29.1</td>
                <td align="left" colspan="1" rowspan="1">12.4</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">WSA</td>
                <td align="left" colspan="1" rowspan="1">42.6</td>
                <td align="left" colspan="1" rowspan="1">28.2</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">RD</td>
                <td align="left" colspan="1" rowspan="1">38.0</td>
                <td align="left" colspan="1" rowspan="1">40.1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">DISTOT</td>
                <td align="left" colspan="1" rowspan="1">78.7</td>
                <td align="left" colspan="1" rowspan="1">76.3</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">HAB</td>
                <td align="left" colspan="1" rowspan="1">73.8</td>
                <td align="left" colspan="1" rowspan="1">74.4</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">DO</td>
                <td align="left" colspan="1" rowspan="1">14.8</td>
                <td align="left" colspan="1" rowspan="1">14.1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">XFC</td>
                <td align="left" colspan="1" rowspan="1">10.1</td>
                <td align="left" colspan="1" rowspan="1">10.4</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">PCT</td>
                <td align="left" colspan="1" rowspan="1">13.2</td>
                <td align="left" colspan="1" rowspan="1">13.6</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt110">
              <label/>
              <p>The first column gives PIPs for the informative model prior analysis. The second column gives PIPs for the flat model prior analysis.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p><xref ref-type="fig" rid="pone-0025677-g002">Figure 2</xref> illustrates the estimated marginal posterior densities for the four parameters: ORDER, WSA, DISTOT, and HAB. ORDER is positively related to intolerant fish abundance. WSA is also positively related to intolerant fish abundance, however, there is not strong evidence of a significant effect. Abundance is negatively related to DISTOT and positively related to HAB. Investigation of the scale of coefficient values for DISTOT and HAB shows that DISTOT seems to have a larger magnitude effect than HAB, suggesting a larger effect of watershed scale disturbance over site level effects. In fact, the PARJ output can be used to determine the model averaged posterior distribution of the ratio of the coefficients for DISTOT to HAB. The posterior probability that DISTOT has a larger magnitude coefficient is 60.4%, providing some evidence of a larger watershed level effect. When both variables are included in the model, however, the 95% highest posterior probability interval for the ratio of absolute coefficient values is 0.00–4.93, indicating the evidence is not strong.</p>
        <fig id="pone-0025677-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0025677.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Marginal posterior density estimates for the top four PIP regression coefficients in the fish abundance analysis.</title>
            <p>Included are coefficients are: Strahler order (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e183" xlink:type="simple"/></inline-formula>), Watershed area (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e184" xlink:type="simple"/></inline-formula>), % watershed area disturbed by human use (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e185" xlink:type="simple"/></inline-formula>), and habitat quality (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e186" xlink:type="simple"/></inline-formula>). Vertical bars represent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e187" xlink:type="simple"/></inline-formula> and the density curve is a kernel estimate conditioned on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e188" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.g002" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>To date, Bayesian methods of model selection and multimodel inference (i.e. model averaging) have not been utilized in great numbers of published research endeavors. No doubt this is due to the fact that PMPs are usually never available in closed form for many of the models typically used in ecology. This is also true, however, for information criterion such as AIC when generalized linear mixed models are utilized.</p>
      <p>The Partial Analytic RJMCMC presented here should be considered a worthy competitor for information criterion methods such as AIC for spatial regression models. First, there is a practical implementation argument. The PARJ algorithm provides a consistent inference methodology for spatial regression modeling. This same method can be used for normal distribution models as well as spatial GLMMs for non-normal data such as counts. While an “off-the-shelf” RJMCMC procedure is often challenging to implement, the PARJ version is not any more difficult to program than a standard Gibbs MCMC sampler for a spatial regression model. One needs only add a model-jumping step. The analyses presented here were programmed in R where run times were on the order of a couple hours for the fish data. The second benefit of a PARJ is that it is Bayesian in nature. The PARJ approach allows information that the researcher possesses about the covariates to enter into the inference. The covariates can be weighted differentially <italic>a priori</italic>.</p>
      <p>The PARJ method presented here is not limited to geostatistical regression models. Any covariance model can be used for the the latent process variable <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0025677.e189" xlink:type="simple"/></inline-formula>. The PARJ method can be easily modified to make model inference with time series correlation or correlation due to factor random effects. This fact makes this method even more appealing as a general procedure for correlated data regression modeling.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pone.0025677.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.s001" xlink:type="simple">
        <label>File S1</label>
        <caption>
          <p><bold>Reversible-jump MCMC details.</bold> Additional material for implementing the RJMCMC methods presented in the paper.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0025677.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.s002" xlink:type="simple">
        <label>File S2</label>
        <caption>
          <p><bold>Convergence assessment.</bold> Additional material on assessing convergence of the RJMCMC chains to their stationary distributions.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0025677.s003" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pone.0025677.s003" xlink:type="simple">
        <label>File S3</label>
        <caption>
          <p><bold>Analysis code R.</bold> R code for performing the analysis presented in the paper.</p>
          <p>(R)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors would like to thank J. Ver Hoef and J. Laake, two anonymous referees, and the associate editor for reviews and comments that lead to an improved version of this manuscript.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pone.0025677-Burnham1">
        <label>1</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Burnham</surname><given-names>KP</given-names></name><name name-style="western"><surname>Anderson</surname><given-names>DR</given-names></name></person-group>             <year>1998</year>             <source>Model Selection and Inference: A Practical Information-Theoretic Approach</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025677-Cressie1">
        <label>2</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cressie</surname><given-names>NAC</given-names></name></person-group>             <year>1993</year>             <source>Statistics for Spatial Data</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Wiley</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025677-VerHoef1">
        <label>3</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ver Hoef</surname><given-names>JM</given-names></name><name name-style="western"><surname>Cressie</surname><given-names>N</given-names></name><name name-style="western"><surname>Fisher</surname><given-names>RN</given-names></name><name name-style="western"><surname>Case</surname><given-names>TJ</given-names></name></person-group>             <year>2001</year>             <article-title>Uncertainty and spatial linear models for ecological data.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Hunsaker</surname><given-names>C</given-names></name><name name-style="western"><surname>Goodchild</surname><given-names>M</given-names></name><name name-style="western"><surname>Friedl</surname><given-names>M</given-names></name><name name-style="western"><surname>Case</surname><given-names>T</given-names></name></person-group>             <source>Spatial Uncertainty for Ecology: Implications for Remote Sensing and GIS Applications</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025677-Hoeting1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hoeting</surname><given-names>JA</given-names></name><name name-style="western"><surname>Davis</surname><given-names>RD</given-names></name><name name-style="western"><surname>Merton</surname><given-names>AA</given-names></name><name name-style="western"><surname>Thompson</surname><given-names>SE</given-names></name></person-group>             <year>2006</year>             <article-title>Model selection for geostatistical models.</article-title>             <source>Ecological Applications</source>             <volume>16</volume>             <fpage>87</fpage>             <lpage>98</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Thompson1">
        <label>5</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Thompson</surname><given-names>SE</given-names></name></person-group>             <year>2001</year>             <article-title>Bayesian Model Averaging and Spatial Predictions.</article-title>             <comment>Ph.D. thesis, Colorado State University</comment>          </element-citation>
      </ref>
      <ref id="pone.0025677-Link1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Link</surname><given-names>WA</given-names></name><name name-style="western"><surname>Cam</surname><given-names>E</given-names></name><name name-style="western"><surname>Nichols</surname><given-names>J</given-names></name><name name-style="western"><surname>Cooch</surname><given-names>E</given-names></name></person-group>             <year>2002</year>             <article-title>Of BUGS and birds: Markov chain Monte Carlo for hierachical modeling in wildlife research.</article-title>             <source>Journal of Wildlife Management</source>             <volume>66</volume>             <fpage>277</fpage>             <lpage>291</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Royle1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Royle</surname><given-names>J</given-names></name><name name-style="western"><surname>Wikle</surname><given-names>C</given-names></name></person-group>             <year>2005</year>             <article-title>Efficient statistical mapping of avian count data.</article-title>             <source>Environmental and Ecological Statistics</source>             <volume>12</volume>             <fpage>255</fpage>             <lpage>243</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Wikle1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wikle</surname><given-names>C</given-names></name></person-group>             <year>2003</year>             <article-title>Hierarchical models for predicting the spread of ecological processes.</article-title>             <source>Ecology</source>             <volume>84</volume>             <fpage>1382</fpage>             <lpage>1394</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Sargeant1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sargeant</surname><given-names>G</given-names></name><name name-style="western"><surname>Solvada</surname><given-names>M</given-names></name><name name-style="western"><surname>Slivinski</surname><given-names>C</given-names></name><name name-style="western"><surname>Johnson</surname><given-names>D</given-names></name></person-group>             <year>2005</year>             <article-title>Markov chain Monte Carlo estimation of species distributions: A case study of the swift fox in Western Kansas.</article-title>             <source>Journal of Wildlife Management</source>             <volume>69</volume>             <fpage>483</fpage>             <lpage>497</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Givens1">
        <label>10</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Givens</surname><given-names>G</given-names></name><name name-style="western"><surname>Hoeting</surname><given-names>JA</given-names></name></person-group>             <year>2005</year>             <source>Computational Statistics</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Wiley</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025677-Green1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Green</surname><given-names>PJ</given-names></name></person-group>             <year>1995</year>             <article-title>Reversible jump Markov chain Monte Carlo computation and Bayesian model determination.</article-title>             <source>Biometrika</source>             <volume>82</volume>             <fpage>711</fpage>             <lpage>732</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Diggle1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Diggle</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Tawn</surname><given-names>JA</given-names></name><name name-style="western"><surname>Moyeed</surname><given-names>RA</given-names></name></person-group>             <year>1998</year>             <article-title>Model-based geostatistics (with disscusion).</article-title>             <source>Applied Statistics</source>             <volume>47</volume>             <fpage>299</fpage>             <lpage>350</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Bailey1">
        <label>13</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bailey</surname><given-names>TC</given-names></name><name name-style="western"><surname>Gatrell</surname><given-names>AC</given-names></name></person-group>             <year>1995</year>             <source>Interactive Spatial Data Analysis</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Prentice Hall</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025677-Stein1">
        <label>14</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stein</surname><given-names>ML</given-names></name></person-group>             <year>1999</year>             <source>Interpolation of Spatial Data: Some Theory for Kriging</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0025677-Christensen1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Christensen</surname><given-names>OF</given-names></name><name name-style="western"><surname>Roberts</surname><given-names>GO</given-names></name><name name-style="western"><surname>Sköld</surname><given-names>M</given-names></name></person-group>             <year>2005</year>             <article-title>Robust MCMC methods for spatial GLMM's.</article-title>             <source>Journal of Computational and Graphical Statistics</source>             <volume>15</volume>             <fpage>1</fpage>             <lpage>17</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Clyde1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Clyde</surname><given-names>M</given-names></name><name name-style="western"><surname>George</surname><given-names>EI</given-names></name></person-group>             <year>2004</year>             <article-title>Model uncertainty.</article-title>             <source>Statistical Science</source>             <volume>19</volume>             <fpage>81</fpage>             <lpage>94</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Hoeting2">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hoeting</surname><given-names>JA</given-names></name><name name-style="western"><surname>Madigan</surname><given-names>D</given-names></name><name name-style="western"><surname>Raftery</surname><given-names>A</given-names></name><name name-style="western"><surname>Volinsky</surname><given-names>C</given-names></name></person-group>             <year>1999</year>             <article-title>Bayesian model averaging: a tutorial (with discussion).</article-title>             <source>Statistical Science</source>             <volume>14</volume>             <fpage>382</fpage>             <lpage>417</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Godsill1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Godsill</surname><given-names>S</given-names></name></person-group>             <year>2001</year>             <article-title>On the relationship between Markov Chain Monte Carlo methods for model uncertainty.</article-title>             <source>Journal of Computational and Graphical Statistics</source>             <volume>10</volume>             <fpage>230</fpage>             <lpage>248</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Christensen2">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Christensen</surname><given-names>OF</given-names></name><name name-style="western"><surname>Waagepetersen</surname><given-names>R</given-names></name></person-group>             <year>2002</year>             <article-title>Bayesian prediction of spatial count data using generalized linear mixed models.</article-title>             <source>Biometrics</source>             <volume>58</volume>             <fpage>280</fpage>             <lpage>286</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Raftery1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Raftery</surname><given-names>AE</given-names></name><name name-style="western"><surname>Madigan</surname><given-names>D</given-names></name><name name-style="western"><surname>Hoeting</surname><given-names>JA</given-names></name></person-group>             <year>1997</year>             <article-title>Bayesian model averaging for linear regression models.</article-title>             <source>Journal of the American Statistical Association</source>             <volume>92</volume>             <fpage>179</fpage>             <lpage>191</lpage>          </element-citation>
      </ref>
      <ref id="pone.0025677-Heidelberger1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Heidelberger</surname><given-names>P</given-names></name><name name-style="western"><surname>Welch</surname><given-names>P</given-names></name></person-group>             <year>1983</year>             <article-title>Simulation run length control in the presence of an initial transient.</article-title>             <source>Operations Research</source>             <volume>31</volume>             <fpage>1109</fpage>             <lpage>1144</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>