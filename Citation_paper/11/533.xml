<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-12-11219</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0042294</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Biological data management</subject>
              <subject>Ecosystem modeling</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Ecology</subject>
            <subj-group>
              <subject>Terrestrial ecology</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Population biology</subject>
            <subj-group>
              <subject>Population dynamics</subject>
              <subject>Population ecology</subject>
              <subject>Population modeling</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical methods</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
          <subject>Ecology</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories><title-group><article-title>A Hierarchical Modeling Framework for Multiple Observer Transect Surveys</article-title><alt-title alt-title-type="running-head">Hierarchical Models for Transect Surveys</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Conn</surname>
            <given-names>Paul B.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Laake</surname>
            <given-names>Jeffrey L.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Johnson</surname>
            <given-names>Devin S.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1">
        <label>1</label>
        <addr-line>National Marine Mammal Laboratory, Alaska Fisheries Science Center, National Marine Fisheries Service, Seattle, Washington, United States of America</addr-line>
      </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Getz</surname>
            <given-names>Wayne M.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">
        <addr-line>University of California, Berkeley, United States of America</addr-line>
      </aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">paul.conn@noaa.gov</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: PBC JLL DSJ. Performed the experiments: PBC. Analyzed the data: PBC. Contributed reagents/materials/analysis tools: PBC DSJ JLL. Wrote the paper: PBC JLL DSJ. Designed the software used in analysis: PBC.</p>
        </fn>
      </author-notes><pub-date pub-type="collection">
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>8</day>
        <month>8</month>
        <year>2012</year>
      </pub-date><volume>7</volume><issue>8</issue><elocation-id>e42294</elocation-id><history>
        <date date-type="received">
          <day>19</day>
          <month>4</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>6</day>
          <month>7</month>
          <year>2012</year>
        </date>
      </history><permissions>
        
        <copyright-holder>This is an open-access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions><abstract>
        <p>Ecologists often use multiple observer transect surveys to census animal populations. In addition to animal counts, these surveys produce sequences of detections and non-detections for each observer. When combined with additional data (i.e. covariates such as distance from the transect line), these sequences provide the additional information to estimate absolute abundance when detectability on the transect line is less than one. Although existing analysis approaches for such data have proven extremely useful, they have some limitations. For instance, it is difficult to extrapolate from observed areas to unobserved areas unless a rigorous sampling design is adhered to; it is also difficult to share information across spatial and temporal domains or to accommodate habitat-abundance relationships. In this paper, we introduce a hierarchical modeling framework for multiple observer line transects that removes these limitations. In particular, abundance intensities can be modeled as a function of habitat covariates, making it easier to extrapolate to unsampled areas. Our approach relies on a complete data representation of the state space, where unobserved animals and their covariates are modeled using a reversible jump Markov chain Monte Carlo algorithm. Observer detections are modeled via a bivariate normal distribution on the probit scale, with dependence induced by a distance-dependent correlation parameter. We illustrate performance of our approach with simulated data and on a known population of golf tees. In both cases, we show that our hierarchical modeling approach yields accurate inference about abundance and related parameters. In addition, we obtain accurate inference about population-level covariates (e.g. group size). We recommend that ecologists consider using hierarchical models when analyzing multiple-observer transect data, especially when it is difficult to rigorously follow pre-specified sampling designs. We provide a new R package, hierarchicalDS, to facilitate the building and fitting of these models.</p>
      </abstract><funding-group>
        <funding-statement>Research was supported by the National Oceanic and Atmospheric Administration. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group><counts>
        <page-count count="13"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Transect surveys are often used to sample animal populations and are a central component of many inventory and monitoring programs. In such surveys, an observer travels along a set of lines or visits a finite collection of points, recording all animals they encounter within a fixed distance of the line (or point). If all animals within this strip are encountered, researchers can make inferences about abundance over a larger area by employing standard design-based sampling protocols <xref ref-type="bibr" rid="pone.0042294-Cochran1">[1]</xref>. On the other hand, if some animals are missed (as is almost always the case), approaches are needed to correct for probabilities of detection (<inline-formula id="pone.0042294.e004"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e004" xlink:type="simple"/></inline-formula>) that are less than one.</p>
      <p>Distance sampling is one potential avenue for correcting for incomplete detection of animals in fixed area polygons. In its canonical form (e.g. <xref ref-type="bibr" rid="pone.0042294-Burnham1">[2]</xref>, <xref ref-type="bibr" rid="pone.0042294-Buckland1">[3]</xref>), distance sampling is a simple extension of quadrat sampling, whereby an observer notes the perpendicular distance of animals or groups of animals from the centerline (or radial distance from a point). Analysts then fit models to distance data that allow them to express the probability of detecting a group of animals as a function <inline-formula id="pone.0042294.e005"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e005" xlink:type="simple"/></inline-formula> of distance <inline-formula id="pone.0042294.e006"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e006" xlink:type="simple"/></inline-formula>, where <inline-formula id="pone.0042294.e007"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e007" xlink:type="simple"/></inline-formula> are parameters to be estimated. Total abundance in the surveyed area can then be estimated as</p>
      <disp-formula id="pone.0042294.e008"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e008" xlink:type="simple"/></disp-formula>
      <p>where <inline-formula id="pone.0042294.e009"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e009" xlink:type="simple"/></inline-formula> is half the transect width. In practice, <inline-formula id="pone.0042294.e010"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e010" xlink:type="simple"/></inline-formula> must often assumed to be 1.0 at distance <inline-formula id="pone.0042294.e011"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e011" xlink:type="simple"/></inline-formula> when transects are traversed by a single observer for parameters to be identifiable.</p>
      <p>When animals are detectable from the air, from vessels at sea, or by other means (e.g. avian auditory counts), distance sampling provides a way to correct for imperfect detection in animal surveys without having to physically capture and mark animals. Correcting for imperfect detection is necessary when estimating absolute abundance, and is also viewed by many as an essential component of trend estimation because trends in detectability are typically confounded with trends in abundance unless detectability is explicitly accounted for <xref ref-type="bibr" rid="pone.0042294-Buckland2">[4]</xref>, <xref ref-type="bibr" rid="pone.0042294-Nichols1">[5]</xref>. For these reasons, practitioners routinely use distance sampling in contemporary animal transect surveys.</p>
      <p>Researchers have extended conventional distance sampling to account for a variety of complications that arise in real life sampling scenarios. Several studies have utilized multiple observers to relax the assumption of complete detectability on the transect line <xref ref-type="bibr" rid="pone.0042294-Borchers1">[6]</xref>, and to model heterogeneity in detection as a function of distance <xref ref-type="bibr" rid="pone.0042294-Laake1">[7]</xref>–<xref ref-type="bibr" rid="pone.0042294-Buckland3">[9]</xref>. These features are common in many datasets, and can cause negative bias in abundance estimates if unaccounted for. Other authors have extended conventional distance sampling to model the effects of individual and external covariates on detection probabilities <xref ref-type="bibr" rid="pone.0042294-Drummer1">[10]</xref>–<xref ref-type="bibr" rid="pone.0042294-Marques1">[12]</xref>. As with conventional approaches to distance sampling, estimators are often obtained via a two-stage approach, whereby analysts first formulate models for multiple-observer and distance data, and then estimate abundance using a Horvitz-Thompson-like estimator <xref ref-type="bibr" rid="pone.0042294-Huggins1">[13]</xref>, <xref ref-type="bibr" rid="pone.0042294-Alho1">[14]</xref>.</p>
      <p>Several authors have recently proposed using hierarchical, Bayesian models in place of likelihood or moment-based estimators to analyze distance sampling data <xref ref-type="bibr" rid="pone.0042294-Royle1">[15]</xref>–<xref ref-type="bibr" rid="pone.0042294-Schmidt1">[20]</xref>. The appeal of using hierarchical models is undeniable, as they permit straightforward inference about the relationship of animal abundance to habitat-specific covariates <xref ref-type="bibr" rid="pone.0042294-Royle3">[21]</xref>, and allow parsimonious relationships to be specified among abundance parameters in time and space <xref ref-type="bibr" rid="pone.0042294-Royle4">[22]</xref>. For instance, Moore and Barlow <xref ref-type="bibr" rid="pone.0042294-Moore1">[18]</xref> and Chelgren et al. <xref ref-type="bibr" rid="pone.0042294-Chelgren1">[19]</xref> recently used hierarchical models to account for strata and year effects on animal densities when analyzing line transect data.</p>
      <fig id="pone-0042294-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0042294.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Directed, acyclic graph (DAG) of the (areal) hierarchical model for distance data.</title>
          <p>Individual nodes indicate a parameter or vector of parameters, and arrows represent conditional dependence. Notation is defined in <xref ref-type="table" rid="pone-0042294-t001">Table 1</xref>.</p>
        </caption>
        <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.g001" xlink:type="simple"/>
      </fig>
      <p>Thus far, attempts to analyze line transect data with hierarchical models have focused on single observer data. In this paper, we develop hierarchical models for double observer data that permit habitat covariates to influence abundance intensity, while simultaneously modeling effects of covariates on detection probability. Since double observers are employed, these models allow for <inline-formula id="pone.0042294.e012"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e012" xlink:type="simple"/></inline-formula>100% detection on the transect line (by contrast, previously developed hierarchical modeling approaches had to assume 100% detection on the line). Our approach can also accommodate increasing dependence among observer detections as a function of distance. Building upon previous work by Durban and Elston <xref ref-type="bibr" rid="pone.0042294-Durban1">[23]</xref> in the context of mark-recapture modeling, our approach for modeling detections and abundance at the transect level is based on data augmentation <xref ref-type="bibr" rid="pone.0042294-Tanner1">[24]</xref>, <xref ref-type="bibr" rid="pone.0042294-Royle5">[25]</xref>, using a reversible jump Markov chain Monte Carlo (RJMCMC) algorithm <xref ref-type="bibr" rid="pone.0042294-Carlin1">[26]</xref>, <xref ref-type="bibr" rid="pone.0042294-Green1">[27]</xref> to sample abundance and individual covariates.</p>
      <p>Our modeling approach is applicable to sampling programs for a variety of taxa; here, we focus on describing a generalized hierarchical modeling framework, developing user friendly software, and demonstrating the viability of our approach. After describing our proposed model, we use a small simulation study to verify that it provides reasonable inference about abundance for multiple species with different habitat preferences. Finally, we analyze data from a known population of golf tees that were sampled via a double observer distance sampling protocol. Golf tee clusters varied by the number of tees in each cluster, by color, and by level of exposure, allowing us to fit models that expressed detection probability as a function of covariates and to estimate posterior distributions for these covariates. In contrast to most population surveys, truth is known for this dataset and provides a verifiable test of our modeling framework.</p>
      <table-wrap id="pone-0042294-t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0042294.t001</object-id><label>Table 1</label><caption>
          <title>Parameter and data definitions.</title>
        </caption><alternatives>
          <graphic id="pone-0042294-t001-1" mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.t001" xlink:type="simple"/>
          <table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Parameter</td>
                <td align="left" colspan="1" rowspan="1">Definition</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>N</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">Total animal abundance in the study area</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>G<sub>j</sub></italic>
                </td>
                <td align="left" colspan="1" rowspan="1">Number of groups of animals located in area <italic>j</italic></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>v<sub>j</sub></italic>
                </td>
                <td align="left" colspan="1" rowspan="1">The log of abundance intensity in area <italic>j</italic></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>τ<sub>v</sub></italic>
                </td>
                <td align="left" colspan="1" rowspan="1">Precision of log of abundance intensity; used to impart overdispersion relative to the Poisson distribution</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>λ<sub>j</sub></italic>
                </td>
                <td align="left" colspan="1" rowspan="1">Abundance intensity in area <italic>j</italic> ( = exp(<italic>v<sub>j</sub></italic>))</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>β</italic>
                  <sup>hab</sup>
                </td>
                <td align="left" colspan="1" rowspan="1">Parameters of the linear predictor describing variation in the log of abundance intensity as a function of habitat covariates</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Z<sub>ijk</sub></italic>
                </td>
                <td align="left" colspan="1" rowspan="1">The value of the <italic>k</italic>th individual covariate associated with group <inline-formula id="pone.0042294.e013"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e013" xlink:type="simple"/></inline-formula> in transect <italic>j</italic> (for groups of animals never observed)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>θ</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">Parameters describing the distribution of individual covariates at the population level</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>β</italic>
                  <sup>det</sup>
                </td>
                <td align="left" colspan="1" rowspan="1">Parameters of the linear predictor describing variation in the probit of detection probability as a function of observer and individual covariates</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>ρ</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">Parameter describing increasing correlation between <italic>Y<sub>ij</sub></italic><sub>1</sub> and <italic>Y<sub>ij</sub></italic><sub>2</sub> as a function of distance when there are double observers</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Data</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Definition</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Y<sub>ijk</sub></italic>
                </td>
                <td align="left" colspan="1" rowspan="1">Bernoulli response variable for whether the <italic>i</italic>th group in the <italic>j</italic>th transect was observed by observer <italic>k</italic></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula id="pone.0042294.e014"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e014" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">Number of groups observed by at least one observer during transect <italic>j</italic></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>O<sub>j</sub></italic>
                </td>
                <td align="left" colspan="1" rowspan="1">Number of observers present when sampling transect <italic>j</italic></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Z<sub>ijk</sub></italic>
                </td>
                <td align="left" colspan="1" rowspan="1">The value of the <italic>k</italic>th individual covariate associated with group <italic>i</italic> in transect <italic>j</italic> if it was actually observed</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>X</italic>
                  <sup>hab</sup>
                </td>
                <td align="left" colspan="1" rowspan="1">Design matrix associated with habitat model</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula id="pone.0042294.e015"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e015" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">Design matrix associated with the detection model for the <italic>i</italic>th group in the <italic>j</italic>th transect and observer <italic>k</italic> (note dependence on <italic>Z<sub>ijk</sub></italic>)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>S<sub>j</sub></italic>
                </td>
                <td align="left" colspan="1" rowspan="1">Label for grid cell <italic>j</italic> (<italic>J</italic> of which are completely covered by transects, and <italic>L</italic>−<italic>J</italic> of which are unsampled cells).</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>A<sub>j</sub></italic>
                </td>
                <td align="left" colspan="1" rowspan="1">The area of grid cell <italic>j</italic> (perhaps scaled to its mean)</td>
              </tr>
            </tbody>
          </table>
        </alternatives><table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>Parameters and data used in the hierarchical model for distance data.</p>
          </fn>
        </table-wrap-foot></table-wrap>
    </sec>
    <sec id="s2" sec-type="methods">
      <title>Methods</title>
      <sec id="s2a">
        <title>Hierarchical Model</title>
        <p>We propose a hierarchical model for distance sampling data consisting of several conceptually distinct components (<xref ref-type="fig" rid="pone-0042294-g001">Figure 1</xref>). Writing the model hierarchically, we can use conditioning to treat these components separately. Letting the notation <inline-formula id="pone.0042294.e016"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e016" xlink:type="simple"/></inline-formula> define the probability distribution or mass function of <inline-formula id="pone.0042294.e017"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e017" xlink:type="simple"/></inline-formula>, <inline-formula id="pone.0042294.e018"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e018" xlink:type="simple"/></inline-formula> denote the conditional probability of <inline-formula id="pone.0042294.e019"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e019" xlink:type="simple"/></inline-formula> given <inline-formula id="pone.0042294.e020"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e020" xlink:type="simple"/></inline-formula>, we (symbolically) write the likelihood of the hierarchical model as</p>
        <disp-formula id="pone.0042294.e021"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e021" xlink:type="simple"/></disp-formula>
        <p>If conducting a Bayesian analysis, the posterior distribution is then proportional to</p>
        <disp-formula id="pone.0042294.e022"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e022" xlink:type="simple"/></disp-formula>
        <p>Given samples from the posterior, one can make posterior predictions of total abundance, so we might include another component <inline-formula id="pone.0042294.e023"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e023" xlink:type="simple"/></inline-formula> | <inline-formula id="pone.0042294.e024"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e024" xlink:type="simple"/></inline-formula> <inline-formula id="pone.0042294.e025"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e025" xlink:type="simple"/></inline-formula> <inline-formula id="pone.0042294.e026"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e026" xlink:type="simple"/></inline-formula> as well. Below, we treat each of these components in turn. Notation is largely defined in the text, but is also provided for convenience in <xref ref-type="table" rid="pone-0042294-t001">Table 1</xref>.</p>
        <fig id="pone-0042294-g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0042294.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>True and estimated population size for simulated data.</title>
            <p>True abundance is indicated in red, with posterior means and estimated 95% credible intervals for abundance indicated by circles and brackets, respectively. Panel (A) gives results for the simulation with linearly increasing abundance, while panel (B) gives results for the simulation with a quadratic relationship between abundance and a habitat covariate.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.g002" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2b">
        <title>Observation (Data) Model</title>
        <p>The data collected in multiple observer transect surveys consist of a collection of binary observations, <inline-formula id="pone.0042294.e027"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e027" xlink:type="simple"/></inline-formula>, and covariates, <inline-formula id="pone.0042294.e028"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e028" xlink:type="simple"/></inline-formula>. Detections (<inline-formula id="pone.0042294.e029"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e029" xlink:type="simple"/></inline-formula>) and non-detections (<inline-formula id="pone.0042294.e030"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e030" xlink:type="simple"/></inline-formula>) are recorded for each observer <inline-formula id="pone.0042294.e031"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e031" xlink:type="simple"/></inline-formula> for the <inline-formula id="pone.0042294.e032"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e032" xlink:type="simple"/></inline-formula>th group of animals encountered on transect <inline-formula id="pone.0042294.e033"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e033" xlink:type="simple"/></inline-formula>. Covariates thought to influence detection probability may also be recorded, with <inline-formula id="pone.0042294.e034"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e034" xlink:type="simple"/></inline-formula> giving the value of covariate <inline-formula id="pone.0042294.e035"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e035" xlink:type="simple"/></inline-formula> for the <inline-formula id="pone.0042294.e036"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e036" xlink:type="simple"/></inline-formula>th group of animals encountered in transect <inline-formula id="pone.0042294.e037"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e037" xlink:type="simple"/></inline-formula>. In practice, <inline-formula id="pone.0042294.e038"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e038" xlink:type="simple"/></inline-formula> may include both transect specific covariates (e.g. survey conditions) or covariates associated with individual groups of animals (distance, group size, species, etc.).</p>
        <fig id="pone-0042294-g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0042294.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Representation of golf tee population.</title>
            <p>Each symbol represents a different group of golf tees, with dark symbols representing yellow tees and gray symbols representing green tees. Groups that were observed by at least one observer are indicated by solid symbols, while open symbols indicate groups that were never observed. Squares represent tee groups that were exposed above surrounding grass, while triangles represent unexposed groups. Group sizes are indicated by the proportional size of each symbol, with the smallest symbols representing groups of 1 animal, and the largest symbols representing a group of 8 individuals. Transect lines are represented by solid black lines, with dotted lines giving survey area boundaries and demarcating the areas surveyed by each transect. The red line serves as the strata boundary (points north comprise the northern stratum).</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.g003" xlink:type="simple"/>
        </fig>
        <p>Suppose for the moment that we also knew the total number of groups present in the area associated with transect <inline-formula id="pone.0042294.e039"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e039" xlink:type="simple"/></inline-formula>, <inline-formula id="pone.0042294.e040"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e040" xlink:type="simple"/></inline-formula>, as well as covariate values for each group. In this case, we could augment the total number of observed groups, <inline-formula id="pone.0042294.e041"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e041" xlink:type="simple"/></inline-formula> with an additional <inline-formula id="pone.0042294.e042"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e042" xlink:type="simple"/></inline-formula> observations for which the <inline-formula id="pone.0042294.e043"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e043" xlink:type="simple"/></inline-formula> were all zero. We adopt this convention here, leaving it to a later section to describe the procedure by which <inline-formula id="pone.0042294.e044"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e044" xlink:type="simple"/></inline-formula> and the missing covariates are estimated.</p>
        <fig id="pone-0042294-g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0042294.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Empirical and posterior predictive distributions of golf tee group size.</title>
            <p>Bar plots representing the probability mass for group size in the golf tee experiment. Empirical distributions correspond to the actual distribution of group size used in the experiment, while posterior distributions represent estimated posterior predictive distributions obtained after analyzing data with our hierarchical model.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.g004" xlink:type="simple"/>
        </fig>
        <p>Conditional on <inline-formula id="pone.0042294.e045"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e045" xlink:type="simple"/></inline-formula> and <inline-formula id="pone.0042294.e046"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e046" xlink:type="simple"/></inline-formula>, we assume that observations <inline-formula id="pone.0042294.e047"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e047" xlink:type="simple"/></inline-formula> are Bernoulli distributed, with success probabilities <inline-formula id="pone.0042294.e048"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e048" xlink:type="simple"/></inline-formula>. We model the <inline-formula id="pone.0042294.e049"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e049" xlink:type="simple"/></inline-formula> using a probit link function, expressing them as a function of covariates in a manner analogous to generalized linear models <xref ref-type="bibr" rid="pone.0042294-McCullagh1">[28]</xref>. We also allow for increasing dependence among observers as a function of distance by allowing for correlation between <inline-formula id="pone.0042294.e050"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e050" xlink:type="simple"/></inline-formula> and <inline-formula id="pone.0042294.e051"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e051" xlink:type="simple"/></inline-formula> on the probit scale. Specifically, assuming two observers, we have</p>
        <disp-formula id="pone.0042294.e052"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e052" xlink:type="simple"/></disp-formula>
        <p>where <inline-formula id="pone.0042294.e053"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e053" xlink:type="simple"/></inline-formula> gives a design matrix incorporating any desired covariates for detection probability, and <inline-formula id="pone.0042294.e054"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e054" xlink:type="simple"/></inline-formula> gives a vector of regression coefficients. Correlation (<inline-formula id="pone.0042294.e055"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e055" xlink:type="simple"/></inline-formula>) is set to be a function of distance by allowing <inline-formula id="pone.0042294.e056"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e056" xlink:type="simple"/></inline-formula>, where <inline-formula id="pone.0042294.e057"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e057" xlink:type="simple"/></inline-formula> is the distance value associated with the <inline-formula id="pone.0042294.e058"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e058" xlink:type="simple"/></inline-formula>th group in the <inline-formula id="pone.0042294.e059"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e059" xlink:type="simple"/></inline-formula>th transect and <inline-formula id="pone.0042294.e060"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e060" xlink:type="simple"/></inline-formula> is an estimated parameter. For continuous data, we suppose that <inline-formula id="pone.0042294.e061"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e061" xlink:type="simple"/></inline-formula>, and for binned data, we suppose that distance bins are represented by finite integers with <inline-formula id="pone.0042294.e062"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e062" xlink:type="simple"/></inline-formula> with <inline-formula id="pone.0042294.e063"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e063" xlink:type="simple"/></inline-formula> being the farthest distance bin. Correlation could potentially be a function of other covariates as well; however, there is typically limited information with which to estimate it. In the following development, we assume that correlation changes linearly on the probit scale as a function of distance from the observer. With binned distance data (i.e. when observers record distance as falling into one of a finite collection of distance intervals), we suppose that</p>
        <disp-formula id="pone.0042294.e064"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e064" xlink:type="simple"/></disp-formula>
        <p>and with continuous distance data,</p>
        <disp-formula id="pone.0042294.e065"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e065" xlink:type="simple"/></disp-formula>
        <p>In both cases, <inline-formula id="pone.0042294.e066"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e066" xlink:type="simple"/></inline-formula> is assumed to be zero on the line (or in the first distance bin). This assumption, termed “point independence” by several authors <xref ref-type="bibr" rid="pone.0042294-Laake1">[7]</xref>–<xref ref-type="bibr" rid="pone.0042294-Buckland3">[9]</xref>, anchors the correlation function at distance zero and makes observer dependence parameters identifiable. This formulation also allows increasing dependence of observations as a function of distance, a common phenomenon in distance sampling <xref ref-type="bibr" rid="pone.0042294-Laake1">[7]</xref>–<xref ref-type="bibr" rid="pone.0042294-Buckland3">[9]</xref>.</p>
        <fig id="pone-0042294-g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0042294.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>True values and estimated posterior distributions for simulated data.</title>
            <p>Kernel density estimates of marginal posterior distributions are indicated in black, with true values used to simulate data indicated by red, vertical lines. Parameters indexed by “Cov” give covariate parameters, “Det” give detection parameters, “Hab” give habitat parameters, and “N” gives abundance. The first panel (“cor”) gives an estimate of the observer dependence parameter. Species specific parameters are indexed by “sp1” (for species one) or “sp2” (species two).</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.g005" xlink:type="simple"/>
        </fig>
        <fig id="pone-0042294-g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0042294.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>True and estimated detection functions for simulated data.</title>
            <p>Detection functions for each species are based on mean group sizes for each species (4 and 2, respectively), and are made for observer 2 (who had an intermediate detective ability).</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.g006" xlink:type="simple"/>
        </fig>
        <p>Like the (more popular) logit link function, the probit link function provides a transformation from <inline-formula id="pone.0042294.e067"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e067" xlink:type="simple"/></inline-formula> space (the space of the linear predictor) to <inline-formula id="pone.0042294.e068"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e068" xlink:type="simple"/></inline-formula> space (probability space). However, use of a probit link allowed us to employ the computationally efficient posterior sampling algorithm suggested by Albert and Chib <xref ref-type="bibr" rid="pone.0042294-Albert1">[29]</xref>. In particular, we augment each detection with a latent variable, <inline-formula id="pone.0042294.e069"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e069" xlink:type="simple"/></inline-formula>, where <inline-formula id="pone.0042294.e070"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e070" xlink:type="simple"/></inline-formula> if and only if <inline-formula id="pone.0042294.e071"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e071" xlink:type="simple"/></inline-formula>. Then, we suppose that</p>
        <disp-formula id="pone.0042294.e001"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e001" xlink:type="simple"/></disp-formula>
        <p>With multiple observers, conditioning on one value of <inline-formula id="pone.0042294.e072"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e072" xlink:type="simple"/></inline-formula> reduces the probability density from a bivariate to a univariate distribution. In particular,</p>
        <disp-formula id="pone.0042294.e002"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e002" xlink:type="simple"/></disp-formula>
        <p>where <inline-formula id="pone.0042294.e073"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e073" xlink:type="simple"/></inline-formula>. The full conditional distribution for <inline-formula id="pone.0042294.e074"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e074" xlink:type="simple"/></inline-formula> is then a truncated normal, which can be updated within MCMC using a Gibbs step; the <inline-formula id="pone.0042294.e075"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e075" xlink:type="simple"/></inline-formula> can also be updated directly with Gibbs steps (see <xref ref-type="supplementary-material" rid="pone.0042294.s001">Text S1</xref> for further details).</p>
      </sec>
      <sec id="s2c">
        <title>Covariate Model</title>
        <p>Some covariates thought to influence detection probability are collected at the transect level (e.g. survey conditions), and are therefore known for all potential groups of animals (observed and unobserved). However, for covariates associated with individual groups of animals (e.g., distance, group size, species), an underlying model is needed to link the observed covariates (for observed groups) to unobserved covariates (for unobserved groups). We model these individual covariates as having arisen from a parametric distribution, possibly with overdispersion. In general, let the covariate <inline-formula id="pone.0042294.e076"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e076" xlink:type="simple"/></inline-formula> have the distribution</p>
        <disp-formula id="pone.0042294.e003"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e003" xlink:type="simple"/></disp-formula>
        <p>where <inline-formula id="pone.0042294.e077"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e077" xlink:type="simple"/></inline-formula> specifies an arbitrary function, <inline-formula id="pone.0042294.e078"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e078" xlink:type="simple"/></inline-formula> gives hyper-priors, and <inline-formula id="pone.0042294.e079"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e079" xlink:type="simple"/></inline-formula> specifies a random effect. We have implemented a number of such distributions in our accompanying R package, hierarchicalDS. For instance, the user can choose <inline-formula id="pone.0042294.e080"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e080" xlink:type="simple"/></inline-formula> to be a uniform, multinomial, Poisson, zero-truncated Poisson, overdispersed Poisson, or overdispersed zero-truncated Poisson distribution. The overdispersed versions of the Poisson distribution are modeled as in <xref ref-type="bibr" rid="pone.0042294-McClintock1">[30]</xref>; namely</p>
        <disp-formula id="pone.0042294.e081"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e081" xlink:type="simple"/></disp-formula>
        <p>where <inline-formula id="pone.0042294.e082"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e082" xlink:type="simple"/></inline-formula> and <inline-formula id="pone.0042294.e083"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e083" xlink:type="simple"/></inline-formula> and <inline-formula id="pone.0042294.e084"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e084" xlink:type="simple"/></inline-formula> are parameters to be estimated. The zero-truncated versions of the Poisson distribution are important for modeling covariates such as group size, which are by definition <inline-formula id="pone.0042294.e085"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e085" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pone.0042294-Royle6">[31]</xref>. One can also choose to fix the parameters of these distributions, or to specify hyper-prior distributions. For further information, see accompanying R package.</p>
      </sec>
      <sec id="s2d">
        <title>Process Model</title>
        <p>Let <inline-formula id="pone.0042294.e086"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e086" xlink:type="simple"/></inline-formula> define a partition of the study area, where <inline-formula id="pone.0042294.e087"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e087" xlink:type="simple"/></inline-formula>, <inline-formula id="pone.0042294.e088"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e088" xlink:type="simple"/></inline-formula>, denote areas covered by individual transects, and <inline-formula id="pone.0042294.e089"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e089" xlink:type="simple"/></inline-formula>, <inline-formula id="pone.0042294.e090"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e090" xlink:type="simple"/></inline-formula>, denote unsampled areas. In practice, these cells may be irregularly shaped, or with different effective areas covered, <inline-formula id="pone.0042294.e091"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e091" xlink:type="simple"/></inline-formula>. We suppose that the number of groups of animals located in the area encompassed by area <inline-formula id="pone.0042294.e092"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e092" xlink:type="simple"/></inline-formula>, <inline-formula id="pone.0042294.e093"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e093" xlink:type="simple"/></inline-formula>, is Poisson distributed with intensity parameter <inline-formula id="pone.0042294.e094"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e094" xlink:type="simple"/></inline-formula>. Overdispersion, if present, can be accommodated in the specification of <inline-formula id="pone.0042294.e095"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e095" xlink:type="simple"/></inline-formula>. We model species-habitat relationships by writing abundance intensity as a function of habitat covariates (an intercept only model can be specified if no such covariates are collected). Letting <inline-formula id="pone.0042294.e096"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e096" xlink:type="simple"/></inline-formula> be the log of abundance intensity in <inline-formula id="pone.0042294.e097"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e097" xlink:type="simple"/></inline-formula>, we impose the following model:</p>
        <disp-formula id="pone.0042294.e098"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e098" xlink:type="simple"/></disp-formula>
        <p>Here, <inline-formula id="pone.0042294.e099"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e099" xlink:type="simple"/></inline-formula> gives a design matrix incorporating any predictor variables for abundance, <inline-formula id="pone.0042294.e100"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e100" xlink:type="simple"/></inline-formula> gives a vector of regression coefficients, and <inline-formula id="pone.0042294.e101"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e101" xlink:type="simple"/></inline-formula> denotes precision of the process model. The resultant Poisson intensity is then <inline-formula id="pone.0042294.e102"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e102" xlink:type="simple"/></inline-formula>. In practice, we find it convenient to scale <inline-formula id="pone.0042294.e103"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e103" xlink:type="simple"/></inline-formula> to its mean rather than use absolute values. This formulation incorporates habitat covariates in a manner analagous to generalized linear models <xref ref-type="bibr" rid="pone.0042294-McCullagh1">[28]</xref>, but also includes possible overdispersion relative to the Poisson distribution, a prevalent feature in ecological datasets. Such overdispersion can lead to left-skewed distributions for total abundance, similar to the lognormal distribution often assumed in conventional distance sampling <xref ref-type="bibr" rid="pone.0042294-Buckland1">[3]</xref>.</p>
      </sec>
      <sec id="s2e">
        <title>Posterior Predictions of Abundance</title>
        <p>The model as written focuses on abundance of <italic>groups</italic>. In contrast, population managers often require estimates of density or abundance that reference the number of unique individuals inhabiting an area of interest. For surveyed cells (i.e., <inline-formula id="pone.0042294.e104"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e104" xlink:type="simple"/></inline-formula>), abundance can simply be calculated as <inline-formula id="pone.0042294.e105"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e105" xlink:type="simple"/></inline-formula>, where <inline-formula id="pone.0042294.e106"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e106" xlink:type="simple"/></inline-formula> is the group size associated with observation <inline-formula id="pone.0042294.e107"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e107" xlink:type="simple"/></inline-formula> in the area covered by transect <inline-formula id="pone.0042294.e108"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e108" xlink:type="simple"/></inline-formula> (which is itself a modeled covariate).</p>
        <p>For areas that are unsurveyed (that is, <inline-formula id="pone.0042294.e109"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e109" xlink:type="simple"/></inline-formula>), abundance <inline-formula id="pone.0042294.e110"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e110" xlink:type="simple"/></inline-formula> can be sampled using the parametric model selected for group size. For the zero-truncated Poisson model,</p>
        <disp-formula id="pone.0042294.e111"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e111" xlink:type="simple"/></disp-formula>
        <p>while for the zero-truncated overdispersed Poisson model,</p>
        <disp-formula id="pone.0042294.e112"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e112" xlink:type="simple"/></disp-formula>
        <p>Posterior predictions of total abundance are then calculated as <inline-formula id="pone.0042294.e113"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e113" xlink:type="simple"/></inline-formula>.</p>
      </sec>
      <sec id="s2f">
        <title>Prior Distributions</title>
        <p>Bayesian analysis requires specification of prior distributions for <inline-formula id="pone.0042294.e114"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e114" xlink:type="simple"/></inline-formula>, <inline-formula id="pone.0042294.e115"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e115" xlink:type="simple"/></inline-formula>, <inline-formula id="pone.0042294.e116"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e116" xlink:type="simple"/></inline-formula>, and <inline-formula id="pone.0042294.e117"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e117" xlink:type="simple"/></inline-formula>. We chose a conjugate <inline-formula id="pone.0042294.e118"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e118" xlink:type="simple"/></inline-formula> prior for <inline-formula id="pone.0042294.e119"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e119" xlink:type="simple"/></inline-formula>, so that full conditional distributions were available in standard form and could be sampled directly with Gibbs sampling. In all subsequent analysis, we chose <inline-formula id="pone.0042294.e120"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e120" xlink:type="simple"/></inline-formula> and <inline-formula id="pone.0042294.e121"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e121" xlink:type="simple"/></inline-formula> to put ample weight on plausible parameter values.</p>
        <p>We gave the <inline-formula id="pone.0042294.e122"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e122" xlink:type="simple"/></inline-formula>, which are analogous to regression parameters, vague <inline-formula id="pone.0042294.e123"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e123" xlink:type="simple"/></inline-formula> prior distributions, which is a common strategy in regression problems (e.g. <xref ref-type="bibr" rid="pone.0042294-Gelman1">[32]</xref>, Chapter 14). By contrast, hyper-priors for individual covariates incorporated greater precision to improve sampling efficiency. In our two subsequent examples, we incorporated a <inline-formula id="pone.0042294.e124"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e124" xlink:type="simple"/></inline-formula> distribution for the log of group size, and a <inline-formula id="pone.0042294.e125"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e125" xlink:type="simple"/></inline-formula> distribution for <inline-formula id="pone.0042294.e126"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e126" xlink:type="simple"/></inline-formula> (the standard deviation for log group size random effects). For the simulation study and golf tee analysis, species and exposure were modeled with a Dirichlet(10,10) distribution, the conjugate prior for the categorical distribution. Pilot analyses suggested little sensitivity of results to our choice of prior distributions.</p>
      </sec>
      <sec id="s2g">
        <title>Data Augmentation and Bayesian Inference</title>
        <p>As suggested previously, the primary challenge in implementing a complete data model for multiple observer transect surveys was in jointly sampling local abundance and individual covariates. We chose to implement a reversible-jump algorithm (RJMCMC) to sample abundance at the transect level, in a manner similar to Durban and Elston <xref ref-type="bibr" rid="pone.0042294-Durban1">[23]</xref>. The RJMCMC approach is commonly used in cases where the dimensionality of the parameter space is unknown (in our case, abundance is unknown) <xref ref-type="bibr" rid="pone.0042294-Green1">[27]</xref>, and provides a mechanism to grow or shrink the number of parameters during posterior sampling. In our case, RJMCMC consists of several steps, including (1) additions and deletions of unobserved animals, (2) resampling of covariate values for unobserved animals, and (3) sampling of <inline-formula id="pone.0042294.e127"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e127" xlink:type="simple"/></inline-formula> values for new additions. These steps were conducted independently for each transect since realizations for each transect are conditionally independent; thus without loss of generality, we present sampling details for a single transect.</p>
        <p>Specification of the complete data model starts with specifying an integer <inline-formula id="pone.0042294.e128"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e128" xlink:type="simple"/></inline-formula> that serves as the upper limit for the number of groups of animals present in the sampled area of transect <inline-formula id="pone.0042294.e129"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e129" xlink:type="simple"/></inline-formula>. In practice, this integer can be increased if it is found that the posterior group abundance runs up against this bound <xref ref-type="bibr" rid="pone.0042294-Durban1">[23]</xref>, <xref ref-type="bibr" rid="pone.0042294-Royle5">[25]</xref>. However, choosing too large of a value can dramatically increase computing time.</p>
        <p>Addition and deletion steps consist of increasing or decreasing the value of <inline-formula id="pone.0042294.e130"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e130" xlink:type="simple"/></inline-formula>, and are accomplished as follows:</p>
        <list list-type="bullet">
          <list-item>
            <p>Propose a new value for <inline-formula id="pone.0042294.e131"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e131" xlink:type="simple"/></inline-formula>, <inline-formula id="pone.0042294.e132"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e132" xlink:type="simple"/></inline-formula>, where <inline-formula id="pone.0042294.e133"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e133" xlink:type="simple"/></inline-formula>, and <inline-formula id="pone.0042294.e134"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e134" xlink:type="simple"/></inline-formula> is a tuning parameter set to achieve a target acceptance rate of 0.3–0.4.</p>
          </list-item>
          <list-item>
            <p>Accept proposal with probability <inline-formula id="pone.0042294.e135"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e135" xlink:type="simple"/></inline-formula>, where</p>
          </list-item>
        </list>
        <disp-formula id="pone.0042294.e136"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e136" xlink:type="simple"/></disp-formula>
        <p>Here, <inline-formula id="pone.0042294.e137"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e137" xlink:type="simple"/></inline-formula> equals the probability that group <inline-formula id="pone.0042294.e138"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e138" xlink:type="simple"/></inline-formula> of transect <inline-formula id="pone.0042294.e139"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e139" xlink:type="simple"/></inline-formula> is observed by one or more observer. If there is only one observer on transect <inline-formula id="pone.0042294.e140"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e140" xlink:type="simple"/></inline-formula>, this probability is simply</p>
        <disp-formula id="pone.0042294.e141"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e141" xlink:type="simple"/></disp-formula>
        <p>if <inline-formula id="pone.0042294.e142"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e142" xlink:type="simple"/></inline-formula>,</p>
        <disp-formula id="pone.0042294.e143"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e143" xlink:type="simple"/></disp-formula>
        <p>This formulation, including the integral and specification of variance as 1.0, corresponds to the inverse probit link function <xref ref-type="bibr" rid="pone.0042294-Collett1">[33]</xref>.</p>
        <p>The Metropolis ratio, <inline-formula id="pone.0042294.e144"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e144" xlink:type="simple"/></inline-formula>, follows directly from a sampling model where the likelihood of observing <inline-formula id="pone.0042294.e145"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e145" xlink:type="simple"/></inline-formula> individuals out of <inline-formula id="pone.0042294.e146"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e146" xlink:type="simple"/></inline-formula> total animals is</p>
        <disp-formula id="pone.0042294.e147"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e147" xlink:type="simple"/></disp-formula>
        <p>where <inline-formula id="pone.0042294.e148"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e148" xlink:type="simple"/></inline-formula>. Link and Barker <xref ref-type="bibr" rid="pone.0042294-Link1">[16]</xref> used a similar model formulation in their complete data representation of distance data.</p>
        <p>Following the addition/deletion step, the next step in our RJMCMC estimation scheme is to resample individual covariates. For each such covariate, there are two categories of values to update: (1) covariates for which a group of animals were in the population and never observed, and (2) latent groups not currently belonging to the population. Letting <inline-formula id="pone.0042294.e149"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e149" xlink:type="simple"/></inline-formula> denote the number of groups observed by at least one observer in transect <inline-formula id="pone.0042294.e150"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e150" xlink:type="simple"/></inline-formula>, and <inline-formula id="pone.0042294.e151"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e151" xlink:type="simple"/></inline-formula> be the total number of groups for transect <inline-formula id="pone.0042294.e152"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e152" xlink:type="simple"/></inline-formula> at the previous iteration of the Markov chain, the full conditional distribution for a given covariate <inline-formula id="pone.0042294.e153"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e153" xlink:type="simple"/></inline-formula>, <inline-formula id="pone.0042294.e154"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e154" xlink:type="simple"/></inline-formula> is given by</p>
        <disp-formula id="pone.0042294.e155"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e155" xlink:type="simple"/></disp-formula>
        <p>for <inline-formula id="pone.0042294.e156"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e156" xlink:type="simple"/></inline-formula>, which is just the observation model (e.g. Eq. 1) multiplied by the prior distribution of the individual covariate. We use a Metropolis-Hastings step to sample from this distribution.</p>
        <p>For “pseudo-groups” <inline-formula id="pone.0042294.e157"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e157" xlink:type="simple"/></inline-formula> (i.e., groups of animals not currently in the population who might be added during a future RJMCMC step), we simulate covariates directly from Eq. 3. These distributions are used in place of the pseudo-prior distributions suggested by Durban and Elston <xref ref-type="bibr" rid="pone.0042294-Durban1">[23]</xref>. The difference between our approaches is that in the present work we obtain posterior samples of the parameters specified in <inline-formula id="pone.0042294.e158"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e158" xlink:type="simple"/></inline-formula> (e.g. the parameters describing the underlying covariate distribution), while Durban and Elston fix these parameters. Simulations (see below) suggest that this approach results in estimates with reasonable properties, and also bypasses the need to tediously tune pseudo-prior distributions. Assuming random placement of transect lines, we selected a uniform distribution a priori to simulate pseudo-group distances.</p>
        <p>Estimation of remaining model parameters (conditional on a set level of abundance) proceeded by cyclical sampling of model parameters from their full conditional distributions <xref ref-type="bibr" rid="pone.0042294-Gelman1">[32]</xref>. In particular, we employed a combination of Gibbs and Metropolis-Hastings steps for posterior sampling. For Metropolis-Hastings steps, candidate parameter values were sampled from uniform distributions centered at the previous iterations parameter value and with a range chosen to achieve an acceptance rate of 30–40% as suggested by Gelman et al. <xref ref-type="bibr" rid="pone.0042294-Gelman1">[32]</xref>. For further details, see <xref ref-type="supplementary-material" rid="pone.0042294.s001">Text S1</xref>.</p>
      </sec>
      <sec id="s2h">
        <title>Computing</title>
        <p>We developed generalized computing code to conduct MCMC estimation, which we implemented in the R programming environment <xref ref-type="bibr" rid="pone.0042294-R1">[34]</xref>. This code has been incorporated into the R package, HierarchicalDS. The package, which includes code, help files, and an example analysis, is currently available on the Comprehensive R Archive Network (CRAN; <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/" xlink:type="simple">http://cran.r-project.org/</ext-link>).</p>
        <fig id="pone-0042294-g007" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0042294.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Posterior distributions for the abundance (number of groups) of golf tees of different types.</title>
            <p>Kernel density estimates of posterior distributions are in black, while true values are represented by red vertical lines, and estimates from a conventional mark-recapture distance sampling analysis (see Laake and Borchers <xref ref-type="bibr" rid="pone.0042294-Laake1">[7]</xref>) are presented in blue.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.g007" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2i">
        <title>Examples</title>
        <sec id="s2i1">
          <title>Simulated data</title>
          <p>We first used simulation to verify that our modeling approach provided reasonable estimates of abundance and related parameters. In particular, we generated a double-observer distance sampling dataset for two species with different habitat preferences and covariate values, but with a common detection function. For the first species, expected abundance increased linearly with an arbitrary covariate (here, transect number); expected abundance of the second species had a quadratic relationship with the covariate (<xref ref-type="fig" rid="pone-0042294-g002">Fig. 2</xref>).</p>
          <fig id="pone-0042294-g008" orientation="portrait" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0042294.g008</object-id>
            <label>Figure 8</label>
            <caption>
              <title>Implied detection probability and observer dependence for covariates maximizing dependence.</title>
              <p>The top panel gives detection probability curves for the set of covariates that maximize observer dependence (observer = 2, group size = 1, exposure = 0, species = “green”). “Individual” specifies detection probability for observer 2 only; “Conditional” gives the probability of detection for observer 2 given that the group was detected by observer 1; “Duplicate” gives the probability of detection by both observers; “Pooled” gives the probability of detection by at least one observer. The bottom panel represents dependence, as summarized by the parameter <inline-formula id="pone.0042294.e159"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e159" xlink:type="simple"/></inline-formula> (see <xref ref-type="bibr" rid="pone.0042294-Buckland3">[9]</xref>) for the same set of covariates.</p>
            </caption>
            <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.g008" xlink:type="simple"/>
          </fig>
          <p>A total of 25 transects were simulated, each of which had two observers assigned. In all cases, observers were picked randomly from a pool of three total observers with different underlying detection probabilities. The assumed detection function was made to be a function of observer, distance, species, and group size. Correlation between observers was modeled as a linearly increasing function of distance on the probit scale, with a maximum value of 0.5 at the farthest observable distance.</p>
          <table-wrap id="pone-0042294-t002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0042294.t002</object-id><label>Table 2</label><caption>
              <title>Modeling choices and justification.</title>
            </caption><alternatives>
              <graphic id="pone-0042294-t002-2" mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.t002" xlink:type="simple"/>
              <table>
                <colgroup span="1">
                  <col align="left" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                </colgroup>
                <thead>
                  <tr>
                    <td align="left" colspan="1" rowspan="1">Modeling construct</td>
                    <td align="left" colspan="1" rowspan="1">Choice</td>
                    <td align="left" colspan="1" rowspan="1">Alternatives</td>
                    <td align="left" colspan="1" rowspan="1">Advantages</td>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="left" colspan="1" rowspan="1">
                      <italic>Point independence</italic>
                    </td>
                    <td align="left" colspan="1" rowspan="1">Bivariate normal distributionwith correlation as a functionof distance</td>
                    <td align="left" colspan="1" rowspan="1">Individual random effect</td>
                    <td align="left" colspan="1" rowspan="1">Not needed when there is one observer</td>
                  </tr>
                  <tr>
                    <td align="left" colspan="1" rowspan="1">
                      <italic>Detection model link function</italic>
                    </td>
                    <td align="left" colspan="1" rowspan="1">Probit</td>
                    <td align="left" colspan="1" rowspan="1">Logit, complimentary log-log</td>
                    <td align="left" colspan="1" rowspan="1">Simplifies Bayesian computation through Albert and Chib algorithm <xref ref-type="bibr" rid="pone.0042294-Albert1">[29]</xref></td>
                  </tr>
                  <tr>
                    <td align="left" colspan="1" rowspan="1">
                      <italic>Data representation</italic>
                    </td>
                    <td align="left" colspan="1" rowspan="1">Complete data likelihood/data augmentation</td>
                    <td align="left" colspan="1" rowspan="1">Observed data likelihood</td>
                    <td align="left" colspan="1" rowspan="1">Eases explicit conditioning, simplifies likelihood computations, and enables extensions such as species misidentification</td>
                  </tr>
                  <tr>
                    <td align="left" colspan="1" rowspan="1">
                      <italic>Estimation procedure</italic>
                    </td>
                    <td align="left" colspan="1" rowspan="1">Reversible Jump MCMC(RJMCMC)</td>
                    <td align="left" colspan="1" rowspan="1">Fixed dimension Bayesian inference (e.g. using occupancy-like setup <xref ref-type="bibr" rid="pone.0042294-Royle4">[22]</xref>)</td>
                    <td align="left" colspan="1" rowspan="1">Straightforward implementation for non-uniform spatial support (e.g. unequal transect lengths)</td>
                  </tr>
                </tbody>
              </table>
            </alternatives><table-wrap-foot>
              <fn id="nt102">
                <label/>
                <p>Choices, alternative(s), and advantages of the modeling choices we made when analyzing double observer line transect data.</p>
              </fn>
            </table-wrap-foot></table-wrap>
          <p>Using the true functional form for detection and habitat models, we sampled the posterior distribution with two Markov chains of length 270,000 with random starting values, recording posterior values from one out of every 20 iterations to save disk space. Convergence was determined by examining trace plots and other standard convergence diagnostics <xref ref-type="bibr" rid="pone.0042294-Gelman1">[32]</xref>, and occurred after <inline-formula id="pone.0042294.e160"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e160" xlink:type="simple"/></inline-formula> iterations. Removing the first 20,000 iterations as a burn-in and combining thinned versions of each chain resulted in 25,000 samples with which to conduct posterior inference.</p>
        </sec>
        <sec id="s2i2">
          <title>Golf Tee Data</title>
          <p>To further test our estimation approach, we analyzed data from an experimental survey of golf tees collected at the University of St. Andrews in 1999 <xref ref-type="bibr" rid="pone.0042294-Borchers3">[35]</xref>. This experiment mimics many nuances of actual animal transect surveys, but has the added advantage that true abundance is known. Several authors have previously used these data to gauge the performance of double observer transect estimators when estimating abundance from a real world dataset <xref ref-type="bibr" rid="pone.0042294-Laake1">[7]</xref>, <xref ref-type="bibr" rid="pone.0042294-Borchers3">[35]</xref>.</p>
          <p>The locations of 108 groups of green golf tees and 142 groups of yellow golf tees were randomly assigned over a landscape with two spatial strata (<xref ref-type="fig" rid="pone-0042294-g003">Fig. 3</xref>). Experiment designers placed 44 groups of green and 86 groups of yellow tees in the northern stratum (area <inline-formula id="pone.0042294.e161"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e161" xlink:type="simple"/></inline-formula>), with the remainder being placed in the southern stratum (area <inline-formula id="pone.0042294.e162"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e162" xlink:type="simple"/></inline-formula>). Tees were distributed in groups of 1–8 tees according to a predefined distribution (<xref ref-type="fig" rid="pone-0042294-g004">Fig. 4</xref>), and were further classified by level of exposure to surrounding grass, with some tee groups partially hidden by grass (Exposure = 0) and others more visible (Exposure = 1).</p>
          <p>A total of 11 8-m wide transects were used to sample the population of golf tees, with eight independent observers traversing each transect. Transects varied in length, but completely covered the study area. We attempted to model these data in a similar manner to Laake and Borchers <xref ref-type="bibr" rid="pone.0042294-Laake1">[7]</xref> (hereafter, LB), in order to make valid comparisons. Like LB, we pooled observations from observers 1–4 and 5–8 into two separate observation “teams” in order to investigate the performance of double observer methods in reconstructing true population size.</p>
          <p>Using the double observer distance data, we attempted to estimate abundance of each “species” of tee (here, green and yellow) using our hierarchical probit formulation. We specified separate models for abundance intensity (<inline-formula id="pone.0042294.e163"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e163" xlink:type="simple"/></inline-formula>) for each species, making each a function of stratum. For the probit of detection probability, we used the same model structure as selected by LB as having the most support in the data. Symbolically, this model expresses the expected value of detection probability (on the probit scale) as</p>
          <disp-formula id="pone.0042294.e164"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0042294.e164" xlink:type="simple"/></disp-formula>
          <p>where <italic>Size</italic> specifies group size, and the ‘*’ symbol denotes a multiplicative interaction between variables. We modeled group size as a realization of an overdispersed, zero truncated Poisson process, and exposure as a categorical distribution.</p>
          <p>We sampled the posterior distribution corresponding to the golf tee data with two Markov chains with different starting values. After an initial pilot run of 1000 iterations to adjust MCMC tuning parameters to desired ranges, each chain was run for 100,000 iterations. Inspection of trace plots and other standard MCMC diagnostics suggested that convergence to a stationary distribution was obtained almost immediately; as such, we combined the final 90,000 iterations of each chain together for inference.</p>
        </sec>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <sec id="s3a">
        <title>Simulation Results</title>
        <p>Estimated abundances mirrored truth in each transect (<xref ref-type="fig" rid="pone-0042294-g002">Fig. 2</xref>). Estimated 95% credible intervals often included true parameter values (i.e. the values used to simulate data), although there were a few exceptions (<xref ref-type="fig" rid="pone-0042294-g005">Fig. 5</xref>). In particular, (i) the slope of the covariate-abundance relationship was overestimated for species one (posterior mean  = 1.10 instead of 1.00), and (ii) the magnitude of the distance effect on the detection function was consistently underestimated. We do not regard these discrepancies as overly problematic, however. Regarding (i), we were still able to capture the general pattern of linear increase in abundance (<xref ref-type="fig" rid="pone-0042294-g002">Fig. 2</xref>). Regarding (ii), we note that plots of realized detection functions still compare favorably to those used to generate data (<xref ref-type="fig" rid="pone-0042294-g006">Fig. 6</xref>).</p>
      </sec>
      <sec id="s3b">
        <title>Golf Tee Results</title>
        <p>For comparison with LB, we focus inference on the number of groups of animals (noting that posterior distributions for absolute abundance are also readily available). The posterior distribution for abundance of golf tees had a mean of 226 groups and 95% credible interval of (204, 251). By contrast, LB produced an estimate of 252, which was much closer to the true population size of 250. However, as LB note, this is somewhat accidental, as estimates of the number of groups in each color and exposure class differed substantially from true values. The hierarchical approach does better in this context, producing estimates that are as good or better than those generated by LB (<xref ref-type="fig" rid="pone-0042294-g007">Fig. 7</xref>). However, both approaches underestimate abundance for unexposed tees. We suspect that some of the unexposed tee clusters had very low (perhaps even zero) detection probabilities, and that the simple binary exposure covariate was insufficient to capture this variation.</p>
        <p>Likelihoods for conventional mark-recapture distance sampling (MRDS) estimators are often written as a function of several different types of detection functions <xref ref-type="bibr" rid="pone.0042294-Laake1">[7]</xref>. For instance, the <italic>conditional</italic> detection function, <inline-formula id="pone.0042294.e165"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e165" xlink:type="simple"/></inline-formula> gives the probability that an object at distance <inline-formula id="pone.0042294.e166"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e166" xlink:type="simple"/></inline-formula> is detected by observer <inline-formula id="pone.0042294.e167"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e167" xlink:type="simple"/></inline-formula> given that is was detected by observer <inline-formula id="pone.0042294.e168"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e168" xlink:type="simple"/></inline-formula>. Similarly, the <italic>individual</italic> detection function, <inline-formula id="pone.0042294.e169"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e169" xlink:type="simple"/></inline-formula> gives the unconditional probability that an object at distance <inline-formula id="pone.0042294.e170"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e170" xlink:type="simple"/></inline-formula> is detected by observer <inline-formula id="pone.0042294.e171"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e171" xlink:type="simple"/></inline-formula>; the <italic>duplicate</italic> detection function, <inline-formula id="pone.0042294.e172"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e172" xlink:type="simple"/></inline-formula> gives the probability that the object is detected by both observers; and the <italic>pooled</italic> detection function, <inline-formula id="pone.0042294.e173"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e173" xlink:type="simple"/></inline-formula> gives the probability that the object is detected by at least one observer. If observers are truly independent, there are theoretical relationships between these detection functions that should hold (e.g. <inline-formula id="pone.0042294.e174"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e174" xlink:type="simple"/></inline-formula>); as such, examining plots of these detection functions can be informative when examining observer dependence. Similarly, Buckland et al. <xref ref-type="bibr" rid="pone.0042294-Buckland3">[9]</xref> defined a dependence parameter, <inline-formula id="pone.0042294.e175"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e175" xlink:type="simple"/></inline-formula> to express observer dependence as a function of distance, where <inline-formula id="pone.0042294.e176"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e176" xlink:type="simple"/></inline-formula>. Although we have not included <inline-formula id="pone.0042294.e177"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e177" xlink:type="simple"/></inline-formula> or any of these detection functions explicitly in our modeling efforts, we calculated these quantities post hoc using posterior means to help in interpreting our results. Observer dependence (<inline-formula id="pone.0042294.e178"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e178" xlink:type="simple"/></inline-formula>) was estimated to be near 1.0 (that is, no dependence) for a large number of combinations of detection covariate values. Dependence was maximized with small group sizes, the second observer group, and green, unexposed tees (<xref ref-type="fig" rid="pone-0042294-g008">Fig. 8</xref>). This dynamic suggests heterogeneity in detection for small groups of unexposed tees that are far from observers.</p>
        <p>As suggested by Royle <xref ref-type="bibr" rid="pone.0042294-Royle6">[31]</xref>, we were able to estimate a posterior mass function for group sizes in the population (<xref ref-type="fig" rid="pone-0042294-g004">Fig. 4</xref>), which compared reasonably with the known empirical distribution. Similarly, we were able to estimate the proportion of unexposed tees in the population; the posterior mean for green tees was 0.46 (95% CI: 0.30,0.61), and the posterior mean for yellow tees was 0.50 (95% CI: 0.40,0.60). By contrast, true values for this proportion were 0.56 and 0.53, respectively. Finally, we were able to estimate the effect of habitat covariates (in this case, strata) on abundance intensity.</p>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>Double-observer transect data are widely used to estimate abundance of animal populations. Although previously available estimators (notably, Horvitz-Thompson-like estimators [HT]; <xref ref-type="bibr" rid="pone.0042294-Borchers3">[35]</xref>) have proven remarkably versatile for estimating abundance from such data, they are of limited utility in making inference about the effects of ecological covariates on abundance, estimating the distribution of individual covariates in a population, and in making predictions about abundance in unsampled areas. The latter is especially important when it is not feasible to employ design-based statistical inference <xref ref-type="bibr" rid="pone.0042294-Cochran1">[1]</xref>, either due to logistical or political constraints (e.g. certain areas are impossible to sample) or because the relative density of animals changes during the study <xref ref-type="bibr" rid="pone.0042294-Ver1">[36]</xref>.</p>
      <p>An alternative approach to extrapolating abundance over a large spatial domain is to use a multi-stage statistical procedure, where the outputs from the first stage of modeling (e.g. density estimates) are used as inputs (data) for a second round of modeling (e.g. using a spatial model with habitat covariates) <xref ref-type="bibr" rid="pone.0042294-Forney1">[37]</xref>, <xref ref-type="bibr" rid="pone.0042294-Hedley1">[38]</xref>. This approach is widely used for extrapolating line transect estimates to unsampled areas in absence of a truly experimental sample design, particularly for cetaceans <xref ref-type="bibr" rid="pone.0042294-Redfern1">[39]</xref>, <xref ref-type="bibr" rid="pone.0042294-Becker1">[40]</xref>. However, care must be taken that variability associated with model outputs in the first stage of modeling are carried through when producing final abundance estimates <xref ref-type="bibr" rid="pone.0042294-Ver1">[36]</xref>.</p>
      <p>We have presented a general framework for hierarchical analysis of double observer transect data that avoids many of these difficulties, obtaining posterior distributions for all parameters from a single analysis. In particular, abundance intensity can be made a function of habitat covariates, so that extrapolation to unsampled areas is straightforward (assuming that covariates are known for these areas). Further, precision of abundance estimates should be better than HT estimators whenever an explanatory habitat covariate can be identified. Modeling data from multiple observers allows us to relax the assumption of 100% detection on the transect line. Observer dependence can be accommodated via a bivariate normal distribution on the probit scale, helping to account for an increase in detection heterogeneity as a function of distance. To our knowledge, this is the first attempt at constructing a hierarchical model for double observer transect data.</p>
      <p>Our model performed well in estimating abundance of two simulated populations whose abundance intensities were linearly and quadratically related to a hypothesized habitat covariate. Admittedly, we supplied the estimation model with the correct functional form for habitat relationships, a convenience typically not possible in real world estimation scenarios. Unfortunately, we know of no universally accepted method for conducting model selection among alternate functional forms for habitat-density relationships when using a RJMCMC approach to estimation. For instance, the popular deviance information criterion (DIC; <xref ref-type="bibr" rid="pone.0042294-Spiegelhalter1">[41]</xref>) has been shown to perform poorly in missing data applications <xref ref-type="bibr" rid="pone.0042294-Celeux1">[42]</xref>. Presently, we suggest using a flexible functional form, with a selection of habitat covariates guided by biology to parameterize these relationships. Analysts can then examine credible intervals to confirm whether such parameters are biologically meaningful. Alternative model selection procedures (e.g. based on posterior predictive loss criteria; <xref ref-type="bibr" rid="pone.0042294-Gelfand1">[43]</xref>) are a subject of current research.</p>
      <p>Our model also performed well when estimating the abundance of a known population of golf tees, in some cases outperforming conventional MRDS HT estimators. The estimates from both approaches (hierarchical, MRDS) tended to underestimate the number of golf tees that were visually obstructed; however, we suspect that this was largely due to some groups of tees being virtually undetectable. As such, this should not be seen as a failure of our proposed method, but as an artifact of the particular dataset. It is well known that transect data alone will produce negatively biased estimates if some subset of the population is unavailable for detection <xref ref-type="bibr" rid="pone.0042294-McLaren1">[44]</xref>; further elaborations are needed to arrive at unbiased estimates in these cases <xref ref-type="bibr" rid="pone.0042294-Marsh1">[45]</xref>–<xref ref-type="bibr" rid="pone.0042294-Diefenbach1">[47]</xref>.</p>
      <p>We made a number of modeling choices that differ from the way in which line transect data are typically analyzed. Some of these choices, together with our rationale, are listed in <xref ref-type="table" rid="pone-0042294-t002">Table 2</xref>. One choice that deserves further explanation is our preference of the RJMCMC formulation for conducting inference in favor of an alternative “occupancy” parameterization recently advocated by several authors (e.g. <xref ref-type="bibr" rid="pone.0042294-Royle1">[15]</xref>, <xref ref-type="bibr" rid="pone.0042294-Link1">[16]</xref>). In a single site (or single transect) analysis, the two parameterizations are effectively identical, with the latter being more computationally efficient <xref ref-type="bibr" rid="pone.0042294-Link1">[16]</xref>. However, with multiple sites (or transects), the parameterization chosen for data augmentation can have practical ramifications for inference. A limiting case in spatial models is that counts (e.g. abundances in given transects) are distributed according to a Poisson distribution. The Poisson distribution has the convenient property of proportional scaling. For example, if transects differ in spatial support (i.e. are of different area), then abundance in a given transect <inline-formula id="pone.0042294.e179"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e179" xlink:type="simple"/></inline-formula> can be assumed to follow a <inline-formula id="pone.0042294.e180"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e180" xlink:type="simple"/></inline-formula> distribution. As we have shown in this paper, this relationship can be incorporated with relative ease using an RJMCMC data augmentation strategy (overdispersion relative to the Poisson distribution can be readily accommodated). By contrast, the approach advocated by Royle and Dorazio <xref ref-type="bibr" rid="pone.0042294-Royle1">[15]</xref> and Link and Barker <xref ref-type="bibr" rid="pone.0042294-Link1">[16]</xref> requires use of an occupancy parameter, <inline-formula id="pone.0042294.e181"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e181" xlink:type="simple"/></inline-formula>, the interpretation of which requires reference to the value of <inline-formula id="pone.0042294.e182"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e182" xlink:type="simple"/></inline-formula> assumed in the model (e.g. <inline-formula id="pone.0042294.e183"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e183" xlink:type="simple"/></inline-formula>). Further, the variance of expected abundance in this model (e.g. <inline-formula id="pone.0042294.e184"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e184" xlink:type="simple"/></inline-formula>) is negatively biased with regard to the Poisson variance (i.e. <inline-formula id="pone.0042294.e185"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0042294.e185" xlink:type="simple"/></inline-formula>). What effect this has on conducting hierarchical inference on abundance is presently unknown, but we recommend using the RJMCMC approach whenever spatial support differs among the areas sampled (e.g. when transects vary in size).</p>
      <p>Although we are convinced that our approach is valuable for making predictions in unsampled areas, there is clearly need for more research in this area. By virtue of its hierarchical structure, our approach can easily be extended to incorporate spatial autocorrelation in abundance. For instance, Schmidt et al. <xref ref-type="bibr" rid="pone.0042294-Schmidt1">[20]</xref> recently used conditionally autoregressive (CAR) models to account for spatial dependence in single observer transect data. However, predicting abundance with such models can be tricky, with spurious “edge effects” that can potentially compromise estimates of landscape-wide abundance <xref ref-type="bibr" rid="pone.0042294-VerHoef1">[48]</xref>. Best practices for conducting posterior predictions with such models is a subject of current research.</p>
      <p>We are also interested in extending our hierarchical framework to model partial observation and misclassification of species. In multi-species transect surveys, this is a real issue, as multiple observers often record species as unknown or have conflicting records. Currently available estimation approaches are incapable of handling such conflicts. Our data augmentation framework is clearly capable of treating true species as a latent (unobserved) variable, with misclassification introduced in the observation component of the model; however, parameter identification under such a scenario deserves further investigation.</p>
      <p>We strongly encourage ecologists interested in abundance and species-habitat relationships to consider hierarchical modeling for estimation, especially when it is infeasible to conduct standard designed-based inference. When surveys are replicated across time and space, hierarchical models provide demonstrable advantages over design-based modeling approaches, as information can be shared across temporal and spatial domains <xref ref-type="bibr" rid="pone.0042294-Moore1">[18]</xref>, <xref ref-type="bibr" rid="pone.0042294-Royle4">[22]</xref>. For multiple-observer transect surveys, our modeling framework and accompanying R package provides the tools necessary to implement a diverse array of hierarchical models.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pone.0042294.s001" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pone.0042294.s001" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>
            <bold>Posterior sampling algorithm for multiple observer transect analysis.</bold>
          </p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank D. Borchers for providing us with the golf tee data, and J. Moore and B. McClintock for comments on a previous draft of this paper. Views expressed are those of the authors and do not necessarily represent findings or policy of any government agency.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pone.0042294-Cochran1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cochran</surname><given-names>WG</given-names></name> (<year>1977</year>) <article-title>Sampling Techniques, 3rd Edition</article-title>. <source>New York: Wiley</source>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Burnham1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burnham</surname><given-names>KP</given-names></name>, <name name-style="western"><surname>Anderson</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Laake</surname><given-names>JL</given-names></name> (<year>1980</year>) <article-title>Estimation of density for line transect sampling of biological populations</article-title>. <source>Wildlife Monographs</source> <volume>72</volume>: <fpage>7</fpage>–<lpage>202</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Buckland1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buckland</surname><given-names>ST</given-names></name>, <name name-style="western"><surname>Anderson</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Burnham</surname><given-names>KP</given-names></name>, <name name-style="western"><surname>Laake</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Borchers</surname><given-names>DL</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Introduction to Distance Sampling: Estimating the abundance of biological populations</article-title>. <source>Oxford, U.K.: Oxford University Press</source>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Buckland2">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buckland</surname><given-names>ST</given-names></name> (<year>2006</year>) <article-title>Point-transect surveys for songbirds: robust methodologies</article-title>. <source>Auk</source> <volume>123</volume>: <fpage>345</fpage>–<lpage>357</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Nichols1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nichols</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Thomas</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Conn</surname><given-names>PB</given-names></name> (<year>2009</year>) <article-title>Inferences about landbird abundance from count data: recent advances and future directions</article-title>. <source>In: Thomson D, Cooch E, Conroy M, editors, Modeling Demographic Processes in Marked Populations, New York: Springer, volume 3 of <italic>Environmental and Ecological Statistics Series</italic></source>. <fpage>201</fpage>–<lpage>236</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Borchers1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Borchers</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Zucchini</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Fewster</surname><given-names>RM</given-names></name> (<year>1998</year>) <article-title>Mark-recapture models for line transect surveys</article-title>. <source>Biometrics</source> <volume>54</volume>: <fpage>1207</fpage>–<lpage>1220</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Laake1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Laake</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Borchers</surname><given-names>DL</given-names></name> (<year>2004</year>) <article-title>Methods for incomplete detection at distance zero</article-title>. <source>In: Buckland S, Anderson D, Burnham K, Laake J, Borchers D, et al., editors, Advanced Distance Sampling, Oxford, U.K.: Oxford University Press</source>. <fpage>108</fpage>–<lpage>189</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Borchers2">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Borchers</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Laake</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Southwell</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Paxton</surname><given-names>CGM</given-names></name> (<year>2006</year>) <article-title>Accomodating unmodeled heterogeneity in double-observer distance sampling surveys</article-title>. <source>Biometrics</source> <volume>62</volume>: <fpage>372</fpage>–<lpage>378</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Buckland3">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buckland</surname><given-names>ST</given-names></name>, <name name-style="western"><surname>Laake</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Borchers</surname><given-names>DL</given-names></name> (<year>2010</year>) <article-title>Double-observer line transect methods: Levels of independence</article-title>. <source>Biometrics</source> <volume>66</volume>: <fpage>169</fpage>–<lpage>177</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Drummer1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Drummer</surname><given-names>TD</given-names></name>, <name name-style="western"><surname>Mcdonald</surname><given-names>LL</given-names></name> (<year>1987</year>) <article-title>Size bias in line transect sampling</article-title>. <source>Biometrics</source> <volume>43</volume>: <fpage>13</fpage>–<lpage>21</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Ramsey1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ramsey</surname><given-names>FL</given-names></name>, <name name-style="western"><surname>Wildman</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Engbring</surname><given-names>J</given-names></name> (<year>1987</year>) <article-title>Adjustments to effective area in variable-area wildlife surveys</article-title>. <source>Biometrics</source> <volume>43</volume>: <fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Marques1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marques</surname><given-names>FFC</given-names></name>, <name name-style="western"><surname>Buckland</surname><given-names>ST</given-names></name> (<year>2003</year>) <article-title>Incorporating covariates into standard line transect analyses</article-title>. <source>Biometrics</source> <volume>59</volume>: <fpage>924</fpage>–<lpage>935</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Huggins1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huggins</surname><given-names>RM</given-names></name> (<year>1989</year>) <article-title>On the statistical analysis of capture-recapture experiments</article-title>. <source>Biometrika</source> <volume>76</volume>: <fpage>133</fpage>–<lpage>140</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Alho1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alho</surname><given-names>JM</given-names></name> (<year>1990</year>) <article-title>Logistic regression in capture-recapture models</article-title>. <source>Biometrics</source> <volume>46</volume>: <fpage>623</fpage>–<lpage>635</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Royle1">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Royle</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Dorazio</surname><given-names>RM</given-names></name> (<year>2008</year>) <article-title>Hierarchical Modeling and Inference in Ecology</article-title>. <source>London, U.K.: Academic Press</source>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Link1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Link</surname><given-names>WA</given-names></name>, <name name-style="western"><surname>Barker</surname><given-names>RJ</given-names></name> (<year>2010</year>) <article-title>Bayesian Inference with Ecological Applications</article-title>. <source>London, U.K.: Academic Press</source>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Royle2">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Royle</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Dorazio</surname><given-names>RM</given-names></name> (<year>2010</year>) <article-title>Parameter-expanded data augmentation for Bayesian analysis of capture-recapture models</article-title>. <source>Journal of Ornithology</source> <volume>152</volume>: <fpage>521</fpage>–<lpage>537</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Moore1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moore</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Barlow</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Bayesian state-space model of fin whale abundance trends from a 1991–2008 time series of line-transect surveys in the california current</article-title>. <source>Journal of Applied Ecology</source> <volume>48</volume>: <fpage>1195</fpage>–<lpage>1205</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Chelgren1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chelgren</surname><given-names>ND</given-names></name>, <name name-style="western"><surname>Samora</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Adams</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>McCreary</surname><given-names>B</given-names></name> (<year>2011</year>) <article-title>Using spatiotemporal models and distance sampling to map the space use and abundance of newly metamorphosed western toads (Anaxyrus boreas)</article-title>. <source>Herpetological Conservation and Biology</source> <volume>6</volume>: <fpage>175</fpage>–<lpage>190</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Schmidt1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schmidt</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Rattenbury</surname><given-names>KL</given-names></name>, <name name-style="western"><surname>Lawler</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Maccluskie</surname><given-names>MC</given-names></name> (<year>2011</year>) <article-title>Using distance smapling and hierarchical models to improve estimates of dall’s sheep abundance</article-title>. <source>Journal of Wildlife Management</source> <volume>76</volume>: <fpage>317</fpage>–<lpage>327</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Royle3">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Royle</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Dawson</surname><given-names>DK</given-names></name>, <name name-style="western"><surname>Bates</surname><given-names>S</given-names></name> (<year>2004</year>) <article-title>Modeling abundance effects in distance sampling</article-title>. <source>Ecology</source> <volume>85</volume>: <fpage>1591</fpage>–<lpage>1597</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Royle4">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Royle</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Kéry</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gautier</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Schmid</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>Hierarchical spatial models of abundance and occurence from imperfect survey data</article-title>. <source>Ecological Monographs</source> <volume>77</volume>: <fpage>465</fpage>–<lpage>481</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Durban1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Durban</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Elston</surname><given-names>D</given-names></name> (<year>2005</year>) <article-title>Mark-recapture with occasional and individual effects: abundance estimation through Bayesian model selection in a fixed dimensional parameter space</article-title>. <source>Journal of Agricultural, Biological, and Environmental Statistics</source> <volume>10</volume>: <fpage>291</fpage>–<lpage>305</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Tanner1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tanner</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>WH</given-names></name> (<year>1987</year>) <article-title>The calculation of posterior distributions by data augmentation (with discussion)</article-title>. <source>Journal of the American Statistical Association</source> <volume>82</volume>: <fpage>528</fpage>–<lpage>550</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Royle5">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Royle</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Dorazio</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Link</surname><given-names>WA</given-names></name> (<year>2007</year>) <article-title>Analysis of multinomial models with unknown index using data augmentation</article-title>. <source>Journal of Computational and Graphical Statistics</source> <volume>16</volume>: <fpage>1</fpage>–<lpage>19</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Carlin1">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carlin</surname><given-names>BP</given-names></name>, <name name-style="western"><surname>Chib</surname><given-names>S</given-names></name> (<year>1995</year>) <article-title>Bayesian model choice via Markov chain Monte Carlo methods</article-title>. <source>Journal of the Royal Statistical Society B</source> <volume>57</volume>: <fpage>473</fpage>–<lpage>485</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Green1">
        <label>27</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Green</surname><given-names>PJ</given-names></name> (<year>1995</year>) <article-title>Reversible jump Markov chain Monte Carlo computation and Bayesian model determination</article-title>. <source>Biometrika</source> <volume>82</volume>: <fpage>711</fpage>–<lpage>732</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-McCullagh1">
        <label>28</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McCullagh</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Nelder</surname><given-names>JA</given-names></name> (<year>1989</year>) <article-title>Generalized Linear Models</article-title>. <source>New York: Chapman and Hall</source>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Albert1">
        <label>29</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Albert</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Chib</surname><given-names>S</given-names></name> (<year>1993</year>) <article-title>Bayesian analysis of binary and polychotomous response data</article-title>. <source>Journal of the American Statistical Association</source> <volume>88</volume>: <fpage>669</fpage>–<lpage>679</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-McClintock1">
        <label>30</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McClintock</surname><given-names>BT</given-names></name>, <name name-style="western"><surname>White</surname><given-names>GC</given-names></name>, <name name-style="western"><surname>Antolin</surname><given-names>MF</given-names></name>, <name name-style="western"><surname>Tripp</surname><given-names>DW</given-names></name> (<year>2009</year>) <article-title>Estimating abundance using markresight when sampling is with replacement or the number of marked individuals is unknown</article-title>. <source>Biometrics</source> <volume>65</volume>: <fpage>237</fpage>–<lpage>246</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Royle6">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Royle</surname><given-names>JA</given-names></name> (<year>2008</year>) <article-title>Hierarchical modeling of cluster size in wildlife surveys</article-title>. <source>Journal of Agricultural, Biological, and Environmental Statistics</source> <volume>13</volume>: <fpage>23</fpage>–<lpage>36</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Gelman1">
        <label>32</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gelman</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Carlin</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Stern</surname><given-names>HS</given-names></name>, <name name-style="western"><surname>Rubin</surname><given-names>DB</given-names></name> (<year>2004</year>) <article-title>Bayesian Data Analysis, 2nd Edition</article-title>. <source>Boca Ration: Chapman and Hall</source>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Collett1">
        <label>33</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Collett</surname><given-names>D</given-names></name> (<year>2003</year>) <article-title>Modelling Binary Data, 2nd Edition</article-title>. <source>Boca Raton, Florida: Chapman &amp; Hall/CRC</source>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-R1">
        <label>34</label>
        <mixed-citation publication-type="other" xlink:type="simple">R Development Core Team (2007) R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria.  Available: http://www.R-project.org. ISBN 3-900051-07-0..</mixed-citation>
      </ref>
      <ref id="pone.0042294-Borchers3">
        <label>35</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Borchers</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Buckland</surname><given-names>ST</given-names></name>, <name name-style="western"><surname>Zucchini</surname><given-names>W</given-names></name> (<year>2002</year>) <article-title>Estimating Animal Abundance: Closed Populations</article-title>. <source>London, U.K.: Springer-Verlag</source>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Ver1">
        <label>36</label>
        <mixed-citation publication-type="other" xlink:type="simple">Ver Hoef JM, Cameron MF, Boveng PL, London JM, Moreland EE (In press) A hierarchical model for abundance of three ice-associated seal species in the eastern Bering sea. Statistical Methodology.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Forney1">
        <label>37</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Forney</surname><given-names>KA</given-names></name> (<year>2000</year>) <article-title>Environmental models of cetacean abundance: reducing uncertainty in population trends</article-title>. <source>Conservation Biology</source> <volume>14</volume>: <fpage>1271</fpage>–<lpage>1286</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Hedley1">
        <label>38</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hedley</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Buckland</surname><given-names>ST</given-names></name> (<year>2004</year>) <article-title>Spatial models for line transect sampling</article-title>. <source>Journal of Agricultural, Biological, and Environmental Statistics</source> <volume>9</volume>: <fpage>181</fpage>–<lpage>199</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Redfern1">
        <label>39</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Redfern</surname><given-names>JV</given-names></name>, <name name-style="western"><surname>Ferguson</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Becker</surname><given-names>EA</given-names></name>, <name name-style="western"><surname>Good</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Barlow</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Techniques for cetaceanhabitat modeling</article-title>. <source>Marine Ecology Progress Series</source> <volume>310</volume>: <fpage>271</fpage>–<lpage>295</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Becker1">
        <label>40</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Becker</surname><given-names>EA</given-names></name>, <name name-style="western"><surname>Forney</surname><given-names>KA</given-names></name>, <name name-style="western"><surname>Ferguson</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Foley</surname><given-names>DG</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>RC</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Comparing California Current cetacean-habitat models developed using <italic>in situ</italic> and remotely sensed sea surface temperature data</article-title>. <source>Marine Ecology Progress Series</source> <volume>413</volume>: <fpage>163</fpage>–<lpage>183</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Spiegelhalter1">
        <label>41</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spiegelhalter</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Best</surname><given-names>NG</given-names></name>, <name name-style="western"><surname>Carlin</surname><given-names>BP</given-names></name>, <name name-style="western"><surname>van der Linde</surname><given-names>A</given-names></name> (<year>2002</year>) <article-title>Bayesian measures of model complexity and fit</article-title>. <source>Journal of the Royal Statistical Society Series B</source> <volume>64</volume>: <fpage>583</fpage>–<lpage>639</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Celeux1">
        <label>42</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Celeux</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Forbes</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Robert</surname><given-names>CP</given-names></name>, <name name-style="western"><surname>Titterington</surname><given-names>DM</given-names></name> (<year>2006</year>) <article-title>Deviance information criterion for missing data models</article-title>. <source>Bayesian Analysis</source> <volume>1</volume>: <fpage>651</fpage>–<lpage>674</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Gelfand1">
        <label>43</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gelfand</surname><given-names>AE</given-names></name>, <name name-style="western"><surname>Ghosh</surname><given-names>SK</given-names></name> (<year>1998</year>) <article-title>Model choice: A minimum posterior predictive loss approach</article-title>. <source>Biometrika</source> <volume>85</volume>: <fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-McLaren1">
        <label>44</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McLaren</surname><given-names>IA</given-names></name> (<year>1961</year>) <article-title>Methods of determining the numbers and availability of ring seals in the eastern canadian arctic</article-title>. <source>Arctic</source> <volume>14</volume>: <fpage>162</fpage>–<lpage>175</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Marsh1">
        <label>45</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marsh</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Sinclair</surname><given-names>DF</given-names></name> (<year>1989</year>) <article-title>Correcting for visibility bias in strip transect aerial surveys of aquatic fauna</article-title>. <source>Journal of Wildlife Management</source> <volume>53</volume>: <fpage>1017</fpage>–<lpage>1024</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Bengtson1">
        <label>46</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bengtson</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Hiruki-Raring</surname><given-names>LM</given-names></name>, <name name-style="western"><surname>Simpkins</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Boveng</surname><given-names>PL</given-names></name> (<year>2005</year>) <article-title>Ringed and bearded seal densities in the eastern Chuckchi Sea, 1999–2000</article-title>. <source>Polar Biology</source> <volume>28</volume>: <fpage>833</fpage>–<lpage>845</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-Diefenbach1">
        <label>47</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Diefenbach</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Marshall</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Mattice</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Brauning</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>Incorporating availability for detection in estimates of bird abundance</article-title>. <source>The Auk</source> <volume>124</volume>: <fpage>96</fpage>–<lpage>106</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0042294-VerHoef1">
        <label>48</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ver Hoef</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Jansen</surname><given-names>JK</given-names></name> (<year>2007</year>) <article-title>Space-time zero-inflated count models of harbor seals</article-title>. <source>Environmetrics</source> <volume>18</volume>: <fpage>697</fpage>–<lpage>712</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>