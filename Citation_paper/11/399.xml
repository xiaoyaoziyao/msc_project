<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0194861</article-id>
<article-id pub-id-type="publisher-id">PONE-D-17-41062</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Developmental biology</subject><subj-group><subject>Embryology</subject><subj-group><subject>Embryos</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Animal models</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Invertebrates</subject><subj-group><subject>Nematoda</subject><subj-group><subject>Caenorhabditis</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject><subj-group><subject>Neurites</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject><subj-group><subject>Neurites</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Developmental biology</subject><subj-group><subject>Morphogenesis</subject><subj-group><subject>Morphogenic segmentation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Microscopy</subject><subj-group><subject>Light microscopy</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Head</subject><subj-group><subject>Eyes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Head</subject><subj-group><subject>Eyes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Ocular system</subject><subj-group><subject>Eyes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Ocular system</subject><subj-group><subject>Eyes</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Automated <italic>C</italic>. <italic>elegans</italic> embryo alignments reveal brain neuropil position invariance despite lax cell body placement</article-title>
<alt-title alt-title-type="running-head">Automated spatiotemporal alignment of developing <italic>C</italic>. <italic>elegans</italic> embryos</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Insley</surname>
<given-names>Peter</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3751-975X</contrib-id>
<name name-style="western">
<surname>Shaham</surname>
<given-names>Shai</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Laboratory of Developmental Genetics, The Rockefeller University, New York, NY, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Hart</surname>
<given-names>Anne C.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Brown University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">shaham@rockefeller.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>28</day>
<month>3</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<year>2018</year>
</pub-date>
<volume>13</volume>
<issue>3</issue>
<elocation-id>e0194861</elocation-id>
<history>
<date date-type="received">
<day>21</day>
<month>11</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>3</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Insley, Shaham</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0194861"/>
<abstract>
<p>The <italic>Caenorhabditis elegans</italic> cell lineage is nearly invariant. Whether this stereotyped cell-division pattern promotes reproducibility in cell shapes/positions is not generally known, as manual spatiotemporal cell-shape/position alignments are labor-intensive, and fully-automated methods are not described. Here, we report automated algorithms for spatiotemporal alignments of <italic>C</italic>. <italic>elegans</italic> embryos from pre-morphogenesis to motor-activity initiation. We use sparsely-labeled green-fluorescent nuclei and a pan-nuclear red-fluorescent reporter to register consecutive imaging time points and compare embryos. Using our method, we monitor early assembly of the nerve-ring (NR) brain neuropil. While NR pioneer neurons exhibit reproducible growth kinetics and axon positions, cell-body placements are variable. Thus, pioneer-neuron axon locations, but not cell-body positions, are under selection. We also show that anterior NR displacement in <italic>cam-1</italic>/ROR Wnt-receptor mutants is not an early NR assembly defect. Our results demonstrate the utility of automated spatiotemporal alignments of <italic>C</italic>. <italic>elegans</italic> embryos, and uncover key principles guiding nervous-system development in this animal.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000065</institution-id>
<institution>National Institute of Neurological Disorders and Stroke</institution>
</institution-wrap>
</funding-source>
<award-id>R01NS064273</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3751-975X</contrib-id>
<name name-style="western">
<surname>Shaham</surname>
<given-names>Shai</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000065</institution-id>
<institution>National Institute of Neurological Disorders and Stroke</institution>
</institution-wrap>
</funding-source>
<award-id>R01NS095795</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3751-975X</contrib-id>
<name name-style="western">
<surname>Shaham</surname>
<given-names>Shai</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000065</institution-id>
<institution>National Institute of Neurological Disorders and Stroke</institution>
</institution-wrap>
</funding-source>
<award-id>R01NS081490</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3751-975X</contrib-id>
<name name-style="western">
<surname>Shaham</surname>
<given-names>Shai</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000071</institution-id>
<institution>National Institute of Child Health and Human Development</institution>
</institution-wrap>
</funding-source>
<award-id>R01HD078703</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3751-975X</contrib-id>
<name name-style="western">
<surname>Shaham</surname>
<given-names>Shai</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000065</institution-id>
<institution>National Institute of Neurological Disorders and Stroke</institution>
</institution-wrap>
</funding-source>
<award-id>R35NS105094</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3751-975X</contrib-id>
<name name-style="western">
<surname>Shaham</surname>
<given-names>Shai</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by NIH grants NS064273, NS095795, NS081490, HD078703 to SS. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="1"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All source codes are available at <ext-link ext-link-type="uri" xlink:href="https://osf.io/hbd4g/" xlink:type="simple">https://osf.io/hbd4g/</ext-link> (Open Science Framework). All other data is in the manuscript or supporting files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The somatic cell lineage of the nematode <italic>C</italic>. <italic>elegans</italic> is essentially invariant between individuals. Thus, for example, <italic>C</italic>. <italic>elegans</italic> hermaphrodites contain 302 neurons, each identifiable by name, with a lineal history traceable back to the zygote. Constancy in lineage could dictate reproducibility in cell placement and morphology, as has been previously suggested [<xref ref-type="bibr" rid="pone.0194861.ref001">1</xref>,<xref ref-type="bibr" rid="pone.0194861.ref002">2</xref>]. Alternatively, cell position and shape could be governed by other imperatives. How lineage relates to cell positioning/morphology is of particular interest in the nervous system, where neurons must interact with specific partners to form circuits generating behavior.</p>
<p>Assessing reproducibility of cell shape and positioning during <italic>C</italic>. <italic>elegans</italic> development requires precise alignments of developing embryos. However, embryos are usually imaged in arbitrary orientations and exhibit variable developmental movements [<xref ref-type="bibr" rid="pone.0194861.ref002">2</xref>–<xref ref-type="bibr" rid="pone.0194861.ref004">4</xref>]. Thus, quantitative cell position/shape comparisons must correct for such bulk differences in animal configuration. Furthermore, since embryogenesis lasts 14 hours at 2°C, and important developmental events occur on minute time scales, temporal alignments must be ensured.</p>
<p>Manual alignments of high-resolution movies capturing <italic>C</italic>. <italic>elegans</italic> embryogenesis are tedious and low throughput, and existing computational methods can extract embryo features, but have not been used for automated alignments [<xref ref-type="bibr" rid="pone.0194861.ref003">3</xref>,<xref ref-type="bibr" rid="pone.0194861.ref004">4</xref>]. To this end, we developed a fully automated method for spatiotemporal alignment of <italic>C</italic>. <italic>elegans</italic> embryos from pre-morphogenesis (~50–100 cells) to the onset of muscle twitching [<xref ref-type="bibr" rid="pone.0194861.ref001">1</xref>]. Fiduciary markers were previously used for alignments in a number of settings [<xref ref-type="bibr" rid="pone.0194861.ref005">5</xref>,<xref ref-type="bibr" rid="pone.0194861.ref006">6</xref>,<xref ref-type="bibr" rid="pone.0194861.ref007">7</xref>,<xref ref-type="bibr" rid="pone.0194861.ref008">8</xref>]. We used this approach, together with organism-wide markers [<xref ref-type="bibr" rid="pone.0194861.ref002">2</xref>,<xref ref-type="bibr" rid="pone.0194861.ref009">9</xref>] in our studies. We employ a pan-nuclear marker for staging, sizing, and initial embryo orientation, and a sparsely-distributed nuclear marker, defining fiducial points, to track developmentally variable rotations and translations. The method uses increasingly accurate registration steps that avoid misleading local alignment solutions, to align test embryos onto a reference. Some of the strategies we use are reminiscent of those employed in [<xref ref-type="bibr" rid="pone.0194861.ref010">10</xref>], studying mouse embryonic development, although the details are quite different. An overview of our method is found in <xref ref-type="supplementary-material" rid="pone.0194861.s001">S1 Fig</xref>.</p>
<p>To examine the efficacy and utility of our algorithm, we studied the development of the <italic>C</italic>. <italic>elegans</italic> brain neuropil, the nerve ring (NR). Approximately 180 <italic>C</italic>. <italic>elegans</italic> neurons send processes into the NR, where most synapses are found [<xref ref-type="bibr" rid="pone.0194861.ref011">11</xref>,<xref ref-type="bibr" rid="pone.0194861.ref012">12</xref>]. While neurons are added to the NR throughout development [<xref ref-type="bibr" rid="pone.0194861.ref011">11</xref>], the structure begins assembly between the bean and comma stages of embryonic development, slightly after embryonic morphogenesis onset [<xref ref-type="bibr" rid="pone.0194861.ref013">13</xref>]. The NR is initially demarcated by processes of CEPsh glial cells with radial-glia-like features, which form a structure that later circumscribes the pharynx. These glia guide axons of 5 bilateral pairs of sublateral (SubL) pioneer neurons to form a NR primordium consisting of ~10 processes. Glia and pioneer neurons then together direct NR entry of follower axons [<xref ref-type="bibr" rid="pone.0194861.ref013">13</xref>].</p>
<p>We used a custom-built single-plane-illumination microscope [<xref ref-type="bibr" rid="pone.0194861.ref014">14</xref>,<xref ref-type="bibr" rid="pone.0194861.ref015">15</xref>] to collect 34 movie stacks of early NR assembly in developing embryos expressing green-fluorescent protein (GFP) in SubL neurons. Remarkably, embryo alignments using our algorithm reveal that while NR SubL axons are positioned to within ~1 μm in different embryos, SubL cell body positions are much more loosely aligned. Unlike SubL neurons, one neuron we imaged, ALA, whose cell body resides near the NR anterior apex, shows little positional variation. Thus, NR and ALA cell-body positions are under precise control, whereas SubL neuron cell-body positions are not under tight selection. The substantial variability we observe for SubL cell body placement is surprising, given that <italic>C</italic>. <italic>elegans</italic> development has been suggested to be invariant [<xref ref-type="bibr" rid="pone.0194861.ref001">1</xref>,<xref ref-type="bibr" rid="pone.0194861.ref002">2</xref>].</p>
<p>Having characterized the fidelity of early nerve ring formation, we used our method to align embryos bearing mutations in <italic>cam-1</italic>/ROR, a receptor-tyrosine-kinase gene required for NR positioning in larvae [<xref ref-type="bibr" rid="pone.0194861.ref016">16</xref>,<xref ref-type="bibr" rid="pone.0194861.ref017">17</xref>]. These studies uncover previously-unappreciated defects in <italic>cam-1</italic> mutants, including formation of a giant NR, associated with loss of animal viability. Furthermore, we show that in surviving animals, initial NR positioning is not perturbed, suggesting that <italic>cam-1</italic> likely functions for later maintenance of NR placement.</p>
<p>Our studies demonstrate the utility of automated embryo alignments for quantitative studies of cell shapes and positions. Since our alignment procedure is generic, it can be extended to other reporter combinations in <italic>C</italic>. <italic>elegans</italic>, as well as to other model systems in which a pan-nuclear marker and an asymmetric fiduciary marker can be identified.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Challenges in aligning <italic>C</italic>. <italic>elegans</italic> embryos</title>
<p>A straightforward way to align two objects is to identify fiducial markers common to both, and then rotate and translate one with respect to the other, until the markers overlap. Thus, in principle, to align two <italic>C</italic>. <italic>elegans</italic> embryos, each would express a fluorescent reporter labeling a common set of cells, and rigid transformations would then be used to overlap these labels. In practice however, this simple idea is remarkably challenging. Since embryos are not rigid objects and embryonic development involves dynamic cell movements, it is impossible to identify fiducial cells whose positions remain constant in time. It is also impossible to keep the number of fiducial cells constant over time, as labeled cells in early embryogenesis divide. Furthermore, most gene reporters display dynamic expression patterns; thus, embryos must be temporally aligned so that identical time points are compared. Even then, positions and label intensity of fiducial labels may vary between embryos as a result of reporter expression differences. Embryo orientation will also affect signal, as spherical aberration and scattering processes will reduce signal from deeper layers. Thus, perfect alignments are generally unattainable, and a best fit should be sought. Often, however, multiple fits with similar alignment scores can be found, and the relevant solution must be identified. Finally, embryos exhibit bulk rotations that vary in magnitude, and are imaged at different initial orientations. Thus, the same alignment parameters cannot be used for each embryo and each time point.</p>
<p>Below, we describe our procedures for addressing these challenges. Embryo image stacks for alignments were acquired on a custom-built single-plane-illumination microscope (Methods) at 20°C for 20 consecutive 10-min intervals (T1-T20) starting within 20 minutes of the first cell division and through the embryonic ball stage [<xref ref-type="bibr" rid="pone.0194861.ref001">1</xref>], to determine embryo shape and temporal staging. Imaging frequency was then increased during morphogenesis, and 125 consecutive images (T21-T145) collected at 2-min intervals, until muscle twitching onset. One embryo was arbitrarily selected as a reference to which test embryos were aligned. An overview of the alignment procedure is presented in <xref ref-type="supplementary-material" rid="pone.0194861.s001">S1 Fig</xref>.</p>
</sec>
<sec id="sec004">
<title>The imaging strain and image segmentation</title>
<p>We used two reporter transgenes for alignments: <italic>his-72</italic>p::HIS-24::mCherry [<xref ref-type="bibr" rid="pone.0194861.ref018">18</xref>], expressing mCherry in all nuclei from the 50-cell stage onward; and <italic>unc-130</italic>p::NLS::GFP [<xref ref-type="bibr" rid="pone.0194861.ref019">19</xref>], expressing GFP in nuclei of anterior cells starting at the 100 cell stage (4–40 nuclei, depending on stage), and in 4 posterior nuclei. To visualize NR development, a <italic>ceh-17</italic>::GFP cytoplasmic reporter, labeling the SIAVR/L, SIADR/L, and SIBVR/L SubL neurons, and the ALA, RMED, DA8, and DB5 neurons was used [<xref ref-type="bibr" rid="pone.0194861.ref020">20</xref>–<xref ref-type="bibr" rid="pone.0194861.ref022">22</xref>] (Methods; <xref ref-type="fig" rid="pone.0194861.g001">Fig 1A–1C</xref>; <xref ref-type="supplementary-material" rid="pone.0194861.s006">S1 Movie</xref>). This reporter was not used for alignments.</p>
<fig id="pone.0194861.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0194861.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Imaging strain reporters and GFP segmentation.</title>
<p><bold>A-C)</bold> Embryo, just before twitching, expressing indicated fluorescent reporters for alignments and for visualization of the nerve ring and sublateral neuron cell bodies. <bold>A</bold>) Cyan arrowhead, <italic>unc-130</italic>::GFP-labeled nucleus. Yellow arrowhead, sublateral neuron cell body. Brown arrowhead, nerve ring. Magenta arrowhead, ALA neuron. <bold>B)</bold> mCherry channel of same embryo. <bold>C</bold>) Merge of <bold>A</bold> and <bold>B</bold>. <bold>D-F</bold>) Segmentation of GFP signals on a test embryo not used for training the classifier. <bold>D</bold>) Raw image. <bold>E</bold>) Blue, segmented <italic>unc-130</italic>::GFP nuclei. Segmentation is restricted to anterior half of embryo outside a central cylinder surrounding the nerve ring. White arrowhead, false negative. <bold>F</bold>) Blue, <italic>ceh-17</italic>::GFP sublateral neuron cell body segmentation. Orange arrowhead, false positive.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.g001" xlink:type="simple"/>
</fig>
<p>To facilitate alignments of embryos between consecutive time points, and of test embryos onto the reference (see sections below), we sought to automatically identify and distinguish fluorescent signals produced by each reporter protein.</p>
<p>To assign mCherry nuclei, we used the StarryNite program, previously designed for segmenting <italic>C</italic>. <italic>elegans</italic> nuclei from image stacks [<xref ref-type="bibr" rid="pone.0194861.ref023">23</xref>]. By tuning the parameters that govern the probability of segmenting a nucleus from a given region, such as “intensity threshold”, to generate a low number of false positives (at the expense of producing some false negatives), we automatically generated a list of nuclear centers for the first 40 time points of each movie, without the usual manual curation (Methods). Parameter thresholds were adjusted until nuclear segmentation outside of the eggshell was not observed in an early test population (not used for further analysis).</p>
<p>GFP segmentation was more complicated, since <italic>unc-130</italic>p::NLS::GFP nuclei, as well as <italic>ceh-17</italic>::GFP neuronal cell bodies and processes, are labeled with this protein. Attempts to differentiate between these features using brightness failed to separate <italic>ceh-17</italic> neurites and <italic>unc-130</italic> nuclei. However, using the machine-learning segmentation program Ilastik [<xref ref-type="bibr" rid="pone.0194861.ref024">24</xref>], we generated a classifier that distinguished between these signals (<xref ref-type="fig" rid="pone.0194861.g001">Fig 1D–1F</xref>; <xref ref-type="supplementary-material" rid="pone.0194861.s002">S2 Fig</xref>; Methods). The classifier was obtained by training the program on five embryos, including the reference embryo, on four time points per embryo during the fast imaging period (T21-T145). The classifier was trained to reduce cross-assignments of <italic>unc-130</italic>p::NLS::GFP and <italic>ceh-17</italic>::GFP at the expense of a high rate of false-negative assignments (Panels B-C in <xref ref-type="supplementary-material" rid="pone.0194861.s002">S2 Fig</xref>), apparently keeping thresholds for nuclear detection within narrow bounds. This procedure was facilitated by only considering <italic>unc-130</italic>p::NLS::GFP signal outside a cylindrical region surrounding the NR in the anterior half of the embryo, and by restricting segmentation to the largest contiguous objects, after use of a Gaussian blurring filter that fills in gaps in objects, thereby reducing signal from disconnected single-pixel-scale objects (Methods).</p>
</sec>
<sec id="sec005">
<title>Temporal alignment of developing embryos</title>
<p>Variability in developmental rates and imaging start times must be addressed to ensure alignment of a test embryo movie to the reference movie. To that end, we collected Starry-Nite segmentation estimates of the number of nuclei per time point over the 20 consecutive frames of slow imaging (T1-T20). The number of nuclei between frames was then interpolated using piecewise cubic hermite polynomials [<xref ref-type="bibr" rid="pone.0194861.ref025">25</xref>], adding four additional nuclei number estimates between consecutive frames, for improved resolution in matching. The resulting temporal distribution of nuclei number was shifted to match that of the reference embryo by a linear time offset (<xref ref-type="fig" rid="pone.0194861.g002">Fig 2</xref>). The offset was chosen to minimize the summed square difference of nuclei numbers across corresponding time points. The root mean square error over all embryos and time points, measured with respect to the reference embryo, and normalized for the number of overlapping time points before and after offset, is 39.2 nuclei prior to offset application, and 10.0 nuclei after. The mean offset across all test embryos was -5.0 min. As seen in <xref ref-type="fig" rid="pone.0194861.g002">Fig 2B</xref>, time courses of different embryos display similar characteristics, and appear aligned to within a few minutes, suggesting that further temporal adjustment, such as multiplicative scaling (e.g. [<xref ref-type="bibr" rid="pone.0194861.ref026">26</xref>]), may be unnecessary.</p>
<fig id="pone.0194861.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0194861.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Temporal alignments of embryos.</title>
<p><bold>A,B</bold>) Bold green curve: reference embryo. Other curves, individual test embryos. <bold>A</bold>) Raw nuclear counts over time. <bold>B</bold>) Nuclear counts over time after implementation of temporal correction algorithm. <bold>C,D</bold>) Onset of twitching, relative to reference embryo without (<bold>C</bold>) and with temporal alignment (<bold>D</bold>). Mean and SD of data are indicated.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.g002" xlink:type="simple"/>
</fig>
<p>To confirm this, we timed the onset of the first instance of muscle twitching. While the standard deviation in twitching times prior to offset application was 19.1 min, it was reduced to 7.4 min following offset implementation (<xref ref-type="fig" rid="pone.0194861.g002">Fig 2C and 2D</xref>). This observation supports the idea that our temporal alignment is accurate to within a few minutes in the time up to twitching, sufficient to track most known developmental events. Surprisingly, our results also suggest that onset of twitching is a precisely reproducible developmental time point, an observation that to our knowledge had not been quantitatively demonstrated before. Correlation of calculated temporal offsets with twitching time was found to be similarly precise to correlation of twitching times with individual cell division plateaus during development (r = .94 for temporal offsets; r = .90 for each of the two plateaus which could reliably be extracted from the data; Methods).</p>
</sec>
<sec id="sec006">
<title>Defining an embryonic long axis</title>
<p>To spatially align embryos that have been temporally aligned, we sought to define coordinate axes for each embryo that could then be brought computationally into correspondence with a similar coordinate system for the reference embryo. To define an axis corresponding to the anterior-posterior (long) axis in early embryos, we used the positions of the mCherry nuclei on the surface of each pre-morphogenesis embryo as an indicator of overall embryonic shape (<xref ref-type="fig" rid="pone.0194861.g003">Fig 3</xref>). The surface nuclei were defined by taking the convex hull of all nuclei (i.e., the smallest convex surface containing all nuclei). We then defined a uniform-density volume by filling the interior of the convex hull, producing a model of the embryo volume, and calculated the principle moments of inertia and centroids of the resulting distribution (<xref ref-type="fig" rid="pone.0194861.g003">Fig 3A–3C</xref>). The axis corresponding to the smallest principle moment (P1 axis) was placed along the camera <italic>x</italic>-axis (<xref ref-type="fig" rid="pone.0194861.g003">Fig 3C</xref>, orange arrow). We averaged our results over 16 time points (T15 –T30) for the reference embryo. This time period was chosen as it corresponds to the period (ball-bean stage) during which an embryo grows to its maximum extent in the eggshell without elongation drastically changing its geometry [<xref ref-type="bibr" rid="pone.0194861.ref001">1</xref>,<xref ref-type="bibr" rid="pone.0194861.ref003">3</xref>]. The same developmental time period was used to average P1 axis positions in test embryos.</p>
<fig id="pone.0194861.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0194861.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Defining a universal coordinate system for alignment of test and reference embryos.</title>
<p>Green, <italic>unc-130</italic>::GFP segmentation. Red, mCherry segmentation. <bold>A</bold>) Raw segmented test embryo. <bold>B</bold>) Axes of the embryo determined using convex hull of mCherry segmentation. Long axis, orange. <bold>C</bold>) Using information in <bold>B</bold>, embryo is centered, aligned to the camera axis, and rescaled. <bold>D-F</bold>) An axis perpendicular to the long axis is defined by generating a vector (yellow arrow) pointing between clusters of <italic>unc-130</italic>::GFP expression (<bold>D</bold>), and projecting onto a plane perpendicular to the long axis (<bold>E</bold>). Solid olive-green arrow, perpendicularly projected vector. Dashed arrow, direction of projection. <bold>F</bold>) Raw overlays of <italic>unc-130</italic>::GFP segmentation of a test embryo (gray) and the reference (green), prior to establishing axes perpendicular to the long axis. This step uses a relaxed segmentation threshold. <bold>G</bold>) Overlay of same segmentation as in <bold>F</bold>, after rotation to align the projection vectors found in <bold>E</bold>. <bold>H-I</bold>) Fine correction for rotation transform in <bold>G</bold>. <bold>H</bold>) Segmentation as in <bold>G</bold>, with a tighter segmentation threshold, at a time point twenty minutes earlier. <bold>I</bold>) Point clouds from <bold>H</bold> are matched using CPD-register, to provide fine corrections.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.g003" xlink:type="simple"/>
</fig>
<p>Subsequently, the anterior end of the embryo was identified from the <italic>unc-130</italic>p::NLS::GFP segmentation, using the observation that overall <italic>unc-130</italic>p::NLS::GFP expression is stronger anteriorly (<xref ref-type="fig" rid="pone.0194861.g003">Fig 3B and 3C</xref>). Thus, embryos are positioned with their long (P1) axis on the camera <italic>x</italic>-axis, with anterior to the right.</p>
</sec>
<sec id="sec007">
<title>Adjustments for embryo size variability</title>
<p>While the spatial orientation of the coordinate axes is not affected by embryo size, the scale of these axes is different in embryos of different sizes, and this must be corrected before alignment proceeds. To do so, the moments of inertia vectors of each ball-stage test embryo were compared to those of the reference embryo, and multiplicative scaling factors that brought these into correspondence were determined (<xref ref-type="fig" rid="pone.0194861.g003">Fig 3C</xref>; Methods). These scaling factors were then used to transform each set of test embryo images to match the reference embryo scale. The short-axis moments are similar at this stage, as the embryo is rotationally symmetric, thus only two scale factors, for length and width, were necessary (Methods). We found that required embryo size adjustments are small, with average length and width adjustments of 2.9% (max = 9.3%), and 1.3% (max = 4.8%), respectively. Scaling parameters calculated using a minimum-volume ellipsoid method [<xref ref-type="bibr" rid="pone.0194861.ref002">2</xref>,<xref ref-type="bibr" rid="pone.0194861.ref027">27</xref>] correlated highly with those obtained by the moment-of-inertia scaling procedure (r = .76 for width, r = .91 for length, p&lt;10<sup>−6</sup> by Z test), suggesting that the adjustments likely reflect real differences in embryo sizes. Nonetheless, the absolute changes are small (around 0.5 μm width and 1.5 μm length on average for a 25 x 50 μm embryo).</p>
</sec>
<sec id="sec008">
<title>Defining time-invariant perpendicular coordinate axes</title>
<p>Moments of inertia vectors could not be used to define unambiguous coordinate axes around the P1 long axis, as the early embryo exhibits high rotational symmetry around this axis. However, we noticed that the <italic>unc-130</italic>p::NLS::GFP marker is asymmetrically expressed in a group of posterior nuclei on the ventral side in a period around T20-T30 in the reference embryo and in corresponding periods in the test embryos. For each embryo, we therefore constructed a vector, originating at the average posterior <italic>unc-130</italic>p::NLS::GFP position and terminating at the average anterior <italic>unc-130</italic>p::NLS::GFP position, and computationally projected this vector onto a plane perpendicular to the long axis (<xref ref-type="fig" rid="pone.0194861.g003">Fig 3D and 3E</xref>). This operation defines two coordinate axes, P2 and P3, perpendicular to the long axis, which are approximately consistent between embryos. While individual cell movements occur prior to morphogenesis, bulk embryonic rotations within the eggshell do not appear to take place during this time period. Thus, for each embryo, the coordinate system we established is time invariant at these early stages.</p>
<p>During morphogenesis, however, bulk embryo movements take place, such that the entire embryo rotates around the long axis (<xref ref-type="fig" rid="pone.0194861.g004">Fig 4</xref>; <xref ref-type="supplementary-material" rid="pone.0194861.s006">S1 Movie</xref>). Thus, the P2 and P3 axes are no longer time invariant. Tracking cell movement then becomes more complicated, because cell positions with respect to the fixed coordinate system of the early embryo are now governed by the composition of two transformations: one reflecting movement within a stationary P123 coordinate system, and the other reflecting bulk embryo movement. Because bulk movements vary widely in magnitude and even direction between embryos (average rotational correction of 34.8 +/- 47.5 degrees (mean +/- SD) counterclockwise, see below; <xref ref-type="fig" rid="pone.0194861.g004">Fig 4A–4C</xref>), automated alignments using a fixed coordinate system become impossible.</p>
<fig id="pone.0194861.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0194861.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Correcting internal embryo rotations.</title>
<p>Internal coordinate systems are established for individual embryos by correcting rotations about the AP-axis throughout development, by point-matching segmented nuclei against one another between time points. <bold>A</bold>,<bold>B</bold>) Segmentation of an embryo before (<bold>A</bold>) and after (<bold>B</bold>) an internal rotation (and concurrent neurite outgrowth). <bold>C</bold>) Summed degrees of internal rotations, calculated using the rotation correction method described in the text, in degrees counterclockwise about the embryo long axis. Each point represents a single embryo. Embryos display a preference for counterclockwise rotation (p = 0.001), but magnitude of rotation varies. <bold>D,E</bold>) Example of rotational correction between adjacent time points. <bold>D,E</bold>) Overlay of two <italic>unc-130</italic>::GFP nuclear segmentation channels (light, dark blue) from successive time points, before (<bold>D</bold>), and after (<bold>E</bold>) correction.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.g004" xlink:type="simple"/>
</fig>
<p>We therefore developed a method to computationally cancel embryonic rotations around the long axis, using the <italic>unc-130</italic>p::NLS::GFP fiducial marker. Although this reporter exhibits positional variability in its expression and additional variability in segmentation, we reasoned that neighboring time points of the same embryo likely exhibit only minor differences in expression and segmentation (<xref ref-type="fig" rid="pone.0194861.g004">Fig 4D and 4E</xref>), thus any differences seen would likely be attributable to bulk embryo movement, and could be corrected by back rotations along the long axis. This assumption was born out in subsequent calculations (<xref ref-type="fig" rid="pone.0194861.g004">Fig 4D</xref>).</p>
<p>We extracted 5000 <italic>unc-130</italic>::GFP points (voxels) at random from the segmentation data at a given time point for a given embryo and projected these onto the plane perpendicular to the long axis of the embryo. A similar operation was carried out for the subsequent time point. The resulting point clouds were fed to the point-matching program CPD-register [<xref ref-type="bibr" rid="pone.0194861.ref026">26</xref>–<xref ref-type="bibr" rid="pone.0194861.ref030">30</xref>], which generates rotations and translations to bring point clouds into correspondence (<xref ref-type="fig" rid="pone.0194861.g004">Fig 4D and 4E</xref>; Methods). Across all pairs of neighboring time points, rotations of 1.7 +/- 1.4 degrees (mean +/- SD) are observed. While implementing this procedure, we noticed that <italic>unc-130</italic>p::NLS::GFP nuclei exhibit small concerted linear movements independent of bulk embryo rotations, resulting in alignment artifacts causing the stationary eggshell, and the embryo inside it, to move with respect to the image frame through successive time points. We therefore computationally adjusted the transformations generated by CPD-register by applying a translational correction keeping all image-frame centers at the same position with respect to the camera, thus producing a pure rotation about the long axis in the P2-P3 plane.</p>
<p>With neighboring time points rotationally aligned, all image stacks could now be brought into correspondence and displayed on the same coordinate system as the first stack by summing or subtracting the individual rotations (<xref ref-type="supplementary-material" rid="pone.0194861.s006">S1</xref> and <xref ref-type="supplementary-material" rid="pone.0194861.s007">S2</xref> Movies). The coordinate system in the reference embryo was used as a reference set of axes onto which all other embryos were subsequently mapped (see below).</p>
</sec>
<sec id="sec009">
<title>Mapping test embryos onto the reference embryo coordinate system</title>
<p>Given identically-defined time-invariant coordinate systems for all embryos, alignment of any embryo to the reference requires only alignment of the coordinate axes. Having previously aligned the P1 axes, we calculated the rotation about this axis bringing the P2 axis (and therefore the P3 axis) into correspondence as described above (<xref ref-type="fig" rid="pone.0194861.g003">Fig 3F and 3G</xref>). This simple approach brought embryos substantially into alignment; however, inspection by eye suggested that P2 vector placement exhibited some variability from embryo to embryo. We therefore refined the alignment by matching point clouds from the rotated test and reference embryos at an early time point during the fast imaging period, using the CPD-register program as above (<xref ref-type="fig" rid="pone.0194861.g003">Fig 3H and 3I</xref>). The resulting dataset shows that on average a correction of 12.5 +/- 11.3 degrees produces a best fit.</p>
<p>Importantly, applying CPD-register without the initial coordinate axis alignment often gave very poor alignments, off by &gt;60 degrees of rotation, suggesting that a number of local minimum solutions must exist, and that the correct one is obtained only if the embryos are already nearly aligned.</p>
<p>Since the P123 coordinate systems for each embryo were now aligned and time invariant, embryos were, in principle, registered over their entire time courses. Nonetheless, inspection of the alignments by eye again suggested that additional small improvements were possible, particularly near the onset of embryo twitching. Therefore, as a final correction, alignments at each time point were refined using CPD-register, with the source code altered to allow translations of arbitrary size but only small rotational corrections. The average angular correction introduced by this last step across all time points was 3.9 +/- 1.6 degrees (mean +/- SD), while the translational correction is 2.9 +/- 2.0 μm.</p>
<p>This completed the full alignment procedure. Across our dataset, the algorithm produced excellent alignment by eye to the reference embryo in 30/33 of the test embryos. The three embryos scored as alignment failures demonstrated gross misalignment at early time points of the fast imaging period (~40 degrees of rotational error), resulting in one case from the initial definition of P2, and in the other two cases from the refining alignment at the early time points finding an incorrect minimum (perhaps facilitated by initial inaccuracy in definition of P2). To quantitatively follow the efficacy of our algorithm, we tracked overlap of the three segmented object classes between each test embryo and the reference as the alignment proceeds. As shown in <xref ref-type="fig" rid="pone.0194861.g005">Fig 5</xref>, each step results in a significant improvement in alignment. The maximal overlap of ~70% (and not 100%) is unlikely to reflect the need for better alignment procedures, as inspection of alignments by eye suggests that the fits are good. Rather, differences in segmentation details between embryos, and actual differences in cell locations (see below), probably account for the lack of full overlap. Typical alignments are shown in <xref ref-type="supplementary-material" rid="pone.0194861.s008">S3 Movie</xref> and in <xref ref-type="fig" rid="pone.0194861.g006">Fig 6A and 6B</xref>.</p>
<fig id="pone.0194861.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0194861.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Quantitative measures of alignment accuracy.</title>
<p>Quantitative measure of overlap between test and reference embryos, The proportion given is labeled pixels in the test/reference stack which are within 1 micrometer of a labeled pixel in the reference/test (<bold>A, B</bold>), respectively, averaged across test embryos. Image stacks are compared to reference at the last time point that could be matched prior to twitching. Overlap is calculated for four states: no transformation; long axis (AP) aligned; indirect alignment, all alignment steps except for final 3D refinement; full alignment, 3D refinement added. Error bars are S.E.M., calculated across embryos.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.g005" xlink:type="simple"/>
</fig>
<fig id="pone.0194861.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0194861.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Quantitative measurements of wild-type nerve ring and cell body positions.</title>
<p><bold>A</bold>) Sublateral and ALA cell bodies in the reference embryo. NR, nerve ring. <bold>B</bold>) Overlap of a test embryo with the reference. Cell bodies in test embryos are identified with corresponding cell bodies in reference based on overlap at earlier time points in the fully aligned 4D sequences. <bold>C</bold>) Individual sublateral neuron cell body centers are measured by hand (Methods) at the last time point before twitching, and absolute value of distance from the mean position is reported. <bold>D</bold>) Nerve rings, NR, were traced out with a semi-automatic method in FIJI (Methods) and their centers measured by averaging over the traces, while ALA neuron center positions were measured by hand as with the sublateral neurons. Reported are deviations from the mean. <bold>E</bold>) The angle of the vector through the nerve ring was measured by fitting the nerve ring to a plane with a linear cost function. Deviations from the mean are reported.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.g006" xlink:type="simple"/>
</fig>
<p>The procedure takes approximately an hour to run for a sequence of 71 351x251x288 image stacks on a 2.4 gHz Intel Xeon e5-2620 processor. Faster operation is possible if optimization thresholds are reduced in the CPD software. The software is adaptable to different stack sizes and/or number of stacks. Some of the steps can be optionally turned on/off. For example, the temporal alignment and the last refinement step are not always essential. It is also not always necessary to register each image to the subsequent one, and the number of skipped images can be adjusted. New StarryNite and Ilastik classifiers, however, do need to be generated for different gene reporter sets before running the alignment tool.</p>
</sec>
<sec id="sec010">
<title>Nerve ring, but not sublateral neuron cell body placement is precise</title>
<p>Having generated a dataset of 30 aligned embryos, we sought to determine the fidelity of NR placement in these embryos. We manually traced NRs using the <italic>ceh-17</italic>::GFP SubL neuron reporter in the final aligned time points before twitching using the Trak-EM2 extension to FIJI [<xref ref-type="bibr" rid="pone.0194861.ref031">31</xref>] (Methods). The NR centroid was calculated by averaging over the trace. We found that the aligned NR centers coincide to within 0.8 +/- 0.4 μm (mean +/- SD; <xref ref-type="fig" rid="pone.0194861.g006">Fig 6D</xref>). We also fit each NR trace to a plane using a linear fitting method (Methods), which would not give undue weight to non-planar sections near SubL neuron cell bodies. The measured planar angles agreed to within 6.0 +/- 2.9 degrees (mean +/- SD; <xref ref-type="fig" rid="pone.0194861.g006">Fig 6E</xref>). The ALA neuron is also labeled by the <italic>ceh-17</italic>::GFP reporter, and sits at the dorsal apex of the presumptive NR. Like the NR, the ALA cell body is also precisely positioned to within 1.0 +/- 0.4 μm (mean +/- SD; <xref ref-type="fig" rid="pone.0194861.g006">Fig 6D</xref>). The correspondence of ALA neuron cell bodies and SubL processes among embryos speaks to the precision of our embryo alignment algorithm as well as to the precision of the developmental events that generate these structures.</p>
<p>Surprisingly, unlike the SubL processes and ALA, SubL neuron cell body positions exhibit extensive variability (<xref ref-type="fig" rid="pone.0194861.g006">Fig 6C</xref>; Methods), with individual SubL cell bodies deviating by up to 6.5 um from the mean position of that cell body across all embryos (<xref ref-type="fig" rid="pone.0194861.g006">Fig 6C</xref>). While positional variation could stem from imprecise temporal alignment or natural variation in developmental clocks between embryos, this seems unlikely, given the good correspondence of <italic>unc-130</italic> hypodermal nuclei, ALA neuron, and the nerve rings in all three dimensions. Thus, while NR position with respect to the embryo body plan is highly precise, global positions of SubL cell bodies appear not to be tightly regulated (e.g. <xref ref-type="fig" rid="pone.0194861.g006">Fig 6A and 6B</xref>).</p>
</sec>
<sec id="sec011">
<title><italic>cam-1</italic>/ROR is required for nerve ring position maintenance</title>
<p>Mutations in <italic>cam-1</italic>, encoding the <italic>C</italic>. <italic>elegans</italic> homolog of the ROR Wnt receptor, promote a small but significant anterior displacement of the NR in ~75% of larvae [<xref ref-type="bibr" rid="pone.0194861.ref017">17</xref>]. We wondered whether our alignment algorithm could be used to determine whether this defect results from early mispositioning of SubL pioneer neurons.</p>
<p>To do so, we imaged 39 <italic>cam-1</italic> mutant embryos using the same markers and imaging protocol described for the wild-type dataset above (<xref ref-type="fig" rid="pone.0194861.g007">Fig 7</xref>). Even before alignment, we observed a number of previously-unreported defects. One embryo exhibited highly disorganized SubL processes and cell body placement (<xref ref-type="fig" rid="pone.0194861.g007">Fig 7E and 7F</xref>), another exhibited severing of SubL processes entering the nerve ring (<xref ref-type="fig" rid="pone.0194861.g007">Fig 7A and 7B</xref>), while a third underwent non-specific arrest. None of these three embryos exhibited muscle twitching. 7/39 embryos exhibited a giant NR with a properly positioned posterior aspect, but an anterior apex displaced towards the tip of the nose (<xref ref-type="fig" rid="pone.0194861.g007">Fig 7C and 7D</xref>). In these animals, the ALA neuron also displayed inappropriate anterior placement (<xref ref-type="fig" rid="pone.0194861.g007">Fig 7C and 7D</xref>). To determine whether prolonged imaging might have perturbed the development of these animals, we imaged an additional 39 embryos starting shortly before NR closure with reduced light intensity relative to our other experiments (<xref ref-type="table" rid="pone.0194861.t001">Table 1</xref>). Six of these animals had giant NRs, and one had disorganized SubL processes. We wondered whether the giant NR defect could explain NR anterior displacement in <italic>cam-1</italic> mutant larvae [<xref ref-type="bibr" rid="pone.0194861.ref017">17</xref>]. To this end, 30 of the 39 late-imaged animals were followed to hatching, including all embryos with a giant NR. 5/6 of giant NR animals failed to hatch, while among the phenotypically normal animals, only 2/22 failed to hatch. Thus, the giant NR defect, occurring relatively rarely in embryos and more rarely still among successfully hatched animals, is unlikely to explain the anterior NR displacement observed in most <italic>cam-1</italic> mutant larvae.</p>
<fig id="pone.0194861.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0194861.g007</object-id>
<label>Fig 7</label>
<caption>
<title><italic>cam-1</italic> mutant defects and nerve ring alignments.</title>
<p><italic>cam-1(gm-122)</italic> mutant nerve ring defects (<bold>A,C,E</bold>) compared to wild-type embryos at similar time points, and which are rotated for comparison (<bold>B,D,F</bold>). White arrows, nerve ring. Blue arrows, ALA neuron. Red loops, nerve ring. Red bars, anterior end of embryo. <bold>A,B</bold>) Split nerve ring defect. The <italic>cam-1</italic> mutant animal arrested immediately after the nerve ring broke apart. <bold>C,D</bold>) Giant nerve ring defect. <bold>E,F</bold>) Disorganized nerve ring defect. <bold>G,H</bold>) phenotypically normal <italic>cam-1(gm-122)</italic> animals aligned to wild-type reference embryo and nerve ring deviations calculated as in <xref ref-type="fig" rid="pone.0194861.g006">Fig 6</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.g007" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0194861.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0194861.t001</object-id>
<label>Table 1</label> <caption><title>Hatching rates of <italic>cam-1(gm122)</italic> animals.</title></caption>
<alternatives>
<graphic id="pone.0194861.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Phenotype</th>
<th align="center">No. embryos</th>
<th align="center">No. hatching</th>
<th align="center">% hatching</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Normal NR</td>
<td align="center">24</td>
<td align="center">22</td>
<td align="center">92</td>
</tr>
<tr>
<td align="left">Large NR</td>
<td align="center">6</td>
<td align="center">1</td>
<td align="center">17</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>NR, nerve ring. The low hatching rate and low incidence of animals with a large nerve ring suggests they may not be the animals exhibiting anterior nerve ring defects reported in [<xref ref-type="bibr" rid="pone.0194861.ref011">11</xref>].</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Based on these observations, we proceeded to align 20 embryos that exhibited twitching and that did not contain a giant NR to the wild-type reference embryo (<xref ref-type="supplementary-material" rid="pone.0194861.s003">S3 Fig</xref>). Two of these showed very poor alignment, likely because expression of the <italic>unc-130</italic>p::NLS::GFP reporter appeared altered, and thus, NR positions could not be quantitatively assessed. The remaining 18 animals appeared by eye to align, although in some cases the last step of the alignment protocol had to be omitted, suggestive of increased variability in <italic>unc-130</italic>::GFP nuclei placement at later, but not earlier, stages. Two of the aligned animals exhibited gross asymmetry in left-right outgrowth rates of SubL neuron bundles. Quantitative assessment of NR position and angle with respect to the reference embryo in the remaining 16 embryos revealed no obvious anterior displacement of the NR (<xref ref-type="fig" rid="pone.0194861.g007">Fig 7G and 7H</xref>), although overall positioning seemed to be somewhat more variable in <italic>cam-1</italic> animals than in wild-type animals.</p>
<p>Taken together, these observations suggest that the anterior NR defect observed in <italic>cam-1</italic> mutant larvae is unlikely a result of early NR misplacement, and may reflect a maintenance role for the gene. In this respect, CAM-1/ROR function appears to be similar to that of SAX-3/ROBO, mutations in which also promote maintenance-related anterior NR placement defects [<xref ref-type="bibr" rid="pone.0194861.ref032">32</xref>].</p>
</sec>
</sec>
<sec id="sec012" sec-type="conclusions">
<title>Discussion</title>
<p>The acquisition of quantitative data on the fidelity and reproducibility of developmental processes requires the precise spatiotemporal alignment of a sufficient number of animals to make statistical claims. A number of obstacles, including developmental variability, imaging variability, and data processing variability make alignments non trivial. Here we describe an automated method for aligning 4D <italic>C</italic>. <italic>elegans</italic> embryonic imaging data between the 50–100 cell stage and the onset of muscle twitching. We demonstrate that progressive steps in the alignment procedure result in increasing overlap of signals from fiducial reporters used for alignment. Perhaps more relevant, the precision with which nerve rings are aligned by the algorithm suggests that our approach produces results accurate to within less than a micrometer, although absolute error is likely greater for features closer to the lateral surfaces of the embryo, given the importance of rotations about the long axis of the embryo to the alignment algorithm. Key to efficient alignment is our observation that applying global point-matching algorithms without initially bringing embryos into rough correspondence often fails. This reflects a tension between competing needs: using enough fiducial points to combat variability in their segmentation (due to imaging orientation, signal variability, etc.), and using sufficiently few fiducial markers to limit the number of configurations that provide maximal signal overlap. For this reason, and because of the underlying variability in segmentation, expression, etc., as well as the presence of partial symmetries in expression patterns (resulting in local maxima), an overlap parameter does not adequately capture the success of an alignment. Future refinement of alignment methods may, therefore, focus on the development of more complex parameters, accounting not only for raw signal overlap, but also taking into account subtler features of the aligned images. Improvements to our work may also involve extending alignments beyond twitching onset. This problem is computationally challenging as the animal changes its configuration in non-rigid ways, requiring more frequent imaging and the development of non-rigid alignment schemes. Recent semi-automated segmentation approaches may offer an excellent starting point [<xref ref-type="bibr" rid="pone.0194861.ref015">15</xref>].</p>
<p>Our alignment procedure allowed us to consider a number of questions related to the fidelity of <italic>C</italic>. <italic>elegans</italic> embryonic development. We demonstrated that positioning of the NR brain neuropil in the embryo is accurate to within about a micrometer. This result is all the more impressive as some of the variance we observe must be due to errors stemming from limited optical resolution, imprecision in the alignments, and measurements of neurite positioning. It is therefore likely that NR placement is accomplished with an accuracy of much less than a micrometer. Conversely, we showed that SubL neuron cell body placement can vary up to six micrometers between individuals. As the head is ~25 micrometers in diameter, this reflects ~25% relative variability. This result strongly contrasts with the prevailing notion that the fixed lineage of <italic>C</italic>. <italic>elegans</italic> should lead to fixed cell placement [<xref ref-type="bibr" rid="pone.0194861.ref002">2</xref>,<xref ref-type="bibr" rid="pone.0194861.ref033">33</xref>]. It also suggests that strong selective pressures on NR placement exist. Consistent with this idea, our alignments reveal that the onset of muscle twitching in the embryo is temporally precise, and occurs within a defined developmental interval of &lt;7 minutes. This represents a variation of ~6% as embryos are synchronized using our temporal alignment protocol through an interval 116 minutes, on average, before twitching. Twitching is correlated with dorsal arrival and overlap of left-right SubL neuron axon bundles, suggesting that precision in SubL neuron axon placement may promote temporal precision in muscle activation.</p>
<p>Our results raise the possibility that the ALA neuron may play a role in defining the dorsal meeting point of the left and right SubL bundles. ALA is located on the dorsal midline and appears to be within the optical resolution limit (~1 micron) of SubL processes, roughly at the point at which the two arms of the nerve ring cross. Unlike SubL neuron cell bodies, the ALA cell body exhibits &lt;1 micron variability in placement between embryos. Furthermore, in <italic>cam-1</italic> mutant animals exhibiting giant NRs, ALA is displaced anteriorly, but is located at the same relative position with respect to the NR. Thus, ALA could define a guidepost towards which NR pioneers grow.</p>
<p>Finally, although the method we present here relies on the specific distribution of <italic>unc-130</italic>p::NLS::GFP expression, used to generate fiducial points for alignments, other reporters expressed in a similar number of different cells could be used as well. In this case, the specifics of the initial rough orientation of the embryo would be different, but subsequent refined alignments would still follow the same algorithms presented here. Importantly, however, some asymmetry in reporter expression would be important to allow precise definition of axes perpendicular to the long embryonic axis. The <italic>ceh-17</italic>::GFP reporter is not used in alignment, and a reporter expressed in any other system of the embryo could be used in its place. Thus, with relatively small manipulations, the method we present here can be applied to other reporter combinations in <italic>C</italic>. <italic>elegans</italic>, perhaps permitting mapping of a variety of tissues in the animal prior to twitching.</p>
<p>Extension of our alignment scheme to other model systems would require identification of pan-nuclear markers and an asymmetric fiduciary reporter. As is the case for post-twitching <italic>C</italic>. <italic>elegans</italic>, our method is likely not suited for registering image stack series for which local transformations, and not a global affine transformation, represent the geometry.</p>
</sec>
<sec id="sec013" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec014">
<title>Strains</title>
<p><italic>C</italic>. <italic>elegans</italic> strains were maintained at 20°C under standard conditions [<xref ref-type="bibr" rid="pone.0194861.ref034">34</xref>]. The OS10584 strain, which is the wild-type strain, contains three transgenes: <italic>stIs10116</italic> (<italic>his-</italic>72 promoter::<italic>his-24</italic>::mCherry::<italic>let-858</italic> 3'UTR + <italic>unc-119</italic>(+)); <italic>wgIs76</italic> (<italic>unc-130</italic> promoter::TY1::eGFP::3xFLAG(P000007_E01)); and <italic>npIs1</italic> (<italic>ceh-17</italic> promoter::GFP, pRF4). It was generated by crossing the RW11144 strain (obtained from the <italic>Caenorhabditis</italic> Genetics Consortium) into the IB8 strain [<xref ref-type="bibr" rid="pone.0194861.ref035">35</xref>]. The OS10585 strain was generated by crossing the OS10584 strain into the NG2615 strain containing the <italic>cam-1(gm122)</italic> mutation [<xref ref-type="bibr" rid="pone.0194861.ref016">16</xref>]. The <italic>his-72</italic> promoter labels most cells of the embryo, with weak to no expression in the germ line, depending on stage, and weak expression in intestine [<xref ref-type="bibr" rid="pone.0194861.ref036">36</xref>].</p>
</sec>
<sec id="sec015">
<title>Microscope design</title>
<p>All images were taken on a custom-built single plane illumination microscope based on the design of Wu et al. [<xref ref-type="bibr" rid="pone.0194861.ref015">15</xref>]. Briefly, light is collected from a 488nm laser and a 588nm laser and combined using a beamsplitter (Thorlabs). Color switching is accomplished using an acoustic optical tunable filter (AOTF) from AA-Optoelectronics to turn excitation channels on and off, with both green and red light ultimately collected through a Chroma dual color filter (59022m). Lasers are scanned in two orthogonal directions using 2 1D galvanometers (Thorlabs) optically conjugate to the sample to generate the light sheet and volume. Lasers are focused onto the sample through a 40x 0.8 NA Nikon water-dipping objective, and emission light is collected from an identical 40x objective. A third objective (10x 0.3 NA, Olympus) is used for sample finding. The microscope body, which holds the objectives in position and provides control over the piezo and the sample position, is provided by ASI. The emission objective tracks the light sheet using a piezo-electric element purchased from ASI. All images were taken using a Hamamatsu Orca Flash 4.0 v.2 sCMOS camera. Control software was custom written by us in Labview. Electronic elements were synchronized using a mix of software synchronization provided by Labview and TTL voltage synchronization through a pair of NI PCIe 6363 DAQ cards. The microscope design and optical path is shown in <xref ref-type="supplementary-material" rid="pone.0194861.s004">S4</xref> and <xref ref-type="supplementary-material" rid="pone.0194861.s005">S5</xref> Figs.</p>
</sec>
<sec id="sec016">
<title>Microscope operation</title>
<p>All image stacks were acquired with both green and red channels, using a 488 nm and a 588 nm laser respectively for excitation. Laser power was measured just in front of the 500 mm lens. 488 nm laser power was measured at 165 +/- 5 μW, and the 588 nm laser at 120 +/- 3 μW, except for the late imaging experiments in <italic>cam-1</italic> (see below). The laser was scanned back and forth once for each imaging slice to prevent directional effects which were otherwise observed in the imaging. A 20 ms delay was provided between every slice to give time for the piezo to settle at its final position, 10 ms was provided for the actual imaging, a ~3 ms delay was used giving the rolling shutter on the CMOS camera time to complete its readout, and 2 ms additional used for software synchronization, resulting in 35 ms total per slice. All stacks consisted of 100 slices, and both red and green channels were acquired for all stacks, so each stack took 7 seconds in total. Stacks were subsequently truncated to 93 slices to remove occasional bad slices at the top and bottom of the volume and to overlay the red and green channels, which were slightly offset in Z. Up to 6 embryos could be imaged at once given the timing considerations outlined above. Embryos were kept well separated to prevent the excitation light targeting one embryo from affecting another.</p>
<p>For most visualization, registration, and position calculations, stacks were linearly interpolated in Z to produce uniform voxels. Stacks were also trimmed in <italic>x</italic> and <italic>y</italic> to more closely match the size of the embryos. The final stacks were 351 x 251 x 287 voxels, with voxel size being 162.5 nm x 162.5 nm x 162.5 nm, for an overall frame size of 57.0 μm x 40.8 μm x 46.7 μm.</p>
<p>For the late <italic>cam-1</italic> imaging experiment, a lower power of ~120 μW in 488 nm and 100 uW in 588 nm were used–the mCherry channel was also acquired in addition to GFP for a possible use in alignment and visualization (although not used). These lower imaging powers and late onset of imaging eased concerns that photodamage might contribute to the large NR defect previously observed, or prevent animals from hatching.</p>
</sec>
</sec>
<sec id="sec017">
<title>Sample preparation</title>
<p>24 mm x 50 mm coverslips (Fisher) were spotted in the center with 30 μl of .01% poly-l-lysine solution (Sigma), let sit until dry, then stored at least a day before use to provide time for the polylysine to firmly adhere to the coverslips. Only coverslips for which the dry polylysine pattern overlapped the exact middle were used, as the imageable space on the coverslip given the constraints of the SPIM system is only the central ~6 mm x ~3 mm.</p>
<p>Embryos were collected for imaging by cutting gravid hermaphrodites in their first 36 hours of laying, in ddH2O. Embryos were mounted in ddH2O on the polylysine coated glass using a mouth-pipette apparatus (Fisher) and a drawn 1 mm capillary with the end broken off. Embryos were blown out of the capillary into an acceptable (central) <italic>x-y</italic> position before beginning. As embryos fell, they were gently rotated into approximately the optimal orientation, flat on the coverslip and perpendicular to the excitation axis, by blowing fluid on them or sucking fluid into the capillary as they fell. When embryos reached the coverslip they rapidly adhered and could no longer be manipulated. The desired orientation, perpendicular to the beam, minimizes expansion of the laser across the width of the embryo, thus leading to slight improvements in sectioning and light efficiency. However, as the placement procedure is difficult to implement and many embryos could not be brought into exactly the correct orientation, embryos were accepted for imaging that fell within 45 degrees of the correct angle (i.e., two octants' worth, or 1/4 of embryos if they had fallen in random orientations). Once the embryos were stuck, the coverslips were washed 3–5 times in water to remove all loose polylysine, in order to protect the water-dipping SPIM objectives.</p>
<p>After all embryos were mounted, the time was noted and embryos were chosen for imaging that were between the 1 and 6 cell stages (which staged them to within about an hour). The embryos were subsequently let sit for 2 hours at 20°C before start of imaging. All imaging was carried out in a 20°C temperature controlled room.</p>
<p>After waiting two hours, we imaged the embryos every 10 minutes for 20 stacks (T1-T20), followed by faster imaging every 2 minutes for 125 stacks (T21-T145) which covered the period leading from before NR development through twitching. The resulting embryos were positioned at an arbitrary dorsal-ventral and left-right position about their long axis since they are uncompressed and so fall into arbitrary rotational orientations (unlike [<xref ref-type="bibr" rid="pone.0194861.ref002">2</xref>]).</p>
<p>For the reference, we chose an embryo initially positioned with its long axis very nearly perpendicular to the detection objective axis, with an initial rotational positioning about its long axis such that NR outgrowth was easily visible. This embryo had been observed to hatch at a later time point, so that it was known to be healthy (this data was only available for some of our embryos).</p>
<p>In the case of OS10584, 46 embryos were initially collected over 7 days worth of imaging. Subsequently, 2 days worth (12 embryos) were discarded, since they featured substantial contamination on the coverslips, which caused incorrect mCherry channel segmentation (see below) on several of the embryos. 33 embryos were set up for alignment (not including the reference, which made 34). Of these, 30 embryos looked acceptably aligned by eye while 3 exhibited obvious misalignments (~40 degree rotations) stemming from misrotations at the early time point.</p>
<p>For the OS10585 imaging, conducted in the style of OS10584, 39 animals were set up for imaging. We attempted alignments on the apparently normal animals, of which many were discarded before conducting alignments for various reasons, including absence of twitching (precluding temporally matching the embryos at their twitching times), bacterial contamination of the coverslips resulting in failure of mCherry channel (StarryNite) segmentation, or movement of the stage during imaging (over one day, five embryos). For the late-imaged <italic>cam-1</italic> animals, an additional 39 animals were imaged starting before the closure of the NR, giving at least 20 hours from fertilization for hatching to occur (compared with the 14 hours typical in wild type).</p>
<sec id="sec018">
<title>Image analysis</title>
<p>Red channel nuclear segmentation was done using the StarryNite program [<xref ref-type="bibr" rid="pone.0194861.ref023">23</xref>]. We made very slight modifications to the program for our use, affecting only superficial aspects of the program's data handling and interface. StarryNite parameters for wild-type (OS10584) experiments were determined manually by trial and error, working on an RW11144 dataset with imaging conditions identical to those described for OS10584. The parameters were adjusted for the <italic>cam-1</italic> embryos, OS10585, to improve segmentation efficiency. As <italic>cam-1</italic> temporal alignments often yielded bad results (with our program finding a degenerate solution in some cases, and large offsets at the last time point in others), <italic>cam-1</italic> animals were not aligned temporally using the StarryNite data, but rather aligned using the last time point before twitching as a guide.</p>
<p>A multiple of the red channel signal intensity (determined at 1/15 for these imaging conditions) was subtracted from the green channel before analysis, to eliminate bleedthrough of the red channel, which was otherwise substantial.</p>
<p>Green channel segmentation of cell bodies, neurites, and nuclei used Ilastik [<xref ref-type="bibr" rid="pone.0194861.ref024">24</xref>], a random forest [<xref ref-type="bibr" rid="pone.0194861.ref037">37</xref>] machine learning method that segments images based on a combination of classifiers such as raw intensity, Difference of Gaussians, and Laplacian of Gaussian. Segmentation of <italic>unc-130</italic>p::NLS::GFP nuclei for determining the anterior end of the embryo, for estimating the initial DV-LR angle, and for correcting the initial estimate of DV-LR angle were done simply by thresholding the (0 1) probabilities output by Ilastik to produce a binary matrix. The threshold criterion was relaxed slightly for segmentation procedures in which more than the usual number of nuclei were desired (i.e., early time point DV-LR angle estimation, determination of the anterior end of the embryo, and determination of nuclei in the target embryo for the refinement step of the algorithm). For 2D rotational corrections within a given embryo and 3D alignments between embryos, <italic>unc-130</italic>p::NLS::GFP segmentation was improved by coring out the area around the NR using a cylinder of defined size, blurring with a Gaussian filter, and restricting the segmentation results to the largest visible objects (maximum of 17 objects).</p>
<p>Temporal alignment of embryos was carried out by minimizing square error over possible offsets of a test embryo relative to the first 20 time points of the reference, normalized by the number of overlapping time points in the solution–i.e., if a test embryo is offset by 5 time points, 15 time points continue to overlap with the first 20 in the reference. Without this normalization, offsetting a test embryo by the maximum number of time points usually minimizes the square error. Nuclear number time courses were interpolated by a factor of 5 prior to alignment as described in the main text. For finding plateaus, all time points were collected for which the number of segmented nuclei was between 120 and 350, then divided into two sets for the two plateaus, 120 to 220 and 220 to 350. A subset of these time points was then defined for which the absolute value of percentage change of (interpolated) cell number from the previous time point was less than or equal to a defined threshold (initially, 0%). The 0% threshold was increased by small increments until a connected component of more than fifteen time points was found, which was selected as a plateau; the two plateaus found in this way for the two groups correspond to the 200 cell stage and the ball stage of embryogenesis. The time associated with each plateau was defined as the mean of the time points in the connected component. Correlation analysis was then conducted with twitching time as described in the text.</p>
<p>Embryo scaling factors were treated symmetrically between the short axes of the embryo, because the second and third moments are similar in magnitude and the associated axes vary in time. The average ratio between short axis moments over the period considered was 1.04 +/- .03 (mean +/- SD), and it was highly correlated across embryos (r = 0.96). In addition, the direction associated with these moments varied over repeated calculations for each embryo by an average of 8.9 +/- 7.7 degrees (mean +/- SD) across time points in all embryos. For comparison, using the same calculation, random reorientation at each step would give 45 degrees deviation). By contrast, the long-axis moments deviate from the other two more substantially, by a factor of 2.05 +/- .10 (mean +/- SD) across embryos, are less well correlated with the other two (r = 0.81), and their angles deviate much less over repeated measurements (1.2 +/- 2.0 degrees deviation per embryo; mean +/- SD across embryos). Given the limited and variable separation of the short axis moments from one another, we ultimately calculated only two scale factors for length and width, averaging the results for width over the short axes.</p>
<p>Embryo scaling factors were calculated as follows. For a given embryo, let <italic>a</italic> be the moment about the long axis, and <italic>b</italic><bold>,</bold> the average moment about the short axes, with the subscripts “<italic>ref</italic>” and “<italic>test</italic>” referring to the reference and individual test embryos, respectively. Let:
<disp-formula id="pone.0194861.e001">
<alternatives>
<graphic id="pone.0194861.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0194861.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="2em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="2em"/><mml:msub><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Then the ratios that must be applied to a test embryo to bring long and short axes into correspondence with the reference, <italic>r</italic><sub><italic>l</italic></sub> and <italic>r</italic><sub><italic>s</italic></sub> respectively, are given by:
<disp-formula id="pone.0194861.e002">
<alternatives>
<graphic id="pone.0194861.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0194861.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>5</mml:mn></mml:mfrac></mml:mrow></mml:msubsup><mml:mo>*</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mn>5</mml:mn></mml:mfrac></mml:mrow></mml:msubsup><mml:mspace width="2em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="2em"/><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msubsup><mml:mo>*</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>These relations can be easily verified by considering the moment of inertia integrals as integrals of a density over space, and considering the change in this density as a result of (uniform) local scaling. The reason for the somewhat exotic exponents appearing in the formula is that the moments of inertia scale as the 5<sup>th</sup> power of distance (3 stemming from the mass density, 2 from the distance weighting).</p>
<p>Point cloud matching was carried out using the "cpd_rigid" alignment method of the Coherent Point Drift (CPD) registration program. CPD register is a Gaussian Mixture Model method using a deterministic annealing procedure to shrink the size of the Gaussians over time. We chose it from among other possibilities since it has a Matlab interface, which matched well with our programming environment, and because it seemed to give better results than tests with the older Iterative Closest Point Method. In addition, the theoretical underpinnings of the method seem to be stronger than some others, with exact instead of approximate solutions to the underlying mathematical model. For 3D alignments between embryos (the refinement step of the algorithm), CPD register was altered to bias against rotations by directly reducing the size of calculated rotations until a certain Gaussian search width had been reached, at which point full rotations were gradually reintroduced. The effect of this approach is to permit only rotations that match nuclei to nearby nuclei.</p>
<p>SubL and ALA cell body center positions were calculated manually in FIJI [<xref ref-type="bibr" rid="pone.0194861.ref031">31</xref>] with center positions in <italic>x</italic> and <italic>y</italic> estimated by eye from maximum projections and <italic>z</italic> positions found by scrolling through stacks at the central <italic>x-y</italic> position until the slice with maximum brightness at that position was found. When the max projection <italic>x-y</italic> center was seen to be substantially off-center at the maximum brightness slice, the <italic>x-y</italic> center was recalculated based on apparent center positions at that slice (resulting in corrections typically of up to a few hundred nanometers). Identification of cell bodies in test embryos with cells in the reference is reliable and based on previous colocalization at earlier stages of embryogenesis (using the full aligned movies). Subsequent identification with particular sublateral cell bodies and the ALA is accomplished by comparing the descriptions of the <italic>ceh-17</italic> marker provided in [<xref ref-type="bibr" rid="pone.0194861.ref035">35</xref>] with the diagrams in [<xref ref-type="bibr" rid="pone.0194861.ref001">1</xref>]. The actual nomenclature is tentative and may be incomplete, as SIADL and SIADR sometimes appear to have another immediately neighboring fluorescent cell. This may be an artifact of the imaging or image transformations, or a visual misunderstanding of the underlying shapes of these two neurons. For SIADL and SIADR the apparent center position of the cluster was taken, with no obvious effect on the variability of the positioning.</p>
<p>Neurites were traced using the TrakEM2 add-on to Fiji, using the semi-automatic tracing method ("pencil") with short (~5–10 pixel) steps between automatic tracing runs. When the automatic tracing method appeared to deduce an incorrect trace, the step size was shortened until the neurite was correctly traced. Short stretches were occasionally manually added ("pen") when the pencil could not find the right route. The main benefit of using the semi-automatic functionality here was that it seemed much more accurate in tracing neurite movement between image slices in Z than could easily be done by hand. Tracing was done on the 93 slice stacks before interpolation to 287 slices, since determining the center slices of neurites was found to be somewhat easier here than using the interpolated version, and the TrakEM2 program ran better with smaller image stacks. Traces are exported as XML files, read in Matlab, and converted to arrays and matrices for further modification and analysis. NRs were fit to a plane by setting an approximate center line (based on observation of the reference embryo and assuming good alignment of other NRs to reference), dividing the nerve ring into top and bottom arms based on position relative to this center line, identifying vectors between points on the top and bottom arms of the ring and decomposing into two sets; a side-to-side vector, which is the component-by-component average of the vectors between points in the bottom and top arms of the plane; a forward vector, which is the average of resulting vectors after subtraction of components in the direction of the side-to-side vector; and an “out” vector, which is the perpendicular to the forward and side-to-side vectors, normalized in all cases to lie in the same half-sphere. This “out” vector defines the plane and is used in the calculation of angles between NRs described in the main text. This method was used instead of a least squares fit because square error seemed to overfit to non-planar segments of the ring near the sublateral neuron cell bodies.</p>
<p>Except for some of the external programs described above which were incorporated in our overall image registration pipeline, all image processing was done using custom-built code written in Matlab, and is available upon request.</p>
</sec>
</sec>
<sec id="sec019">
<title>Supporting information</title>
<supplementary-material id="pone.0194861.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Overview of spatial alignment process.</title>
<p>Green text, outcome of preceding steps.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0194861.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Quantifying segmentation procedure accuracy.</title>
<p><bold>A</bold>) Additional measures of segmentation for cell bodies and neurites are compared to Ilastik segmentation using the “pixels within 1 micrometer” method described in the text. The neurite segmentation channel for the last time point is compared to manual traces. The cell body segmentation is compared to a simple filter that extracts all pixels above 500 counts. Proportion of labeled pixels in test image within 1 micrometer of a labeled pixel in reference, and vice versa, are shown. <bold>B</bold>) The false positive rate in nuclear segmentation was calculated by hand using 90 time points from random embryos, distributed throughout embryogenesis. 13 false positives were recorded out of 1213 nuclei counted by the full nuclear segmentation procedure. <bold>C</bold>) Nuclear counts per time point across all time points, recorded using the full segmentation procedure. The minimum count across all time points is 6 nuclei, while the maximum recorded (which is the maximum permitted by the software) is 17. Except in highly symmetrical cases, only 3 nuclei are required to match two 3D objects.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0194861.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Alignments of phenotypically normal <italic>cam-1</italic> animals to wild type.</title>
<p>Alignment procedure as described in the text, with slight modifications because of poor segmentation of nuclei in red and green channels. An embryo aligned to reference at the second to last time point (<bold>A-C</bold>), and at the last time point (<bold>D-F</bold>).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0194861.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>SPIM optical table light path.</title>
<p>Diagram of external light path for the custom-built SPIM microscope used in the experiments described in the text. Briefly, 488 nm and a 588 nm laser light are combined with a long-pass beamsplitter, and directed to an acoustic optical tunable filter (AOTF) used for beam shuttering. The beam encounters a pair of galvanometers used to scan the beam and generate the light sheet and volume. Mirrors and relay lenses are used to reimage the galvanometers onto the back focal plane of the excitation objective, converting the angular shifting of the laser beams at the galvos into linear movement at the sample. <bold>A</bold>) Front view of microscope. <bold>B</bold>) The light path is traced on the optical table, with the periscope and back port of the microscope broken out for a clearer view (<bold>C</bold>). <bold>D</bold>) Diagram of the light path through the optical elements on the table. Mirror 1 is conjugate to the sample plane and can be used to adjust angles at the sample. Mirrors 2 were used in setting the optical distance to the periscope. <bold>E</bold>) Legend for <bold>B</bold>, <bold>C</bold>, <bold>D</bold>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0194861.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Microscope body light path.</title>
<p>A diagram of the light path in the microscope body. Excitation light (purple) flows down through the excitation objective (“Ex”) to the sample, producing fluorescence (magenta), which is collected by the emission objective (“Em”) and conveyed to a Hamamatsu SCMOS camera. A second lens system and camera on the bottom axis, imaging at low NA, provides the capacity to locate samples for imaging. <bold>A</bold>) Front view of microscope. <bold>B</bold>) Overlay of light path on microscope body. <bold>C</bold>) Diagram of light path and optical components. <bold>D</bold>) Legend for <bold>B</bold>, <bold>C</bold>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0194861.s006" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.s006" xlink:type="simple">
<label>S1 Movie</label>
<caption>
<title>Development of the reference embryo.</title>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0194861.s007" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.s007" xlink:type="simple">
<label>S2 Movie</label>
<caption>
<title>Reference embryo with rotations corrected.</title>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0194861.s008" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pone.0194861.s008" xlink:type="simple">
<label>S3 Movie</label>
<caption>
<title>Test embryo aligned with reference embryo.</title>
<p>(AVI)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Hari Shroff and Zachary Frentz for their assistance with the development of the SPIM system, Georgia Rapti, and Anupriya Singhal for reagents and additional assistance during this project, and members of the Shaham lab for discussions and comments on the manuscript. This work was supported by NIH grants NS064273, NS095795, NS081490, HD078703 to S.S. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0194861.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sulston</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Schierenberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JN</given-names></name>. <article-title>The embryonic cell lineage of the nematode Caenorhabditis elegans</article-title>. <source>Dev Biol</source>. <year>1983</year> <month>Nov</month>;<volume>100</volume>(<issue>1</issue>):<fpage>64</fpage>–<lpage>119</lpage>. <object-id pub-id-type="pmid">6684600</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Richards</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Zacharias</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Walton</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Burdick</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>JI</given-names></name>. <article-title>A quantitative model of normal Caenorhabditis elegans embryogenesis and its disruption after stress</article-title>. <source>Dev Biol</source>. <year>2013</year> <month>Feb</month> <day>1</day>;<volume>374</volume>(<issue>1</issue>):<fpage>12</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ydbio.2012.11.034" xlink:type="simple">10.1016/j.ydbio.2012.11.034</ext-link></comment> <object-id pub-id-type="pmid">23220655</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Christensen</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Bokinsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Santella</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Marquina-Solis</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Untwisting the Caenorhabditis elegans embryo</article-title>. <source>Elife</source>. <year>2015</year>;<fpage>4</fpage>.</mixed-citation></ref>
<ref id="pone.0194861.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Giurumescu</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Planchon</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Betzig</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bloomekatz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yelon</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Quantitative semi-automated analysis of morphogenesis with single-cell resolution in complex embryos</article-title>. <source>Development</source>. <year>2012</year> <month>Nov</month>;<volume>139</volume>(<issue>22</issue>):<fpage>4271</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/dev.086256" xlink:type="simple">10.1242/dev.086256</ext-link></comment> <object-id pub-id-type="pmid">23052905</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Horn</surname> <given-names>BKP</given-names></name>. <article-title>Closed-form solution of absolute orientation using unit quaternions</article-title>. <source>J Opt Soc Am A, JOSAA</source>. <year>1987</year> <month>Apr</month> <day>1</day>;<volume>4</volume>(<issue>4</issue>):<fpage>629</fpage>–<lpage>42</lpage>.</mixed-citation></ref>
<ref id="pone.0194861.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kremser</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Plangger</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bösecke</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pallua</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Aichner</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Felber</surname> <given-names>SR</given-names></name>. <article-title>Image registration of MR and CT images using a frameless fiducial marker system</article-title>. <source>Magn Reson Imaging</source>. <year>1997</year>;<volume>15</volume>(<issue>5</issue>):<fpage>579</fpage>–<lpage>85</lpage>. <object-id pub-id-type="pmid">9254002</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peng</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Chung</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Long</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Qu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Jenett</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Seeds</surname> <given-names>AM</given-names></name>, <etal>et al</etal>. <article-title>BrainAligner: 3D registration atlases of Drosophila brains</article-title>. <source>Nat Meth</source>. <year>2011</year> <month>Jun</month>;<volume>8</volume>(<issue>6</issue>):<fpage>493</fpage>–<lpage>8</lpage>.</mixed-citation></ref>
<ref id="pone.0194861.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>Y-L</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>S-J</given-names></name>, <name name-style="western"><surname>Zhai</surname> <given-names>X-Y</given-names></name>, <name name-style="western"><surname>Thomsen</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Christensen</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Andreasen</surname> <given-names>A</given-names></name>. <article-title>Non-rigid landmark-based large-scale image registration in 3-D reconstruction of mouse and rat kidney nephrons</article-title>. <source>Micron</source>. <year>2015</year> <month>Jan</month> <day>1</day>;<volume>68</volume>:<fpage>122</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.micron.2014.10.002" xlink:type="simple">10.1016/j.micron.2014.10.002</ext-link></comment> <object-id pub-id-type="pmid">25464150</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peng</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Long</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>EW</given-names></name>. <article-title>Straightening Caenorhabditis elegans images</article-title>. <source>Bioinformatics</source>. <year>2008</year> <month>Jan</month> <day>15</day>;<volume>24</volume>(<issue>2</issue>):<fpage>234</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btm569" xlink:type="simple">10.1093/bioinformatics/btm569</ext-link></comment> <object-id pub-id-type="pmid">18025002</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Strnad</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gunther</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Reichmann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Krzic</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Balazs</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>de Medeiros</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Inverted light-sheet microscope for imaging mouse pre-implantation development</article-title>. <source>Nature Methods</source>. <year>2016</year> <month>Feb</month>;<volume>13</volume>(<issue>2</issue>):<fpage>139</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3690" xlink:type="simple">10.1038/nmeth.3690</ext-link></comment> <object-id pub-id-type="pmid">26657559</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Southgate</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Brenner</surname> <given-names>S</given-names></name>. <article-title>The Structure of the Nervous System of the Nematode Caenorhabditis elegans</article-title>. <source>Philosophical Transactions of the Royal Society of London B: Biological Sciences</source>. <year>1986</year> <month>Nov</month> <day>12</day>;<volume>314</volume>(<issue>1165</issue>):<fpage>1</fpage>–<lpage>340</lpage>. <object-id pub-id-type="pmid">22462104</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zallen</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Kirch</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Bargmann</surname> <given-names>CI</given-names></name>. <article-title>Genes required for axon pathfinding and extension in the C. elegans nerve ring</article-title>. <source>Development</source>. <year>1999</year> <month>Aug</month>;<volume>126</volume>(<issue>16</issue>):<fpage>3679</fpage>–<lpage>92</lpage>. <object-id pub-id-type="pmid">10409513</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rapti</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Shan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shaham</surname> <given-names>S</given-names></name>. <article-title>Glia initiate brain assembly through noncanonical Chimaerin-Furin axon guidance in C. elegans</article-title>. <source>Nat Neurosci</source>. <year>2017</year> <month>Oct</month>;<volume>20</volume>(<issue>10</issue>):<fpage>1350</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4630" xlink:type="simple">10.1038/nn.4630</ext-link></comment> <object-id pub-id-type="pmid">28846083</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huisken</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Swoger</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bene</surname> <given-names>FD</given-names></name>, <name name-style="western"><surname>Wittbrodt</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stelzer</surname> <given-names>EHK</given-names></name>. <article-title>Optical Sectioning Deep Inside Live Embryos by Selective Plane Illumination Microscopy</article-title>. <source>Science</source>. <year>2004</year> <month>Aug</month> <day>13</day>;<volume>305</volume>(<issue>5686</issue>):<fpage>1007</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1100035" xlink:type="simple">10.1126/science.1100035</ext-link></comment> <object-id pub-id-type="pmid">15310904</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ghitani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Christensen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Santella</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Du</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Rondeau</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Inverted selective plane illumination microscopy (iSPIM) enables coupled cell identity lineaging and neurodevelopmental imaging in Caenorhabditis elegans</article-title>. <source>PNAS</source>. <year>2011</year> <month>Oct</month> <day>25</day>;<volume>108</volume>(<issue>43</issue>):<fpage>17708</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1108494108" xlink:type="simple">10.1073/pnas.1108494108</ext-link></comment> <object-id pub-id-type="pmid">22006307</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Forrester</surname> <given-names>WC</given-names></name>, <name name-style="western"><surname>Dell</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Perens</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Garriga</surname> <given-names>G</given-names></name>. <article-title>A C. elegans Ror receptor tyrosine kinase regulates cell motility and asymmetric cell division</article-title>. <source>Nature</source>. <year>1999</year> <month>Aug</month> <day>26</day>;<volume>400</volume>(<issue>6747</issue>):<fpage>881</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/23722" xlink:type="simple">10.1038/23722</ext-link></comment> <object-id pub-id-type="pmid">10476968</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kennerdell</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Fetter</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Bargmann</surname> <given-names>CI</given-names></name>. <article-title>Wnt-Ror signaling to SIA and SIB neurons directs anterior axon guidance and nerve ring placement in C. elegans</article-title>. <source>Development</source>. <year>2009</year> <month>Nov</month>;<volume>136</volume>(<issue>22</issue>):<fpage>3801</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/dev.038109" xlink:type="simple">10.1242/dev.038109</ext-link></comment> <object-id pub-id-type="pmid">19855022</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Murray</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Boyle</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Preston</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Vafeados</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mericle</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Weisdepp</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Multidimensional regulation of gene expression in the C. elegans embryo</article-title>. <source>Genome Res</source>. <year>2012</year> <month>Jul</month>;<volume>22</volume>(<issue>7</issue>):<fpage>1282</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.131920.111" xlink:type="simple">10.1101/gr.131920.111</ext-link></comment> <object-id pub-id-type="pmid">22508763</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zacharias</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Walton</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Preston</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>JI</given-names></name>. <article-title>Quantitative Differences in Nuclear β-catenin and TCF Pattern Embryonic Cells in C. elegans</article-title>. <source>PLOS Genetics</source>. <year>2015</year> <month>Oct</month> <day>21</day>;<volume>11</volume>(<issue>10</issue>):<fpage>e1005585</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1005585" xlink:type="simple">10.1371/journal.pgen.1005585</ext-link></comment> <object-id pub-id-type="pmid">26488501</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nath</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Schwarz</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Sternberg</surname> <given-names>PW</given-names></name>. <article-title>C. elegans Stress-Induced Sleep Emerges from the Collective Action of Multiple Neuropeptides</article-title>. <source>Current Biology</source> [Internet]. <year>2016</year> <month>Aug</month> <day>18</day> [cited 2016 Aug 22];0(0). Available from: /current-biology/abstract/S0960-9822(16)30841-7</mixed-citation></ref>
<ref id="pone.0194861.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sanders</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nagy</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fetterman</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Treinin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Biron</surname> <given-names>D</given-names></name>. <article-title>The Caenorhabditis elegans interneuron ALA is (also) a high-threshold mechanosensor</article-title>. <source>BMC Neuroscience</source>. <year>2013</year>;<volume>14</volume>:<fpage>156</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2202-14-156" xlink:type="simple">10.1186/1471-2202-14-156</ext-link></comment> <object-id pub-id-type="pmid">24341457</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Van Buskirk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sternberg</surname> <given-names>PW</given-names></name>. <article-title>Epidermal growth factor signaling induces behavioral quiescence in Caenorhabditis elegans</article-title>. <source>Nat Neurosci</source>. <year>2007</year> <month>Oct</month>;<volume>10</volume>(<issue>10</issue>):<fpage>1300</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1981" xlink:type="simple">10.1038/nn1981</ext-link></comment> <object-id pub-id-type="pmid">17891142</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Boyle</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ooi</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Sandel</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Waterston</surname> <given-names>RH</given-names></name>. <article-title>Automated cell lineage tracing in Caenorhabditis elegans</article-title>. <source>PNAS</source>. <year>2006</year> <month>Feb</month> <day>21</day>;<volume>103</volume>(<issue>8</issue>):<fpage>2707</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0511111103" xlink:type="simple">10.1073/pnas.0511111103</ext-link></comment> <object-id pub-id-type="pmid">16477039</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sommer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Straehle</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Köthe</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Hamprecht</surname> <given-names>FA</given-names></name>. <article-title>Ilastik: Interactive learning and segmentation toolkit</article-title>. In: <source>2011 IEEE International Symposium on Biomedical Imaging: From Nano to Macro</source>. <year>2011</year>. p. <fpage>230</fpage>–<lpage>3</lpage>.</mixed-citation></ref>
<ref id="pone.0194861.ref025"><label>25</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Kahaner</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Moler</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Nash</surname> <given-names>S</given-names></name>. <chapter-title>Numerical Methods and Software</chapter-title>. <publisher-loc>Upper Saddle River, NJ, USA</publisher-loc>: <publisher-name>Prentice-Hall, Inc.</publisher-name>; <year>1989</year>.</mixed-citation></ref>
<ref id="pone.0194861.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Boyle</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Waterston</surname> <given-names>RH</given-names></name>. <article-title>Control of Cell Cycle Timing during C. elegans Embryogenesis</article-title>. <source>Dev Biol</source>. <year>2008</year> <month>Jun</month> <day>1</day>;<volume>318</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ydbio.2008.02.054" xlink:type="simple">10.1016/j.ydbio.2008.02.054</ext-link></comment> <object-id pub-id-type="pmid">18430415</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Van Aelst</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rousseeuw</surname> <given-names>P</given-names></name>. <article-title>Minimum volume ellipsoid</article-title>. <source>WIREs Comp Stat</source>. <year>2009</year> <month>Jul</month> <day>1</day>;<volume>1</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>82</lpage>.</mixed-citation></ref>
<ref id="pone.0194861.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname> <given-names>LG</given-names></name>. <article-title>A Survey of Image Registration Techniques</article-title>. <source>ACM Comput Surv</source>. <year>1992</year> <month>Dec</month>;<volume>24</volume>(<issue>4</issue>):<fpage>325</fpage>–<lpage>376</lpage>.</mixed-citation></ref>
<ref id="pone.0194861.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Myronenko</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>X</given-names></name>. <article-title>Point Set Registration: Coherent Point Drift</article-title>. <source>IEEE Transactions on Pattern Analysis and Machine Intelligence</source>. <year>2010</year> <month>Dec</month>;<volume>32</volume>(<issue>12</issue>):<fpage>2262</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TPAMI.2010.46" xlink:type="simple">10.1109/TPAMI.2010.46</ext-link></comment> <object-id pub-id-type="pmid">20975122</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zitová</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Flusser</surname> <given-names>J</given-names></name>. <article-title>Image registration methods: a survey</article-title>. <source>Image and Vision Computing</source>. <year>2003</year> <month>Oct</month>;<volume>21</volume>(<issue>11</issue>):<fpage>977</fpage>–<lpage>1000</lpage>.</mixed-citation></ref>
<ref id="pone.0194861.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schindelin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Arganda-Carreras</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Frise</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kaynig</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Longair</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pietzsch</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Fiji—an Open Source platform for biological image analysis</article-title>. <source>Nat Methods</source> [Internet]. <year>2012</year> <month>Jun</month> <day>28</day> [cited 2016 Jun 2];9(7). Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3855844/" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3855844/</ext-link></mixed-citation></ref>
<ref id="pone.0194861.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Singhal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shaham</surname> <given-names>S</given-names></name>. <article-title>Infrared laser-induced gene expression for tracking development and function of single <italic>C</italic></article-title>. <article-title><italic>elegans</italic> embryonic neurons</article-title>. <source>Nature Communications</source>. <year>2017</year> <month>Jan</month> <day>18</day>;<volume>8</volume>:<fpage>14100</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms14100" xlink:type="simple">10.1038/ncomms14100</ext-link></comment> <object-id pub-id-type="pmid">28098184</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schnabel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hutter</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Moerman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Schnabel</surname> <given-names>H</given-names></name>. <article-title>Assessing normal embryogenesis in Caenorhabditis elegans using a 4D microscope: variability of development and regional specification</article-title>. <source>Dev Biol</source>. <year>1997</year> <month>Apr</month> <day>15</day>;<volume>184</volume>(<issue>2</issue>):<fpage>234</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/dbio.1997.8509" xlink:type="simple">10.1006/dbio.1997.8509</ext-link></comment> <object-id pub-id-type="pmid">9133433</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brenner</surname> <given-names>S</given-names></name>. <article-title>The genetics of Caenorhabditis elegans</article-title>. <source>Genetics</source>. <year>1974</year> <month>May</month>;<volume>77</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>94</lpage>. <object-id pub-id-type="pmid">4366476</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pujol</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Torregrossa</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ewbank</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Brunet</surname> <given-names>JF</given-names></name>. <article-title>The homeodomain protein CePHOX2/CEH-17 controls antero-posterior axonal growth in C. elegans</article-title>. <source>Development</source>. <year>2000</year> <month>Aug</month> <day>1</day>;<volume>127</volume>(<issue>15</issue>):<fpage>3361</fpage>–<lpage>71</lpage>. <object-id pub-id-type="pmid">10887091</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ooi</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Priess</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Henikoff</surname> <given-names>S</given-names></name>. <article-title>Histone H3.3 variant dynamics in the germline of Caenorhabditis elegans</article-title>. <source>PLoS Genet</source>. <year>2006</year> <month>Jun</month>;<volume>2</volume>(<issue>6</issue>):<fpage>e97</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.0020097" xlink:type="simple">10.1371/journal.pgen.0020097</ext-link></comment> <object-id pub-id-type="pmid">16846252</object-id></mixed-citation></ref>
<ref id="pone.0194861.ref037"><label>37</label><mixed-citation publication-type="other" xlink:type="simple">Ho TK. Random decision forests. In: Proceedings of the Third International Conference on Document Analysis and Recognition, 1995. 1995. p. 278–82 vol.1.</mixed-citation></ref>
</ref-list>
</back>
</article>