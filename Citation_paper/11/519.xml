<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-18-19237</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0208927</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject><subj-group><subject>Normal distribution</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Bayesian method</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Mathematical models</subject><subj-group><subject>Random walk</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Bayesian change-point modeling with segmented ARMA model</article-title>
<alt-title alt-title-type="running-head">Bayesian change-point modeling with segmented ARMA model</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Sadia</surname> <given-names>Farhana</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Boyd</surname> <given-names>Sarah</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9675-3976</contrib-id>
<name name-style="western">
<surname>Keith</surname> <given-names>Jonathan M.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>School of Mathematical Sciences, Monash University, Clayton, VIC, Australia</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Faculty of Information Technology, Monash University, Clayton, VIC, Australia</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Peixoto</surname> <given-names>Tiago P.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Bath, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">jonathan.keith@monash.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>31</day>
<month>12</month>
<year>2018</year>
</pub-date>
<volume>13</volume>
<issue>12</issue>
<elocation-id>e0208927</elocation-id>
<history>
<date date-type="received">
<day>28</day>
<month>6</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>26</day>
<month>11</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Sadia et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0208927"/>
<abstract>
<p>Time series segmentation aims to identify segment boundary points in a time series, and to determine the dynamical properties corresponding to each segment. To segment time series data, this article presents a Bayesian change-point model in which the data within segments follows an autoregressive moving average (ARMA) model. A prior distribution is defined for the number of change-points, their positions, segment means and error terms. To quantify uncertainty about the location of change-points, the resulting posterior probability distributions are sampled using the Generalized Gibbs sampler Markov chain Monte Carlo technique. This methodology is illustrated by applying it to simulated data and to real data known as the well-log time series data. This well-log data records the measurements of nuclear magnetic response of underground rocks during the drilling of a well. Our approach has high sensitivity, and detects a larger number of change-points than have been identified by comparable methods in the existing literature.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000923</institution-id>
<institution>Australian Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>DP1095849</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9675-3976</contrib-id>
<name name-style="western">
<surname>Keith</surname> <given-names>Jonathan M.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was funded by the Australian Research Council (<ext-link ext-link-type="uri" xlink:href="http://www.arc.gov.au/" xlink:type="simple">http://www.arc.gov.au/</ext-link>) grant DP1095849. The authors are grateful to the Australian Research Council (ARC) and the ARC Centre of Excellence for Mathematical and Statistical Frontiers for their support of this project (DP1095849, CE140100049). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="14"/>
<table-count count="1"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are available at: <ext-link ext-link-type="uri" xlink:href="https://rss.onlinelibrary.wiley.com/hub/journal/14679868/series-b-datasets/pre_2016a" xlink:type="simple">https://rss.onlinelibrary.wiley.com/hub/journal/14679868/series-b-datasets/pre_2016a</ext-link>. Those interested would be able to access the data in the same manner as the authors. The authors had no special access privileges.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>A time series is a succession of measurements made over a time interval. Some time series can be divided into a sequence of individual segments, each with its own unique characteristic properties. Identifying segment boundaries and inferring dynamical properties of different segments is referred to as time series segmentation. Change-point detection methods can be used to segment time series data since the goal of such methods is to select a sequence of change-point locations such that the observations are, in some sense, homogeneous within segments and different between segments [<xref ref-type="bibr" rid="pone.0208927.ref001">1</xref>].</p>
<p>Statistical analysis of change-point problems has been the subject of intensive research in the past half-century and there has been a large amount of literature on this subject (for reviews, see [<xref ref-type="bibr" rid="pone.0208927.ref002">2</xref>–<xref ref-type="bibr" rid="pone.0208927.ref005">5</xref>]). Literature on Bayesian change-point modeling is as extensive as for the classical change-point model. The Bayesian change-point model was pioneered by Chernoff and Zacks [<xref ref-type="bibr" rid="pone.0208927.ref006">6</xref>], who estimated the mean of a normal distribution for each segment in a Bayesian framework. Smith [<xref ref-type="bibr" rid="pone.0208927.ref007">7</xref>] proposed a Bayesian change-point model for finite series with normal and binomial models. To detect change-points in multivariate time series, Harlé <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0208927.ref008">8</xref>] used a Bayesian approach where change-points are modeled using Bernoulli variables for the change-point indicator vector. Successive generalizations and extensions of Bayesian methods for change-point problems include [<xref ref-type="bibr" rid="pone.0208927.ref009">9</xref>–<xref ref-type="bibr" rid="pone.0208927.ref013">13</xref>] and many others.</p>
<p>Different authors propose diverse models for each segment. For example, Punskaya <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0208927.ref014">14</xref>] suggested a Bayesian method for fitting piecewise linear regression models such as autoregressive models. To explain regime switching behaviour in the conditional mean, Chan and Tong [<xref ref-type="bibr" rid="pone.0208927.ref015">15</xref>] proposed a new class of non-linear models, called the Smooth Transition Autoregressive (STAR) models. This model is an extension of the Threshold Autoregressive (TAR) model, introduced by Tong and Lim [<xref ref-type="bibr" rid="pone.0208927.ref016">16</xref>–<xref ref-type="bibr" rid="pone.0208927.ref018">18</xref>]. The TAR model is a piecewise linear model consisting of two or more linear sub-models. An indicator variable is used in the TAR model which represents a switch from one regime to another and takes a value zero or one, depending upon the values of a transition variable and a threshold parameter. This indicator variable implies abrupt jumps from one regime to the next. Chan and Tong [<xref ref-type="bibr" rid="pone.0208927.ref015">15</xref>] suggested the replacement of the indicator function with a smooth transition function in their STAR model, since sudden jumps from one regime to another may not be the best representation of the underlying mechanism generating observed data. Davis <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0208927.ref019">19</xref>] estimated structural breaks in a nonstationary time series by segmenting the series into blocks of distinct autoregressive (AR) processes. They assumed the number of breakpoints, their locations and the orders of the respective AR models are unknown. To segment non-stationary time series data, Wood <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0208927.ref020">20</xref>] developed a Bayesian mixture of autoregressive models where components of the model are time series and mixture probabilities. The time series have constant but unknown parameters and those mixture probabilities depend on time. They assumed unknown lag of the AR processes as well as an unknown number of components in the mixture model. To estimate the number and locations of multiple change-points in the mean of a Gaussian AR(1) process, Chakar <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0208927.ref021">21</xref>] proposed a new approach where the unknown autocorrelation coefficient and the variance of an “innovation” term remain unchanged from one segment to the other. They firstly estimated the autocorrelation coefficient and then decorrelate the series. After that they applied a dynamic programming algorithm to the decorrelated series.</p>
<p>As noted above, some existing models for time series segmentation have used a segmented AR model [<xref ref-type="bibr" rid="pone.0208927.ref019">19</xref>, <xref ref-type="bibr" rid="pone.0208927.ref022">22</xref>]. This paper proposes to segment time series data using a segmented ARMA model, an approach that is surprisingly absent from the existing literature. Results for the well-log time series data discussed below show that fitting an ARMA model in each segment potentially identifies a greater number of change-points than the AR model in both real and simulated data and thus provides higher sensitivity. Moreover, we find that this is true for both large and small values of the variance <italic>σ</italic><sup>2</sup> of the innovation term. Detailed explanations and comparison with AR model are provided in <xref ref-type="supplementary-material" rid="pone.0208927.s003">S3 Appendix</xref>.</p>
<p>The Bayesian segmented ARMA change-point model presented here resembles the approach of Keith <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0208927.ref023">23</xref>]. The major modelling innovation here is the use of an ARMA model in all segments. The posterior marginal distribution of this model are difficult to analyse directly since they have nonstandard form. However, simulated sampling can be performed via a Markov chain Monte Carlo (MCMC) algorithm. Several MCMC algorithms are available in the literature including the Metropolis-Hastings algorithm [<xref ref-type="bibr" rid="pone.0208927.ref024">24</xref>, <xref ref-type="bibr" rid="pone.0208927.ref025">25</xref>], Gibbs Sampler [<xref ref-type="bibr" rid="pone.0208927.ref026">26</xref>], the Reversible Jump MCMC algorithm [<xref ref-type="bibr" rid="pone.0208927.ref009">9</xref>]; Multiple-Try Metropolis algorithm [<xref ref-type="bibr" rid="pone.0208927.ref027">27</xref>] and Delayed Rejection Metropolis-Hastings algorithm [<xref ref-type="bibr" rid="pone.0208927.ref028">28</xref>]. The Bayesian segmented ARMA change-point model here uses a highly efficient sampling technique known as the Generalized Gibbs Sampler (GGS) for generating samples from a posterior distribution [<xref ref-type="bibr" rid="pone.0208927.ref029">29</xref>]. The dimension in this algorithm does not need to be fixed and it provides flexibility to sample from varying dimensional spaces. The Generalized Gibbs Sampler (GGS) has been applied to some very high dimensional problems (see [<xref ref-type="bibr" rid="pone.0208927.ref030">30</xref>, <xref ref-type="bibr" rid="pone.0208927.ref031">31</xref>]). It has resulted in highly efficient sampling for these problems. However, no systematic comparison of the advantages and disadvantages of the GGS versus the reversible jump sampler has been performed.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methodology</title>
<sec id="sec003">
<title>Problem statement</title>
<p>We consider the problem of modeling a time series by segmenting the series into blocks of autoregressive moving average (ARMA) processes. Let <italic>t</italic> = 1, ⋯, <italic>T</italic> be time points in the signal or time series, where <italic>T</italic> represents the total length of the signal. Let <italic>x</italic><sub><italic>t</italic></sub> represent a real valued signal at time point, <italic>t</italic>. Let, <inline-formula id="pone.0208927.e001"><alternatives><graphic id="pone.0208927.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> represent the time series vector or the signal that we want to segment. The ARMA model is:
<disp-formula id="pone.0208927.e002"><alternatives><graphic id="pone.0208927.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>a</mml:mi></mml:munderover> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>ψ</italic><sub>1</sub>, ⋯, <italic>ψ</italic><sub><italic>a</italic></sub> and <italic>θ</italic><sub>1</sub>, ⋯, <italic>θ</italic><sub><italic>m</italic></sub> are the parameters of the AR and MA sub-models, respectively; <italic>a</italic> and <italic>m</italic> denote the order of the AR and MA sub-models; <italic>c</italic> is the mean of the ARMA model; <italic>ϵ</italic> is white noise and <italic>x</italic><sub><italic>t</italic></sub> is the time series. The number of change-points and their locations are assumed unknown. Each segment in the time-series is assumed to be generated by an ARMA model with different mean, and the goal is to infer the most probable segment locations and model parameters that describe them.</p>
</sec>
<sec id="sec004">
<title>Likelihood model</title>
<p>We start by writing down the likelihood function of a model in which the sequence within each segment is generated by an ARMA process. This determines the probability of generating the observed sequence for any given parameter values. For each position in the signal except the first, the probability of starting a new segment at that position is denoted by <italic>ϕ</italic>. Thus a time series with <italic>K</italic> segments that have starting positions <bold>s</bold> = (1 = <italic>s</italic><sub>1</sub> &lt; ⋯ &lt; <italic>s</italic><sub><italic>K</italic></sub> ≤ <italic>T</italic>) is generated with probability:
<disp-formula id="pone.0208927.e003"><alternatives><graphic id="pone.0208927.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>Here, <italic>s</italic><sub>1</sub> = 1, indicating that the first segment always starts at the beginning of the signal. Let the right hand points of the segments be <bold>d</bold> = (<italic>d</italic><sub>1</sub>, ⋯, <italic>d</italic><sub><italic>K</italic></sub>) where <italic>d</italic><sub><italic>K</italic></sub> = <italic>T</italic> so that the last segment always finishes at the end of the signal. Let <italic>X</italic><sub><italic>k</italic></sub> be the signal of the segment between positions <italic>s</italic><sub><italic>k</italic></sub> and <italic>d</italic><sub><italic>k</italic></sub> inclusive. Each segment is then assigned to one of <italic>N</italic> groups with probabilities <bold><italic>π</italic></bold> = (<italic>π</italic><sub>1</sub>, ⋯, <italic>π</italic><sub><italic>N</italic></sub>) where <italic>π</italic><sub><italic>n</italic></sub> is the probability of assigning any segment to group <italic>n</italic>. We denote the group to which segment <italic>k</italic> is assigned by <italic>g</italic><sub><italic>k</italic></sub> ∈ {1, ⋯, <italic>N</italic>} where <bold>g</bold> = (<italic>g</italic><sub>1</sub>, ⋯, <italic>g</italic><sub><italic>K</italic></sub>). Then the probability of a specific assignment of the <italic>K</italic> segments to the <italic>N</italic> groups is
<disp-formula id="pone.0208927.e004"><alternatives><graphic id="pone.0208927.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msub><mml:mi mathvariant="bold-italic">π</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>Let <italic>b</italic><sub><italic>n</italic></sub> be the number of segments with <italic>g</italic><sub><italic>k</italic></sub> = <italic>n</italic>. The probability of a specific assignment of the <italic>K</italic> segments to the <italic>N</italic> groups can be alternatively defined as:
<disp-formula id="pone.0208927.e005"><alternatives><graphic id="pone.0208927.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow> <mml:mi>n</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>Each segment is then modeled by an ARMA model. We write the ARMA model in each segment as:
<disp-formula id="pone.0208927.e006"><alternatives><graphic id="pone.0208927.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>a</mml:mi></mml:munderover> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>Here, <italic>c</italic><sub><italic>k</italic></sub> is the mean signal level for segment <italic>k</italic> and <inline-formula id="pone.0208927.e007"><alternatives><graphic id="pone.0208927.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0208927.e008"><alternatives><graphic id="pone.0208927.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msub><mml:mi>μ</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0208927.e009"><alternatives><graphic id="pone.0208927.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> are the mean and variance of the distribution of these means for the group <italic>g</italic><sub><italic>k</italic></sub>. Also, <bold><italic>ϵ</italic></bold> = (<italic>ϵ</italic><sub>1</sub>, ⋯, <italic>ϵ</italic><sub><italic>T</italic></sub>) is the vector of error terms and <italic>ϵ</italic><sub><italic>t</italic></sub> = <italic>x</italic><sub><italic>t</italic></sub> − λ<sub><italic>t</italic></sub>, where <inline-formula id="pone.0208927.e010"><alternatives><graphic id="pone.0208927.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>a</mml:mi></mml:munderover></mml:mstyle> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>m</mml:mi></mml:munderover></mml:mstyle> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. We suppose that <inline-formula id="pone.0208927.e011"><alternatives><graphic id="pone.0208927.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>σ</italic><sup>2</sup> is the variance of error terms and this applies for <italic>t</italic> ∈ (<italic>s</italic><sub><italic>k</italic></sub>, ⋯, <italic>d</italic><sub><italic>k</italic></sub>). In our model only these segment means differ between segments; other parameters of the ARMA model, <bold><italic>ψ</italic></bold> and <bold><italic>θ</italic></bold>, are the same for all segments. This assumption is appropriate for the applications used in this paper but other data sets may need to allow all of these parameters to differ between segments. In this paper, when we define the order of the AR (<italic>a</italic>) and MA (<italic>m</italic>) submodels we only intend for <italic>a</italic> and <italic>m</italic> to take values 0 or 1. Note that when <italic>t</italic> − <italic>s</italic><sub><italic>k</italic></sub> is less than <italic>a</italic> or <italic>m</italic>, the expression for λ<sub><italic>t</italic></sub> includes terms from the previous segment. However, for the left end of the signal when we can not look back <italic>a</italic> or <italic>m</italic> order steps, λ<sub><italic>t</italic></sub> includes only the <italic>c</italic><sub><italic>k</italic></sub> term. An alternative is to choose the initial values for each segment by initializing them from the stationary distribution for the ARMA process in that segment.</p>
<p>The probability density of the observed signal is a product over all segments, that is, the probability of the signal <bold>X</bold> conditioning on parameters <italic>K</italic>, <bold>s</bold>, <bold><italic>θ</italic></bold>, <bold><italic>ψ</italic></bold>, <bold>c</bold> and <italic>σ</italic><sup>2</sup> is expressed as a product of normal distributions with mean λ<sub><italic>t</italic></sub> and variance <italic>σ</italic><sup>2</sup> as follows:
<disp-formula id="pone.0208927.e012"><alternatives><graphic id="pone.0208927.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">ψ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">c</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>Here, <italic>x</italic><sub>&lt;<italic>t</italic></sub> indicates the signal value at time points 1, 2, ⋯, <italic>t</italic> − 1. The joint distribution of <bold>X</bold>, <italic>K</italic>, <bold>s</bold>, <bold>g</bold> and <bold>c</bold> conditional on the other parameters is given by:
<disp-formula id="pone.0208927.e013"><alternatives><graphic id="pone.0208927.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">c</mml:mi> <mml:mo>|</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">ψ</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">ψ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">c</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo> <mml:mo>×</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>|</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>×</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">c</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>×</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>|</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula></p>
<p>Here, <italic>p</italic>(<bold>c</bold>|<bold>g</bold>, <bold><italic>μ</italic></bold>, <bold><italic>τ</italic></bold>) is the probability of the ARMA mean for all segments given by:
<disp-formula id="pone.0208927.e014"><alternatives><graphic id="pone.0208927.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">c</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>
<xref ref-type="fig" rid="pone.0208927.g001">Fig 1</xref> shows the parameters of this model and their conditional dependencies. A parameter at the head of an arrow is conditionally dependent on the parameter at the tail.</p>
<fig id="pone.0208927.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The conditional dependencies of the parameter.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Prior distribution</title>
<p>Since the segmented ARMA model is presented here in a hierarchical Bayesian framework, we have to assign prior distributions for the unspecified parameters. A beta prior is assigned for <italic>ϕ</italic> with parameters <italic>a</italic> = 1.0 and <italic>b</italic> = 1.0. Our computational algorithm is not sensitive to the choice of prior for <italic>ϕ</italic>, as we show in <xref ref-type="supplementary-material" rid="pone.0208927.s004">S4 Appendix</xref>. We assign a Dirichlet distribution to <bold><italic>π</italic></bold> = (<italic>π</italic><sub>1</sub>, ⋯, <italic>π</italic><sub><italic>N</italic></sub>) with parameters (<italic>α</italic><sub>1</sub>, ⋯, <italic>α</italic><sub><italic>N</italic></sub>) = (1.0, ⋯, 1.0) and <inline-formula id="pone.0208927.e015"><alternatives><graphic id="pone.0208927.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>π</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Inferences are performed here using a weakly informative normal prior with mean 0.0 and variance 1.0 for the mean <italic>μ</italic><sub><italic>n</italic></sub> of the distribution of ARMA means in segment class <italic>N</italic>. We also assign an inverse gamma prior distribution with parameters <italic>α</italic> = 3.0 and <italic>β</italic> = 3.0 for the variance <inline-formula id="pone.0208927.e016"><alternatives><graphic id="pone.0208927.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>n</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of the distribution of <bold>c</bold> and the variance of the error terms (<italic>σ</italic><sup>2</sup>) of the ARMA model. The order of the AR model and the MA model will be considered fixed. Since we have no strong prior beliefs about the parameters of the ARMA model, we choose a uniform prior distribution for these on the interval (-1,1) and assume they are independent of each other. The forms of these hyper-priors were chosen to reflect the degree of prior belief about their respective parameters. Note that in general the signal <italic>x</italic><sub><italic>t</italic></sub> can be shifted and scaled so that the above prior is appropriate.</p>
</sec>
<sec id="sec006">
<title>Posterior distribution</title>
<p>Using Bayes’ theorem the posterior distribution of parameters is:
<disp-formula id="pone.0208927.e017"><alternatives><graphic id="pone.0208927.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">ψ</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∝</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">c</mml:mi> <mml:mo>|</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">ψ</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula></p>
<p>See <xref ref-type="supplementary-material" rid="pone.0208927.s001">S1 Appendix</xref> for details of the calculation of the conditional posterior distribution of each parameter.</p>
</sec>
<sec id="sec007">
<title>Sampling</title>
<p>The posterior distribution obtained in <xref ref-type="supplementary-material" rid="pone.0208927.s001">S1 Appendix</xref> is sampled using a Markov chain Monte Carlo technique known as the Generalized Gibbs Sampler, or GGS [<xref ref-type="bibr" rid="pone.0208927.ref029">29</xref>]. The GGS algorithm cycles through a sequence of steps in which parts of a sampled element are updated, while other parts are held constant. These different types of update are analogous to the coordinate updates of the conventional Gibbs sampler and are known as “move-types”. This technique resembles a conventional Gibbs sampler but can be applied in a transdimensional setting, where it provides an alternative to the reversible jump sampler. This technique allows the number of change-points to vary: it cycles through segments inserting and deleting change-points, and shifting change-point positions. See <xref ref-type="supplementary-material" rid="pone.0208927.s002">S2 Appendix</xref> for details of the GGS algorithm. The three main stages of this algorithm in Bayesian change-point segmented ARMA model are: (also see <xref ref-type="fig" rid="pone.0208927.g002">Fig 2</xref>)</p>
<list list-type="bullet">
<list-item>
<p>Iterate through the segments doing insertion and deletion updates, segment group assignments (<italic>g</italic><sub><italic>k</italic></sub>) and segment mean updates (<italic>c</italic><sub><italic>k</italic></sub>).</p>
</list-item>
<list-item>
<p>Iterate through the groups updating group parameters (group mean <italic>μ</italic><sub><italic>g</italic></sub> and group variance <inline-formula id="pone.0208927.e018"><alternatives><graphic id="pone.0208927.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>g</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>).</p>
</list-item>
<list-item>
<p>Update all the other parameters (<bold><italic>π</italic></bold>, <italic>σ</italic><sup>2</sup>, <italic>ϕ</italic>, <bold><italic>θ</italic></bold> and <bold><italic>ψ</italic></bold>).</p>
</list-item>
</list>
<fig id="pone.0208927.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Order of move-types for the sampler.</title>
<p>Note that <italic>I</italic> updates run from 1 to <italic>K</italic> whereas <italic>D</italic> updates run from 2 to <italic>K</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g002" xlink:type="simple"/>
</fig>
<sec id="sec008">
<title>Move types</title>
<p>
<xref ref-type="fig" rid="pone.0208927.g002">Fig 2</xref> illustrates the following defined move-types:</p>
<list list-type="bullet">
<list-item>
<p>(<italic>I</italic>, <italic>k</italic>): Decide whether to insert a new change-point in segment <italic>k</italic>, and at what position.</p>
</list-item>
<list-item>
<p>(<italic>D</italic>, <italic>k</italic>): Decide whether to remove change-point <italic>k</italic> or move it to a new position (for each change-point except the first).</p>
</list-item>
<list-item>
<p><italic>c</italic><sub><italic>k</italic></sub>: Update mean signal level <italic>c</italic><sub><italic>k</italic></sub> in segment <italic>k</italic> = 1, 2, 3, ⋯, <italic>K</italic>.</p>
</list-item>
<list-item>
<p><italic>g</italic><sub><italic>k</italic></sub>: Update segment group assignments <italic>g</italic><sub><italic>k</italic></sub> in segment <italic>k</italic> = 1, 2, 3, ⋯, <italic>K</italic>.</p>
</list-item>
<list-item>
<p><italic>μ</italic><sub><italic>g</italic></sub>: Update group mean <italic>μ</italic><sub><italic>g</italic></sub> for group <italic>g</italic>.</p>
</list-item>
<list-item>
<p>
<inline-formula id="pone.0208927.e019">
<alternatives>
<graphic id="pone.0208927.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e019" xlink:type="simple"/>
<mml:math display="inline" id="M19">
<mml:msubsup>
<mml:mi>τ</mml:mi>
<mml:mi>g</mml:mi>
<mml:mn>2</mml:mn>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>: Update group variance <inline-formula id="pone.0208927.e020"><alternatives><graphic id="pone.0208927.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>g</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> for group <italic>g</italic>.</p>
</list-item>
<list-item>
<p>(<bold><italic>θ</italic></bold>, <bold><italic>ψ</italic></bold>): Update <bold><italic>θ</italic></bold> and <bold><italic>ψ</italic></bold>.</p>
</list-item>
<list-item>
<p>(<bold><italic>π</italic></bold>, <italic>σ</italic><sup>2</sup>, <italic>ϕ</italic>): Update all other parameters, <bold><italic>π</italic></bold>, <italic>σ</italic><sup>2</sup> and <italic>ϕ</italic>.</p>
</list-item>
</list>
<p>There are <italic>K</italic> I-moves, <italic>K</italic> − 1 D-moves, <italic>K</italic> moves for updating segment group assignments, <italic>K</italic> moves for updating mean signal level, <italic>N</italic> moves for updating group mean, <italic>N</italic> moves for updating group variance, <italic>a</italic> moves to update parameters of the AR model, <italic>m</italic> moves to update parameters of the MA model and finally three moves for updating other parameters <bold><italic>π</italic></bold>, <italic>σ</italic><sup>2</sup> and <italic>ϕ</italic>. The total number of moves for a sequence with <italic>K</italic> segments is:
<disp-formula id="pone.0208927.e021"><alternatives><graphic id="pone.0208927.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi> <mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>4</mml:mn> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mi>m</mml:mi> <mml:mo>+</mml:mo> <mml:mn>3</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <italic>N</italic> is the number of groups, <italic>a</italic> is the order of the AR model and <italic>m</italic> is the order of the MA model.</p>
</sec>
<sec id="sec009">
<title>Insertion: Step (<italic>I</italic>, <italic>k</italic>)</title>
<p>Each move-type of a GGS sampler involves drawing from a distribution over a subset of the target space. The insertion and deletion move-types mentioned in <xref ref-type="fig" rid="pone.0208927.g002">Fig 2</xref> both involve selecting an element from a set containing only two elements. In this respect, these move-types resemble a Metropolis-Hastings update, in which a new element is proposed and either accepted or rejected with some probability. In fact the insertion and deletion move-types involve the same subsets: they differ only in which element of the set is regarded as the source or current element, and which is regarded as the proposed element. The two elements in these subsets each have non-zero probability of being selected, proportional to the target distribution multiplied by the probability of selecting the move type when that element is the current element (see [<xref ref-type="bibr" rid="pone.0208927.ref029">29</xref>] for details).</p>
<p>In an (<italic>I</italic>, <italic>k</italic>) insertion step (where <italic>k</italic> ∈ {1, ⋯, <italic>K</italic>}) the subset contains the current segmentation and a new segmentation with a change-point inserted somewhere in segment <italic>k</italic>. A new segment end-point position <italic>z</italic> is proposed between <italic>s</italic><sub><italic>k</italic></sub> and <italic>d</italic><sub><italic>k</italic></sub> − 1, inclusive. The location of <italic>z</italic> is selected from a uniform distribution over the set {<italic>s</italic><sub><italic>k</italic></sub>, ⋯, <italic>d</italic><sub><italic>k</italic></sub> − 1}. Then for the left segment (from <italic>s</italic><sub><italic>k</italic></sub> to <italic>z</italic>) new values of <inline-formula id="pone.0208927.e022"><alternatives><graphic id="pone.0208927.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0208927.e023"><alternatives><graphic id="pone.0208927.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> are proposed and for the right segment (from <italic>z</italic> + 1 to <italic>d</italic><sub><italic>k</italic></sub>) new values of <inline-formula id="pone.0208927.e024"><alternatives><graphic id="pone.0208927.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0208927.e025"><alternatives><graphic id="pone.0208927.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are proposed. Here, <inline-formula id="pone.0208927.e026"><alternatives><graphic id="pone.0208927.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0208927.e027"><alternatives><graphic id="pone.0208927.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are selected from a discrete distribution with parameters <italic>π</italic><sub>1</sub>, …, <italic>π</italic><sub><italic>N</italic></sub> and then <inline-formula id="pone.0208927.e028"><alternatives><graphic id="pone.0208927.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0208927.e029"><alternatives><graphic id="pone.0208927.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are selected from normal distributions with parameters <inline-formula id="pone.0208927.e030"><alternatives><graphic id="pone.0208927.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0208927.e031"><alternatives><graphic id="pone.0208927.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> respectively. Choosing <inline-formula id="pone.0208927.e032"><alternatives><graphic id="pone.0208927.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0208927.e033"><alternatives><graphic id="pone.0208927.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0208927.e034"><alternatives><graphic id="pone.0208927.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0208927.e035"><alternatives><graphic id="pone.0208927.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> in this manner results in cancellations such that the terms <italic>p</italic>(<bold>c</bold>|<bold>g</bold>, <bold><italic>μ</italic></bold>, <bold><italic>τ</italic></bold>) and <italic>p</italic>(<bold>g</bold>|<italic>K</italic>, <bold><italic>π</italic></bold>) in <xref ref-type="disp-formula" rid="pone.0208927.e013">Eq 6</xref> disappear when calculating the acceptance ratio.</p>
<p>After further cancellations, the new change-point at position <italic>z</italic> + 1 is rejected with a probability proportional to
<disp-formula id="pone.0208927.e036"><alternatives><graphic id="pone.0208927.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where
<disp-formula id="pone.0208927.e037"><alternatives><graphic id="pone.0208927.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mtext>exp</mml:mtext> <mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and
<disp-formula id="pone.0208927.e038"><alternatives><graphic id="pone.0208927.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>a</mml:mi></mml:munderover> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>In this expression, 1/(<italic>d</italic><sub><italic>k</italic></sub> − <italic>s</italic><sub><italic>k</italic></sub>) is the probability of proposing the location of the new change-point and 1/<italic>T</italic>(<italic>K</italic>) is a correction factor used by the GGS to account for the number of move types available for the current segmentation with <italic>K</italic> segments.</p>
<p>Alternatively, the new change-point is accepted with probability proportional to:
<disp-formula id="pone.0208927.e039"><alternatives><graphic id="pone.0208927.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow> <mml:mi>z</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mi>z</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
where
<disp-formula id="pone.0208927.e040"><alternatives><graphic id="pone.0208927.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mtext>exp</mml:mtext> <mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mtext>exp</mml:mtext> <mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>a</mml:mi></mml:munderover> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
and
<disp-formula id="pone.0208927.e041"><alternatives><graphic id="pone.0208927.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>a</mml:mi></mml:munderover> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p>
<p>Here, <xref ref-type="disp-formula" rid="pone.0208927.e040">Eq 12</xref> applies for the left segment from <italic>s</italic><sub><italic>k</italic></sub> to <italic>z</italic> and <xref ref-type="disp-formula" rid="pone.0208927.e041">Eq 13</xref> applies for the right segment from <italic>z</italic> + 1 to <italic>d</italic><sub><italic>k</italic></sub>.</p>
<p>Thus the new change-point at <italic>z</italic> + 1 is accepted with probability <inline-formula id="pone.0208927.e042"><alternatives><graphic id="pone.0208927.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mfrac><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> or rejected with probability <inline-formula id="pone.0208927.e043"><alternatives><graphic id="pone.0208927.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mfrac><mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. An alternative (which we have not implemented) is to use the Metropolis-Hastings acceptance probability min{1, <italic>P</italic><sub>0</sub>/<italic>P</italic><sub>1</sub>}.</p>
<p>If a change-point is inserted, the move-type is updated to (<italic>D</italic>, <italic>k</italic>+ 1), otherwise it remains (<italic>I</italic>, <italic>k</italic>). In either case, the move-type is then further updated as in <xref ref-type="fig" rid="pone.0208927.g002">Fig 2</xref>.</p>
</sec>
<sec id="sec010">
<title>Deletion: Step (<italic>D</italic>, <italic>k</italic>)</title>
<p>For each segment <italic>k</italic> = 2, ⋯, <italic>K</italic>, a (<italic>D</italic>, <italic>k</italic>) deletion step also involves selecting an element from a set containing only two elements: the current segmentation and a new segmentation with the change-point at the left end of segment <italic>k</italic> removed, so that segments <italic>k</italic> − 1 and <italic>k</italic> merge to form a new segment. Values of <italic>g</italic><sub><italic>k</italic></sub> and <italic>c</italic><sub><italic>k</italic></sub> are then chosen for the new merged segment: <italic>g</italic><sub><italic>k</italic></sub> is selected from a discrete distribution with parameters <italic>π</italic><sub>1</sub>, …, <italic>π</italic><sub><italic>N</italic></sub> and then <italic>c</italic><sub><italic>k</italic></sub> is selected from a normal distribution with parameters <inline-formula id="pone.0208927.e044"><alternatives><graphic id="pone.0208927.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msub><mml:mi>μ</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0208927.e045"><alternatives><graphic id="pone.0208927.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> respectively. Other parameters and the positions of other change-points are held constant.</p>
<p>The probability of accepting the deletion is proportional to:
<disp-formula id="pone.0208927.e046"><alternatives><graphic id="pone.0208927.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where
<disp-formula id="pone.0208927.e047"><alternatives><graphic id="pone.0208927.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mtext>exp</mml:mtext> <mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and
<disp-formula id="pone.0208927.e048"><alternatives><graphic id="pone.0208927.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e048" xlink:type="simple"/><mml:math display="block" id="M48"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>a</mml:mi></mml:munderover> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Here <italic>K</italic> is the number of segments in the current segmentation, that is, without making the deletion.</p>
<p>The probability of rejecting the deletion is proportional to:
<disp-formula id="pone.0208927.e049"><alternatives><graphic id="pone.0208927.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow> <mml:mi>z</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mi>z</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msubsup> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Thus the deletion is accepted with probability <inline-formula id="pone.0208927.e050"><alternatives><graphic id="pone.0208927.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mfrac><mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> or rejected with probability <inline-formula id="pone.0208927.e051"><alternatives><graphic id="pone.0208927.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mfrac><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>.</p>
<p>The conditional posterior distribution for <bold>c</bold> and <bold><italic>ϵ</italic></bold> is proportional to:
<disp-formula id="pone.0208927.e052"><alternatives><graphic id="pone.0208927.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow> <mml:msub><mml:mi>d</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>The <bold>c</bold>’s and the corresponding <inline-formula id="pone.0208927.e053"><alternatives><graphic id="pone.0208927.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can be updated one segment at a time with this conditional posterior distribution. Now, the conditional posterior distribution for <bold><italic>θ</italic></bold> and <bold><italic>ϵ</italic></bold> is proportional to:
<disp-formula id="pone.0208927.e054"><alternatives><graphic id="pone.0208927.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>To update <bold><italic>ψ</italic></bold>, similar procedures were used. The sampler iterates through the groups, updating group parameters (<bold><italic>μ</italic></bold> and <bold><italic>τ</italic></bold>) with their respective conditional posterior distributions.</p>
<p>The sampler uses conventional Gibbs updates for other parameters <italic>c</italic><sub><italic>k</italic></sub>, <italic>g</italic><sub><italic>k</italic></sub>, <italic>θ</italic><sub><italic>i</italic></sub>, <italic>ϕ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sup>2</sup>, <bold><italic>π</italic></bold>, <italic>ϕ</italic>, <italic>μ</italic><sub><italic>g</italic></sub> and <italic>τ</italic><sub><italic>g</italic></sub>. We use the Slice sampler [<xref ref-type="bibr" rid="pone.0208927.ref032">32</xref>] where needed to draw from non-standard distributions.</p>
</sec>
</sec>
</sec>
<sec id="sec011">
<title>Validation of the methodology</title>
<p>We have used a simulation-based method for testing the correctness of software for fitting Bayesian models using posterior simulation [<xref ref-type="bibr" rid="pone.0208927.ref033">33</xref>]. This validation technique is based on posterior quantiles. Consider the general Bayesian joint distribution <italic>p</italic>(<italic>y</italic>|Θ)<italic>p</italic>(Θ), where <italic>p</italic>(<italic>y</italic>|Θ) presents the sampling distribution of the data, <italic>p</italic>(Θ) presents the proper prior distribution of the parameter vector Θ, and inferences are based on the posterior distribution, <italic>p</italic>(Θ|<italic>y</italic>). The validation method samples a parameter vector Θ<sup>(0)</sup> from <italic>p</italic>(Θ). Then conditional on Θ<sup>(0)</sup>, this technique samples data <italic>y</italic> from <italic>p</italic>(<italic>y</italic>|Θ = Θ<sup>(0)</sup>) and then simulates sampling from the posterior distribution, <italic>p</italic>(Θ|<italic>y</italic>) using the software to be validated. The resulting posterior sample of size <italic>L</italic> is denoted (Θ<sup>(1)</sup>, Θ<sup>(2)</sup>, ⋯, Θ<sup>(<italic>L</italic>)</sup>). Finally, for each coordinate of Θ<sup>(0)</sup>, denoted <italic>θ</italic><sup>(0)</sup>, compute its posterior quantile <inline-formula id="pone.0208927.e055"><alternatives><graphic id="pone.0208927.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:mover accent="true"><mml:mi>q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, with respect to the posterior sample (<italic>θ</italic><sup>(1)</sup>, <italic>θ</italic><sup>(2)</sup>, ⋯, <italic>θ</italic><sup>(<italic>L</italic>)</sup>). To perform the validation procedure, many replications are required, each drawing Θ<sup>(0)</sup> from <italic>p</italic>(Θ) and <italic>y</italic> from <italic>p</italic>(<italic>y</italic>|Θ<sup>(0)</sup>). The simulation output is a collection of estimated posterior quantiles. From these quantiles calculate a test statistic <inline-formula id="pone.0208927.e056"><alternatives><graphic id="pone.0208927.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mi>θ</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mo>Φ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> where, <inline-formula id="pone.0208927.e057"><alternatives><graphic id="pone.0208927.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>L</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:msubsup> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>l</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the posterior quantile for the ith replication, <italic>N</italic><sub><italic>rep</italic></sub> is the total number of replications, <italic>θ</italic> denotes component of Θ and Φ represents the standard normal CDF. If the software is implemented correctly, this test statistic follows a <italic>χ</italic><sup>2</sup> distribution with <italic>N</italic><sub><italic>rep</italic></sub> degrees of freedom and also the posterior quantiles will be uniformly distributed. The posterior quantiles’ deviation from uniformity can be quantified by calculating the associated <italic>p</italic> value, that is, <italic>p</italic><sub><italic>θ</italic></sub> for each <inline-formula id="pone.0208927.e058"><alternatives><graphic id="pone.0208927.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mi>θ</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>. Extremely small <italic>p</italic><sub><italic>θ</italic></sub> values indicate an error in the software. As an exploratory tool, <italic>p</italic><sub><italic>θ</italic></sub> values can be transformed into a <italic>z</italic><sub><italic>θ</italic></sub> statistic (<italic>z</italic><sub><italic>θ</italic></sub> = Φ<sup>−1</sup>(<italic>p</italic><sub><italic>θ</italic></sub>)). If all |<italic>z</italic><sub><italic>θ</italic></sub>| statistics are not extreme, such as less than 2, the software may be considered validated.</p>
<p>To validate our method according to the above described technique, we generated the parameters <italic>τ</italic><sup>2</sup>, <italic>σ</italic><sup>2</sup>, <italic>π</italic>, <italic>μ</italic> from the following prior distributions:
<disp-formula id="pone.0208927.e059"><alternatives><graphic id="pone.0208927.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>τ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>∼</mml:mo> <mml:mi>I</mml:mi> <mml:mi>n</mml:mi> <mml:mi>v</mml:mi> <mml:mo>-</mml:mo> <mml:mi>g</mml:mi> <mml:mi>a</mml:mi> <mml:mi>m</mml:mi> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>3</mml:mn> <mml:mo>,</mml:mo> <mml:mn>3</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>∼</mml:mo> <mml:mi>I</mml:mi> <mml:mi>n</mml:mi> <mml:mi>v</mml:mi> <mml:mo>-</mml:mo> <mml:mi>g</mml:mi> <mml:mi>a</mml:mi> <mml:mi>m</mml:mi> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>3</mml:mn> <mml:mo>,</mml:mo> <mml:mn>3</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>π</mml:mi> <mml:mo>∼</mml:mo> <mml:mi>U</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>μ</mml:mi> <mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>θ</mml:mi> <mml:mo>∼</mml:mo> <mml:mi>U</mml:mi> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>ψ</mml:mi> <mml:mo>∼</mml:mo> <mml:mi>U</mml:mi> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>We generated 20 sequences from an ARMA model with 20 different segment means where every sequence has length 100. We simulated 5000 draws from the posterior distribution of the model parameters. Then the quantiles of the posterior distributions for each parameter were determined and the whole procedure was repeated 20 times. From these quantiles we determined the absolute values of the <italic>z</italic><sub><italic>θ</italic></sub> statistic. The absolute <italic>z</italic><sub><italic>θ</italic></sub> statistics from this simulation are plotted in <xref ref-type="fig" rid="pone.0208927.g003">Fig 3</xref>:</p>
<fig id="pone.0208927.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Absolute <italic>z</italic><sub><italic>θ</italic></sub> statistic plot.</title>
<p>Each row shows a parameter of the segmented ARMA model and the |<italic>z</italic><sub><italic>θ</italic></sub>| statistics associated with these parameters are displayed as a circle in each row.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g003" xlink:type="simple"/>
</fig>
<p>In the above plot, since the <italic>z</italic><sub><italic>θ</italic></sub> statistic for each parameter is less than 2, we conclude the software is correctly written. More precisely, we find no evidence of software errors.</p>
</sec>
<sec id="sec012">
<title>Illustrative examples</title>
<sec id="sec013">
<title>Simulation example</title>
<p>As a test of our method, we applied it to a simulated example in which the number and location of change-points, ARMA parameters, segment means and error variance are known. We analyzed 20 time series, each containing 100 observations, generated from the autoregressive moving average (ARMA(1,1)) model with parameter values <italic>ψ</italic> = 0.22 and <italic>θ</italic> = 0.60. Each series was generated using <italic>σ</italic><sup>2</sup> = 0.96 and 20 different segment means. The simulated ARMA data with the true segment means and the location of change-points is shown in <xref ref-type="fig" rid="pone.0208927.g004">Fig 4</xref>.</p>
<fig id="pone.0208927.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Simulated signal.</title>
<p>The true change-point locations are shown as vertical blue lines and segment means are shown as horizontal red lines.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g004" xlink:type="simple"/>
</fig>
<p>We executed 5,000 iterations of the MCMC estimation algorithm and the first 1,000 iterations were treated as a burn in period and discarded. The convergence of AR and MA parameters is evident in <xref ref-type="fig" rid="pone.0208927.g005">Fig 5</xref>. Both AR and MA parameters converge, display good mixing and are close to the true values of those parameters.</p>
<fig id="pone.0208927.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Trace plot of AR and MA parameters.</title>
<p>Both parameters converged to the true values.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g005" xlink:type="simple"/>
</fig>
<p>The top panel of <xref ref-type="fig" rid="pone.0208927.g006">Fig 6</xref> presents the simulated signal with the true change-points (red vertical line). The middle plot shows the posterior distribution of occurrence of change-point locations, that is, the posterior probability of being change-points at each position. The height of the (red) ‘spikes’ indicates the posterior probability of a change-point being selected at each time point. The top two plots show the locations of estimated change-points and the true change-points are similar. This picture is clearer if we compare actual change-point locations and estimated change-point locations with the simulated data, as in the top and bottom plots of <xref ref-type="fig" rid="pone.0208927.g006">Fig 6</xref>. The blue lines indicate time points at which the posterior probabilities of change-points are greater than 0.5. <xref ref-type="fig" rid="pone.0208927.g006">Fig 6</xref> (bottom) identifies 17 change-points out of 19 true change-points.</p>
<fig id="pone.0208927.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g006</object-id>
<label>Fig 6</label>
<caption>
<title/>
<p>(Top) Segmented signal with the true change-point locations. (Middle) Posterior probabilities of occurrence of change-points. (Bottom) Estimated change-point locations (posterior probability greater than 0.5). The middle plot shows the location of peaks in the probability profile closely follows the true change-points locations but in some positions with low posterior probability. Using a threshold in posterior probability 0.5, we identify 17 change-points out of 19 which match the locations of the true change-points.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g006" xlink:type="simple"/>
</fig>
<p>
<xref ref-type="fig" rid="pone.0208927.g007">Fig 7</xref> plots posterior estimators of mean signal level (<italic>c</italic>) at each position of the simulated signal. This plot clearly indicates 20 segments in the simulated signal detecting a change in mean even where change-points were not detected in <xref ref-type="fig" rid="pone.0208927.g006">Fig 6</xref>.</p>
<fig id="pone.0208927.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Segment means at each position of simulated data.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Well-log data</title>
<p>We now apply the segmented ARMA model to identify change-points in a real data set. This data records 4050 measurements of nuclear magnetic response of underground rocks during the drilling of a well. During drilling, data were obtained at discrete time points by lowering a probe into a bore-hole in the Earth’s surface. This geophysical data originates from Ó Ruanaidh and Fitzgerald [<xref ref-type="bibr" rid="pone.0208927.ref034">34</xref>] and has been previously analyzed in the context of change-point detection by many researchers, for example, by Fearnhead and Clifford [<xref ref-type="bibr" rid="pone.0208927.ref035">35</xref>], Fearnhead [<xref ref-type="bibr" rid="pone.0208927.ref036">36</xref>] and by Whiteley <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0208927.ref001">1</xref>]. A few outliers present in this data were removed by hand before analyzing the data as in Fearnhead [<xref ref-type="bibr" rid="pone.0208927.ref036">36</xref>]. The data is shown in <xref ref-type="fig" rid="pone.0208927.g008">Fig 8</xref>.</p>
<fig id="pone.0208927.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Well-log data.</title>
<p>This data provides information about the rock structure of the well. Some change-points are present in the data reflecting the presence of a new rock.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g008" xlink:type="simple"/>
</fig>
<p>The piecewise constant signal of this data indicates information about the geophysical structure of the rocks in the well. Changes in mean occur at each time point whenever a new rock type is found. To identify change-points in this well-log data, Ó Ruanaidh and Fitzgerald [<xref ref-type="bibr" rid="pone.0208927.ref034">34</xref>] used a Gibbs sampler to fit a Bayesian change-point model with a fixed number of change-points; Fearnhead and Clifford [<xref ref-type="bibr" rid="pone.0208927.ref035">35</xref>] used on-line Bayesian analysis of data with a hidden Markov model using particle filters; Fearnhead [<xref ref-type="bibr" rid="pone.0208927.ref036">36</xref>] considered an extension of the model described by Fearnhead and Clifford [<xref ref-type="bibr" rid="pone.0208927.ref035">35</xref>] in which they considered all the parameters of their model to be unknown and they used reversible jump MCMC to fit that model; Whiteley <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0208927.ref001">1</xref>] considered the same model used by Fearnhead [<xref ref-type="bibr" rid="pone.0208927.ref036">36</xref>] to analyze well-log data but here they used a block Gibbs sampler for generating samples from the posterior distribution.</p>
<p>To find change-points in this data, we attempted to fit an AR(1) model, an MA(1) model and an ARMA(1,1) model. We are the first to investigate this data using a segmented ARMA model. Each model was run for 5000 iterations and then tested for convergence of each parameter using trace plots and an autocorrelation function (ACF) plot which represents the degree of correlation between all pairs of samples separated by progressively larger lags (number of samples). The change-point profiles and segment mean profiles for each model are given in Figs <xref ref-type="fig" rid="pone.0208927.g009">9</xref>–<xref ref-type="fig" rid="pone.0208927.g011">11</xref>.</p>
<fig id="pone.0208927.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Top plot shows the posterior estimators of mean signal level (c) on each segment of AR(1) model.</title>
<p>Bottom plot shows the posterior probability of a change-point at each position. These segment means and change-point positions indicate significant jumps in the original data.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g009" xlink:type="simple"/>
</fig>
<fig id="pone.0208927.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Top and bottom plot show the segment mean profiles and the change-point profiles for MA(1) model respectively.</title>
<p>This model identifies more change-points than the AR(1) model.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g010" xlink:type="simple"/>
</fig>
<fig id="pone.0208927.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Top and bottom plot show the segment mean profiles and the change-point profiles for ARMA(1,1) model respectively.</title>
<p>These change-points and segment means are almost identical to those identified using the MA(1) model.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g011" xlink:type="simple"/>
</fig>
<p>In our model, the initial segmentation was generated using a probability of starting a new segment <italic>ϕ</italic> = 0.1. The initial segmentation was generated by throwing a uniform(0,1) random number for each sequence position except the first, making that position a change-point if the random number is less than <italic>ϕ</italic> at that position. Note that, this initial segmentation should not affect the stationary distribution of the Markov chain. The posterior probabilities of occurrence of change-points at each position of the input sequence are calculated using the uniform prior probability distribution for <italic>ϕ</italic> (the probability that any given sequence position is a change-point) and the likelihood probability (<italic>p</italic>(<italic>K</italic>, <bold>s</bold>|<bold><italic>ϕ</italic></bold>) = <bold><italic>ϕ</italic></bold><sup><italic>K</italic>−1</sup>(1 − <italic>ϕ</italic>)<sup><italic>T</italic>−<italic>K</italic>−1</sup>) of generating a new segmentation with <italic>K</italic> change-points and <bold>s</bold> = (1 = <italic>s</italic><sub>1</sub> &lt; ⋯ &lt; <italic>s</italic><sub><italic>K</italic></sub> ≤ <italic>T</italic>) starting positions.</p>
<p>All change-point profile plots (Figs <xref ref-type="fig" rid="pone.0208927.g009">9</xref>–<xref ref-type="fig" rid="pone.0208927.g011">11</xref>) show almost the same change-points locations. But at some locations the AR(1) model gives comparatively smaller posterior probability than the MA(1) and ARMA(1,1) models. In addition, the AR(1) model identifies fewer change-points with high posterior probability (when the posterior probability is more than 0.5) than the other two models. These results are somewhat similar to the previous results found in the change-point literature [<xref ref-type="bibr" rid="pone.0208927.ref001">1</xref>, <xref ref-type="bibr" rid="pone.0208927.ref034">34</xref>–<xref ref-type="bibr" rid="pone.0208927.ref036">36</xref>].</p>
<p>Since the three segmented ARMA models indicate many of the same change-point locations, we compare the change-points locations for which posterior probabilities are greater than 0.5 in <xref ref-type="fig" rid="pone.0208927.g012">Fig 12</xref>. Among these three models, the ARMA(1,1) model identifies the largest number of change-points and matches more closely with the number and locations of change-points detectable to the eye. Moreover, the ARMA(1,1) model picks up small changes in mean with high posterior probability whereas the AR(1) and MA(1) models missed change-points at some time points where small jumps occured in the data.</p>
<fig id="pone.0208927.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Estimated change-point locations with posterior probability greater than 0.5 for AR(1), MA(1) and ARMA(1,1) model.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g012" xlink:type="simple"/>
</fig>
<p>To determine the best model among these three, we compare these models using the deviance information criterion (DICV). The DICV is defined as: <inline-formula id="pone.0208927.e060"><alternatives><graphic id="pone.0208927.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:mtext>DICV</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0208927.e061"><alternatives><graphic id="pone.0208927.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mover><mml:mrow><mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the mean posterior deviance, <italic>p</italic><sub><italic>v</italic></sub> = <italic>Var</italic>(<italic>D</italic>(<italic>θ</italic>))/2 and deviance <italic>D</italic>(<italic>θ</italic>) = −2lnf(<italic>y</italic>|<italic>θ</italic>) (details of DICV are in [<xref ref-type="bibr" rid="pone.0208927.ref037">37</xref>, <xref ref-type="bibr" rid="pone.0208927.ref038">38</xref>]). The DICV, <inline-formula id="pone.0208927.e062"><alternatives><graphic id="pone.0208927.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mover><mml:mrow><mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <italic>p</italic><sub><italic>v</italic></sub> of these three models are shown in <xref ref-type="table" rid="pone.0208927.t001">Table 1</xref>.</p>
<table-wrap id="pone.0208927.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.t001</object-id>
<label>Table 1</label>
<caption>
<title>DICV of Models.</title>
</caption>
<alternatives>
<graphic id="pone.0208927.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Model</th>
<th align="center">
<inline-formula id="pone.0208927.e063">
<alternatives>
<graphic id="pone.0208927.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0208927.e063" xlink:type="simple"/>
<mml:math display="inline" id="M63">
<mml:mover>
<mml:mrow>
<mml:mi>D</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>θ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="center"><italic>p</italic><sub><italic>v</italic></sub></th>
<th align="center">DICV</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Segmented AR(1) Model</td>
<td align="char" char=".">958.0043</td>
<td align="char" char=".">181306.7</td>
<td align="char" char=".">182264.7</td>
</tr>
<tr>
<td align="center">Segmented MA(1) Model</td>
<td align="char" char=".">509.5514</td>
<td align="char" char=".">253045.4</td>
<td align="char" char=".">253554.9</td>
</tr>
<tr>
<td align="center">Segmented ARMA(1,1) Model</td>
<td align="char" char=".">672.8849</td>
<td align="char" char=".">169945.6</td>
<td align="char" char=".">170618.5</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Here, the segmented ARMA(1,1) model gives lower DICV than the other two models. The lower DICV of the ARMA(1,1) model supports the conclusion that the ARMA(1,1) model is the best of the three.</p>
</sec>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Discussion</title>
<p>In this paper, we have developed a Bayesian change-point segmented ARMA model to segment time series data. The novel features of our approach include: (1) It uses an ARMA model in each segment (2) It uses a highly efficient sampling technique (GGS) to generate samples from a posterior distribution. Results for simulated data and real data show that this model achieves high detection accuracy.</p>
<p>The results we obtain for the well-log data seem reasonable when judged by eye. The posterior probabilities of change-point occurrences of the ARMA(1,1) model are somewhat similar to results previously found in the literature for this data. Ó Ruanaidh and Fitzgerald [<xref ref-type="bibr" rid="pone.0208927.ref034">34</xref>] assumed 13 change-points exist in this data (after removing outliers) but our ARMA(1,1) model identifies 27 change-points (considering posterior probability more than 0.5). They missed some small jumps in the data whereas the ARMA(1,1) model identifies small jumps as well as large jumps. Fearnhead and Clifford [<xref ref-type="bibr" rid="pone.0208927.ref035">35</xref>] inferred 16 change-points but since they did not remove the outliers of the data, the results cannot be directly compared. Fearnhead [<xref ref-type="bibr" rid="pone.0208927.ref036">36</xref>] found too many change-points in their piecewise constant model. They used a random walk sampler and found similar change-points to our ARMA(1,1) model. In addition to the change-points found by Fearnhead [<xref ref-type="bibr" rid="pone.0208927.ref036">36</xref>], the ARMA(1,1) model identifies some significant change-points between time points 1 and 1000 and after 2800 (shown in Figs <xref ref-type="fig" rid="pone.0208927.g013">13</xref> and <xref ref-type="fig" rid="pone.0208927.g014">14</xref>).</p>
<fig id="pone.0208927.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Comparison between the results of a random walk model [<xref ref-type="bibr" rid="pone.0208927.ref036">36</xref>] and our ARMA(1,1) model.</title>
<p>(Left) change-point profiles of random walk model [<xref ref-type="bibr" rid="pone.0208927.ref036">36</xref>]; (centre) change-point profiles of ARMA(1,1) at time points 1 to 1000; (right) change-point profiles of ARMA(1,1) after time point 2800.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g013" xlink:type="simple"/>
</fig>
<fig id="pone.0208927.g014" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0208927.g014</object-id>
<label>Fig 14</label>
<caption>
<title>Change-point locations identified using ARMA(1,1) model displayed with the original well-log data at two different time points.</title>
<p>(Left) change-point locations using ARMA(1,1) model in well-log data at time points 1 to 1000; (right) change-point locations using ARMA(1,1) model in well-log data after time point 2800.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.g014" xlink:type="simple"/>
</fig>
<p>The results of the ARMA(1,1) model are similar to the results reported in Whiteley <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0208927.ref001">1</xref>] but in some time points ARMA(1,1) model shows a higher posterior probability of change-point occurrences.</p>
<p>Overall, this paper has presented a promising new direction for estimation of change-point models by assuming a segment-wise ARMA model. Most of the previous methods discussed in the literature use autoregressive (AR) models in each segment. Adding a moving average component helps to consider the dependence between residual terms which is an advantage over the segmented AR model. Our results obtained using simulated data demonstrate that when the data are generated via an ARMA process, the ARMA model finds more change-points than the AR model, without finding false positives. The ARMA model also finds more change-points in the well log data, but a question remains whether the additional change-points are false positives in this case. As the true locations of change in this data set are unknown, this question cannot be answered definitively. However, we compared the segmented ARMA (1,1) model, segmented AR(1) model and segmented MA (1) model using the deviance information criterion (DICV), and found that the ARMA (1,1) is favoured by this criterion, suggesting the additional change-points reflect a real feature of the data. Since this model assumes the same variance for all segments, it is not suitable for data sets in which different segments have different variance.</p>
</sec>
<sec id="sec016">
<title>Supporting information</title>
<supplementary-material id="pone.0208927.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Details of posterior distribution.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0208927.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.s002" xlink:type="simple">
<label>S2 Appendix</label>
<caption>
<title>Generalized gibbs sampling.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0208927.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.s003" xlink:type="simple">
<label>S3 Appendix</label>
<caption>
<title>Supplementary material A.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0208927.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0208927.s004" xlink:type="simple">
<label>S4 Appendix</label>
<caption>
<title>Supplementary material B.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors are grateful to the Australian Research Council for their support of this project (DP1095849). <bold>Data Source</bold>: The data analysed in this paper is a third party data which was collected by the authors. The data can be obtained from <ext-link ext-link-type="uri" xlink:href="https://rss.onlinelibrary.wiley.com/hub/journal/14679868/series-b-datasets/pre_2016a" xlink:type="simple">https://rss.onlinelibrary.wiley.com/hub/journal/14679868/series-b-datasets/pre_2016a</ext-link> (Vol. 65-4.fearnhead).</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0208927.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Whiteley</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Andrieu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Doucet</surname> <given-names>A</given-names></name>. <source>Bayesian computational methods for inference in multiple change-points models</source>; <year>2011</year>.</mixed-citation>
</ref>
<ref id="pone.0208927.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Carlin</surname> <given-names>BP</given-names></name>, <name name-style="western"><surname>Gelfand</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>AF</given-names></name>. <article-title>Hierarchical Bayesian analysis of changepoint problems</article-title>. <source>Applied statistics</source>. <year>1992</year>; p. <fpage>389</fpage>–<lpage>405</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/2347570" xlink:type="simple">10.2307/2347570</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reeves</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>XL</given-names></name>, <name name-style="western"><surname>Lund</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>QQ</given-names></name>. <article-title>A review and comparison of changepoint detection techniques for climate data</article-title>. <source>Journal of Applied Meteorology and Climatology</source>. <year>2007</year>;<volume>46</volume>(<issue>6</issue>):<fpage>900</fpage>–<lpage>915</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1175/JAM2493.1" xlink:type="simple">10.1175/JAM2493.1</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jensen</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Lütkebohmert</surname> <given-names>C</given-names></name>. <article-title>Change-point models</article-title>. <source>Encyclopedia of Statistics in Quality and Reliability</source>. <year>2007</year>.</mixed-citation>
</ref>
<ref id="pone.0208927.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ko</surname> <given-names>SI</given-names></name>, <name name-style="western"><surname>Chong</surname> <given-names>TT</given-names></name>, <name name-style="western"><surname>Ghosh</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Dirichlet Process Hidden Markov Multiple Change-point Model</article-title>. <source>Bayesian Analysis</source>. <year>2015</year>;<volume>10</volume>(<issue>2</issue>):<fpage>275</fpage>–<lpage>296</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/14-BA910" xlink:type="simple">10.1214/14-BA910</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chernoff</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Zacks</surname> <given-names>S</given-names></name>. <article-title>Estimating the current mean of a normal distribution which is subjected to changes in time</article-title>. <source>The Annals of Mathematical Statistics</source>. <year>1964</year>; p. <fpage>999</fpage>–<lpage>1018</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/aoms/1177700517" xlink:type="simple">10.1214/aoms/1177700517</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>A</given-names></name>. <article-title>A Bayesian approach to inference about a change-point in a sequence of random variables</article-title>. <source>Biometrika</source>. <year>1975</year>;<volume>62</volume>(<issue>2</issue>):<fpage>407</fpage>–<lpage>416</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/biomet/62.2.407" xlink:type="simple">10.1093/biomet/62.2.407</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref008">
<label>8</label>
<mixed-citation publication-type="other" xlink:type="simple">Harlé F, Chatelain F, Gouy-Pailler C, Achard S. Bayesian Model for Multiple Change-points Detection in Multivariate Time Series. arXiv preprint arXiv:14073206. 2014;.</mixed-citation>
</ref>
<ref id="pone.0208927.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Green</surname> <given-names>PJ</given-names></name>. <article-title>Reversible jump Markov chain Monte Carlo computation and Bayesian model determination</article-title>. <source>Biometrika</source>. <year>1995</year>;<volume>82</volume>(<issue>4</issue>):<fpage>711</fpage>–<lpage>732</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/biomet/82.4.711" xlink:type="simple">10.1093/biomet/82.4.711</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chib</surname> <given-names>S</given-names></name>. <article-title>Estimation and comparison of multiple change-point models</article-title>. <source>Journal of econometrics</source>. <year>1998</year>;<volume>86</volume>(<issue>2</issue>):<fpage>221</fpage>–<lpage>241</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0304-4076(97)00115-2" xlink:type="simple">10.1016/S0304-4076(97)00115-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keith</surname> <given-names>JM</given-names></name>. <article-title>Segmenting eukaryotic genomes with the generalized Gibbs sampler</article-title>. <source>Journal of Computational Biology</source>. <year>2006</year>;<volume>13</volume>(<issue>7</issue>):<fpage>1369</fpage>–<lpage>1383</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1089/cmb.2006.13.1369" xlink:type="simple">10.1089/cmb.2006.13.1369</ext-link></comment> <object-id pub-id-type="pmid">17037964</object-id></mixed-citation>
</ref>
<ref id="pone.0208927.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sofronov</surname> <given-names>GY</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Keith</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Kroese</surname> <given-names>DP</given-names></name>. <article-title>Identifying change-points in biological sequences via sequential importance sampling</article-title>. <source>Environmental Modeling &amp; Assessment</source>. <year>2009</year>;<volume>14</volume>(<issue>5</issue>):<fpage>577</fpage>–<lpage>584</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10666-008-9160-8" xlink:type="simple">10.1007/s10666-008-9160-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref013">
<label>13</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Cribben</surname> <given-names>I</given-names></name>. <source>Detecting Dependence Change Points in Multivariate Time Series with Applications in Neuroscience and Finance</source>. <publisher-name>Columbia University</publisher-name>; <year>2012</year>.</mixed-citation>
</ref>
<ref id="pone.0208927.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Punskaya</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Andrieu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Doucet</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fitzgerald</surname> <given-names>WJ</given-names></name>. <article-title>Bayesian curve fitting using MCMC with applications to signal segmentation</article-title>. <source>Signal Processing, IEEE Transactions on</source>. <year>2002</year>;<volume>50</volume>(<issue>3</issue>):<fpage>747</fpage>–<lpage>758</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/78.984776" xlink:type="simple">10.1109/78.984776</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chan</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Tong</surname> <given-names>H</given-names></name>. <article-title>On estimating thresholds in autoregressive models</article-title>. <source>Journal of time series analysis</source>. <year>1986</year>;<volume>7</volume>(<issue>3</issue>):<fpage>179</fpage>–<lpage>190</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1467-9892.1986.tb00501.x" xlink:type="simple">10.1111/j.1467-9892.1986.tb00501.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref016">
<label>16</label>
<mixed-citation publication-type="other" xlink:type="simple">Tong H. On a threshold model. 29. Sijthoff &amp; Noordhoff; 1978.</mixed-citation>
</ref>
<ref id="pone.0208927.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tong</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lim</surname> <given-names>KS</given-names></name>. <article-title>Threshold autoregression, limit cycles and cyclical data</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1980</year>; p. <fpage>245</fpage>–<lpage>292</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.2517-6161.1980.tb01126.x" xlink:type="simple">10.1111/j.2517-6161.1980.tb01126.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref018">
<label>18</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Tong</surname> <given-names>H</given-names></name>. <source>Threshold models in non-linear time series analysis</source>. <volume>vol. 21</volume>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2012</year>.</mixed-citation>
</ref>
<ref id="pone.0208927.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Davis</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>TCM</given-names></name>, <name name-style="western"><surname>Rodriguez-Yam</surname> <given-names>GA</given-names></name>. <article-title>Structural break estimation for nonstationary time series models</article-title>. <source>Journal of the American Statistical Association</source>. <year>2006</year>;<volume>101</volume>(<issue>473</issue>):<fpage>223</fpage>–<lpage>239</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1198/016214505000000745" xlink:type="simple">10.1198/016214505000000745</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wood</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rosen</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Kohn</surname> <given-names>R</given-names></name>. <article-title>Bayesian mixtures of autoregressive models</article-title>. <source>Journal of Computational and Graphical Statistics</source>. <year>2011</year>;<volume>20</volume>(<issue>1</issue>):<fpage>174</fpage>–<lpage>195</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1198/jcgs.2010.09174" xlink:type="simple">10.1198/jcgs.2010.09174</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chakar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lebarbier</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lévy-Leduc</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Robin</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>A robust approach for estimating change-points in the mean of an AR(1) process</article-title>. <source>Bernoulli</source>. <year>2017</year>;<volume>23</volume>(<issue>2</issue>):<fpage>1408</fpage>–<lpage>1447</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3150/15-BEJ782" xlink:type="simple">10.3150/15-BEJ782</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Albert</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Chib</surname> <given-names>S</given-names></name>. <article-title>Bayes inference via Gibbs sampling of autoregressive time series subject to Markov mean and variance shifts</article-title>. <source>Journal of Business &amp; Economic Statistics</source>. <year>1993</year>;<volume>11</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/1391303" xlink:type="simple">10.2307/1391303</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keith</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Stephen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mattick</surname> <given-names>JS</given-names></name>. <article-title>Delineating slowly and rapidly evolving fractions of the Drosophila genome</article-title>. <source>Journal of Computational Biology</source>. <year>2008</year>;<volume>15</volume>(<issue>4</issue>):<fpage>407</fpage>–<lpage>430</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1089/cmb.2007.0173" xlink:type="simple">10.1089/cmb.2007.0173</ext-link></comment> <object-id pub-id-type="pmid">18435570</object-id></mixed-citation>
</ref>
<ref id="pone.0208927.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Metropolis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Rosenbluth</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Teller</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Teller</surname> <given-names>E</given-names></name>. <article-title>Equation of state calculations by fast computing machines</article-title>. <source>The journal of chemical physics</source>. <year>1953</year>;<volume>21</volume>(<issue>6</issue>):<fpage>1087</fpage>–<lpage>1092</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.1699114" xlink:type="simple">10.1063/1.1699114</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hastings</surname> <given-names>WK</given-names></name>. <article-title>Monte Carlo sampling methods using Markov chains and their applications</article-title>. <source>Biometrika</source>. <year>1970</year>;<volume>57</volume>(<issue>1</issue>):<fpage>97</fpage>–<lpage>109</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/biomet/57.1.97" xlink:type="simple">10.1093/biomet/57.1.97</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Geman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Geman</surname> <given-names>D</given-names></name>. <article-title>Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images</article-title>. <source>IEEE Transactions on pattern analysis and machine intelligence</source>. <year>1984</year>;(<issue>6</issue>):<fpage>721</fpage>–<lpage>741</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TPAMI.1984.4767596" xlink:type="simple">10.1109/TPAMI.1984.4767596</ext-link></comment> <object-id pub-id-type="pmid">22499653</object-id></mixed-citation>
</ref>
<ref id="pone.0208927.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Liang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>WH</given-names></name>. <article-title>The multiple-try method and local optimization in Metropolis sampling</article-title>. <source>Journal of the American Statistical Association</source>. <year>2000</year>;<volume>95</volume>(<issue>449</issue>):<fpage>121</fpage>–<lpage>134</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/01621459.2000.10473908" xlink:type="simple">10.1080/01621459.2000.10473908</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mira</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>On Metropolis-Hastings algorithms with delayed rejection</article-title>. <source>Metron</source>. <year>2001</year>;<volume>59</volume>(<issue>3-4</issue>):<fpage>231</fpage>–<lpage>241</lpage>.</mixed-citation>
</ref>
<ref id="pone.0208927.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keith</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Kroese</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Bryant</surname> <given-names>D</given-names></name>. <article-title>A generalized Markov sampler</article-title>. <source>Methodology and Computing in Applied Probability</source>. <year>2004</year>;<volume>6</volume>(<issue>1</issue>):<fpage>29</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/B:MCAP.0000012414.14405.15" xlink:type="simple">10.1023/B:MCAP.0000012414.14405.15</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Oldmeadow</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mengersen</surname> <given-names>Kerrie</given-names></name>, <name name-style="western"><surname>Mattick</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Keith</surname> <given-names>JM</given-names></name>. <article-title>Multiple evolutionary rate classes in animal genome evolution</article-title>. <source>Molecular biology and evolution</source>. <year>2009</year>;<volume>27</volume>(<issue>4</issue>):<fpage>942</fpage>–<lpage>953</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/msp299" xlink:type="simple">10.1093/molbev/msp299</ext-link></comment> <object-id pub-id-type="pmid">19955480</object-id></mixed-citation>
</ref>
<ref id="pone.0208927.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keith</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Spring</surname> <given-names>D</given-names></name>. <article-title>Agent-based Bayesian approach to monitoring the progress of invasive species eradication programs</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>33</issue>):<fpage>13428</fpage>–<lpage>13433</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1216146110" xlink:type="simple">10.1073/pnas.1216146110</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Neal</surname> <given-names>RM</given-names></name>. <article-title>Slice sampling</article-title>. <source>Annals of statistics</source>. <year>2003</year>; p. <fpage>705</fpage>–<lpage>741</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/aos/1056562461" xlink:type="simple">10.1214/aos/1056562461</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cook</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <article-title>Validation of software for Bayesian models using posterior quantiles</article-title>. <source>Journal of Computational and Graphical Statistics</source>. <year>2006</year>;<volume>15</volume>(<issue>3</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1198/106186006X136976" xlink:type="simple">10.1198/106186006X136976</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref034">
<label>34</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ó Ruanaidh</surname> <given-names>JJK</given-names></name>, <name name-style="western"><surname>Fitzgerald</surname> <given-names>WJ</given-names></name>. <source>Numerical bayesian methods applied to signal processing</source>; <year>1996</year>.</mixed-citation>
</ref>
<ref id="pone.0208927.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fearnhead</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Clifford</surname> <given-names>P</given-names></name>. <article-title>On-line inference for hidden Markov models via particle filters</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2003</year>;<volume>65</volume>(<issue>4</issue>):<fpage>887</fpage>–<lpage>899</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/1467-9868.00421" xlink:type="simple">10.1111/1467-9868.00421</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fearnhead</surname> <given-names>P</given-names></name>. <article-title>Exact and efficient Bayesian inference for multiple changepoint problems</article-title>. <source>Statistics and computing</source>. <year>2006</year>;<volume>16</volume>(<issue>2</issue>):<fpage>203</fpage>–<lpage>213</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11222-006-8450-8" xlink:type="simple">10.1007/s11222-006-8450-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0208927.ref037">
<label>37</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <source>Bayesian data analysis</source>. <volume>vol. 2</volume>. <publisher-name>Chapman &amp; Hall/CRC</publisher-name> <publisher-loc>Boca Raton, FL, USA</publisher-loc>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pone.0208927.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sturtz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ligges</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>R2WinBUGS: a package for running WinBUGS from R</article-title>. <source>Journal of Statistical software</source>. <year>2005</year>;<volume>12</volume>(<issue>3</issue>):<fpage>1</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v012.i03" xlink:type="simple">10.18637/jss.v012.i03</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>