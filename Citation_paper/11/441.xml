<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="pmc">plosone</journal-id>
      <journal-title-group>
        <journal-title>PLoS ONE</journal-title>
      </journal-title-group>
      <issn pub-type="epub">1932-6203</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PONE-D-12-24115</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pone.0054050</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Anatomy and physiology</subject>
            <subj-group>
              <subject>Neurological system</subject>
              <subj-group>
                <subject>Nervous system components</subject>
                <subject>Neural pathways</subject>
                <subject>Neuroanatomy</subject>
                <subject>Synapses</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Computational neuroscience</subject>
              <subj-group>
                <subject>Circuit models</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Model organisms</subject>
            <subj-group>
              <subject>Animal models</subject>
              <subj-group>
                <subject>Caenorhabditis elegans</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Neuroscience</subject>
            <subj-group>
              <subject>Cellular neuroscience</subject>
              <subj-group>
                <subject>Neuronal morphology</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Computational neuroscience</subject>
              <subj-group>
                <subject>Circuit models</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Neuroanatomy</subject>
              <subj-group>
                <subject>Connectomics</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Neural networks</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Computer applications</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Physiology</subject>
          <subject>Computational Biology</subject>
          <subject>Neuroscience</subject>
          <subject>Computer Science</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Computer Assisted Assembly of Connectomes from Electron Micrographs: Application to <italic>Caenorhabditis elegans</italic></article-title>
        <alt-title alt-title-type="running-head">Software for Connectomics</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Xu</surname>
            <given-names>Meng</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Jarrell</surname>
            <given-names>Travis A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Wang</surname>
            <given-names>Yi</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Cook</surname>
            <given-names>Steven J.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Hall</surname>
            <given-names>David H.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Emmons</surname>
            <given-names>Scott W.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <label>1</label>
        <addr-line>Department of Genetics, Albert Einstein College of Medicine, Bronx, New York, United States of America</addr-line>
      </aff>
      <aff id="aff2">
        <label>2</label>
        <addr-line>Dominick P. Purpura Department of Neuroscience, Albert Einstein College of Medicine, Bronx, New York, United States of America</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Gómez</surname>
            <given-names>Sergio</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>Universitat Rovira i Virgili, Spain</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">scott.emmons@einstein.yu.edu</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: MX TAJ YW SJC DHH SWE. Performed the experiments: MX TAJ SJC SWE. Analyzed the data: TAJ SJC SWE. Wrote the paper: SWE.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <year>2013</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>16</day>
        <month>1</month>
        <year>2013</year>
      </pub-date>
      <volume>8</volume>
      <issue>1</issue>
      <elocation-id>e54050</elocation-id>
      <history>
        <date date-type="received">
          <day>11</day>
          <month>8</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>5</day>
          <month>12</month>
          <year>2012</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2013</copyright-year>
        <copyright-holder>Xu et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>A rate-limiting step in determining a connectome, the set of all synaptic connections in a nervous system, is extraction of the relevant information from serial electron micrographs. Here we introduce a software application, Elegance, that speeds acquisition of the minimal dataset necessary, allowing the discovery of new connectomes. We have used Elegance to obtain new connectivity data in the nematode worm <italic>Caenorhabditis elegans</italic>. We analyze the accuracy that can be obtained, which is limited by unresolvable ambiguities at some locations in electron microscopic images. Elegance is useful for reconstructing connectivity in any region of neuropil of sufficiently small size.</p>
      </abstract>
      <funding-group>
        <funding-statement>This work was supported by the United States National Institutes of Health (NIH.gov)(R21MH63223 to SWE)and the G. Harold and Leila Y. Mathers Charitable Foundation (mathersfoundation.org) to SWE. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="6"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>The neural circuits that create the functions of the nervous system arise from the patterns of synaptic connections between the neurons. The size of the sub-cellular structures that define synaptic contacts (synaptic densities, synaptic vesicles, and gap junctions) as well as the tiny diameter of many neurite processes (50 nm), necessitates the use of high-resolution electron microscopy of ultra-thin serial sections for a dense reconstruction. In the late 1960’s, Sydney Brenner sought to overcome the discrepancy in scale between the capabilities of electron microscopy and the typical nervous system by selecting an animal that was tiny, simple, and regular enough to allow for a complete reconstruction <xref ref-type="bibr" rid="pone.0054050-Brenner1">[1]</xref>. The efforts of the Brenner group resulted in the first complete animal connectome, the wiring diagram of the 302-neuron nervous system of the <italic>C. elegans</italic> adult hermaphrodite <xref ref-type="bibr" rid="pone.0054050-White1">[2]</xref>, <xref ref-type="bibr" rid="pone.0054050-Varshney1">[3]</xref>. This wiring diagram, fundamental to <italic>C. elegans</italic> research, has made possible genetic and molecular analysis of behavior in the context of known connectivity, a circumstance unique to this organism. The connectome reveals the type of every neural cell (sensory, interneuron, motor neuron) and has allowed circuit-level analysis of several worm behaviors (<italic>e.g.</italic> <xref ref-type="bibr" rid="pone.0054050-Gray1">[4]</xref>–<xref ref-type="bibr" rid="pone.0054050-Ha1">[8]</xref>).</p>
      <p>The methodology used by the Brenner group involved marking paper prints of electron micrographs with colored pens to follow neurites through thousands of images, after which lists of synaptic contacts were written down and maps drawn by hand. The enormous, more than 12 person-year effort has inhibited further attempts at complete reconstructions in <italic>C. elegans</italic> or any other animals. The most labor-intensive and difficult step was analysis of the electron micrographs. In order to make determination of additional connectomes possible, we developed a PC-based software application, Elegance, to expedite this step. Using Elegance, we have determined the connectome of the posterior nervous system of the <italic>C. elegans</italic> adult male and repeated, for comparison, parts of the hermaphrodite connectome <xref ref-type="bibr" rid="pone.0054050-Jarrell1">[9]</xref> (unpublished data available at <ext-link ext-link-type="uri" xlink:href="http://wormwiring.org" xlink:type="simple">http://wormwiring.org</ext-link>). The posterior nervous system of the male, which contains circuits for mating behavior, was attempted by the Brenner group in the 1970’s using their methods, but its size and complexity, due in part to branching neurons, prevented its completion <xref ref-type="bibr" rid="pone.0054050-Sulston1">[10]</xref>. With Elegance, complexity is no longer an issue. The possibility of determining a connectome from an existing electron micrographic series with a reasonable amount of effort now depends solely on the size of the dataset (number of sections, number of neuron profiles and synapses per section), the continuity of the serial stack, and the clarity of the electron micrographic images. The minimally ten-fold increase in speed of annotation and assembly we have achieved brings additional connectomes within feasible range.</p>
      <sec id="s1a">
        <title>Description of Software and Database</title>
        <p>Elegance is a JAVA-based program that facilitates the tracing and reconstruction of neurons and synapses across serial section images (<xref ref-type="fig" rid="pone-0054050-g001">Fig. 1</xref>). The location of a neuron profile in an image is represented by a single point and neuron reconstructions are non-volumetric skeleton diagrams. The physical location of each synapse is recorded along with synapse size. Multiple neurons can be traced simultaneously. To reconstruct a neuron, the locations of structures in images, both neurite profiles and synapses, are entered from the computer screen with the mouse. Coordinates and associated attributes are stored in a MySQL database. From the information in the database tables, Elegance draws 2D and 3D neuron diagrams and generates synapse lists and connectivity (adjacency) matrices (<xref ref-type="fig" rid="pone-0054050-g002">Fig. 2</xref>).</p>
        <fig id="pone-0054050-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0054050.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Elegance screenshot.</title>
            <p>Cell profiles are marked by open blue squares. Different chains of connected objects are labeled with a colored number for ease of recognition. The pink 215 neuron branches between the central and left-hand images. Synapses are marked by red circles.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054050.g001" position="float" xlink:type="simple"/>
        </fig>
        <fig id="pone-0054050-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0054050.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Elegance output.</title>
            <p>A. 2D map of the <italic>C. elegans</italic> neuron LUAL in the adult male <xref ref-type="bibr" rid="pone.0054050-Jarrell1">[9]</xref>. The scale indicates section number (70–90 nm section thickness). The cell body (solid blue box) is in the left lumbar ganglion and is connected through a commissure to a process in the pre-anal ganglion which is dense with synapses. B. Enlargement of a small region of the LUAL map, showing branching architecture and locations of synapses; line thickness indicates synapse size (red: chemical input, magenta: chemical output, green: gap junctions). C. Portion of the adjacency matrix of chemical connectivity in the <italic>C. elegans</italic> male posterior nervous system <xref ref-type="bibr" rid="pone.0054050-Jarrell1">[9]</xref>, generated by Elegance and formatted in Excel. Pre-synaptic neurons to left, post-synaptic neurons at top, connection strength in number of serial sections.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054050.g002" position="float" xlink:type="simple"/>
        </fig>
        <p>The MySQL database populated by Elegance contains two central tables, an Object Table and a Relationship Table. These two tables hold the essential data of the reconstruction, entered by annotating the images with the mouse. In the Object Table, each record contains a numerical identifier for an object and the object’s X, Y, Z (section number) coordinates. An object may denote the approximate centroid of a neurite profile or it may denote a presynaptic density or a gap junction.</p>
        <p>Each record in the Relationship Table, which refers to the Object Table, holds the numerical identifiers of a pair of objects that the user wishes to link together. These may be the objects representing neurite profiles in adjacent images that are part of the same neurite. Or they may be objects identifying a single presynaptic density or gap junction that runs across multiple sections. Elegance uses the Relationship Table to assemble the elements of the connectome. Upon user request, Elegance searches the Relationship Table starting from a specified object to find all the objects linked to it in a continuous chain. For neurite objects, these chains, which are called <italic>contins</italic>, represent the skeleton traces of neurons. For synapse objects, contins represent individual synapses. Elegance assigns to each contin a numerical identifier. These contins, which play a central role in reconstruction using Elegance, are gradually built up as a reconstruction project proceeds until each one represents a complete neuron or a fully annotated synapse.</p>
        <p>In both Object and Relationship Tables, along with the central data, additional fields allow the user to enter further information into the records. The identities of the pre- and postsynaptic neurites, for chemical synapse objects, or connected pairs for gap junctions, are stored in each synapse object record in the Object Table. Additional information includes user identity, date of entry, degree of certainty, membership in a contin, and so forth.</p>
        <p>Elegance is organized to provide three main functions: 1) enter metadata about images, including section number and file locations, into an image database; 2) bring multiple adjacent serial images to the screen with overlays showing previous annotations (<xref ref-type="fig" rid="pone-0054050-g001">Fig. 1</xref>) (Elegance loads multiple adjacent images into RAM to allow fast scrolling through the stack of images with arrow keys); allow the entering of new annotations and store these in a MySQL database; 3) output selected data from the database in one of several formats (<xref ref-type="fig" rid="pone-0054050-g002">Fig. 2</xref>). Multiple projects can be handled simultaneously and multiple users can simultaneously work on a single project. Elegance is a standalone JAVA application running under Windows or Unix operating system. Implementation requires prior installation of the JAVA environment and the MySQL database. The Graphical User Interface templates are derived from ‘JFrame’ and ‘JComponent’ classes, while Windows default display features have been retained for most of the user interfaces. The Application Logic layer contains classes for functional logic, flow control and for supporting the GUI control. This layer adopts Java Advanced Imaging (JAI) API for image handling and processing to render the display and provide better GUI characteristics. It uses J-Connector for connecting to the MySQL database. TIFF and JPEG image formats are supported.</p>
        <p>Elegance has been implemented using a Linux server (2.4 GHz Intel Core 2 Duo processors, 8 GB RAM) running the MySQL database. User terminals are similarly configured. With this configuration 4 users have simultaneously annotated images without slowing the system. The size of a reconstruction, in terms of the number of objects or number of sections involved, is unlimited. Images of 400 MB and 16,000 X 16,000 pixel dimension have been handled. The number of images that can be simultaneously loaded into RAM at each user terminal will depend on the sizes of the images and the amount of RAM. Elegance is open source. The source code, documentation for installing and running the software, and an annotated test dataset are provided as Supplemental Information available at <ext-link ext-link-type="uri" xlink:href="https://wormwiring.org" xlink:type="simple">https://wormwiring.org</ext-link>. Elegance is also available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/Emmonslab" xlink:type="simple">https://github.com/Emmonslab</ext-link>. This laboratory is committed to maintaining the software and is prepared to offer assistance upon request.</p>
      </sec>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <p>Elegance differs from other computer packages for EM image analysis for connectomics in being designed with the sole aim of capturing as quickly as possible the minimum information necessary to obtain neuron maps and a connectivity matrix. With its simple design, a new user can become proficient with 20 min of instruction. In the first phase of reconstruction, in order to trace neurons through a stack each image must be partitioned or segmented into regions corresponding to different neurites. Some computer-assisted approaches segment the image by tracing cell boundaries. Tracing by hand, such as in widely-used Reconstruct <xref ref-type="bibr" rid="pone.0054050-Fiala1">[11]</xref> and TrakEM2 <xref ref-type="bibr" rid="pone.0054050-Cardona1">[12]</xref>, is very slow, while automated approaches have yet to achieve sufficient accuracy and require correction by hand <xref ref-type="bibr" rid="pone.0054050-Macke1">[13]</xref>–<xref ref-type="bibr" rid="pone.0054050-Jain1">[18]</xref>. Skeleton tracing is available in TrakEM2, a more feature-rich application than Elegance, and in KNOSSOS, which does not support scoring of synapses <xref ref-type="bibr" rid="pone.0054050-Cardona1">[12]</xref>, <xref ref-type="bibr" rid="pone.0054050-Helmstaedter1">[19]</xref>.</p>
      <p>In Elegance, the image is segmented by the user placing a single point object at the center of each neurite profile. To facilitate this phase of annotation, Elegance displays three adjacent images side-by-side on the computer screen and combines in a single mouse click the operations of creating a new neurite object and connecting it to an existing neurite object in an adjacent image (<xref ref-type="fig" rid="pone-0054050-g001">Fig. 1</xref>). The user can trace very quickly by scrolling through the image stack in RAM with arrow keys. From the track of points, 2D and 3D skeleton diagrams of the neurons are drawn (<xref ref-type="fig" rid="pone-0054050-g002">Fig. 2</xref>). These neuron maps will accurately reflect the pathways of the neurites provided the image stack is well-registered.</p>
      <p>In the second phase of reconstruction, synapses are annotated in the same way as cell profiles by single point objects. To be useful in modeling network function, the description of a connectome should include not only connectivity but also the strengths of connections. In graph theoretic terms, in which the neurons are nodes or vertices and the synaptic connections are edges, edge weight represents synaptic strength. Elegance annotation records not only the physical location of each synapse, it also allows calculation of synapse size by determining the number of physical sections the presynaptic density or gap junction traverses. Synapse size serves as a morphometric proxy for synapse functional strength <xref ref-type="bibr" rid="pone.0054050-Schikorski1">[20]</xref>. Total morphological strength of synaptic interaction between each pair of cells is obtained by summing over all the synapses between them. Elegance neuron maps indicate the location along the skeleton of the synapses and synaptic partners (<xref ref-type="fig" rid="pone-0054050-g002">Fig. 2A,B</xref>). Elegance also generates lists of synapses and a connectivity matrix (weight adjacency matrix) that gives the total interaction strength for each pair of cells (<xref ref-type="fig" rid="pone-0054050-g002">Fig. 2C</xref>).</p>
      <p>The accuracy of a nervous system reconstruction has two elements: whether the correct continuity and branching structure of the neurites has been obtained, and whether their synaptic interactions have been correctly identified. For the first of these, the ability to obtain perfect neurite architecture from an electron microscopic series is compromised only if the quality of the electron micrographs is poor, if the distance between images in any region is too great (e.g. from missing sections), or if a neurite of thin caliber close to section thickness (in the range 90–30 nm for TEM) runs in or near the plane of sectioning. Absent such difficulties, an accurate reconstruction can be expected.</p>
      <p>Annotation of synaptic interactions has two aspects, identification of synaptic partners and estimation of synaptic strengths. The usefulness of a described connectome for quantitative functional modeling will depend on the accuracy of the weights in the weight adjacency matrix. We found in our <italic>C. elegans</italic> reconstructions that, in contrast to determination of neurite architecture, determination from EM images of synaptic interactions and their strengths is subject to inherent limitations that cannot be resolved unambiguously. These limitations include faint pre-synaptic densities, doubtful post synaptic partners at polyads, and uncertain gap junction structures. For this reason, different individuals annotating the same electron micrographs do not generate identical connectomes.</p>
      <p>To assess the impact of these uncertainties, we compared duplicate reconstructions carried out by separate individuals. This assessment was carried out in the context of our reconstruction of the posterior connectome of the <italic>C. elegans</italic> male. All of the images and adjacency matrices from this study are available through our publication <xref ref-type="bibr" rid="pone.0054050-Jarrell1">[9]</xref>. In a comparison of the duplicate scoring of 119 chemical synapses in the <italic>C. elegans</italic> male, 41% were scored identically―presynaptic density running through the same number of sections, the same post-synaptic partners. Of the remainder, 25% of the total differed in synapse size, 20% of the total differed in a post-synaptic cell, and 14% of the total were annotated by only one of the two people. To estimate how strongly these differences affected the measured weights in the adjacency matrix, we compared three independent reconstructions of a male-specific interneuron, PVX. PVX is connected to 55 neurons via 420 chemical synapses <xref ref-type="bibr" rid="pone.0054050-Jarrell1">[9]</xref>. Differences between the three scores of the 55 edge weights averaged 1–2 sections, and was approximately independent of edge weight (<xref ref-type="fig" rid="pone-0054050-g003">Fig. 3</xref>). Hence the estimated percent uncertainty falls with increasing weight from around 10% for weights of 10 sections or less to 2% for edge weights of 40 sections or more. Similar values are likely to hold for scoring gap junctions.</p>
      <fig id="pone-0054050-g003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054050.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Error in determining connection strength.</title>
          <p>Average and distribution of edge weights (total amount of synaptic interaction) determined by three separate individuals for the 55 edges connecting the male-specific interneuron PVX to its 55 synaptic partners in the <italic>C. elegans</italic> male posterior connectome <xref ref-type="bibr" rid="pone.0054050-Jarrell1">[9]</xref>. Edge weights are represented by the number of 70–90 nm serial sections of pre-synaptic densities. The weights are for a single edge except where indicated. Values of edge weights (abscissa) are the weights assigned by one of the three scorers, arbitrarily chosen. Weight values typically differed by 1 to 2 sections.</p>
        </caption>
        <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054050.g003" position="float" xlink:type="simple"/>
      </fig>
      <p>Does this error rate compromise a useful determination of the connectome? We compared the similarity of the connectivity of the three duplicate annotations of the PVX neuron to the similarity of the connectivity of presumptively equivalent neurons in the same animal. For equivalent cells, we compared left/right homologous neurons <xref ref-type="bibr" rid="pone.0054050-Jarrell1">[9]</xref>. Our duplicate annotations were significantly more similar to each other than the equivalent neuron pairs are to each other (data not shown). Therefore the error in our measured connectome is less than the differences between presumptively equivalent neurons and we can be comfortable that the differences between neurons in our reconstruction are real and not a result of measurement error.</p>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>Under optimal conditions―well-aligned, high quality images and neurons running mostly orthogonal to the plane of section, as for example in the <italic>C. elegans</italic> ventral nerve cord―data points can be entered into Elegance at a rate of 1000 per hr. We reconstructed the <italic>C. elegans</italic> hermaphrodite nerve ring, a more difficult region where neurons run nearly parallel to the plane of section, which required 60,000 objects, at a rate of approximately 600 per hr. These values may be used to estimate the time required for a contemplated reconstruction project in any system. The overall increased speed achieved allowed us to easily complete a new reconstruction of the longest series previously reconstructed for the hermaphrodite connectome (the N2U series, see <xref ref-type="bibr" rid="pone.0054050-White1">[2]</xref>) (unpublished). This project required several months, compared to many years when carried out on paper prints by hand. Moreover, it yielded a more accurate reconstruction including synaptic weights. In a second project, a single individual reconstructed the posterior connectome of the <italic>C. elegans</italic> hermaphrodite from existing electron micrographs (JSE series, see <xref ref-type="bibr" rid="pone.0054050-White1">[2]</xref>) in 131 hr. Reconstruction of the posterior hermaphrodite connectome had previously occupied an entire PhD thesis project <xref ref-type="bibr" rid="pone.0054050-Hall1">[21]</xref>. These experiences lead us to estimate that Elegance provides at minimum a ten-fold increase in speed over previous methods.</p>
      <p>Reconstructions in <italic>C. elegans</italic> are facilitated by the often unbranched architecture of the neurons and the relatively stable neighborhoods in which they run. Moreover, as <italic>C. elegans</italic> is a worm, many neurons run orthogonal to a transverse sectional plane. However, many do not, and this does not prevent their reconstruction. In certain regions, notably the pre-anal ganglion of the male, <italic>C. elegans</italic> material is highly similar to mammalian neuropil. Mammalian neuropil has been traced from anisotropic TEM image stacks similar to those we have used (5 nm×5 nm×50 nm) <xref ref-type="bibr" rid="pone.0054050-Bock1">[22]</xref>. A simple modification of Elegance for scoring synapse size to accommodate the in-plane dimension can be made by allowing more than one synapse object per synapse per image.</p>
      <p>The speed and simplicity of reconstruction with Elegance makes a more complete and accurate reconstruction possible, while providing the additional information of synapse strength. The quantitative weight adjacency matrix can be analyzed with the many tools of graph and network theory, leading to insights into network organization and function <xref ref-type="bibr" rid="pone.0054050-Jarrell1">[9]</xref>.</p>
      <p>Elegance makes it possible to pursue the long-term goal envisioned by Brenner, to use <italic>C. elegans</italic> to identify the genetic code for a wiring diagram by analyzing presumptive connectivity mutants <xref ref-type="bibr" rid="pone.0054050-Brenner1">[1]</xref>. The post-embryonic L1 larva will require at most one tenth the number of objects as an adult, making its reconstruction feasible in one to two months once a satisfactory set of images is obtained. Comparison of the L1 connectome to those of later larval stages will reveal the process of nervous system growth and synaptogenesis, and allow investigation of whether this process is influenced by experience and learning in <italic>C. elegans</italic>. Studies of this type may be undertaken in any organism comparable in size to <italic>C. elegans</italic> or for any small region of the brain.</p>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank Hannes Buelow for his comments on the manuscript. The initial version of Elegance was written by Metahelix Life Sciences, LTD., Bangalore, India. We are grateful to R. Ramanan for his guidance in obtaining software support.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pone.0054050-Brenner1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brenner</surname><given-names>S</given-names></name> (<year>1974</year>) <article-title>The genetics of <italic>Caenorhabditis elegans</italic></article-title>. <source>Genetics</source> <volume>77</volume>: <fpage>71</fpage>–<lpage>94</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-White1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Southgate</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Thomson</surname><given-names>JN</given-names></name>, <name name-style="western"><surname>Brenner</surname><given-names>S</given-names></name> (<year>1986</year>) <article-title>The structure of the nervous system of the nematode <italic>Caenorhabditis elegans</italic></article-title>. <source>Philosophical Transactions of the Royal Society, Series B Biological Sciences</source> <volume>314</volume>: <fpage>1</fpage>–<lpage>340</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Varshney1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Varshney</surname><given-names>LR</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>BL</given-names></name>, <name name-style="western"><surname>Paniagua</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Hall</surname><given-names>DH</given-names></name>, <name name-style="western"><surname>Chklovskii</surname><given-names>DB</given-names></name> (<year>2011</year>) <article-title>Structural properties of the <italic>Caenorhabditis elegans</italic> neuronal network</article-title>. <source>PLoS Computational Biology</source> <volume>7</volume>: <fpage>e1001066</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Gray1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gray</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Hill</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Bargmann</surname><given-names>CI</given-names></name> (<year>2005</year>) <article-title>A circuit for navigation in <italic>Caenorhabditis elegans</italic></article-title>. <source>PNAS</source> <volume>102</volume>: <fpage>3184</fpage>–<lpage>3191</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Chalfie1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chalfie</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sulston</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>White</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Southgate</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Thomson</surname><given-names>JN</given-names></name>, <etal>et al</etal>. (<year>1985</year>) <article-title>The neural circuit for touch sensitivity in <italic>Caenorhabditis elegans</italic></article-title>. <source>The Journal of Neuroscience</source> <volume>5</volume>: <fpage>956</fpage>–<lpage>964</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Bargmann1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bargmann</surname><given-names>CI</given-names></name>, <name name-style="western"><surname>Hartwieg</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Horvitz</surname><given-names>HR</given-names></name> (<year>1993</year>) <article-title>Odorant-selective genes and neurons mediate olfaction in C. elegans</article-title>. <source>Cell</source> <volume>74</volume>: <fpage>515</fpage>–<lpage>527</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Mori1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mori</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Ohshima</surname><given-names>Y</given-names></name> (<year>1995</year>) <article-title>Neural regulation of thermotaxis in Caenorhabditis elegans</article-title>. <source>Nature</source> <volume>376</volume>: <fpage>344</fpage>–<lpage>348</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Ha1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ha</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Hendricks</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Shen</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Gabel</surname><given-names>CV</given-names></name>, <name name-style="western"><surname>Fang-Yen</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Functional organization of a neural network for aversive olfactory learning in <italic>Caenorhabditis elegans</italic></article-title>. <source>Neuron</source> <volume>68</volume>: <fpage>1173</fpage>–<lpage>1186</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Jarrell1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jarrell</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Bloniarz</surname><given-names>AE</given-names></name>, <name name-style="western"><surname>Brittin</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Xu</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The connectome of a decision-making neural network</article-title>. <source>Science</source> <volume>337</volume>: <fpage>437</fpage>–<lpage>444</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Sulston1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sulston</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Albertson</surname><given-names>DG</given-names></name>, <name name-style="western"><surname>Thomson</surname><given-names>JN</given-names></name> (<year>1980</year>) <article-title>The <italic>Caenorhabditis elegans</italic> male: postembryonic development of nongonadal structures</article-title>. <source>Dev Biol</source> <volume>78</volume>: <fpage>542</fpage>–<lpage>576</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Fiala1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fiala</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Harris</surname><given-names>KM</given-names></name> (<year>2002</year>) <article-title>Computer-based alignment and reconstruction of serial sections Microscopy and Analysis, USA Ed</article-title>. <volume>52</volume>: <fpage>5</fpage>–<lpage>7</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Cardona1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cardona</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Saalfeld</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Preibisch</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Schmid</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>An Integrated micro- and macroarchitectural analysis of the <italic>Drosophila</italic> brain by computer-assisted serial section electron microscopy</article-title>. <source>PLoS Biol</source> <volume>8</volume>: <fpage>e1000502</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Macke1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Macke</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Maack</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Gupta</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Denk</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Schölkopf</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Contour-propagation algorithms for semi-automated reconstruction of neural processes</article-title>. <source>Journal of Neuroscience Methods</source> <volume>167</volume>: <fpage>349</fpage>–<lpage>357</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Jeong1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jeong</surname><given-names>W-K</given-names></name>, <name name-style="western"><surname>Beyer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hadwiger</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Vazquez</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Pfister</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Scalable and interactive segmentation and visualization of neural processes in EM datasets</article-title>. <source>IEEE Transactions on Visualization and Computer Graphics</source> <volume>15</volume>: <fpage>1505</fpage>–<lpage>1514</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Jeong2">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jeong</surname><given-names>W-K</given-names></name>, <name name-style="western"><surname>Beyer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hadwiger</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Blue</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Law</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Ssecrett and NeuroTrace: Interactive visualization and analysis tools for large-scale neuroscience data sets</article-title>. <source>IEEE Computer Graphics Applications</source> <volume>30</volume>: <fpage>58</fpage>–<lpage>70</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Mishchenko1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mishchenko</surname><given-names>Y</given-names></name> (<year>2009</year>) <article-title>Automation of 3D reconstruction of neural tissue from large volume of conventional serial section transmission electron micrographs</article-title>. <source>Journal of Neuroscience Methods</source> <volume>176</volume>: <fpage>276</fpage>–<lpage>289</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Chklovskii1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chklovskii</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Vitaladevuni</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Scheffer</surname><given-names>LK</given-names></name> (<year>2010</year>) <article-title>Semi-automated reconstruction of neural circuits using electron microscopy</article-title>. <source>Current Opinion in Neurobiology</source> <volume>20</volume>: <fpage>667</fpage>–<lpage>675</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Jain1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jain</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Seung</surname><given-names>HS</given-names></name>, <name name-style="western"><surname>Turaga</surname><given-names>SC</given-names></name> (<year>2010</year>) <article-title>Machines that learn to segment images: a crucial technology for connectomics</article-title>. <source>Current Opinion in Neurobiology</source> <volume>20</volume>: <fpage>653</fpage>–<lpage>666</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Helmstaedter1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Helmstaedter</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Briggman</surname><given-names>KL</given-names></name>, <name name-style="western"><surname>Denk</surname><given-names>W</given-names></name> (<year>2011</year>) <article-title>High-accuracy neurite reconstruction for high-throughput neuroanatomy</article-title>. <source>Nature Neuroscience</source> <volume>14</volume>: <fpage>1081</fpage>–<lpage>1088</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Schikorski1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schikorski</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Stevens</surname><given-names>CF</given-names></name> (<year>1997</year>) <article-title>Quantitative ultrastructural analysis of hippocampal excitatory synapses</article-title>. <source>The Journal of Neuroscience</source> <volume>17</volume>: <fpage>5858</fpage>–<lpage>5867</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Hall1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hall</surname><given-names>DH</given-names></name>, <name name-style="western"><surname>Russell</surname><given-names>RL</given-names></name> (<year>1991</year>) <article-title>The posterior nervous system of the nematode <italic>Caenorhabditis elegans</italic>: Serial reconstruction of identified neurons and complete pattern of synaptic interactions</article-title>. <source>The Journal of Neuroscience</source> <volume>11</volume>: <fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054050-Bock1">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bock</surname><given-names>DD</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>W-CA</given-names></name>, <name name-style="western"><surname>Kerlin</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Andermann</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Hood</surname><given-names>G</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Network anatomy and in vivo physiology of visual cortical neurons</article-title>. <source>Nature</source> <volume>471</volume>: <fpage>177</fpage>–<lpage>182</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>