<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-11-09530</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0026105</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Biophysics</subject>
            <subj-group>
              <subject>Biomacromolecule-ligand interactions</subject>
              <subject>Biophysics theory</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
              <subj-group>
                <subject>Functional genomics</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Molecular genetics</subject>
              <subj-group>
                <subject>Gene expression</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Biophysic al simulations</subject>
              <subject>Regulatory networks</subject>
              <subject>Sequence analysis</subject>
              <subject>Systems biology</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genetics</subject>
            <subj-group>
              <subject>Gene expression</subject>
              <subj-group>
                <subject>DNA transcription</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Molecular cell biology</subject>
            <subj-group>
              <subject>Gene expression</subject>
              <subj-group>
                <subject>DNA transcription</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Theoretical biology</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability theory</subject>
            <subj-group>
              <subject>Bayes theorem</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Physics</subject>
          <subj-group>
            <subject>Biophysics</subject>
            <subj-group>
              <subject>Biomacromolecule-ligand interactions</subject>
              <subject>Biophysics simulations</subject>
              <subject>Biophysics theory</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Molecular Biology</subject>
          <subject>Computational Biology</subject>
          <subject>Biophysics</subject>
          <subject>Physics</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories><title-group><article-title>Bayesian Analysis of High-Throughput Quantitative Measurement of Protein-DNA Interactions</article-title><alt-title alt-title-type="running-head">Bayesian Analysis of Protein-DNA Binding Affinity</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Pollock</surname>
            <given-names>David D.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>de Koning</surname>
            <given-names>A. P. Jason</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Kim</surname>
            <given-names>Hyunmin</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Castoe</surname>
            <given-names>Todd A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Churchill</surname>
            <given-names>Mair E. A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Kechris</surname>
            <given-names>Katerina J.</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Biochemistry and Molecular Genetics, University of Colorado School of Medicine, Aurora, Colorado, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Pharmacology, University of Colorado School of Medicine, Aurora, Colorado, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Department of Biostatistics and Informatics, Colorado School of Public Health, Aurora, Colorado, United States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Liberles</surname>
            <given-names>David</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University of Wyoming, United States of America</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">David.Pollock@UCDenver.edu</email></corresp>
        <fn fn-type="con">
          <p>Performed the experiments: DDP APJdK HK. Analyzed the data: DDP APJdK HK KK. Contributed reagents/materials/analysis tools: DDP MEAC. Wrote the paper: DDP APJdK KJK. Conceived and designed the study: DDP KJK TAC MEAC. Wrote novel programs to analyze the data: APJdK HK. Revised the manuscript critically for important intellectual content: DDP KJK TAC APJdK MEAC.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <year>2011</year>
      </pub-date><pub-date pub-type="epub">
        <day>1</day>
        <month>11</month>
        <year>2011</year>
      </pub-date><volume>6</volume><issue>11</issue><elocation-id>e26105</elocation-id><history>
        <date date-type="received">
          <day>1</day>
          <month>6</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>19</day>
          <month>9</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Pollock et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Transcriptional regulation depends upon the binding of transcription factor (TF) proteins to DNA in a sequence-dependent manner. Although many experimental methods address the interaction between DNA and proteins, they generally do not comprehensively and accurately assess the full binding repertoire (the complete set of sequences that might be bound with at least moderate strength). Here, we develop and evaluate through simulation an experimental approach that allows simultaneous high-throughput quantitative analysis of TF binding affinity to thousands of potential DNA ligands. Tens of thousands of putative binding targets can be mixed with a TF, and both the pre-bound and bound target pools sequenced. A hierarchical Bayesian Markov chain Monte Carlo approach determines posterior estimates for the dissociation constants, sequence-specific binding energies, and free TF concentrations. A unique feature of our approach is that dissociation constants are jointly estimated from their inferred degree of binding and from a model of binding energetics, depending on how many sequence reads are available and the explanatory power of the energy model. Careful experimental design is necessary to obtain accurate results over a wide range of dissociation constants. This approach, which we call Simultaneous Ultra high-throughput Ligand Dissociation EXperiment (SULDEX), is theoretically capable of rapid and accurate elucidation of an entire TF-binding repertoire.</p>
      </abstract><funding-group><funding-statement>The authors acknowledge the support of the National Institutes of Health (R01, GM083127) and University of Colorado setup funds to DDP. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="15"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Transcription is one of the most important control points for gene expression and is regulated in eukaryotes through multiple layers of control <xref ref-type="bibr" rid="pone.0026105-Carey1">[1]</xref>. Sequence-specific DNA binding transcription factors (TFs) bind to specific genomic sites in promoters and enhancers, recruit additional proteins to achieve opening of chromatin, and ultimately assemble and activate RNA polymerase II pre-initiation complexes. Such transcription factor binding sites (TFBS) are essential to organismal function, yet there are substantial limitations in our current ability to predict the location and function of these elements <xref ref-type="bibr" rid="pone.0026105-Friberg1">[2]</xref>–<xref ref-type="bibr" rid="pone.0026105-Stepanova1">[8]</xref>. In addition, mutations in regulatory sequences can easily alter transcription rates <xref ref-type="bibr" rid="pone.0026105-Gibson1">[9]</xref>, <xref ref-type="bibr" rid="pone.0026105-Carroll1">[10]</xref>, leading to the evolution of novel phenotypes, but the effects of TFBS mutations on transcription are generally unpredictable. This unpredictability exists partly because measuring TF-TFBS binding affinities in a high-throughput way remains problematic <xref ref-type="bibr" rid="pone.0026105-Maerkl1">[11]</xref>, and the number of large and accurate binding datasets remains few <xref ref-type="bibr" rid="pone.0026105-Zykovich1">[12]</xref>, <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>. To better understand the functional role of TF and TFBS interactions that contribute to altering gene regulation, methods capable of estimating such effects in a probabilistic and high-throughput manner are an important area of research. Here we focus on developing and testing a method that can be applied in a high-throughput fashion to estimate the binding affinities of TFs to their cognate TFBSs. Transcription is a process driven by the biophysics of these interactions, and thus they are often viewed as a necessary component to understanding transcription and biological networks <xref ref-type="bibr" rid="pone.0026105-Maerkl1">[11]</xref>, <xref ref-type="bibr" rid="pone.0026105-Lassig1">[14]</xref>–<xref ref-type="bibr" rid="pone.0026105-Bulyk3">[24]</xref>. Our aim is that this Bayesian method should work for both strong and moderate binding relationships while taking into account the biophysical properties of these interactions.</p>
      <p>A number of approaches have been developed to characterize details of how TFs bind to their cognate TFBSs. Established methods like SELEX and its high-throughput extensions <xref ref-type="bibr" rid="pone.0026105-Jolma1">[25]</xref> are, however, biased towards the highest affinity TFBSs. Other methods, relying on technologies such as electrophoretic mobility shift assays (EMSA), luciferase constructs, and proximity ligation analysis are labor-intensive or low throughput, and are typically used only to examine the affinity of variants of a known consensus binding site <xref ref-type="bibr" rid="pone.0026105-Liu1">[26]</xref>–<xref ref-type="bibr" rid="pone.0026105-Gustafsdottir1">[29]</xref>. While protein-DNA binding microarrays (PBM) are a quite useful high-throughput technology that assesses binding of transcription factors to double-stranded DNA microarrays <xref ref-type="bibr" rid="pone.0026105-Bulyk2">[22]</xref>, <xref ref-type="bibr" rid="pone.0026105-Mukherjee1">[30]</xref>–<xref ref-type="bibr" rid="pone.0026105-Warren2">[33]</xref> <xref ref-type="bibr" rid="pone.0026105-Badis1">[31]</xref>–<xref ref-type="bibr" rid="pone.0026105-Warren2">[33]</xref>, PBMs make mostly qualitative measurements <xref ref-type="bibr" rid="pone.0026105-Choi1">[18]</xref>–<xref ref-type="bibr" rid="pone.0026105-Bulyk3">[24]</xref>. PBMs are also highly susceptible to inaccuracies due to loss of weakly bound material <xref ref-type="bibr" rid="pone.0026105-Maerkl1">[11]</xref>, while more accurate microfluidic devices <xref ref-type="bibr" rid="pone.0026105-Maerkl1">[11]</xref> rely on specialized equipment. Other popular methods utilize chromatin immunoprecipitation (ChIP) followed by microarrays (ChIP-chip) to provide low resolution information on in vivo transcription factor occupancy, and this approach has been successfully employed for most of the known yeast TFs <xref ref-type="bibr" rid="pone.0026105-Harbison1">[34]</xref>, <xref ref-type="bibr" rid="pone.0026105-MacIsaac1">[35]</xref> using microarrays of all intergenic regions. Higher resolution methods are now available based on ChIP followed by high density tiling arrays <xref ref-type="bibr" rid="pone.0026105-Borneman1">[36]</xref>, by sequencing of DNA using paired-end diTAG, ChIP-PET, <xref ref-type="bibr" rid="pone.0026105-Wei1">[37]</xref> or by direct next generation sequencing of ChIP products, <xref ref-type="bibr" rid="pone.0026105-Robertson1">[38]</xref>, <xref ref-type="bibr" rid="pone.0026105-Johnson1">[39]</xref>. Limitations of ChIP-based methods are, however, that condition-specific protein binding can result in low enrichment and that it can be difficult to distinguish direct from indirect binding <xref ref-type="bibr" rid="pone.0026105-Bulyk2">[22]</xref>.</p>
      <p>To generalize and extend characterization of measurement-based estimates of TF and TFBS affinities, position weight matrices (PWMs) have been used to summarize binding preferences so that new sequences can be scored for their potential to bind a specific TF. The PWM is based on nucleotide frequencies at each position, assuming each position contributes independently to the overall binding energy of the DNA-protein complex <xref ref-type="bibr" rid="pone.0026105-Stormo1">[40]</xref>. This approximation is correct when the TF is at extremely low concentration. The seminal work of Berg and von Hippel <xref ref-type="bibr" rid="pone.0026105-Berg1">[41]</xref> related biophysical models of binding to the information content of the nucleotide frequencies used to construct the PWMs. Since then, biophysical models for DNA-protein interactions have been used to estimate binding affinities for a TF to genomic sequences given a PWM <xref ref-type="bibr" rid="pone.0026105-Granek1">[42]</xref>–<xref ref-type="bibr" rid="pone.0026105-vanOeffelen1">[46]</xref>. Several methods have been developed to estimate the energy terms in the biophysical model directly through high-throughput studies such as ChIP-chip and PBM <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>, <xref ref-type="bibr" rid="pone.0026105-Djordjevic1">[47]</xref>–<xref ref-type="bibr" rid="pone.0026105-Foat1">[50]</xref>. Many of the earlier methods assume low protein concentration <xref ref-type="bibr" rid="pone.0026105-Kinney1">[48]</xref>, <xref ref-type="bibr" rid="pone.0026105-Foat1">[50]</xref> for estimation or saturated occupancy <xref ref-type="bibr" rid="pone.0026105-Djordjevic1">[47]</xref>. More recently the BayesPI <xref ref-type="bibr" rid="pone.0026105-Wang2">[49]</xref> and BEEML <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref> methods have introduced models without these constraints.</p>
      <p>In this paper, we introduce what we call a “Simultaneous Ultra-high throughput Ligand Dissociation Experiment”, or SULDEX. To evaluate dissociation constants, this approach utilizes high-throughput sequencing to count the relative numbers of short synthetic duplex DNA segments (ds-oligos) in solution before and after binding to a transcription factor. The goal of SULDEX is to: 1) simultaneously measure the relative binding abilities of large numbers of ds-oligos; 2) construct a biophysical binding model that can predict the energies of binding (and therefore the dissociation constants); and 3) integrate individual count-based binding estimates with model-based predictions informed by the entire repertoire; this allows better predictions of binding affinities when the frequencies of particular ds-oligos are low (either before or after binding). The SULDEX method is a Bayesian approach in which we apply Markov chain Monte Carlo (MCMC) methodology to obtain full posterior distributions of our unknown quantities.</p>
      <p>SULDEX is comparable to two recently introduced techniques, Bind-n-Seq <xref ref-type="bibr" rid="pone.0026105-Zykovich1">[12]</xref> and HT-SELEX <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>, which utilize similar information. In contrast to SULDEX, the Bind-n-Seq approach <xref ref-type="bibr" rid="pone.0026105-Zykovich1">[12]</xref> is designed to obtain approximate binding motifs that were previously unknown. As we demonstrate below, the Bind-n-Seq experimental design leads to data with undesirable qualities in terms of accurately measuring dissociation constants or binding energies. HT-SELEX <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref> has more similar goals to ours, but is a maximum likelihood approach, and does not allow flexible assessment of binding model accuracy in the way that SULDEX does. Also, in contrast to these existing approaches, we incorporate into our method a means of predicting ds-oligo frequencies in the pre-bound solution. This is often critical for accurate results as these frequencies can easily vary by many orders of magnitude, even in cases where the nucleotide synthesis was designed to create equal ds-oligo frequencies. Furthermore, our method allows incorporation of multiple reference ds-oligos with known binding energies to obtain accurate dissociation constants in the absence of a good energy model. We evaluate the utility of our method using data simulated for ds-oligos with known dissociation constants for the Leu3 and ArcA transcription factors <xref ref-type="bibr" rid="pone.0026105-Liu1">[26]</xref>, <xref ref-type="bibr" rid="pone.0026105-Wang1">[28]</xref>, and Zif268 data from a Bind-n-Seq experiment <xref ref-type="bibr" rid="pone.0026105-Zykovich1">[12]</xref>. Our results suggest that our Bayesian method can be used to accurately and precisely predict TF-TFBS binding affinities across a broad range of binding specificities. In addition to developing and testing our method, we provide extended focus on the interaction of experimental design with theoretical considerations.</p>
    </sec>
    <sec id="s2" sec-type="methods">
      <title>Methods</title>
      <sec id="s2a">
        <title>Transcription factor binding</title>
        <p>The binding interaction between a transcription factor, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e001" xlink:type="simple"/></inline-formula>, and a specific DNA sequence, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e002" xlink:type="simple"/></inline-formula>, can be described by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e003" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e004" xlink:type="simple"/></inline-formula> is the complex of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e005" xlink:type="simple"/></inline-formula> bound to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e006" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e007" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e008" xlink:type="simple"/></inline-formula> are sequence-dependent rate constants of association of the components and dissociation of the complex, respectively (also sometimes known respectively as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e010" xlink:type="simple"/></inline-formula>). If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e011" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e012" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e013" xlink:type="simple"/></inline-formula> are the concentrations in solution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e014" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e015" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e016" xlink:type="simple"/></inline-formula>, respectively, then at equilibrium, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e017" xlink:type="simple"/></inline-formula> by definition. If we define the equilibrium constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e018" xlink:type="simple"/></inline-formula>, the proportion of the sequence that is bound at any point in time is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e019" xlink:type="simple"/><label>(2)</label></disp-formula>This relationship is at the basis of most methods for determining <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e020" xlink:type="simple"/></inline-formula>. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e021" xlink:type="simple"/></inline-formula> can be related to the standard free energies of binding, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e022" xlink:type="simple"/></inline-formula>, using the relationship <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e023" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e024" xlink:type="simple"/></inline-formula> is the ideal gas constant and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e025" xlink:type="simple"/></inline-formula> is the temperature (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e026" xlink:type="simple"/></inline-formula>). We note that this formula can be rearranged to derive a “chemical potential”, as in <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>, <xref ref-type="bibr" rid="pone.0026105-Djordjevic1">[47]</xref>, <xref ref-type="bibr" rid="pone.0026105-Gerland1">[51]</xref>, but this is not necessary. Also, we do not assume that there is an unvarying non-specific binding component that is not specific to the sequence, as in <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>.</p>
        <p>In the SULDEX protocol, many sequences are mixed together in solution, and rather than measuring the proportion of a specific sequence bound, one measures the relative proportion of different sequences in both the pre-bound (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e027" xlink:type="simple"/></inline-formula>) and the bound mixtures (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e028" xlink:type="simple"/></inline-formula>). Thus, if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e029" xlink:type="simple"/></inline-formula> is the concentration of sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e030" xlink:type="simple"/></inline-formula> in the absence of transcription factors, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e031" xlink:type="simple"/></inline-formula> in the presence of a transcription factor, then we can estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e032" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e033" xlink:type="simple"/></inline-formula>, by sequencing and counting ds-oligos in the respective fractions. Note that we assume here (as is necessary in most experiments) that the frequencies in the bound fraction will not be affected by the purification process. This is probably a good assumption for strong binders, but will become problematic for weaker binders, for which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e034" xlink:type="simple"/></inline-formula> (known in this context as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e035" xlink:type="simple"/></inline-formula>) can be relatively large. We leave detailed consideration of this problem for future research.</p>
        <p>We know that<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e036" xlink:type="simple"/><label>(3)</label></disp-formula>so by substituting this into Eqn. 2 and re-arranging, we can see that if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e037" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e038" xlink:type="simple"/></inline-formula> were known precisely, then the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e039" xlink:type="simple"/></inline-formula> could be estimated as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e040" xlink:type="simple"/><label>(4)</label></disp-formula>It is worth pausing here to note that the probability of binding, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e041" xlink:type="simple"/></inline-formula>, can in theory also be predicted using a partition function, as discussed by Stormo and colleagues <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>. In this context, Equation 3 has the same form as Equation 6 in that work, in which it is viewed as an application of Bayes' Theorem. We do not believe, however, that these two equations are exactly equivalent. One important difference is that here (as discussed in detail later) we model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e042" xlink:type="simple"/></inline-formula> as a free (unknown) parameter. This allows us to avoid the issue of predicting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e043" xlink:type="simple"/></inline-formula> from first principles based on binding energies, conformations, and concentrations of the entire ensemble of sequences in the mix. This also leads to a second important difference, which is that given a known or inferred free <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e044" xlink:type="simple"/></inline-formula>, the probability that each sequence is bound does not depend on the other <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e045" xlink:type="simple"/></inline-formula>. Another way of putting this is that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e046" xlink:type="simple"/></inline-formula> only affect each other through their effect on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e047" xlink:type="simple"/></inline-formula>. As a consequence, our Equation 3 should not be viewed as an application of Bayes' Theorem, but rather a statement of physical transformation such that the relative frequencies of molecules in the bound fraction will depend upon their relative frequencies in the pre-bound fraction multiplied by their probability of binding to the transcription factor, given the concentration of transcription factor available in solution at equilibrium. Furthermore, since this results in relative frequencies, the result of Equation 3 is a relative proportion among the sequences that have been chosen to be compared. In other words, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e048" xlink:type="simple"/></inline-formula> is not a posterior probability, but is instead formally a proportion among sequences considered, and the comparator sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e049" xlink:type="simple"/></inline-formula> in Equation 3 and elsewhere may be summed over any desired subset of the sequences that were in the solutions.</p>
        <p>In theory, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e050" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e051" xlink:type="simple"/></inline-formula> could be estimated as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e052" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e053" xlink:type="simple"/></inline-formula>, where the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e054" xlink:type="simple"/></inline-formula> are the counts in the pre-bound fraction, and the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e055" xlink:type="simple"/></inline-formula> are the counts in the TF-bound fraction. Then, given two known reference <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e056" xlink:type="simple"/></inline-formula>, the two unknowns, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e057" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e058" xlink:type="simple"/></inline-formula>, could be determined by solving the two ds-oligo-specific versions of Eqn. 3 (i.e., two equations with two unknowns). All of the unknown <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e059" xlink:type="simple"/></inline-formula> could subsequently be estimated using these values. In practice, however, it is preferable to take into account the uncertainty in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e060" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e061" xlink:type="simple"/></inline-formula>. We chose to estimate all parameters using Markov chain Monte Carlo estimation under a Bayesian graphical model, described below, which can directly incorporate parameter uncertainty and allow that uncertainty to propagate properly through the conditional relationships. To reduce variance, it is also recommended that the reference sequences should be represented at a high frequency in the pre-bound fraction, and should be strong binders, so that they are highly represented in both the bound and pre-bound fractions. To produce exact reference dissociation constants in the basic binding model, at least two reference sequences are required. We note that with the incorporation of the energy model below, it is not strictly necessary to include reference sequences with known dissociation constants (as demonstrated by Stormo and colleagues<xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>), although without reference dissociation constants only relative binding energies (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e062" xlink:type="simple"/></inline-formula>s) are produced. However, since our goal is to allow the results to depend more heavily on the count-based estimates of dissociation constants (or binding energies) than on the energy model (described below) in cases where the energy model appears to be unreliable, we have included reference sequences in all the analyses presented here, and highly recommend at least two whenever it is possible.</p>
      </sec>
      <sec id="s2b">
        <title>A Bayesian graphical model for basic binding estimation</title>
        <p>The goal of Markov chain Monte Carlo (MCMC) estimation is to estimate the posterior density <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e063" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e064" xlink:type="simple"/></inline-formula> are the free parameters of a generative model and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e065" xlink:type="simple"/></inline-formula> is the data. In the basic binding model (BBM), the data are the set of pre-bound counts <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e066" xlink:type="simple"/></inline-formula> and bound counts <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e067" xlink:type="simple"/></inline-formula>, as well as a set of at least two (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e068" xlink:type="simple"/></inline-formula>) known reference dissociation constants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e069" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>). The parameters are the transcription factor concentration in the bound solution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e070" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e071" xlink:type="simple"/></inline-formula>, the set of pre-bound ds-oligo frequencies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e072" xlink:type="simple"/></inline-formula>, the set of bound ds-oligo frequencies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e073" xlink:type="simple"/></inline-formula>, the set of binding probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e074" xlink:type="simple"/></inline-formula>, the set of dissociation constants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e075" xlink:type="simple"/></inline-formula> = {<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e076" xlink:type="simple"/></inline-formula>} (not including the reference dissociation constants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e077" xlink:type="simple"/></inline-formula>), and the set of binding energies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e078" xlink:type="simple"/></inline-formula>. As frequency vectors, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e079" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e080" xlink:type="simple"/></inline-formula> are constrained by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e081" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e082" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e083" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e084" xlink:type="simple"/></inline-formula>. Due to the dependencies described above and depicted in <xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>, the sets <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e085" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e086" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e087" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e088" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e089" xlink:type="simple"/></inline-formula>, as well as the parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e090" xlink:type="simple"/></inline-formula>, can all be calculated as functions of one another, and there is considerable potential leeway in choosing which parameters are free and which are not. In all implementations of the BBM presented here, we have chosen to model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e091" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e092" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e093" xlink:type="simple"/></inline-formula> as free parameters, and calculated the remaining parameters as functions of these free parameters. We also note that it would not be difficult to include uncertainty about the reference constants (<xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>), but we have not implemented this here.</p>
        <fig id="pone-0026105-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0026105.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Graphical representation of the basic binding model (BBM).</title>
            <p>Observed variables (the pre-bound counts, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e094" xlink:type="simple"/></inline-formula>, the bound counts, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e095" xlink:type="simple"/></inline-formula>, and the reference dissociation constants, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e096" xlink:type="simple"/></inline-formula>) are in filled circles, and unobserved variables (i.e., parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e097" xlink:type="simple"/></inline-formula>) are in hollow circles. Probabilistic dependencies and their directions are shown with solid arrows, while deterministic dependencies are shown with dashed arrows. There is some flexibility in the graphical model as to which parameters are free and which are dependent on the others. In the implementations presented here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e098" xlink:type="simple"/></inline-formula> (thick bordered circles) were allowed to vary in the MCMC analyses, while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e099" xlink:type="simple"/></inline-formula> were calculated from the other parameters.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.g001" xlink:type="simple"/>
        </fig>
        <p>The probabilities of the observed ds-oligo counts in the pre-bound and bound fractions are based on multinomials of the parametric frequencies of each ds-oligo in solution,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e100" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e101" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e102" xlink:type="simple"/></inline-formula>. The log of the likelihood, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e103" xlink:type="simple"/></inline-formula>, in the BBM is thus<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e104" xlink:type="simple"/><label>(6)</label></disp-formula>As is clear from <xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>, Equations 2 and 3, and our choice of free parameters, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e105" xlink:type="simple"/></inline-formula> are calculated as functions of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e106" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e107" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e108" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e109" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e110" xlink:type="simple"/></inline-formula>.</p>
        <p>We note that in this simple model, the main data-based confostraints on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e111" xlink:type="simple"/></inline-formula> (other than the pre-bound and bound counts) arise from the set of known reference dissociation constants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e112" xlink:type="simple"/></inline-formula> that directly affect only the two <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e113" xlink:type="simple"/></inline-formula> corresponding to the reference sequences. The only further constraint on the system is that the free transcription factor concentration in the bound fraction must be less than the total transcription factor concentration, if it is known from, for example, the amount of transcription factor added to the solution (i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e114" xlink:type="simple"/></inline-formula>). It would be straightforward, however, to add further boundary constraints or specify prior knowledge of any of the parameters (whether free or not). For example, the proportion of transcription factor in the unbound and bound fractions might be quantified, there might be error estimates on the reference dissociation constants, and some of the free energies of binding might have been previously predicted in some fashion (see below).</p>
      </sec>
      <sec id="s2c">
        <title>A generative model of binding energy</title>
        <p>It is reasonable to expect that in many cases the accuracy of estimating the frequency of the ds-oligos in the bound solution will be low (due to low counts). The accuracy of many of the calculated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e115" xlink:type="simple"/></inline-formula> may also be low because they are much smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e116" xlink:type="simple"/></inline-formula>, and therefore the probability of binding is close to 1.0 (see Equation 2). The accuracy of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e117" xlink:type="simple"/></inline-formula> estimates will also be low if the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e118" xlink:type="simple"/></inline-formula> are much greater than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e119" xlink:type="simple"/></inline-formula>, and therefore the probability of binding is close to zero. One potential way to improve the situation is to build a generative model of binding energies. It is also of general interest to better understand how binding energies are formed based on independent position effects and interactions among positions.</p>
        <p>The general model we will consider to generate an energy-based <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e120" xlink:type="simple"/></inline-formula> for a specific sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e121" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pone-0026105-g002">Figure 2</xref>) includes positional energy terms relative to the optimal binding energy (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e122" xlink:type="simple"/></inline-formula>); these positional terms are independent (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e123" xlink:type="simple"/></inline-formula>) or interactive (e.g., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e124" xlink:type="simple"/></inline-formula>), and the energy is given by:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e125" xlink:type="simple"/><label>(7)</label></disp-formula>Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e126" xlink:type="simple"/></inline-formula> is an abbreviated way of indicating the position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e127" xlink:type="simple"/></inline-formula>-specific energy of the specific nucleotide (G, A, C, or T) that is found at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e128" xlink:type="simple"/></inline-formula> in sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e129" xlink:type="simple"/></inline-formula>. The independent position-specific energy terms are all zero (for the optimal sequence) or positive (since no sequence-specific binding energies can be lower than the optimum), and there are therefore up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e130" xlink:type="simple"/></inline-formula> different independent energy term parameters. The abbreviation is similar for the pairwise terms, and the ellipses indicate the possibility of higher-order energy terms, although these were not implemented here. The interactive energy terms would be presumed to be zero unless otherwise justified, and constrained such that no sequence has a lower energy than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e131" xlink:type="simple"/></inline-formula>. We use an indicator matrix, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e132" xlink:type="simple"/></inline-formula>, that controls the inclusion of individual energy terms in the model according to their posterior justification using a reversible jump Markov Chain (discussed in more detail below). We note that in the current implementation, the prior is uniform on each possible model. This may be more rigid than is desirable, and it may be a productive area for future research to consider other parameters, for example by including a hyperparameter on the probability that individual energy terms should be included.</p>
        <fig id="pone-0026105-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0026105.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Graphical representation of the generative energy model (GEM).</title>
            <p>As in <xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>, unobserved variables (i.e., parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e133" xlink:type="simple"/></inline-formula>) are in hollow circles, and probabilistic dependencies and their directions are shown with solid arrows, while deterministic dependencies are shown with dashed arrows. The Basic Binding Model (<xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>) is linked as shown. As in <xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>, the free parameters (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e134" xlink:type="simple"/></inline-formula>) are shown with thick-bordered circles, as is the model indicator matrix, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e135" xlink:type="simple"/></inline-formula>. The dependent parameters calculated from the free parameters in the GEM are (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e136" xlink:type="simple"/></inline-formula>), and the other parameters (not shown) are the same as described in <xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.g002" xlink:type="simple"/>
        </fig>
        <p>In the examples here, we also include a random variable term, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e137" xlink:type="simple"/></inline-formula>, which allows for possible sequence-specific error in the generative energy model. Because the individual sequence-specific estimates are included as part of the GEM, this error term allows an automatic transition from the energy model predictions to the BBM predictions if the GEM is inaccurate or if the pre-bound and bound counts are especially accurate for a particular sequence. This variable is modeled as a normal distribution centered around zero and with variance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e138" xlink:type="simple"/></inline-formula>. This is equivalent to stating that for the generative energy model (GEM),<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e139" xlink:type="simple"/><label>(8)</label></disp-formula>Thus, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e140" xlink:type="simple"/></inline-formula> is a free parameter in the model that determines how much the GEM controls the range of credible sequence-specific energies (as opposed to control based on the observed sequence frequencies in the two solutions). We note that if only the additive portion of this model were used, the result would be similar to PWM scores only under the additional constraint of very low concentration of transcription factor <xref ref-type="bibr" rid="pone.0026105-Djordjevic1">[47]</xref>, <xref ref-type="bibr" rid="pone.0026105-Stormo2">[52]</xref>. The log of the likelihood, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e141" xlink:type="simple"/></inline-formula>, in the GEM is thus calculated as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e142" xlink:type="simple"/><label>(10)</label></disp-formula>As shown in <xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref> and <xref ref-type="fig" rid="pone-0026105-g002">2</xref>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e143" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e144" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e145" xlink:type="simple"/></inline-formula> are still freely variable in the GEM. There are, however, two new free parameters in the GEM, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e146" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e147" xlink:type="simple"/></inline-formula>, along with the new set of free energy parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e148" xlink:type="simple"/></inline-formula>, and the freely variable indicator matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e149" xlink:type="simple"/></inline-formula> that controls inclusion of the various energy parameters in the family of GEM models. The dependent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e150" xlink:type="simple"/></inline-formula> parameters in the likelihood calculations for the GEM model (Equation 10) are thus calculated using these new free parameters as well.</p>
      </sec>
      <sec id="s2d">
        <title>A generative sequence model</title>
        <p>In many instances, an experiment may be run in which there are too many ds-oligos synthesized relative to the amount of sequencing carried out, so that the accuracy of estimating the frequency of the ds-oligos in the pre-bound solution is low. In such instances, it may be advisable to build a Markov model of ds-oligo synthesis based on dinucleotide or higher polynucleotide observed frequencies in the pre-bound ds-oligo mix. We used a simple generative sequence model (GSM) whereby, if the ds-oligo was of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e151" xlink:type="simple"/></inline-formula> and the polynucleotide size was length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e152" xlink:type="simple"/></inline-formula>, the GSM-predicted count, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e153" xlink:type="simple"/></inline-formula>, for a particular ds-oligo sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e154" xlink:type="simple"/></inline-formula> was<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e155" xlink:type="simple"/><label>(11)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e156" xlink:type="simple"/></inline-formula> is the probability (in the entire data set) that a ds-oligo will start with the polynucleotide of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e157" xlink:type="simple"/></inline-formula> observed at the start of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e158" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e159" xlink:type="simple"/></inline-formula> is the nucleotide observed at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e160" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e161" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e162" xlink:type="simple"/></inline-formula> is the polynucleotide <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e163" xlink:type="simple"/></inline-formula> of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e164" xlink:type="simple"/></inline-formula> ending at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e165" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e166" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e167" xlink:type="simple"/></inline-formula> is the probability of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e168" xlink:type="simple"/></inline-formula> being observed in the data immefodiately following the observation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e169" xlink:type="simple"/></inline-formula>. As before, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e170" xlink:type="simple"/></inline-formula> is the sum frequency of all observed full-length ds-oligo counts in the pre-bound fraction. The frequency <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e171" xlink:type="simple"/></inline-formula> is included to take into account any beginning terminus bias in the sequence generation probabilities. The graphical representation of this model (<xref ref-type="fig" rid="pone-0026105-g003">Figure 3</xref>) therefore contains two input vectors that determine the sequence: the set of frequencies for all polynucleotides of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e172" xlink:type="simple"/></inline-formula> at the starting position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e173" xlink:type="simple"/></inline-formula>; and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e174" xlink:type="simple"/></inline-formula>, the set of probabilities for each nucleotide given that it is preceded by a particular polynucleotide of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e175" xlink:type="simple"/></inline-formula>. We note that we are treating these frequencies here as highly accurate estimates and not accounting for uncertainty in the estimates; the uncertainty should be negligible as long as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e176" xlink:type="simple"/></inline-formula> is small enough that the number of possible polynucleotides is much less than the total ds-oligo counts (i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e177" xlink:type="simple"/></inline-formula>). As will be clear in the <xref ref-type="sec" rid="s3">results</xref> section, we did not utilize this model in any likelihood analyses in the current study based on our estimate of the lack of applicability of the model to current datasets. Instead, we evaluated the predictive utility of the model and used it to generate sequences for simulation of a full <italic>SULDEX</italic> study. However, the <italic>SULDEX</italic> program is designed to use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e178" xlink:type="simple"/></inline-formula> in place of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e179" xlink:type="simple"/></inline-formula> as needed, or in place of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e180" xlink:type="simple"/></inline-formula> directly (foregoing the multinomial and not treating the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e181" xlink:type="simple"/></inline-formula> as free parameters) if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e182" xlink:type="simple"/></inline-formula> is believed to have negligible error.</p>
        <fig id="pone-0026105-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0026105.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Graphical representation of the generative sequence model GSM.</title>
            <p>Symbols and arrows are as in <xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>. The pre-bound counts, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e183" xlink:type="simple"/></inline-formula>, are given a superscript <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e184" xlink:type="simple"/></inline-formula> to indicate that they are counts for the shorter ds-oligos need for the GSM of size <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e185" xlink:type="simple"/></inline-formula>. The parameter set includes the various polynucleotide probabilities used in the GSM (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e186" xlink:type="simple"/></inline-formula>) as well as the new predicted counts, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e187" xlink:type="simple"/></inline-formula>. In the <italic>SULDEX</italic> program, the GSM can be linked to the BBM (<xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>) using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e188" xlink:type="simple"/></inline-formula> in place of C or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e189" xlink:type="simple"/></inline-formula>, although that was not done in the analyses presented here due to problems with the available datasets.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.g003" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2e">
        <title>Markov chain Monte Carlo estimation</title>
        <p>MCMC runs used the Metropolis-Hastings algorithm <xref ref-type="bibr" rid="pone.0026105-Hastings1">[53]</xref> acceptance ratio:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.e190" xlink:type="simple"/><label>(13)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e191" xlink:type="simple"/></inline-formula> is the proposal density, or the probability of proposing a move to parameter set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e192" xlink:type="simple"/></inline-formula> given a current state of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e193" xlink:type="simple"/></inline-formula>. Symmetric (Gaussian) proposals were used throughout, so that the proposal ratios always cancelled out. Flat, non-informative priors were also used throughout, making the prior ratio also cancel. The acceptance ratio was therefore simply the ratio of likelihoods between the current and proposed parameter states, thus making the posterior distribution equivalent to the likelihood surface.</p>
        <p>Proposal widths were tuned prior to each analysis, yielding an acceptance ratio close to the optimal value of 0.45 for unidimensional proposals <xref ref-type="bibr" rid="pone.0026105-Gelman1">[54]</xref> or around 0.234 for multidimensional proposals <xref ref-type="bibr" rid="pone.0026105-Roberts1">[55]</xref>. Analyses were run several times so that the ratio of within- to between-chain variances could be used to measure convergence (although in practice, running chains for 100,000 generations and excluding the first 10,000 as burn-in was generally adequate).</p>
      </sec>
      <sec id="s2f">
        <title>Reversible jumps in model space</title>
        <p>In GEMs, site-specific energy terms are set to zero (that is, they do not modify the optimum position-specific energy) unless there is strong evidence that a particular nucleotide at a position makes the binding worse. The vector of all energy terms is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e194" xlink:type="simple"/></inline-formula>. It is clear that only a limited number of interactive energy terms may be used in conjunction with the additive energy terms in order to avoid problems with non-identifiability of parameters. Here, we consider only the usage of the additive energy terms, and constrain all interactive energy terms to be zero. We also use an indicator matrix, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e195" xlink:type="simple"/></inline-formula>, which tracks whether an element of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e196" xlink:type="simple"/></inline-formula> is constrained to equal zero in the current state of the model. When implementing the energy model, energy terms are added or removed (made equal to zero) using Green's reversible jump MCMC (RJMCMC) approach <xref ref-type="bibr" rid="pone.0026105-Green1">[56]</xref>, which is generally used to switch between parameter spaces with different dimension sizes. All dimensional jumps increase or decrease the number of terms in E (and thus the dimension of the parameter space) by one, and these moves begin by either randomly sampling the value of a new energy term from a uniform distribution from 0 to width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e197" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e198" xlink:type="simple"/></inline-formula>, or collapsing an energy parameter term to zero. However, since these proposals may not be good samples near the optimum for the new dimension, we use a technique called “proposal reallocation” <xref ref-type="bibr" rid="pone.0026105-AlAwadhi1">[57]</xref>, in which we perform <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e199" xlink:type="simple"/></inline-formula> fixed-dimension MCMC steps through parameter space (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e200" xlink:type="simple"/></inline-formula>) satisfying detailed balance with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e201" xlink:type="simple"/></inline-formula>. The final state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e202" xlink:type="simple"/></inline-formula> is then used for the decision to accept or reject the move to the new dimensional space, and we use a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e203" xlink:type="simple"/></inline-formula> that is large enough (based on empirical tests) that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e204" xlink:type="simple"/></inline-formula> is assumed to be independent of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e205" xlink:type="simple"/></inline-formula>, i.e., that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e206" xlink:type="simple"/></inline-formula>. Note that we are thereby essentially using an arbitrary implicit prior ratio of 1∶1 for the two hypotheses, and that the ratio of time spent in any two adjacent dimensional spaces will be equal to the Bayes Factor between those spaces.</p>
      </sec>
      <sec id="s2g">
        <title>Accuracy of the generative sequence model</title>
        <p>For a given dataset, we evaluated the accuracy of the GSM for each polynucleotide of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e207" xlink:type="simple"/></inline-formula> and ds-oligo length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e208" xlink:type="simple"/></inline-formula> by comparing its predictions for frequencies of each ds-oligo <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e209" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e210" xlink:type="simple"/></inline-formula>) to their observed values. The observed values can be considered precise estimators for comparison (i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e211" xlink:type="simple"/></inline-formula>) only in cases where the ds-oligos all have high counts, and in practice we could not go above ds-oligo length 7 for the GSM accuracy analysis. To evaluate estimator accuracy we used the root mean square error (RMSE), where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e212" xlink:type="simple"/></inline-formula>, which includes both bias and variance in the estimates as they deviate from the true value.</p>
      </sec>
      <sec id="s2h">
        <title>SULDEX Simulations using existing control data sets</title>
        <p>Two existing sets of data containing moderate numbers of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e213" xlink:type="simple"/></inline-formula>s were used for simulation analyses, 43 Leu3 <xref ref-type="bibr" rid="pone.0026105-Liu1">[26]</xref>, and 46 ArcA binding sites <xref ref-type="bibr" rid="pone.0026105-Wang1">[28]</xref>, with two reference sequences chosen for each data set. We also used the Zif268 Bind-n-Seq data (at 5 nM initial transcription factor concentration), including only the 436 ds-oligos that were within two nucleotide differences from the consensus binding site (<named-content content-type="gene" xlink:type="simple">GCGTGGGCGT</named-content>). We used the top three best binders (<named-content content-type="gene" xlink:type="simple">GCGTGGGCGG</named-content> and <named-content content-type="gene" xlink:type="simple">GCGTGGGAGG</named-content> and the consensus) as reference <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e214" xlink:type="simple"/></inline-formula>s (0.25728988, 0.579150579, and 0.15026296 nM, respectively). To determine the effectiveness of the SULDEX procedure in obtaining accurate dissociation constants and energy models, datasets were simulated based on known (or presumed) dissociation constants, mimicking the steps in a real SULDEX experiment. For simulations of the Leu3 and ArcA data, sequences were generated at equal frequencies. To avoid expected generation frequencies of zero for the Zif268 sequences, they were generated at frequencies equal to 0.8 times the observed frequency plus 0.2 times the frequencies obtained from a GSM with polynucleotide length 7. The accuracy of parameter estimates (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e215" xlink:type="simple"/></inline-formula>) from the posterior means were then evaluated using the root mean square error (RMSE) of their logs, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e216" xlink:type="simple"/></inline-formula>. The protein concentration and the total copy number were varied in these simulations to determine what effect these experimental conditions have on the accuracy of the outcomes, and thus to guide experimental design. For the Leu3 and ArcA data, each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e217" xlink:type="simple"/></inline-formula> was categorized into low, medium, and high when its value was, respectively, lower than the lowest <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e218" xlink:type="simple"/></inline-formula>, close to the lowest <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e219" xlink:type="simple"/></inline-formula>, or in the middle of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e220" xlink:type="simple"/></inline-formula> distributions of the target sequences.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <p>In this study, we introduce multiple models for use in analyzing the results from SULDEX experiments. The first is the basic binding model (BBM), which can be used in situations where enough data has been collected such that most ds-oligo counts in the pre-bound and bound fractions are large enough to allow their frequencies to be estimated fairly accurately. We fit this model with the likelihood function given in Equation 6. The other two model classes are designed as extensions of the BBM. The generative sequence model (GSM) is designed to provide replacement estimates of counts in situations where many (or most) of the observed counts in the pre-bound fraction are zero or so small that they are estimated poorly. Such situations typically occur when there are exceptionally large numbers of sequences (e.g., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e221" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e222" xlink:type="simple"/></inline-formula> for length 10 or 20 random ds-oligos, respectively). As described below, however, we find that for available large-scale datasets neither the original counts nor this model are adequate, and so the GSM (Equation 11) was used only to generate synthetic datasets for testing the effectiveness of Bayesian analysis in determining parameters for the other models. Finally, we introduce the generative energy model (GEM) to provide better estimates in situations where some or many of the bound counts are not accurately determined. The GEM is actually not a single model, but a family of models in which various free energy parameter terms are turned on and off (included or removed from the model) during the course of the reversible jump Markov chain Monte Carlo analysis. We fit this model with the likelihood function given in Equation 10. The <italic>SULDEX</italic> program for implementing these analyses is freely available at the authors' web site, <ext-link ext-link-type="uri" xlink:href="http://www.EvolutionaryGenomics.com" xlink:type="simple">www.EvolutionaryGenomics.com</ext-link>. We begin the results with an analysis of experimental design considerations and the effectiveness of the GSM, followed by implementation and testing of the BBM and GEM on the small Leu3 and ArcA datasets, followed by testing of a full GEM-based SULDEX analysis of 10 mers simulated based on GSM count predictions from the Zif268 Bind-n-Seq 20 mer dataset.</p>
      <sec id="s3a">
        <title>Experimental Design</title>
        <p>An important consideration for experimental design is the synthesis of the ds-oligos that will be made into double-stranded targets and then bound to a transcription factor. This leads to several questions: What is the preferable target structure? What should the relative frequencies of different ds-oligos be? and what part of the binding site should be targeted with variation? SULDEX ds-oligos may contain primer regions for sequencing, variable sequence tags (or “barcodes”) to distinguish different experiments, and variable (experimental) and constant parts in the binding site and flanking region to prevent differential binding depending on which sequence tag is used. There is an inherent tradeoff between the goal of analyzing many sequences at once and the goal of obtaining accurate results. As accurate estimation of dissociation constants depends on accurate estimation of the pre-bound target frequencies, for a given number of sequence counts, including more ds-oligos in an experiment will lower the average number of sequence counts per ds-oligo. Furthermore, when many ds-oligos are included in the mixture, the variation in realized ds-oligo concentrations will mean that some ds-oligos are at much lower concentrations compared to others. For example, in the Zif268 data <xref ref-type="bibr" rid="pone.0026105-Zykovich1">[12]</xref>, hexamer (length 6) counts vary by 384 fold. In the HT-SELEX data <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>, the expected ratio between the highest and lowest count 10 mer ds-oligo is over 1 billion.</p>
        <p>This simple result has serious implications for designing experiments with satisfactory accuracy. One way to address this is to limit the number of ds-oligos per experiment. We can consider that if each ds-oligo we care about is sequenced 100 times in the pre-bound fraction, the standard deviation (std) of the count is 10% of its expectation (according to a Poisson assumption). Thus, we might want to sequence such ds-oligos 100–1000 times. It may be currently reasonable to expect 65 million reads in a single lane of Illumina HiSeq sequencing, meaning that one could reasonably target 65,000 different ds-oligos, hoping that with an average expectation of 1000 counts, a large fraction would be sequenced 100 times or more. For random ds-oligos, this means that only 8 sites should be varied (leading to 65,536 different ds-oligos). Although this may work for some studies, it may be unsatisfactory for others, and we suggest two alternatives to allow the entire binding site sequence repertoire to be evaluated at once. The first suggestion is to make smaller numbers of variants, and then mix them. For example, if five sites at a time were randomized in a 10 mer, and this was repeated 15 times over with a careful assortment of sites each time, then all pairwise deviations from the consensus sequence might be reasonably sampled in the mixture of these 15 syntheses containing 15,360 different ds-oligos. The second suggestion is to synthesize 50∶50 nucleotide mixtures at each site, focusing on those variants at each site that are thought to be relevant to binding the transcription factor in question. This is similar to a previously proposed approach for sampling ancestral sequences <xref ref-type="bibr" rid="pone.0026105-Pollock1">[58]</xref>.</p>
        <p>In cases where there are too many variants to get accurate relative frequencies in the pre-bound fraction, it is possible to use a predictive model. A simple model is to use the mononucleotide frequencies to predict ds-oligo frequencies, assuming that there is no higher-order interactive effect, as in <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>. A preliminary analysis of the Bind-n-Seq data <xref ref-type="bibr" rid="pone.0026105-Zykovich1">[12]</xref> indicated that this simple model was not satisfactory, as demonstrated by the observation that the frequencies of many ds-oligos are substantially different depending on which direction they are considered. This is also true of the HT-SELEX data. We therefore developed an order and context-dependent generative sequence model (GSM) to include higher-order interactions using polynucleotides of varying length to predict subsequent sequences (see <xref ref-type="sec" rid="s2">Methods</xref>).</p>
        <p>It is straightforward to test the predictive accuracy of this GSM on shorter ds-oligos since the frequencies of short ds-oligos can be accurately measured by direct count. For the Bind-n-Seq data <xref ref-type="bibr" rid="pone.0026105-Zykovich1">[12]</xref>, the average predicted error for counts of 5 mer sequences is 1.96%, which is accurate enough to compare to GSM estimates. Using the observed values as a reference, the GSM with polynucleotide lengths of 1, 2, and 3 had RMSEs of 71.1%, 40.5%, and 22.1%, respectively. This indicates strongly that GSMs with longer polynucleotide dependencies are preferable, and thus that the longest polynucleotide that can be accurately measured (based on the predicted accuracy of the observed polynucleotide frequencies in a dataset) should be used. Although these predicted error rates are somewhat disappointing, the errors in predictions of 10 mer frequencies are likely to be considerably higher. Our sense is that there are other more complex trends in the data that may allow greater predictive accuracy, but that a greater number of independent synthesis datasets are required to determine if these trends are general and thus worth computationally pursuing.</p>
        <p>The second step in SULDEX is to incubate the ds-oligo mixture with a transcription factor of interest. The concentration of free transcription factor in solution is the most important consideration in determining the outcome of the experiments (i.e., the accuracy of estimating binding energies or dissociation constants of interest). Unfortunately, this is difficult to predict ahead of time, as it depends on the concentrations and binding energies of all the sequences in solution, which are of course unknown at the outset. In cases where most of the sequences in the mixture are of interest (i.e., if variation in the mixture is targeted to be similar to the known binding motif), one can simply add different amounts of protein (holding the amount of sequence mixture constant), and from EMSA estimate the total ds-oligo content in the unbound and bound regions of tthe electrophoretic gel. An intermediate starting protein concentration can then be chosen in which approximately half of the DNA is in the bound fraction. Another possibility is to co-immunoprecipitate sequences bound to a transcription factor to measure the relative frequencies of the reference sequences in the pre-bound and bound solutions using quantitative PCR <xref ref-type="bibr" rid="pone.0026105-Haring1">[59]</xref> or high-throughput sequencing.</p>
      </sec>
      <sec id="s3b">
        <title>Analysis of the generative energy model with Leu3 and ArcA data</title>
        <p>To demonstrate the utility of the GEM analyses, we simulated SULDEX sequencing experiments using pre-existing datasets of known dissociation constants for the transcription factors Leu3 and ArcA. Since the original data sets include dissociation constants for less than 50 distinct sequences, we could not generate enough information to evaluate interaction terms. Therefore, only independent position-specific (additive) energy components were included in analyzing these simulations. In general, it is unclear how accurately a simple additive GEM will estimate binding energies. As described below, additive GEMs estimated from the ArcA dataset predicted binding energies extremely well, although this was not true for the Leu3 dataset. The point of the GEM is to leverage the information about binding energies in the data set as a whole, to improve binding energy predictions for individual ds-oligos. If the GEM accurately represents the determinants of binding energy, then less sequencing may be required to achieve good results. An accurate GEM will therefore be particularly helpful for predicting binding energies for ds-oligos that are sequenced at low frequency, or that bind poorly, and are thus under-represented in the data. This insight motivated the inclusion of an error term (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e223" xlink:type="simple"/></inline-formula>) to account for inaccuracies in the energy model (see <xref ref-type="sec" rid="s2">Methods</xref>). This error term is estimated along with the rest of the model, allowing an automatic transition from the energy model predictions to the basic binding model predictions when either the GEM is inaccurate or when large pre-bound and bound counts allow <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e224" xlink:type="simple"/></inline-formula>s to be accurately predicted by the BBM alone. When the counts get large, the model effectively factors apart into two subcomponents: a multinomial model in which all dissociation constants are entirely determined by the pre- and post-binding counts (and the reference dissociation constants), and an energy model that attempts to reproduce those nearly-certain dissociation constants in terms of a combination of energy parameters and error terms.</p>
        <p>As expected, binding predictions were more accurate (had lower log <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e225" xlink:type="simple"/></inline-formula> RMSEs) as the average number of sequence counts was increased (<xref ref-type="fig" rid="pone-0026105-g004">Figure 4</xref>). The results for Leu3 GEM analyses indicate that the error term improved predictions, since the RMSEs are mostly well below the value obtained when the error term was excluded (0.4). Although the GEM analytical predictions are not quite as accurate as the BBM predictions for Leu3, the error term allows the GEM to mostly reflect the accuracy inherent in the high counts and not the less accurate predictions of the energy model. For the experiments with Leu3 at a concentration of 50 nM, for which the BBM had the lowest accuracy among the Leu3 runs, there are some conditions for which the GEM analyses had slightly less error than the BBM analyses alone (<xref ref-type="fig" rid="pone-0026105-g004">Figure 4</xref>). Under these conditions (the highest transcription factor concentrations), many of the strong and moderate binders are almost completely bound (not shown), and it is therefore hard for the BBM to accurately distinguish the relative magnitude of their dissociation constants.</p>
        <fig id="pone-0026105-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0026105.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Comparison of the Basic Binding Model (BBM) and Generative Energy Model (GEM).</title>
            <p>The BBM results are shown in blue, and the GEM results in red. Data were synthesized based on the Leu3 (a) and ArcA (b) dissociation constant data sets. In silico sequences were equilibrated, resulting in 1 nM, 10 nM, or 50 nM free <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e226" xlink:type="simple"/></inline-formula> for Leu3, and 1 nM, 100 nM, or 1000 nM for ArcA. Values are the RMSE across all log <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e227" xlink:type="simple"/></inline-formula> estimates, and error bars shown are for four replicates. Average reads (counts) per ds-oligo sequence ranged from 1 to 100.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.g004" xlink:type="simple"/>
        </fig>
        <p>For the ArcA data, the GEM provides an improvement over the BBM in almost all cases. While the BBM RMSEs get substantially worse when the free transcription factor is high (<xref ref-type="fig" rid="pone-0026105-g004">Figure 4</xref>; note the differing scales on the graphs), the GEM RMSEs are similar for all but the lowest counts. The difference between the two methods is most notable in the results for the 1 µM (1000 nM) concentration of transcription factor. Evaluation of the errors as a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e228" xlink:type="simple"/></inline-formula> (<xref ref-type="supplementary-material" rid="pone.0026105.s001">Figures S1a</xref> and <xref ref-type="supplementary-material" rid="pone.0026105.s002">S2a</xref>) indicate that most of the error reductions come from the best or the worst binding ds-oligos under conditions where they are poorly estimated by the BBM. It is also worth noting that for ArcA, with its relatively accurate GEM, increases in the amount of sequencing only slightly alter the RMSEs under the GEM, and the variance of the error estimates are slightly narrower (<xref ref-type="supplementary-material" rid="pone.0026105.s002">Figure S2b</xref>). In contrast, the error terms for the Leu3 GEMs become considerably larger with increases in the amount of total sequence counts collected (<xref ref-type="supplementary-material" rid="pone.0026105.s001">Figure S1b</xref>). One way to view this is that as more counts accumulate, the BBM estimators become more accurate and thereby better expose the inaccuracy of the Leu3 GEM estimates. Thus, the change in the error estimate with increased sequencing seems to serve as an indicator of the reliability of the GEM.</p>
      </sec>
      <sec id="s3c">
        <title>Relationship between posterior energy model terms and binding site consensus</title>
        <p>Leu3 binds to a palindromic consensus site (<named-content content-type="gene" xlink:type="simple">CCGgtacCGG</named-content>) as a homodimer to regulate genes involved in branched-chain amino acid metabolism <xref ref-type="bibr" rid="pone.0026105-Friden1">[60]</xref>. There are 10 positions in the palindromic binding site, but since only 43 variants with known dissociation constants were available for the simulation analysis, there is a great deal of missing data. Positions 2 and 9, for example, do not vary, and there are only two variants each at positions 3, 8 and 10. In the original experiment <xref ref-type="bibr" rid="pone.0026105-Liu1">[26]</xref>, variants with mutations at positions 2 and 9 were too deleterious to Leu3 binding to be observed. An examination of the posterior mean binding energy estimates for the intermediate binding conditions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e229" xlink:type="simple"/></inline-formula> = 10 nM) and moderate counts (average 10 per ds-oligo) indicates that a number of positions have only marginal differences between the optimal variant and the next-best variant (<xref ref-type="table" rid="pone-0026105-t001">Table 1</xref>). At position 3, for example, the mean posterior position-specific energy difference between G and T is only 0.03 energy units, and at position 7 the difference between C and T is only 0.04. In contrast, the nucleotide T at position 1 is the most deleterious variant, with 1.9 additional energy units difference from C, which is the optimal nucleotide at this position.</p>
        <table-wrap id="pone-0026105-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0026105.t001</object-id><label>Table 1</label><caption>
            <title>Posterior distribution of position-specific energy terms for Leu3, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e230" xlink:type="simple"/></inline-formula> = 10 nM, average counts = 10).</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0026105-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="2" rowspan="1">A</td>
                <td align="left" colspan="2" rowspan="1">C</td>
                <td align="left" colspan="2" rowspan="1">G</td>
                <td align="left" colspan="2" rowspan="1">T</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Position</td>
                <td align="left" colspan="1" rowspan="1">mean</td>
                <td align="left" colspan="1" rowspan="1">std</td>
                <td align="left" colspan="1" rowspan="1">mean</td>
                <td align="left" colspan="1" rowspan="1">std</td>
                <td align="left" colspan="1" rowspan="1">mean</td>
                <td align="left" colspan="1" rowspan="1">std</td>
                <td align="left" colspan="1" rowspan="1">mean</td>
                <td align="left" colspan="1" rowspan="1">std</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00*</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.01</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.32</td>
                <td align="left" colspan="1" rowspan="1">0.21</td>
                <td align="left" colspan="1" rowspan="1">1.88</td>
                <td align="left" colspan="1" rowspan="1">0.46</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00*</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.02*</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.05</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.05</td>
                <td align="left" colspan="1" rowspan="1">0.10</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">0.91</td>
                <td align="left" colspan="1" rowspan="1">0.45</td>
                <td align="left" colspan="1" rowspan="1">0.15</td>
                <td align="left" colspan="1" rowspan="1">0.19</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.04*</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.10</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.19</td>
                <td align="left" colspan="1" rowspan="1">0.22</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">0.42</td>
                <td align="left" colspan="1" rowspan="1">0.15</td>
                <td align="left" colspan="1" rowspan="1">0.58</td>
                <td align="left" colspan="1" rowspan="1">0.20</td>
                <td align="left" colspan="1" rowspan="1">0.80</td>
                <td align="left" colspan="1" rowspan="1">0.26</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00*</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.01</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">6</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.01*</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.03</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">1.22</td>
                <td align="left" colspan="1" rowspan="1">0.30</td>
                <td align="left" colspan="1" rowspan="1">0.33</td>
                <td align="left" colspan="1" rowspan="1">0.36</td>
                <td align="left" colspan="1" rowspan="1">0.61</td>
                <td align="left" colspan="1" rowspan="1">0.18</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">7</td>
                <td align="left" colspan="1" rowspan="1">0.57</td>
                <td align="left" colspan="1" rowspan="1">0.25</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.25*</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.16</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.71</td>
                <td align="left" colspan="1" rowspan="1">0.51</td>
                <td align="left" colspan="1" rowspan="1">0.29</td>
                <td align="left" colspan="1" rowspan="1">0.47</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">8</td>
                <td align="left" colspan="1" rowspan="1">0.28</td>
                <td align="left" colspan="1" rowspan="1">0.27</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.02*</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.07</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">9</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00*</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">0.92</td>
                <td align="left" colspan="1" rowspan="1">0.35</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00*</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.01</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>The lowest energy term at each position is in boldface, and the mean for the consensus sequence is indicated with a *. Variants that were not tested in the analysis have a dash.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>One of the features of our modeling approach is that Markov chains are run over different models that include varying numbers of parameters. For example, an energy term might not be required if the corresponding variant is energetically indistinguishable from the optimal binding variant. In general for Leu3, a mean posterior energy difference of about 0.6 or greater is associated with a posterior probability of &gt;0.95 that an energy term is required (i.e., that having that nucleotide at that position worsens the energy of Leu3 binding enough that an energy term is required to distinguish it from the optimal variant; <xref ref-type="fig" rid="pone-0026105-g005">Figure 5</xref>). As expected, the lowest energy terms at each position generally match the consensus (<xref ref-type="table" rid="pone-0026105-t001">Table 1</xref>).</p>
        <fig id="pone-0026105-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0026105.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Posterior probability of position-specific energy terms in Leu3 and ArcA.</title>
            <p>The posterior probability for each nucleotide at each position is shown in the order A (black), C (red), G (green), and T (blue). Gray dots are shown for nucleotides for which no information was available in the data, and black dots are shown over the nucleotide used at a site where no variation was available at that site. The consensus sequence is shown above the probability bar corresponding to the consensus nucleotide. Capital letters indicate a strongly preferred consensus nucleotide at a position, while lower case letters indicate a more indeterminate consensus nucleotide. Conditions are specified in <xref ref-type="table" rid="pone-0026105-t001">Tables 1</xref> and <xref ref-type="table" rid="pone-0026105-t002">2</xref>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.g005" xlink:type="simple"/>
        </fig>
        <p>ArcA binds as a symmetric dimer to a tandem-repeated 15-position consensus site (<named-content content-type="gene" xlink:type="simple">GTTAccattATGTTA</named-content>) to regulate genes involved in oxygen response <xref ref-type="bibr" rid="pone.0026105-Wang1">[28]</xref>. There were 46 sequences available with known dissociation constants, and out of the 136 possible single nucleotide variants, only four were not represented in these 46 sequences (<xref ref-type="table" rid="pone-0026105-t002">Table 2</xref>). Results (<xref ref-type="table" rid="pone-0026105-t002">Table 2</xref> and <xref ref-type="fig" rid="pone-0026105-g005">Figure 5</xref>) are similar to those from Leu3, with the lowest energy variant usually matching the consensus, with some variants only slightly different from the lowest energy variant (e.g., C versus G at position 6), and with some variants being extremely deleterious (e.g., C at position 1).</p>
        <table-wrap id="pone-0026105-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0026105.t002</object-id><label>Table 2</label><caption>
            <title>Posterior distribution of position-specific energy terms for ArcA, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e231" xlink:type="simple"/></inline-formula> = 100 nM, average counts = 20).</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0026105-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.t002" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="2" rowspan="1">A</td>
                <td align="left" colspan="2" rowspan="1">C</td>
                <td align="left" colspan="2" rowspan="1">G</td>
                <td align="left" colspan="2" rowspan="1">T</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Position</td>
                <td align="left" colspan="1" rowspan="1">mean</td>
                <td align="left" colspan="1" rowspan="1">std</td>
                <td align="left" colspan="1" rowspan="1">mean</td>
                <td align="left" colspan="1" rowspan="1">std</td>
                <td align="left" colspan="1" rowspan="1">mean</td>
                <td align="left" colspan="1" rowspan="1">std</td>
                <td align="left" colspan="1" rowspan="1">mean</td>
                <td align="left" colspan="1" rowspan="1">std</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1.42</td>
                <td align="left" colspan="1" rowspan="1">0.31</td>
                <td align="left" colspan="1" rowspan="1">2.32</td>
                <td align="left" colspan="1" rowspan="1">0.19</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">1.05</td>
                <td align="left" colspan="1" rowspan="1">0.28</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">1.49</td>
                <td align="left" colspan="1" rowspan="1">0.32</td>
                <td align="left" colspan="1" rowspan="1">2.11</td>
                <td align="left" colspan="1" rowspan="1">0.46</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">0.52</td>
                <td align="left" colspan="1" rowspan="1">0.31</td>
                <td align="left" colspan="1" rowspan="1">2.18</td>
                <td align="left" colspan="1" rowspan="1">0.51</td>
                <td align="left" colspan="1" rowspan="1">0.46</td>
                <td align="left" colspan="1" rowspan="1">0.29</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.02</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.01</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">2.27</td>
                <td align="left" colspan="1" rowspan="1">0.43</td>
                <td align="left" colspan="1" rowspan="1">0.74</td>
                <td align="left" colspan="1" rowspan="1">0.30</td>
                <td align="left" colspan="1" rowspan="1">1.74</td>
                <td align="left" colspan="1" rowspan="1">0.39</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">0.25</td>
                <td align="left" colspan="1" rowspan="1">0.20</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.01</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.05</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.77</td>
                <td align="left" colspan="1" rowspan="1">0.36</td>
                <td align="left" colspan="1" rowspan="1">0.40</td>
                <td align="left" colspan="1" rowspan="1">0.35</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">6</td>
                <td align="left" colspan="1" rowspan="1">0.35</td>
                <td align="left" colspan="1" rowspan="1">0.14</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.06</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.13</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.13</td>
                <td align="left" colspan="1" rowspan="1">0.18</td>
                <td align="left" colspan="1" rowspan="1">0.32</td>
                <td align="left" colspan="1" rowspan="1">0.28</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">7</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.09</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.15</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.22</td>
                <td align="left" colspan="1" rowspan="1">0.24</td>
                <td align="left" colspan="1" rowspan="1">0.12</td>
                <td align="left" colspan="1" rowspan="1">0.18</td>
                <td align="left" colspan="1" rowspan="1">0.51</td>
                <td align="left" colspan="1" rowspan="1">0.09</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">8</td>
                <td align="left" colspan="1" rowspan="1">0.24</td>
                <td align="left" colspan="1" rowspan="1">0.19</td>
                <td align="left" colspan="1" rowspan="1">0.17</td>
                <td align="left" colspan="1" rowspan="1">0.23</td>
                <td align="left" colspan="1" rowspan="1">0.51</td>
                <td align="left" colspan="1" rowspan="1">0.33</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.03</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.08</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">9</td>
                <td align="left" colspan="1" rowspan="1">0.07</td>
                <td align="left" colspan="1" rowspan="1">0.10</td>
                <td align="left" colspan="1" rowspan="1">0.19</td>
                <td align="left" colspan="1" rowspan="1">0.22</td>
                <td align="left" colspan="1" rowspan="1">0.21</td>
                <td align="left" colspan="1" rowspan="1">0.22</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.05</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.10</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.02</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.06</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.64</td>
                <td align="left" colspan="1" rowspan="1">0.32</td>
                <td align="left" colspan="1" rowspan="1">0.53</td>
                <td align="left" colspan="1" rowspan="1">0.32</td>
                <td align="left" colspan="1" rowspan="1">0.27</td>
                <td align="left" colspan="1" rowspan="1">0.14</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">11</td>
                <td align="left" colspan="1" rowspan="1">1.02</td>
                <td align="left" colspan="1" rowspan="1">0.27</td>
                <td align="left" colspan="1" rowspan="1">0.66</td>
                <td align="left" colspan="1" rowspan="1">0.33</td>
                <td align="left" colspan="1" rowspan="1">1.02</td>
                <td align="left" colspan="1" rowspan="1">0.30</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.01</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.05</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">-</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">13</td>
                <td align="left" colspan="1" rowspan="1">2.24</td>
                <td align="left" colspan="1" rowspan="1">0.51</td>
                <td align="left" colspan="1" rowspan="1">1.72</td>
                <td align="left" colspan="1" rowspan="1">0.37</td>
                <td align="left" colspan="1" rowspan="1">2.08</td>
                <td align="left" colspan="1" rowspan="1">0.41</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">14</td>
                <td align="left" colspan="1" rowspan="1">0.10</td>
                <td align="left" colspan="1" rowspan="1">0.15</td>
                <td align="left" colspan="1" rowspan="1">1.83</td>
                <td align="left" colspan="1" rowspan="1">0.39</td>
                <td align="left" colspan="1" rowspan="1">0.16</td>
                <td align="left" colspan="1" rowspan="1">0.20</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.03</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.06</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.00</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.01</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">1.70</td>
                <td align="left" colspan="1" rowspan="1">0.40</td>
                <td align="left" colspan="1" rowspan="1">0.75</td>
                <td align="left" colspan="1" rowspan="1">0.31</td>
                <td align="left" colspan="1" rowspan="1">1.13</td>
                <td align="left" colspan="1" rowspan="1">0.32</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt102">
              <label/>
              <p>Notation is the same as in <xref ref-type="table" rid="pone-0026105-t001">Table 1</xref>.</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s3d">
        <title>Simulating a more complete SULDEX experiment</title>
        <p>A more complete SULDEX experiment would include most or all of the ds-oligos that are likely to be specifically bound by a transcription factor, unlike for the Leu3 and ArcA data sets, which each have dissociation constants for fewer than 50 binding sites. Furthermore, for the Leu3 and ArcA simulations we assumed equal pre-bound frequencies, even though it is more realistic to expect variation in the relative frequencies of the different ds-oligos in the pre-bound fraction. We therefore tested our method on a more complete SULDEX experiment simulation that incorporated these factors. The best available dataset for this purpose, that we are aware of, is the Zif268 data from the Bind-n-Seq experiment <xref ref-type="bibr" rid="pone.0026105-Zykovich1">[12]</xref>. The Bind-n-Seq dataset, however, presents a major practical difficulty in that the Zif268 binding sites (length 10) are located within random 21 mers, meaning that the local context for any putative binding site varies in every instance. The efficiency of ds-oligo synthesis itself can vary with local sequence context, sometimes resulting in dramatically unequal frequencies (as discussed above). Additionally, the probability that a target site is bound may vary with sequence context, and the transcription factor may even bind to different locations on a long ds-oligo. Thus, the probability of binding a sequence must be summed over all binding locations, and 10 mer frequency distributions may not directly reflect binding probabilities due to interference caused by binding at other locations. Because of these problems, one cannot expect that the true Zif268 dissociation constants values can necessarily be accurately determined from this dataset. Nevertheless, SULDEX analysis of these data can provide a large set of reasonable parameter values for simulating a dataset for the purpose of testing the method. We therefore performed such an analysis, and then simulated binding using the “known” dissociation constant values.</p>
        <p>The first step of the simulation is the synthesis of pre-bound 10 mers at different background frequencies. Some of the frequencies in the Zif268 dataset could be used directly, but many pre-bound counts in the Zif268 dataset were low or zero. We therefore generated pre-bound sequences using a generative model (GSM; see <xref ref-type="sec" rid="s2">Methods</xref>), which predicts frequencies for all ds-oligos. The next step is to simulate binding of the 10 mers according to their “known” binding affinities based on energy terms derived from the preliminary SULDEX analysis of the Zif268 data. For results below, we synthesized and analyzed 10 mers differing from the consensus by two nucleotides or fewer. Simulations were run at four transcription factor concentrations (0.1, 1.0, 10.0, and 100.0 nM) with an average of 1000, 200, 100, or 20 sequence reads per ds-oligo in the pre-bound and/or bound solutions. Bound frequencies were obtained by multiplying the pre-bound frequency by the probability of binding calculated as in Equation 2, using the GEM to obtain the binding energies and thus the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e232" xlink:type="simple"/></inline-formula>s. Simulations were replicated three times for each condition to obtain means and variance of all estimators, and were evaluated using the basic method alone (BBM), and using the basic plus GEM method, both including three known reference <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e233" xlink:type="simple"/></inline-formula>s.</p>
        <p>In the MCMC analysis, pre-bound frequencies and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e234" xlink:type="simple"/></inline-formula>were treated as free parameters (subject to the constraints of the model) and posterior estimates of all parameters were compared to their true (simulated) values. When an average of 1000 sequence reads (counts) per ds-oligo were used, the mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e235" xlink:type="simple"/></inline-formula> estimators for both models were generally accurate for a variety of transcription factor concentrations (<xref ref-type="fig" rid="pone-0026105-g006">Figure 6</xref>). One caveat is that the basic binding model required inclusion of a reference ds-oligo with high <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e236" xlink:type="simple"/></inline-formula> (100 nM) to obtain remotely accurate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e237" xlink:type="simple"/></inline-formula> estimates when the transcription factor concentration was high (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e238" xlink:type="simple"/></inline-formula> = 100 nM). In contrast, the energy model does not, and even the very lowest <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e239" xlink:type="simple"/></inline-formula>s are estimated poorly (<xref ref-type="fig" rid="pone-0026105-g006">Figure 6a</xref>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e240" xlink:type="simple"/></inline-formula> = 100 nM). Furthermore, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e241" xlink:type="simple"/></inline-formula> estimates were slightly worse for the basic binding method at the lowest and highest transcription factor concentrations. The transcription factor concentration estimates were accurate as well (data not shown). In general, the individual <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e242" xlink:type="simple"/></inline-formula> estimates were worst for ds-oligos that have very low counts in the pre-bound and/or bound fractions.</p>
        <fig id="pone-0026105-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0026105.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Accuracy of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e243" xlink:type="simple"/></inline-formula> estimates for Zif268 simulation.</title>
            <p>Means and standard deviation estimates from the posterior distribution are shown for a single representative simulation replicate for each condition. In these simulations, there were 1000 counts per ds-oligo on average in both the pre-bound and bound solutions, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e244" xlink:type="simple"/></inline-formula> was 0.1, 1.0, 10, or 100 nM. For the Basic (BBM) model (a), but not the GEM (b) model, a reference ds-oligo with a larger <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e245" xlink:type="simple"/></inline-formula> was required for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e246" xlink:type="simple"/></inline-formula> = 100 nm (c.f., <xref ref-type="supplementary-material" rid="pone.0026105.s001">Figure S1</xref>). Only the 89 high affinity ds-oligos with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e247" xlink:type="simple"/></inline-formula> nM are shown (out of 436 total ds-oligos).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.g006" xlink:type="simple"/>
        </fig>
        <p>As described in the previous section, the energy model is expected to provide a greater benefit when more counts in the pre-bound or bound fraction are low. This prediction is borne out by the simulations with reduced sequencing per ds-oligo (<xref ref-type="fig" rid="pone-0026105-g007">Figure 7</xref> and <xref ref-type="fig" rid="pone-0026105-g008">8</xref>). The GEM has better accuracy, particularly for ds-oligos with high <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e248" xlink:type="simple"/></inline-formula> values (<xref ref-type="fig" rid="pone-0026105-g009">Figure 9</xref>), indicating that it provides a better estimator by sharing information across sequences according to the GEM. The effect is even more pronounced when the pre-bound ds-oligos are sequenced in higher numbers, but the bound ds-oligos are not. The GEM energy terms themselves are also estimated accurately as long as the pre-bound sequencing is high (<xref ref-type="fig" rid="pone-0026105-g010">Figure 10</xref>), although some of the largest energy terms are estimated less accurately than the others. This is to be expected, since the high-energy terms lead to ds-oligos with weak binding properties for which the strength of binding can only be approximately estimated.</p>
        <fig id="pone-0026105-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0026105.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Accuracy of Zif268 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e249" xlink:type="simple"/></inline-formula> estimates with fewer counts in both solutions. </title>
            <p>Results are displayed as in <xref ref-type="fig" rid="pone-0026105-g006">Figure 6</xref>. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e250" xlink:type="simple"/></inline-formula> was 1.0 nM and there were 200, 100, or 20 sequence counts per ds-oligo in both the both the pre-bound and bound solutions (labeled as “pre-bound, bound” in the different sub-figures).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.g007" xlink:type="simple"/>
        </fig>
        <fig id="pone-0026105-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0026105.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Accuracy of Zif268 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e251" xlink:type="simple"/></inline-formula> estimates with fewer counts in bound solution only.</title>
            <p> Results are displayed as in <xref ref-type="fig" rid="pone-0026105-g006">Figure 6</xref>. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e252" xlink:type="simple"/></inline-formula> was 1.0 nM, and there were 1000 counts per ds-oligo in the pre-bound solutions. There were 200, 100, or 20 sequence counts per ds-oligo in the bound solutions. Pre-bound and bound solution concentration are labeled in the different sub-figures as in <xref ref-type="fig" rid="pone-0026105-g007">Figure 7</xref>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.g008" xlink:type="simple"/>
        </fig>
        <fig id="pone-0026105-g009" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0026105.g009</object-id>
          <label>Figure 9</label>
          <caption>
            <title>Relationship of BBM and GEM coefficients of variation for Zif268 simulations.</title>
            <p>Coefficients of variation (CVs, standard deviations over the means) were calculated from the posteriors using the same data as shown in <xref ref-type="fig" rid="pone-0026105-g007">Figure 7</xref>. The dashed line indicates equal CVs for the BBM and GEM estimators.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.g009" xlink:type="simple"/>
        </fig>
        <fig id="pone-0026105-g010" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0026105.g010</object-id>
          <label>Figure 10</label>
          <caption>
            <title>Posterior estimates of nucleotide- and position-specific energy terms.</title>
            <p>The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e253" xlink:type="simple"/></inline-formula> was 1.0 nM, and counts per ds-oligo in the pre-bound and bound solutions were 1000 and 1000, 100 and 100, or 1000 and 100, as labeled on the sub-figures. Results for nucleotide A, T, C, and G energy terms at each position are color coded black, blue, red, and green, respectively. The mean posterior estimate is shown with a dot, the 95% credible regions of the estimates are shown with vertical bars, and the true values are shown with horizontal bars.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.g010" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>The core principle applied in this study is that in solution and at equilibrium, the proportion of a particular TFBS sequence that is bound to a transcription factor (the probability of binding) is determined by the dissociation constant between the sequence and transcription factor, and the concentration of free transcription factor. Therefore, if one knows the relative frequencies of different sequences in a mixture prior to binding, one can predict the relative frequencies of those sequences that are bound to the transcription factor. A difficulty arises, in that the free concentration of transcription factor is generally unknown, and if the equilibrium constants are also unknown then there are more unknowns than data points (i.e., ds-oligo sequence counts in the bound solution). This problem can be easily solved by including at least two reference sequences with known dissociation constants in the basic (BBM) system, and if an energy model (GEM) is used, only one reference sequence is required. To ensure accuracy, it is also best if the counts for the reference sequences are relatively high. Although one could first solve for the unknowns using the reference sequence data, we have chosen to use a flexible Bayesian approach that can account for errors and uncertainty in all data points and allows inclusion of as many reference sequences as are available.</p>
      <p>One of the main benefits of the Bayesian approach is that it can incorporate information from multiple sources, all with varying degrees of uncertainty. In the simple graphical system that does not model the binding energy (<xref ref-type="fig" rid="pone-0026105-g001">Figure 1</xref>), the sources of information are the counts of sequences before the transcription factor is bound (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e254" xlink:type="simple"/></inline-formula>) and the counts in the fraction bound to the transcription factor (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e255" xlink:type="simple"/></inline-formula>). It is assumed that these counts are random draws from a multinomial based on the true underlying proportions of the sequences in the two solutions, respectively <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e256" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e257" xlink:type="simple"/></inline-formula>. These counts thus constrain the reasonable range of values for the underlying proportions, with higher counts constraining the proportions more than lower counts. The ds-oligo proportions in the bound solution containing transcription factor are modified from the pre-bound proportions based on the sequence-specific probability of binding the transcription factor. The reference sequences, with known dissociation constants, allow the information about the proportions of sequences in the two solutions to be translated back into information about the dissociation constants, and thus the binding energy of each sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e258" xlink:type="simple"/></inline-formula> through the relationship <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e259" xlink:type="simple"/></inline-formula> (see <xref ref-type="sec" rid="s2">Methods</xref> for details). Inclusion of at least two reference sequences ensures the identifiability of all unknown parameters.</p>
      <p>An interesting illustration of the flexibility of our Bayesian approach is our use of “generative energy models” (GEMs). With these models, information is communicated across ds-oligo sequences to predict the binding energy. In GEMs, the binding energy is considered to be composed of independent position-specific energy components, as well as interaction energy components <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>. The energy model may not be perfectly accurate, however, and the error term for the energy model allows for automated weighting of the accuracy of the energy-based predictions and the relative frequency-based predictions in coming to a joint posterior prediction of each sequence-specific dissociation constant. This weighting allows an easy switch from a basic method that relies on reference ds-oligos with known <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e260" xlink:type="simple"/></inline-formula>s and the counts alone, if they are high enough, to the GEM portion of the model, if the error in the GEM portion is low enough.</p>
      <p>There are similarities between the GEM and a position weight matrix (PWM) model using binding energies since both are (typically) estimated using independent energy contributions for each position <xref ref-type="bibr" rid="pone.0026105-Stormo1">[40]</xref>. The main difference is that in PWM estimation, the free <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e261" xlink:type="simple"/></inline-formula> concentration is assumed to be low. If this assumption is inaccurate the PWM will return an incorrect energy model. Therefore, an advantage of approaches such as ours that allow <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e262" xlink:type="simple"/></inline-formula> to vary, and to be estimated in the model-fitting process (see also <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>), is that a more accurate energy model can be determined without restrictive assumptions. In addition, our method also contrasts with PWM fitting in the use of reversible jumps between models of different dimensions to allow simultaneous estimates of the parameters of interest (the binding energies) while only including those energy components that are statistically well-justified.</p>
      <p>We have also proposed a separate “generative sequence model”, or GSM, which allows us to use the frequencies of shorter sub-sequences (polynucleotides) to model the frequency of sequences in solution prior to binding. This is useful in cases (such as the Zif268 Bind-n-Seq data) where there are so many pre-bound sequences that most of them individually have extremely low frequencies and are therefore difficult to count. For example, as we showed for the Bind-n-Seq data <xref ref-type="bibr" rid="pone.0026105-Zykovich1">[12]</xref>, the relative frequencies of their “randomly”-generated ds-oligos of even 8 bp in length can differ by many orders of magnitude. The range of frequencies for longer ds-oligos is even greater, and thus if accuracy is a concern it may be impossible to obtain sufficient coverage of all ds-oligos in a highly complex mixture. The sequencing requirements for accurate frequency estimates can easily be far beyond the capacity of even the best modern high-throughput sequencers. The GSM ameliorates this problem to some extent by providing improved frequency estimators for ds-oligos with low sequence counts, and may be further improved by discovering and incorporating other general rules to predict frequency variation. In the meantime, careful experimental design to reduce the number of sequences in the mixture and focus on particular experimental questions is also important if accuracy is a concern.</p>
      <p>Two recently proposed approaches similar to the SULDEX experimental system, Bind-n-Seq <xref ref-type="bibr" rid="pone.0026105-Zykovich1">[12]</xref> and HT-SELEX <xref ref-type="bibr" rid="pone.0026105-Zhao1">[13]</xref>, also utilize ds-oligos sequenced before and after binding to a transcription factor. The Bind-n-Seq analysis was designed to qualitatively identify binding site preferences, and assumes a simple PWM model with no attempt to model the biophysical energy terms or the relationship between the pre-bound and bound solution counts. As we have noted here, the experimental results are suboptimal for the purpose of measuring binding energies primarily because binding sites are created randomly in the varying context of a much longer random ds-oligonucleotide. This variable context can affect the probability of ds-oligo synthesis and the probability of binding, adding noise and bias to the results. The HT-SELEX approach, in contrast, has a similar aim to the SULDEX approach, and uses the BEEML program to estimate transcription factor concentrations and energy terms using a maximum likelihood approach and a nearly identical biophysical model. Key advantageous features of our approach include: 1) SULDEX uses a Bayesian approach and MCMC rather than a maximum likelihood approach, resulting in posterior distributions and an automatic estimate of uncertainty rather than only a point estimate. Bayesian and MCMC approaches based on biophysical models of transcription factor binding have previously been used to analyze ChIP-chip or PBM data <xref ref-type="bibr" rid="pone.0026105-Kinney1">[48]</xref>, <xref ref-type="bibr" rid="pone.0026105-Foat2">[61]</xref>, and are particularly useful for parameter-rich models such as these; 2) Unlike HT-SELEX, SULDEX allows estimation of binding energies directly from relative frequencies or in combination with an energy model, and allows incorporation of reference sequences with known binding energies. Thus, while both approaches include an energy model error term, in SULDEX this term allows reduced dependence on the energy model assumptions when binding energies are inferred. Binding energy inference will flexibly depend more on the energy model for low frequency ds-oligos with insufficient sequencing to be estimated by the BBM approach alone; 3) SULDEX uses the multinomial distribution to calculate the probabilities of observed counts given underlying ds-oligo frequencies in solution, while HT-SELEX's BEEML program uses a Gaussian approximation. This is most likely to matter when some counts are small, which will often occur due to the high variance of starting ds-oligo frequencies. BEEML also uses energy level discretization to approximate the partition function; 4) We have presented here a model (GSM) to predict relative ds-oligo frequencies in the pre-bound fraction, and shown that the simple independent nucleotide frequency model used in HT-SELEX/BEEML can be highly inaccurate. The GSM should be further developed to increase accuracy when data from a larger number of pre-bound ds-oligo synthesis experiments become available; 5) the SULDEX method allows simultaneous inference of model complexity and parameter values by incorporating a reversible jump MCMC approach, thus avoiding potential problems of model over-specification that can lead maximum likelihood estimators (such as those in BEEML) to focus on noise and thus reduce prediction accuracy.</p>
      <p>We expect that a future application of this and related approaches will be to allow detailed study of how binding energies are influenced by nucleotide variation in the binding site. In particular, the simple additive energy model is insufficient to accurately predict dissociation constants for many proteins, and interactive energy terms will therefore be needed. The number of possible interactive energy terms can be quite large, and their statistical justification and usefulness should be carefully considered. The reversible jump MCMC approach applied here can be used for this purpose and allows detailed biophysical models to be developed, evaluated, and compared without making a large number of assumptions. However, to explore interaction terms, it will be important to implement careful experimental design for generating data. For the datasets currently available (Bind-n-Seq and HT-SELEX), we do not believe that the pre-bound frequencies can be reliably determined, and for the Bind-n-Seq data the binding probabilities are confounded by variable context and possible multiple binding opportunities per ds-oligo. Thus, it seems quite possible that estimation of higher-order interactions in these datasets could be thoroughly confounded by these other effects. For example, in our own focused experiments using mitochondrial transcription factor A protein (mtTFA; unpublished data), which has moderate sequence specificity <xref ref-type="bibr" rid="pone.0026105-Gangelhoff1">[62]</xref>, we found that its multiple binding modes and multimers that form on the ds-oligos, as well as the context of varying sequence well outside the binding site, can deeply confound interpretation. Experiments that therefore focus on a sub-sample of possible ds-oligos close to the consensus or optimal ds-oligo can produce precise estimates of binding energies without relying on a model, and these may then be used to better elucidate reasonable model structures.</p>
      <p>Characterizing the binding potential of target binding sites for a transcription factor within a species has immediate benefit for understanding transcriptional regulation for a particular system, but applying this strategy across multiple species may have more widespread impact. In particular, to understand morphological evolution, it is necessary to have a clear idea of the relationship between transcription factors, their strength of binding to a wide range of targets, and how the binding energy relationships change as transcription factors evolve. Future implementations can also include important factors such as cooperative binding and interaction with repressors. We therefore expect that exploiting methods for determining binding energies across species will lead to substantial impact in other fields and in understanding to approach questions relating to disease pathology, evolutionary adaptation, and speciation.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pone.0026105.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.s001" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>True versus predicted binding with and without inclusion of an energy model for Leu3.</bold> The relationship between the true and predicted log <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e263" xlink:type="simple"/></inline-formula>s are shown in (a), with results that included the GEM model and an error term shown with red circles, and results without an energy term (the BBM model) with blue circles. The posterior distribution of the respective error terms for the GEM model results are shown in (b). Results are shown for free <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e264" xlink:type="simple"/></inline-formula> of 10 nM (labeled a1 and a3, and b1 and b3) or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e265" xlink:type="simple"/></inline-formula> = 50 nM (labeled a2 and a4, and b2 and b4). Average counts per ds-oligo were also varied, with counts of 10 in a1 and a3 (and b1 and b3), and counts of 100 in a2 and a4 (and b2 and b4). Dotted lines represent perfectly accurate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e266" xlink:type="simple"/></inline-formula> predictions.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0026105.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0026105.s002" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p><bold>True versus predicted binding with and without inclusion of an energy model for ArcA.</bold> Results shown for ArcA are the same as for Leu3 in <xref ref-type="supplementary-material" rid="pone.0026105.s002">Figure S2</xref>, except that free <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0026105.e267" xlink:type="simple"/></inline-formula> was 100 nM or 1000 nM (1 µM).</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="pone.0026105-Carey1">
        <label>1</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Carey</surname><given-names>M</given-names></name><name name-style="western"><surname>Smale</surname><given-names>ST</given-names></name></person-group>             <year>1999</year>             <source>Transcriptional Regulation in Eukaryotes: Concepts, Strategies, and Techniques</source>             <publisher-loc>Cold Spring Harbor</publisher-loc>             <publisher-name>Cold Spring Harbor Laboratory</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0026105-Friberg1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Friberg</surname><given-names>MT</given-names></name></person-group>             <year>2007</year>             <article-title>Prediction of transcription factor binding sites using ChIP-chip and phylogenetic footprinting data.</article-title>             <source>J Bioinform Comput Biol</source>             <volume>5</volume>             <fpage>105</fpage>             <lpage>116</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Reddy1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Reddy</surname><given-names>TE</given-names></name><name name-style="western"><surname>DeLisi</surname><given-names>C</given-names></name><name name-style="western"><surname>Shakhnovich</surname><given-names>BE</given-names></name></person-group>             <year>2007</year>             <article-title>Binding site graphs: a new graph theoretical framework for prediction of transcription factor binding sites.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e90</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Pape1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pape</surname><given-names>UJ</given-names></name><name name-style="western"><surname>Grossmann</surname><given-names>S</given-names></name><name name-style="western"><surname>Hammer</surname><given-names>S</given-names></name><name name-style="western"><surname>Sperling</surname><given-names>S</given-names></name><name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>A new statistical model to select target sequences bound by transcription factors.</article-title>             <source>Genome Inform</source>             <volume>17</volume>             <fpage>134</fpage>             <lpage>140</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Dai1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dai</surname><given-names>X</given-names></name><name name-style="western"><surname>He</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhao</surname><given-names>X</given-names></name></person-group>             <year>2007</year>             <article-title>A new systematic computational approach to predicting target genes of transcription factors.</article-title>             <source>Nucleic Acids Res</source>          </element-citation>
      </ref>
      <ref id="pone.0026105-Chen1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>Y</given-names></name><name name-style="western"><surname>Blackwell</surname><given-names>TW</given-names></name><name name-style="western"><surname>Chen</surname><given-names>J</given-names></name><name name-style="western"><surname>Gao</surname><given-names>J</given-names></name><name name-style="western"><surname>Lee</surname><given-names>AW</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Integration of genome and chromatin structure with gene expression profiles to predict c-MYC recognition site binding and function.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e63</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Ananko1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ananko</surname><given-names>EA</given-names></name><name name-style="western"><surname>Kondrakhin</surname><given-names>YV</given-names></name><name name-style="western"><surname>Merkulova</surname><given-names>TI</given-names></name><name name-style="western"><surname>Kolchanov</surname><given-names>NA</given-names></name></person-group>             <year>2007</year>             <article-title>Recognition of interferon-inducible sites, promoters, and enhancers.</article-title>             <source>BMC Bioinformatics</source>             <volume>8</volume>             <fpage>56</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Stepanova1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stepanova</surname><given-names>M</given-names></name><name name-style="western"><surname>Lin</surname><given-names>F</given-names></name><name name-style="western"><surname>Lin</surname><given-names>VC</given-names></name></person-group>             <year>2006</year>             <article-title>In silico modelling of hormone response elements.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <supplement>Suppl 4</supplement>             <fpage>S27</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Gibson1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gibson</surname><given-names>G</given-names></name><name name-style="western"><surname>Weir</surname><given-names>B</given-names></name></person-group>             <year>2005</year>             <article-title>The quantitative genetics of transcription.</article-title>             <source>Trends Genet</source>             <volume>21</volume>             <fpage>616</fpage>             <lpage>623</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Carroll1">
        <label>10</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Carroll</surname><given-names>SBGJK</given-names></name><name name-style="western"><surname>Weatherbee</surname><given-names>SD</given-names></name></person-group>             <year>2001</year>             <source>From DNA to Diversity: Molecular Genetics and the Evolution of Animal Design</source>             <publisher-loc>Malden, MA</publisher-loc>             <publisher-name>Blackwell Science</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0026105-Maerkl1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Maerkl</surname><given-names>SJ</given-names></name><name name-style="western"><surname>Quake</surname><given-names>SR</given-names></name></person-group>             <year>2007</year>             <article-title>A systems approach to measuring the binding energy landscapes of transcription factors.</article-title>             <source>Science</source>             <volume>315</volume>             <fpage>233</fpage>             <lpage>237</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Zykovich1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zykovich</surname><given-names>A</given-names></name><name name-style="western"><surname>Korf</surname><given-names>I</given-names></name><name name-style="western"><surname>Segal</surname><given-names>DJ</given-names></name></person-group>             <year>2009</year>             <article-title>Bind-n-Seq: high-throughput analysis of in vitro protein-DNA interactions using massively parallel sequencing.</article-title>             <source>Nucleic Acids Res</source>             <volume>37</volume>             <fpage>e151</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Zhao1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhao</surname><given-names>Y</given-names></name><name name-style="western"><surname>Granas</surname><given-names>D</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>             <year>2009</year>             <article-title>Inferring binding energies from selected binding sites.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000590</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Lassig1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lassig</surname><given-names>M</given-names></name></person-group>             <year>2007</year>             <article-title>From biophysics to evolutionary genetics: statistical aspects of gene regulation.</article-title>             <source>BMC Bioinformatics</source>             <volume>8</volume>             <supplement>Suppl 6</supplement>             <fpage>S7</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Marcy1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Marcy</surname><given-names>Y</given-names></name><name name-style="western"><surname>Ishoey</surname><given-names>T</given-names></name><name name-style="western"><surname>Lasken</surname><given-names>RS</given-names></name><name name-style="western"><surname>Stockwell</surname><given-names>TB</given-names></name><name name-style="western"><surname>Walenz</surname><given-names>BP</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Nanoliter reactors improve multiple displacement amplification of genomes from single cells.</article-title>             <source>PLoS Genet</source>             <volume>3</volume>             <fpage>1702</fpage>             <lpage>1708</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Warren1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Warren</surname><given-names>LA</given-names></name><name name-style="western"><surname>Rossi</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Schiebinger</surname><given-names>GR</given-names></name><name name-style="western"><surname>Weissman</surname><given-names>IL</given-names></name><name name-style="western"><surname>Kim</surname><given-names>SK</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Transcriptional instability is not a universal attribute of aging.</article-title>             <source>Aging Cell</source>             <volume>6</volume>             <fpage>775</fpage>             <lpage>782</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Marcy2">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Marcy</surname><given-names>Y</given-names></name><name name-style="western"><surname>Ouverney</surname><given-names>C</given-names></name><name name-style="western"><surname>Bik</surname><given-names>EM</given-names></name><name name-style="western"><surname>Losekann</surname><given-names>T</given-names></name><name name-style="western"><surname>Ivanova</surname><given-names>N</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Dissecting biological “dark matter” with single-cell genetic analysis of rare and uncultivated TM7 microbes from the human mouth.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>11889</fpage>             <lpage>11894</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Choi1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Choi</surname><given-names>Y</given-names></name><name name-style="western"><surname>Qin</surname><given-names>Y</given-names></name><name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name><name name-style="western"><surname>Ballow</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Microarray analyses of newborn mouse ovaries lacking Nobox.</article-title>             <source>Biol Reprod</source>             <volume>77</volume>             <fpage>312</fpage>             <lpage>319</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-McCord1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>McCord</surname><given-names>RP</given-names></name><name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name><name name-style="western"><surname>Philippakis</surname><given-names>AA</given-names></name><name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name></person-group>             <year>2007</year>             <article-title>Inferring condition-specific transcription factor function from DNA binding and gene expression data.</article-title>             <source>Mol Syst Biol</source>             <volume>3</volume>             <fpage>100</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Bulyk1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name></person-group>             <year>2007</year>             <article-title>Protein binding microarrays for the characterization of DNA-protein interactions.</article-title>             <source>Adv Biochem Eng Biotechnol</source>             <volume>104</volume>             <fpage>65</fpage>             <lpage>85</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Berger1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name><name name-style="western"><surname>Philippakis</surname><given-names>AA</given-names></name><name name-style="western"><surname>Qureshi</surname><given-names>AM</given-names></name><name name-style="western"><surname>He</surname><given-names>FS</given-names></name><name name-style="western"><surname>Estep</surname><given-names>PW</given-names><suffix>3rd</suffix></name><etal/></person-group>             <year>2006</year>             <article-title>Compact, universal DNA microarrays to comprehensively determine transcription-factor binding site specificities.</article-title>             <source>Nat Biotechnol</source>             <volume>24</volume>             <fpage>1429</fpage>             <lpage>1435</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Bulyk2">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name></person-group>             <year>2006</year>             <article-title>Analysis of sequence specificities of DNA-binding proteins with protein binding microarrays.</article-title>             <source>Methods Enzymol</source>             <volume>410</volume>             <fpage>279</fpage>             <lpage>299</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Berger2">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name><name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name></person-group>             <year>2006</year>             <article-title>Protein binding microarrays (PBMs) for rapid, high-throughput characterization of the sequence specificities of DNA binding proteins.</article-title>             <source>Methods Mol Biol</source>             <volume>338</volume>             <fpage>245</fpage>             <lpage>260</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Bulyk3">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name></person-group>             <year>2006</year>             <article-title>DNA microarray technologies for measuring protein-DNA interactions.</article-title>             <source>Curr Opin Biotechnol</source>             <volume>17</volume>             <fpage>422</fpage>             <lpage>430</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Jolma1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jolma</surname><given-names>A</given-names></name><name name-style="western"><surname>Kivioja</surname><given-names>T</given-names></name><name name-style="western"><surname>Toivonen</surname><given-names>J</given-names></name><name name-style="western"><surname>Cheng</surname><given-names>L</given-names></name><name name-style="western"><surname>Wei</surname><given-names>G</given-names></name><etal/></person-group>             <article-title>Multiplexed massively parallel SELEX for characterization of human transcription factor binding specificities.</article-title>             <source>Genome Res</source>             <volume>20</volume>             <fpage>861</fpage>             <lpage>873</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Liu1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>X</given-names></name><name name-style="western"><surname>Clarke</surname><given-names>ND</given-names></name></person-group>             <year>2002</year>             <article-title>Rationalization of gene regulation by a eukaryotic transcription factor: calculation of regulatory region occupancy from predicted binding affinities.</article-title>             <source>J Mol Biol</source>             <volume>323</volume>             <fpage>1</fpage>             <lpage>8</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Hallikas1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hallikas</surname><given-names>O</given-names></name><name name-style="western"><surname>Palin</surname><given-names>K</given-names></name><name name-style="western"><surname>Sinjushina</surname><given-names>N</given-names></name><name name-style="western"><surname>Rautiainen</surname><given-names>R</given-names></name><name name-style="western"><surname>Partanen</surname><given-names>J</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Genome-wide prediction of mammalian enhancers based on analysis of transcription-factor binding affinity.</article-title>             <source>Cell</source>             <volume>124</volume>             <fpage>47</fpage>             <lpage>59</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Wang1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>X</given-names></name><name name-style="western"><surname>Gao</surname><given-names>H</given-names></name><name name-style="western"><surname>Shen</surname><given-names>Y</given-names></name><name name-style="western"><surname>Weinstock</surname><given-names>GM</given-names></name><name name-style="western"><surname>Zhou</surname><given-names>J</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>A high-throughput percentage-of-binding strategy to measure binding energies in DNA-protein interactions: application to genome-scale site discovery.</article-title>             <source>Nucleic Acids Res</source>             <volume>36</volume>             <fpage>4863</fpage>             <lpage>4871</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Gustafsdottir1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gustafsdottir</surname><given-names>SM</given-names></name><name name-style="western"><surname>Schlingemann</surname><given-names>J</given-names></name><name name-style="western"><surname>Rada-Iglesias</surname><given-names>A</given-names></name><name name-style="western"><surname>Schallmeiner</surname><given-names>E</given-names></name><name name-style="western"><surname>Kamali-Moghaddam</surname><given-names>M</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>In vitro analysis of DNA-protein interactions by proximity ligation.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>3067</fpage>             <lpage>3072</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Mukherjee1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mukherjee</surname><given-names>S</given-names></name><name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name><name name-style="western"><surname>Jona</surname><given-names>G</given-names></name><name name-style="western"><surname>Wang</surname><given-names>XS</given-names></name><name name-style="western"><surname>Muzzey</surname><given-names>D</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Rapid analysis of the DNA-binding specificities of transcription factors with DNA microarrays.</article-title>             <source>Nat Genet</source>             <volume>36</volume>             <fpage>1331</fpage>             <lpage>1339</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Badis1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Badis</surname><given-names>G</given-names></name><name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name><name name-style="western"><surname>Philippakis</surname><given-names>AA</given-names></name><name name-style="western"><surname>Talukder</surname><given-names>S</given-names></name><name name-style="western"><surname>Gehrke</surname><given-names>AR</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Diversity and complexity in DNA recognition by transcription factors.</article-title>             <source>Science</source>             <volume>324</volume>             <fpage>1720</fpage>             <lpage>1723</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Zhu1">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>C</given-names></name><name name-style="western"><surname>Byers</surname><given-names>KJ</given-names></name><name name-style="western"><surname>McCord</surname><given-names>RP</given-names></name><name name-style="western"><surname>Shi</surname><given-names>Z</given-names></name><name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>High-resolution DNA-binding specificity analysis of yeast transcription factors.</article-title>             <source>Genome Res</source>             <volume>19</volume>             <fpage>556</fpage>             <lpage>566</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Warren2">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Warren</surname><given-names>CL</given-names></name><name name-style="western"><surname>Kratochvil</surname><given-names>NC</given-names></name><name name-style="western"><surname>Hauschild</surname><given-names>KE</given-names></name><name name-style="western"><surname>Foister</surname><given-names>S</given-names></name><name name-style="western"><surname>Brezinski</surname><given-names>ML</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Defining the sequence-recognition profile of DNA-binding molecules.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>103</volume>             <fpage>867</fpage>             <lpage>872</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Harbison1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Harbison</surname><given-names>CT</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>DB</given-names></name><name name-style="western"><surname>Lee</surname><given-names>TI</given-names></name><name name-style="western"><surname>Rinaldi</surname><given-names>NJ</given-names></name><name name-style="western"><surname>Macisaac</surname><given-names>KD</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Transcriptional regulatory code of a eukaryotic genome.</article-title>             <source>Nature</source>             <volume>431</volume>             <fpage>99</fpage>             <lpage>104</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-MacIsaac1">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>MacIsaac</surname><given-names>KD</given-names></name><name name-style="western"><surname>Wang</surname><given-names>T</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>DB</given-names></name><name name-style="western"><surname>Gifford</surname><given-names>DK</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>An improved map of conserved regulatory sites for Saccharomyces cerevisiae.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <fpage>113</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Borneman1">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Borneman</surname><given-names>AR</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>ZD</given-names></name><name name-style="western"><surname>Rozowsky</surname><given-names>J</given-names></name><name name-style="western"><surname>Seringhaus</surname><given-names>MR</given-names></name><name name-style="western"><surname>Gerstein</surname><given-names>M</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Transcription factor binding site identification in yeast: a comparison of high-density oligonucleotide and PCR-based microarray platforms.</article-title>             <source>Funct Integr Genomics</source>             <volume>7</volume>             <fpage>335</fpage>             <lpage>345</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Wei1">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wei</surname><given-names>CL</given-names></name><name name-style="western"><surname>Wu</surname><given-names>Q</given-names></name><name name-style="western"><surname>Vega</surname><given-names>VB</given-names></name><name name-style="western"><surname>Chiu</surname><given-names>KP</given-names></name><name name-style="western"><surname>Ng</surname><given-names>P</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>A global map of p53 transcription-factor binding sites in the human genome.</article-title>             <source>Cell</source>             <volume>124</volume>             <fpage>207</fpage>             <lpage>219</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Robertson1">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Robertson</surname><given-names>G</given-names></name><name name-style="western"><surname>Hirst</surname><given-names>M</given-names></name><name name-style="western"><surname>Bainbridge</surname><given-names>M</given-names></name><name name-style="western"><surname>Bilenky</surname><given-names>M</given-names></name><name name-style="western"><surname>Zhao</surname><given-names>Y</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Genome-wide profiles of STAT1 DNA association using chromatin immunoprecipitation and massively parallel sequencing.</article-title>             <source>Nat Methods</source>             <volume>4</volume>             <fpage>651</fpage>             <lpage>657</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Johnson1">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>DS</given-names></name><name name-style="western"><surname>Mortazavi</surname><given-names>A</given-names></name><name name-style="western"><surname>Myers</surname><given-names>RM</given-names></name><name name-style="western"><surname>Wold</surname><given-names>B</given-names></name></person-group>             <year>2007</year>             <article-title>Genome-wide mapping of in vivo protein-DNA interactions.</article-title>             <source>Science</source>             <volume>316</volume>             <fpage>1497</fpage>             <lpage>1502</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Stormo1">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>             <year>2000</year>             <article-title>DNA binding sites: representation and discovery.</article-title>             <source>Bioinformatics</source>             <volume>16</volume>             <fpage>16</fpage>             <lpage>23</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Berg1">
        <label>41</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Berg</surname><given-names>OG</given-names></name><name name-style="western"><surname>von Hippel</surname><given-names>PH</given-names></name></person-group>             <year>1987</year>             <article-title>Selection of DNA binding sites by regulatory proteins. Statistical-mechanical theory and application to operators and promoters.</article-title>             <source>J Mol Biol</source>             <volume>193</volume>             <fpage>723</fpage>             <lpage>750</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Granek1">
        <label>42</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Granek</surname><given-names>JA</given-names></name><name name-style="western"><surname>Clarke</surname><given-names>ND</given-names></name></person-group>             <year>2005</year>             <article-title>Explicit equilibrium modeling of transcription-factor binding and gene regulation.</article-title>             <source>Genome Biol</source>             <volume>6</volume>             <fpage>R87</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Manke1">
        <label>43</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Manke</surname><given-names>T</given-names></name><name name-style="western"><surname>Roider</surname><given-names>HG</given-names></name><name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name></person-group>             <year>2008</year>             <article-title>Statistical modeling of transcription factor binding affinities predicts regulatory interactions.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e1000039</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Roider1">
        <label>44</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Roider</surname><given-names>HG</given-names></name><name name-style="western"><surname>Kanhere</surname><given-names>A</given-names></name><name name-style="western"><surname>Manke</surname><given-names>T</given-names></name><name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name></person-group>             <year>2007</year>             <article-title>Predicting transcription factor affinities to DNA from a biophysical model.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>134</fpage>             <lpage>141</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-He1">
        <label>45</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>He</surname><given-names>X</given-names></name><name name-style="western"><surname>Chen</surname><given-names>CC</given-names></name><name name-style="western"><surname>Hong</surname><given-names>F</given-names></name><name name-style="western"><surname>Fang</surname><given-names>F</given-names></name><name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>A biophysical model for analysis of transcription factor interaction and binding site arrangement from genome-wide binding data.</article-title>             <source>PLoS One</source>             <volume>4</volume>             <fpage>e8155</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-vanOeffelen1">
        <label>46</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>van Oeffelen</surname><given-names>L</given-names></name><name name-style="western"><surname>Cornelis</surname><given-names>P</given-names></name><name name-style="western"><surname>Van Delm</surname><given-names>W</given-names></name><name name-style="western"><surname>De Ridder</surname><given-names>F</given-names></name><name name-style="western"><surname>De Moor</surname><given-names>B</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Detecting cis-regulatory binding sites for cooperatively binding proteins.</article-title>             <source>Nucleic Acids Res</source>             <volume>36</volume>             <fpage>e46</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Djordjevic1">
        <label>47</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Djordjevic</surname><given-names>M</given-names></name><name name-style="western"><surname>Sengupta</surname><given-names>AM</given-names></name><name name-style="western"><surname>Shraiman</surname><given-names>BI</given-names></name></person-group>             <year>2003</year>             <article-title>A biophysical approach to transcription factor binding site discovery.</article-title>             <source>Genome Res</source>             <volume>13</volume>             <fpage>2381</fpage>             <lpage>2390</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Kinney1">
        <label>48</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kinney</surname><given-names>JB</given-names></name><name name-style="western"><surname>Tkacik</surname><given-names>G</given-names></name><name name-style="western"><surname>Callan</surname><given-names>CG</given-names><suffix>Jr</suffix></name></person-group>             <year>2007</year>             <article-title>Precise physical models of protein-DNA interaction from high-throughput data.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>501</fpage>             <lpage>506</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Wang2">
        <label>49</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>J</given-names></name><name name-style="western"><surname>Morigen</surname></name></person-group>             <year>2009</year>             <article-title>BayesPI - a new model to study protein-DNA interactions: a case study of condition-specific protein binding parameters for Yeast transcription factors.</article-title>             <source>BMC Bioinformatics</source>             <volume>10</volume>             <fpage>345</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Foat1">
        <label>50</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Foat</surname><given-names>BC</given-names></name><name name-style="western"><surname>Morozov</surname><given-names>AV</given-names></name><name name-style="western"><surname>Bussemaker</surname><given-names>HJ</given-names></name></person-group>             <year>2006</year>             <article-title>Statistical mechanical modeling of genome-wide transcription factor occupancy data by MatrixREDUCE.</article-title>             <source>Bioinformatics</source>             <volume>22</volume>             <fpage>e141</fpage>             <lpage>149</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Gerland1">
        <label>51</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gerland</surname><given-names>U</given-names></name><name name-style="western"><surname>Moroz</surname><given-names>JD</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>             <year>2002</year>             <article-title>Physical constraints and functional characteristics of transcription factor-DNA interaction.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>99</volume>             <fpage>12015</fpage>             <lpage>12020</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Stormo2">
        <label>52</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name><name name-style="western"><surname>Fields</surname><given-names>DS</given-names></name></person-group>             <year>1998</year>             <article-title>Specificity, free energy and information content in protein-DNA interactions.</article-title>             <source>Trends Biochem Sci</source>             <volume>23</volume>             <fpage>109</fpage>             <lpage>113</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Hastings1">
        <label>53</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hastings</surname><given-names>WK</given-names></name></person-group>             <year>1970</year>             <article-title>Monte Carlo sampling methods using Markov chains and their applications.</article-title>             <source>Biometrika</source>             <volume>57</volume>             <fpage>97</fpage>             <lpage>109</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Gelman1">
        <label>54</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gelman</surname><given-names>A</given-names></name></person-group>             <year>2004</year>             <source>Bayesian data analysis</source>             <publisher-loc>Boca Raton, Fla.</publisher-loc>             <publisher-name>Chapman &amp; Hall/CRC</publisher-name>             <fpage>xxv</fpage>             <page-range>668</page-range>          </element-citation>
      </ref>
      <ref id="pone.0026105-Roberts1">
        <label>55</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Roberts</surname><given-names>GO</given-names></name><name name-style="western"><surname>Gelman</surname><given-names>A</given-names></name><name name-style="western"><surname>Gilks</surname><given-names>WR</given-names></name></person-group>             <year>1997</year>             <article-title>Weak Convergence and Optimal Scaling of Random Walk Metropolis Algorithms.</article-title>             <source>The Annals of Applied Probability</source>             <volume>7</volume>             <fpage>110</fpage>             <lpage>120</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Green1">
        <label>56</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Green</surname><given-names>PJ</given-names></name></person-group>             <year>1995</year>             <article-title>Reversible jump Markov chain Monte Carlo computation and Bayesian model determination.</article-title>             <source>Biometrika</source>             <volume>82</volume>             <fpage>711</fpage>             <lpage>732</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-AlAwadhi1">
        <label>57</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Al-Awadhi</surname><given-names>F</given-names></name><name name-style="western"><surname>Hurn</surname><given-names>M</given-names></name><name name-style="western"><surname>Jennison</surname><given-names>C</given-names></name></person-group>             <year>2004</year>             <article-title>Improving the acceptance rate of reversible jump MCMC proposals.</article-title>             <source>Statistics &amp; Probability Letters</source>             <volume>69</volume>             <fpage>189</fpage>             <lpage>198</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Pollock1">
        <label>58</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pollock</surname><given-names>DD</given-names></name><name name-style="western"><surname>Chang</surname><given-names>BH</given-names></name></person-group>             <year>2007</year>             <article-title>Dealing with Uncertainty in Ancestral Sequence Reconstruction: Sampling from the Posterior Distribution.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Liberles</surname><given-names>DA</given-names></name></person-group>             <source>Ancestral Sequence Reconstruction</source>             <publisher-loc>Oxford</publisher-loc>             <publisher-name>Oxford University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0026105-Haring1">
        <label>59</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Haring</surname><given-names>M</given-names></name><name name-style="western"><surname>Offermann</surname><given-names>S</given-names></name><name name-style="western"><surname>Danker</surname><given-names>T</given-names></name><name name-style="western"><surname>Horst</surname><given-names>I</given-names></name><name name-style="western"><surname>Peterhansel</surname><given-names>C</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Chromatin immunoprecipitation: optimization, quantitative analysis and data normalization.</article-title>             <source>Plant Methods</source>             <volume>3</volume>             <fpage>11</fpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Friden1">
        <label>60</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Friden</surname><given-names>P</given-names></name><name name-style="western"><surname>Schimmel</surname><given-names>P</given-names></name></person-group>             <year>1988</year>             <article-title>LEU3 of Saccharomyces cerevisiae activates multiple genes for branched-chain amino acid biosynthesis by binding to a common decanucleotide core sequence.</article-title>             <source>Mol Cell Biol</source>             <volume>8</volume>             <fpage>2690</fpage>             <lpage>2697</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Foat2">
        <label>61</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Foat</surname><given-names>BC</given-names></name><name name-style="western"><surname>Morozov</surname><given-names>AV</given-names></name><name name-style="western"><surname>Bussemaker</surname><given-names>HJ</given-names></name></person-group>             <year>2006</year>             <article-title>Statistical mechanical modeling of genome-wide transcription factor occupancy data by MatrixREDUCE.</article-title>             <source>Bioinformatics</source>             <volume>22</volume>             <fpage>e141</fpage>             <lpage>149</lpage>          </element-citation>
      </ref>
      <ref id="pone.0026105-Gangelhoff1">
        <label>62</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gangelhoff</surname><given-names>TA</given-names></name><name name-style="western"><surname>Mungalachetty</surname><given-names>PS</given-names></name><name name-style="western"><surname>Nix</surname><given-names>JC</given-names></name><name name-style="western"><surname>Churchill</surname><given-names>ME</given-names></name></person-group>             <year>2009</year>             <article-title>Structural analysis and DNA binding of the HMG domains of the human mitochondrial transcription factor A.</article-title>             <source>Nucleic Acids Res</source>             <volume>37</volume>             <fpage>3153</fpage>             <lpage>3164</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>