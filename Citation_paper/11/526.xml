<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-15-07295</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0131739</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Overfitting Bayesian Mixture Models with an Unknown Number of Components</article-title>
<alt-title alt-title-type="running-head">Overfitted Mixture Models</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>van Havre</surname> <given-names>Zoé</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>White</surname> <given-names>Nicole</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Rousseau</surname> <given-names>Judith</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Mengersen</surname> <given-names>Kerrie</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>School of Mathematical Sciences, Queensland University of Technology, Brisbane, Queensland, Australia</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>CEREMADE, Université Paris Dauphine, Paris, France</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Chen</surname> <given-names>Cathy W.S.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Feng Chia University, TAIWAN</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: ZvH NW JR KM. Performed the experiments: ZvH NW JR KM. Analyzed the data: ZvH NW JR KM. Contributed reagents/materials/analysis tools: ZvH NW JR KM. Wrote the paper: ZvH NW JR KM.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">zoe.vanhavre@qut.edu.au</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>15</day>
<month>7</month>
<year>2015</year>
</pub-date>
<volume>10</volume>
<issue>7</issue>
<elocation-id>e0131739</elocation-id>
<history>
<date date-type="received">
<day>17</day>
<month>2</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>4</day>
<month>6</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>van Havre et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0131739" xlink:type="simple"/>
<abstract>
<p>This paper proposes solutions to three issues pertaining to the estimation of finite mixture models with an unknown number of components: the non-identifiability induced by overfitting the number of components, the mixing limitations of standard Markov Chain Monte Carlo (MCMC) sampling techniques, and the related label switching problem. An overfitting approach is used to estimate the number of components in a finite mixture model via a Zmix algorithm. Zmix provides a bridge between multidimensional samplers and test based estimation methods, whereby priors are chosen to encourage extra groups to have weights approaching zero. MCMC sampling is made possible by the implementation of prior parallel tempering, an extension of parallel tempering. Zmix can accurately estimate the number of components, posterior parameter estimates and allocation probabilities given a sufficiently large sample size. The results will reflect uncertainty in the final model and will report the range of possible candidate models and their respective estimated probabilities from a single run. Label switching is resolved with a computationally light-weight method, Zswitch, developed for overfitted mixtures by exploiting the intuitiveness of allocation-based relabelling algorithms and the precision of label-invariant loss functions. Four simulation studies are included to illustrate Zmix and Zswitch, as well as three case studies from the literature. All methods are available as part of the R package <italic>Zmix</italic>, which can currently be applied to univariate Gaussian mixture models.</p>
</abstract>
<funding-group>
<funding-statement>This study was partially funded by an Australian Postgraduate Award and the Australian Research Council.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="4"/>
<page-count count="27"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>The case studies utilize previously published data which are widely available. All data used are included as part of the R package associated with this manuscript. The file "<xref ref-type="supplementary-material" rid="pone.0131739.s011">S1 File</xref>" includes both the instructions for installation and the code required to replicate the simulations, access the case studies, and perform the analyses.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Finite mixture models naturally arise when homogeneous subgroups or clusters are thought to be present in a population, and can also be used as flexible parametric models for estimating complex or unknown distributions [<xref ref-type="bibr" rid="pone.0131739.ref001">1</xref>]. Whether latent subgroups are present or not, their flexible framework has the potential to help tackle many research problems. As such they are useful tools in many fields including but not limited to genetic and medical research [<xref ref-type="bibr" rid="pone.0131739.ref002">2</xref>–<xref ref-type="bibr" rid="pone.0131739.ref004">4</xref>], econometrics [<xref ref-type="bibr" rid="pone.0131739.ref005">5</xref>], and image and sound analysis, where mixtures are used to perform complex tasks such as object tracking and speaker identification [<xref ref-type="bibr" rid="pone.0131739.ref006">6</xref>, <xref ref-type="bibr" rid="pone.0131739.ref007">7</xref>]. Despite their popularity, model estimation can be difficult when the number of components is unknown [<xref ref-type="bibr" rid="pone.0131739.ref008">8</xref>].</p>
<p>The density of a <italic>K</italic>-component mixture with respect to some measure is given by <xref ref-type="disp-formula" rid="pone.0131739.e002">Eq (1)</xref>, where <italic>π</italic><sub><italic>k</italic></sub> and <italic>θ</italic><sub><italic>k</italic></sub> denote the weight and associated emission parameters of component <italic>k</italic>, <italic>k</italic> = 1, …, <italic>K</italic>, with 0 &lt; <italic>π</italic><sub><italic>k</italic></sub> &lt; 1 satisfying <inline-formula id="pone.0131739.e001"><alternatives><graphic id="pone.0131739.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e001"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msub><mml:mi>π</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. This paper considers the situation where the emission densities <italic>f</italic>(<italic>y</italic>∣<italic>θ</italic><sub><italic>k</italic></sub>) belong to a parametric family, i.e. <italic>θ</italic><sub><italic>k</italic></sub> ∈ Θ ⊂ <bold>R</bold><sup><italic>d</italic></sup>. While mixtures are most often used for clustering and classification, the methods presented here can also be used for density estimation to obtain a sparse representation of an unknown distribution.
<disp-formula id="pone.0131739.e002"><alternatives><graphic id="pone.0131739.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e002"/><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msub><mml:mi>π</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>MCMC methods are commonly used for Bayesian estimation of complex hierarchical models such as mixtures, and Gibbs samplers are a special case of these where all parameters are estimated from their full conditional distributions [<xref ref-type="bibr" rid="pone.0131739.ref009">9</xref>–<xref ref-type="bibr" rid="pone.0131739.ref012">12</xref>]. This would be a tedious endeavour for finite mixture models if not for the inclusion of a latent allocation variable, a Multinomial <italic>Z</italic> = {<italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>n</italic></sub>}, where <italic>z</italic><sub><italic>i</italic></sub> ∼ 𝓜(1; <italic>π</italic><sub>1</sub>, …, <italic>π</italic><sub><italic>K</italic></sub>), so that <italic>y</italic><sub><italic>i</italic></sub>∣<italic>z</italic><sub><italic>i</italic></sub> = <italic>f</italic>(<italic>y</italic><sub><italic>i</italic></sub>∣<italic>θ</italic><sub><italic>z</italic><sub><italic>i</italic></sub></sub>) [<xref ref-type="bibr" rid="pone.0131739.ref013">13</xref>]. For each iteration <italic>t</italic> of a Gibbs sampler, the allocations <italic>Z</italic><sup>(<italic>t</italic>)</sup> are estimated first, then the parameters are generated from their component-wise conditional distributions based on the clustering in <italic>Z</italic><sup>(<italic>t</italic>)</sup>.</p>
<p>This paper addresses three important issues concerning mixture modelling when the number of components is unknown: (i) theoretical issues in estimating the number of components due to non-identifiability caused by overfitting, (ii) problems in applying standard Markov chain Monte Carlo (MCMC) sampling techniques, and (iii) the non-identifiability of the output of MCMC due to label switching. These issues are reviewed and then addressed in a coordinated manner, with the aim to develop a method for intuitive estimation of the number of components (also known as order estimation), resulting in a sparse yet representative posterior exhibiting clear separation between the estimated and unnecessary components.</p>
<sec id="sec002">
<title>Issue 1: Non-identifiability due to overfitting</title>
<p>Order estimation methods for finite mixtures can be loosely classified into two types of approaches: those which compare competing models (e.g. Bayes Factors [<xref ref-type="bibr" rid="pone.0131739.ref010">10</xref>, <xref ref-type="bibr" rid="pone.0131739.ref011">11</xref>]), and those which employ multidimensional samplers to directly estimate the distribution of <italic>K</italic> (e.g. Reversible Jump MCMC [<xref ref-type="bibr" rid="pone.0131739.ref014">14</xref>], the allocation sampler [<xref ref-type="bibr" rid="pone.0131739.ref015">15</xref>]). Overfitting, the act of including more components in a model than is supported by the data, is an integral part of both strategies as the former must fit at least one extra group to compare some criterion, whilst the latter implicitly explores an overfitted space to estimate <italic>K</italic>. Non-Bayesian methods for mixture estimation are particularly vulnerable to overfitting as it violates the regularity conditions required for maximum likelihood estimation and likelihood based goodness-of-fit criteria [<xref ref-type="bibr" rid="pone.0131739.ref001">1</xref>].</p>
<p>The difficulty with order estimation stems from the fact that overfitting induces a special type of non-identifiability in the posterior distribution of mixture models. Theoretically, any mixture distribution can be represented equally well by one with a larger number of groups, where some components have either merged together or have weights equal to zero [<xref ref-type="bibr" rid="pone.0131739.ref001">1</xref>, <xref ref-type="bibr" rid="pone.0131739.ref016">16</xref>–<xref ref-type="bibr" rid="pone.0131739.ref019">19</xref>]. Developments in the Bayesian asymptotic theory of overfitted mixture models by [<xref ref-type="bibr" rid="pone.0131739.ref020">20</xref>] provide a theoretical basis to use overfitting for order estimation.</p>
<p>[<xref ref-type="bibr" rid="pone.0131739.ref020">20</xref>] proved that quite generally, the posterior behaviour of overfitted mixtures depends on the chosen prior on the weights, and on the number of free parameters in the emission distributions (here “d”). Consider the prior on the weights <bold>P</bold><sub><italic>π</italic></sub>, which we take to follow a Dirichlet distribution, <bold>P</bold><sub><italic>π</italic></sub> = 𝓓(<italic>α</italic><sub>1</sub>, …, <italic>α</italic><sub><italic>K</italic></sub>). If <italic>min</italic>(<italic>α</italic><sub><italic>k</italic></sub>, <italic>k</italic> ≤ <italic>K</italic>) &gt; <italic>d</italic>/2, asymptotically two or more components in an overfitted mixture model will tend to merge with non-negligible weights. Conversely, if <italic>max</italic>(<italic>α</italic><sub><italic>k</italic></sub>, <italic>k</italic> ≤ <italic>K</italic>) &lt; <italic>d</italic>/2, the extra components are emptied at a rate of <italic>n</italic><sup>−1/2</sup>. Choosing a prior where <italic>max</italic>(<italic>α</italic><sub><italic>k</italic></sub>, <italic>k</italic> ≤ <italic>K</italic>) &lt; <italic>d</italic>/2 penalises the analysis more subtly than using the dimensions of the model or the number of parameters, placing mass on the sparsest configuration approximating the density in a uniquely Bayesian manner. In this context an exchangeable prior corresponds to choosing <italic>α</italic><sub>1</sub> = <italic>α</italic><sub>2</sub> = … = <italic>α</italic><sub><italic>K</italic></sub>, which is done hereafter in this paper.</p>
<p>Overfitting is an appealing solution for order estimation as it requires little input from the investigator; it simply involves selecting a large number of components (greater than the anticipated number), and choosing a prior which encourages the extra components to have weights close to zero. This approach was recognised in [<xref ref-type="bibr" rid="pone.0131739.ref021">21</xref>], where Section 22.4 on mixtures with an unspecified number of components focuses almost entirely on the strategy of deliberately overfitting for the purpose of order estimation. They recommend a straightforward approach of counting the components whose posterior weights are larger than some threshold. In practice, [<xref ref-type="bibr" rid="pone.0131739.ref021">21</xref>] suggest choosing <italic>α</italic> = <italic>n</italic><sub>0</sub>/<italic>K</italic>, where <italic>n</italic><sub>0</sub> is the prior sample size of the components with a default “noninformative” value of <italic>n</italic><sub>0</sub> = 1. However this leads to its own set of difficulties. First, extra components have a non-zero probability of being allocated observations, allowing MCMC samplers some freedom to explore the posterior surface. However, if the posterior weights of the extra, unwanted groups are not close enough to zero they become impossible to distinguish from the truly supported components. [<xref ref-type="bibr" rid="pone.0131739.ref021">21</xref>] note that components with small weights were sometimes found to have non-trivial posterior means. Second, some choices of <italic>K</italic> caused the posterior to contain several redundant, closely overlapping groups, indicating that some merging of extra components with the truth is allowed to occur under such a prior.</p>
<p>In this paper, we aim to place stronger bounds on <italic>α</italic> so that extra components with no support have posterior weights approaching zero, to the point where they are allocated no observations. When extra components can be said to have <italic>emptied</italic>, order estimation should be a simple case of reporting the number of alive (non-empty) components present in the posterior.</p>
</sec>
<sec id="sec003">
<title>Issue 2: Obtaining a well mixed MCMC sample</title>
<p>MCMC algorithms are prone to becoming trapped in regions of large posterior probability for high dimensional problems; they have a propensity for lack of mixing when the posterior contains multiple well separated modes [<xref ref-type="bibr" rid="pone.0131739.ref017">17</xref>]. Some argue this hinders MCMC estimation since the samplers cannot explore all potentially important regions of a target space, clusters may be missed, and thus the MCMC cannot be assumed to have converged [<xref ref-type="bibr" rid="pone.0131739.ref008">8</xref>].</p>
<p>Parallel tempering is a popular method originating in physics which improves mixing in multimodal situations. The general idea is to simulate <italic>J</italic> replicas of the original distribution of interest, each produced under a different “temperature”, and to sample from each of these allowing for information to flow between adjacent temperatures. The high temperature posteriors are increasingly flattened, providing less extreme surfaces which allow MCMC samplers to mix more freely, whereas the low temperature posteriors better reflect the precise distributions in a local region of the probability space, but have a strong risk of becoming trapped in local minima during sampling [<xref ref-type="bibr" rid="pone.0131739.ref022">22</xref>–<xref ref-type="bibr" rid="pone.0131739.ref024">24</xref>].</p>
<p>In essence, the higher temperature posteriors allow those of lower temperature to access a more complete set of regions in the posterior space. Tempering can be done in many ways, the most common approach being to raise the target distribution to a power <italic>T</italic> (where 0 ≤ <italic>T</italic> ≤ 1), which increasingly flattens the distribution as <italic>T</italic> → 0. While tempering is usually performed directly on the likelihood or the posterior distribution, it is also readily adaptable to other situations as recently demonstrated in an application to Approximate Bayesian Computation [<xref ref-type="bibr" rid="pone.0131739.ref025">25</xref>].</p>
<p>In the Methods section entitled “Prior Parallel Tempering (PPT)”, a parallel tempering algorithm is developed using <italic>α</italic> to directly control the degree of tempering as well as obtain the desired target distribution.</p>
</sec>
<sec id="sec004">
<title>Issue 3: Untangling the label switching</title>
<p>The third challenge is to retrieve the posterior estimates from the target chain of the MCMC. These are non-identifiable due to label switching, a phenomenon which occurs when exchangeable priors are placed on mixture parameters. Label switching results in a posterior which is invariant to permutations of the labelling of components [<xref ref-type="bibr" rid="pone.0131739.ref026">26</xref>]. In essence, the group names of two components ‘switch’ randomly during MCMC, resulting in the marginal posterior distributions of each parameter to be identical for all groups. Resolving the label switching can be a difficult task but its presence is proof of adequate mixing and is an important requirement to establish that an MCMC sampler has converged [<xref ref-type="bibr" rid="pone.0131739.ref027">27</xref>–<xref ref-type="bibr" rid="pone.0131739.ref029">29</xref>].</p>
<p>Excellent reviews of the label switching issue and a wide range of potential solutions can be found in [<xref ref-type="bibr" rid="pone.0131739.ref030">30</xref>] and [<xref ref-type="bibr" rid="pone.0131739.ref027">27</xref>]. An increasingly popular approach is to employ a relabelling scheme, such as that proposed by [<xref ref-type="bibr" rid="pone.0131739.ref026">26</xref>] and [<xref ref-type="bibr" rid="pone.0131739.ref031">31</xref>], where the posterior samples of the parameter of interest are clustered according to a k-means algorithm [<xref ref-type="bibr" rid="pone.0131739.ref030">30</xref>]. This method converges to local minima, so the results based on multiple starting points are compared to identify the optimal solution. This idea was extended by [<xref ref-type="bibr" rid="pone.0131739.ref008">8</xref>] who use the <italic>maximum a posteriori</italic> (MAP) estimate as the starting point of the clustering.</p>
<p>Another approach is to use label invariant loss functions, the idea being to identify some loss function based on a label invariant estimate and to select the permutation of the labelling which minimises this loss. For example if the allocations are computed, [<xref ref-type="bibr" rid="pone.0131739.ref032">32</xref>] propose a loss function based on the pairwise comparison of the allocations of each data point. To relabel the samples, the algorithm permutes the labelling to minimise this loss. However this can incur a high computational cost for mixtures with many components and rapidly become impractical [<xref ref-type="bibr" rid="pone.0131739.ref030">30</xref>].</p>
<p>Label switching in overfitted mixtures is particularly difficult to resolve as superfluous components may merge or overlap with other components, or may be empty, which negatively impacts on relabelling and clustering. The presence of many empty components is an additional level of complexity which is not generally accounted for by existing tools.</p>
<p>A new method for resolving the label switching problem is developed in the Methods section “Resolving the label switching with Zswitch” which aims to combine the MAP and relabelling approaches of [<xref ref-type="bibr" rid="pone.0131739.ref008">8</xref>] with the rich information available from the joint distribution of the allocations used by [<xref ref-type="bibr" rid="pone.0131739.ref032">32</xref>].</p>
</sec>
<sec id="sec005">
<title>Motivation</title>
<p>While overfitting is an appealing tool for Bayesian order estimation, the number of non-empty components in the posterior of overfitted mixtures cannot currently be used to estimate of the true number of components. Extra components always have a non-zero probability of being allocated some observations, the number of which is determined by the prior on the weights. Setting this to be very close to zero is not possible with current estimation methods as such a prior creates a sparse posterior surface comprised of isolated modes separated by areas of near-zero probability, inhibiting mixing.</p>
<p>The goal of this paper is to produce a sparse, representative posterior configuration of finite mixtures with an unknown number of components. We develop an extension to parallel tempering to enable a Gibbs sampler to sample from a well mixed posterior, where the unsupported components contain no observations, to explore if this can be used for simple order estimation.</p>
</sec>
</sec>
<sec id="sec006" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec007">
<title>Models and notation</title>
<p>Given observations <italic>Y</italic> = {<italic>y</italic><sub>1</sub>, …, <italic>y</italic><sub><italic>n</italic></sub>}, component weights <inline-formula id="pone.0131739.e003"><alternatives><graphic id="pone.0131739.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e003"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and component parameters <inline-formula id="pone.0131739.e004"><alternatives><graphic id="pone.0131739.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e004"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, the full likelihood of a mixture model can be written as <xref ref-type="disp-formula" rid="pone.0131739.e005">Eq 2</xref>. Here, <italic>K</italic> is the number of components included in the model, where the true number of components in <italic>Y</italic> is <italic>K</italic><sub>0</sub> and <italic>K</italic><sub>0</sub> &lt; <italic>K</italic>.
<disp-formula id="pone.0131739.e005"><alternatives><graphic id="pone.0131739.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e005"/><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>|</mml:mo> <mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mo>,</mml:mo> <mml:munder><mml:mi>θ</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msub><mml:mi>π</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
The allocations are modelled with a Multinomial variable <italic>Z</italic> = {<italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>n</italic></sub>}, where <italic>z</italic><sub><italic>i</italic></sub> ∼ 𝓜(1; <italic>π</italic><sub>1</sub>, …, <italic>π</italic><sub><italic>K</italic></sub>), so that <italic>y</italic><sub><italic>i</italic></sub>∣<italic>z</italic><sub><italic>i</italic></sub> = <italic>f</italic>(<italic>y</italic><sub><italic>i</italic></sub>∣<italic>θ</italic><sub><italic>z</italic><sub><italic>i</italic></sub></sub>) [<xref ref-type="bibr" rid="pone.0131739.ref013">13</xref>].</p>
<p>A Dirichlet prior is placed on the mixture weights {<italic>π</italic><sub>1</sub>, …, <italic>π</italic><sub><italic>K</italic></sub>} ∼ 𝓓(<italic>α</italic><sub>1</sub>, …, <italic>α</italic><sub><italic>K</italic></sub>). As this prior is always of the exchangeable form where <italic>α</italic><sub>1</sub> = <italic>α</italic><sub>2</sub> = … = <italic>α</italic><sub><italic>K</italic></sub>, <italic>α</italic><sub><italic>k</italic></sub> will be refered to as <italic>α</italic> from this point.</p>
</sec>
<sec id="sec008">
<title>Prior Parallel Tempering (PPT)</title>
<p>We aim to use the prior on the weights to define different degrees of tempering, setting up an approximation to classical tempering which simultaneously models a wide range of possible posterior configurations.</p>
<p><italic>J</italic> chains are included in the PPT algorithm, each indexed by <italic>j</italic>. In a Bayesian setting, each chain can be considered to have a different target posterior <italic>p</italic><sub><italic>j</italic></sub>(<italic>ζ</italic><sub><italic>j</italic></sub>∣<italic>Y</italic>). The <italic>ζ</italic><sub><italic>j</italic></sub> denote the full set of unknown parameters, such as <inline-formula id="pone.0131739.e006"><alternatives><graphic id="pone.0131739.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e006"/><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:munder accentunder="true"><mml:mi>μ</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>σ</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:munder accentunder="true"><mml:mi>π</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math>
</alternatives></inline-formula> for univariate Gaussian mixtures, and <inline-formula id="pone.0131739.e007"><alternatives><graphic id="pone.0131739.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e007"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:munder><mml:mi>μ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:msubsup><mml:munder><mml:mi>σ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:munder><mml:mi>σ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The posterior parameters sampled at each iteration <italic>t</italic> are denoted <inline-formula id="pone.0131739.e008"><alternatives><graphic id="pone.0131739.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e008"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. For iteration <italic>t</italic>, the posterior of the <italic>j</italic>’th chain is indexed as <inline-formula id="pone.0131739.e009"><alternatives><graphic id="pone.0131739.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e009"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">∣</mml:mo> <mml:mi>Y</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0131739.e010"><alternatives><graphic id="pone.0131739.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e010"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">∣</mml:mo> <mml:mi>Y</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∝</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>Y</mml:mi> <mml:mo stretchy="false">∣</mml:mo> <mml:msubsup><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>When a proposal is made to swap the samples of a pair of adjacent chains at a given iteration, a Metropolis-Hastings update on the joint distribution must be made. Consider the proposal to swap chains <italic>j</italic> and <italic>j</italic>′ at iteration <italic>t</italic>. The joint target of both chains can be written as <inline-formula id="pone.0131739.e011"><alternatives><graphic id="pone.0131739.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e011"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>ζ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">∣</mml:mo> <mml:mi>Y</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>ζ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">∣</mml:mo> <mml:mi>Y</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and the goal of tempering is to preserve this target, only accepting moves with probability <italic>min</italic>(1, <italic>A</italic>). The acceptance ratio is the joint density of the chains given the move is accepted, divided by the current joint density.</p>
<p>Omitting the iteration indicator <sup>(<italic>t</italic>)</sup> as all values are assumed to refer to the same iteration, the acceptance ratio formulation is as follows:
<disp-formula id="pone.0131739.e012"><alternatives><graphic id="pone.0131739.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e012"/><mml:math id="M12" display="block" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>=</mml:mo> <mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ζ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>|</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ζ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>|</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>In the case of PPT, the likelihood is the same in all chains, so <italic>p</italic><sub><italic>j</italic></sub>(<italic>Y</italic>∣<italic>ζ</italic><sub><italic>j</italic></sub>) = <italic>p</italic><sub><italic>j</italic>′</sub>(<italic>Y</italic>∣<italic>ζ</italic><sub><italic>j</italic></sub>) and <italic>p</italic><sub><italic>j</italic></sub>(<italic>Y</italic>∣<italic>ζ</italic><sub><italic>j</italic>′</sub>) = <italic>p</italic><sub><italic>j</italic>′</sub>(<italic>Y</italic>∣<italic>ζ</italic><sub><italic>j</italic>′</sub>). Expanding the ratio of posterior distributions reduces <italic>A</italic> to the prior densities:
<disp-formula id="pone.0131739.e013"><alternatives><graphic id="pone.0131739.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e013"/><mml:math id="M13" display="block" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ζ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>ζ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ζ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>ζ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula> <disp-formula id="pone.0131739.e014"><alternatives><graphic id="pone.0131739.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e014"/><mml:math id="M14" display="block" overflow="scroll"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>ζ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>ζ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>ζ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>Furthermore, as only the prior on the weights is allowed to change, <italic>A</italic> may be further simplified. Recalling the prior structure <italic>p</italic>(<italic>ζ</italic>) = <italic>p</italic>(<underline><italic>μ</italic></underline>)<italic>p</italic>(<underline><italic>σ</italic></underline><sup>2</sup>)<italic>p</italic>(<underline><italic>π</italic></underline>), <italic>A</italic> can be written as
<disp-formula id="pone.0131739.e015"><alternatives><graphic id="pone.0131739.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e015"/><mml:math id="M15" display="block" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>=</mml:mo> <mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>μ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>σ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>σ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>π</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>μ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>σ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>σ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>π</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>μ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>σ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>σ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>π</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>μ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>σ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>σ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>π</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula></p>
<p>Since <inline-formula id="pone.0131739.e016"><alternatives><graphic id="pone.0131739.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e016"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>μ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>σ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mpadded height="0pt" depth="0pt"><mml:mi>μ</mml:mi></mml:mpadded> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:munder><mml:mi>σ</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0131739.e017"><alternatives><graphic id="pone.0131739.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e017"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:munder><mml:mi>σ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:munder><mml:mi>σ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, the final acceptance ratio is comprised of four densities defined by the prior on the weights only:
<disp-formula id="pone.0131739.e018"><alternatives><graphic id="pone.0131739.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e018"/><mml:math id="M18" display="block" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>=</mml:mo> <mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula></p>
</sec>
<sec id="sec009">
<title>Sampling overfitted mixture models with PPT</title>
<p>We now set up Zmix, an MCMC sampling algorithm for mixture models which incorporates PPT into a collection of Gibbs samplers. A set of <italic>J</italic> parallel, independent samplers are set up, and as mentioned the degree of tempering is determined by the hyperparameter on the mixture weights, (<italic>α</italic><sub><italic>j</italic></sub>, <italic>j</italic> ≤ <italic>J</italic>). The set of <italic>α</italic><sub><italic>j</italic></sub> must be chosen to ensure a wide range of parallel chains and include values from well above <italic>d</italic>/2 to close to zero. As the overall goal is to sample from a posterior where extra components’ posterior weights are very close to zero, the chain generated by the smallest value of <italic>α</italic><sup><italic>j</italic></sup> in the PPT is referred to as the <italic>target</italic> chain of Zmix.</p>
<sec id="sec010">
<title>Choosing the candidate parameters (<italic>α</italic><sub><italic>j</italic></sub>, <italic>j</italic> ≤ <italic>J</italic>)</title>
<p>The choice of <italic>α</italic><sub><italic>j</italic></sub> is arbitrary at this point; a wide range allows a broad spectrum of posterior configurations to be generated, but values too far apart result in undesirably large changes between tempered chains (and the acceptance ratio of the PPT algorithm is rarely satisfied). The smallest hyperparameter, <italic>α</italic><sub><italic>J</italic></sub>, is set very close to zero to encourage unsupported components to have a negligible probability of being assigned observations. In practice, the success of the tempering is ensured by tracking the acceptance frequency of swaps between all chains to ensure an adequate acceptance rate. Values are chosen starting at <italic>α</italic><sub>1</sub> = 30 to ensure total merging in all simulations and examples included this paper.</p>
<p>Two sets of (<italic>α</italic><sub><italic>j</italic></sub>, <italic>j</italic> ≤ <italic>J</italic>) are explored, a larger range in the early exploratory stage, followed by a refined set. Initially <italic>J</italic> = 30 chains are used to explore the posterior behaviour of overfitted mixtures under increasingly extreme conditions with values according to <xref ref-type="disp-formula" rid="pone.0131739.e019">Eq 8</xref>.
<disp-formula id="pone.0131739.e019"><alternatives><graphic id="pone.0131739.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e019"/><mml:math id="M19" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>J</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mn>30</mml:mn> <mml:mo>,</mml:mo> <mml:mn>20</mml:mn> <mml:mo>,</mml:mo> <mml:mn>10</mml:mn> <mml:mo>,</mml:mo> <mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mn>3</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow> <mml:msup><mml:mn>5</mml:mn> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>3</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>4</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>5</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>6</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>8</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>9</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>10</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>15</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>20</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>30</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>35</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>40</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>45</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>5</mml:mn> <mml:mn>50</mml:mn></mml:msup> <mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
Subsequently, this is reduced to <italic>J</italic> = 25 chains (<xref ref-type="disp-formula" rid="pone.0131739.e020">Eq 9</xref>).</p>
<disp-formula id="pone.0131739.e020">
<alternatives>
<graphic id="pone.0131739.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e020"/>
<mml:math id="M20" display="block" overflow="scroll">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:msub>
<mml:mi>α</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mo>⋯</mml:mo>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>α</mml:mi>
<mml:mi>J</mml:mi>
</mml:msub>
<mml:mo>}</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>=</mml:mo>
<mml:mo>{</mml:mo>
<mml:mn>30</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>20</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>10</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>5</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>3</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>5</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
</mml:mrow>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>3</mml:mn>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>4</mml:mn>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>5</mml:mn>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>6</mml:mn>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>8</mml:mn>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>9</mml:mn>
</mml:msup>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>10</mml:mn>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>15</mml:mn>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>20</mml:mn>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:msup>
<mml:mn>5</mml:mn>
<mml:mn>30</mml:mn>
</mml:msup>
<mml:mrow>
<mml:mo>}</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
</sec>
<sec id="sec011">
<title>Zmix Algorithm</title>
<p>Recall that a Gibbs sampler [<xref ref-type="bibr" rid="pone.0131739.ref009">9</xref>] is based on drawing samples from the full conditional distributions of each unknown variable, and that PPT requires only the prior on the weights to differ between chains.</p>
<p>Define <inline-formula id="pone.0131739.e021"><alternatives><graphic id="pone.0131739.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e021"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as the set of <italic>K</italic> weights for chain <italic>j</italic> where <italic>j</italic> = 1, …, <italic>J</italic>. The prior on the weights is denoted <inline-formula id="pone.0131739.e022"><alternatives><graphic id="pone.0131739.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e022"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∼</mml:mo> <mml:mo>𝓓</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The density of the distribution of <inline-formula id="pone.0131739.e023"><alternatives><graphic id="pone.0131739.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e023"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> given the allocations <italic>Z</italic><sub><italic>j</italic>(<italic>t</italic>)</sub> at iteration <italic>t</italic> is written <inline-formula id="pone.0131739.e024"><alternatives><graphic id="pone.0131739.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e024"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">∣</mml:mo> <mml:msubsup><mml:mi>Z</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Similarly, the parameters of the components of chain <italic>j</italic> are indiced as <inline-formula id="pone.0131739.e025"><alternatives><graphic id="pone.0131739.e025g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e025"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Since the distribution of the parameters given the allocations and the data is the same across all chains, we write <inline-formula id="pone.0131739.e026"><alternatives><graphic id="pone.0131739.e026g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e026"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">∣</mml:mo> <mml:msubsup><mml:mi>Z</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>Y</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for iteration <italic>t</italic>.</p>
<p>Before Zmix is implemented a choice of <italic>u</italic> must be made, which determines the probability a tempering move will be attempted at a given iteration. For clarity, note that each parameter is first indexed by tempering chain <italic>j</italic>, for example the weights in a chain are <inline-formula id="pone.0131739.e027"><alternatives><graphic id="pone.0131739.e027g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e027"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and the allocations <italic>Z</italic><sub><italic>j</italic></sub>. More specificity is added by including another level when required, so that for example the <italic>k</italic>’th element of <inline-formula id="pone.0131739.e028"><alternatives><graphic id="pone.0131739.e028g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e028"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is denoted <italic>π</italic><sub><italic>j</italic><sub><italic>k</italic></sub></sub>.</p>
<p>MCMC sampling of the unknown parameters then proceeds as follows.
<list list-type="order">
<list-item><p>Initialise: Choose starting values for parameters <inline-formula id="pone.0131739.e029"><alternatives><graphic id="pone.0131739.e029g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e029"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0131739.e030"><alternatives><graphic id="pone.0131739.e030g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e030"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in all chains.</p></list-item> <list-item><p>Step t: For each iteration <italic>t</italic> = 1, …, 
<list list-type="alpha-lower">
<list-item><p><italic>Gibbs sampling.</italic> For each chain <italic>j</italic> = 1, …, <italic>J</italic>,
<list list-type="roman-lower">
<list-item><p>Generate the allocations <inline-formula id="pone.0131739.e031"><alternatives><graphic id="pone.0131739.e031g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e031"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, from
<disp-formula id="pone.0131739.e032"><alternatives><graphic id="pone.0131739.e032g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e032"/><mml:math id="M32" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:msub><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>=</mml:mo> <mml:mi>k</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:munder><mml:mi>θ</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>∝</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mrow><mml:msub><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mrow><mml:msub><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
for each <italic>i</italic> = 1, …., <italic>n</italic> and <italic>k</italic> = 1, …, <italic>K</italic>,</p></list-item>
<list-item><p>Generate <inline-formula id="pone.0131739.e033"><alternatives><graphic id="pone.0131739.e033g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e033"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> from
<disp-formula id="pone.0131739.e034"><alternatives><graphic id="pone.0131739.e034g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e034"/><mml:math id="M34" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub><mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>Z</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>𝓓</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mi>K</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
with <inline-formula id="pone.0131739.e035"><alternatives><graphic id="pone.0131739.e035g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e035"/><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item>
<list-item><p>Generate <inline-formula id="pone.0131739.e036"><alternatives><graphic id="pone.0131739.e036g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e036"/><mml:math id="M36" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> from <inline-formula id="pone.0131739.e037"><alternatives><graphic id="pone.0131739.e037g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e037"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:msubsup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo stretchy="false">∣</mml:mo> <mml:msubsup><mml:mi>Z</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>Y</mml:mi> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p></list-item></list></p></list-item>
<list-item><p><italic>Exchanging the chains</italic>.</p>
<p>With probability <italic>u</italic> ∼ 𝓤(0, 1):
<list list-type="roman-lower">
<list-item><p>Draw <italic>j</italic> randomly from the set (1:<italic>J</italic> − 1), selecting chains <italic>j</italic> and <italic>j</italic>′ = <italic>j</italic> + 1 as candidates for tempering.</p></list-item>
<list-item><p>Accept the move with probability <italic>A</italic>, where
<disp-formula id="pone.0131739.e038"><alternatives><graphic id="pone.0131739.e038g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e038"/><mml:math id="M38" display="block" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>=</mml:mo> <mml:mo movablelimits="true" form="prefix">min</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub><mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>(</mml:mo> <mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mrow><mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub><mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mrow><mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>(</mml:mo> <mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo>̲</mml:mo></mml:munder> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
and perform the tempering:
<list list-type="simple"><list-item><p>A. Exchange <inline-formula id="pone.0131739.e039"><alternatives><graphic id="pone.0131739.e039g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e039"/><mml:math id="M39" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0131739.e040"><alternatives><graphic id="pone.0131739.e040g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e040"/><mml:math id="M40" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>,</p></list-item>
<list-item><p>B. Exchange <inline-formula id="pone.0131739.e041"><alternatives><graphic id="pone.0131739.e041g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e041"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0131739.e042"><alternatives><graphic id="pone.0131739.e042g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e042"/><mml:math id="M42" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and</p></list-item>
<list-item><p>C. Exchange <inline-formula id="pone.0131739.e043"><alternatives><graphic id="pone.0131739.e043g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e043"/><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0131739.e044"><alternatives><graphic id="pone.0131739.e044g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e044"/><mml:math id="M44" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item></list></p></list-item>
<list-item><p>Return to Step 2(a).</p></list-item></list></p></list-item></list></p></list-item></list></p>
</sec>
<sec id="sec012">
<title>Important quantities</title>
<p>The number of non-empty components at each iteration <italic>t</italic> (after a burn in period) for chain <italic>j</italic> is <inline-formula id="pone.0131739.e045"><alternatives><graphic id="pone.0131739.e045g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e045"/><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi> <mml:msub><mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and we set <inline-formula id="pone.0131739.e046"><alternatives><graphic id="pone.0131739.e046g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e046"/><mml:math id="M46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:msub><mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:msubsup><mml:mi>K</mml:mi> <mml:msub><mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>K</mml:mi> <mml:msub><mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The distinct values of <inline-formula id="pone.0131739.e047"><alternatives><graphic id="pone.0131739.e047g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e047"/><mml:math id="M47" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:msub><mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are defined as 𝓚<sub><italic>k</italic><sub>0</sub></sub> for <inline-formula id="pone.0131739.e048"><alternatives><graphic id="pone.0131739.e048g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e048"/><mml:math id="M48" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>∈</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo accent="true">‾</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (where <inline-formula id="pone.0131739.e049"><alternatives><graphic id="pone.0131739.e049g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e049"/><mml:math id="M49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo accent="true">‾</mml:mo></mml:mover> <mml:msub><mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the maximum number of alive (non-empty) groups observed in chain <italic>j</italic>). The mode of the empirical distribution of <inline-formula id="pone.0131739.e050"><alternatives><graphic id="pone.0131739.e050g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e050"/><mml:math id="M50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:msub><mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is <inline-formula id="pone.0131739.e051"><alternatives><graphic id="pone.0131739.e051g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e051"/><mml:math id="M51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:msub><mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec013">
<title>Choice of mixture distribution</title>
<p>The asymptotic theory underpinning this paper can be applied to a wide range of mixture distributions, so a univariate Gaussian mixture model is adopted with <italic>f</italic>(.∣<italic>θ</italic><sub><italic>k</italic></sub>) ∼ 𝓝(<italic>μ</italic><sub><italic>k</italic></sub>, <italic>σ</italic><sub><italic>k</italic></sub>). A hierarchical prior is used on <italic>θ</italic><sub><italic>k</italic></sub> where <inline-formula id="pone.0131739.e052"><alternatives><graphic id="pone.0131739.e052g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e052"/><mml:math id="M52" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, in the conjugate form. This involves an Inverse Gamma prior on the variances <inline-formula id="pone.0131739.e053"><alternatives><graphic id="pone.0131739.e053g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e053"/><mml:math id="M53" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup> <mml:mo>∼</mml:mo> <mml:msup><mml:mo>𝓖</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and a Gaussian prior on the means <inline-formula id="pone.0131739.e054"><alternatives><graphic id="pone.0131739.e054g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e054"/><mml:math id="M54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Hyperparameters are set to <inline-formula id="pone.0131739.e055"><alternatives><graphic id="pone.0131739.e055g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e055"/><mml:math id="M55" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, <italic>a</italic> = 2.5, <inline-formula id="pone.0131739.e056"><alternatives><graphic id="pone.0131739.e056g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e056"/><mml:math id="M56" display="inline" overflow="scroll"><mml:mrow><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:mi>l</mml:mi> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>τ</italic> = 1. This formulation is chosen to facilitate Gibbs sampling, particularly the choice of <inline-formula id="pone.0131739.e057"><alternatives><graphic id="pone.0131739.e057g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e057"/><mml:math id="M57" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> which centres the prior for the means within the range of the observed sample. This speeds up convergence compared to choosing a value not within the range of the observations.</p>
</sec>
</sec>
<sec id="sec014">
<title>Resolving label switching with Zswitch</title>
<p>A relabelling algorithm is proposed here inspired by the methods of [<xref ref-type="bibr" rid="pone.0131739.ref008">8</xref>] and [<xref ref-type="bibr" rid="pone.0131739.ref032">32</xref>]. Unless otherwise indicated, all notation in this section relates to the target chain <italic>j</italic> = <italic>J</italic> of the tempering algorithm. For each iteration <italic>t</italic>, let <inline-formula id="pone.0131739.e058"><alternatives><graphic id="pone.0131739.e058g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e058"/><mml:math id="M58" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> denote the number of non-empty groups. Then for <italic>k</italic><sub>0</sub> = 1, …, <italic>K</italic>, let <inline-formula id="pone.0131739.e059"><alternatives><graphic id="pone.0131739.e059g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e059"/><mml:math id="M59" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mi>t</mml:mi> <mml:mo>;</mml:mo> <mml:msubsup><mml:mi>K</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denote the set of iterations for which <inline-formula id="pone.0131739.e060"><alternatives><graphic id="pone.0131739.e060g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e060"/><mml:math id="M60" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>For each value of <italic>k</italic><sub>0</sub>, choose a reference set of allocations <italic>Z</italic><sup>0</sup> and corresponding parameters <inline-formula id="pone.0131739.e061"><alternatives><graphic id="pone.0131739.e061g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e061"/><mml:math id="M61" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, permuting the labels so that the first <italic>k</italic><sub>0</sub> groups are non-empty. Here, the reference is chosen as the MAP estimator of the target posterior, computed using only non-empty components.</p>
<p>For each iteration <italic>t</italic> ∈ <italic>T</italic>(<italic>k</italic><sub>0</sub>) let <inline-formula id="pone.0131739.e062"><alternatives><graphic id="pone.0131739.e062g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e062"/><mml:math id="M62" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> be the number of observations assigned to component <italic>k</italic> (for <italic>k</italic> = 1, …, <italic>K</italic>), and let the vector <inline-formula id="pone.0131739.e063"><alternatives><graphic id="pone.0131739.e063g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e063"/><mml:math id="M63" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder accentunder="true"><mml:mi>λ</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> be the labels of the non-empty components.</p>
<p>The joint distribution of the current and reference allocations is summarised by creating a <italic>k</italic><sub>0</sub> × <italic>k</italic><sub>0</sub> table <italic>M</italic>, where <italic>M</italic><sub>(<italic>r</italic>, <italic>c</italic>)</sub> is the cell pertaining to row <italic>r</italic> and column <italic>c</italic>, the columns denote the reference labels, and the rows denote the elements of <inline-formula id="pone.0131739.e064"><alternatives><graphic id="pone.0131739.e064g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e064"/><mml:math id="M64" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>λ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The value of <italic>M</italic><sub>(<italic>r</italic>, <italic>c</italic>)</sub> is the number of observations assigned to the component labelled <inline-formula id="pone.0131739.e065"><alternatives><graphic id="pone.0131739.e065g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e065"/><mml:math id="M65" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> which are also in the reference group labelled <italic>c</italic>.</p>
<p>The table <italic>M</italic> is the key of Zswitch and is used to identify the subset of reference components which have a similar membership to each current component. The tuning parameter <italic>m</italic>, defined below, determines the sensitivity of the algorithm by designating the minimum proportion of the observations from each component which must belong to some reference group before it is considered a candidate for relabelling.</p>
<p>For each row <italic>r</italic> = 1, …, <italic>k</italic><sub>0</sub>, let <italic>I</italic><sup><italic>r</italic></sup> be the set of labels such that the proportion of observations shared by the current group and reference group exceeds a threshold <italic>m</italic>, that is <inline-formula id="pone.0131739.e066"><alternatives><graphic id="pone.0131739.e066g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e066"/><mml:math id="M66" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>I</mml:mi> <mml:mi>r</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mi>c</mml:mi> <mml:mo>;</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mi>r</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mi>m</mml:mi> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Since <italic>I</italic><sup><italic>r</italic></sup> is a set of labels, ∣<italic>I</italic><sup><italic>r</italic></sup>∣ denotes the size of the set, and <italic>I</italic><sup><italic>r</italic></sup> × <italic>I</italic><sup><italic>r</italic></sup>* is the Cartesian product between <italic>I</italic><sup><italic>r</italic></sup> and <italic>I</italic><sup><italic>r</italic></sup>*. Let <inline-formula id="pone.0131739.e067"><alternatives><graphic id="pone.0131739.e067g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e067"/><mml:math id="M67" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mi>r</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> denote the updated or resolved label for <inline-formula id="pone.0131739.e068"><alternatives><graphic id="pone.0131739.e068g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e068"/><mml:math id="M68" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>If ∣<italic>I</italic><sup><italic>r</italic></sup>∣ = 1, then <inline-formula id="pone.0131739.e069"><alternatives><graphic id="pone.0131739.e069g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e069"/><mml:math id="M69" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>I</mml:mi> <mml:mi>r</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. In addition, if <inline-formula id="pone.0131739.e070"><alternatives><graphic id="pone.0131739.e070g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e070"/><mml:math id="M70" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mo>∑</mml:mo> <mml:msub><mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msup> <mml:mo stretchy="false">∣</mml:mo> <mml:msup><mml:mi>I</mml:mi> <mml:mi>r</mml:mi></mml:msup> <mml:mo stretchy="false">∣</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, then <inline-formula id="pone.0131739.e071"><alternatives><graphic id="pone.0131739.e071g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e071"/><mml:math id="M71" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>λ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Updating the values of <inline-formula id="pone.0131739.e072"><alternatives><graphic id="pone.0131739.e072g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e072"/><mml:math id="M72" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>λ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> relabels all associated allocations (<italic>Z</italic><sup>(<italic>t</italic>)</sup>) and parameters (<italic>θ</italic><sup>(<italic>t</italic>)</sup>), resolving the label switching.</p>
<p>If <inline-formula id="pone.0131739.e073"><alternatives><graphic id="pone.0131739.e073g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e073"/><mml:math id="M73" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>r</mml:mi></mml:msup><mml:mo>∣</mml:mo><mml:mi> </mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, there are multiple candidate labels for at least one component. The final choice is the permutation of the candidate labels which minimises the distance between the current and reference parameters under each possible relabelling scheme, as follows. Let <italic>S</italic><sub><italic>I</italic></sub> be the set of permutations from <italic>I</italic><sup><italic>r</italic></sup> to <italic>I</italic><sup><italic>r</italic></sup>, the Cartesian product of the <italic>k</italic><sub>0</sub> sets <italic>I</italic><sup>1</sup>, …, <inline-formula id="pone.0131739.e074"><alternatives><graphic id="pone.0131739.e074g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e074"/><mml:math id="M74" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>I</mml:mi> <mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e075"><alternatives><graphic id="pone.0131739.e075g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e075"/><mml:math id="M75" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mi>I</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>I</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>×</mml:mo> <mml:mo>…</mml:mo> <mml:mo>×</mml:mo> <mml:msup><mml:mi>I</mml:mi> <mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The final relabelling scheme <italic>v</italic>* is then identified as
<disp-formula id="pone.0131739.e076"><alternatives><graphic id="pone.0131739.e076g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e076"/><mml:math id="M76" display="block" overflow="scroll"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>*</mml:mo> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>g</mml:mi><mml:mspace width="1pt"/><mml:munder><mml:mo movablelimits="true" form="prefix">min</mml:mo> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi>I</mml:mi> <mml:mi>r</mml:mi></mml:msup></mml:mrow></mml:munder> <mml:mo>|</mml:mo> <mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup></mml:mfrac></mml:mstyle> <mml:mo>|</mml:mo> <mml:mo>+</mml:mo> <mml:mo>|</mml:mo> <mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup></mml:mfrac></mml:mstyle> <mml:mo>|</mml:mo> <mml:mo>+</mml:mo> <mml:mo>|</mml:mo> <mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup></mml:mfrac></mml:mstyle> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
All parameters and allocations are then relabelled according to <inline-formula id="pone.0131739.e077"><alternatives><graphic id="pone.0131739.e077g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e077"/><mml:math id="M77" display="inline" overflow="scroll"><mml:msub><mml:munder accentunder="true"><mml:mi>λ</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:munder accentunder="true"><mml:mi>λ</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>v</mml:mi><mml:mo>*</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>r</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.</p>
<sec id="sec015">
<title>Zswitch algorithm</title>
<p>Define the number of observations assigned to each group <italic>k</italic> = 1, …, <italic>K</italic> at each iteration as <inline-formula id="pone.0131739.e078"><alternatives><graphic id="pone.0131739.e078g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e078"/><mml:math id="M78" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>For <italic>k</italic><sub>0</sub> = 1, …, <italic>K</italic>, <inline-formula id="pone.0131739.e079"><alternatives><graphic id="pone.0131739.e079g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e079"/><mml:math id="M79" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mi>t</mml:mi> <mml:mo>;</mml:mo> <mml:msubsup><mml:mi>K</mml:mi> <mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>:
<list list-type="order"><list-item><p>Select reference <italic>Z</italic><sup>0</sup> and <inline-formula id="pone.0131739.e080"><alternatives><graphic id="pone.0131739.e080g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e080"/><mml:math id="M80" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Permute the labels of <inline-formula id="pone.0131739.e081"><alternatives><graphic id="pone.0131739.e081g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e081"/><mml:math id="M81" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi>Z</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn></mml:msup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> so that the first <italic>k</italic><sub>0</sub> groups are non-empty.</p></list-item> <list-item><p>Step <italic>t</italic>: For each iteration <italic>t</italic> ∈ <italic>T</italic>(<italic>k</italic><sub>0</sub>),
<list list-type="alpha-lower"><list-item><p><italic>Phase one: Allocation-based relabelling.</italic> <list list-type="roman-lower"><list-item><p>For <italic>k</italic> = 1, …, <italic>K</italic>, compute <inline-formula id="pone.0131739.e082"><alternatives><graphic id="pone.0131739.e082g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e082"/><mml:math id="M82" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item> <list-item><p>Create <inline-formula id="pone.0131739.e083"><alternatives><graphic id="pone.0131739.e083g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e083"/><mml:math id="M83" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder accentunder="true"><mml:mi>λ</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, the vector of component labels for which <inline-formula id="pone.0131739.e084"><alternatives><graphic id="pone.0131739.e084g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e084"/><mml:math id="M84" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for <italic>k</italic> = {1, …, <italic>K</italic>}.</p></list-item> <list-item><p>Construct <italic>M</italic>, a <italic>k</italic><sub>0</sub> × <italic>k</italic><sub>0</sub> table and set
<disp-formula id="pone.0131739.e085"><alternatives><graphic id="pone.0131739.e085g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e085"/><mml:math id="M85" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msub><mml:mn mathvariant="bold">1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>×</mml:mo> <mml:msub><mml:mn mathvariant="bold">1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mspace width="1.em"/><mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula></p></list-item> <list-item><p>For <italic>r</italic> = 1, …, <italic>k</italic><sub>0</sub>, start with an empty set <italic>I</italic><sup><italic>r</italic></sup> = <italic>ϕ</italic>, and let
<disp-formula id="pone.0131739.e086"><alternatives><graphic id="pone.0131739.e086g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e086"/><mml:math id="M86" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mi>I</mml:mi> <mml:mi>r</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mi>c</mml:mi> <mml:mo>;</mml:mo> <mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msubsup><mml:mi>n</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mstyle> <mml:mo>&gt;</mml:mo> <mml:mi>m</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula> <list list-type="simple"><list-item><p>If ∣<italic>I</italic><sup><italic>r</italic></sup>∣ = 1, let <inline-formula id="pone.0131739.e087"><alternatives><graphic id="pone.0131739.e087g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e087"/><mml:math id="M87" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>r</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item></list></p></list-item> <list-item><p>If <inline-formula id="pone.0131739.e088"><alternatives><graphic id="pone.0131739.e088g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e088"/><mml:math id="M88" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>r</mml:mi></mml:msup><mml:mo>∣</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, relabel <italic>Z</italic><sup>(<italic>t</italic>)</sup> and <inline-formula id="pone.0131739.e089"><alternatives><graphic id="pone.0131739.e089g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e089"/><mml:math id="M89" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> by setting <inline-formula id="pone.0131739.e090"><alternatives><graphic id="pone.0131739.e090g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e090"/><mml:math id="M90" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>λ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mover><mml:munder><mml:mi>λ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and exit loop.</p></list-item> <list-item><p>If <inline-formula id="pone.0131739.e091"><alternatives><graphic id="pone.0131739.e091g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e091"/><mml:math id="M91" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>r</mml:mi></mml:msup><mml:mo>∣</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, proceed with <italic>Phase two</italic>.</p></list-item></list></p></list-item> <list-item><p><italic>Phase two: Parameter-based relabelling</italic> <list list-type="roman-lower"><list-item><p>Let <italic>S</italic><sub><italic>I</italic></sub> be the set of permutations from <italic>I</italic><sup><italic>r</italic></sup> to <italic>I</italic><sup><italic>r</italic></sup>, found by computing the <italic>k</italic><sub>0</sub>-fold Cartesian product <inline-formula id="pone.0131739.e092"><alternatives><graphic id="pone.0131739.e092g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e092"/><mml:math id="M92" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mi>I</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>I</mml:mi> <mml:mn>1</mml:mn></mml:msup> <mml:mo>×</mml:mo><mml:mo>…</mml:mo> <mml:mo>×</mml:mo><mml:msup><mml:mi>I</mml:mi> <mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item> <list-item><p>Find the permutation <italic>v</italic>* for which: <disp-formula id="pone.0131739.e093"><alternatives><graphic id="pone.0131739.e093g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e093"/><mml:math id="M93" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mi>v</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>g</mml:mi> <mml:munder><mml:mo movablelimits="true" form="prefix">min</mml:mo> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:msup><mml:mi>I</mml:mi> <mml:mi>r</mml:mi></mml:msup></mml:msub></mml:mrow></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi>I</mml:mi> <mml:mi>r</mml:mi></mml:msup></mml:mrow></mml:munder> <mml:mo>|</mml:mo> <mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup></mml:mfrac></mml:mstyle> <mml:mo>|</mml:mo> <mml:mo>+</mml:mo> <mml:mo>|</mml:mo> <mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup></mml:mfrac></mml:mstyle> <mml:mo>|</mml:mo> <mml:mo>+</mml:mo> <mml:mo>|</mml:mo> <mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup></mml:mfrac></mml:mstyle> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula></p></list-item> <list-item><p>Relabel <italic>Z</italic><sup>(<italic>t</italic>)</sup> and <inline-formula id="pone.0131739.e094"><alternatives><graphic id="pone.0131739.e094g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e094"/><mml:math id="M94" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>θ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> by setting <inline-formula id="pone.0131739.e095"><alternatives><graphic id="pone.0131739.e095g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e095"/><mml:math id="M95" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>λ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:msup><mml:mi>I</mml:mi> <mml:mi>r</mml:mi></mml:msup></mml:msub></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mover><mml:munder><mml:mi>λ</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mrow><mml:msup><mml:mi>v</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi>I</mml:mi> <mml:mi>r</mml:mi></mml:msup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item></list></p></list-item></list></p></list-item></list></p>
<p>To ensure the success of Zswitch, density plots are created for each set of relabelled posterior parameter estimates, and we deem the Zswitch successful when these are all clearly unimodal.</p>
</sec>
</sec>
<sec id="sec016">
<title>Simulations and case studies</title>
<p>The results are presented according to the following evaluation strategy, which is designed to explore the impact of <italic>α<sup>j</sup></italic>, and particularly the behaviour of the target posterior. Replicate simulation studies are included to explore the consistency of the observed behaviour, and case studies are also included for comparison with existing literature.</p>
<sec id="sec017">
<title>Simulations</title>
<p>A set of simulations representing a range of univariate Gaussian mixtures is used to test and illustrate Zmix and Zswitch. Gaussian mixture models are considered, with unknown means and variances for all components. Four simulations illustrate the methods in this paper, denoted Sim 1- 4. <xref ref-type="fig" rid="pone.0131739.g001">Fig 1</xref> includes histograms of samples where <italic>n</italic> = 200 from each simulation as well as the density of the true underlying distribution. Sim 1 defines a well separated mixture of <italic>K</italic><sub>0</sub> = 3 components. Sim 2 has the same number of groups but they are closer together, with two high peaks whose tails overlap with a central component with a larger variance. Sim 3 represents a scenario where the <italic>K</italic><sub>0</sub> = 2 components are difficult distinguish; all parameters except the variances are equal, producing a unimodal density. Sim 4 contains <italic>K</italic><sub>0</sub> = 3 components, where 99% of the observations are expected to represent only two components with close means, while a third, better separated component is only allocated 1% of the weight. Sim 4 describes a situation where true groups with small weights exist, to better understand how these can best be identified.</p>
<fig id="pone.0131739.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Description of the four simulations considered in this paper.</title>
<p>Density plots of the mixture distributions are indicated by a dashed line, and histograms of a single realisation of each simulation (with n = 200) are included.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.g001"/>
</fig>
<p>The parameters of the simulations are as follows:
<list list-type="simple"><list-item><p><bold>Sim 1</bold> <italic>K</italic><sub>0</sub> = 3 with <inline-formula id="pone.0131739.e096"><alternatives><graphic id="pone.0131739.e096g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e096"/><mml:math id="M96" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>3</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic>μ</italic> = {15, 7, 1} and <italic>σ</italic><sup>2</sup> = {1, 1, 1}</p></list-item> <list-item><p><bold>Sim 2</bold> <italic>K</italic><sub>0</sub> = 3 with <inline-formula id="pone.0131739.e097"><alternatives><graphic id="pone.0131739.e097g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e097"/><mml:math id="M97" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>3</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic>μ</italic> = {−1, 10, 4} and <italic>σ</italic><sup>2</sup> = {0.5, 0.5, 3}.</p></list-item> <list-item><p><bold>Sim 3</bold> <italic>K</italic><sub>0</sub> = 2 with <inline-formula id="pone.0131739.e098"><alternatives><graphic id="pone.0131739.e098g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e098"/><mml:math id="M98" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic>μ</italic> = {1, 1} and <italic>σ</italic><sup>2</sup> = {10, 1}.</p></list-item> <list-item><p><bold>Sim 4</bold> <italic>K</italic><sub>0</sub> = 3 with <inline-formula id="pone.0131739.e099"><alternatives><graphic id="pone.0131739.e099g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e099"/><mml:math id="M99" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mi>π</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>6</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>39</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>01</mml:mn> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic>μ</italic> = {6, 10, 20} and <italic>σ</italic><sup>2</sup> = {1, 1, 0.5}.</p></list-item></list></p>
</sec>
<sec id="sec018">
<title>Evaluation strategy</title>
<list list-type="order">
<list-item>
<p><bold>Exploratory simulations</bold></p>
<p>For each of the four simulations, generate samples of size <italic>n</italic> = 100 and <italic>n</italic> = 200. Fit Zmix with <italic>K</italic> = 10 to each simulation, for 50,000 iterations and 30 chains. Store the last 20,000 iterations for all chains (<italic>j</italic> = 1, …, <italic>J</italic>).
<list list-type="alpha-lower"><list-item><p><bold>Number of non-empty components</bold>:</p>
<p>Compute <inline-formula id="pone.0131739.e100"><alternatives><graphic id="pone.0131739.e100g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e100"/><mml:math id="M100" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, the number of alive (non-empty) components at each iteration, for each chain (<italic>j</italic> = 1, …, <italic>J</italic>).</p></list-item> <list-item><p><bold>Model fit and parameter estimates</bold>:</p>
<p>Resolve the label switching for the target chain (where <italic>j</italic> = <italic>J</italic>) using Zswitch and proceed with post-processing (described in detail further on). Compute posterior estimates of all estimated parameters, including 95% credible intervals. Compute the posterior allocation probabilities of each observation and each alive component.</p></list-item></list></p>
</list-item>
<list-item>
<p><bold>Replicate simulations</bold> <list list-type="alpha-lower">
<list-item>
<p><bold>Number of non-empty components</bold></p>
<p>For <italic>n</italic> = 100 and <italic>n</italic> = 200, produce 20 replicates of each simulation.</p>
<p>Run Zmix for 20,000 iterations with <italic>K</italic> = 10 and 25 chains, saving the target chain (<italic>j</italic> = <italic>J</italic>) for each run after 5000 iterations.</p>
</list-item>
<list-item>
<p>Compute <inline-formula id="pone.0131739.e101"><alternatives><graphic id="pone.0131739.e101g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e101"/><mml:math id="M101" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for each iteration, storing the vector <inline-formula id="pone.0131739.e102"><alternatives><graphic id="pone.0131739.e102g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e102"/><mml:math id="M102" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Compute the proportion of each configuration represented, and the mode of the empirical distribution of <inline-formula id="pone.0131739.e103"><alternatives><graphic id="pone.0131739.e103g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e103"/><mml:math id="M103" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:msub><mml:mi>J</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
</list>
</p>
</list-item>
</list>
</sec>
<sec id="sec019">
<title>Case Studies</title>
<p>Three case studies are described to illustrate the results of Zmix and Zswitch in practice. The first case study is the <italic>Acidity</italic> dataset, which consists of the log acidity index for 155 lakes in the North-Eastern United States [<xref ref-type="bibr" rid="pone.0131739.ref018">18</xref>]. These have been previously analysed as a mixture of Gaussian distributions on the log scale by [<xref ref-type="bibr" rid="pone.0131739.ref018">18</xref>] who found evidence for two or three groups. [<xref ref-type="bibr" rid="pone.0131739.ref014">14</xref>] found evidence for three to five components with the same model with a Reversible Jump MCMC algorithm, while [<xref ref-type="bibr" rid="pone.0131739.ref021">21</xref>] overfit this dataset resulting in a posterior with two true components.</p>
<p>The second case study involves the <italic>Enzyme</italic> dataset found in [<xref ref-type="bibr" rid="pone.0131739.ref033">33</xref>], which consists of measurements of enzymatic activity in blood for an enzyme involved in the metabolism of carcinogenic substances (velocity and substrate concentration), for a group of 245 unrelated individuals. [<xref ref-type="bibr" rid="pone.0131739.ref033">33</xref>] first analysed this data and found a mixture of 2 skewed components using MLE. [<xref ref-type="bibr" rid="pone.0131739.ref014">14</xref>] found evidence for 3 to 5 components using RJMCMC. [<xref ref-type="bibr" rid="pone.0131739.ref034">34</xref>] also modelled this data with 2 skewed Gaussian components.</p>
<p>Finally, <italic>Galaxy</italic> data [<xref ref-type="bibr" rid="pone.0131739.ref035">35</xref>] is considered since it has been investigated by many researchers with a wide range of results [<xref ref-type="bibr" rid="pone.0131739.ref036">36</xref>–<xref ref-type="bibr" rid="pone.0131739.ref038">38</xref>]. It is a small dataset of 82 measurements of galaxy speeds from 6 segments of the sky. It is of particular interest as different order estimation methods have suggested that the data contains anywhere from 3 to 9 components [<xref ref-type="bibr" rid="pone.0131739.ref011">11</xref>, <xref ref-type="bibr" rid="pone.0131739.ref019">19</xref>, <xref ref-type="bibr" rid="pone.0131739.ref021">21</xref>, <xref ref-type="bibr" rid="pone.0131739.ref037">37</xref>, <xref ref-type="bibr" rid="pone.0131739.ref039">39</xref>–<xref ref-type="bibr" rid="pone.0131739.ref041">41</xref>]. [<xref ref-type="bibr" rid="pone.0131739.ref040">40</xref>] observed that extra components appears to be modelling underlying skewness present in the sample.</p>
</sec>
<sec id="sec020">
<title>Evaluation strategy for Case Studies</title>
<p>For each case study, run Zmix for 50,000 iterations. Extract the last 20,000 iterations of the target posterior. Subset by value of <inline-formula id="pone.0131739.e104"><alternatives><graphic id="pone.0131739.e104g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e104"/><mml:math id="M104" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and apply Zswitch and post-processing to each subset. Compute and save posterior mean of all estimated parameters, including 95% credible intervals, and posterior allocation probabilities for each configuration considered.</p>
</sec>
</sec>
<sec id="sec021">
<title>Post-processing</title>
<p>For all but the replicate simulation studies, the same post-processing is performed on the target posterior of the results of Zmix.</p>
<p>The iterations of the target chain are split into subsets by the number of non-empty components present at each iteration, <inline-formula id="pone.0131739.e105"><alternatives><graphic id="pone.0131739.e105g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e105"/><mml:math id="M105" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and the label switching is resolved for each of these according to Zswitch. Model quality statistics are particularly useful when multiple configurations are present as they allow further comparison of the candidate models, and the following statistics are computed for each subset processed by Zswitch.</p>
<p>For each considered configuration, identified by 𝓚<sub><italic>K</italic><sub>0</sub></sub>, the proportion of iterations represented is first computed to estimate the probability that the observations originate from a mixture with 𝓚<sub><italic>k</italic><sub>0</sub></sub> components, <italic>p</italic>(𝓚<sub><italic>k</italic><sub>0</sub></sub>). When 𝓚<sub><italic>k</italic><sub>0</sub></sub> = <italic>K</italic><sub>0</sub>, the proportion of the observations whose predicted allocations corresponds to their true groupings is computed. The mean absolute error (MAE) and mean squared error (MSE) are calculated using the unswitched parameter estimates.</p>
<p>The remaining statistics are based on posterior predictive testing, which are found by resampling the posterior samples of the parameters in the target chain in order to predict 10,000 datasets of the same size as the original data. Mean absolute errors (MAPE) and mean squared prediction errors (MSPE) are reported as an average over the replicates. Bayesian P-values estimating <italic>p</italic>(<italic>min</italic>(<italic>Y</italic><sup><italic>rep</italic></sup>) &lt; <italic>min</italic>(<italic>Y</italic>)) and <italic>p</italic>(<italic>max</italic>(<italic>Y</italic><sup><italic>rep</italic></sup>) &lt; <italic>max</italic>(<italic>Y</italic>)) are included, which we call <italic>P</italic><sub><italic>min</italic></sub> and <italic>P</italic><sub><italic>max</italic></sub>. Both are included as they can be useful in identifying a skewed fit. Predictive concordance is then computed, which can be interpreted as the average proportion of <italic>y</italic><sub><italic>i</italic></sub>’s that are not outliers given the model (based on the suggestion that any <italic>y</italic><sub><italic>i</italic></sub> that is in either 2.5% tail area of <inline-formula id="pone.0131739.e106"><alternatives><graphic id="pone.0131739.e106g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e106"/><mml:math id="M106" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> should be considered an outlier) [<xref ref-type="bibr" rid="pone.0131739.ref042">42</xref>]. An ideal fit should have a predictive concordance of around 95%[<xref ref-type="bibr" rid="pone.0131739.ref042">42</xref>].</p>
<p>A small set of plots is also created for each candidate configuration. Density plots of the posterior paramaters illustrate their distribution and the success of Zswitch at relabelling the output of Zmix. Also included is a plot of estimated allocation probabilities, and a plot of the density of 10,000 predicted datasets overlaid by a that of <italic>Y</italic> to allow for the overall fit to be explored and identification of areas of bad fit.</p>
<sec id="sec022">
<title>R Code</title>
<p>Please refer to <xref ref-type="supplementary-material" rid="pone.0131739.s011">S1 File</xref> to obtain the R code to perform all analyses described in the methods.</p>
</sec>
</sec>
</sec>
<sec id="sec023" sec-type="results">
<title>Results</title>
<p>The following results show that the number of alive components, the set of which is denoted <inline-formula id="pone.0131739.e107"><alternatives><graphic id="pone.0131739.e107g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e107"/><mml:math id="M107" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for the target of an overfitted mixture modelled with Zmix, provides a sparse estimate of the true number of components, <italic>K</italic><sub>0</sub>. Given a large enough sample size and a well mixed MCMC sampler, there is little or no variation in <inline-formula id="pone.0131739.e108"><alternatives><graphic id="pone.0131739.e108g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e108"/><mml:math id="M108" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and the mode of this distribution is equal to <italic>K</italic><sub>0</sub>. When the sample size is small relative to the complexity of the underlying mixture, <inline-formula id="pone.0131739.e109"><alternatives><graphic id="pone.0131739.e109g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e109"/><mml:math id="M109" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> encompasses a small range of likely configurations, which tend to include the true value as well as one or two more conservative estimates of the number of components. The estimated parameters and allocation probabilities corresponding to each model (or configuration) considered can be extracted directly from the target chain, and interpreted once label switching is resolved.</p>
<sec id="sec024">
<title>1. Exploratory simulations</title>
<sec id="sec025">
<title>1.(<italic>a</italic>) Exploring the distribution of <inline-formula id="pone.0131739.e110"><alternatives><graphic id="pone.0131739.e110g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e110"/><mml:math id="M110" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula></title>
<p>Boxplots illustrating the distribution of <inline-formula id="pone.0131739.e111"><alternatives><graphic id="pone.0131739.e111g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e111"/><mml:math id="M111" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are presented in <xref ref-type="fig" rid="pone.0131739.g002">Fig 2</xref> for each chain of Zmix <italic>j</italic> = {1, …, <italic>J</italic>}, where <italic>j</italic> = <italic>J</italic> corresponds to the target posterior. <xref ref-type="fig" rid="pone.0131739.g002">Fig 2</xref> contains these results for Sim 2, while the plots pertaining to the other simulations can be found in the supplementary material (<xref ref-type="supplementary-material" rid="pone.0131739.s001">S1</xref>, <xref ref-type="supplementary-material" rid="pone.0131739.s002">S2</xref>, and <xref ref-type="supplementary-material" rid="pone.0131739.s003">S3</xref> Figs).</p>
<fig id="pone.0131739.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Number of alive (non-empty) groups <inline-formula id="pone.0131739.e112"><alternatives><graphic id="pone.0131739.e112g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e112"/><mml:math id="M112" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for each chain <italic>j</italic> for Sim 2.</title>
<p>Results are shown for Sim 2, n = 100 (left) and n = 200 (right). Boxplots of the number of non-empty groups <inline-formula id="pone.0131739.e113"><alternatives><graphic id="pone.0131739.e113g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e113"/><mml:math id="M113" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for each chain <italic>j</italic> are included; each chain represents posterior samples from the Zmix sampler with the hyperparameter <italic>α</italic><sup><italic>j</italic></sup> on the mixture weights, the value of which is included in red for each <italic>j</italic>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.g002"/>
</fig>
<p>For the simulations in this paper, when <italic>α</italic><sup><italic>j</italic></sup> &gt; 5 all components merge so that none are empty. As <italic>α</italic><sup><italic>j</italic></sup> approaches <italic>d</italic>/2 = 1, a slight decrease in <inline-formula id="pone.0131739.e114"><alternatives><graphic id="pone.0131739.e114g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e114"/><mml:math id="M114" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mover><mml:mi>K</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> can be observed. As the threshold of <italic>d</italic>/2 is passed (at <italic>α<sup>j</sup></italic> = 1), and <italic>α<sup>j</sup></italic> decreases further, a steady drop in the number of non-empty groups is evident, which continues as <italic>α<sup>j</sup></italic> approaches zero.</p>
<p>Once <italic>α<sup>j</sup></italic> is close to zero (approximately 3 × 10<sup>−8</sup> here), the posterior distribution of <inline-formula id="pone.0131739.e115"><alternatives><graphic id="pone.0131739.e115g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e115"/><mml:math id="M115" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> appears to reach an equilibrium, and remain constant for all subsequent chains up to and including the target. The posterior behaviour of the target <inline-formula id="pone.0131739.e116"><alternatives><graphic id="pone.0131739.e116g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e116"/><mml:math id="M116" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is well exemplified by <xref ref-type="fig" rid="pone.0131739.g002">Fig 2</xref>, where the following can be observed. When the sample size is large enough (<italic>n</italic> = 200 here), <inline-formula id="pone.0131739.e117"><alternatives><graphic id="pone.0131739.e117g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e117"/><mml:math id="M117" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> represents a single configuration in all <italic>t</italic> iterations, so that <inline-formula id="pone.0131739.e118"><alternatives><graphic id="pone.0131739.e118g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e118"/><mml:math id="M118" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>j</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>j</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. This is inferred to be equal to the true number of components, and <inline-formula id="pone.0131739.e119"><alternatives><graphic id="pone.0131739.e119g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e119"/><mml:math id="M119" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. In the case where <italic>n</italic> = 100, the range of <inline-formula id="pone.0131739.e120"><alternatives><graphic id="pone.0131739.e120g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e120"/><mml:math id="M120" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> includes a small subset of likely configurations, in this case one with the true number of components, and an alternate posterior configuration with one fewer group.</p>
<p>This behaviour is observed consistently across the four simulations except for Sim 4 with <italic>n</italic> = 100, where the range of <inline-formula id="pone.0131739.e121"><alternatives><graphic id="pone.0131739.e121g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e121"/><mml:math id="M121" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder accentunder="true"><mml:mi>K</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> does not include the true value <italic>K</italic><sub>0</sub>; all iterations represent a posterior with only 2 groups. Since the true allocations are known here, it is noted that the component with <italic>π</italic><sub><italic>k</italic></sub> = 0.01 is not represented in this realisation Sim 4, and thus could not be estimated.</p>
</sec>
<sec id="sec026">
<title>1.(<italic>b</italic>) Model fit and parameter estimates</title>
<p>The candidate models found by Zmix defined by the values of 𝓚<sub><italic>K</italic><sub>0</sub></sub> for <inline-formula id="pone.0131739.e122"><alternatives><graphic id="pone.0131739.e122g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e122"/><mml:math id="M122" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are compared using the posterior parameter estimates obtained from the target posterior. A set of summary and model quality statistics computed for each configuration (or number of components) is included in <xref ref-type="table" rid="pone.0131739.t001">Table 1</xref>.</p>
<table-wrap id="pone.0131739.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.t001</object-id>
<label>Table 1</label>
<caption>
<title>Goodness-of-fit statistics for each simulation estimated by Zmix.</title>
</caption>
<alternatives>
<graphic id="pone.0131739.t001g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.t001"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1"><bold>Sim</bold></th>
<th align="left" rowspan="1" colspan="1"><bold>n</bold></th>
<th align="left" rowspan="1" colspan="1"><bold>𝓚<sub><italic>k</italic><sub>0</sub></sub></bold></th>
<th align="left" rowspan="1" colspan="1"><bold><italic>p</italic>(𝓚<sub><italic>k</italic><sub>0</sub></sub>)</bold></th>
<th align="left" rowspan="1" colspan="1"><bold>%</bold></th>
<th align="left" rowspan="1" colspan="1"><bold>{<italic>P</italic><sub><italic>min</italic></sub>, <italic>P</italic><sub><italic>max</italic></sub>}</bold></th>
<th align="left" rowspan="1" colspan="1"><bold>Con.</bold></th>
<th align="left" rowspan="1" colspan="1"><bold>MAPE</bold></th>
<th align="left" rowspan="1" colspan="1"><bold>MSPE</bold></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">100</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td char="." align="char" rowspan="1" colspan="1">0.87</td>
<td align="left" rowspan="1" colspan="1">-</td>
<td align="left" rowspan="1" colspan="1">0.85, 0.22</td>
<td char="." align="char" rowspan="1" colspan="1">0.93</td>
<td char="." align="char" rowspan="1" colspan="1">228.66</td>
<td char="." align="char" rowspan="1" colspan="1">964.68</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">100</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td char="." align="char" rowspan="1" colspan="1">0.13</td>
<td align="left" rowspan="1" colspan="1">99</td>
<td align="left" rowspan="1" colspan="1">0.88, 0.25</td>
<td char="." align="char" rowspan="1" colspan="1">0.92</td>
<td char="." align="char" rowspan="1" colspan="1">135.68</td>
<td char="." align="char" rowspan="1" colspan="1">335.44</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">200</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td char="." align="char" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">100</td>
<td align="left" rowspan="1" colspan="1">0.99, 0.74</td>
<td char="." align="char" rowspan="1" colspan="1">0.90</td>
<td char="." align="char" rowspan="1" colspan="1">225.48</td>
<td char="." align="char" rowspan="1" colspan="1">424.33</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">100</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td char="." align="char" rowspan="1" colspan="1">0.67</td>
<td align="left" rowspan="1" colspan="1">-</td>
<td align="left" rowspan="1" colspan="1">0.99, 0.99</td>
<td char="." align="char" rowspan="1" colspan="1">0.83</td>
<td char="." align="char" rowspan="1" colspan="1">149.78</td>
<td char="." align="char" rowspan="1" colspan="1">358.28</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">100</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td char="." align="char" rowspan="1" colspan="1">0.33</td>
<td align="left" rowspan="1" colspan="1">97</td>
<td align="left" rowspan="1" colspan="1">0.91, 0.97</td>
<td char="." align="char" rowspan="1" colspan="1">0.85</td>
<td char="." align="char" rowspan="1" colspan="1">111.24</td>
<td char="." align="char" rowspan="1" colspan="1">207.58</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">200</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td char="." align="char" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">97</td>
<td align="left" rowspan="1" colspan="1">1.00, 0.54</td>
<td char="." align="char" rowspan="1" colspan="1">0.89</td>
<td char="." align="char" rowspan="1" colspan="1">204.59</td>
<td char="." align="char" rowspan="1" colspan="1">353.47</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">100</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td char="." align="char" rowspan="1" colspan="1">0.78</td>
<td align="left" rowspan="1" colspan="1">-</td>
<td align="left" rowspan="1" colspan="1">0.48, 0.03</td>
<td char="." align="char" rowspan="1" colspan="1">0.98</td>
<td char="." align="char" rowspan="1" colspan="1">191.52</td>
<td char="." align="char" rowspan="1" colspan="1">576.03</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">100</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td char="." align="char" rowspan="1" colspan="1">0.22</td>
<td align="left" rowspan="1" colspan="1">70</td>
<td align="left" rowspan="1" colspan="1">0.46, 0.09</td>
<td char="." align="char" rowspan="1" colspan="1">0.98</td>
<td char="." align="char" rowspan="1" colspan="1">155.01</td>
<td char="." align="char" rowspan="1" colspan="1">443.28</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">200</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td char="." align="char" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">77</td>
<td align="left" rowspan="1" colspan="1">0.26, 0.01</td>
<td char="." align="char" rowspan="1" colspan="1">0.96</td>
<td char="." align="char" rowspan="1" colspan="1">327.23</td>
<td char="." align="char" rowspan="1" colspan="1">1059.17</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">100</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td char="." align="char" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">-</td>
<td align="left" rowspan="1" colspan="1">0.17, 0.34</td>
<td char="." align="char" rowspan="1" colspan="1">0.93</td>
<td char="." align="char" rowspan="1" colspan="1">92.24</td>
<td char="." align="char" rowspan="1" colspan="1">141.79</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">200</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td char="." align="char" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">99</td>
<td align="left" rowspan="1" colspan="1">0.78, 0.24</td>
<td char="." align="char" rowspan="1" colspan="1">0.93</td>
<td char="." align="char" rowspan="1" colspan="1">203.61</td>
<td char="." align="char" rowspan="1" colspan="1">539.50</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>𝓚<sub><italic>k</italic><sub>0</sub></sub> is the number of non-empty groups in the configuration considered in that row. <italic>p</italic>(𝓚<sub><italic>k</italic><sub>0</sub></sub>) is the estimated probability of this configuration. % refers to the percentage of observations correctly reclassified when the correct number of components has been estimated. <italic>Conc.</italic> is the concordance, {<italic>P</italic><sub><italic>min</italic></sub>, <italic>P</italic><sub><italic>max</italic></sub>} refer to the Bayesian P-values described in the methods. Finally the average Mean Absolute Prediction Errors (MAPE) and average Mean Squared Prediction Errors (MSPE) are included.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>For all simulations when <italic>n</italic> = 100, Zmix tends to place a higher probability on the configuration with fewer components, and when <italic>n</italic> = 200 a single configuration (or model) is represented in the posterior. The replicate study in the following section provides a comprehensive exploration of the distribution of <inline-formula id="pone.0131739.e123"><alternatives><graphic id="pone.0131739.e123g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e123"/><mml:math id="M123" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for each sample size and simulation. When <italic>n</italic> = 100, there is some ambiguity in the true number of components and a small subset of models is present in the results. For Sim 1, the model quality statistics in <xref ref-type="table" rid="pone.0131739.t001">Table 1</xref> exhibit a marked preference for the configuration with 𝓚<sub><italic>k</italic><sub>0</sub></sub> = 3. The statistics show a much smaller difference between competing configurations for the other, more complex simulations, particularly Sim 3.</p>
<p>These statistics do not provide a complete view of the fit of each configuration. For example, errors based on the estimated means invariably shrink slightly as more components are included. While large changes may be useful and appear to point towards the right number of components, we find visual evaluation tools to be quite illustrative and useful for decision making. We focus on the results of Sim 2 in the following paragraphs; all corresponding figures for the other simulations are available as supplementary material. Diagnostic plots can be found for Sim 1 <italic>n</italic> = 100 and <italic>n</italic> = 200 in <xref ref-type="supplementary-material" rid="pone.0131739.s004">S4</xref> and <xref ref-type="supplementary-material" rid="pone.0131739.s005">S5</xref> Figs, and the same for for Sim 3 can be found in <xref ref-type="supplementary-material" rid="pone.0131739.s006">S6</xref> and <xref ref-type="supplementary-material" rid="pone.0131739.s007">S7</xref>, and <xref ref-type="supplementary-material" rid="pone.0131739.s008">S8</xref> and <xref ref-type="supplementary-material" rid="pone.0131739.s009">S9</xref> Figs for Sim 4. Parameter summaries of all candidate configurations can be found in <xref ref-type="supplementary-material" rid="pone.0131739.s010">S1 Table</xref>.</p>
<p>Exploring the results of Sim 2, from <xref ref-type="table" rid="pone.0131739.t001">Table 1</xref> it is known that when n = 200 <italic>p</italic>(𝓚<sub><italic>k</italic>0</sub> = 3) = 1, and the resulting clustering is found to be very accurate with 97% of observations correctly reclassified. Diagnostic plots for Sim 2 with n = 200 can be found in <xref ref-type="fig" rid="pone.0131739.g003">Fig 3</xref>. The predictive density plots show the three component model fits the data very well, and there is almost no uncertainty in the clustering of each observation. It is observed that the label switching has been resolved successfully, with all posterior densities exhibiting a single mode. Posterior parameter estimates and 95% credible intervals are given in <xref ref-type="table" rid="pone.0131739.t002">Table 2</xref>. Parameters for n = 200 are tightly estimated with only the variances slightly inflated, attributable to the modest sample size.</p>
<fig id="pone.0131739.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Sim 2, <italic>n</italic> = 200, 𝓚<sub><italic>k</italic><sub>0</sub></sub> = 3.</title>
<p>Results of Zmix and Zswitch including, from top left to right: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a density plot of the data over the densities of 10,000 predicted datasets of the same size from the posterior.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.g003"/>
</fig>
<table-wrap id="pone.0131739.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.t002</object-id>
<label>Table 2</label>
<caption>
<title>Estimated parameters of Sim 2 and 95% credible intervals for n = 100 and n = 200.</title>
</caption>
<alternatives>
<graphic id="pone.0131739.t002g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.t002"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">n</th>
<th align="left" rowspan="1" colspan="1">𝓚<sub><italic>k</italic><sub>0</sub></sub></th>
<th align="left" rowspan="1" colspan="1"><italic>k</italic><sub>0</sub></th>
<th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0131739.e124">
<alternatives>
<graphic id="pone.0131739.e124g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e124"/>
<mml:math id="M124" display="inline" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mover>
<mml:mi>π</mml:mi>
<mml:mo accent="true">^</mml:mo>
</mml:mover>
<mml:msub>
<mml:mi>k</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula> (95% CI)</th>
<th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0131739.e125">
<alternatives>
<graphic id="pone.0131739.e125g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e125"/>
<mml:math id="M125" display="inline" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mover>
<mml:mi>μ</mml:mi>
<mml:mo accent="true">^</mml:mo>
</mml:mover>
<mml:msub>
<mml:mi>k</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula> (95% CI)</th>
<th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0131739.e126">
<alternatives>
<graphic id="pone.0131739.e126g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e126"/>
<mml:math id="M126" display="inline" overflow="scroll">
<mml:mrow>
<mml:msubsup>
<mml:mover>
<mml:mi>σ</mml:mi>
<mml:mo accent="true">^</mml:mo>
</mml:mover>
<mml:msub>
<mml:mi>k</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mn>2</mml:mn>
</mml:msubsup>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula> (95% CI)</th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="5" align="left" colspan="1"><italic>n</italic> = 100</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.55 (0.44, 0.67)</td>
<td align="left" rowspan="1" colspan="1">-0.68 (-1.14, 0.05)</td>
<td align="left" rowspan="1" colspan="1">2.29 (1.20, 4.89)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">0.45 (0.33, 0.56)</td>
<td align="left" rowspan="1" colspan="1">9.03 (8.13, 9.99)</td>
<td align="left" rowspan="1" colspan="1">5.48 (1.90, 9.28)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3*</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.51 (0.39, 0.62)*</td>
<td align="left" rowspan="1" colspan="1">-0.81 (-1.23, -0.42)*</td>
<td align="left" rowspan="1" colspan="1">1.69 (1.09, 2.69)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3*</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">0.38 (0.29, 0.48)*</td>
<td align="left" rowspan="1" colspan="1">9.79 (9.26, 10.30)*</td>
<td align="left" rowspan="1" colspan="1">2.31 (1.43, 3.82)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3*</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">0.11 (0.04, 0.21)*</td>
<td align="left" rowspan="1" colspan="1">3.85 (1.76, 5.48)*</td>
<td align="left" rowspan="1" colspan="1">3.95 (1.42, 10.54)*</td>
</tr>
<tr>
<td rowspan="3" align="left" colspan="1"><italic>n</italic> = 200</td>
<td align="left" rowspan="1" colspan="1">3*</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.53 (0.46, 0.60)*</td>
<td align="left" rowspan="1" colspan="1">-0.93 (-1.13, -0.73)*</td>
<td align="left" rowspan="1" colspan="1">0.98 (0.73, 1.32)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3*</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">0.35 (0.28, 0.42)*</td>
<td align="left" rowspan="1" colspan="1">9.88 (9.54, 10.23)*</td>
<td align="left" rowspan="1" colspan="1">1.80 (1.23, 2.65)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3*</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">0.12 (0.07, 0.18)*</td>
<td align="left" rowspan="1" colspan="1">4.25 (3.14, 5.32)*</td>
<td align="left" rowspan="1" colspan="1">3.77 (1.67, 8.39)*</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>𝓚<sub><italic>k</italic><sub>0</sub></sub> defines the number of non-empty groups in the configuration considered in that row, and is annotated by an asterisk when this is equal to the truth. The credible intervals which contain the true value of the parameter are identified with an asterisk.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>Two sets of plots describe the results of Zmix for Sim 2 with n = 100, as two possible configurations were reported. <xref ref-type="fig" rid="pone.0131739.g004">Fig 4</xref> illustrates these for both candidates, given <italic>p</italic>(𝓚<sub><italic>k</italic><sub>0</sub></sub> = 2) = 0.67, and <italic>p</italic>(𝓚<sub><italic>k</italic><sub>0</sub></sub> = 3) = 0.33 from <xref ref-type="table" rid="pone.0131739.t001">Table 1</xref>. For this simulation and sample size there is little difference evident in the overall fit of the model, and the predictive density plots are very close to <italic>Y</italic> for 𝓚<sub><italic>k</italic><sub>0</sub></sub> = 2 except for some skewness in the right tail. The same plots for 𝓚<sub><italic>k</italic><sub>0</sub></sub> = 3 show that this area of bad fit is resolved by adding an extra component. The allocation probabilities highlight the difference between the two configurations. When only 2 groups are included, there is some uncertainty in the posterior allocations of observations which fall in a small region between the estimated components. This region forms the extra component included in the alternate configuration, and here the allocations probabilities are very high for all observations: 97% of the allocation are correctly predicted under this model.</p>
<fig id="pone.0131739.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Summary of the results for Sim 2 and n = 100.</title>
<p>The first two rows of plots refer to 𝓚<sub><italic>k</italic><sub>0</sub></sub> = 2, and the lower set refers to 𝓚<sub><italic>k</italic><sub>0</sub></sub> = 3. Results of Zmix and Zswitch are presented including, from upper left to lower right of each set: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a density plot of the data over the densities of 10,000 predicted datasets of the same size from the posterior. A panel of plots is included for each candidate model found by Zmix.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.g004"/>
</fig>
<p>Looking at the posterior parameter estimates of all the simulations considered, which can be found in supplementary material <xref ref-type="supplementary-material" rid="pone.0131739.s010">S1 Table</xref>, parameter estimates when n = 200 are very close to the true underlying values with some variances slightly inflated. As can be expected, estimated variances are generally larger for the results where n = 100. Overall we find the clustering is very successful for these simulations when the correct number of components is estimated, ranging from 97% to 100% accuracy for all but Sim 3 (<xref ref-type="table" rid="pone.0131739.t001">Table 1</xref>). Sim 3 contains two components which overlap almost entirely, and here while the parameters are close to the truth, the posterior allocations are only correctly estimated for 70% to 77% of the observations.</p>
</sec>
</sec>
<sec id="sec027">
<title>2. Replicate simulation study</title>
<p>Recall that for the replicate simulation study, 20 realisations of each simulation were created and overfitted with <italic>K</italic> = 10 using Zmix and 25 chains. For each replicate, <inline-formula id="pone.0131739.e127"><alternatives><graphic id="pone.0131739.e127g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e127"/><mml:math id="M127" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is estimated as the most likely (most frequently observed) value of <inline-formula id="pone.0131739.e128"><alternatives><graphic id="pone.0131739.e128g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e128"/><mml:math id="M128" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. <xref ref-type="table" rid="pone.0131739.t003">Table 3</xref> shows the proportion of times each <inline-formula id="pone.0131739.e129"><alternatives><graphic id="pone.0131739.e129g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e129"/><mml:math id="M129" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mover><mml:mi>K</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is estimated for each simulation.</p>
<table-wrap id="pone.0131739.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.t003</object-id>
<label>Table 3</label>
<caption>
<title>Summary of the results for 20 replicate simulation study.</title>
</caption>
<alternatives>
<graphic id="pone.0131739.t003g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.t003"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1"/>
<th align="left" rowspan="1" colspan="1"/>
<th align="left" rowspan="1" colspan="1"><italic>Sim 1</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>Sim 2</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>Sim</italic> 3</th>
<th align="left" rowspan="1" colspan="1"><italic>Sim 4</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2" align="left" colspan="1">
<inline-formula id="pone.0131739.e130">
<alternatives>
<graphic id="pone.0131739.e130g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e130"/>
<mml:math id="M130" display="inline" overflow="scroll">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:msubsup>
<mml:munder>
<mml:mover>
<mml:mi>K</mml:mi>
<mml:mo accent="true">^</mml:mo>
</mml:mover>
<mml:mo accent="true">¯</mml:mo>
</mml:munder>
<mml:mn>0</mml:mn>
<mml:mi>J</mml:mi>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left" rowspan="1" colspan="1">n = 100</td>
<td char="." align="char" rowspan="1" colspan="1">0.00</td>
<td char="." align="char" rowspan="1" colspan="1">0.00</td>
<td char="." align="char" rowspan="1" colspan="1">0.55</td>
<td char="." align="char" rowspan="1" colspan="1">0.10</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">n = 200</td>
<td char="." align="char" rowspan="1" colspan="1">0.00</td>
<td char="." align="char" rowspan="1" colspan="1">0.00</td>
<td char="." align="char" rowspan="1" colspan="1">0.05</td>
<td char="." align="char" rowspan="1" colspan="1">0.00</td>
</tr>
<tr>
<td rowspan="2" align="left" colspan="1">
<inline-formula id="pone.0131739.e131">
<alternatives>
<graphic id="pone.0131739.e131g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e131"/>
<mml:math id="M131" display="inline" overflow="scroll">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:msubsup>
<mml:munder>
<mml:mover>
<mml:mi>K</mml:mi>
<mml:mo accent="true">^</mml:mo>
</mml:mover>
<mml:mo accent="true">¯</mml:mo>
</mml:munder>
<mml:mn>0</mml:mn>
<mml:mi>J</mml:mi>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:mn>2</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left" rowspan="1" colspan="1">n = 100</td>
<td char="." align="char" rowspan="1" colspan="1">0.75</td>
<td char="." align="char" rowspan="1" colspan="1">0.85</td>
<td char="." align="char" rowspan="1" colspan="1">*0.45</td>
<td char="." align="char" rowspan="1" colspan="1">0.55</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">n = 200</td>
<td char="." align="char" rowspan="1" colspan="1">0.00</td>
<td char="." align="char" rowspan="1" colspan="1">0.00</td>
<td char="." align="char" rowspan="1" colspan="1">*0.95</td>
<td char="." align="char" rowspan="1" colspan="1">0.30</td>
</tr>
<tr>
<td rowspan="2" align="left" colspan="1">
<inline-formula id="pone.0131739.e132">
<alternatives>
<graphic id="pone.0131739.e132g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e132"/>
<mml:math id="M132" display="inline" overflow="scroll">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:msubsup>
<mml:munder>
<mml:mover>
<mml:mi>K</mml:mi>
<mml:mo accent="true">^</mml:mo>
</mml:mover>
<mml:mo accent="true">¯</mml:mo>
</mml:munder>
<mml:mn>0</mml:mn>
<mml:mi>J</mml:mi>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:mn>3</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left" rowspan="1" colspan="1">n = 100</td>
<td char="." align="char" rowspan="1" colspan="1">*0.25</td>
<td char="." align="char" rowspan="1" colspan="1">*0.15</td>
<td char="." align="char" rowspan="1" colspan="1">0.00</td>
<td char="." align="char" rowspan="1" colspan="1">*0.35</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">n = 200</td>
<td char="." align="char" rowspan="1" colspan="1">*1.00</td>
<td char="." align="char" rowspan="1" colspan="1">*1.00</td>
<td char="." align="char" rowspan="1" colspan="1">0.00</td>
<td char="." align="char" rowspan="1" colspan="1">*0.70</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001">
<p>Each cell represents the proportion of replicates whose most commonly reported model corresponds to each value of <inline-formula id="pone.0131739.e133"><alternatives><graphic id="pone.0131739.e133g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e133"/><mml:math id="M133" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mover><mml:mi>K</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. These are computed over 20 replicates using the target chain of Zmix. A * indicates values corresponding to the true number of components for that simulation.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>For all simulations across most replicates, when <italic>n</italic> = 100 the <inline-formula id="pone.0131739.e134"><alternatives><graphic id="pone.0131739.e134g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e134"/><mml:math id="M134" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> include a small range of values of 𝓚<sub><italic>k</italic><sub>0</sub></sub>, as in the exploratory simulations. For Sim 1 and 2, when <italic>n</italic> = 200 every replicate estimates three components consistently. Sim 3 and 4 are more complex mixtures, and the target of Zmix often encompasses a small range of one to three configurations.</p>
<p>For small sample sizes <inline-formula id="pone.0131739.e135"><alternatives><graphic id="pone.0131739.e135g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e135"/><mml:math id="M135" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mover><mml:mi>K</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> tends to underestimate the number of components. With a small increase in sample size, the probability of <inline-formula id="pone.0131739.e136"><alternatives><graphic id="pone.0131739.e136g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e136"/><mml:math id="M136" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:munder><mml:mover><mml:mi>K</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn> <mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> providing a correct estimate of <italic>K</italic><sub>0</sub> increases sharply. This is most evident for the simpler simulations included, but also by a clear trend for Sim 3 and Sim 4.</p>
</sec>
<sec id="sec028">
<title>0.1 Case Studies</title>
<p>In the analysis of the three case studies, Zmix results in posterior configurations with the same number of components as the smallest number found by previous literature.</p>
<sec id="sec029">
<title>Acidity</title>
<p>Zmix finds that 2 components are best suited to model the <italic>Acidity</italic> data, with <italic>p</italic>(𝓚<sub><italic>k</italic><sub>0</sub></sub> = 2) = 1. The target posterior does not contain any estimates from another configuration, indicating there is no ambiguity in this decision. Referring to <xref ref-type="fig" rid="pone.0131739.g005">Fig 5</xref>, the two components are well separated and there is little uncertainty in the posterior allocations, which are slightly less sharply defined in a small region of overlap between the two groups. Posterior predictive plots indicate the model represents the data well, with no need for any more components.</p>
<fig id="pone.0131739.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Overfitting the <italic>Acidity</italic> dataset.</title>
<p>Results of Zmix and Zswitch including from upper left to lower right: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a density plot of the data over the densities of 10,000 predicted datasets of the same size from the posterior.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.g005"/>
</fig>
<p>The resulting mixture has tightly estimated posterior parameter estimates, included here with 95% credible intervals in brackets. One component is estimated with <inline-formula id="pone.0131739.e137"><alternatives><graphic id="pone.0131739.e137g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e137"/><mml:math id="M137" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>π</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>60</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>50</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>68</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0131739.e138"><alternatives><graphic id="pone.0131739.e138g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e138"/><mml:math id="M138" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>μ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>4</mml:mn> <mml:mo>.</mml:mo> <mml:mn>34</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>4</mml:mn> <mml:mo>.</mml:mo> <mml:mn>25</mml:mn> <mml:mo>,</mml:mo> <mml:mn>4</mml:mn> <mml:mo>.</mml:mo> <mml:mn>44</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e139"><alternatives><graphic id="pone.0131739.e139g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e139"/><mml:math id="M139" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>16</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>11</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>22</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, while the other has an estimated posterior weight of <inline-formula id="pone.0131739.e140"><alternatives><graphic id="pone.0131739.e140g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e140"/><mml:math id="M140" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>π</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>4</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>32</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>50</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and is described by <inline-formula id="pone.0131739.e141"><alternatives><graphic id="pone.0131739.e141g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e141"/><mml:math id="M141" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>μ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>6</mml:mn> <mml:mo>.</mml:mo> <mml:mn>23</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>6</mml:mn> <mml:mo>.</mml:mo> <mml:mn>03</mml:mn> <mml:mo>,</mml:mo> <mml:mn>6</mml:mn> <mml:mo>.</mml:mo> <mml:mn>39</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0131739.e142"><alternatives><graphic id="pone.0131739.e142g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e142"/><mml:math id="M142" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>31</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>19</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>50</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec030">
<title>Enzyme</title>
<p>Overfitting the <italic>Enzyme</italic> dataset with Zmix produces two possible alternate configurations with two or three components, in a similar manner to the simulation results observed where the sample size was too small. From <xref ref-type="table" rid="pone.0131739.t004">Table 4</xref> we obtain the probability that this data can be modelled by 2 components is <italic>p</italic>(𝓚<sub><italic>k</italic><sub>0</sub></sub> = 3) = 0.90, and find that three components are less likely, with <italic>p</italic>(𝓚<sub><italic>k</italic><sub>0</sub></sub> = 3) = 0.10.</p>
<table-wrap id="pone.0131739.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.t004</object-id>
<label>Table 4</label>
<caption>
<title>Goodness-of-fit statistics for each case study.</title>
</caption>
<alternatives>
<graphic id="pone.0131739.t004g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.t004"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">Case Study</th>
<th align="left" rowspan="1" colspan="1">𝓚<sub><italic>k</italic><sub>0</sub></sub></th>
<th align="left" rowspan="1" colspan="1"><italic>p</italic>(𝓚<sub><italic>k</italic><sub>0</sub></sub>)</th>
<th align="left" rowspan="1" colspan="1">(<italic>P</italic><sub><italic>min</italic></sub>, <italic>P</italic><sub><italic>max</italic></sub>)</th>
<th align="left" rowspan="1" colspan="1"><italic>Conc.</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>MAPE</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>MSPE</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Acidity</italic></td>
<td align="left" rowspan="1" colspan="1">2</td>
<td char="." align="char" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">(0.01, 0.99)</td>
<td char="." align="char" rowspan="1" colspan="1">0.91</td>
<td char="." align="char" rowspan="1" colspan="1">66.00</td>
<td char="." align="char" rowspan="1" colspan="1">48.61</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Enzyme</italic></td>
<td align="left" rowspan="1" colspan="1">2</td>
<td char="." align="char" rowspan="1" colspan="1">0.90</td>
<td align="left" rowspan="1" colspan="1">(1.00, 0.13)</td>
<td char="." align="char" rowspan="1" colspan="1">0.91</td>
<td char="." align="char" rowspan="1" colspan="1">54.63</td>
<td char="." align="char" rowspan="1" colspan="1">30.26</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Enzyme</italic></td>
<td align="left" rowspan="1" colspan="1">3</td>
<td char="." align="char" rowspan="1" colspan="1">0.10</td>
<td align="left" rowspan="1" colspan="1">(1.00, 0.58)</td>
<td char="." align="char" rowspan="1" colspan="1">0.88</td>
<td char="." align="char" rowspan="1" colspan="1">48.88</td>
<td char="." align="char" rowspan="1" colspan="1">23.98</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Galaxy</italic></td>
<td align="left" rowspan="1" colspan="1">2</td>
<td char="." align="char" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">(0.81, 0.42)</td>
<td char="." align="char" rowspan="1" colspan="1">0.96</td>
<td char="." align="char" rowspan="1" colspan="1">229.52</td>
<td char="." align="char" rowspan="1" colspan="1">1,480.50</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t004fn001">
<p>Goodness-of-fit statistics for each case study. 𝓚<sub><italic>k</italic><sub>0</sub></sub> is the number of non-empty groups in the configuration considered in that row. <italic>p</italic>(𝓚<sub><italic>k</italic><sub>0</sub></sub>) is the probability of this configuration estimated by Zmix. {<italic>P</italic><sub><italic>min</italic></sub>, <italic>P</italic><sub><italic>max</italic></sub>} refer to the Bayesian P- values described in the methods, <italic>Conc.</italic> is the concordance, followed by the average Mean Absolute Prediction Errors (MAPE) and average Mean Squared Prediction Errors (MSPE).</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>The posterior parameters describing each possible configuration are
<list list-type="bullet"><list-item><p>For 𝓚<sub><italic>k</italic><sub>0</sub></sub> = 2:</p>
<p><inline-formula id="pone.0131739.e143"><alternatives><graphic id="pone.0131739.e143g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e143"/><mml:math id="M143" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>π</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>60</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>54</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>67</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e144"><alternatives><graphic id="pone.0131739.e144g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e144"/><mml:math id="M144" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>μ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>19</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>18</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>21</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e145"><alternatives><graphic id="pone.0131739.e145g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e145"/><mml:math id="M145" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>01</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>01</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>01</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p><inline-formula id="pone.0131739.e146"><alternatives><graphic id="pone.0131739.e146g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e146"/><mml:math id="M146" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>π</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>40</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>33</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>46</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e147"><alternatives><graphic id="pone.0131739.e147g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e147"/><mml:math id="M147" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>μ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>27</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>16</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>38</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e148"><alternatives><graphic id="pone.0131739.e148g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e148"/><mml:math id="M148" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>25</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>18</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>33</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item> <list-item><p>For 𝓚<sub><italic>k</italic><sub>0</sub></sub> = 3:</p>
<p><inline-formula id="pone.0131739.e149"><alternatives><graphic id="pone.0131739.e149g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e149"/><mml:math id="M149" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>π</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>62</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>55</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>68</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e150"><alternatives><graphic id="pone.0131739.e150g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e150"/><mml:math id="M150" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>μ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>18</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>21</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e151"><alternatives><graphic id="pone.0131739.e151g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e151"/><mml:math id="M151" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>18</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>21</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p><inline-formula id="pone.0131739.e152"><alternatives><graphic id="pone.0131739.e152g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e152"/><mml:math id="M152" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>π</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>18</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>33</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e153"><alternatives><graphic id="pone.0131739.e153g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e153"/><mml:math id="M153" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>μ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>55</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>95</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e154"><alternatives><graphic id="pone.0131739.e154g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e154"/><mml:math id="M154" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>27</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>49</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p><inline-formula id="pone.0131739.e155"><alternatives><graphic id="pone.0131739.e155g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e155"/><mml:math id="M155" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>π</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>3</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>21</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>07</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>34</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e156"><alternatives><graphic id="pone.0131739.e156g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e156"/><mml:math id="M156" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>μ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>3</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>11</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>94</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>61</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0131739.e157"><alternatives><graphic id="pone.0131739.e157g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e157"/><mml:math id="M157" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>3</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>09</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>03</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>30</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item></list></p>
<p>Comparing the two candidate models with the model fit quantities in <xref ref-type="table" rid="pone.0131739.t004">Table 4</xref>, the inclusion of three components decrease the MAPE and MSPE slightly, but have little impact on the remaining statistics. Concordance is observed to decrease with the addition of a third component. The posterior predictive density plots in <xref ref-type="fig" rid="pone.0131739.g006">Fig 6</xref> reveals little difference between the fit of the two models, but the plot of the allocation probabilities reveals the difference in the candidate configurations. It is clear that the 2 component posterior provides a much more certain fit with no uncertainty in the clustering of the data, whereas the 3 component model exhibits much less clarity in the posterior allocation probabilities.</p>
<fig id="pone.0131739.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Overfitting the <italic>Enzyme</italic> dataset.</title>
<p>Results of Zmix and Zswitch including, from upper left to lower right: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a posterior predictive density plot of 10,000 replicates with the density of the data represented as a dashed line.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.g006"/>
</fig>
<p>This case study illustrates the importance of making a final choice based on the original goal of the analysis. Recall that the <italic>Enzyme</italic> dataset comprises measurements of enzymatic activity in blood for an enzyme involved in the metabolism of a carcinogenic substance. While the posterior may strongly favour 2 components, the fact that multiple configurations are included in <inline-formula id="pone.0131739.e158"><alternatives><graphic id="pone.0131739.e158g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e158"/><mml:math id="M158" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:munder><mml:mi>K</mml:mi> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:msub><mml:mi>J</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> indicates there is some non-negligible probability that this is the true number of components. The added cluster describes a smaller component with a larger mean, suggesting that a small group of patients with a different distribution of enzymatic activity characterised by a larger mean may be present. If a higher level of activity is believed to relate to a higher risk of cancer, for example, then further analyses on a subset of individuals with potentially higher risk may be of interest and the less likely model may be reported.</p>
</sec>
<sec id="sec031">
<title>Galaxy</title>
<p>Surprisingly given the small sample size, analysis of this dataset results in a stable target consistently representing only 2 components with similar means, <inline-formula id="pone.0131739.e159"><alternatives><graphic id="pone.0131739.e159g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e159"/><mml:math id="M159" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>μ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>21</mml:mn> <mml:mo>.</mml:mo> <mml:mn>33</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>20</mml:mn> <mml:mo>.</mml:mo> <mml:mn>76</mml:mn> <mml:mo>,</mml:mo> <mml:mn>21</mml:mn> <mml:mo>.</mml:mo> <mml:mn>9</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0131739.e160"><alternatives><graphic id="pone.0131739.e160g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e160"/><mml:math id="M160" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>μ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>19</mml:mn> <mml:mo>.</mml:mo> <mml:mn>47</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>15</mml:mn> <mml:mo>.</mml:mo> <mml:mn>8</mml:mn> <mml:mo>,</mml:mo> <mml:mn>22</mml:mn> <mml:mo>.</mml:mo> <mml:mn>69</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (see <xref ref-type="fig" rid="pone.0131739.g007">Fig 7</xref>). One has a large weight of <inline-formula id="pone.0131739.e161"><alternatives><graphic id="pone.0131739.e161g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e161"/><mml:math id="M161" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>π</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>72</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>54</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>86</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and small variance <inline-formula id="pone.0131739.e162"><alternatives><graphic id="pone.0131739.e162g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e162"/><mml:math id="M162" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mo>.</mml:mo> <mml:mn>69</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>.</mml:mo> <mml:mn>31</mml:mn> <mml:mo>,</mml:mo> <mml:mn>5</mml:mn> <mml:mo>.</mml:mo> <mml:mn>66</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, modelling the peak at the center of the range of <italic>Y</italic>, and the other is described by a smaller weight <inline-formula id="pone.0131739.e163"><alternatives><graphic id="pone.0131739.e163g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e163"/><mml:math id="M163" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>π</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>28</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>14</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>46</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, but a very large variance of <inline-formula id="pone.0131739.e164"><alternatives><graphic id="pone.0131739.e164g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e164"/><mml:math id="M164" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>57</mml:mn> <mml:mo>.</mml:mo> <mml:mn>23</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>30</mml:mn> <mml:mo>.</mml:mo> <mml:mn>41</mml:mn> <mml:mo>,</mml:mo> <mml:mn>106</mml:mn> <mml:mo>.</mml:mo> <mml:mn>97</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. This second group models the outlying values of the dataset at both tails. The posterior predictive density plot reveals that this is a reasonable model for these data, resulting in similar predicted replicates.</p>
<fig id="pone.0131739.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0131739.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Overfitting the <italic>Galaxy</italic> dataset.</title>
<p>Results of Zmix and Zswitch including, from top left to right: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a density plot of the data overlaid over the densities of 10,000 predicted datasets of the same size from the posterior.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.g007"/>
</fig>
<p>Since the fitted mixture model places no restrictions on the variance of the underlying mixture, this configuration is possible, and it appears reasonable to conclude that these data could have originated from such a model. Given the physical origins of the data however, it may be warranted to impose some restrictions on other priors or on the variances. [<xref ref-type="bibr" rid="pone.0131739.ref043">43</xref>] use astronomically motivated priors to model this dataset, and find evidence for 7 components. In the sensitivity study conducted in [<xref ref-type="bibr" rid="pone.0131739.ref019">19</xref>], it is shown that while there appears to be evidence for anywhere from two to eight components, there is a very large probability assigned to two components when the variances is allowed to be large. In terms of Zmix, recall that in the simulation studies, the algorithm was able to identify a component with a very small weight of <italic>π</italic><sub><italic>k</italic></sub> = 0.01 in 35% of replicates when n = 100, and 70% of replicates when <italic>n</italic> = 200; it is frequently able to identify well separated univariate Gaussian components when these are represented by as few as two or three observations in a sample. From these observations, there appears to be some evidence that the <italic>Galaxy</italic> dataset may not originate from a Gaussian mixture. If this distribution is Gaussian, a larger number of observations is required for Zmix to estimate a more complex configuration, or some restrictions must be placed.</p>
</sec>
</sec>
</sec>
<sec id="sec032" sec-type="conclusions">
<title>Discussion</title>
<p>The success of Zmix for order estimation is indicated by a close relationship between sample size and the underlying complexity of a mixture distribution to be overfitted. However, this is also true for all order estimation methods; a component must be adequately represented in the given sample before it can be estimated [<xref ref-type="bibr" rid="pone.0131739.ref001">1</xref>]. The algorithm is easy to implement and interpret, and requires only that a maximum number of components is specified and that this is larger than the expected upper bound of <italic>K</italic><sub>0</sub>. It is based on the same basic format and conditional distributions as a standard Gibbs sampler on a single parametric model, with the addition of a range of prior hyperparameter values implemented in the PPT algorithm.</p>
<p>Obtaining a well-mixed MCMC sample for mixtures can be a difficult task in mixture modelling even when <italic>K</italic><sub>0</sub> is known, and Zmix can also be used in such cases to ensure plentiful mixing. To ensure all groups merge in at least some tempered chains, the largest <italic>α</italic> used would need to be large compared to the sample size. When the number of groups is overfitted this is less important as the extra groups act as bridges between the supported modes, facilitating mixing.</p>
<p>Given a large enough sample size relative to the underlying complexity of a mixture, Zmix can provide an accurate estimate of the minimum number of components required to model the given data. When there is some uncertainty in the best configuration which fits the sample, Zmix produces a small range of candidate models. This commonly occurs when the sample size is small relative to the complexity of the mixture. Using the distribution of the number of non-empty components results in a strict subset of likely configurations smaller than that typically obtained by multidimensional samplers, as the chosen prior forbids components to be identical in the target posterior and prevents unnecessary groups from being allocated observations.</p>
<p>The method can underestimate the number of components present when there is a small sample size, or the observations represent many heavily overlapping groups. This is partially due to a hyperparameter on the mean and variance of the Gaussian distributions of each component; the <italic>τ</italic> hyperparameter. When <italic>τ</italic> = 1, the prior for the mean is strongly linked to the estimated variance of that component; such a prior assumes that the variance of the mean <italic>μ</italic><sub><italic>k</italic></sub> of each component is the same as the variance of that component, <inline-formula id="pone.0131739.e165"><alternatives><graphic id="pone.0131739.e165g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e165"/><mml:math id="M165" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. This choice may be too restrictive for certain applications, and lowering this value will prevent groups with small sample sizes from being assimilated into the tail of other groups. Overfitting with <italic>τ</italic> = 1 will cause the posterior to have a stronger preference for a model with fewer components and large variances over one with more groups characterised by large means and small variances. The value of <italic>τ</italic> can be adjusted easily in the R implementation of Zmix.</p>
<p>This behaviour is observed in the results of the Galaxy case study, where only two components are found by Zmix. It may be more reasonable to weaken the bounds on the variance of the means for this dataset to reflect our existing knowledge that the observations do come from many small, separate sections of space. Repeating the analysis with <italic>τ</italic> = 0.01 results in a posterior with a 100% probability of three non-empty components, placing the two small clusters in each tail in separate groups (results not shown).</p>
<p>The tempering algorithm (PPT) which is incorporated in Zmix allows for an exchange of information between the many potential overfitted posteriors, from fully merged configurations with many identical components to the sparsest configuration, where components either differ by at least one parameter or are empty. If an overfitted model with a value of the common hyperparameter <italic>α</italic> very close to zero is fit directly with no tempering, the extreme posterior surface prevents the sampler from exploring this space, no mixing is present, and the results often lead to a single group. PPT allows a better exploration of the posterior distribution, even for small values of <italic>α</italic>. The number of alive components hovers within a small range, providing a small set of candidate models for further comparison. Model averaging has not been considered in this paper but could also be a useful way to interpret the target posterior when multiple configurations are present.</p>
<p>In considering the number and range of <italic>α<sup>j</sup></italic> values which should be included in Zmix for each chain <italic>j</italic> = (1, …, <italic>J</italic>), the minimum <italic>α<sup>j</sup></italic> should theoretically define a space where all extra groups are expected to have weights approaching zero. Since the goal of Zmix is to overfit <italic>K</italic> intentionally in order to create empty components, it makes sense to set the smallest value of <italic>α</italic> in relation to <italic>n</italic> as well as <italic>d</italic>, selecting <italic>α</italic> much smaller than 1/<italic>n</italic>. Indeed by doing so, one expects the posterior distribution of the number of non empty components to converge to a point mass on the true number of components.</p>
<p>Aside from modelling and order estimation, the Zswitch algorithm proposed is able to rapidly undo the label switching in the target posterior of Zmix. It is at this stage designed specifically for dealing with the output of overfitted mixture models with empty components, but the method is available to be implemented in other applications as needed. It can be applied with little modification to any mixture modelling situation where a latent allocation parameter is included; the set of parameters utilised in the second phase of Zswitch simply needs to be updated to match the desired distribution. Please note that a rigorous comparison of the performance of Zswitch versus other relabelling methods has not been performed, and this is planned for future work.</p>
<p>It is theoretically possible for Zswitch to result in a computational overload in practice, if it attempts to compute large permutations of labels (for example, if 6 or more labels were to be permuted in the second step, Zswitch would need to compute 6! label permutations). This was however not observed in any of our experiments, and is unlikely to occur in practice; for 6! to need to be computed, a mixture posterior would have to contain 6 components all of which overlap heavily with each other. In the unlikely event this does occur, simply reducing the sensitivity of Zswitch slightly (by choosing a larger value of <italic>m</italic>) will prevent such an overload. One must also ensure that Zswitch is only applied to a posterior containing no identical (merged) components.</p>
<p>We present Zmix and Zswitch as part of an R package called <bold>Zmix</bold>, which is available on Github at <underline>github.com/zoevanhavre/Zmix</underline>. <bold>Zmix</bold> includes all methods and functions described in this paper for overfitting univariate Gaussian mixtures, with the intention of providing a straightforward Bayesian tool for modelling and order estimation of the most common type of mixtures.</p>
<p>This paper presents a comprehensive solution to estimating Gaussian mixtures with an unknown number of components, dealing with three general problems which inhibit accurate estimation. The issue of non-identifiability induced by overfitting is cast as an order estimation tool using recent theory on the effect of the prior on the weights of an overfitted Bayesian mixture model. MCMC mixing difficulties common to mixtures are greatly amplified by this prior, and this is resolved by Prior Parallel Tempering which ensures full posterior exploration by travelling through all possible configurations of the posterior. This is analogous to parallel tempering but uses a much simpler acceptance ratio formulation. Finally, Zswitch provides a straightforward and complete relabelling algorithm which is adaptable to a wide range of models, allowing the results of an MCMC sampler on mixture data to be interpreted with no extra modelling effort on the part of the analyst.</p>
</sec>
<sec id="sec033">
<title>Supporting Information</title>
<supplementary-material id="pone.0131739.s001" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s001" mimetype="application/eps" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Sim 1, Boxplot of the number of non-empty groups for each chain.</title>
<p>For <italic>n</italic> = 100 and <italic>n</italic> = 200, the distribution of the number of alive (non-empty) groups in each chain of the tempering is plotted across all 50,000 iterations minus a burn in of 5,000. The value of the hyper-parameter of the weights <italic>α</italic> of each chain is included in red.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0131739.s002" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s002" mimetype="application/eps" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Sim 3, Boxplot of the number of non-empty groups for each chain.</title>
<p>For <italic>n</italic> = 100 and <italic>n</italic> = 200, the distribution of the number of alive (non-empty) groups in each chain of the tempering is plotted across all 50,000 iterations minus a burn in of 5,000. The value of the hyper-parameter of the weights <italic>α</italic> of each chain is included in red.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0131739.s003" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s003" mimetype="application/eps" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Sim 4, Boxplot of the number of non-empty groups for each chain.</title>
<p>For <italic>n</italic> = 100 and <italic>n</italic> = 200, the distribution of the number of alive (non-empty) groups in each chain of the tempering is plotted across all 50,000 iterations minus a burn in of 5,000. The value of the hyper-parameter of the weights <italic>α</italic> of each chain is included in red.’</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0131739.s004" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s004" mimetype="application/eps" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Sim 1 (n = 100): Results of Zmix and Zswitch.</title>
<p>From upper left to lower right: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a density plot of the data over the densities of 10,000 predicted datasets of the same size from the posterior. A panel of plots is included for each candidate model found by Zmix.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0131739.s005" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s005" mimetype="application/eps" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Sim 1 (n = 200): Results of Zmix and Zswitch.</title>
<p>From upper left to lower right: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a density plot of the data over the densities of 10,000 predicted datasets of the same size from the posterior.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0131739.s006" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s006" mimetype="application/eps" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Sim 3 (n = 100): Results of Zmix and Zswitch.</title>
<p>From upper left to lower right: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a density plot of the data over the densities of 10,000 predicted datasets of the same size from the posterior. A panel of plots is included for each candidate model found by Zmix.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0131739.s007" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s007" mimetype="application/eps" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Sim 3 (n = 200): Results of Zmix and Zswitch.</title>
<p>From upper left to lower right: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a density plot of the data over the densities of 10,000 predicted datasets of the same size from the posterior.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0131739.s008" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s008" mimetype="application/eps" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Sim 4 (n = 100): Results of Zmix and Zswitch.</title>
<p>From upper left to lower right: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a density plot of the data over the densities of 10,000 predicted datasets of the same size from the posterior. A panel of plots is included for each candidate model found by Zmix.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0131739.s009" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s009" mimetype="application/eps" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Sim 4 (n = 200): Results of Zmix and Zswitch.</title>
<p>From upper left to lower right: the posterior parameter densities of all parameters from estimated groups, the posterior probability of allocations for each observation for each component, and a density plot of the data over the densities of 10,000 predicted datasets of the same size from the posterior.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0131739.s010" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s010" mimetype="application/pdf" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Parameter summaries for each model estimated by Zmix, for each simulation.</title>
<p>Parameter summaries are included for <italic>n</italic> = 100 and <italic>n</italic> = 200 for all non-empty components for Sim 1 to 4. 95% Bayesian credible intervals are included for all estimates. <inline-formula id="pone.0131739.e166"><alternatives><graphic id="pone.0131739.e166g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0131739.e166"/><mml:math id="M166" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder><mml:mover><mml:mi>K</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo accent="true">¯</mml:mo></mml:munder> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> defines the number of non-empty groups in the configuration considered in that row, and is annotated by an asterisk when this is correct. The parameter estimates corresponding to this configuration which contain the true value are similarly identified with an asterisk.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0131739.s011" position="float" xlink:href="info:doi/10.1371/journal.pone.0131739.s011" mimetype="text/x-R" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>R Code.</title>
<p>Script file (format.r) containing instructions for downloading and installing the Zmix package, obtaining the simulations and case studies, and repeating the analysis performed in the paper.</p>
<p>(R)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The author(s) wish to thank the Queensland University of Technology and the Université Paris Dauphine.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0131739.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Fruhwirth-Schnatter</surname> <given-names>SI</given-names></name>. <source>Finite mixture and Markov switching models</source>. <edition>1st ed</edition>. <publisher-name>Springer</publisher-name>; <year>2006</year>. PLOS 20/232.</mixed-citation>
</ref>
<ref id="pone.0131739.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lewin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bochkina</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>S</given-names></name>. <article-title>Fully Bayesian mixture model for differential gene expression: simulations and model checks</article-title>. <source>Statistical applications in genetics and molecular biology</source>. <year>2007</year> <month>Jan</month>;<volume>6</volume>:Article36. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2202/1544-6115.1314" xlink:type="simple">10.2202/1544-6115.1314</ext-link></comment> <object-id pub-id-type="pmid">18171320</object-id></mixed-citation>
</ref>
<ref id="pone.0131739.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ferreira da Silva</surname> <given-names>AR</given-names></name>. <article-title>A Dirichlet process mixture model for brain MRI tissue classification</article-title>. <source>Medical image analysis</source>. <year>2007</year>;<volume>11</volume>(<issue>2</issue>):<fpage>169</fpage>–<lpage>182</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.media.2006.12.002" xlink:type="simple">10.1016/j.media.2006.12.002</ext-link></comment> <object-id pub-id-type="pmid">17258932</object-id></mixed-citation>
</ref>
<ref id="pone.0131739.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="other">White N, Johnson H, Silburn P, Mellick G, Dissanayaka N, Mengersen K. Probabilistic subgroup identification using Bayesian finite mixture modelling: A case study in Parkinson’s disease phenotype identification. Statistical methods in medical research. 2010 Dec;.</mixed-citation>
</ref>
<ref id="pone.0131739.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Heckman</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Taber</surname> <given-names>CR</given-names></name>. <source>Econometric mixture models and more general models for unobservables in duration analysis Statistical Methods in Medical Research</source>. <year>1994</year>;<volume>3</volume>(<issue>3</issue>):<fpage>279</fpage>–<lpage>299</lpage>.</mixed-citation>
</ref>
<ref id="pone.0131739.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="other">Stauffer C, Grimson WEL. Adaptive background mixture models for real-time tracking. In: Computer vision and pattern recognition, 1999. IEEE Computer Society Conference on.. vol. 2. IEEE; 1999..</mixed-citation>
</ref>
<ref id="pone.0131739.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Reynolds</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Rose</surname> <given-names>RC</given-names></name>. <article-title>Robust text-independent speaker identification using Gaussian mixture speaker models</article-title>. <source>Speech and Audio Processing, IEEE Transactions on</source>. <year>1995</year>;<volume>3</volume>(<issue>1</issue>):<fpage>72</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/89.365379" xlink:type="simple">10.1109/89.365379</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Marin</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Mengersen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Robert</surname> <given-names>CP</given-names></name>. <article-title>Bayesian modelling and inference on mixtures of distributions</article-title>. <source>Handbook of statistics</source>. <year>2005</year>;<volume>25</volume>:<fpage>459</fpage>–<lpage>507</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0169-7161(05)25016-2" xlink:type="simple">10.1016/S0169-7161(05)25016-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gelfand</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>AFM</given-names></name>. <article-title>Sampling-based approaches to calculating marginal densities</article-title>. <source>Journal of the American Statistical Association</source>. <year>1990</year>;<volume>85</volume>(<issue>410</issue>):<fpage>398</fpage>–<lpage>409</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1990.10476213" xlink:type="simple">10.1080/01621459.1990.10476213</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Chib</surname> <given-names>S</given-names></name>. <article-title>Marginal likelihood from the Gibbs output</article-title>. <source>Journal of the American Statistical Association</source>. <year>1995</year> <month>Dec</month>;<volume>90</volume>(<issue>432</issue>):<fpage>1313</fpage>–<lpage>1321</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1995.10476635" xlink:type="simple">10.1080/01621459.1995.10476635</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Carlin</surname> <given-names>BP</given-names></name>, <name name-style="western"><surname>Chib</surname> <given-names>S</given-names></name>. <article-title>Bayesian model choice via Markov chain Monte Carlo methods</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1995</year>;<volume>57</volume>(<issue>3</issue>):<fpage>473</fpage>–<lpage>484</lpage>.</mixed-citation>
</ref>
<ref id="pone.0131739.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Robert</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Casella</surname> <given-names>G</given-names></name>. <article-title>A short history of Markov chain Monte Carlo: subjective recollections from incomplete data</article-title>. <source>Statistical Science</source>. <year>2011</year> <month>Feb</month>;<volume>26</volume>(<issue>1</issue>):<fpage>102</fpage>–<lpage>115</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/10-STS351" xlink:type="simple">10.1214/10-STS351</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tanner</surname> <given-names>MAMa</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>WHWH</given-names></name>. <article-title>The calculation of posterior distributions by data augmentation</article-title>. <source>Journal of the American Statistical Association</source>. <year>1987</year>;<volume>82</volume>(<issue>398</issue>):<fpage>528</fpage>–<lpage>540</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/2289463" xlink:type="simple">10.2307/2289463</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Green</surname> <given-names>PJ</given-names></name>. <article-title>Reversible jump Markov chain Monte Carlo computation and Bayesian model determination</article-title>. <source>Biometrika</source>. <year>1995</year>;<volume>82</volume>(<issue>4</issue>):<fpage>711</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/82.4.711" xlink:type="simple">10.1093/biomet/82.4.711</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nobile</surname> <given-names>A.</given-names></name>, <name name-style="western"><surname>Fearnside</surname> <given-names>A.T.</given-names></name> <year>2007</year>, <source>Bayesian finite mixtures with an unknown number of components: The allocation sampler, Statistics and Computing</source>, vol. <volume>17</volume>, no. <issue>2</issue>, pp. <fpage>147</fpage>–<lpage>162</lpage>.</mixed-citation>
</ref>
<ref id="pone.0131739.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>McLachlan</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Peel</surname> <given-names>D</given-names></name>. <source>Finite mixture models</source>. <publisher-name>Wiley Series in Probability and Statistics</publisher-name>; <year>2000</year>.</mixed-citation>
</ref>
<ref id="pone.0131739.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Celeux</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hurn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Robert</surname> <given-names>CP</given-names></name>. <article-title>Computational and inferential difficulties with mixture posterior distributions</article-title>. <source>Journal of the American Statistical</source>. <year>2000</year>;<volume>95</volume>(<issue>451</issue>):<fpage>957</fpage>–<lpage>970</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.2000.10474285" xlink:type="simple">10.1080/01621459.2000.10474285</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Crawford</surname> <given-names>S</given-names></name>. <article-title>An application of the Laplace method to finite mixture distributions</article-title>. <source>Journal of the American Statistical Association</source>. <year>1994</year>;<volume>89</volume>(<issue>425</issue>):<fpage>259</fpage>–<lpage>267</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1994.10476467" xlink:type="simple">10.1080/01621459.1994.10476467</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="other">Nobile, A. (2007). Bayesian finite mixtures: a note on prior specification and posterior computation. arXiv preprint arXiv:0711.0458.</mixed-citation>
</ref>
<ref id="pone.0131739.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rousseau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mengersen</surname> <given-names>K</given-names></name>. <article-title>Asymptotic behaviour of the posterior distribution in overfitted mixture models</article-title>. <source>Journal of the Royal Statistical Society: B</source>. <year>2011</year> <month>Nov</month>;<volume>75</volume>(<issue>Part 5</issue>):<fpage>689</fpage>–<lpage>710</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-9868.2011.00781.x" xlink:type="simple">10.1111/j.1467-9868.2011.00781.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Dunson</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Vehtari</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <source>Bayesian data analysis</source>, <edition>Third Edition</edition>. <year>2013</year>.</mixed-citation>
</ref>
<ref id="pone.0131739.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Swendsen</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>JS</given-names></name>. <article-title>Replica Monte Carlo simulation of spin-glasses</article-title>. <source>Physical Review Letters</source>. <year>1986</year>;<volume>57</volume>(<issue>21</issue>):<fpage>2607</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.57.2607" xlink:type="simple">10.1103/PhysRevLett.57.2607</ext-link></comment> <object-id pub-id-type="pmid">10033814</object-id></mixed-citation>
</ref>
<ref id="pone.0131739.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Earl</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Deem</surname> <given-names>MW</given-names></name>. <article-title>Parallel tempering: theory, applications, and new perspectives</article-title>. <source>Physical Chemistry Chemical Physics</source>. <year>2005</year>;<volume>7</volume>(<issue>23</issue>):<fpage>3910</fpage>–<lpage>3916</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1039/b509983h" xlink:type="simple">10.1039/b509983h</ext-link></comment> <object-id pub-id-type="pmid">19810318</object-id></mixed-citation>
</ref>
<ref id="pone.0131739.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Altekar</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dwarkadas</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Huelsenbeck</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Ronquist</surname> <given-names>F</given-names></name>. <article-title>Parallel metropolis coupled Markov chain Monte Carlo for Bayesian phylogenetic inference</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>20</volume>(<issue>3</issue>):<fpage>407</fpage>–<lpage>415</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btg427" xlink:type="simple">10.1093/bioinformatics/btg427</ext-link></comment> <object-id pub-id-type="pmid">14960467</object-id></mixed-citation>
</ref>
<ref id="pone.0131739.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Baragatti</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Grimaud</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pommeret</surname> <given-names>D</given-names></name>. <article-title>Likelihood-free parallel tempering</article-title>. <source>Statistics and Computing</source>. <year>2013</year>;<volume>23</volume>(<issue>4</issue>):<fpage>535</fpage>–<lpage>549</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11222-012-9328-6" xlink:type="simple">10.1007/s11222-012-9328-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="other">Celeux G. Bayesian inference for mixtures: The label-switching problem. Computational Statistics 1998. 1998;p. 227–232.</mixed-citation>
</ref>
<ref id="pone.0131739.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Grün</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Leisch</surname> <given-names>F</given-names></name>. <article-title>Dealing with label switching in mixture models under genuine multimodality</article-title>. <source>Journal of Multivariate Analysis</source>. <year>2009</year> <month>May</month>;<volume>100</volume>(<issue>5</issue>):<fpage>851</fpage>–<lpage>861</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmva.2008.09.006" xlink:type="simple">10.1016/j.jmva.2008.09.006</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Yao</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lindsay</surname> <given-names>BG</given-names></name>. <article-title>Bayesian mixture labelling by highest posterior density</article-title>. <source>Journal of the American Statistical Association</source>. <year>2009</year> <month>Jun</month>;<volume>104</volume>(<issue>486</issue>):<fpage>758</fpage>–<lpage>767</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/jasa.2009.0237" xlink:type="simple">10.1198/jasa.2009.0237</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Robert</surname> <given-names>E</given-names></name>. <article-title>On Bayesian analysis of mixtures with an unknown number of components—Discussion</article-title>. <source>Journal of the Royal Statistical Society—Series B: Statistical Methodology</source>. <year>1997</year>;<volume>59</volume>(<issue>4</issue>):<fpage>731</fpage>–<lpage>792</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/1467-9868.00095" xlink:type="simple">10.1111/1467-9868.00095</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jasra</surname> <given-names>a</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>Da</given-names></name>. <article-title>Markov chain Monte Carlo methods and the label switching problem in Bayesian mixture modeling</article-title>. <source>Statistical Science</source>. <year>2005</year> <month>Feb</month>;<volume>20</volume>(<issue>1</issue>):<fpage>50</fpage>–<lpage>67</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/088342305000000016" xlink:type="simple">10.1214/088342305000000016</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Stephens</surname> <given-names>M</given-names></name>. <article-title>Dealing with label switching in mixture models</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2000</year> <month>Nov</month>;<volume>62</volume>(<issue>4</issue>):<fpage>795</fpage>–<lpage>809</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/1467-9868.00265" xlink:type="simple">10.1111/1467-9868.00265</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hurn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Justel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Robert</surname> <given-names>CP</given-names></name>. <article-title>Estimating mixtures of regressions</article-title>. <source>Journal of Computational and Graphical Statistics</source>. <year>2003</year> <month>Mar</month>;<volume>12</volume>(<issue>1</issue>):<fpage>55</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/1061860031329" xlink:type="simple">10.1198/1061860031329</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bechtel</surname> <given-names>YC</given-names></name>, <name name-style="western"><surname>Bonaiti-Pellie′e</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Poisson</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Magnette</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bechtel</surname> <given-names>PR</given-names></name>. <article-title>A population and family study of N-acetyltransferase using caffeine urinary metabolites</article-title>. <source>Clin Pharm Therp</source>. <year>1993</year>;<volume>54</volume>:<fpage>134</fpage>–<lpage>141</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/clpt.1993.124" xlink:type="simple">10.1038/clpt.1993.124</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lin</surname> <given-names>TI</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Yen</surname> <given-names>SY</given-names></name>. <article-title>Finite mixture modelling using the skew normal distribution</article-title>. <source>Statistica Sinica</source>. <year>2007</year>;<volume>17</volume>:<fpage>909</fpage>–<lpage>927</lpage>.</mixed-citation>
</ref>
<ref id="pone.0131739.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Roeder</surname> <given-names>K</given-names></name>. <article-title>Density estimation with confidence sets exemplified by superclusters and voids in the galaxies</article-title>. <source>Journal of the American Statistical Association</source>. <year>1990</year>;<volume>85</volume>(<issue>411</issue>):<fpage>617</fpage>–<lpage>624</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1990.10474918" xlink:type="simple">10.1080/01621459.1990.10474918</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Aitkin</surname> <given-names>M</given-names></name>. <article-title>Likelihood and Bayesian analysis of mixtures</article-title>. <source>Statistical Modelling</source>. <year>2001</year> <month>Dec</month>;<volume>1</volume>(<issue>4</issue>):<fpage>287</fpage>–<lpage>304</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1191/147108201128212" xlink:type="simple">10.1191/147108201128212</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Escobar</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>West</surname> <given-names>M</given-names></name>. <article-title>Bayesian density estimation and inference using mixtures</article-title>. <source>Journal of the american statistical association</source>. <year>1995</year>;<volume>90</volume>(<issue>430</issue>):<fpage>577</fpage>–<lpage>588</lpage>. PLOS 22/2336. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1995.10476550" xlink:type="simple">10.1080/01621459.1995.10476550</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Stephens</surname> <given-names>M</given-names></name>. <article-title>Bayesian analysis of mixture models with an unknown number of components-an alternative to reversible jump methods</article-title>. <source>Annals of Statistics</source>. <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>40</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/aos/1016120364" xlink:type="simple">10.1214/aos/1016120364</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Roeder</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wasserman</surname> <given-names>L</given-names></name>. <article-title>Practical Bayesian density estimation using mixtures of normals</article-title>. <source>Journal of the American Statistical Association</source>. <year>1997</year>;<volume>92</volume>(<issue>439</issue>):<fpage>894</fpage>–<lpage>902</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1997.10474044" xlink:type="simple">10.1080/01621459.1997.10474044</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Richardson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Green</surname> <given-names>PJ</given-names></name>. <article-title>On Bayesian analysis of mixtures with an unknown number of components (with discussion)</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1997</year>;<volume>59</volume>(<issue>4</issue>):<fpage>731</fpage>–<lpage>792</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/1467-9868.00095" xlink:type="simple">10.1111/1467-9868.00095</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0131739.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="other">Phillips DB, Smith AFM. Bayesian model comparison via jump diffusions. Markov chain Monte Carlo in practice. 1996;p. 215–239.</mixed-citation>
</ref>
<ref id="pone.0131739.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Gelfand</surname> <given-names>A.</given-names></name>
<chapter-title>Chapter 9: Model determination using sampling Based Methods</chapter-title>. In: <name name-style="western"><surname>Gilks</surname> <given-names>RSS W</given-names></name>, editor. <source>Markov chain Monte Carlo in practice</source>. <publisher-loc>Boca Raton, FL</publisher-loc>.: <publisher-name>Chapman Hall</publisher-name>; <year>1996</year>..</mixed-citation></ref>
<ref id="pone.0131739.ref043">
<label>43</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cameron</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Pettitt</surname> <given-names>A</given-names></name>. <article-title>Recursive pathways to marginal likelihood estimation with prior-sensitivity analysis</article-title>. <source>Statist Sci</source>. <year>2014</year> 08;<volume>29</volume>(<issue>3</issue>):<fpage>397</fpage>–<lpage>419</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/13-STS465" xlink:type="simple">10.1214/13-STS465</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>