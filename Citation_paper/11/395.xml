<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0205348</article-id>
<article-id pub-id-type="publisher-id">PONE-D-18-15462</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular structures and organelles</subject><subj-group><subject>Vesicles</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Developmental biology</subject><subj-group><subject>Life cycles</subject><subj-group><subject>Larvae</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>People and places</subject><subj-group><subject>Population groupings</subject><subj-group><subject>Age groups</subject><subj-group><subject>Young adults</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Animal models</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Invertebrates</subject><subj-group><subject>Nematoda</subject><subj-group><subject>Caenorhabditis</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Machine learning</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Geometry</subject><subj-group><subject>Radii</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Machine learning</subject><subj-group><subject>Support vector machines</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Synapses</subject><subj-group><subject>Synaptic vesicles</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Synapses</subject><subj-group><subject>Synaptic vesicles</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject><subj-group><subject>Synaptic vesicles</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject><subj-group><subject>Synaptic vesicles</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject><subj-group><subject>Synaptic vesicles</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular structures and organelles</subject><subj-group><subject>Vesicles</subject><subj-group><subject>Synaptic vesicles</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Automated classification of synaptic vesicles in electron tomograms of <italic>C</italic>. <italic>elegans</italic> using machine learning</article-title>
<alt-title alt-title-type="running-head">Automated classification of synaptic vesicles in electron tomograms of <italic>C</italic>. <italic>elegans</italic></alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kaltdorf</surname>
<given-names>Kristin Verena</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Theiss</surname>
<given-names>Maria</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Markert</surname>
<given-names>Sebastian Matthias</given-names>
</name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zhen</surname>
<given-names>Mei</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1886-7625</contrib-id>
<name name-style="western">
<surname>Dandekar</surname>
<given-names>Thomas</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6941-2669</contrib-id>
<name name-style="western">
<surname>Stigloher</surname>
<given-names>Christian</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8049-6186</contrib-id>
<name name-style="western">
<surname>Kollmannsberger</surname>
<given-names>Philip</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Imaging Core Facility, Biocenter, University of Würzburg, Würzburg, Germany</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Bioinformatics, Biocenter, University of Würzburg, Würzburg, Germany</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Center for Computational and Theoretical Biology, University of Würzburg, Würzburg, Germany</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Department of Molecular Genetics, University of Toronto, Toronto, Canada</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Xu</surname>
<given-names>Jianhua</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Augusta University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">Philip.Kollmannsberger@uni-wuerzburg.de</email> (PK); <email xlink:type="simple">Christian.Stigloher@uni-wuerzburg.de</email> (CS); <email xlink:type="simple">dandekar@biozentrum.uni-wuerzburg.de</email> (TD)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>8</day>
<month>10</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<year>2018</year>
</pub-date>
<volume>13</volume>
<issue>10</issue>
<elocation-id>e0205348</elocation-id>
<history>
<date date-type="received">
<day>24</day>
<month>5</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>9</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Kaltdorf et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0205348"/>
<abstract>
<p>Synaptic vesicles (SVs) are a key component of neuronal signaling and fulfil different roles depending on their composition. In electron micrograms of neurites, two types of vesicles can be distinguished by morphological criteria, the classical “clear core” vesicles (CCV) and the typically larger “dense core” vesicles (DCV), with differences in electron density due to their diverse cargos. Compared to CCVs, the precise function of DCVs is less defined. DCVs are known to store neuropeptides, which function as neuronal messengers and modulators [<xref ref-type="bibr" rid="pone.0205348.ref001">1</xref>]. In <italic>C</italic>. <italic>elegans</italic>, they play a role in locomotion, dauer formation, egg-laying, and mechano- and chemosensation [<xref ref-type="bibr" rid="pone.0205348.ref002">2</xref>]. Another type of DCVs, also referred to as granulated vesicles, are known to transport Bassoon, Piccolo and further constituents of the presynaptic density in the center of the active zone (AZ), and therefore are important for synaptogenesis [<xref ref-type="bibr" rid="pone.0205348.ref003">3</xref>].</p>
<p>To better understand the role of different types of SVs, we present here a new automated approach to classify vesicles. We combine machine learning with an extension of our previously developed vesicle segmentation workflow, the ImageJ macro 3D ART VeSElecT. With that we reliably distinguish CCVs and DCVs in electron tomograms of <italic>C</italic>. <italic>elegans</italic> NMJs using image-based features. Analysis of the underlying ground truth data shows an increased fraction of DCVs as well as a higher mean distance between DCVs and AZs in dauer larvae compared to young adult hermaphrodites. Our machine learning based tools are adaptable and can be applied to study properties of different synaptic vesicle pools in electron tomograms of diverse model organisms.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>SFB688/A2</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1886-7625</contrib-id>
<name name-style="western">
<surname>Dandekar</surname>
<given-names>Thomas</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004350</institution-id>
<institution>Studienstiftung des Deutschen Volkes</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Markert</surname>
<given-names>Sebastian Matthias</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>K.V.K., T.D. acknowledge support by the Deutsche Forschungsgemeinschaft (grant SFB688/A2, <ext-link ext-link-type="uri" xlink:href="http://gepris.dfg.de/gepris/projekt/14085162" xlink:type="simple">http://gepris.dfg.de/gepris/projekt/14085162</ext-link>). S.M.M. was supported by a PhD grant from the Studienstiftung des Deutschen Volkes. This publication was funded by the German Research Foundation (DFG) and the University of Wuerzburg in the funding programme Open Access Publishing. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="4"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p><italic>Caenorhabditis elegans</italic> is a well-studied model organism. Its small nervous system, consisting of 302 neurons [<xref ref-type="bibr" rid="pone.0205348.ref004">4</xref>,<xref ref-type="bibr" rid="pone.0205348.ref005">5</xref>] allows for studies of the connectome in its entirety [<xref ref-type="bibr" rid="pone.0205348.ref005">5</xref>–<xref ref-type="bibr" rid="pone.0205348.ref007">7</xref>]. A focus of research is on <italic>C</italic>. <italic>elegans</italic> young adult hermaphrodites, which makes them a reference system for comparison with other developmental states in the life cycle. The most remarkable of all <italic>C</italic>. <italic>elegans</italic> developmental states is the dauer larva.</p>
<p>When the L1 stage larvae sense adverse environmental conditions such as heat, overpopulation and starvation, they activate an alternative state, diapause, instead of continuing the reproductive life cycle [<xref ref-type="bibr" rid="pone.0205348.ref008">8</xref>,<xref ref-type="bibr" rid="pone.0205348.ref009">9</xref>]. Dauer larvae are characterized by their ability to survive several months without any food uptake [<xref ref-type="bibr" rid="pone.0205348.ref010">10</xref>]. Although metabolic activity is reduced [<xref ref-type="bibr" rid="pone.0205348.ref010">10</xref>], dauer larvae are able to move quickly, if necessary, in particular to escape adverse environmental stimuli and in order to reach and colonize new habitats. Improvement of environmental conditions leads dauers to exit diapause, resume development into pre-adult L4 larvae, and re-enter the reproductive life cycle [<xref ref-type="bibr" rid="pone.0205348.ref009">9</xref>]. The mechanisms behind this strikingly fast developmental transition, and the role of the dauer nervous system in sensing and responding to environmental cues, remain largely enigmatic.</p>
<p>Neuronal signaling plays a critical role in regulating the dauer stage. Neuronally released insulin-like peptides [<xref ref-type="bibr" rid="pone.0205348.ref011">11</xref>–<xref ref-type="bibr" rid="pone.0205348.ref014">14</xref>] and morphogens such as TGF-beta [<xref ref-type="bibr" rid="pone.0205348.ref015">15</xref>,<xref ref-type="bibr" rid="pone.0205348.ref016">16</xref>] regulate the activation of dauer diapause. These observations suggest potential changes of the nature of neuronal signaling in dauer larvae.</p>
<p>Neuropeptides are stored and released through dense core vesicles (DCVs) [<xref ref-type="bibr" rid="pone.0205348.ref001">1</xref>,<xref ref-type="bibr" rid="pone.0205348.ref017">17</xref>,<xref ref-type="bibr" rid="pone.0205348.ref018">18</xref>]. Recent studies, particularly the electron microscopic reconstruction of <italic>C</italic>. <italic>elegans</italic> prepared by high-pressure freezing, reveal that almost all synapses, including the neuromuscular junctions (NMJs), contain two principal types of vesicles, a small fraction of DCVs and the much more abundant clear core vesicles (CCVs) [<xref ref-type="bibr" rid="pone.0205348.ref019">19</xref>–<xref ref-type="bibr" rid="pone.0205348.ref021">21</xref>]. CCVs are characterized by their clear inner core in electron micrographs, which stands in strong contrast to the stained vesicle membrane. CCVs typically contain neurotransmitters such as acetylcholine and GABA in the <italic>C</italic>. <italic>elegans</italic> NMJs that are released into the synaptic cleft after fusion of the CCV with the presynaptic cell membrane at the release sites at active zones [<xref ref-type="bibr" rid="pone.0205348.ref002">2</xref>]. In contrast to CCVs, the role of DCVs is much more enigmatic. DCVs are characterized by their eponymous dark, electron dense core that typically contains neuropeptides, small protein molecules with about 3–100 amino acids [<xref ref-type="bibr" rid="pone.0205348.ref001">1</xref>] or other protein cargos such as active zone proteins [<xref ref-type="bibr" rid="pone.0205348.ref003">3</xref>]. DCVs have a bigger average size of about 60–80 nm in comparison to CCVs, which have a much smaller diameter [<xref ref-type="bibr" rid="pone.0205348.ref019">19</xref>], that can vary in different organisms or developmental states [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>,<xref ref-type="bibr" rid="pone.0205348.ref023">23</xref>]. Whereas CCVs cluster around the active zone, DCVs tend to locate further away from the release site, typically at the rim of the SV pool as described for <italic>C</italic>. <italic>elegans</italic> NMJs [<xref ref-type="bibr" rid="pone.0205348.ref019">19</xref>].</p>
<p>DCV exocytosis is considered to mediate slow synaptic and non-synaptic signaling in neurons [<xref ref-type="bibr" rid="pone.0205348.ref001">1</xref>]. It typically occurs independently of the active zone and only at high rates of neuronal activity [<xref ref-type="bibr" rid="pone.0205348.ref001">1</xref>,<xref ref-type="bibr" rid="pone.0205348.ref002">2</xref>]. In <italic>C</italic>. <italic>elegans</italic>, neuropeptides participate in a wide variety of behaviors such as egg-laying, locomotion, dauer formation, mechano- and chemosensation depending on the expression pattern of the peptides [<xref ref-type="bibr" rid="pone.0205348.ref002">2</xref>, <xref ref-type="bibr" rid="pone.0205348.ref024">24</xref>]. Despite the known critical involvement of neural peptides in dauer development, whether the dauer states exhibit differences in DCV distribution in the nervous system remains unknown.</p>
<p>We used high-resolution 3D transmission electron microscopy (electron tomography) to systematically investigate differences of DCV and CCV in NMJs of <italic>C</italic>. <italic>elegans</italic> young adult hermaphrodites and dauer larvae. Series of 2D images were taken from different viewing angles by tilting the sample, and reconstructed <italic>in silico</italic> to obtain one 3D image stack with near isotropic resolution of typically 4–5 nm, determined by measuring the “unit membrane” thickness [<xref ref-type="bibr" rid="pone.0205348.ref019">19</xref>,<xref ref-type="bibr" rid="pone.0205348.ref025">25</xref>–<xref ref-type="bibr" rid="pone.0205348.ref028">28</xref>]. Quantification of SV in 3D electron tomograms requires reconstruction of the vesicle pool of a sufficient number of tomograms, which is very time-consuming and prone to mistakes when performed manually.</p>
<p>To circumvent these shortcomings we previously developed <italic>3D ART VeSElecT</italic>, a workflow for automated reconstruction of vesicles [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>]: This ImageJ/Fiji tool allows for automated reconstruction of synaptic vesicle pools in electron tomograms, but is not able to differentiate between different types of vesicles. To solve this issue, we here present a python-based machine learning approach that trains vesicle classifiers, and a straightforward ImageJ/Fiji tool that applies a trained classifier to previously detected vesicles.</p>
<p>We show that our technique can differentiate between DCV and CCV in two developmental states, young adult hermaphrodites and dauer larvae. The application of these image analysis and machine learning tools for electron tomograms is in principle useful to study differences in synaptic vesicle pools of many other model organisms.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Manual classification shows three distinct vesicle types</title>
<p>To compare vesicle properties in two different developmental states of <italic>C</italic>. <italic>elegans</italic>, dauer larvae and young adult hermaphrodites, we used high-pressure freezing and subsequent freeze substitution to immobilize and fix animals in a near-to-native state. Using electron tomography on ~250 nm cross-sections of the worm, we obtained high resolution 3D images that allow for investigation of the ultrastructure of the nematode’s NMJs. We used this information to compare synaptic vesicle pool characteristics, aiming for an automated approach for vesicle classification.</p>
<p>Upon visual examination of electron microscopic datasets of the NMJs of <italic>C</italic>. <italic>elegans</italic> dauer samples, we noted an increased fraction of DCV in dauer larvae compared to young adult hermaphrodites. To systematically quantify this, vesicles were automatically extracted from tomograms, using an improved version of our 3D ART VeSElecT workflow (see <xref ref-type="supplementary-material" rid="pone.0205348.s001">S1 Fig</xref>), and then manually assigned for vesicle types by two experts. In uncertain cases, a third expert was consulted. Since closer examination of tomograms revealed that a definite assignment of some vesicles to one of the two classes (CCV and DCV) was difficult, we initially established a third, hypothetic group of non-determinable (ND) vesicles. Non-assignable (NA) vesicles are a subgroup of ND that we could ultimately not classify as CCV or DCV. <xref ref-type="fig" rid="pone.0205348.g001">Fig 1</xref> shows a representative selection of clear core, non-determinable and dense core vesicles from 8 exemplary tomograms (4 dauer larva tomograms and 4 hermaphrodite tomograms).</p>
<fig id="pone.0205348.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Comparison of CCV, ND vesicles and DCV of dauer larvae and young adult hermaphrodites.</title>
<p>A selection of representative pictures is shown. Pictures of the same developmental state (young adult hermaphrodite (H) / dauer larva (D)) and with identical number (I–IV) are from the same tomogram (e.g. CCV DI, ND DI and DCV DI originate from exactly the same tomogram). Edge length of micrographs = 100 nm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.g001" xlink:type="simple"/>
</fig>
<p>Together, we included 1072 segmented vesicles from the 7 young adult hermaphrodite tomograms, and 1108 segmented vesicles from the 8 dauer larva tomograms for analyses (<xref ref-type="table" rid="pone.0205348.t001">Table 1</xref>). When we included all identified vesicle populations from all tomograms, the percentage of manually labeled DCVs differed slightly for dauer larvae (13%) and adult hermaphrodite (10%) datasets. After filtering the datasets, comparing only the vesicle population from the same type of NMJ with the bouton fully reconstituted in the tomograms (putative cholinergic NMJs with central cut through the AZ area and at least 100 vesicles), the dauer larvae NMJs exhibited a higher DCV ratio of 16% versus 9% in young adult hermaphrodites.</p>
<table-wrap id="pone.0205348.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.t001</object-id>
<label>Table 1</label> <caption><title>Number and percentage of vesicle types in all tomograms<xref ref-type="table-fn" rid="t001fn001"><sup>1</sup></xref>.</title></caption>
<alternatives>
<graphic id="pone.0205348.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" style="background-color:#BFBFBF">Developmental state</th>
<th align="left" style="background-color:#BFBFBF">Tomograms<break/>(n)</th>
<th align="left" style="background-color:#BFBFBF">Amount of vesicles</th>
<th align="left" style="background-color:#BFBFBF">CCV</th>
<th align="left" style="background-color:#BFBFBF;border-right:thick;border-left:thick">DCV</th>
<th align="left" style="background-color:#BFBFBF">NA</th>
<th align="left" style="background-color:#BFBFBF">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="4" style="background-color:#FFFFFF"><bold>Adult hermaphrodite</bold></td>
<td align="left" rowspan="2" style="background-color:#FFFFFF"><bold>7</bold></td>
<td align="left" style="background-color:#FFFFFF"><bold>Sum</bold></td>
<td align="left" style="background-color:#FFFFFF">949</td>
<td align="left" style="background-color:#FFFFFF;border-right:thick;border-left:thick">109</td>
<td align="left" style="background-color:#FFFFFF">14</td>
<td align="left" style="background-color:#FFFFFF">1072</td>
</tr>
<tr>
<td align="left" style="background-color:#FFFFFF"><bold>Percentage</bold></td>
<td align="left" style="background-color:#FFFFFF">89%</td>
<td align="left" style="background-color:#FFFF00;border-right:thick;border-left:thick"><bold>10%</bold></td>
<td align="left" style="background-color:#FFFFFF">1%</td>
<td align="left" style="background-color:#FFFFFF"/>
</tr>
<tr>
<td align="left" rowspan="2" style="background-color:#FFFFFF"><bold>5</bold></td>
<td align="left" style="background-color:#FFFFFF"><bold>Sum</bold> <sup>(1)</sup></td>
<td align="left" style="background-color:#FFFFFF">837</td>
<td align="left" style="background-color:#FFFFFF;border-right:thick;border-left:thick">85</td>
<td align="left" style="background-color:#FFFFFF">11</td>
<td align="left" style="background-color:#FFFFFF">933</td>
</tr>
<tr>
<td align="left" style="background-color:#FFFFFF"><bold>Percentage</bold> <sup>(1)</sup></td>
<td align="left" style="background-color:#FFFFFF">90%</td>
<td align="left" style="background-color:#18E1FC;border-right:thick;border-left:thick"><bold>9%</bold></td>
<td align="left" style="background-color:#FFFFFF">1%</td>
<td align="left" style="background-color:#FFFFFF"/>
</tr>
<tr>
<td align="left" rowspan="4" style="background-color:#D9D9D9"><bold>Dauer larvae</bold></td>
<td align="left" rowspan="2" style="background-color:#D9D9D9"><bold>8</bold></td>
<td align="left" style="background-color:#D9D9D9"><bold>Sum</bold></td>
<td align="left" style="background-color:#D9D9D9">948</td>
<td align="left" style="background-color:#D9D9D9;border-right:thick;border-left:thick">148</td>
<td align="left" style="background-color:#D9D9D9">12</td>
<td align="left" style="background-color:#D9D9D9">1108</td>
</tr>
<tr>
<td align="left" style="background-color:#D9D9D9"><bold>Percentage</bold></td>
<td align="left" style="background-color:#D9D9D9">86%</td>
<td align="left" style="background-color:#FFFF00;border-right:thick;border-left:thick"><bold>13%</bold></td>
<td align="left" style="background-color:#D9D9D9">1%</td>
<td align="left" style="background-color:#D9D9D9"/>
</tr>
<tr>
<td align="left" rowspan="2" style="background-color:#D9D9D9"><bold>5</bold></td>
<td align="left" style="background-color:#D9D9D9"><bold>Sum</bold> <sup>(1)</sup></td>
<td align="left" style="background-color:#D9D9D9">669</td>
<td align="left" style="background-color:#D9D9D9;border-right:thick;border-left:thick">130</td>
<td align="left" style="background-color:#D9D9D9">3</td>
<td align="left" style="background-color:#D9D9D9">802</td>
</tr>
<tr>
<td align="left" style="background-color:#D9D9D9"><bold>Percentage</bold> <sup>(1)</sup></td>
<td align="left" style="background-color:#D9D9D9">83%</td>
<td align="left" style="background-color:#18E1FC;border-right:thick;border-left:thick"><bold>16%</bold></td>
<td align="left" style="background-color:#D9D9D9">0%</td>
<td align="left" style="background-color:#D9D9D9"/>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p><sup>(1)</sup> analysis with a selected set of tomograms where only putative cholinergic NMJs with apparent dense projections and with &gt; 100 vesicles were included.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec004">
<title>Characterization based on image features</title>
<p>In order to perform a quantitative comparison of vesicles and for clarification about the ND vesicle class, we extracted a number of image features based on qualitative observations. Since DCVs appear larger, darker and further apart from the active zone compared to CCVs, we used mean radius (r), mean gray value (gv) of the vesicle volume, and distance of the vesicle center to the manually annotated center of the active zone (distAZ) as primary features (<xref ref-type="fig" rid="pone.0205348.g002">Fig 2</xref>). In addition, the standard deviation of the gray value distribution of a vesicle (GVSD) is a measure for the contrast between membrane and core that is independent of the brightness of the vesicle. While GVSD was determined on the central slice of each vesicle for better discrimination, the other features were calculated using the entire vesicle volume excluding the membrane.</p>
<fig id="pone.0205348.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Visualization of vesicle pool in a dauer larva tomogram with color coded image features: Inner radius, gray value, distance to active zone (distAZ), gray value standard deviation (GVSD).</title>
<p>Clear core like characteristics are yellow-shifted, dense core like features are blue shifted. The active zone is located at the bottom.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.g002" xlink:type="simple"/>
</fig>
<p>Statistical analysis and comparison of ND vesicles with CCV and DCV suggests that synapses show no third type of vesicles and that NDs are in most cases CCVs (see <xref ref-type="supplementary-material" rid="pone.0205348.s002">S2 Fig</xref>). Hence, for further analysis, we proceeded with the assumption of two existing vesicle classes, CCVs and DCVs (<xref ref-type="table" rid="pone.0205348.t001">Table 1</xref>). We tried to apply simple thresholding and manually varied the weights of the linear combination of vesicle radius, distAZ and gv to separate DCVs from CCVs, but with limited success (see <xref ref-type="supplementary-material" rid="pone.0205348.s011">S2 Fig</xref> and <xref ref-type="supplementary-material" rid="pone.0205348.s010">S1 Text</xref>). Therefore, a machine learning approach was developed and applied to automatically determine the optimal weighting of the features, as described below. To generate training data, two experts independently reassigned ND vesicles as either DCV or CCV. Their label was only changed if they turned out to be DCV, as we programmed classifiers to treat the label ND as CCV. In difficult cases, a third expert was consulted. Still non-assignable vesicles (NA) were excluded from training by labelling them as error (see <xref ref-type="table" rid="pone.0205348.t001">Table 1</xref>: n = 12, ~ 1.1% in dauer larvae; n = 14, ~1.3% in young adult hermaphrodites).</p>
</sec>
<sec id="sec005">
<title>Machine learning can distinguish vesicle types</title>
<p>To automatically classify vesicles using the previously calculated image features, we evaluated different machine-learning algorithms. We compared a support vector machine (SVM), random forest (RF), and k nearest neighbor (KNN) for their performance on differentiating between CCVs and DCVs using four image-based characteristics described above: radius (r), mean gray value (gv), standard deviation of the gray value (GVSD) and distance to the active zone (distAZ) (see <xref ref-type="fig" rid="pone.0205348.g003">Fig 3</xref>). 1994 manually labelled vesicles from 15 different tomograms (7 young adult hermaphrodite and 8 dauer larval tomograms) were used as training data. Adult and dauer stages were combined into a single training set to reflect the biological variability and to focus the classifier on the task of identifying vesicle types rather than developmental stages. The features were extracted as in the first two steps of our classification macro (see <xref ref-type="fig" rid="pone.0205348.g003">Fig 3</xref> and Methods section 7.3), saved as a table, and processed in a python script using the scikit-learn machine learning library [<xref ref-type="bibr" rid="pone.0205348.ref029">29</xref>]. <xref ref-type="table" rid="pone.0205348.t002">Table 2</xref> shows the results of the comparison of the different algorithms. The overall accuracy (first column) was not a good indicator for classifier performance, as CCV greatly outnumber DCV. We instead used precision<sub>DCV</sub>, recall<sub>DCV</sub> and F-score<sub>DCV</sub> defined in the methods section 7.6 (Eqs <xref ref-type="disp-formula" rid="pone.0205348.e004">2</xref>–<xref ref-type="disp-formula" rid="pone.0205348.e006">4</xref>) to specifically score the ability of classifiers to recognize DCVs.</p>
<fig id="pone.0205348.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Workflow of the classification macro.</title>
<p>1) preparation: StackSegmented (registered vesicles) and StackDuplicateScale (scaled tomogram) from 3D ART VeSElecT [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>] are used as input; the user is requested to mark the active zone via point-selection (semi-automated). 2) readout of features: gray value (gv), radius (r), vesicles coordinates and gray value standard deviation (GVSD) in the middle slice of vesicles are determined; the distance to active zone (distAZ) is calculated. 3) processing of features: offsetting, standardization and weighting of features followed by final assignment of labels. 4) output: includes a logfile and visualization of results as new image stack windows.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.g003" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0205348.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.t002</object-id>
<label>Table 2</label> <caption><title>Average performance of different machine learning classifiers.</title></caption>
<alternatives>
<graphic id="pone.0205348.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">classifier</th>
<th align="left">accuracy</th>
<th align="left">precision<sub>DCV</sub></th>
<th align="left">recall<sub>DCV</sub></th>
<th align="left">F-score<sub>DCV</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">SVM</td>
<td align="left">0.98 ± 0.02</td>
<td align="left">0.95 ± 0.07</td>
<td align="left">0.90 ± 0.1</td>
<td align="left">0.92 ± 0.07</td>
</tr>
<tr>
<td align="left">Random forest<break/>(t = 10)</td>
<td align="left">0.97 ± 0.03</td>
<td align="left">0.88 ± 0.12</td>
<td align="left">0.89 ± 0.09</td>
<td align="left">0.88 ± 0.08</td>
</tr>
<tr>
<td align="left">Random forest<break/>(t = 1500)</td>
<td align="left">0.97 ± 0.02</td>
<td align="left">0.93 ± 0.08</td>
<td align="left">0.86 ± 0.1</td>
<td align="left">0.89 ± 0.07</td>
</tr>
<tr>
<td align="left">KNN<break/>(k = 10)</td>
<td align="left">0.98 ± 0.02</td>
<td align="left">0.92 ± 0.09</td>
<td align="left">0.89 ± 0.12</td>
<td align="left">0.90 ± 0.09</td>
</tr>
<tr>
<td align="left">Nonlinear SVM</td>
<td align="left">0.98 ± 0.02</td>
<td align="left">0.94 ± 0.09</td>
<td align="left">0.89 ± 0.1</td>
<td align="left">0.91 ± 0.08</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The comparison between linear and nonlinear SVM, random forest and KNN revealed that the SVM algorithm performs best on our classification problem. The linear SVM shows the lowest error rates in all four categories (see <xref ref-type="sec" rid="sec010">Methods</xref>): Accuracy, precision<sub>DCV</sub>, recall<sub>DCV</sub> and F-score<sub>DCV</sub>. KNN shows second best results that were about 0–3 percent worse compared to the linear SVM, and slightly better than nonlinear SVM. For the random forest variants, t = 1500 trees performed similarly or better than t = 10, except for recall<sub>DCV</sub>. Random forest (t = 1500) shows overall third best results with 3 percent worse results for recall<sub>DCV</sub> and about 1 percent worse results for accuracy, precision<sub>DCV</sub> and F-score<sub>DCV</sub> compared to KNN. Resulting values of the SVM hyperplane delimiting DCVs from CCVs are shown in <xref ref-type="table" rid="pone.0205348.t003">Table 3</xref>. We also performed a systematic comparison of classifier performance over a much wider range of input parameters, summarized in <xref ref-type="supplementary-material" rid="pone.0205348.s009">S2 Table</xref>.</p>
<table-wrap id="pone.0205348.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.t003</object-id>
<label>Table 3</label> <caption><title>SVM and standardization parameters transferred to the Fiji macro.</title></caption>
<alternatives>
<graphic id="pone.0205348.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">parameter</th>
<th align="left">r</th>
<th align="left">gv</th>
<th align="left">distAZ</th>
<th align="left">GVSD</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">mean</td>
<td align="left">10.4</td>
<td align="left">129.1</td>
<td align="left">259.1</td>
<td align="left">5.9</td>
</tr>
<tr>
<td align="left">SD</td>
<td align="left">3.1</td>
<td align="left">4.7</td>
<td align="left">118.5</td>
<td align="left">1.7</td>
</tr>
<tr>
<td align="left">weight</td>
<td align="left">-1.69</td>
<td align="left">1.65</td>
<td align="left">-0.76</td>
<td align="left">1.21</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The final trained SVM classifier used the following weighting of the four features:
<disp-formula id="pone.0205348.e001">
<alternatives>
<graphic id="pone.0205348.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0205348.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mo>−</mml:mo><mml:mn>4.36</mml:mn><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1.69</mml:mn><mml:mo>*</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1.65</mml:mn><mml:mo>*</mml:mo><mml:mi>g</mml:mi><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:mn>0.76</mml:mn><mml:mo>*</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>A</mml:mi><mml:mi>Z</mml:mi><mml:mo>+</mml:mo><mml:mn>1.21</mml:mn><mml:mo>*</mml:mo><mml:mi>G</mml:mi><mml:mi>V</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula></p>
<p>The weight for distAZ is smaller than for the other three parameters, which indicates that it is less important. Still, it contributes to the classifier, since the performance of the SVM using only three features without taking distAZ into account drops to precision<sub>DCV</sub> = 0.91 ± 0.09, recall<sub>DCV</sub> = 0.89 ± 0.1, and F-score<sub>DCV</sub> = 0.90 ± 0.08 on the same training set.</p>
<p>In summary, the SVM algorithm in its linear form without kernelization outperformed all other classification methods including non-linear SVM and random forest (t = 1500) classification. Additionally, using a linear SVM has the advantage that the resulting classifier can easily be incorporated into a classification workflow by extracting the coefficients after successful training. For this purpose, a new vesicle classification macro in ImageJ/Fiji was developed to be consecutively applied after the modified 3D ART VeSElecT registration macro. The workflow of the classification macro is shown in <xref ref-type="fig" rid="pone.0205348.g003">Fig 3</xref> and is described in detail in Materials and Methods.</p>
</sec>
<sec id="sec006">
<title>Application to <italic>C</italic>. <italic>elegans</italic> dauer and adult hermaphrodite NMJs</title>
<p>We used the ground truth classification to quantify differences in the vesicle pool of <italic>C</italic>. <italic>elegans</italic> dauer and adult hermaphrodite NMJs in electron tomograms. Additionally, visual results of 3D ART VeSElecT and the classification macro for one exemplary tomogram of each analyzed developmental state are presented in <xref ref-type="fig" rid="pone.0205348.g004">Fig 4</xref> to provide an intuitive impression of DCV and CCV distribution.</p>
<fig id="pone.0205348.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Comparison of the visual results from the adapted 3D ART VeSElecT and the consecutive classification macro.</title>
<p><italic>Top</italic>: I) and II) original tomograms of young adult hermaphrodite (I) and dauer larva (II). <italic>Bottom</italic>: a) and c) show <italic>Composit</italic> stacks of 3D ART VeSElecT (random colors), whereas a’) and c’) show the resulting <italic>Composit</italic> after classification of vesicles (CCV = magenta, DCV = green). b) and d) show the 3D model of the vesicle pool, b’) and d’) show the 3D model with color labels showing the assigned class. All scale bars = 100 nm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.g004" xlink:type="simple"/>
</fig>
<p>The 3D models show that DCVs most often localize on the rim of the CCV cluster. CCVs themselves gather around the dense projections, electron dense structures attached to the cell membrane that indicate the active zone where synaptic vesicle fusion occurs. For further analysis of vesicle characteristics (radius, gray value, GVSD and distAZ), ground truth results are shown as violin plots in <xref ref-type="fig" rid="pone.0205348.g005">Fig 5</xref>. The predictions of the SVM resulted in the same statistical significance as the manual ground truth regarding most differences between vesicle types and developmental stages (<xref ref-type="supplementary-material" rid="pone.0205348.s006">S6 Fig</xref>).</p>
<fig id="pone.0205348.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Comparison of DCVs (black) characteristics with CCVs (light gray) characteristics.</title>
<p>Violin plots show a) inner vesicle radius in nm, b) gray value (gv), c) distance to active zone (distAZ) and d) gray value standard deviation in central slice of each vesicle (GVSD). Panels b)-d) show normalized values of n<sub>h</sub> = 7 tomograms of N2 young adult hermaphrodites (N<sub>CCV</sub> = 949, N<sub>DCV</sub> = 109); n<sub>d</sub> = 8 tomograms of N2 dauer larvae (N<sub>CCV</sub> = 948, N<sub>DCV</sub> = 148). All plots are based on expert curated manual ground truth classification. Statistical significance was determined using the Mann-Whitney U test (* p&lt;0.05, ** p&lt;0.01, *** p&lt;0.001; exact p values are given in <xref ref-type="supplementary-material" rid="pone.0205348.s005">S5 Fig</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.g005" xlink:type="simple"/>
</fig>
<p><xref ref-type="fig" rid="pone.0205348.g005">Fig 5A</xref> shows highly significant differences in CCV and DCV size in both developmental states. In the following, the radius always refers to our original measured results, which is the “inner radius” of all vesicles, as described in [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>]. To make vesicle size comparable to other published results, the measured radius must be multiplied by two to receive the inner diameter and increased by 9 nm to include vesicle membrane thickness [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>]. This estimated diameter is only an approximation and cannot be directly compared to manually measured data due to the different way how both are measured [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>].</p>
<p>CCVs of dauer larvae show a median inner radius of 9.0 nm, whereas DCVs have a median inner radius of 14.7 nm, which results in a significant difference of 5.7 nm. However young adult hermaphrodites’ median inner radius of DCVs is 16.7 nm, hence they have a ~ 5.4 nm bigger radius than CCVs with a median inner radius of 10.3 nm. Noticeably, both vesicle types are slightly but significantly bigger in young adult hermaphrodites compared to dauer larvae. The radius of hermaphrodite CCVs is 1.3 nm larger compared to dauer larvae, whereas the radius of hermaphrodite DCVs is 2 nm larger compared to dauer larvae.</p>
<p>In all cases, DCVs have significantly darker normalized gray value intensities in comparison to CCVs, as shown in <xref ref-type="fig" rid="pone.0205348.g005">Fig 5B</xref>. Gray values were normalized on a per-tomogram basis by subtracting the minimum and dividing by the difference of maximum and minimum of all vesicles in the same tomogram to average out brightness variations between tomograms. Young adult hermaphrodites show a normalized gv of 0.17 for CCVs and 0.45 for DCVs, whereas dauer larvae have a normalized gv of 0.23 for CCVs and 0.56 for DCVs. Hence, vesicles of dauer larvae tomograms possess significantly darker vesicles (both CCVs and DCVs) in comparison to hermaphrodite tomograms. In contrast, GVSD (gray value standard deviation in the central slice of each vesicle) does not differ significantly between developmental states, but shows highly significant differences of ~ 0.22 in GVSD values of CCV to DCV for both developmental states (<xref ref-type="fig" rid="pone.0205348.g006">Fig 6D</xref>).</p>
<fig id="pone.0205348.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.g006</object-id>
<label>Fig 6</label>
<caption>
<title/>
<p><bold>Cumulative histogram (a, b) and kernel density estimation (smoothed histogram) plots (c, d; bandwidth = 0.07*maximum value of total dataset) of distances to the active zone (distAZ)</bold>. Given are normalized distances (left) and real values in nm (right). CCVs are shown as dashed line and DCVs as continuous line. Adult hermaphrodite vesicles are presented in shades of gray, whereas dauer larval vesicles are shown in violet. All plots are based on expert curated manual ground truth classification.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.g006" xlink:type="simple"/>
</fig>
<p>The normalized distance of CCVs to the active zone distAZ is smaller (0.42 for young adult hermaphrodites and 0.4 for dauer larvae) than that of DCVs (young adult hermaphrodites: 0.64, dauer larvae: 0.72) in both larval stages (<xref ref-type="fig" rid="pone.0205348.g006">Fig 6C</xref>). The normalized distances of DCVs to the AZ, of young adult hermaphrodites in comparison to dauer larvae, show a highly significant difference of 0.08 (normalized). For better visualization of this observation, distances are visualized as histogram plots in <xref ref-type="fig" rid="pone.0205348.g006">Fig 6</xref>. Distances were normalized on a per-tomogram basis by subtracting the minimum and dividing by the difference of maximum and minimum of all vesicles in the same tomogram to average out cell size variations between tomograms.</p>
<p><xref ref-type="fig" rid="pone.0205348.g006">Fig 6A and 6C</xref> illustrate that normalized distances of CCVs of both developmental states are almost identical, whereas distances of DCVs differ significantly in both plots. DCVs show a systematic discrepancy in their localization: DCVs in young adult hermaphrodites cluster closer to the active zone than DCVs of dauer larvae. Histograms in <xref ref-type="fig" rid="pone.0205348.g006">Fig 6B and 6D</xref> shows results of distAZ in real distance measured in nm. Interestingly, this statistic shows that vesicle pools in dauer larvae have a generally smaller maximal distAZ in young adult hermaphrodites. The largest distance of dauer larvae vesicles from the active zone is about 550 nm whereas the largest distance of vesicles in young adult hermaphrodites is about 700 nm. It should be noted that distAZ as derived from tomograms should be considered as an estimate of the actual distance of vesicles to the active zone, since a single tomographic stack may not contain the full information on the actual position and shape of the active zone.</p>
</sec>
<sec id="sec007">
<title>Error rates and cross validation</title>
<p>To generate the ground truth data, a consensus label was created (N = 15 tomograms, 8 dauer larva and 7 hermaphrodite tomograms): First, labels were assigned independently by two biologists. Differing labels were re-examined. In case of no agreement, a third examiner was employed. NA vesicles (~1%) were excluded from SVM training. The initial assignment by individuals was compared with this consensus label to determine the manual error rate (<xref ref-type="table" rid="pone.0205348.t004">Table 4</xref>).</p>
<table-wrap id="pone.0205348.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.t004</object-id>
<label>Table 4</label> <caption><title>Manual vs classification macro (SVM performance).</title></caption>
<alternatives>
<graphic id="pone.0205348.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.t004" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left">presicion<sub>DCV</sub></th>
<th align="left">recall<sub>DCV</sub></th>
<th align="left">F-score<sub>DCV</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Manual <xref ref-type="table-fn" rid="t004fn001"><sup>(1)</sup></xref></td>
<td align="left">0.98 ± 0.05</td>
<td align="left">0.96 ± 0.08</td>
<td align="left">0.97 ± 0.05</td>
</tr>
<tr>
<td align="left">SVM <xref ref-type="table-fn" rid="t004fn002"><sup>(2)</sup></xref></td>
<td align="left">0.95 ± 0.07</td>
<td align="left">0.90 ± 0.10</td>
<td align="left">0.92 ±0.07</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t004fn001"><p><sup>(1)</sup> Compares two independent manual assignments to the consensus label (ground truth)</p></fn>
<fn id="t004fn002"><p><sup>(2)</sup> Compares the SVM assignment to the ground truth</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Manual annotation shows higher scores than the SVM. Manual assignment of vesicle types shows 98% precision<sub>DCV</sub>, whereas the SVM reaches 95% precision<sub>DCV</sub>. The results for recall<sub>DCV</sub> is 96% for manual assignment and 90% for the SVM. The F-score is the harmonic mean of precision and recall (see <xref ref-type="sec" rid="sec010">Materials and Methods</xref>) and shows a mean result for the error rate of 97% for manual and 92% for automated classification. Results for precision and recall are additionally shown as scatterplot in <xref ref-type="fig" rid="pone.0205348.g007">Fig 7</xref>.</p>
<fig id="pone.0205348.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.g007</object-id>
<label>Fig 7</label>
<caption>
<title>SVM error rates as precision<sub>DCV</sub> and recall<sub>DCV</sub> plot.</title>
<p>Each data point represents one validation tomogram. Red squares: adult hermaphrodite, blue circles: dauer larvae. Right: magnified detail plot. Red star indicates mean of hermaphrodite data: precision<sub>DCV</sub> = 0.93, recall<sub>DCV</sub> = 0.85. Blue cross indicates mean of dauer data: precision<sub>DCV</sub> = 0.97, recall<sub>DCV</sub> = 0.94. 3 dauer tomograms and 1 hermaphrodite tomogram were classified without error.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.g007" xlink:type="simple"/>
</fig>
<p>The SVM classifier was cross-validated against each tomogram using all other tomograms as training data. <xref ref-type="fig" rid="pone.0205348.g007">Fig 7</xref> shows error rates of cross validation of automated SVM classification. Hermaphrodite tomograms are represented as red squares and dauer larvae tomograms are represented as blue circles. Mean classification results are shown as red star for young adult hermaphrodites (precision<sub>DCV</sub> = 0.93, recall<sub>DCV</sub> = 0.85) and as blue cross for dauer larvae tomograms (precision<sub>DCV</sub> = 0.97, recall<sub>DCV</sub> = 0.94). Dauer larvae tomograms have on average better results than hermaphrodites and cluster in the right upper corner. 3 dauer tomograms and one young adult hermaphrodite tomogram were classified without any error and overlay in the right upper corner at precision<sub>DCV</sub> = 1.0, recall<sub>DCV</sub> = 1.0.</p>
<p>To examine the transferability of the vesicle classification workflow, we tested the pre-trained classifier to two tomograms of the <italic>unc-59(e261)</italic> septin mutant of <italic>C</italic>. <italic>elegans</italic> [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>]. We observe a precision<sub>DCV</sub> of 0.78 and 0.8 and a recall<sub>DCV</sub> of 0.88 and 0.94, respectively, on these EM data without any additional training of the classifier. When we adjusted the image brightness to be more similar to those used for training, the performance increased further (<xref ref-type="fig" rid="pone.0205348.g008">Fig 8</xref>).</p>
<fig id="pone.0205348.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0205348.g008</object-id>
<label>Fig 8</label>
<caption>
<title>precision<sub>DCV</sub>—recall<sub>DCV</sub> plot of test-data.</title>
<p>The pre-trained classifier was tested on two tomograms of the <italic>unc-59(e261)</italic> septin mutant of <italic>C</italic>. <italic>elegans</italic>. Blue squares indicate tomogram 1, green circles tomogram 2. Result of brightening tomograms is indicated by bigger marker and arrows, with numbers indicating brightness-adjustment.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.g008" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>Automated methods for image analysis are of great importance to reduce manual labor in the long term and prevent biased analysis of data, hence making double blind analysis unnecessary. This is confirmed by our own experience, where one re-analysis of the same tomogram by the same expert revealed one differential interpretation of CCV and DCV and 6 other non-matching assignments on n = 134 vesicles in total. Such deviations in manual analysis may have a great influence on the outcome. For this reason, we had two experts manually assign all vesicles independently. In case of inconsistency, both persons came to a mutual agreement or consulted a third expert in the decision process. Still unassignable vesicles were excluded from analysis. Since this evaluation process is very elaborate and time-consuming, a long-term automated solution is inevitable. As far as we know there is no other approach for the specific task of automated vesicle classification in electron tomograms. We present here a new methodological approach that is applied subsequent to a modified version of our previously published Fiji macro 3D ART VeSElecT [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>]. First, a Fiji macro was written to read out important characteristics. Those were, together with manual labelling, used to train machine learning classifiers in python. Extracted machine learning parameters of an SVM completed the new Fiji macro to classify vesicles and visualize classes through 3D color labelling. Our tool can thus be used for automated vesicle classification. We used our ground truth label to identify differences between two types of vesicles in two different developmental states of <italic>C</italic>. <italic>elegans</italic>, young adult hermaphrodites and dauer larvae. We then use these data to train an automated classification workflow to show that resulted algorithm can reproduce these manually obtained biological results.</p>
<p>Manual analysis revealed a hypothetical third type of vesicles, called non-determinable vesicles (ND) which are most likely CCVs with no perfectly clear inner core. This seems reasonable, since they resemble CCV characteristics in radius and distance to the active zone and only differ significantly in their gray value, which lies among gv intensities of DCVs and CCVs (<xref ref-type="supplementary-material" rid="pone.0205348.s002">S2 Fig</xref>). This observation can be explained by either biological or technical reasons. On the one hand, medium-gray vesicles could be DCVs with partially released cargo, e.g. after kiss-and-run [<xref ref-type="bibr" rid="pone.0205348.ref030">30</xref>–<xref ref-type="bibr" rid="pone.0205348.ref032">32</xref>]. Overall this does not explain why NDs have the same size as CCVs, since DCVs are known to be considerably larger [<xref ref-type="bibr" rid="pone.0205348.ref023">23</xref>]. On the other hand, vesicles may appear darker in electron micrographs because of lower quality of tomograms at some locations. Lacking precision of the tomogram overlay of the two single tilted tomograms to receive one double tilted tomogram could result in darker, more blurry vesicles with no perfectly clear core.</p>
<p>The comparison of DCV number in dauer larvae and young adult hermaphrodites revealed differences in the ratio of DCVs (9% in young adult hermaphrodites and 16% in dauer larvae), when comparing only cholinergic synapses with apparent dense projections and at least 100 vesicles in the NMJ. Furthermore, we found that DCV ratio correlates with cell size change throughout the tomogram (<xref ref-type="supplementary-material" rid="pone.0205348.s004">S4 Fig</xref>). A large cell size change indicates inclusion of decentral regions of the synaptic bouton in the tomogram. We assume that inclusion of more remote areas in the tomogram is more likely in dauer larvae, since the overall size of the synaptic bouton is smaller (mean diameter ± SD of cross section: 452 ± 85 nm) compared to young adult hermaphrodites (mean diameter ± SD of cross section: 542 ± 97 nm). Therefore, standard sized 250 nm sections, typically prepared for electron tomography, naturally have a higher chance of catching decentral regions in dauer larvae NMJs. For a more comprehensive understanding, serial section tomography for visualization of complete synaptic boutons would be necessary.</p>
<p>Additionally, we found that young adult hermaphrodites show significantly larger vesicles (CCVs and DCVs) and diameters of synapses in comparison to dauer larvae. This observation could either be a biological phenomenon of dauer larvae or a side effect of the sample preparation. Dauer larvae have a distinct cuticle that shields the animal from adverse environmental conditions, like heat and drought. This could lead to adverse effects during fixation (freeze substitution) of the sample, even though we did not observe any sign of deficient sample fixation in dauer larvae. Divergent synaptic vesicle sizes have already been found in NMJs of other organisms, like rats [<xref ref-type="bibr" rid="pone.0205348.ref033">33</xref>] and zebrafish [<xref ref-type="bibr" rid="pone.0205348.ref023">23</xref>]. For zebrafish a dependency of vesicle size on the maturation stage of NMJs was assumed that might be related to the functional transition of these synapses to control different swimming behavior [<xref ref-type="bibr" rid="pone.0205348.ref023">23</xref>]. Differences in synaptic vesicle sizes during normal development have not been observed for <italic>C</italic>. <italic>elegans</italic>, to our knowledge. However, divergent vesicle sizes could also be related to different moving behavior of dauer larvae that are well known for their unique nictation behavior [<xref ref-type="bibr" rid="pone.0205348.ref009">9</xref>]. Since manual measurements are often inaccurate, smaller deviations in vesicle sizes are only observable in extensive analysis, therefore automated approaches are inevitable. Our previously published macro 3D ART VeSElecT proved to be successful for distinguishing vesicle size differences [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>]. This approach in combination with our here presented extended version for automated classification may be the key to reveal so far undistinguishable differences in the future.</p>
<p>Interestingly, although nervous cells in dauer larvae are typically smaller, segregation of DCVs and CCVs is more distinct. Our interpretation is that DCVs in dauer larvae locate further away from the active zone on the rim of the synaptic vesicle pool compared to young adult hermaphrodites. Differences in this characteristic of synaptic architecture could be explained by a shift towards a higher ratio of DCVs in a non-fusion competent resting state in dauer compared to young adult hermaphrodites. Moreover, the location of DCVs closer to the cell margin in dauer compared to young adult hermaphrodites could indicate the need for faster peptide release, and their increased number could compensate for lower volume.</p>
<p>For automated classification of vesicles, different machine learning algorithms were tested. The SVM showed best results in comparison to random forest or k-nearest neighbor classification. Furthermore, the SVM works regardless of dimensionality, can classify non-linearly separable classes by using the kernel trick, enables an easy integration of the trained linear classifier into the macro and generally can be used for assignment into more than two classes [<xref ref-type="bibr" rid="pone.0205348.ref034">34</xref>].</p>
<p>Cross-validation showed very good results for automated classification of vesicles. Interestingly, dauer larval tomograms showed better results than young adult hermaphrodite tomograms, which could be related to the differing gray value intensities of the tomograms. Hence high contrast vesicles were easier to automatically recognize and showed more distinct results for GVSD and gv. Another reason could be the more pronounced positional segregation of the two vesicle types for dauer larvae.</p>
<p>We suggest that our pre-trained SVM can be used for DCV and CCV classification in other, similar tomograms, and provide the Fiji classification macro including the trained parameters. In addition, users can train an SVM on their own data using the python script we provide, and integrate the parameters into the Fiji macro, which is quickly achievable via an input dialog.</p>
<p>Our ImageJ classification macro and the python script, for retraining of the classifier, a tutorial and test datasets are available at: <ext-link ext-link-type="uri" xlink:href="https://www.biozentrum.uni-wuerzburg.de/bioinfo/computing/3dart-veselect/" xlink:type="simple">https://www.biozentrum.uni-wuerzburg.de/bioinfo/computing/3dart-veselect/</ext-link>.</p>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Conclusion</title>
<p>We developed a new automated approach to classify vesicles and to quantify their properties from electron tomograms. We combined machine learning with an extension of our previously developed vesicle segmentation workflow 3D ART VeSElecT to reliably distinguish clear core from dense core vesicles using image-based features. We apply this method to electron tomograms of <italic>C</italic>. <italic>elegans</italic> NMJs in young adult hermaphrodites and dauer larvae. Using our ground truth data, we find an increased fraction of dense core vesicles (~ 16% vs ~ 9%) in tomograms matching certain characteristics (cholinergic synapses with &gt; 100 vesicles of a central slice through the AZ area), as well as significantly reduced vesicle size and a higher distance of dense core vesicles to the active zone in dauer larvae compared to young adult hermaphrodites. Our approach is not limited to <italic>C</italic>. <italic>elegans</italic> and can be easily adapted to study differences in synaptic and other vesicles in electron tomograms in various settings and many other model organisms, e.g. in <italic>Danio rerio</italic> [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>].</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Material and methods</title>
<sec id="sec011">
<title>Electron microscopy</title>
<sec id="sec012">
<title>Animals</title>
<p>C. elegans wild-type (Bristol N2) were used and maintained using standard methods [<xref ref-type="bibr" rid="pone.0205348.ref004">4</xref>]. For the experiments, three different young adult hermaphrodite worms and two different dauer larvae were used.</p>
</sec>
<sec id="sec013">
<title>Purification of dauer larvae</title>
<p>For segregation of dauer larvae from other states of the C. elegans life cycle, treatment with sodium dodecyl sulfate (SDS) buffer was used [<xref ref-type="bibr" rid="pone.0205348.ref035">35</xref>]. Firstly, worms were washed from the agar plates using M9 medium [<xref ref-type="bibr" rid="pone.0205348.ref036">36</xref>]. The worm solution was then transferred into 50 ml tubes and centrifuged for 5 min at 2000g at 4°C. Afterwards, the supernatant was removed and the pellet was dissolved in 50 ml 1% SDS solution and incubated on a shaker for 15 min. SDS was then removed by centrifuging (2000g, 5 min, 4°C) and subsequent discarding of the supernatant while retaining 5 ml of solution. The tube was then refilled with distilled water and the procedure repeated 2–3 times. For separation of dauer larvae from dead material, the solution was pipetted into a pit on an unseeded agar plate. Once the solution had dried, living dauer larvae were able to crawl away from the pit. After 1–3 hours, emigrated worms were washed off with M9 medium.</p>
</sec>
<sec id="sec014">
<title>High-pressure freezing, freeze-substitution and electron tomography</title>
<p>HPF, FS and electron tomography were performed as previously described ([<xref ref-type="bibr" rid="pone.0205348.ref019">19</xref>], [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>]). Tomograms of young adult hermaphrodites were from three animals in three different HPF experiments, and Dauer tomograms were from two animals in a single HPF experiment. Pixel size during acquisition and after reconstruction was between 0.6 and 0.8 nm, and sample thickness was between 150 and 250 nm. All tomograms were dual tilt series and were recorded from at least +65° to -65° but not exceeding +70° to -70°.</p>
</sec>
</sec>
<sec id="sec015">
<title>Improvements to 3D ART VeSElecT</title>
<p>We extended our tool 3D ART VeSElecT to calculate various image features of detected vesicles to be used for classification. The workflow is shown in <xref ref-type="supplementary-material" rid="pone.0205348.s001">S1 Fig</xref>, with changes compared to the previous version highlighted by a black box. The overall workflow of 3D ART VeSElecT remained as previously published [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>]. One change in the preprocessing step is the determination of the radius (mean distance between object center and surface voxels in 3D) instead of volume, since the radius or diameter is typically used when comparing vesicle size. Furthermore, automated calculation of the 3D cell volume was added. Since semi-automated selection of the cell outline by the user was already included in the macro, this selection is now basis for calculating the analyzed volume in 3D (which corresponds to cell volume if the selection is taken along the cell membrane, as described in the 3D ART VeSElecT tutorial).</p>
</sec>
<sec id="sec016">
<title>Classification macro</title>
<p>The workflow of the new Fiji macro for classification of DCV and CCV in electron tomograms of synapses comprises four main steps: 1) preparation, 2) reading out features, 3) processing of features followed by labelling of vesicles, and 4) output. In the preparation step, StackDuplicateScale and StackSegmented, which result from the 3D ART VeSElecT recognition macro, are read into the classification macro. StackDuplicateScale is the scaled original tomogram, StackSegmented contains the registered vesicles. First, the macro opens a preparation window for changing the names of read-in stacks (StackDuplicateScale and StackSegmented) and setting parameters for standardization and adaption of SVM weights. In case of adaptation of the SVM algorithm to another user’s needs, values can easily be changed through the input window. In a second step, four characterizing vesicle features are computed from the images: radius, gv, GVSD and distAZ. Radius is determined as the mean of the distance between vesicle center and surface voxels, and gray value (gv) is the mean of all voxels, both excluding the vesicle membrane as described in [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>]. GVSD is a value for standard deviation of gray values in the central slice of each vesicle, since CCVs have a higher gv variance than DCV. It is calculated on a blurred version of the image volume to enhance the contribution of dark membrane voxels (<xref ref-type="fig" rid="pone.0205348.g003">Fig 3</xref>) and uses only the central slice of the vesicle which has the highest contrast, whereas r and gv both are determined in 3D. The distance to the active zone (distAZ) was determined by taking the Euclidean distance in 3D from the center of the vesicle to the manually annotated center of the AZ. In the third step, features are processed, which includes applying an offset to gv (if the darkest vesicle is lighter than a threshold), standardization of parameters, weighting features based on SVM weights, and finally the assignment of labels according to the identified class (CCV = magenta, DCV = green). In the last step, the output is created, including a logfile and visual output shown in new windows. The logfile includes all measured characteristics (e.g. features, classification labels (CCV = 1, DCV = 0), number of vesicles in each class). The visual output shows, besides the input stacks (“StackSegmented” and “StackDuplicateScale”), an additional image stack, named “label” which corresponds to the StackSegmented but displays color-coded vesicles according to their classification. Furthermore a Composit stack, named “CompositLabel” (overlay of original tomogram and the “label” stack) is created.</p>
</sec>
<sec id="sec017">
<title>Comparison of different types of machine learning classifiers</title>
<p>We compared a support vector machine (SVM), random forest (RF, using t = 10, t = 1500; t indicates the number of trees) and k nearest neighbor (KNN, k = 10 neighbors) for their performance on differentiating between CCVs and DCVs based on four image-based characteristics: radius (r), mean gray value (gv), standard deviation of the gray value (GVSD) and distance to the active zone (distAZ). Random forest uses decision trees to classify samples: Comparable to a flowchart, samples are divided based on their features. A random forest utilizes the majority classification of t decision trees each grown on randomly selected training data and split using the best randomly selected feature. Generalization error is lower than for individual decision trees. Performance, but also runtime increases with t. KNN classifies samples based on the majority of their k nearest training samples in feature space. Linear SVM (C = 1) showed the best average classification results (see <xref ref-type="table" rid="pone.0205348.t002">Table 2</xref>). C determines the penalty for falsely classified training data points and therefore indicates bias-variance trade-off, since bias decreases with C [<xref ref-type="bibr" rid="pone.0205348.ref037">37</xref>]. The SVM will be described more accurately below. Parameters of the SVM (<xref ref-type="table" rid="pone.0205348.t003">Table 3</xref>) were determined using all input tomograms as training data and transferred to a Fiji-Macro (<xref ref-type="fig" rid="pone.0205348.g003">Fig 3</xref>) to enable classification downstream of the 3D ART VeSElecT registration macro.</p>
</sec>
<sec id="sec018">
<title>Support vector machine (SVM)</title>
<p>A linear support-vector machine (SVM) divides two classes by a hyperplane. As such, the SVM is a binary classifier dealing with linear classification problems. A one-versus-all approach and kernelization can extend classification to non-linear problems and into more than two classes. Using a nonlinear radial basis function kernel (RBF) did not improve SVM performance, see <xref ref-type="sec" rid="sec002">results</xref>. With the aim of minimizing generalization error, the optimization objective of the SVM is to maximize the margin between the hyperplane and the closest data points of the two classes. Those eponymous support-vectors lie on the positive and negative hyperplane, which are equidistant to the separating hyperplane [<xref ref-type="bibr" rid="pone.0205348.ref037">37</xref>]. As the linear SVM is parametric, the equation of the separating hyperplane can be transferred independently of the training-data (see <xref ref-type="sec" rid="sec010">Results</xref>, <xref ref-type="table" rid="pone.0205348.t003">Table 3</xref> and <xref ref-type="disp-formula" rid="pone.0205348.e001">Eq 1</xref>), with xi being the features and ω<sub>i</sub> the assigned feature-weights. All data points with <inline-formula id="pone.0205348.e002"><alternatives><graphic id="pone.0205348.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0205348.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are assigned to class 1 (CCV), whereas all data points with <inline-formula id="pone.0205348.e003"><alternatives><graphic id="pone.0205348.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0205348.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are assigned to class -1 (DCV).</p>
</sec>
<sec id="sec019">
<title>Implementation of machine learning algorithms</title>
<p>A python 3 script (<xref ref-type="supplementary-material" rid="pone.0205348.s003">S3 Fig</xref>) reads in the CSV files containing the training datasets (<xref ref-type="supplementary-material" rid="pone.0205348.s007">S7 Fig</xref>) and applies classifiers from the scikit-learn library [<xref ref-type="bibr" rid="pone.0205348.ref029">29</xref>]. The manual labels are transformed into a feature array: Particles marked “D” (DCV) are relabeled “-1”. Particles marked “E” (error) are removed. All other markings are relabeled “1”, including “C” (CCV) and “N” (not determinable), since non-determinable particles show more similarities to CCV (<xref ref-type="supplementary-material" rid="pone.0205348.s002">S2 Fig</xref>).</p>
<p>For random forest, we used the <italic>RandomForestClassifier</italic> in scikit-learn. Subsets of the same size as the original training set were drawn with replacement (bootstrap), resulting in about 2/3 of the training set used to build each tree. Features were randomly permuted at each split. Voting was weighted by probability estimates, such that the predicted class was the one with highest mean probability across all trees. For SVM, we used the <italic>SVC</italic> classifier in scikit-learn with a linear or radial basis function (RBF) kernel, and one-vs.-rest decision function. For KNN, we used the <italic>KNeighborsClassifier</italic> in scikit-learn with 10 neighbors, uniform weights, and Euclidean distance metric (p = 2).</p>
<p>Classifiers are evaluated by cross-validation: Data from one CSV file are used as validation data, all other files are concatenated and used as training data (there are as many training-validation combinations as input CSV files). For each combination, features are standardized using mean and standard deviation (sd) of the training data and passed to the classifiers, namely linear SVM, random forest and KNN. An evaluation function determines accuracy of all vesicles and precision, recall and F-score of DCV only (see Eqs (<xref ref-type="disp-formula" rid="pone.0205348.e004">2</xref>)–(<xref ref-type="disp-formula" rid="pone.0205348.e006">4</xref>)). Evaluation results are returned as pandas.DataFrame [<xref ref-type="bibr" rid="pone.0205348.ref038">38</xref>] and as CSV file.</p>
<p>Equations:
<disp-formula id="pone.0205348.e004">
<alternatives>
<graphic id="pone.0205348.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0205348.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<disp-formula id="pone.0205348.e005">
<alternatives>
<graphic id="pone.0205348.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0205348.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:msub><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
<disp-formula id="pone.0205348.e006">
<alternatives>
<graphic id="pone.0205348.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0205348.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula></p>
<p>tp: true positive; fp: false positive; fn: false negative.</p>
<p>The runtime of the training script for the different classifiers was 5 s for t = 10 trees and 140 s for t = 1500 trees. The ImageJ classification macro takes 33s for the calculation, plus the time required to manually click on the active zone. All computations were performed on a 16-core AMD Opteron 1.7 GHz server with 128 GB RAM running Ubuntu Linux 16.04. In comparison, manual classification of vesicles takes an experienced user about 1 h per tomogram. The time required to set up the python environment and prepare the training data depends on the level of experience of the user, but overall there should still be at least a factor of 10 (one order of magnitude) of speed-up with reasonably large data sets of a few tomograms, as in our case. In addition, automated workflows as reported here increase reproducibility compared to manual assignment.</p>
</sec>
</sec>
<sec id="sec020">
<title>Supporting information</title>
<supplementary-material id="pone.0205348.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Changes in the workflow of the 3D ART VeSElecT registration macro.</title>
<p>The figure shows the workflow of the previously published 3D ART VeSElecT macro [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>], with changes framed in black. The macro allows the segmentation of vesicles and includes steps for the preprocessing, separation of the foreground, removal of interfering components and segmentation of individual vesicles. <underline>1) Preprocessing:</underline> The pixel per nm resolution for the image-stack is set by user input. To allow a reproducible routine for different image resolutions and the determination of real vesicle sizes the image-stack is scaled to 1 nm/pixel in x- and y-direction using bilateral scaling. For the z-dimension, no rescaling was applied and the distance between the stack images was set to the actual voxel depth, in order to maintain the proper spatial dimensions without generating additional interpolated images. Afterwards the contrast is enhanced via histogram stretching, and the stack is then smoothed with a mean filter (radius = 3.45 px) to lower the image noise. Additionally, a 2D bilateral filter is applied for noise-reduction and edge-preservation. <underline>2) Separation of foreground:</underline> Thresholding based on mean brightness is performed for every stack image individually. Holes within the vesicles are filled in an additional processing step. <underline>3) Segmentation:</underline> In order to extract the round vesicles, a watershed segmentation is performed in a two-step process: first a 2D segmentation is done, then a 3D Distance map is created and smoothed with a 3D Gaussian blur of 3.45 in order to remove artifacts on the edges. Based on the created distance map, a 3D watershed segmentation is performed, which results in a map of separated particles with different colors. In a final step all particles are registered with the 3D RoiManager, and particles that don't match predefined characteristics (volume, sphericity and ellipse fitting) are automatically removed before the <underline>4) output of the registration</underline> marks the end of the workflow. In the yellow box only one small change was made: instead of volume, the inner radius is now used for size determination.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Statistical analysis of CCV and DCV features.</title>
<p>a + b) boxplots of inner radius and normalized gray value, distance to active zone and DCF of dauer larva and adult hermaphrodites. Significance levels were determined via Mann-Whitney-U: p-values &gt; 0.05 = not significant (n.s.), &lt; 0.05 = *, &lt; 0.01 = **, &lt; 0.001 = ***. c) vesicles standard deviation of gray value vs dense core factor (DCF, see <xref ref-type="supplementary-material" rid="pone.0205348.s010">S1 Text</xref>). Exemplary plots of one dauer (N2 stack01 bp) and one adult hermaphrodite (F1 s1 vnc) tomogram. Marked in hermaphrodite tomogram: DCV with highest GVSD (black square) and DCV with highest DCF (dense core factor, black circle) and corresponding quadrant thresholds (black dotted lines). d) Distribution of CCV and ND within the quadrants of all examined tomograms. The circle represents the DCV with highest DCF (= the most clear-core like DCF). The square represents the DCV with highest GVSD (= with the most clear-core like GVSD). Thresholds were independently determined for each tomogram. Green shaded quadrant (lower left) contains all DCV.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Schematic representation of the python-script that trains and cross-validates SVM, KNN and random forest.</title>
<p>Functions are written bold, descriptions of arguments italic. Horizontal, light gray arrow indicates function calls, vertical black arrows passing of arguments. This schematic is intended to be used together with the documentation of the script (<xref ref-type="supplementary-material" rid="pone.0205348.s011">S2 Text</xref>)</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Scatterplot of cell size change [nm] compared to the DCV ratio.</title>
<p>Since it is known that DCVs appear in higher concentration at the rim of the AZ [<xref ref-type="bibr" rid="pone.0205348.ref019">19</xref>], we compared the cell size of each neuromuscular junction (NMJ) in x and y direction in the first and last picture of each image stack. To obtain the overall cell size change, we added both differences up. This measurement gives a clue of how centrally the NMJ has been cut. For a cut near the center of the NMJ, we expect a very low cell size change rate, whereas for a more remote cut through the AZ (although they demonstrably include dense projections) we expect a higher change of the cell size since synapses tend to narrow at regions far-off the AZ. Tomograms of adult hermaphrodites are plotted in dark red. Results of dauer larvae are plotted in teal green. Tomograms of the selected set (see <xref ref-type="supplementary-material" rid="pone.0205348.s008">S1 Table</xref>, only putative cholinergic synapses with &gt; 100 vesicles and apparent dense projections) are visualized as circles, NMJs with divergent characteristics are shown as different symbols (see legend). This shows that the number of DCVs included in a cell seems to be proportional to the cell size change. As an example, 3 of the dauer larvae tomograms show a DCV ratio of 18–21% but also have a high change of cell size. Hence, although apparent dense projections can be seen in the tomograms, the sample also includes decentral regions, were higher DCV abundance is expected.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Comparison of DCVs (black) characteristics with CCVs (light gray) characteristics, including p-values.</title>
<p>Violin plots show a) inner vesicle radius in nm, b) gray value (gv), c) distance to active zone (distAZ) and d) gray value standard deviation in central slice of each vesicle (GVSD). Panels b)-d) show normalized values of n<sub>h</sub> = 7 tomograms of N2 young adult hermaphrodites (N<sub>CCV</sub> = 949, N<sub>DCV</sub> = 109); n<sub>d</sub> = 8 tomograms of N2 dauer larvae (N<sub>CCV</sub> = 948, N<sub>DCV</sub> = 148). All plots are based on expert curated manual ground truth classification. Statistical significance was determined using the Mann-Whitney U test.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Comparison of ground truth and automatically classified data.</title>
<p>Here we show violin plots of vesicle features for CCV and DCV, as well as dauer and hermaphrodites. Black represents DCV, light gray CCV. Significance was determined with Mann-Whitney-U test. The left side shows violin plots of the ground truth assignment, the right side violin plots of SVM-assigned labels. a) and a') are the radius [nm], b) and b') gray value (normalized), c) and c') are distAZ—the red frame indicates differences between SVM and ground truth assignment. a) and d') are GVSD.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Format of input CSV file.</title>
<p>First four columns are the four features, the fifth column is the manual labels. The python script rewrites manual labels into a binary label-array: “D” (DCV) is rewritten to -1, “E” (error) is removed, and everything else is rewritten as “1” (CCV).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s008" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Overview of the final results for each tomogram.</title>
<p>All selected tomograms (&gt; 100 vesicles, cholinergic, central cut) are marked in yellow. Other tomograms are colored after exclusion criterion in light gray (&lt; 100 vesicles), dark gray (decentral cut plus &lt; 100 vesicles) or blue (GABAergic NMJ).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s009" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s009" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Systematic comparison of classifier performance over a wide range of input parameters.</title>
<p>For the random forest classifier, we use different values for the number of trees, apply the Gini criterion, no bootstrapping, and different feature numbers. For KNN, we vary the number of neighbors, the algorithm, and distance metric. For the linear SVM, we applied a one-vs-one decision function and probability estimates. For the nonlinear SVM, we tried radial basis function (RBF), polynomial and sigmoidal kernels. All other parameters were identical to those reported in the Methods section.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s010" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s010" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Vesicle classification by thresholding a combination of features.</title>
<p>Here we describe why classifying vesicles by manually thresholding a linear combination of features is not sufficient and why a machine learning approach was used instead.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s011" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Documentation of the python script for classifier training.</title>
<p>This document contains detailed instructions on how to use the python script in <xref ref-type="supplementary-material" rid="pone.0205348.s013">S1 File</xref> to retrain the classifiers for your own dataset.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s012" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Documentation for the vesicle classification macro.</title>
<p>This document contains detailed instructions on how to apply the vesicle classification macro in <xref ref-type="supplementary-material" rid="pone.0205348.s014">S2 File</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s013" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s013" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Python script for training classifiers.</title>
<p>This code can be used to train your own classifier. For instructions see <xref ref-type="supplementary-material" rid="pone.0205348.s011">S2 Text</xref>.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s014" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s014" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>Vesicle Classification macro for ImageJ/Fiji.</title>
<p>This is the macro code for calculating vesicle features and applying a pre-trained SVM classifier. Requires the output from the vesicle segmentation workflow 3D ART VeSElecT 2. For instructions see <xref ref-type="supplementary-material" rid="pone.0205348.s012">S3 Text</xref>.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0205348.s015" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pone.0205348.s015" xlink:type="simple">
<label>S3 File</label>
<caption>
<title>Updated vesicle segmentation workflow 3D ART VeSElecT 2.</title>
<p>This is an updated version of the previously published vesicle segmentation workflow in [<xref ref-type="bibr" rid="pone.0205348.ref022">22</xref>] and should be applied before the classification macro in <xref ref-type="supplementary-material" rid="pone.0205348.s014">S2 File</xref>.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Johannes Kattan for his support in the very initial part of the dauer project.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0205348.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salio</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lossi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ferrini</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Merighi</surname> <given-names>A</given-names></name>. <article-title>Neuropeptides as synaptic transmitters</article-title>. <source>Cell Tissue Res</source>. Springer-Verlag; <year>2006</year>;<volume>326</volume>: <fpage>583</fpage>–<lpage>598</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00441-006-0268-3" xlink:type="simple">10.1007/s00441-006-0268-3</ext-link></comment> <object-id pub-id-type="pmid">16847638</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref002"><label>2</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>. <chapter-title>Neuropeptides</chapter-title>. <publisher-name>WormBook</publisher-name>. <year>2008</year>; <fpage>1</fpage>–<lpage>36</lpage>.</mixed-citation></ref>
<ref id="pone.0205348.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhai</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Vardinon-Friedman</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Cases-Langhoff</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Becker</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gundelfinger</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Ziv</surname> <given-names>NE</given-names></name>, <etal>et al</etal>. <article-title>Assembling the presynaptic active zone: a characterization of an active one precursor vesicle</article-title>. <source>Neuron</source>. <year>2001</year>;<volume>29</volume>: <fpage>131</fpage>–<lpage>43</lpage>. <object-id pub-id-type="pmid">11182086</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brenner</surname> <given-names>S</given-names></name>. <article-title>The genetics of Caenorhabditis elegans</article-title>. <source>Genetics. Genetics Society of America</source>; <year>1974</year>;<volume>77</volume>: <fpage>71</fpage>–<lpage>94</lpage>.</mixed-citation></ref>
<ref id="pone.0205348.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Southgate</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Brenner</surname> <given-names>S</given-names></name>. <article-title>The Structure of the Nervous System of the Nematode Caenorhabditis elegans</article-title>. <source>Phil Trans R Soc Lond B</source>. <year>1986</year>;<volume>314</volume> <issue>1165</issue>: <fpage>1</fpage>–<lpage>340</lpage>.</mixed-citation></ref>
<ref id="pone.0205348.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Varshney</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Paniagua</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Chklovskii</surname> <given-names>DB</given-names></name>. <article-title>Structural Properties of the Caenorhabditis elegans Neuronal Network</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>: <fpage>1</fpage>–<lpage>21</lpage>.</mixed-citation></ref>
<ref id="pone.0205348.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haueis</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Slaby</surname> <given-names>J</given-names></name>. <article-title>Connectomes as constitutively epistemic objects: Critical perspectives on modeling in current neuroanatomy</article-title>. <source>Progress in brain research</source>. <year>2017</year>. pp. <fpage>149</fpage>–<lpage>177</lpage>.</mixed-citation></ref>
<ref id="pone.0205348.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Golden</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Riddle</surname> <given-names>DL</given-names></name>. <article-title>The Caenorhabditis elegans dauer larva: Developmental effects of pheromone, food, and temperature</article-title>. <source>Dev Biol</source>. Academic Press; <year>1984</year>;<volume>102</volume>: <fpage>368</fpage>–<lpage>378</lpage>. <object-id pub-id-type="pmid">6706004</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cassada</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Russel</surname> <given-names>RL</given-names></name>. <article-title>The dauerlarva, a post-embryonic developmental variant of the nematode Caenorhabditis elegans</article-title>. <source>Dev Biol</source>. Academic Press; <year>1975</year>;<volume>46</volume>: <fpage>326</fpage>–<lpage>342</lpage>. <object-id pub-id-type="pmid">1183723</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Erkut</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kurzchalia T</surname> <given-names>V</given-names></name>. <article-title>The C. elegans dauer larva as a paradigm to study metabolic suppression and desiccation tolerance</article-title>. <source>Planta</source>. Springer Berlin Heidelberg; <year>2015</year>;<volume>242</volume>: <fpage>389</fpage>–<lpage>396</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00425-015-2300-x" xlink:type="simple">10.1007/s00425-015-2300-x</ext-link></comment> <object-id pub-id-type="pmid">25868548</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pierce</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wisotzkey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Devadhar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Homburger</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Buchman</surname> <given-names>AR</given-names></name>, <etal>et al</etal>. <article-title>Regulation of DAF-2 receptor signaling by human insulin and ins-1, a member of the unusually large and diverse C. elegans insulin gene family</article-title>. <source>Genes Dev</source>. Cold Spring Harbor Laboratory Press; <year>2001</year>;<volume>15</volume>: <fpage>672</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gad.867301" xlink:type="simple">10.1101/gad.867301</ext-link></comment> <object-id pub-id-type="pmid">11274053</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hung</surname> <given-names>WL</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Chitturi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhen</surname> <given-names>M</given-names></name>. <article-title>A Caenorhabditis elegans developmental decision requires insulin signaling-mediated neuron-intestine communication</article-title>. <source>Development</source>. Oxford University Press for The Company of Biologists Limited; <year>2014</year>;<volume>141</volume>: <fpage>1767</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/dev.103846" xlink:type="simple">10.1242/dev.103846</ext-link></comment> <object-id pub-id-type="pmid">24671950</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kennedy</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Ruvkun</surname> <given-names>G</given-names></name>. <article-title>daf-28 encodes a C. elegans insulin superfamily member that is regulated by environmental cues and acts in the DAF-2 signaling pathway</article-title>. <source>Genes Dev</source>. Cold Spring Harbor Laboratory Press; <year>2003</year>;<volume>17</volume>: <fpage>844</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gad.1066503" xlink:type="simple">10.1101/gad.1066503</ext-link></comment> <object-id pub-id-type="pmid">12654727</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cornils</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gloeck</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Alcedo</surname> <given-names>J</given-names></name>. <article-title>Specific insulin-like peptides encode sensory information to regulate distinct developmental processes</article-title>. <source>Development</source>. Oxford University Press for The Company of Biologists Limited; <year>2011</year>;<volume>138</volume>: <fpage>1183</fpage>–<lpage>93</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/dev.060905" xlink:type="simple">10.1242/dev.060905</ext-link></comment> <object-id pub-id-type="pmid">21343369</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ren</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lim</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Johnsen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Albert</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Pilgrim</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Riddle</surname> <given-names>DL</given-names></name>. <article-title>Control of C. elegans larval development by neuronal expression of a TGF-β homolog</article-title>. <source>Science</source>. <year>1996</year>;<volume>274</volume>: <fpage>1389</fpage>–<lpage>1391</lpage>. <object-id pub-id-type="pmid">8910282</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schackwitz</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Inoue</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>JH</given-names></name>. <article-title>Chemosensory Neurons Function in Parallel to Mediate a Pheromone Response in C. elegans</article-title>. <source>Neuron</source>. Cell Press; <year>1996</year>;<volume>17</volume>: <fpage>719</fpage>–<lpage>728</lpage>. <object-id pub-id-type="pmid">8893028</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salio</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Averill</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Priestley</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>Merighi</surname> <given-names>A</given-names></name>. <article-title>Costorage of BDNF and neuropeptides within individual dense-core vesicles in central and peripheral neurons</article-title>. <source>Dev Neurobiol</source>. Wiley Subscription Services, Inc., A Wiley Company; <year>2007</year>;<volume>67</volume>: <fpage>326</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/dneu.20358" xlink:type="simple">10.1002/dneu.20358</ext-link></comment> <object-id pub-id-type="pmid">17443791</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walch-Solimena</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Takei</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Marek</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Midyett</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Südhof</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>De Camilli</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Synaptotagmin: a membrane constituent of neuropeptide-containing large dense-core vesicles</article-title>. <source>J Neurosci. Society for Neuroscience</source>; <year>1993</year>;<volume>13</volume>: <fpage>3895</fpage>–<lpage>903</lpage>.</mixed-citation></ref>
<ref id="pone.0205348.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stigloher</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhan</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Zhen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Richmond</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bessereau</surname> <given-names>J-L</given-names></name>. <article-title>The presynaptic dense projection of the Caenorhabditis elegans cholinergic neuromuscular junction localizes synaptic vesicles at the active zone through SYD-2/liprin and UNC-10/RIM-dependent interactions</article-title>. <source>J Neurosci</source>. <year>2011</year>;<volume>31</volume>: <fpage>4388</fpage>–<lpage>96</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.6164-10.2011" xlink:type="simple">10.1523/JNEUROSCI.6164-10.2011</ext-link></comment> <object-id pub-id-type="pmid">21430140</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kittelmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hegermann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Goncharov</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Taru</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ellisman</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Richmond</surname> <given-names>JE</given-names></name>, <etal>et al</etal>. <article-title>Liprin-α/SYD-2 determines the size of dense projections in presynaptic active zones in C. elegans</article-title>. <source>J Cell Biol</source>. <year>2013</year>;<volume>203</volume>: <fpage>849</fpage>–<lpage>863</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1083/jcb.201302022" xlink:type="simple">10.1083/jcb.201302022</ext-link></comment> <object-id pub-id-type="pmid">24322429</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lim</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Chitturi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Laskova</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Meng</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Findeis</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wiekenberg</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Neuroendocrine modulation sustains the C. elegans forward motor state</article-title>. <source>Elife</source>. <year>2016</year>;<volume>5</volume>.</mixed-citation></ref>
<ref id="pone.0205348.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kaltdorf</surname> <given-names>KV</given-names></name>, <name name-style="western"><surname>Schulze</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Helmprobst</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kollmannsberger</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dandekar</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Stigloher</surname> <given-names>C</given-names></name>. <article-title>FIJI Macro 3D ART VeSElecT: 3D Automated Reconstruction Tool for Vesicle Structures of Electron Tomograms</article-title>. <name name-style="western"><surname>Dyer</surname> <given-names>E</given-names></name>, editor. <source>PLOS Comput Biol</source>. Public Library of Science; <year>2017</year>;<volume>13</volume>: <fpage>e1005317</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005317" xlink:type="simple">10.1371/journal.pcbi.1005317</ext-link></comment> <object-id pub-id-type="pmid">28056033</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Helmprobst</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Stigloher</surname> <given-names>C</given-names></name>. <article-title>Presynaptic architecture of the larval zebrafish neuromuscular junction</article-title>. <source>J Comp Neurol</source>. <year>2015</year>; <volume>523</volume>;<issue>13</issue>: <fpage>1984</fpage>–<lpage>97</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/cne.23775" xlink:type="simple">10.1002/cne.23775</ext-link></comment> <object-id pub-id-type="pmid">25766140</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Phillips</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Ian</surname> <given-names>M</given-names></name>. <article-title>Neuropeptides: Regulators of Physiological Processes</article-title>. <source>Regul Pept</source>. Elsevier; <year>2000</year>;<volume>90</volume>: <fpage>101</fpage>.</mixed-citation></ref>
<ref id="pone.0205348.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mastronarde</surname> <given-names>DN</given-names></name>. <article-title>Dual-axis tomography: an approach with alignment methods that preserve resolution</article-title>. <source>J Struct Biol</source>. <year>1997</year>;<volume>120</volume>: <fpage>343</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/jsbi.1997.3919" xlink:type="simple">10.1006/jsbi.1997.3919</ext-link></comment> <object-id pub-id-type="pmid">9441937</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zampighi</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Fain</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Zampighi</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Cantele</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lanzavecchia</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>EM</given-names></name>. <article-title>Conical Electron Tomography of a Chemical Synapse: Polyhedral Cages Dock Vesicles to the Active Zone</article-title>. <source>J Neurosci</source>. <year>2008</year>;<fpage>28</fpage>.</mixed-citation></ref>
<ref id="pone.0205348.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zampighi</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Zampighi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Fain</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Cantele</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lanzavecchia</surname> <given-names>S</given-names></name>. <article-title>Conical tomography II: A method for the study of cellular organelles in thin sections</article-title>. <source>J Struct Biol</source>. <year>2005</year>;<volume>151</volume>: <fpage>263</fpage>–<lpage>274</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jsb.2005.05.008" xlink:type="simple">10.1016/j.jsb.2005.05.008</ext-link></comment> <object-id pub-id-type="pmid">16084109</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robertson</surname> <given-names>JD</given-names></name>. <article-title>The Early Days of Electron Microscopy of Nerve Tissue and Membranes</article-title>. <source>Int Rev Cytol</source>. <year>1987</year>;<volume>100</volume>: <fpage>129</fpage>–<lpage>201</lpage>. <object-id pub-id-type="pmid">3549603</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pedregosa</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Varoquaux</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gramfort</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Michel</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Thirion</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Grisel</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Scikit-learn: Machine Learning in Python</article-title>. <source>J Mach Learn Res</source>. <year>2012</year>;<volume>12</volume>: <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation></ref>
<ref id="pone.0205348.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Artalejo</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Elhamdani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Palfrey</surname> <given-names>HC</given-names></name>. <article-title>Secretion: Dense-core vesicles can kiss-and-run too</article-title>. <source>Curr Biol</source>. Cell Press; <year>1998</year>;<volume>8</volume>: <fpage>R62</fpage>–<lpage>R65</lpage>. <object-id pub-id-type="pmid">9427637</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rutter</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Tsuboi</surname> <given-names>T</given-names></name>. <article-title>Kiss and run exocytosis of dense core secretory vesicles</article-title>. <source>Neuroreport</source>. <year>2004</year>;<volume>15</volume>: <fpage>79</fpage>–<lpage>81</lpage>. <object-id pub-id-type="pmid">15106835</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tsuboi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>McMahon</surname> <given-names>HT</given-names></name>, <name name-style="western"><surname>Rutter</surname> <given-names>GA</given-names></name>. <article-title>Mechanisms of dense core vesicle recapture following "kiss and run" ("Cavicapture") exocytosis in insulin-secreting cells</article-title>. <source>J Biol Chem</source>. American Society for Biochemistry and Molecular Biology; <year>2004</year>;<volume>279</volume>: <fpage>47115</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1074/jbc.M408179200" xlink:type="simple">10.1074/jbc.M408179200</ext-link></comment> <object-id pub-id-type="pmid">15331588</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Markus</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Petit</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>LeBoutillier</surname> <given-names>JC</given-names></name>. <article-title>Synaptic structural changes during development and aging</article-title>. <source>Brain Res</source>. <year>1987</year>;<volume>432</volume>: <fpage>239</fpage>–<lpage>48</lpage>. <object-id pub-id-type="pmid">3676839</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shawe-Taylor</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cristianini</surname> <given-names>N</given-names></name>. <article-title>Kernel Methods for Pattern Analysis [Internet]</article-title>. <source>Elements</source>. <year>2004</year>.</mixed-citation></ref>
<ref id="pone.0205348.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cassada</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Russell</surname> <given-names>RL</given-names></name>. <article-title>The dauerlarva, a post-embryonic developmental variant of the nematode Caenorhabditis elegans</article-title>. <source>Dev Biol</source>. <year>1975</year>;<volume>46</volume>: <fpage>326</fpage>–<lpage>342</lpage>. <object-id pub-id-type="pmid">1183723</object-id></mixed-citation></ref>
<ref id="pone.0205348.ref036"><label>36</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Hope</surname> <given-names>I</given-names></name>. <chapter-title>C. elegans a practical approach</chapter-title>. <publisher-name>Oxford Univ Press</publisher-name>. <year>1999</year>;</mixed-citation></ref>
<ref id="pone.0205348.ref037"><label>37</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Raschka</surname> <given-names>S</given-names></name>. <chapter-title>Python Machine Learning</chapter-title>. <publisher-name>Packt Publishing</publisher-name>; <year>2015</year>.</mixed-citation></ref>
<ref id="pone.0205348.ref038"><label>38</label><mixed-citation publication-type="other" xlink:type="simple">McKinney W. Data Structures for Statistical Computing in Python. Proc 9th Python Sci Conf. 2010;1697900: 51–56.</mixed-citation></ref>
</ref-list>
</back>
</article>