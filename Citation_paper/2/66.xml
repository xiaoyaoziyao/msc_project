<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-14-04047</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0096821</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Transcriptome analysis</subject><subj-group><subject>Genome expression analysis</subject></subj-group></subj-group><subj-group><subject>Sequence assembly tools</subject></subj-group></subj-group></subj-group><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer and information sciences</subject><subj-group><subject>Computer applications</subject><subj-group><subject>Web-based applications</subject></subj-group></subj-group><subj-group><subject>Software engineering</subject><subj-group><subject>Software tools</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>RNAbrowse: RNA-Seq De Novo Assembly Results Browser</article-title>
<alt-title alt-title-type="running-head">RNAbrowse: RNA-Seq De Novo Assembly Results Browser</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mariette</surname><given-names>Jérôme</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Noirot</surname><given-names>Céline</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Nabihoudine</surname><given-names>Ibounyamine</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bardou</surname><given-names>Philippe</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hoede</surname><given-names>Claire</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Djari</surname><given-names>Anis</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Cabau</surname><given-names>Cédric</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Klopp</surname><given-names>Christophe</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Plate-forme bio-informatique Genotoul/Biométrie et Intelligence Artificielle, INRA, Castanet-Tolosan, France</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Plate-forme SIGENAE/Génétique Cellulaire, INRA, Castanet-Tolosan, France</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Jordan</surname><given-names>I. King</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Georgia Institute of Technology, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">support.genopole@toulouse.inra.fr</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: JM CK. Performed the experiments: JM CN IN PB. Wrote the paper: CK JM. Tested the software: AD CH CC.</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>13</day><month>5</month><year>2014</year></pub-date>
<volume>9</volume>
<issue>5</issue>
<elocation-id>e96821</elocation-id>
<history>
<date date-type="received"><day>28</day><month>1</month><year>2014</year></date>
<date date-type="accepted"><day>11</day><month>4</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Mariette et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Transcriptome analysis based on a de novo assembly of next generation RNA sequences is now performed routinely in many laboratories. The generated results, including contig sequences, quantification figures, functional annotations and variation discovery outputs are usually bulky and quite diverse. This article presents a user oriented storage and visualisation environment permitting to explore the data in a top-down manner, going from general graphical views to all possible details. The software package is based on biomart, easy to install and populate with local data. The software package is available under the GNU General Public License (GPL) at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.genotoul.fr/RNAbrowse" xlink:type="simple">http://bioinfo.genotoul.fr/RNAbrowse</ext-link>.</p>
</abstract>
<funding-group><funding-statement>The authors have no support or funding to report.</funding-statement></funding-group><counts><page-count count="7"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>The massive sequencing cost decrease has attracted a large community of new users, some of them studying organisms for which the reference genome sequence is still not available. When trying to understand mechanisms taking place at the gene level they usually would start with a de novo transcriptome assembly approach. Software packages such as Trinity <xref ref-type="bibr" rid="pone.0096821-Grabherr1">[1]</xref> or Oases <xref ref-type="bibr" rid="pone.0096821-Schulz1">[2]</xref> are mature enough to produce reliable contigs from short reads. The analyses performed on the assembled contigs generate a large amount of heterogeneous results including variations, functional annotation and expression measurements. The processing steps of these pipelines are usually shared inside the community but the parameters, the tools and the reference databases used are specific. The results are often provided throught a WEB server including a BLAST query form and download links.</p>
<p>Cbrowse <xref ref-type="bibr" rid="pone.0096821-Li1">[3]</xref> is a WEB environment presenting this kind of results throught graphical views and query forms. The functional annotation part is not implemented yet and the query possibilities are very limited. The Galaxy <xref ref-type="bibr" rid="pone.0096821-Goecks1">[4]</xref> engine provides users with an interface to create and track workflow executions. It already embeds RNA-Seq analysis and assembly components. However, none of them offers user-friendly query and vizualisation features designed for RNA-Seq de novo annotation.</p>
<p>In its last version (0.8), biomart <xref ref-type="bibr" rid="pone.0096821-Zhang1">[5]</xref> is developed as an easily extensible query infrastructures which can be specialized in the presentation of focused data types. On top of the database and beside the proposed query forms it is possible to add new pages as plug-ins in order to present data in a user-friendly way.</p>
</sec><sec id="s2">
<title>Results</title>
<p>RNAbrowse permits sequencing facilities and, even small, bioinformatic teams to give a user-friendly access to RNA-Seq de novo results, helping biologists to analyse and extract meaningful information from their data.</p>
<p>RNAbrowse includes two components: a web-based user interface and an administration command line tool presented here-after.</p>
<sec id="s2a">
<title>Implementation and installation</title>
<p>RNAbrowse is based on a newly defined biomart schema specialized in RNA-Seq de novo assembly. It includes two marts, storing contig and variant data, and some extra tables for meta-data. The WEB-based user interface is implemented as a biomart plugin using the latest jquery and highcharts features. To perform all third parts requests, the software takes advantage of the biomart API and implements several biomart processors to prepare the data before presenting it.</p>
<p>The command line administration tool is based on a workflow execution environment called jflow. It is developed in Python. The installation requires a standard unix server and a MySQL database. The downloadable installation archive, provided on the project web-site, has only to be uncompressed before setting up a first instance. In order to ease the testing, a minimal and a complete example dataset are included in the archive.</p>
</sec><sec id="s2b">
<title>WEB interface</title>
<p>The web interface was designed to display the data starting with general views before zooming into detailed ones. It is organised in four levels. The first, called the instance level, corresponds to the home page of the web-site presenting all the available projects. A project gathers the data of an assembly. The second level is entered after having chosen a project. The introduction page contains a picture of the assembled species, a description text and a table including all the analysis processing steps with software names, parameters and versions in order to ease materials and methods writing.</p>
<p>The third level is accessed through the menu bar items at the top of the project page and presents general informations about contigs and variants. It also includes the download page. The contigs (<xref ref-type="fig" rid="pone-0096821-g001">Figure 1</xref>) and variants (<xref ref-type="fig" rid="pone-0096821-g002">Figure 2</xref>) overview pages include a set of graphics showing general statistics, containing for example the contig length histogram, alignment rate bar-chart, mostly represented species in the functional annotation histogram or variant types distribution as a pie-chart. These graphs enable rapid assembly validation and comparison. For contigs, the next section includes detailed information about the different sequenced libraries and provides access to tools such as Venn diagrams (<xref ref-type="fig" rid="pone-0096821-g003">Figure 3</xref>) and a differential digital display. The last section corresponds to the favourite contigs or variants table which can be updated by the user while exploring detailed views. The forth level sections gathers all information on a contig or a variant and provides multiple tools to analyse them further.</p>
<fig id="pone-0096821-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0096821.g001</object-id><label>Figure 1</label><caption>
<title>Contigs overview figures.</title>
<p>From the main contig page, graphics synthesizing informations on the contig set can be displayed. The presented graphs are contigs depth versus size plot (top-left), contigs length distribution (top-right), contig best annotations pie chart (bottom-left) and libraries mapping bar chart (bottom-right). All graphics can be printed or downloaded in four different formats (PNG, JPEG, PDF, SVG).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0096821.g001" position="float" xlink:type="simple"/></fig><fig id="pone-0096821-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0096821.g002</object-id><label>Figure 2</label><caption>
<title>Variants overview figures.</title>
<p>From the main variant page, graphics synthesizing informations on the variant set can be displayed. The presented graphs are InDels size distribution (top) and Indels annotations pie chart (bottom).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0096821.g002" position="float" xlink:type="simple"/></fig><fig id="pone-0096821-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0096821.g003</object-id><label>Figure 3</label><caption>
<title>The Venn diagram shows the number of contigs shared between libraries and the specific ones.</title>
<p>It has been built using libraries alignment data. To build a new diagram the user has to select the libraries he wants to have in each pool (from two to five). If the user clicks on a figure in the graph the list of corresponding contigs will appear in the list box on the right hand side. Clicking on the contig names redirects to the corresponding page.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0096821.g003" position="float" xlink:type="simple"/></fig>
<p>To illustrate these features we could imagine a simple use case in which a user would like to find all contigs corresponding to a gene for which the sequence is available for another species. This can be done by an alignment versus the contigs using the blast query form (<xref ref-type="fig" rid="pone-0096821-g004">Figure 4</xref>) or by a name or description search using the biomart form. The user can then add the found contigs to the favourite table. For each contig, the sequence can be extracted to perform a multiple alignment in order to check if different splice forms have been assembled. All possible open reading frames can be sought (<xref ref-type="fig" rid="pone-0096821-g005">Figure 5</xref>). Annotations can be graphically displayed in jbrowse <xref ref-type="bibr" rid="pone.0096821-Westesson1">[6]</xref>. It is also possible to graphically verify if the expression levels along the contig are conserved between libraries (<xref ref-type="fig" rid="pone-0096821-g006">Figure 6</xref>).</p>
<fig id="pone-0096821-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0096821.g004</object-id><label>Figure 4</label><caption>
<title>The blast query form allows to search the contigs as a database using as input sequence(s) in Fasta format.</title>
<p>Others parameters which can be used in this query are blast program (blastn, blastx), expected value and maximum number of outputs to be shown. The blast results are shown in a table allowing to add new contigs as favorite. Ticking the alignment checkbox enables to browse the alignment results.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0096821.g004" position="float" xlink:type="simple"/></fig><fig id="pone-0096821-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0096821.g005</object-id><label>Figure 5</label><caption>
<title>The sequence view provides informations such as nucleotide content and longest open reading frame (ORF).</title>
<p>The possible starts are presented in green, stops in red and ORFs in blue. The query form permits different actions on the sequence such as extraction, reverse complementation, translation in different frames, ORF presentation and text search.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0096821.g005" position="float" xlink:type="simple"/></fig><fig id="pone-0096821-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0096821.g006</object-id><label>Figure 6</label><caption>
<title>The contig depth view enables to visualise the coverage of the reads of the different libraries on a given contig.</title>
<p>Each library has a defined colour in the table and the same one on the graphic. It is possible to modify the graphical layout by averaging different library depths. This is typically to be used when you work with replicates.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0096821.g006" position="float" xlink:type="simple"/></fig>
<p>All generated graphics can directly be printed from the web-page or downloaded in JPG, PNG, PDF, SVG formats or as a CSV file. Tables can be sorted on all columns, text searched and exported to the clipboard or as CSV files. The download page files are organised as topics. It is possible to download a single file, all the files of a topic or to get the text file containing all the URLs of a topic in order to download the files from the command line. The Download section gathers raw files but also processed ones, enabling users to perform further analyses.</p>
<p>A demo site containing a small set of results is accessible at: <ext-link ext-link-type="uri" xlink:href="http://ngspipelines.toulouse.inra.fr:9012/" xlink:type="simple">http://ngspipelines.toulouse.inra.fr:9012/</ext-link>.</p>
</sec><sec id="s2c">
<title>Administration tools and extensions</title>
<p>The administration interface is a command line tool with which the environment can be set up. It includes database creation, data formatting and loading and web server managing. The loading process requiers standard file formats, provided by most commonly used tools. During the database upload phase, datafile format compliance is checked. It is possible to set up a minimum environment with just three files: a contig Fasta file, the corresponding annotation file and an alignment file. The reads quantifications can be provided as an input file or calculated during the upload process. The number of input files being potentially quite important for large projects, a configuration file template is provided. It can be used as a loading script parameter.</p>
<p>Depending on the provided inputs, RNAbrowse processing steps can be quite time consuming. Thus, in a production environment, the tool can be set up to use different schedulers such as condor, sge, moab, workqueue or mpi-queuein in order to parallelize the loading. If the loading process fails, a recovery command is available to rerun it.</p>
<p>The website provided to the biologists can be secured using the biomart Open-ID or jetty realm features.</p>
<p>Users with some programming knowledge can add new graphics by loading the corresponding data in the analysis table and writing a javascript module.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>RNAbrowse is a simple and efficient solution to give access to RNA-Seq de novo results on the Internet. It includes many features that help biologists to analyse and extract biologically meaningful information from their data. The installation and user manuals as well as a general documentation are available on the project website: <ext-link ext-link-type="uri" xlink:href="http://bioinfo.genotoul.fr/RNAbrowse" xlink:type="simple">http://bioinfo.genotoul.fr/RNAbrowse</ext-link>. The software has been designed to be easily extended by developpers having some biomart insights.</p>
</sec></body>
<back>
<ack>
<p>We would like to acknowledge all our users for providing us useful feedback on the system and for pointing out features worth developing.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0096821-Grabherr1"><label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">Grabherr MG, Haas BJ, Yassour M, Levin JZ, Thompson DA, <etal>et al</etal>.. (2011) Full-length transcriptome assembly from rna-seq data without a reference genome. Nat Biotech <volume>29</volume>..</mixed-citation>
</ref>
<ref id="pone.0096821-Schulz1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schulz</surname><given-names>MH</given-names></name>, <name name-style="western"><surname>Zerbino</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Birney</surname><given-names>E</given-names></name> (<year>2012</year>) <article-title>Oases: robust de novo rna-seq assembly across the dynamic range of expression levels</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>1086</fpage>–<lpage>1092</lpage>.</mixed-citation>
</ref>
<ref id="pone.0096821-Li1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Ji</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Dong</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Schmidt</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Lenox</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Cbrowse: a sam/bam-based contig browser for transcriptome assembly visualization and analysis</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>2382</fpage>–<lpage>2384</lpage>.</mixed-citation>
</ref>
<ref id="pone.0096821-Goecks1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goecks</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Nekrutenko</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Taylor</surname><given-names>J</given-names></name> (<year>2010</year>) <collab xlink:type="simple">Team TG</collab> (<year>2010</year>) <article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title>. <source>Genome Biology</source> <volume>11</volume>: <fpage>R86</fpage>.</mixed-citation>
</ref>
<ref id="pone.0096821-Zhang1"><label>5</label>
<mixed-citation publication-type="other" xlink:type="simple">Zhang J, Haider S, Baran J, Cros A, Guberman JM, <etal>et al</etal>.. (2011) Biomart: a data federation framework for large collaborative projects. Database 2011.</mixed-citation>
</ref>
<ref id="pone.0096821-Westesson1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Westesson</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Skinner</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name> (<year>2013</year>) <article-title>Visualizing next-generation sequencing data with jbrowse</article-title>. <source>Briefings in Bioinformatics</source> <volume>14</volume>: <fpage>172</fpage>–<lpage>177</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>