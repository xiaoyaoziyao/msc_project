<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-11-20074</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0031386</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
              <subj-group>
                <subject>Genome analysis tools</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Ecology</subject>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
          <subj-group>
            <subject>Microbiology</subject>
          </subj-group>
          <subj-group subj-group-type="Discipline-v2">
            <subject>Computer science</subject>
            <subj-group>
              <subject>Computerized simulations</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Computational Biology</subject>
          <subject>Ecology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Assessment of Metagenomic Assembly Using Simulated Next Generation Sequencing Data</article-title><alt-title alt-title-type="running-head">Comparison of Assembly of Simulated Metagenomes</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Mende</surname>
            <given-names>Daniel R.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Waller</surname>
            <given-names>Alison S.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Sunagawa</surname>
            <given-names>Shinichi</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Järvelin</surname>
            <given-names>Aino I.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Chan</surname>
            <given-names>Michelle M.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Arumugam</surname>
            <given-names>Manimozhiyan</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Raes</surname>
            <given-names>Jeroen</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Bork</surname>
            <given-names>Peer</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>European Molecular Biology Laboratory, Heidelberg, Germany</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Computational and Systems Biology Program, Massachusetts Institute of Technology, Cambridge Massachusetts, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>VIB, Vrije Universiteit Brussel, Brussels, Belgium</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Max Delbrück Centre for Molecular Medicine, Berlin, Germany</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Parkinson</surname>
            <given-names>John</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Hospital for Sick Children, Canada</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">bork@embl.de</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: ASW DRM SS JR PB. Performed the experiments: ASW DRM SS AIJ MMC MA JR. Analyzed the data: ASW DRM SS. Contributed reagents/materials/analysis tools: ASW DRM SS AIJ MMC MA. Wrote the paper: ASW DRM PB.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>23</day>
        <month>2</month>
        <year>2012</year>
      </pub-date><volume>7</volume><issue>2</issue><elocation-id>e31386</elocation-id><history>
        <date date-type="received">
          <day>11</day>
          <month>10</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>6</day>
          <month>1</month>
          <year>2012</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Mende et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Due to the complexity of the protocols and a limited knowledge of the nature of microbial communities, simulating metagenomic sequences plays an important role in testing the performance of existing tools and data analysis methods with metagenomic data. We developed metagenomic read simulators with platform-specific (Sanger, pyrosequencing, Illumina) base-error models, and simulated metagenomes of differing community complexities. We first evaluated the effect of rigorous quality control on Illumina data. Although quality filtering removed a large proportion of the data, it greatly improved the accuracy and contig lengths of resulting assemblies. We then compared the quality-trimmed Illumina assemblies to those from Sanger and pyrosequencing. For the simple community (10 genomes) all sequencing technologies assembled a similar amount and accurately represented the expected functional composition. For the more complex community (100 genomes) Illumina produced the best assemblies and more correctly resembled the expected functional composition. For the most complex community (400 genomes) there was very little assembly of reads from any sequencing technology. However, due to the longer read length the Sanger reads still represented the overall functional composition reasonably well. We further examined the effect of scaffolding of contigs using paired-end Illumina reads. It dramatically increased contig lengths of the simple community and yielded minor improvements to the more complex communities. Although the increase in contig length was accompanied by increased chimericity, it resulted in more complete genes and a better characterization of the functional repertoire. The metagenomic simulators developed for this research are freely available.</p>
      </abstract><funding-group><funding-statement>This research received funding from MetaHIT, the Natural Sciences and Engineering Research Council of Canada (funding A.S.W.) and European Molecular Biology Laboratory. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="11"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>The field of metagenomics examines the functional and phylogenetic composition of microbial communities in their natural habitats and allows access to the genomic content of the majority of organisms that are not easily cultivatable <xref ref-type="bibr" rid="pone.0031386-Handelsman1">[1]</xref>. This is achieved through extraction of genomic DNA directly from environmental samples followed by sequencing, assembly and data analysis. Metagenomics has lead to the characterization of microbial communities in a variety of habitats on the earth: for example, the ocean <xref ref-type="bibr" rid="pone.0031386-Venter1">[2]</xref>–<xref ref-type="bibr" rid="pone.0031386-Angly1">[3]</xref>, soil <xref ref-type="bibr" rid="pone.0031386-Abulencia1">[4]</xref>–<xref ref-type="bibr" rid="pone.0031386-Tringe1">[5]</xref>, hot springs <xref ref-type="bibr" rid="pone.0031386-Schoenfeld1">[6]</xref> and acid-mine drainage ponds <xref ref-type="bibr" rid="pone.0031386-Tyson1">[7]</xref>–<xref ref-type="bibr" rid="pone.0031386-Chivian1">[8]</xref>. More recently the human microbiome, in particular the gastro intestinal tract <xref ref-type="bibr" rid="pone.0031386-Gill1">[9]</xref>–<xref ref-type="bibr" rid="pone.0031386-Arumugam1">[11]</xref>, gained considerable attention and large-scale metagenomic initiatives now promise to characterize the microbiota in many different body sites with an ultimate goal of understanding human health and disease (e.g. <xref ref-type="bibr" rid="pone.0031386-Peterson1">[12]</xref>). The very first projects used Sanger sequencing, and even though Sanger sequencing is used less and less due to the advent of less expensive next generation sequencing, it still can reveal novel biological concepts <xref ref-type="bibr" rid="pone.0031386-Arumugam1">[11]</xref>. In addition, reanalysis of Sanger sequencing data have led to a number of recent discoveries <xref ref-type="bibr" rid="pone.0031386-Raes1">[13]</xref>–<xref ref-type="bibr" rid="pone.0031386-Gianoulis1">[15]</xref>. Yet, the currently two most prominent sequencing methods used for metagenomics are pyrosequencing <xref ref-type="bibr" rid="pone.0031386-Edwards1">[16]</xref>–<xref ref-type="bibr" rid="pone.0031386-Turnbaugh1">[17]</xref> and most recently Illumina sequencing <xref ref-type="bibr" rid="pone.0031386-Qin1">[10]</xref> enabling studies of a wide array of ecosystems, with the consequence of an exponential increase in environmental sequencing <xref ref-type="bibr" rid="pone.0031386-Singh1">[18]</xref>.</p>
      <p>The initial steps in metagenomic data analysis involve the assembly of DNA sequence reads into contiguous consensus sequences (contigs), followed by prediction of genes. The protein-coding genes are then used to predict the functional repertoire encoded in the metagenomes and the phylogenetic composition can be estimated using a variety of methods <xref ref-type="bibr" rid="pone.0031386-Raes2">[19]</xref>. Data analysis pipeline tools like SmashCommunity <xref ref-type="bibr" rid="pone.0031386-Arumugam2">[20]</xref>, MG-RAST <xref ref-type="bibr" rid="pone.0031386-Meyer1">[21]</xref>, IMG/M <xref ref-type="bibr" rid="pone.0031386-Markowitz1">[22]</xref> and Metarep <xref ref-type="bibr" rid="pone.0031386-Goll1">[23]</xref>, are complemented by numerous special purpose tools, and they all need to be validated. As there is no completely annotated metagenome available, simulations based on genomic data provide the currently only feasible way to get close to the truth. Indeed a number of simulations have already been performed in metagenomics. Mavromatis and colleagues <xref ref-type="bibr" rid="pone.0031386-Mavromatis1">[24]</xref> simulated metagenomic data by sampling sequencing reads from isolate genomes and then benchmarked assembly and annotation tools for Sanger-sequenced metagenomes. In addition, some simulator software has been developed that allows users to create metagenomes with desired properties: MetaSim <xref ref-type="bibr" rid="pone.0031386-Richter1">[25]</xref>, Grinder <xref ref-type="bibr" rid="pone.0031386-Angly2">[26]</xref> and NGSfy <xref ref-type="bibr" rid="pone.0031386-Pignatelli1">[27]</xref>.</p>
      <p>Here we investigate the fidelity of metagenomic assemblies of next generation sequencing methods (pyrosequencing and Illumina) and compare these to classical Sanger sequencing as well as to previous results. To enable this, we developed two new metagenomic simulators iMESS (for Sanger and pyrosequencing) and iMESSi (for Illumina) that not only provide realistic sequencing reads, but also simulate errors and corresponding quality values based on actual metagenomic data. The simulated metagenomes were used to benchmark currently used assembly protocols. Due to the current uprise of Illumina sequencing in metagenomics, we also assessed the impact of quality control as well as the use of scaffolding in metagenomics. The simulators are freely available to allow the design of custom metagenomic data, and in order to allow researchers to benchmark new tools using these datasets the raw and assembled data are available at <ext-link ext-link-type="uri" xlink:href="http://www.bork.embl.de/~mende/simulated_data/" xlink:type="simple">http://www.bork.embl.de/~mende/simulated_data/</ext-link>.</p>
    </sec>
    <sec id="s2" sec-type="methods">
      <title>Methods</title>
      <sec id="s2a">
        <title>iMESS</title>
        <p>iMESS is a metagenomic simulator for Sanger sequencing as well as pyrosequencing. Users can generate Metagenomes through an easy-to-use website at <ext-link ext-link-type="uri" xlink:href="http://www.bork.embl.de/software/iMESS" xlink:type="simple">http://www.bork.embl.de/software/iMESS</ext-link>. First the user has to specify a desired community structure, by selecting the number of organisms and the shape of the rank abundance curve. Next the sequencing method and the amount of sequencing (number of reads) have to be specified. Using these parameters the simulator calculates how many reads of each organism's genome should be sequenced. iMESS then calls ReadSim (<ext-link ext-link-type="uri" xlink:href="http://ab.inf.uni-tuebingen.de/software/readsim/" xlink:type="simple">http://ab.inf.uni-tuebingen.de/software/readsim/</ext-link>) to generate reads with sequencing errors but without quality values. Quality value models were determined by obtaining quality values from actual metagenomic reads and fitting a function. For Sanger sequences quality models were generated for 3 different data sets: JGI <xref ref-type="bibr" rid="pone.0031386-Tyson1">[7]</xref> <xref ref-type="bibr" rid="pone.0031386-GarcaMartn1">[28]</xref>, TIGR <xref ref-type="bibr" rid="pone.0031386-Gill1">[9]</xref>, JAP <xref ref-type="bibr" rid="pone.0031386-Kurokawa1">[29]</xref>. For pyrosequencing one model was determined based on reads from a real dataset (unpublished) with a 250 bp median length. Read sequences and quality values are written to a .fasta and a .qual file. For more details please refer to the iMESS manual online.</p>
      </sec>
      <sec id="s2b">
        <title>iMESS_Illumina</title>
        <p>iMESSi is a metagenomic simulator for the Illumina sequencing technology. It can be downloaded at: <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/cmessi/" xlink:type="simple">http://sourceforge.net/projects/cmessi/</ext-link>. Similar to iMESS the user first specifies what kind of community should be simulated. The user also has to specify a number of other parameters including the total number of inserts, the read length, the insert size and standard deviation of the read length. The actual number of inserts sampled from each genome is calculated in a similar fashion as done in Metasim <xref ref-type="bibr" rid="pone.0031386-Richter1">[25]</xref>. To generate realistic quality values we obtained quality values from the MetaHIT gene catalog dataset <xref ref-type="bibr" rid="pone.0031386-Qin1">[10]</xref> and clustered the runs by quality values using Euclidean distances. This resulted in 3 different clusters for 75 bp reads and one for 44 bp reads. To simulate errors within the reads the quality values are then mapped to a ‘read’ extracted from a reference genome and then random errors were generated at the probability as defined by the equation below.</p>
        <p>Q = −10 log<sub>10</sub> (P/(1−P)), where Q is the Phred quality score and P is the error probability <xref ref-type="bibr" rid="pone.0031386-Ewing1">[30]</xref>.</p>
        <p>The 4 error models for 75 bp reads show large differences in average error. The error models are available at: <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/cmessi/" xlink:type="simple">http://sourceforge.net/projects/cmessi/</ext-link>, but users can easily generate their own error models by extracting the quality values from any Illumina sequencing run and converting them to Sanger scale Phred scores in .qual format. This enables users to generate realistic data for their sequencing machine and protocol and enables simulations of Illumina reads from any sequencing read length used by Illumina sequencing. The sequences and their assigned quality values are returned as fastq formatted files <xref ref-type="bibr" rid="pone.0031386-Cock1">[31]</xref>.</p>
      </sec>
      <sec id="s2c">
        <title>Simulated Metagenomes</title>
        <p>Metagenomic datasets were simulated for Sanger sequencing, pyrosequencing, and Illumina sequencing. For each sequencing technology, three metagenomes were simulated to mimic different community complexities (10, 100 and 400 genomes). (<xref ref-type="table" rid="pone-0031386-t001">Table 1</xref>, <xref ref-type="supplementary-material" rid="pone.0031386.s001">Table S1</xref>, <xref ref-type="supplementary-material" rid="pone.0031386.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pone.0031386.s003">S3</xref>). We generated metagenomes of the three sequencing platform at different sequencing depths in order to account for the price difference between the three sequencing technologies and the usual sequencing effort for metagenomic projects using each technology. Thus, about 15 times more base pairs were generated for Illumina than for pyrosequencing, to reflect the lower cost associated with Illumina sequencing <xref ref-type="bibr" rid="pone.0031386-Glenn1">[32]</xref>, and similarly 1.3 times more for pyrosequencing than for Sanger. The datasets were assembled and analyzed using SmashCommunity (pyrosequencing and Sanger) or a pipeline using freely available tools (i.e fastx toolkit <xref ref-type="bibr" rid="pone.0031386-Goecks1">[33]</xref>, SOAPdenovo <xref ref-type="bibr" rid="pone.0031386-Li1">[34]</xref> and parts of the SmashCommunity pipline) (Illumina).</p>
        <table-wrap id="pone-0031386-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0031386.t001</object-id><label>Table 1</label><caption>
            <title>Simulated Raw Data for each Metagenome.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0031386-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Simulated Metagenome</td>
                <td align="left" colspan="1" rowspan="1">MG1</td>
                <td align="left" colspan="1" rowspan="1">MG2</td>
                <td align="left" colspan="1" rowspan="1">MG3</td>
                <td align="left" colspan="1" rowspan="1">MG4</td>
                <td align="left" colspan="1" rowspan="1">MG5</td>
                <td align="left" colspan="1" rowspan="1">MG6</td>
                <td align="left" colspan="1" rowspan="1">MG7</td>
                <td align="left" colspan="1" rowspan="1">MG8</td>
                <td align="left" colspan="1" rowspan="1">MG9</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Sequencing technology</td>
                <td align="left" colspan="3" rowspan="1">Illumina</td>
                <td align="left" colspan="3" rowspan="1">Sanger</td>
                <td align="left" colspan="3" rowspan="1">pyrosequencing</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of genomes</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">100</td>
                <td align="left" colspan="1" rowspan="1">400</td>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">100</td>
                <td align="left" colspan="1" rowspan="1">400</td>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">100</td>
                <td align="left" colspan="1" rowspan="1">400</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of reads (Million)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">53.33</td>
                <td align="left" colspan="1" rowspan="1">53.33</td>
                <td align="left" colspan="1" rowspan="1">53.33</td>
                <td align="left" colspan="1" rowspan="1">0.25</td>
                <td align="left" colspan="1" rowspan="1">0.25</td>
                <td align="left" colspan="1" rowspan="1">0.25</td>
                <td align="left" colspan="1" rowspan="1">1.00</td>
                <td align="left" colspan="1" rowspan="1">1.00</td>
                <td align="left" colspan="1" rowspan="1">1.00</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Amount sequence (Mb)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">4000</td>
                <td align="left" colspan="1" rowspan="1">4000</td>
                <td align="left" colspan="1" rowspan="1">4000</td>
                <td align="left" colspan="1" rowspan="1">200</td>
                <td align="left" colspan="1" rowspan="1">200</td>
                <td align="left" colspan="1" rowspan="1">200</td>
                <td align="left" colspan="1" rowspan="1">255</td>
                <td align="left" colspan="1" rowspan="1">255</td>
                <td align="left" colspan="1" rowspan="1">255</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Average read length (bp)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">75</td>
                <td align="left" colspan="1" rowspan="1">75</td>
                <td align="left" colspan="1" rowspan="1">75</td>
                <td align="left" colspan="1" rowspan="1">800</td>
                <td align="left" colspan="1" rowspan="1">800</td>
                <td align="left" colspan="1" rowspan="1">800</td>
                <td align="left" colspan="1" rowspan="1">255</td>
                <td align="left" colspan="1" rowspan="1">255</td>
                <td align="left" colspan="1" rowspan="1">255</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>For each sequencing technology (Illumina, Sanger, pyrosequencing), three different metagenomes were simulated for different community complexities (10 genomes, 100 genomes, 400 genomes). The amount of sequence generated for each sequencing technology was based on the current price for each technology as well as the usual amount generated. Reads and quality values for Illumina were generated using the freely available simulator iMESSi, and reads and quality values for Sanger and pyrosequencing were generated using iMESS which is available through an easy-to-use web interface.</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s2d">
        <title>Quality Control</title>
        <p>Sanger and pyrosequencing reads were quality trimmed using lucy <xref ref-type="bibr" rid="pone.0031386-Chou1">[35]</xref> and the lucyTrim.pl script from OCTUPUS (<ext-link ext-link-type="uri" xlink:href="http://octupus.sourceforge.net" xlink:type="simple">http://octupus.sourceforge.net</ext-link>). Illumina reads were quality trimmed and filtered using the procedure described in <xref ref-type="bibr" rid="pone.0031386-Arumugam1">[11]</xref>. Specifically, the 5′-ends of the reads were trimmed so that the abundance of each base (A,C,T,G) per position was within 2 standard deviations of the average across all cycles. Then, all bases with a quality score less than 20 were trimmed off the 3′-ends. Lastly, all reads that were shorter than 35 bases or had a median quality score below 20 were removed.</p>
      </sec>
      <sec id="s2e">
        <title>Mapping of Illumina Reads to Original Genomes</title>
        <p>Trimmed and untrimmed reads were mapped to the original genomes with MOSAIK 1.1.0021 (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/marthlab/Mosaik" xlink:type="simple">http://bioinformatics.bc.edu/marthlab/Mosaik</ext-link>) using the following parameters: “-a all -m all -hs 15 -mm 2 -act 35”. This software was also used to calculate the coverage of the genomes.</p>
      </sec>
      <sec id="s2f">
        <title>Assemblies</title>
        <p>All simulated metagenomic datasets using Sanger and pyrosequencing technologies were assembled using SmashCommunity <xref ref-type="bibr" rid="pone.0031386-Arumugam2">[20]</xref>. The Sanger sequencing data was assembled using Arachne v3.1 <xref ref-type="bibr" rid="pone.0031386-Lander1">[36]</xref> with SmashCommunity standard parameters. Pyrosequencing datasets were assembled using Celera <xref ref-type="bibr" rid="pone.0031386-Miller1">[37]</xref> assembler with SmashCommunity standard parameters.</p>
        <p>The Illumina datasets were assembled using SOAPdenovo 1.05 <xref ref-type="bibr" rid="pone.0031386-Goecks1">[33]</xref> using following parameters: “-K 23 -L 70 -M 3 -u -R -F”. To assess the effect of quality filtering in metagenomic data analysis of Illumina data, we assembled the datasets with and without quality filtering, as described above.</p>
        <p>To determine which read was incorporated into which contig we used this information provided by SmashCommunity for all datasets processed with this tool. In order to get this information for the Illumina datasets we mapped the reads against the contigs using SOAPaligner 2.20 (Parameters: “-r 0 -v 2 -M 2”) <xref ref-type="bibr" rid="pone.0031386-Li2">[38]</xref>.</p>
      </sec>
      <sec id="s2g">
        <title>Measures of Chimerism</title>
        <p>Chimeric contigs are those contigs that combine reads originating from more than one genome. This definition was originally based on assemblies of Sanger reads. In contrast to assemblies of Sanger reads, in assemblies of Illumina data reads can be assigned to more than one contig as an entire read may be identical (or nearly identical) to two reference genomes. Therefore to adjust the definition of a Chimeric contig to Illumina data, contigs were only considered to be chimeric if they contained uniquely-mapping reads that originate from more than one genome. Uniquely-mapping reads are those that are only mapped to one contig, as opposed to being mapped to multiple contigs. For all chimeric contigs we calculated the degree of chimericity as described in <xref ref-type="bibr" rid="pone.0031386-Mavromatis1">[24]</xref>. Specifically, the degree of chimericity is the ratio of the number of reads that do not originate from the species which makes up most of the reads in the contig over the total number of reads in that contig.</p>
      </sec>
      <sec id="s2h">
        <title>Contig Score</title>
        <p>In order to determine how accurately contigs represent the corresponding genomes, we defined the Contig Score. To calculate this we used BLASTN to map contigs to the original genomes. We then extracted the percent identity for the best HSP as well as the percent of each contig covered by its HSP. The Contig Score was then calculated by multiplying these two values and normalized to be in a range from 0 to 100.</p>
      </sec>
      <sec id="s2i">
        <title>Functional Annotation and Analysis</title>
        <p>Functional annotation and analysis was done using SmashCommunity <xref ref-type="bibr" rid="pone.0031386-Arumugam2">[20]</xref>. Briefly, gene prediction was performed using MetaGeneMark <xref ref-type="bibr" rid="pone.0031386-Zhu1">[39]</xref>, and then the protein translations of the predicted genes were assigned to a COG (Cluster of Orthologous Group) by performing a BLASTP against the eggNOG2 database (single best hit, bit score &gt;60) <xref ref-type="bibr" rid="pone.0031386-Muller1">[40]</xref>. The abundance of each COG in each metagenome was determined using scripts in SmashCommunity. The abundances were normalized to produce probability distributions. To determine the similarity or difference between the COG abundance distributions, Principal Coordinate Analysis (PCoA) was performed using a distance metric related to Jensen-Shannon Divergence (JSD) <xref ref-type="bibr" rid="pone.0031386-Arumugam1">[11]</xref>. For a complementary ordination analysis, Principal Component Analysis (PCA) was performed using the COG abundance distribution matrix using R <xref ref-type="bibr" rid="pone.0031386-R1">[41]</xref>. In addition, the abundance of each COG, as determined from the metagenomic assembly and annotation, was plotted against the abundance of each COG as expected from the input genomes and Pearson correlation coefficients were determined.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <sec id="s3a">
        <title>Importance of Quality Control for Illumina Data</title>
        <p>Both metagenomic simulators presented here generate sequences and corresponding quality values that were modeled on actual metagenomic data. Quality values were originally developed for Sanger sequencing to estimate the accuracy of each base call <xref ref-type="bibr" rid="pone.0031386-Ewing2">[42]</xref>. Most assemblers for Sanger and pyrosequencing use quality values as part of the assembly process (e.g. Phrap (<ext-link ext-link-type="uri" xlink:href="http://www.phrap.org/" xlink:type="simple">http://www.phrap.org/</ext-link>), Arachne <xref ref-type="bibr" rid="pone.0031386-Lander1">[36]</xref>, JAZZ <xref ref-type="bibr" rid="pone.0031386-Aparicio1">[43]</xref>, Celera <xref ref-type="bibr" rid="pone.0031386-Miller1">[37]</xref>, Newbler <xref ref-type="bibr" rid="pone.0031386-Myers1">[44]</xref>). However, the most commonly used assemblers for Illumina data (SOAPdenovo <xref ref-type="bibr" rid="pone.0031386-Goecks1">[33]</xref>, Velvet <xref ref-type="bibr" rid="pone.0031386-Zerbino1">[45]</xref>, SSAKE <xref ref-type="bibr" rid="pone.0031386-Warren1">[46]</xref> do not use quality values for assembly. Thus there is no standard treatment for poor quality bases of Illumina reads. To evaluate the impact of quality-based pre-processing of reads, the 3 Illumina metagenomic datasets were assembled with and without quality control. We chose quality control which included trimming the 5′-end based on base frequency distributions, the 3′-end based on quality scores, and then removal of reads based on median quality scores and minimum length. This is more rigorous than the quality control performed with the first published Illumina metagenomic data set <xref ref-type="bibr" rid="pone.0031386-Qin1">[10]</xref>. Although 13–16% of the reads and 24–27% of the base pairs were removed by quality trimming, the accuracy of the data was greatly improved (<xref ref-type="table" rid="pone-0031386-t002">Table 2</xref>). To assess how well the reads represent the genomic sequences present in the metagenome, the reads were mapped back to the source genomes allowing for a maximum of 2 mismatches. Even though the total number of reads was lower in the trimmed dataset, the total number of reads that mapped to the original genomes doubled. The quality trimming of the reads also produced a strong improvement in the assemblies (<xref ref-type="fig" rid="pone-0031386-g001">Figure 1</xref>, <xref ref-type="table" rid="pone-0031386-t002">Table 2</xref>). Notably, for the 10 species metagenome, prior to quality trimming no contigs longer than 500 base pairs (bp) were obtained, while after trimming 13799 contigs longer than 500 bp were assembled with an average length of 2332 bp. For the 100 genomes metagenome the number of contigs longer than 500 bp increased by almost 3-fold and the N50 more than doubled. While, for the 400 genomes metagenome improvements to the assembly due to quality filtering were more modest. Increasing the number of contigs longer than 500 base pairs will strengthen the ability to predict and annotate protein-coding genes by both using homology- and neighborhood-based <xref ref-type="bibr" rid="pone.0031386-Harrington1">[47]</xref> methods. Assembly of the trimmed dataset clearly outperforms the assembly of the untrimmed dataset demonstrating that stringent quality control as performed here should be used for real metagenomic sequencing data in order to enhance results.</p>
        <fig id="pone-0031386-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0031386.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Comparison of Assemblies of Illumina Data with and without Quality Control.</title>
            <p>Contig length histograms illustrate the number of contigs within a certain size fraction for assemblies of Illumina reads with quality filtering (red) and without quality filtering (purple). Contig lengths were compared for assemblies of different community complexities (10 genomes, 100 genomes, 400 genomes). Only contigs greater than 500 bp are shown, the x-axis is log scale. There was a strong improvement in the assemblies with pre-assembly quality control of the reads.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.g001" xlink:type="simple"/>
        </fig>
        <table-wrap id="pone-0031386-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0031386.t002</object-id><label>Table 2</label><caption>
            <title>Comparison of Reads and Assemblies for Illumina Data with and without Quality Control.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0031386-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.t002" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Metagenome</td>
                <td align="left" colspan="3" rowspan="1">10 genomes</td>
                <td align="left" colspan="3" rowspan="1">100 genomes</td>
                <td align="left" colspan="3" rowspan="1">400 genomes</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">raw</td>
                <td align="left" colspan="1" rowspan="1">qualitly filtered</td>
                <td align="left" colspan="1" rowspan="1">fold change</td>
                <td align="left" colspan="1" rowspan="1">raw</td>
                <td align="left" colspan="1" rowspan="1">quality filtered</td>
                <td align="left" colspan="1" rowspan="1">fold change</td>
                <td align="left" colspan="1" rowspan="1">raw</td>
                <td align="left" colspan="1" rowspan="1">quality filtered</td>
                <td align="left" colspan="1" rowspan="1">fold change</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>raw data</bold>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Bases (Mbp)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">4000</td>
                <td align="left" colspan="1" rowspan="1">2908.95</td>
                <td align="left" colspan="1" rowspan="1">0.73</td>
                <td align="left" colspan="1" rowspan="1">4000</td>
                <td align="left" colspan="1" rowspan="1">3031.64</td>
                <td align="left" colspan="1" rowspan="1">0.76</td>
                <td align="left" colspan="1" rowspan="1">4000</td>
                <td align="left" colspan="1" rowspan="1">3031.68</td>
                <td align="left" colspan="1" rowspan="1">0.76</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Reads (Million)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">53.33</td>
                <td align="left" colspan="1" rowspan="1">44.99</td>
                <td align="left" colspan="1" rowspan="1">0.84</td>
                <td align="left" colspan="1" rowspan="1">53.33</td>
                <td align="left" colspan="1" rowspan="1">46.47</td>
                <td align="left" colspan="1" rowspan="1">0.87</td>
                <td align="left" colspan="1" rowspan="1">53.33</td>
                <td align="left" colspan="1" rowspan="1">46.47</td>
                <td align="left" colspan="1" rowspan="1">0.87</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Average Read Length</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">75.00</td>
                <td align="left" colspan="1" rowspan="1">64.66</td>
                <td align="left" colspan="1" rowspan="1">0.86</td>
                <td align="left" colspan="1" rowspan="1">75.00</td>
                <td align="left" colspan="1" rowspan="1">65.24</td>
                <td align="left" colspan="1" rowspan="1">0.87</td>
                <td align="left" colspan="1" rowspan="1">75.00</td>
                <td align="left" colspan="1" rowspan="1">65.24</td>
                <td align="left" colspan="1" rowspan="1">0.87</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>accuracy of raw data</bold>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Mapped Reads (max. 2 MM)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">23.36</td>
                <td align="left" colspan="1" rowspan="1">42.99</td>
                <td align="left" colspan="1" rowspan="1">1.84</td>
                <td align="left" colspan="1" rowspan="1">25.48</td>
                <td align="left" colspan="1" rowspan="1">44.56</td>
                <td align="left" colspan="1" rowspan="1">1.75</td>
                <td align="left" colspan="1" rowspan="1">25.48</td>
                <td align="left" colspan="1" rowspan="1">44.56</td>
                <td align="left" colspan="1" rowspan="1">1.75</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>% mapped of total</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">43.80</td>
                <td align="left" colspan="1" rowspan="1">95.55</td>
                <td align="left" colspan="1" rowspan="1">2.18</td>
                <td align="left" colspan="1" rowspan="1">47.78</td>
                <td align="left" colspan="1" rowspan="1">95.90</td>
                <td align="left" colspan="1" rowspan="1">2.01</td>
                <td align="left" colspan="1" rowspan="1">47.77</td>
                <td align="left" colspan="1" rowspan="1">95.89</td>
                <td align="left" colspan="1" rowspan="1">2.01</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>% of ref genome covered</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">100</td>
                <td align="left" colspan="1" rowspan="1">100</td>
                <td align="left" colspan="1" rowspan="1">1.00</td>
                <td align="left" colspan="1" rowspan="1">98.2</td>
                <td align="left" colspan="1" rowspan="1">98.7</td>
                <td align="left" colspan="1" rowspan="1">1.01</td>
                <td align="left" colspan="1" rowspan="1">75.3</td>
                <td align="left" colspan="1" rowspan="1">87.8</td>
                <td align="left" colspan="1" rowspan="1">1.17</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>contig lengths in assembly</bold>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of Contigs &gt;500 bp</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">13799</td>
                <td align="left" colspan="1" rowspan="1">n/a</td>
                <td align="left" colspan="1" rowspan="1">65813</td>
                <td align="left" colspan="1" rowspan="1">183528</td>
                <td align="left" colspan="1" rowspan="1">2.79</td>
                <td align="left" colspan="1" rowspan="1">10154</td>
                <td align="left" colspan="1" rowspan="1">23794</td>
                <td align="left" colspan="1" rowspan="1">2.34</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Average Contig Length</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">n/a</td>
                <td align="left" colspan="1" rowspan="1">2332</td>
                <td align="left" colspan="1" rowspan="1">n/a</td>
                <td align="left" colspan="1" rowspan="1">647</td>
                <td align="left" colspan="1" rowspan="1">1291</td>
                <td align="left" colspan="1" rowspan="1">2.00</td>
                <td align="left" colspan="1" rowspan="1">589</td>
                <td align="left" colspan="1" rowspan="1">679</td>
                <td align="left" colspan="1" rowspan="1">1.15</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>N50</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">n/a</td>
                <td align="left" colspan="1" rowspan="1">3240</td>
                <td align="left" colspan="1" rowspan="1">n/a</td>
                <td align="left" colspan="1" rowspan="1">629</td>
                <td align="left" colspan="1" rowspan="1">1496</td>
                <td align="left" colspan="1" rowspan="1">2.38</td>
                <td align="left" colspan="1" rowspan="1">567</td>
                <td align="left" colspan="1" rowspan="1">635</td>
                <td align="left" colspan="1" rowspan="1">1.12</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Longest Contig</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">354</td>
                <td align="left" colspan="1" rowspan="1">22725</td>
                <td align="left" colspan="1" rowspan="1">n/a</td>
                <td align="left" colspan="1" rowspan="1">2448</td>
                <td align="left" colspan="1" rowspan="1">43111</td>
                <td align="left" colspan="1" rowspan="1">17.61</td>
                <td align="left" colspan="1" rowspan="1">1601</td>
                <td align="left" colspan="1" rowspan="1">5854</td>
                <td align="left" colspan="1" rowspan="1">3.66</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt102">
              <label/>
              <p>The table is divided into three sections. The upper section describes the raw data before and after quality control. The second, describes the accuracy of the data as determined by mapping the reads back to the reference genomes (allowing for 2 mismatches). The last section compares the length of the contigs that result from assembly of the raw and trimmed data. N50 is defined as the length N for which 50% of all bases are represented in fragments of length L&lt;N. The degree of chimericity is the ratio of the number of reads that do not originate from the species which makes up most of the reads in the contig over the total number of reads in that contig. The Contig Score represents the percent identity between a contig and its corresponding reference genome. The percent identity between the two (from BLAST) is multiplied by the percent of each contig covered by its HSP and normalized to be in a range from 0 to 100.</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s3b">
        <title>Comparison of Assemblies from Different Sequencing Methods</title>
        <p>We used different assembly programs for reads generated by each sequencing technology in order to account for the differences between them. Therefore, the following is a comparison between assemblies produced from different sequencing methods, along with a chosen pipeline of assembly software with specified parameters. We used parameters which are optimized for metagenomic assembly as well as for each technology and that were used in previous studies <xref ref-type="bibr" rid="pone.0031386-Arumugam1">[11]</xref> <xref ref-type="bibr" rid="pone.0031386-Qin1">[10]</xref>.</p>
        <p>A comparison of the assemblies shows that contig size length distributions differ depending on the community complexity and the sequencing technology (<xref ref-type="fig" rid="pone-0031386-g002">Figure 2</xref>, <xref ref-type="table" rid="pone-0031386-t003">Table 3</xref>). For simple communities (10 genomes) all sequencing platforms produced a similar total sum of contig lengths, but differed in the distribution of contig lengths. Although pyrosequencing had the longest N50 (N50 is defined as the length N for which 50% of all bases are represented in fragments of length L&lt;N) <xref ref-type="bibr" rid="pone.0031386-Miller2">[48]</xref>, Sanger sequencing produced the largest number of contigs greater than 500 bp. For more complex communities (100 genomes), Illumina reads resulted in by far the best assembly with 8 times the number of contigs assembled than as for the Sanger sequences (the next best), the largest proportion of long contigs, and over 6 times more genes with functional annotations. For the most complex community (400 genomes) there was very little assembly using any technology. Although there was no assembly of Sanger reads into contigs, the Sanger reads still represent the best ‘assembly’ with 10 times more fragments over 500 bp, than the Illumina assembly and over 10 times more genes with functional annotation. These differences can be attributed to the differences in read length and especially sequencing depth, but both parameters are intrinsic to the different sequencing technologies., as the cost of the sequencing technology is directly related to the sequencing depth. All of the sequencing technologies perform comparably when the coverage per organism is relatively high as in the 10 genomes metagenome. But for the more complex communities (100 genomes) Illumina performs better due to the greater sequencing depth achieved. However, for the metagenomes with 400 genomes even the sequencing depth achieved with Illumina does not make up for the lower coverage of each genome and Sanger performs well due to the long read lengths.</p>
        <fig id="pone-0031386-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0031386.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Comparison of assemblies from different sequencing technologies.</title>
            <p>a) <bold>Contig Length Distribution.</bold> Histograms of the contig lengths illustrate the number of contigs within a certain size fraction for assemblies of Illumina reads with quality filtering (red), Sanger sequenced reads (yellow) and reads from pyrosequencing (blue). Only contigs greater than 500 bp are shown, the x-axis is log scale. Assemblies were generated for different community complexities (10 genomes, 100 genomes, 400 genomes). b) <bold>Overall Accuracy of the Contigs.</bold> The overall accuracy of the contigs is summarized using different measures of chimericity. Bars to the left illustrate the percentage of all of the contigs that are chimeric, bars in the middle show the percentage of all of the contigs that have a Contig Score less than 95%, and to the right contigs that have a Contig Score less than 99%. Contig Score represents the percent identity between the contig and the derived reference genome. Contigs from Illumina reads are red, contigs from Sanger reads are yellow and contigs from pyrosequencing are blue. In general there was a slightly higher proportion of Illumina contigs that were chimeric, however they had higher contig scores. c) <bold>Contig Accuracy across Contig Lengths.</bold> These combined strip plots show the degree of chimericity (upper plot) and contig score (lower plot) for each contig in the assemblies, each dot represents one contig. They are grouped into size bins. The degree of chimericity is the proportion of reads in a contig that are derived from the ‘wrong’ genome and thus make the contig chimeric. Contig Score represents the percent identity between the contig and the derived reference genome. Again contigs from Illumina assemblies are in red, from Sanger assemblies are in yellow and from pyrosequencing assemblies are in blue. For all sequencing technologies and communities, longer contigs are more accurate.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.g002" xlink:type="simple"/>
        </fig>
        <table-wrap id="pone-0031386-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0031386.t003</object-id><label>Table 3</label><caption>
            <title>Comparison of Assemblies from Reads of Different Sequencing Technologies.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0031386-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.t003" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Number of Genomes</td>
                <td align="left" colspan="3" rowspan="1">10</td>
                <td align="left" colspan="3" rowspan="1">100</td>
                <td align="left" colspan="3" rowspan="1">400</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Sequencing</td>
                <td align="left" colspan="1" rowspan="1">Illumina</td>
                <td align="left" colspan="1" rowspan="1">Sanger</td>
                <td align="left" colspan="1" rowspan="1">pyro</td>
                <td align="left" colspan="1" rowspan="1">Illumina</td>
                <td align="left" colspan="1" rowspan="1">Sanger</td>
                <td align="left" colspan="1" rowspan="1">pyro</td>
                <td align="left" colspan="1" rowspan="1">Illumina</td>
                <td align="left" colspan="1" rowspan="1">Sanger</td>
                <td align="left" colspan="1" rowspan="1">pyro</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>contig lengths</bold>
                  <xref ref-type="table-fn" rid="nt103">1</xref>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of Contigs &gt;500 bp</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">13799</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>15368</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">6046</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>183528</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">21977</td>
                <td align="left" colspan="1" rowspan="1">14035</td>
                <td align="left" colspan="1" rowspan="1">23634</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>249989</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">1151</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Sum of Contig Lengths (Mbp)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>32.18</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>34.88</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>33.26</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>236.91</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">28.33</td>
                <td align="left" colspan="1" rowspan="1">11.71</td>
                <td align="left" colspan="1" rowspan="1">16.05</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>167.89</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.81</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>N50 (bp)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">3240</td>
                <td align="left" colspan="1" rowspan="1">2693</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>9198</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>1496</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">1221</td>
                <td align="left" colspan="1" rowspan="1">809</td>
                <td align="left" colspan="1" rowspan="1">636</td>
                <td align="left" colspan="1" rowspan="1">671</td>
                <td align="left" colspan="1" rowspan="1">640</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Longest Contig (kb)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">22.73</td>
                <td align="left" colspan="1" rowspan="1">13.70</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>119.83</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>43.11</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">4.83</td>
                <td align="left" colspan="1" rowspan="1">7.26</td>
                <td align="left" colspan="1" rowspan="1">5.85</td>
                <td align="left" colspan="1" rowspan="1">0.77</td>
                <td align="left" colspan="1" rowspan="1">2.81</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>contig accuracy</bold>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>% of contigs that are chimeric</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">4.98</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.01</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.36</td>
                <td align="left" colspan="1" rowspan="1">9.79</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>2.98</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">27.10</td>
                <td align="left" colspan="1" rowspan="1">37.08</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0</bold>
                  <xref ref-type="table-fn" rid="nt104">2</xref>
                </td>
                <td align="left" colspan="1" rowspan="1">47.15</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Average degree of chimericity (%)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">1.56</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>38.04</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">15.28</td>
                <td align="left" colspan="1" rowspan="1">18.25</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>44.56</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">35.67</td>
                <td align="left" colspan="1" rowspan="1">41.50</td>
                <td align="left" colspan="1" rowspan="1">0<xref ref-type="table-fn" rid="nt104">2</xref></td>
                <td align="left" colspan="1" rowspan="1">47.89</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>% of contigs with ContigScore &lt;95</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>0.03</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.24</td>
                <td align="left" colspan="1" rowspan="1">1.62</td>
                <td align="left" colspan="1" rowspan="1">0.11</td>
                <td align="left" colspan="1" rowspan="1">0.84</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>5.50</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">4.51</td>
                <td align="left" colspan="1" rowspan="1">0.38</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>26.80</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>functional annotation</bold>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of genes</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">40173</td>
                <td align="left" colspan="1" rowspan="1">52550</td>
                <td align="left" colspan="1" rowspan="1">40201</td>
                <td align="left" colspan="1" rowspan="1">359969</td>
                <td align="left" colspan="1" rowspan="1">61839</td>
                <td align="left" colspan="1" rowspan="1">26369</td>
                <td align="left" colspan="1" rowspan="1">33449</td>
                <td align="left" colspan="1" rowspan="1">413779</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>1587</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of complete genes</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">21276</td>
                <td align="left" colspan="1" rowspan="1">28841</td>
                <td align="left" colspan="1" rowspan="1">31628</td>
                <td align="left" colspan="1" rowspan="1">106024</td>
                <td align="left" colspan="1" rowspan="1">30899</td>
                <td align="left" colspan="1" rowspan="1">9228</td>
                <td align="left" colspan="1" rowspan="1">3267</td>
                <td align="left" colspan="1" rowspan="1">102121</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>542</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of genes with OG annotation</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">35713</td>
                <td align="left" colspan="1" rowspan="1">42878</td>
                <td align="left" colspan="1" rowspan="1">35399</td>
                <td align="left" colspan="1" rowspan="1">305217</td>
                <td align="left" colspan="1" rowspan="1">48922</td>
                <td align="left" colspan="1" rowspan="1">20992</td>
                <td align="left" colspan="1" rowspan="1">27118</td>
                <td align="left" colspan="1" rowspan="1">293047</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>1002</bold>
                </td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt103">
              <label>1</label>
              <p>- for Sanger reads there were no contigs assembled from combining more than one read, therefore the term contigs represents Sanger reads that were longer than 500 bp.</p>
            </fn>
            <fn id="nt104">
              <label>2</label>
              <p>– as there were no contigs assembled from more than one read, then there cannot be any ‘chimeric’ contigs.</p>
            </fn>
            <fn id="nt105">
              <label/>
              <p>This table compares assembly statistics for assemblies of reads from quality-trimmed Illumina reads, Sanger reads, and pyrosequencing reads (quality trimming was performed by assembly software). The upper portion of the table compares different statistics related to contig lengths, and the lower portion compares statistics related to the accuracy of the contigs. N50 is defined as the length N for which 50% of all bases are represented in fragments of length L&lt;N. The degree of chimericity is the ratio of the number of reads that do not originate from the species which makes up most of the reads in the contig over the total number of reads in that contig. The Contig Score represents the percent identity between a contig and its corresponding reference genome. The percent identity between the two (from BLAST) is multiplied by the percent of each contig covered by its HSP and normalized to be in a range from 0 to 100.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>The definition of a chimeric contig arose from analysis of Sanger assemblies and describes a contig that combines reads originating from more than one genome <xref ref-type="bibr" rid="pone.0031386-Mavromatis1">[24]</xref>. In this case, reads that originate from two different genomes may be combined into one contig based on a short region of homology between the two, while the majority of the contig would match one of the reference genomes better than the other. However for Illumina reads the definition of a chimeric contig is not as clear. As Illumina reads are so short, an entire read may be identical (or nearly) to two reference genomes. In addition, most Illumina assembly software allows reads to be assigned to more than one contig. Thus, for Illumina data we defined a contig as chimeric if it contains uniquely-mapped reads that originate from more than one genome; where uniquely mapped reads are those that are only mapped to one contig, as opposed to being mapped to multiple contigs. Moreover, in order to assess the accuracy of a contig without using the concept of chimericity, which may not be so informative for Illumina data, we defined the term ‘contig score’ to represent the sequence identity between a contig and its corresponding genome. The contig score can vary between 0 and 100, with 100 being the best value.</p>
        <p>The percentage of chimeric contigs was lowest in Sanger sequencing, while pyrosequencing and Illumina had a much higher percentage of chimeric contigs (<xref ref-type="table" rid="pone-0031386-t002">Table 2</xref>, <xref ref-type="fig" rid="pone-0031386-g002">Figure 2</xref>). However, the degree of chimericity (percentage of reads from “wrong” genomes <xref ref-type="bibr" rid="pone.0031386-Mavromatis1">[24]</xref>) was on average higher for Sanger sequencing than the other sequencing technologies, with the effect being more pronounced in the least complex community, and almost negligible in the most complex community. The degree of chimericity was clearly dependent on the contig length for all sequencing methods, with shorter contigs having a much higher degree of chimericity. The percentage of chimeric contigs and the degree of chimericity both increase with increasing community complexity. This shows that some contig accuracy characteristics known from Sanger sequencing <xref ref-type="bibr" rid="pone.0031386-Mavromatis1">[24]</xref> also hold true for next generation sequencing methods.</p>
        <p>By comparing the contig scores to the chimericity analysis, it is clear that chimeric contigs can still resemble the original genomes (<xref ref-type="fig" rid="pone-0031386-g002">Figure 2</xref>, Panel B). This is especially true for Illumina contigs that had overall better contig scores than other sequencing method for all community complexities. Conversely, pyrosequencing produced assemblies with the lowest contig scores. In agreement with the relationship between contig length and chimericity, we also found a proportional relationship between contig length and the contig score in most cases, delivering additional evidence that longer contigs are indeed more reliable. However, for the 10 genome community the trend was not as clear for the contigs from pyrosequencing, and a number of long contigs had a low contig score.</p>
      </sec>
      <sec id="s3c">
        <title>The use of Scaffolds and Scaftigs in Illumina Assemblies</title>
        <p>The assembly of reads into contigs usually does not lead to completely assembled genomes, hence scaffolding is used to combine contigs and place them within context of their genomic location <xref ref-type="bibr" rid="pone.0031386-Pop1">[49]</xref>. Scaffolds are constructed by linking contigs using information from paired end reads. During this process a number of unknown bases, or gaps, are usually found between the sequences of the linked contigs. Some scaffolding tools try to fill this gapped-region with unused reads. Unknown bases that remain between the contigs in the scaffold will be represented by Ns. To use the information obtained by scaffolding, scaftigs can be constructed by extracting the contiguous sequences that lack unknown bases (Ns). Scaffolding is especially useful when assembling short reads generated using next generation sequencing technologies since repeats are harder to resolve in this case. The main advantage of scaftigs over contigs is an increase in fragment lengths and scaftigs have been proven to be useful in metagenomic data analysis <xref ref-type="bibr" rid="pone.0031386-Qin1">[10]</xref>.</p>
        <p>We used simulated Illumina data to survey the effect of scaffolding on assemblies of different communities. Fragment lengths increase with scaffolding. This is most pronounced in the low complexity metagenomes (10 genomes) where the N50 increases 10-fold from 3240 to 35893, while there is hardly a difference in the high complexity (400 genomes) dataset (N50 improves from 631 to 690) (<xref ref-type="table" rid="pone-0031386-t004">Table 4</xref>, <xref ref-type="fig" rid="pone-0031386-g003">Figure 3</xref>). Although the use of scaffolds increases contig lengths, a larger proportion of scaftigs were chimeric than contigs in simulations of all community complexities. The degree of chimercity was also higher in scaftigs than in contigs for all length bins (<xref ref-type="fig" rid="pone-0031386-g003">Figure 3</xref>). While the effect of scaffolding seems to be detrimental when looking at chimericity, the effect is small when comparing the actual sequence of scaftigs and contigs to the original genomes. The percentage of sequences having a contig score below 95 slightly increases for all 3 community complexities; however, the median contig score was very similar for scaftigs and contigs (<xref ref-type="table" rid="pone-0031386-t004">Table 4</xref>). In conclusion, scaffolding of Illumina data represents a tradeoff between increased fragment lengths and accuracy, and therefore might be more useful when mapping fragments for function assignment purposes but less so when sequence identify is used to quantify the distance to reference genomes.</p>
        <fig id="pone-0031386-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0031386.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Comparison of assemblies of Illumina contigs and Illumina scaftigs.</title>
            <p>Scaffolds are constructed by linking contigs using information from paired end reads, during this process a number of unknown bases are usually found between the sequences of the linked contigs. To use the information obtained by scaffolding, Scaftigs can be constructed by extracting the contiguous sequences that lack unknown bases (Ns). a) <bold>Contig Length Distribution.</bold> Histograms of the contig lengths illustrate the number of contigs within a certain size fraction for assemblies of Illumina contigs (red) and Illumina scaftigs (light blue). Only contigs greater than 500 bp are shown, the x-axis is log scale. Assemblies were generated for different community complexities (10 genomes, 100 genomes, 400 genomes). b) <bold>Overall Accuracy of the Contigs.</bold> The overall accuracy of the contigs is summarized using different measures of chimericity. Bars to the left illustrate the percentage of all of the contigs that are chimeric, bars in the middle show the percentage of all of the contigs that have a Contig Score less than 95%, and to the right contigs that have a Contig Score less than 99%. Contig Score represents the percent identity between the contig and the derived reference genome. Illumina contigs are in red Illumina scaftigs are blue. c) <bold>Contig Accuracy across Contig Lengths.</bold> These combined strip plots show the degree of chimericity (upper plot) and contig score (lower plot) for each contig in the assemblies, each dot represents one contig. They are grouped into size bins. The degree of chimericity is the proportion of reads in a contig that are derived from the ‘wrong’ genome and thus make the contig chimeric. Contig Score represents the percent identity between the contig and the derived reference genome. Again Illumina contigs are in red and Illumina scaftigs are in blue.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.g003" xlink:type="simple"/>
        </fig>
        <table-wrap id="pone-0031386-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0031386.t004</object-id><label>Table 4</label><caption>
            <title>Comparisons of Illumina Assemblies of Contigs and Scaftigs.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0031386-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.t004" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Number of Genomes</td>
                <td align="left" colspan="3" rowspan="1">10</td>
                <td align="left" colspan="3" rowspan="1">100</td>
                <td align="left" colspan="3" rowspan="1">400</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Sequencing</td>
                <td align="left" colspan="1" rowspan="1">Illumina contigs</td>
                <td align="left" colspan="1" rowspan="1">Illumina scaftigs</td>
                <td align="left" colspan="1" rowspan="1">fold change</td>
                <td align="left" colspan="1" rowspan="1">Illumina contigs</td>
                <td align="left" colspan="1" rowspan="1">Illumina scaftigs</td>
                <td align="left" colspan="1" rowspan="1">fold change</td>
                <td align="left" colspan="1" rowspan="1">Illumina contigs</td>
                <td align="left" colspan="1" rowspan="1">Illumina scaftigs</td>
                <td align="left" colspan="1" rowspan="1">fold change</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>contig lengths</bold>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of Contigs &gt;500 bp</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">13799</td>
                <td align="left" colspan="1" rowspan="1">1900</td>
                <td align="left" colspan="1" rowspan="1">0.14</td>
                <td align="left" colspan="1" rowspan="1">183528</td>
                <td align="left" colspan="1" rowspan="1">152230</td>
                <td align="left" colspan="1" rowspan="1">0.83</td>
                <td align="left" colspan="1" rowspan="1">23634</td>
                <td align="left" colspan="1" rowspan="1">32496</td>
                <td align="left" colspan="1" rowspan="1">1.37</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Sum of Contig Length (Mbp)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">32.18</td>
                <td align="left" colspan="1" rowspan="1">33.34</td>
                <td align="left" colspan="1" rowspan="1">1.04</td>
                <td align="left" colspan="1" rowspan="1">236.91</td>
                <td align="left" colspan="1" rowspan="1">33.34</td>
                <td align="left" colspan="1" rowspan="1">0.14</td>
                <td align="left" colspan="1" rowspan="1">16.05</td>
                <td align="left" colspan="1" rowspan="1">24.19</td>
                <td align="left" colspan="1" rowspan="1">1.51</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>N50 (bp)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>3240</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>35893</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>11.08</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">1496</td>
                <td align="left" colspan="1" rowspan="1">2200</td>
                <td align="left" colspan="1" rowspan="1">1.47</td>
                <td align="left" colspan="1" rowspan="1">636</td>
                <td align="left" colspan="1" rowspan="1">690</td>
                <td align="left" colspan="1" rowspan="1">1.08</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Longest Contig (kb)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>22.73</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>195.65</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>8.61</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>43.11</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>573.10</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>13.29</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>5.85</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>11.70</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>2.00</bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>contig accuracy</bold>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>% of contigs that are chimeric</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>4.98</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>27.74</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>5.57</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">9.79</td>
                <td align="left" colspan="1" rowspan="1">16.82</td>
                <td align="left" colspan="1" rowspan="1">1.72</td>
                <td align="left" colspan="1" rowspan="1">37.08</td>
                <td align="left" colspan="1" rowspan="1">41.50</td>
                <td align="left" colspan="1" rowspan="1">1.12</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Average degree of chimericity (%)</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">1.56</td>
                <td align="left" colspan="1" rowspan="1">1.21</td>
                <td align="left" colspan="1" rowspan="1">0.78</td>
                <td align="left" colspan="1" rowspan="1">18.25</td>
                <td align="left" colspan="1" rowspan="1">19.03</td>
                <td align="left" colspan="1" rowspan="1">1.04</td>
                <td align="left" colspan="1" rowspan="1">41.50</td>
                <td align="left" colspan="1" rowspan="1">42.96</td>
                <td align="left" colspan="1" rowspan="1">1.04</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>% of contigs with ContigScore &lt;95</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">0.03</td>
                <td align="left" colspan="1" rowspan="1">2.05</td>
                <td align="left" colspan="1" rowspan="1">70.81</td>
                <td align="left" colspan="1" rowspan="1">0.11</td>
                <td align="left" colspan="1" rowspan="1">0.42</td>
                <td align="left" colspan="1" rowspan="1">3.82</td>
                <td align="left" colspan="1" rowspan="1">4.51</td>
                <td align="left" colspan="1" rowspan="1">5.03</td>
                <td align="left" colspan="1" rowspan="1">1.11</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>functional annotation</bold>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of predicted genes</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">40173</td>
                <td align="left" colspan="1" rowspan="1">32834</td>
                <td align="left" colspan="1" rowspan="1">0.82</td>
                <td align="left" colspan="1" rowspan="1">359969</td>
                <td align="left" colspan="1" rowspan="1">358473</td>
                <td align="left" colspan="1" rowspan="1">1.00</td>
                <td align="left" colspan="1" rowspan="1">33449</td>
                <td align="left" colspan="1" rowspan="1">47667</td>
                <td align="left" colspan="1" rowspan="1">1.43</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of complete genes</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">21276</td>
                <td align="left" colspan="1" rowspan="1">30690</td>
                <td align="left" colspan="1" rowspan="1">1.44</td>
                <td align="left" colspan="1" rowspan="1">106024</td>
                <td align="left" colspan="1" rowspan="1">144364</td>
                <td align="left" colspan="1" rowspan="1">1.36</td>
                <td align="left" colspan="1" rowspan="1">3267</td>
                <td align="left" colspan="1" rowspan="1">6000</td>
                <td align="left" colspan="1" rowspan="1">1.84</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>Number of genes with OG annotation</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">35713</td>
                <td align="left" colspan="1" rowspan="1">29827</td>
                <td align="left" colspan="1" rowspan="1">0.84</td>
                <td align="left" colspan="1" rowspan="1">305217</td>
                <td align="left" colspan="1" rowspan="1">305823</td>
                <td align="left" colspan="1" rowspan="1">1.00</td>
                <td align="left" colspan="1" rowspan="1">27118</td>
                <td align="left" colspan="1" rowspan="1">39235</td>
                <td align="left" colspan="1" rowspan="1">1.45</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt106">
              <label/>
              <p>This table compares assembly statistics for assemblies of Illumina data that result in contigs and those for which scaftigs were created. N50 is defined as the length N for which 50% of all bases are represented in fragments of length L&lt;N. The degree of chimericity is the ratio of the number of reads that do not originate from the species which makes up most of the reads in the contig over the total number of reads in that contig. The Contig Score represents the percent identity between a contig and its corresponding reference genome. The percent identity between the two (from BLAST) is multiplied by the percent of each contig covered by its HSP and normalized to be in a range from 0 to 100.</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s3d">
        <title>Functional Composition of Simulated Metagenomes</title>
        <p>To determine if better assembly parameters such as longer contigs result in assemblies that more accurately represent the functional composition of the community, we compared the functional content of the metagenomes to the functional repertoire expected from the input genomes. For the 10 and 100 genome metagenomes, where the genomes had higher coverage, the actual COG abundances determined from the assemblies correlated well with the expected COG abundances (<xref ref-type="fig" rid="pone-0031386-g004">Figure 4A</xref>). For the more complex communities (100 and 400 genomes) the Illumina scaftigs had slightly better correlations than the Illumina contigs. This indicates that the positive impact of increased fragment length outweighs the minor increases in the number of assembly errors. In addition we performed principal component analysis and principal coordinate analysis of JSD distances to determine how the use of different technologies might affect functional ordination analyses. Both ordination analyses showed that for all sequencing technologies the low complexity metagenomes (10 genomes) were similar in functional content to each other as well as to the expected (<xref ref-type="fig" rid="pone-0031386-g004">Figure 4B</xref>). For the medium complexity metagenomes (100 genomes), the Illumina reads produced assemblies that were very similar to expected, with the Sanger assembly also being close and the pyrosequencing assembly being the most different from expected. For the high complexity community (400 genomes) the Illumina and pyrosequencing metagenomes appear to be quite divergent from the expected functional content. And the Sanger reads provided the best representation of the functional content with the Sanger assembly appearing relatively similar to expected in the PCoA. One of the main reasons that pyrosequencing could not accurately represent the overall functional composition was the lower number of genes that were annotated (<xref ref-type="table" rid="pone-0031386-t003">Table 3</xref>). In addition, for all metagenomes the Illumina contigs and Illumina scaftigs had very similar functional compositions. Overall, the functional analysis shows that better assemblies (eg. more complete genes) do actually result in better functional characterization of a metagenome.</p>
        <fig id="pone-0031386-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0031386.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Comparison of the functional repertoire of the metagenomes to each other and to the expected.</title>
            <p>a) <bold>Correlations between expected and actual COG abundance.</bold> Dotplots compare the expected and actual abundance for each COG, with the x-axis displaying the COG abundances as expected from the input genomes and the y-axis displaying the COG abundances as determined from assembly and annotation of the simulated metagenomes. The black line shows the 1∶1 correlation. The Pearson correlation coefficients are displayed for each dataset. b) <bold>Principal Coordinate Analysis (PCoA) and Principal Component Analysis (PCA).</bold> The COG abundance profiles were compared to each other using Jensen-Shannon divergence and the distance matrix was then analyzed plotted using PCoA. The COG abundance profiles were analyzed plotted using PCA. The dots are colored by sequencing method: Illumina contigs (red), Illumina scaftigs (light blue), Sanger (yellow) and pyrosequencing (blue).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.g004" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>The first step in any metagenomic data analysis should be raw data treatment. This includes quality control and removal of contamination (eg. human contamination in metagenomic studies of the human gut). Tools for NGS quality control like the FASTX toolkit <xref ref-type="bibr" rid="pone.0031386-Goecks1">[33]</xref>, SolexaQA <xref ref-type="bibr" rid="pone.0031386-Cox1">[50]</xref> or PrinSeq <xref ref-type="bibr" rid="pone.0031386-Schmieder1">[51]</xref> are readily available. However, there is currently no standard protocol for how the quality values should be used in read pre-processing. Our results show the importance of good quality control as the Illumina assemblies greatly improved after rigorous quality filtering and trimming.</p>
      <p>After this initial step there are a number of analyses that one can perform, but to decrease the complexity of the data, the quality controlled reads are usually assembled into contigs. Our comparison of assemblies from different sequencing technologies reveals that each assembly has different characteristics depending on community composition and sequencing technology. The different sequencing technologies performed similarly for the low complexity community. For the more complex community (100 genomes), the Illumina sequences assembled a much greater length of contigs resulting in more complete genes. This is due to the greater sequencing depth achieved as the price per base is much less for Illumina sequencing than pyrosequencing or Sanger. For the most complex community none of the sequencing technologies assembled many reads into contigs. However, due to their length the Sanger reads still had many sequences greater than 500 bp. Earlier metagenomic simulation studies focused on the chimericity of contigs concluding that currently used assemblers need to improve to be useful for metagenomics <xref ref-type="bibr" rid="pone.0031386-Mavromatis1">[24]</xref>. However, this term that originated from Sanger sequencing may not be as applicable to IIlumina data. This is because Illumina reads are so short and may actually represent regions that are identical between two organisms, and because assembly of Illumina reads often results in reads being assigned to more than one contigs. We therefore need to asses new ways to determine the accuracy of Illumina assemblies. Accordingly, we defined the term ‘Contig Score’ to quantify the divergence of the contigs from the original genomes. Our results show that for all sequencing technologies and community complexities the vast majority of the contigs diverge by less than 5% from the original genomes. The Illumina dataset excelled using this measure showing the usefulness of Illumina sequencing data in metagenomics. The reliability of most contigs is reflected by the fact that the functional repertoire of the low and medium complexity metagenomes accurately represents the expected functional repertoire. This is also because the amount of sequence produced allowed for all of the sequencing technologies to provide enough coverage of each genome. For the most complex community, where there was low coverage of each genome, assemblies from Illumina and pyrosequencing failed to represent the expected functional composition of the metagenomes, as there were very few complete genes annotated. However, the Sanger reads approximated the expected functional composition reasonably well as the length of the reads allowed for accurate functional annotation. For the pyrosequencing simulations 250 bp was used as the average read length. Currently, the GS FLX Titanium system can deliver reads as long as 400 bp, this would probably improve the assemblies. The ability of all NGS sequencing technologies to fully capture the functional repertoire of complex communities will also improve as technology developments might lower prices allowing for deeper sequencing.</p>
      <p>By using paired end information available in most NGS technologies, the fragment length of an assembly can be increased by gap-filling and scaffolding of contigs. Our results show that scaffolding is a good way to increase fragment lengths. And although scaffolding increased chimeras and decreased the Contig Score, the functional profiles of the metagenomes derived from contigs and those derived from scaftigs were virtually indistinguishable, with the COG abundance profiles of the scaftig-metagenomes correlating slightly better with the expected.</p>
      <p>Currently, Illumina sequencing technology can produce the greatest yield at the lowest price <xref ref-type="bibr" rid="pone.0031386-Glenn1">[32]</xref>, but as of now has not been extensively used for metagenomics. Our study of simulated metagenomes shows that Illumina data can be used to obtain assemblies that, for the low and medium complexity metagenomes in this study, are superior to those from pyrosequencing and Sanger sequencing, provided a rigorous quality control of reads prior to assembly. However, the assembly performance is coupled to the underlying community structure, and thus simulations will aid in choosing the optimal sequencing technology for a microbiome of interest. In addition, the results are highly dependent on the sequencing depth and read lengths which are increasing for next-generation sequencing technologies, thus it is likely that they may perform even better for more complex metagenomes in the future.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pone.0031386.s001" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.s001" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p>
            <bold>Genomes Used in the Low Complexity Metagenome and Estimated Coverage (10 genomes).</bold>
          </p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0031386.s002" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.s002" xlink:type="simple">
        <label>Table S2</label>
        <caption>
          <p>
            <bold>Genomes Used in the Medium Complexity Metagenome and Estimated Coverage (100 genomes).</bold>
          </p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0031386.s003" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pone.0031386.s003" xlink:type="simple">
        <label>Table S3</label>
        <caption>
          <p>
            <bold>Genomes Used in the High Complexity Metagenome and Estimated Coverage (400 genomes).</bold>
          </p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank Y. Yuan and the EMBL IT core facility for managing the high-performance computing resources. We are also grateful to all members of the Bork group for discussions and assistance.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pone.0031386-Handelsman1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Handelsman</surname><given-names>J</given-names></name><name name-style="western"><surname>Rondon</surname><given-names>MR</given-names></name><name name-style="western"><surname>Brady</surname><given-names>SF</given-names></name><name name-style="western"><surname>Clardy</surname><given-names>J</given-names></name><name name-style="western"><surname>Goodman</surname><given-names>RM</given-names></name></person-group>             <year>1998</year>             <article-title>Molecular biological access to the chemistry of unknown soil microbes: a new frontier for natural products.</article-title>             <source>Chemistry &amp; Biology</source>             <volume>5</volume>             <fpage>R245</fpage>             <lpage>R249</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Venter1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Venter</surname><given-names>JC</given-names></name><name name-style="western"><surname>Remington</surname><given-names>K</given-names></name><name name-style="western"><surname>Heidelberg</surname><given-names>JF</given-names></name><name name-style="western"><surname>Halpern</surname><given-names>AL</given-names></name><name name-style="western"><surname>Rusch</surname><given-names>D</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Environmental genome shotgun sequencing of the Sargasso Sea.</article-title>             <source>Science (New York, NY)</source>             <volume>304</volume>             <fpage>66</fpage>             <lpage>74</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Angly1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Angly</surname><given-names>FE</given-names></name><name name-style="western"><surname>Felts</surname><given-names>B</given-names></name><name name-style="western"><surname>Breitbart</surname><given-names>M</given-names></name><name name-style="western"><surname>Salamon</surname><given-names>P</given-names></name><name name-style="western"><surname>Edwards</surname><given-names>RA</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>The marine viromes of four oceanic regions.</article-title>             <source>PLoS biology</source>             <volume>4</volume>             <fpage>e368</fpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Abulencia1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Abulencia</surname><given-names>CB</given-names></name><name name-style="western"><surname>Wyborski</surname><given-names>DL</given-names></name><name name-style="western"><surname>Garcia</surname><given-names>JA</given-names></name><name name-style="western"><surname>Podar</surname><given-names>M</given-names></name><name name-style="western"><surname>Chen</surname><given-names>W</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Environmental whole-genome amplification to access microbial populations in contaminated sediments.</article-title>             <source>Applied and environmental microbiology</source>             <volume>72</volume>             <fpage>3291</fpage>             <lpage>3301</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Tringe1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tringe</surname><given-names>SG</given-names></name><name name-style="western"><surname>von Mering</surname><given-names>C</given-names></name><name name-style="western"><surname>Kobayashi</surname><given-names>A</given-names></name><name name-style="western"><surname>Salamov</surname><given-names>AA</given-names></name><name name-style="western"><surname>Chen</surname><given-names>K</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Comparative metagenomics of microbial communities.</article-title>             <source>Science (New York, NY)</source>             <volume>308</volume>             <fpage>554</fpage>             <lpage>557</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Schoenfeld1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schoenfeld</surname><given-names>T</given-names></name><name name-style="western"><surname>Patterson</surname><given-names>M</given-names></name><name name-style="western"><surname>Richardson</surname><given-names>PM</given-names></name><name name-style="western"><surname>Wommack</surname><given-names>KE</given-names></name><name name-style="western"><surname>Young</surname><given-names>M</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Assembly of viral metagenomes from yellowstone hot springs.</article-title>             <source>Applied and environmental microbiology</source>             <volume>74</volume>             <fpage>4164</fpage>             <lpage>4174</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Tyson1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tyson</surname><given-names>GW</given-names></name><name name-style="western"><surname>Chapman</surname><given-names>J</given-names></name><name name-style="western"><surname>Hugenholtz</surname><given-names>P</given-names></name><name name-style="western"><surname>Allen</surname><given-names>EE</given-names></name><name name-style="western"><surname>Ram</surname><given-names>RJ</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Community structure and metabolism through reconstruction of microbial genomes from the environment.</article-title>             <source>Nature</source>             <volume>428</volume>             <fpage>37</fpage>             <lpage>43</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Chivian1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chivian</surname><given-names>D</given-names></name><name name-style="western"><surname>Brodie</surname><given-names>EL</given-names></name><name name-style="western"><surname>Alm</surname><given-names>EJ</given-names></name><name name-style="western"><surname>Culley</surname><given-names>DE</given-names></name><name name-style="western"><surname>Dehal</surname><given-names>PS</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Environmental genomics reveals a single-species ecosystem deep within Earth.</article-title>             <source>Science (New York, NY)</source>             <volume>322</volume>             <fpage>275</fpage>             <lpage>278</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Gill1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gill</surname><given-names>SR</given-names></name><name name-style="western"><surname>Pop</surname><given-names>M</given-names></name><name name-style="western"><surname>Deboy</surname><given-names>RT</given-names></name><name name-style="western"><surname>Eckburg</surname><given-names>PB</given-names></name><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Metagenomic analysis of the human distal gut microbiome.</article-title>             <source>Science (New York, NY)</source>             <volume>312</volume>             <fpage>1355</fpage>             <lpage>1359</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Qin1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Qin</surname><given-names>J</given-names></name><name name-style="western"><surname>Li</surname><given-names>R</given-names></name><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Arumugam</surname><given-names>M</given-names></name><name name-style="western"><surname>Burgdorf</surname><given-names>KS</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>A human gut microbial gene catalogue established by metagenomic sequencing.</article-title>             <source>Nature</source>             <volume>464</volume>             <fpage>59</fpage>             <lpage>65</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Arumugam1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Arumugam</surname><given-names>M</given-names></name><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Pelletier</surname><given-names>E</given-names></name><name name-style="western"><surname>Le Paslier</surname><given-names>D</given-names></name><name name-style="western"><surname>Yamada</surname><given-names>T</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Enterotypes of the human gut microbiome.</article-title>             <source>Nature</source>             <volume>473</volume>             <fpage>174</fpage>             <lpage>180</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Peterson1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Peterson</surname><given-names>J</given-names></name><name name-style="western"><surname>Garges</surname><given-names>S</given-names></name><name name-style="western"><surname>Giovanni</surname><given-names>M</given-names></name><name name-style="western"><surname>McInnes</surname><given-names>P</given-names></name><name name-style="western"><surname>Wang</surname><given-names>L</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>The NIH Human Microbiome Project.</article-title>             <source>Genome research</source>             <volume>19</volume>             <fpage>2317</fpage>             <lpage>2323</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Raes1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Letunic</surname><given-names>I</given-names></name><name name-style="western"><surname>Yamada</surname><given-names>T</given-names></name><name name-style="western"><surname>Jensen</surname><given-names>LJ</given-names></name><name name-style="western"><surname>Bork</surname><given-names>P</given-names></name></person-group>             <year>2011</year>             <article-title>Toward molecular trait-based ecology through integration of biogeochemical, geographical and metagenomic data.</article-title>             <source>Molecular Systems Biology</source>             <volume>7</volume>          </element-citation>
      </ref>
      <ref id="pone.0031386-Wu1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>D</given-names></name><name name-style="western"><surname>Wu</surname><given-names>M</given-names></name><name name-style="western"><surname>Halpern</surname><given-names>A</given-names></name><name name-style="western"><surname>Rusch</surname><given-names>DB</given-names></name><name name-style="western"><surname>Yooseph</surname><given-names>S</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Stalking the Fourth Domain in Metagenomic Data: Searching for, Discovering, and Interpreting Novel, Deep Branches in Marker Gene Phylogenetic Trees.</article-title>             <source>PLoS ONE</source>             <volume>6</volume>             <fpage>e18011</fpage>             <lpage>e18011</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Gianoulis1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gianoulis</surname><given-names>TA</given-names></name><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Patel</surname><given-names>PV</given-names></name><name name-style="western"><surname>Bjornson</surname><given-names>R</given-names></name><name name-style="western"><surname>Korbel</surname><given-names>JO</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Quantifying environmental adaptation of metabolic pathways in metagenomics.</article-title>             <source>Proceedings of the National Academy of Sciences of the United States of America</source>             <volume>106</volume>             <fpage>1374</fpage>             <lpage>1379</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Edwards1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Edwards</surname><given-names>RA</given-names></name><name name-style="western"><surname>Rodriguez-Brito</surname><given-names>B</given-names></name><name name-style="western"><surname>Wegley</surname><given-names>L</given-names></name><name name-style="western"><surname>Haynes</surname><given-names>M</given-names></name><name name-style="western"><surname>Breitbart</surname><given-names>M</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Using pyrosequencing to shed light on deep mine microbial ecology.</article-title>             <source>BMC genomics</source>             <volume>7</volume>             <fpage>57</fpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Turnbaugh1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name><name name-style="western"><surname>Yatsunenko</surname><given-names>T</given-names></name><name name-style="western"><surname>Cantarel</surname><given-names>BL</given-names></name><name name-style="western"><surname>Duncan</surname><given-names>A</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>A core gut microbiome in obese and lean twins.</article-title>             <source>Nature</source>             <volume>457</volume>             <fpage>480</fpage>             <lpage>484</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Singh1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Singh</surname><given-names>AH</given-names></name><name name-style="western"><surname>Doerks</surname><given-names>T</given-names></name><name name-style="western"><surname>Letunic</surname><given-names>I</given-names></name><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Bork</surname><given-names>P</given-names></name></person-group>             <year>2009</year>             <article-title>Discovering functional novelty in metagenomes: examples from light-mediated processes.</article-title>             <source>Journal of bacteriology</source>             <volume>191</volume>             <fpage>32</fpage>             <lpage>41</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Raes2">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Bork</surname><given-names>P</given-names></name></person-group>             <year>2008</year>             <article-title>Molecular eco-systems biology: towards an understanding of community function.</article-title>             <source>Nature reviews Microbiology</source>             <volume>6</volume>             <fpage>693</fpage>             <lpage>699</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Arumugam2">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Arumugam</surname><given-names>M</given-names></name><name name-style="western"><surname>Harrington</surname><given-names>ED</given-names></name><name name-style="western"><surname>Foerstner</surname><given-names>KU</given-names></name><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Bork</surname><given-names>P</given-names></name></person-group>             <year>2010</year>             <article-title>SmashCommunity: a metagenomic annotation and analysis tool.</article-title>             <source>Bioinformatics (Oxford, England)</source>             <volume>26</volume>             <fpage>2977</fpage>             <lpage>2978</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Meyer1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Meyer</surname><given-names>F</given-names></name><name name-style="western"><surname>Paarmann</surname><given-names>D</given-names></name><name name-style="western"><surname>D'Souza</surname><given-names>M</given-names></name><name name-style="western"><surname>Olson</surname><given-names>R</given-names></name><name name-style="western"><surname>Glass</surname><given-names>EM</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>The metagenomics RAST server - a public resource for the automatic phylogenetic and functional analysis of metagenomes.</article-title>             <source>BMC bioinformatics</source>             <volume>9</volume>             <fpage>386</fpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Markowitz1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Markowitz</surname><given-names>VM</given-names></name><name name-style="western"><surname>Ivanova</surname><given-names>NN</given-names></name><name name-style="western"><surname>Szeto</surname><given-names>E</given-names></name><name name-style="western"><surname>Palaniappan</surname><given-names>K</given-names></name><name name-style="western"><surname>Chu</surname><given-names>K</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>IMG/M: a data management and analysis system for metagenomes.</article-title>             <source>Nucleic acids research</source>             <volume>36</volume>             <fpage>D534</fpage>             <lpage>D538</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Goll1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Goll</surname><given-names>J</given-names></name><name name-style="western"><surname>Rusch</surname><given-names>D</given-names></name><name name-style="western"><surname>Tanenbaum</surname><given-names>DM</given-names></name><name name-style="western"><surname>Thiagarajan</surname><given-names>M</given-names></name><name name-style="western"><surname>Li</surname><given-names>K</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>METAREP: JCVI Metagenomics Reports - an open source tool for high-performance comparative metagenomics.</article-title>             <source>Bioinformatics (Oxford, England)</source>             <volume>26</volume>             <fpage>2631</fpage>             <lpage>2632</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Mavromatis1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mavromatis</surname><given-names>K</given-names></name><name name-style="western"><surname>Ivanova</surname><given-names>N</given-names></name><name name-style="western"><surname>Barry</surname><given-names>K</given-names></name><name name-style="western"><surname>Shapiro</surname><given-names>H</given-names></name><name name-style="western"><surname>Goltsman</surname><given-names>E</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Use of simulated data sets to evaluate the fidelity of metagenomic processing methods.</article-title>             <source>Nature methods</source>             <volume>4</volume>             <fpage>495</fpage>             <lpage>500</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Richter1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Richter</surname><given-names>DC</given-names></name><name name-style="western"><surname>Ott</surname><given-names>F</given-names></name><name name-style="western"><surname>Auch</surname><given-names>AF</given-names></name><name name-style="western"><surname>Schmid</surname><given-names>R</given-names></name><name name-style="western"><surname>Huson</surname><given-names>DH</given-names></name></person-group>             <year>2008</year>             <article-title>MetaSim: a sequencing simulator for genomics and metagenomics.</article-title>             <source>PloS one</source>             <volume>3</volume>             <fpage>e3373</fpage>             <lpage>e3373</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Angly2">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Angly</surname><given-names>FE</given-names></name><name name-style="western"><surname>Willner</surname><given-names>D</given-names></name><name name-style="western"><surname>Prieto-Davó</surname><given-names>A</given-names></name><name name-style="western"><surname>Edwards</surname><given-names>RA</given-names></name><name name-style="western"><surname>Schmieder</surname><given-names>R</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>The GAAS Metagenomic Tool and Its Estimations of Viral and Microbial Average Genome Size in Four Major Biomes.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000593</fpage>             <lpage>e1000593</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Pignatelli1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pignatelli</surname><given-names>M</given-names></name><name name-style="western"><surname>Moya</surname><given-names>A</given-names></name></person-group>             <year>2011</year>             <article-title>Evaluating the Fidelity of De Novo Short Read Metagenomic Assembly Using Simulated Data.</article-title>             <source>PLoS ONE</source>             <volume>6</volume>             <fpage>e19984</fpage>             <lpage>e19984</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-GarcaMartn1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>García Martín</surname><given-names>H</given-names></name><name name-style="western"><surname>Ivanova</surname><given-names>N</given-names></name><name name-style="western"><surname>Kunin</surname><given-names>V</given-names></name><name name-style="western"><surname>Warnecke</surname><given-names>F</given-names></name><name name-style="western"><surname>Barry</surname><given-names>KW</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Metagenomic analysis of two enhanced biological phosphorus removal (EBPR) sludge communities.</article-title>             <source>Nature biotechnology</source>             <volume>24</volume>             <fpage>1263</fpage>             <lpage>1269</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Kurokawa1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kurokawa</surname><given-names>K</given-names></name><name name-style="western"><surname>Itoh</surname><given-names>T</given-names></name><name name-style="western"><surname>Kuwahara</surname><given-names>T</given-names></name><name name-style="western"><surname>Oshima</surname><given-names>K</given-names></name><name name-style="western"><surname>Toh</surname><given-names>H</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Comparative metagenomics revealed commonly enriched gene sets in human gut microbiomes.</article-title>             <source>DNA research: an international journal for rapid publication of reports on genes and genomes</source>             <volume>14</volume>             <fpage>169</fpage>             <lpage>181</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Ewing1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ewing</surname><given-names>B</given-names></name><name name-style="western"><surname>Green</surname><given-names>P</given-names></name></person-group>             <year>1998</year>             <article-title>Base-Calling of Automated Sequencer Traces Using Phred. II. Error Probabilities.</article-title>             <source>Genome Res</source>             <volume>8</volume>             <fpage>186</fpage>             <lpage>194</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Cock1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cock</surname><given-names>PJA</given-names></name><name name-style="western"><surname>Fields</surname><given-names>CJ</given-names></name><name name-style="western"><surname>Goto</surname><given-names>N</given-names></name><name name-style="western"><surname>Heuer</surname><given-names>ML</given-names></name><name name-style="western"><surname>Rice</surname><given-names>PM</given-names></name></person-group>             <year>2010</year>             <article-title>The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants.</article-title>             <source>Nucleic acids research</source>             <volume>38</volume>             <fpage>1767</fpage>             <lpage>1771</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Glenn1">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Glenn</surname><given-names>TC</given-names></name></person-group>             <year>2011</year>             <article-title>Field guide to next-generation DNA sequencers.</article-title>             <source>Molecular Ecology</source>          </element-citation>
      </ref>
      <ref id="pone.0031386-Goecks1">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Goecks</surname><given-names>J</given-names></name><name name-style="western"><surname>Nekrutenko</surname><given-names>A</given-names></name><name name-style="western"><surname>Taylor</surname><given-names>J</given-names></name></person-group>             <collab xlink:type="simple">Galaxy Team T</collab>             <year>2010</year>             <article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences.</article-title>             <source>Genome Biology</source>             <volume>11</volume>             <fpage>R86</fpage>             <lpage>R86</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Li1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>R</given-names></name><name name-style="western"><surname>Zhu</surname><given-names>H</given-names></name><name name-style="western"><surname>Ruan</surname><given-names>J</given-names></name><name name-style="western"><surname>Qian</surname><given-names>W</given-names></name><name name-style="western"><surname>Fang</surname><given-names>X</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>De novo assembly of human genomes with massively parallel short read sequencing.</article-title>             <source>Genome research</source>             <volume>20</volume>             <fpage>265</fpage>             <lpage>272</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Chou1">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chou</surname><given-names>H-H</given-names></name></person-group>             <year>2001</year>             <article-title>DNA sequence quality trimming and vector removal.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>1093</fpage>             <lpage>1104</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Lander1">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name><name name-style="western"><surname>Linton</surname><given-names>LM</given-names></name><name name-style="western"><surname>Birren</surname><given-names>B</given-names></name><name name-style="western"><surname>Nusbaum</surname><given-names>C</given-names></name><name name-style="western"><surname>Zody</surname><given-names>MC</given-names></name><etal/></person-group>             <year>2001</year>             <article-title>Initial sequencing and analysis of the human genome.</article-title>             <source>Nature</source>             <volume>409</volume>             <fpage>860</fpage>             <lpage>921</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Miller1">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Miller</surname><given-names>JR</given-names></name><name name-style="western"><surname>Delcher</surname><given-names>AL</given-names></name><name name-style="western"><surname>Koren</surname><given-names>S</given-names></name><name name-style="western"><surname>Venter</surname><given-names>E</given-names></name><name name-style="western"><surname>Walenz</surname><given-names>BP</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Aggressive assembly of pyrosequencing reads with mates.</article-title>             <source>Bioinformatics (Oxford, England)</source>             <volume>24</volume>             <fpage>2818</fpage>             <lpage>2824</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Li2">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>R</given-names></name><name name-style="western"><surname>Yu</surname><given-names>C</given-names></name><name name-style="western"><surname>Li</surname><given-names>Y</given-names></name><name name-style="western"><surname>Lam</surname><given-names>T-W</given-names></name><name name-style="western"><surname>Yiu</surname><given-names>S-M</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>SOAP2: an improved ultrafast tool for short read alignment.</article-title>             <source>Bioinformatics (Oxford, England)</source>             <volume>25</volume>             <fpage>1966</fpage>             <lpage>1967</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Zhu1">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>W</given-names></name><name name-style="western"><surname>Lomsadze</surname><given-names>A</given-names></name><name name-style="western"><surname>Borodovsky</surname><given-names>M</given-names></name></person-group>             <year>2010</year>             <article-title>Ab initio gene identification in metagenomic sequences.</article-title>             <source>Nucleic acids research</source>             <volume>38</volume>             <fpage>e132</fpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Muller1">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Muller</surname><given-names>J</given-names></name><name name-style="western"><surname>Szklarczyk</surname><given-names>D</given-names></name><name name-style="western"><surname>Julien</surname><given-names>P</given-names></name><name name-style="western"><surname>Letunic</surname><given-names>I</given-names></name><name name-style="western"><surname>Roth</surname><given-names>A</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>eggNOG v2.0: extending the evolutionary genealogy of genes with enhanced non-supervised orthologous groups, species and functional annotations.</article-title>             <source>Nucleic acids research</source>             <volume>38</volume>             <fpage>D190</fpage>             <lpage>D195</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-R1">
        <label>41</label>
        <element-citation publication-type="other" xlink:type="simple">             <collab xlink:type="simple">R Development Core Team (R Foundation for Statistical Computing)</collab>             <year>2011</year>             <source>R: A Language and Environment for Statistical Computing</source>             <publisher-loc>Vienna, Austria</publisher-loc>          </element-citation>
      </ref>
      <ref id="pone.0031386-Ewing2">
        <label>42</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ewing</surname><given-names>B</given-names></name><name name-style="western"><surname>Green</surname><given-names>P</given-names></name></person-group>             <year>1998</year>             <article-title>Base-Calling of Automated Sequencer Traces Using Phred. II. Error Probabilities.</article-title>             <source>Genome Research</source>             <volume>8</volume>             <fpage>186</fpage>             <lpage>194</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Aparicio1">
        <label>43</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Aparicio</surname><given-names>S</given-names></name><name name-style="western"><surname>Chapman</surname><given-names>J</given-names></name><name name-style="western"><surname>Stupka</surname><given-names>E</given-names></name><name name-style="western"><surname>Putnam</surname><given-names>N</given-names></name><name name-style="western"><surname>Chia</surname><given-names>J-M</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>Whole-genome shotgun assembly and analysis of the genome of Fugu rubripes.</article-title>             <source>Science (New York, NY)</source>             <volume>297</volume>             <fpage>1301</fpage>             <lpage>1310</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Myers1">
        <label>44</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name></person-group>             <year>2000</year>             <article-title>A Whole-Genome Assembly of Drosophila.</article-title>             <source>Science</source>             <volume>287</volume>             <fpage>2196</fpage>             <lpage>2204</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Zerbino1">
        <label>45</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zerbino</surname><given-names>DR</given-names></name><name name-style="western"><surname>Birney</surname><given-names>E</given-names></name></person-group>             <year>2008</year>             <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs.</article-title>             <source>Genome research</source>             <volume>18</volume>             <fpage>821</fpage>             <lpage>829</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Warren1">
        <label>46</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Warren</surname><given-names>RL</given-names></name><name name-style="western"><surname>Sutton</surname><given-names>GG</given-names></name><name name-style="western"><surname>Jones</surname><given-names>SJM</given-names></name><name name-style="western"><surname>Holt</surname><given-names>RA</given-names></name></person-group>             <year>2007</year>             <article-title>Assembling millions of short DNA sequences using SSAKE.</article-title>             <source>Bioinformatics (Oxford, England)</source>             <volume>23</volume>             <fpage>500</fpage>             <lpage>501</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Harrington1">
        <label>47</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Harrington</surname><given-names>ED</given-names></name><name name-style="western"><surname>Singh</surname><given-names>AH</given-names></name><name name-style="western"><surname>Doerks</surname><given-names>T</given-names></name><name name-style="western"><surname>Letunic</surname><given-names>I</given-names></name><name name-style="western"><surname>von Mering</surname><given-names>C</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Quantitative assessment of protein function prediction from metagenomics shotgun sequences.</article-title>             <source>Proceedings of the National Academy of Sciences of the United States of America</source>             <volume>104</volume>             <fpage>13913</fpage>             <lpage>13918</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Miller2">
        <label>48</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Miller</surname><given-names>JR</given-names></name><name name-style="western"><surname>Koren</surname><given-names>S</given-names></name><name name-style="western"><surname>Sutton</surname><given-names>G</given-names></name></person-group>             <year>2010</year>             <article-title>Assembly algorithms for next-generation sequencing data.</article-title>             <source>Genomics</source>             <volume>95</volume>             <fpage>315</fpage>             <lpage>327</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Pop1">
        <label>49</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pop</surname><given-names>M</given-names></name><name name-style="western"><surname>Kosack</surname><given-names>DS</given-names></name><name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name></person-group>             <year>2004</year>             <article-title>Hierarchical scaffolding with Bambus.</article-title>             <source>Genome research</source>             <volume>14</volume>             <fpage>149</fpage>             <lpage>159</lpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Cox1">
        <label>50</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cox</surname><given-names>MP</given-names></name><name name-style="western"><surname>Peterson</surname><given-names>DA</given-names></name><name name-style="western"><surname>Biggs</surname><given-names>PJ</given-names></name></person-group>             <year>2010</year>             <article-title>SolexaQA: At-a-glance quality assessment of Illumina second-generation sequencing data.</article-title>             <source>BMC bioinformatics</source>             <volume>11</volume>             <fpage>485</fpage>          </element-citation>
      </ref>
      <ref id="pone.0031386-Schmieder1">
        <label>51</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schmieder</surname><given-names>R</given-names></name><name name-style="western"><surname>Edwards</surname><given-names>R</given-names></name></person-group>             <year>2011</year>             <article-title>Quality control and preprocessing of metagenomic datasets.</article-title>             <source>Bioinformatics (Oxford, England)</source>             <volume>27</volume>             <fpage>863</fpage>             <lpage>864</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>