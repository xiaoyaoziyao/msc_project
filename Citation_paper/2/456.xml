<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0151064</article-id>
<article-id pub-id-type="publisher-id">PONE-D-15-47425</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>Non-coding RNA</subject><subj-group><subject>Ribosomal RNA</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Ribosomes</subject><subj-group><subject>Ribosomal RNA</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular structures and organelles</subject><subj-group><subject>Ribosomes</subject><subj-group><subject>Ribosomal RNA</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biomechanics</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Running</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Running</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Running</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Computer architecture</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Memory</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Memory</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Comparative sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Comparative sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>CLUSTOM-CLOUD: In-Memory Data Grid-Based Software for Clustering 16S rRNA Sequence Data in the Cloud Environment</article-title>
<alt-title alt-title-type="running-head">CLUSTOM-CLOUD: Sequence Clustering Based on In-Memory Data Grid</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Oh</surname>
<given-names>Jeongsu</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Choi</surname>
<given-names>Chi-Hwan</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Park</surname>
<given-names>Min-Kyu</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kim</surname>
<given-names>Byung Kwon</given-names>
</name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hwang</surname>
<given-names>Kyuin</given-names>
</name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Lee</surname>
<given-names>Sang-Heon</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff008"><sup>8</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hong</surname>
<given-names>Soon Gyu</given-names>
</name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Nasir</surname>
<given-names>Arshan</given-names>
</name>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Cho</surname>
<given-names>Wan-Sup</given-names>
</name>
<xref ref-type="aff" rid="aff007"><sup>7</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Kim</surname>
<given-names>Kyung Mo</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff008"><sup>8</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Microbial Resource Center, Korea Research Institute of Bioscience and Biotechnology, Daejeon, Republic of Korea</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Bio-Information Technology, Chungbuk National University, CheongJu, Republic of Korea</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Business Data Convergence, Chungbuk National University, CheongJu, Republic of Korea</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>BioNano Health Guard Research Center, Korea Research Institute of Bioscience and Biotechnology, Daejeon, Republic of Korea</addr-line></aff>
<aff id="aff005"><label>5</label> <addr-line>Division of Polar Life Sciences, Korea Polar Research Institute, Incheon, Republic of Korea</addr-line></aff>
<aff id="aff006"><label>6</label> <addr-line>Department of Biosciences, COMSATS Institute of Information Technology, Islamabad, Pakistan</addr-line></aff>
<aff id="aff007"><label>7</label> <addr-line>Department of Management Information Systems/BK Plus Team, Chungbuk National University, CheongJu, Republic of Korea</addr-line></aff>
<aff id="aff008"><label>8</label> <addr-line>Department of Bioinformatics, University of Science and Technology, Daejeon, Republic of Korea</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Antoniewski</surname>
<given-names>Christophe</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>CNRS UMR7622 &amp; University Paris 6 Pierre-et-Marie-Curie, FRANCE</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: SGH BKK KMK. Performed the experiments: JO CC KH. Analyzed the data: CC MP KH SL. Contributed reagents/materials/analysis tools: KMK WC. Wrote the paper: JO CC AN KMK.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">kmkim@kribb.re.kr</email> (KMK); <email xlink:type="simple">wscho@chungbuk.ac.kr</email> (WC)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>8</day>
<month>3</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<year>2016</year>
</pub-date>
<volume>11</volume>
<issue>3</issue>
<elocation-id>e0151064</elocation-id>
<history>
<date date-type="received">
<day>31</day>
<month>10</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>2</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Oh et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0151064"/>
<abstract>
<p>High-throughput sequencing can produce hundreds of thousands of 16S rRNA sequence reads corresponding to different organisms present in the environmental samples. Typically, analysis of microbial diversity in bioinformatics starts from pre-processing followed by clustering 16S rRNA reads into relatively fewer operational taxonomic units (OTUs). The OTUs are reliable indicators of microbial diversity and greatly accelerate the downstream analysis time. However, existing hierarchical clustering algorithms that are generally more accurate than greedy heuristic algorithms struggle with large sequence datasets. To keep pace with the rapid rise in sequencing data, we present CLUSTOM-CLOUD, which is the first distributed sequence clustering program based on In-Memory Data Grid (IMDG) technology–a distributed data structure to store all data in the main memory of multiple computing nodes. The IMDG technology helps CLUSTOM-CLOUD to enhance both its capability of handling larger datasets and its computational scalability better than its ancestor, CLUSTOM, while maintaining high accuracy. Clustering speed of CLUSTOM-CLOUD was evaluated on published 16S rRNA human microbiome sequence datasets using the small laboratory cluster (10 nodes) and under the Amazon EC2 cloud-computing environments. Under the laboratory environment, it required only ~3 hours to process dataset of size 200 K reads regardless of the complexity of the human microbiome data. In turn, one million reads were processed in approximately 20, 14, and 11 hours when utilizing 20, 30, and 40 nodes on the Amazon EC2 cloud-computing environment. The running time evaluation indicates that CLUSTOM-CLOUD can handle much larger sequence datasets than CLUSTOM and is also a scalable distributed processing system. The comparative accuracy test using 16S rRNA pyrosequences of a mock community shows that CLUSTOM-CLOUD achieves higher accuracy than DOTUR, mothur, ESPRIT-Tree, UCLUST and Swarm. CLUSTOM-CLOUD is written in JAVA and is freely available at <ext-link ext-link-type="uri" xlink:href="http://clustomcloud.kopri.re.kr/" xlink:type="simple">http://clustomcloud.kopri.re.kr</ext-link>.</p>
</abstract>
<funding-group>
<funding-statement>This material is based upon work supported by the KRIBB (<ext-link ext-link-type="uri" xlink:href="http://www.kribb.re.kr" xlink:type="simple">http://www.kribb.re.kr</ext-link>) Research Initiative Program (to KMK) and by KOPRI (<ext-link ext-link-type="uri" xlink:href="http://www.kopri.re.kr" xlink:type="simple">http://www.kopri.re.kr</ext-link>) research program under Grant No. PE15020 (to SGH). The funders had no role in studying design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="2"/>
<page-count count="20"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Microorganisms constitute a vital component of the biosphere. They are remarkably abundant and occupy many kinds of environments including various human body sites [<xref ref-type="bibr" rid="pone.0151064.ref001">1</xref>]. Microbes play crucial roles in ecosystems. They are involved in nitrogen fixation, utilized in the medicine and food industry, cause numerous diseases, and are a rich source of new genes for other organisms. Despite having been extensively studied for decades, many aspects of microbial ecology and evolution still remain unexplored. Since the vast majority of microbes cannot be cultured, it is desirable to analyze microbial diversity directly from environmental samples. Recent advances in next-generation sequencing (NGS) have enabled generation of large amount of 16S ribosomal RNA (rRNA) sequence data recovered directly from a variety of environmental samples. Although the data provide a unique opportunity to deeply examine microbial diversity and community structure, its efficient handling remains a bioinformatics challenge.</p>
<p>The first step in the analysis of microbial samples recovered from various environments is pre-processing, which includes trimming tag sequences, filtering out the low-quality reads, removing chimera errors and dereplication [<xref ref-type="bibr" rid="pone.0151064.ref002">2</xref>]. Pre-processing is followed by clustering 16S rRNA sequences into operational taxonomic units (OTUs). Since the number and size of OTUs are obligatory indicators of the richness (e.g., number of different species) and evenness (relative abundance of individual species across taxonomic groups) of microbial taxa present in the samples [<xref ref-type="bibr" rid="pone.0151064.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0151064.ref004">4</xref>], sequence clustering is regarded as one of the most important and influential steps in analyzing environmental data. Sequence clustering is effectively a taxonomy-independent (or <italic>de novo</italic>) approach that can group microbial taxa even in the absence of reference databases of known organisms [<xref ref-type="bibr" rid="pone.0151064.ref005">5</xref>]. Moreover, the use of representative OTUs greatly reduces the computational time required in the downstream analysis of extensive data generated by high-throughput sequencing platforms. Several algorithms have therefore been developed for accurate and fast clustering of sequences into OTUs. Some well-known options include DOTUR [<xref ref-type="bibr" rid="pone.0151064.ref006">6</xref>], ESPRIT [<xref ref-type="bibr" rid="pone.0151064.ref007">7</xref>], Cd-hit [<xref ref-type="bibr" rid="pone.0151064.ref008">8</xref>], UCLUST [<xref ref-type="bibr" rid="pone.0151064.ref009">9</xref>], mothur [<xref ref-type="bibr" rid="pone.0151064.ref010">10</xref>], CLUSTOM [<xref ref-type="bibr" rid="pone.0151064.ref011">11</xref>] and Swarm [<xref ref-type="bibr" rid="pone.0151064.ref012">12</xref>]. In a recent comparative study, we showed that CLUSTOM gave superior clustering performance and guaranteed both optimal accuracy and speed relative to its contemporaries [<xref ref-type="bibr" rid="pone.0151064.ref011">11</xref>]. Specifically, the clustering accuracy of CLUSTOM was similar to DOTUR but better than other hierarchical clustering algorithms. Importantly, CLUSTOM that uses <italic>k</italic>-mer thresholds in clustering sequences outperformed DOTUR and mothur in terms of computational time even though the computational complexity of the three programs is basically <italic>O</italic>(<italic>N</italic><sup><italic>2</italic></sup>). While both Cd-hit and UCLUST (greedy heuristic clustering algorithms of complexity <italic>O</italic>(<italic>N</italic><sup><italic>1</italic>.<italic>2</italic></sup>)) were faster than CLUSTOM, their accuracy did not reach desirable levels [<xref ref-type="bibr" rid="pone.0151064.ref011">11</xref>]. Therefore, CLUSTOM should be considered the method of choice to efficiently and accurately cluster 16S rRNA sequences into OTUs, and importantly, is based on the natural phenomenon of prokaryotic species divergence, unlike other algorithms [<xref ref-type="bibr" rid="pone.0151064.ref011">11</xref>]. However, the original version of CLUSTOM relied on the CPU and memory resources of a single computational node, which limited its use to small-scale datasets (generally up to 300K reads). To overcome this limitation we present CLUSTOM-CLOUD, a significant upgrade to CLUSTOM, which can run in both the distributed and cloud-computing environments and can be conveniently scaled to process over one million 16S sequences.</p>
<p>Current distributed computing techniques such as Message Passing Interface (MPI) and MapReduce of the Hadoop ecosystem are widely used to analyze large-scale sequence data in bioinformatics fields. MPI has been in use for some time and offers portability and reliable performance [<xref ref-type="bibr" rid="pone.0151064.ref013">13</xref>]. However, it is difficult to make application durable of fault tolerance which means the ability to recover from one or more component failures in a manner with a transparent or application-driven mechanism. In turn, MapReduce of the Hadoop offers high scalability and fault tolerance and is relatively easier to use [<xref ref-type="bibr" rid="pone.0151064.ref014">14</xref>–<xref ref-type="bibr" rid="pone.0151064.ref016">16</xref>]. However, it suffers from occasional performance degradation and slow speed due to I/O bottlenecks between the CPU and the hard disk [<xref ref-type="bibr" rid="pone.0151064.ref017">17</xref>, <xref ref-type="bibr" rid="pone.0151064.ref018">18</xref>]. In addition, Hadoop MapReduce-based programs demand specific installations and settings similar to MPI, which can be difficult to implement and time-consuming. Because of these limitations, a different distributed computing approach such as the ‘In-Memory Data Grid (IMDG)’ technology needs to be considered. This distributed approach has recently become popular in industrial and information science fields to handle “big data”. Some well-known applications include online banking, risk analysis, trading systems, e-commerce, and online gaming [<xref ref-type="bibr" rid="pone.0151064.ref019">19</xref>]. The IMDG data structure can store terabytes of data in Random Access Memory (RAM) shared by multiple nodes. It provides three key advantages over MPI and Hadoop MapReduce: (i) processes data much faster because all data can be stored and accessed in memory, (ii) can be relatively easily scaled and executed without any complicated installation, and (iii) is easy to implement for both parallel and distributed computing systems.</p>
<p>To assess the speed performance of CLUSTOM-CLOUD, we prepared four sequence datasets of various sizes (50 K, 100 K, 150 K, and 200 K) from 16S rRNA data of microbial communities sequenced from different human body sites [<xref ref-type="bibr" rid="pone.0151064.ref001">1</xref>] exhibiting <italic>high</italic>, <italic>intermediate</italic>, and <italic>low</italic> microbial complexity (see <xref ref-type="sec" rid="sec002">Methods</xref>). To demonstrate the scalability of CLUSTOM-CLOUD, we analyzed one million randomly sampled sequences from the above-mentioned datasets by gradually increasing the computing nodes on the Amazon Elastic Compute Cloud (EC2) computing environment (20, 30, and 40 nodes). Comparative accuracy evaluation of clustering programs was also conducted using 16S rRNA sequences of a mock community. The speed and accuracy comparison results revealed that implementation of IMDG technology and its additional enhancements such as sequence dereplication and <italic>k</italic>-mer transformation method (read below) in CLUSTOM-CLOUD yielded speedier processing of large sequence datasets than its ancestor CLUSTOM while maintaining the high accuracy. CLUSTOM-CLOUD is platform-independent and can be conveniently scaled and upgraded to keep pace with the continuous rise of biological sequence data.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>System architecture</title>
<p>OTUs are inferred from the genetic distance between each pair of 16S rRNA sequences. While the precise calculation of genetic distance requires exhaustive implementation of dynamic programming such as the Needleman-Wunsch (NW) algorithm, determining optimal alignments between millions of possible sequence pairs can be computationally intensive. While the heavy computational time is difficult to reduce, we can significantly reduce the wall clock time by building a high-performance distributed computing system. Following this rationale, we adopted the <italic>k</italic>-mer transformation method and sequence dereplication steps (read below) to significantly reduce the computational time while also considering network overhead effects by finding optimal data granularity. Moreover, the majority of raw and intermediate data needs to be stored in memory (i.e., IMDG data structure) rather than the hard disk of individual nodes for faster execution. In consideration of these points, CLUSTOM-CLOUD has utilized a hybrid architecture comprising both peer-to-peer (useful for high-performance distributed computing) and client-server (appropriate because most data needs to be stored in memory) cluster approaches [<xref ref-type="bibr" rid="pone.0151064.ref020">20</xref>]. The hybrid architecture consists of two components: <italic>Cluster</italic> and <italic>Application</italic> (<xref ref-type="fig" rid="pone.0151064.g001">Fig 1</xref>).</p>
<fig id="pone.0151064.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0151064.g001</object-id>
<label>Fig 1</label>
<caption>
<title>System architecture.</title>
<p>CLUSTOM-CLOUD consists of <italic>Application</italic> and <italic>Cluster</italic> units. <italic>Application</italic> is composed of <italic>Job Tracker</italic> and <italic>Data Manager</italic>. <italic>Job Tracker</italic> assigns <italic>Task Tracker</italic> to each <italic>Cluster Node</italic> in <italic>Cluster</italic> and checks its status. <italic>Task Tracker</italic> processes a distributed task in parallel using multi-threads. Data manager manages processed results and generates clustering results. <italic>Cluster</italic> is a set of <italic>N</italic>-nodes, which are unified by IMDG. <italic>Cluster</italic> is composed of <italic>Cluster Node</italic> and <italic>Task Tracker</italic>. A part of RAM in each <italic>Cluster Node</italic> is assigned to IMDG data structure and backup area.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.g001" xlink:type="simple"/>
</fig>
<p><italic>Cluster</italic> is a collection of <italic>N</italic>-nodes that share the computational task of deriving OTUs and determining sequence clusters. To support IMDG, each <italic>Cluster Node</italic> partially stores overall data in the ‘owner’ area of RAM (<xref ref-type="fig" rid="pone.0151064.g001">Fig 1</xref>), referenced by the ‘key-value’ data structure (read below). To avoid data loss resulting from the unexpected shutdown of some nodes, each node has an additional ‘backup’ area linked to another node (solid lines in <xref ref-type="fig" rid="pone.0151064.g001">Fig 1</xref>). The owner and backup constitute a single data partition [<xref ref-type="bibr" rid="pone.0151064.ref020">20</xref>] and a similar design is implemented across <italic>N</italic>-nodes to store the entire dataset directly into memory. In turn, <italic>Task Tracker</italic> is a logical unit for processing requested tasks. It contains definitions of operations, information about the required number of threads, and the range of sequences to be processed by each node. <italic>Task Tracker</italic> processes a distributed task in parallel using multi-threads and is assigned to each node by the <italic>Job Tracker</italic> of <italic>Application</italic>.</p>
<p>The <italic>Application</italic> unit activates the <italic>Cluster</italic> upon user request. It is composed of <italic>Job Tracker</italic> and <italic>Data Manager</italic>. <italic>Job Tracker</italic> assigns <italic>Task Tracker</italic> to each <italic>Cluster Node</italic> (dotted lines in <xref ref-type="fig" rid="pone.0151064.g001">Fig 1</xref>) and routinely checks its status. In case of any malfunction, it can automatically reassign <italic>Task Tracker</italic> to another node, thus continuing the operational chain. Although the IMDG data structure provides functionality for checking node heartbeat, it does not support reassigning a failed task to another node. Therefore, <italic>Job Tracker</italic> is a crucial component of the architecture to support the high availability of CLUSTOM-CLOUD. In turn, <italic>Data Manager</italic> integrates partial results from multiple <italic>Task Trackers</italic> and generates initial and final clustering results (<xref ref-type="fig" rid="pone.0151064.g001">Fig 1</xref>, double dashed line). It also clears temporary data from memory to ensure maximum availability of resources during all stages of processing.</p>
</sec>
<sec id="sec004">
<title>Clustering workflow</title>
<p>The workflow of the previous version CLUSTOM consisted of three major steps: <italic>k-mer threshold determination</italic>, <italic>initial clustering</italic> and <italic>refinement</italic>. In the <italic>k-mer threshold determination</italic> step, CLUSTOM randomly samples a subset of sequences from a given 16S input dataset. Next, <italic>k</italic>-mer and NW distances between all possible sampled sequence pairs are calculated to determine the <italic>k</italic>-mer threshold that corresponds to the user-defined NW distance threshold (e.g., 3% dissimilarity of 16S sequences). In the <italic>initial clustering</italic> step, CLUSTOM calculates <italic>k</italic>-mer distance of each pair in the 16S input sequences, chooses sequence pairs below the <italic>k</italic>-mer threshold, connects the two sequences of the individual pairs to each other and constructs an initial network only with the selected sequence pairs [<xref ref-type="bibr" rid="pone.0151064.ref011">11</xref>]. CLUSTOM then searches for the sequence to which the largest number of other sequences is directly connected. This highly connected node in the network is then treated as <italic>seed</italic> that, along with its directly connected sequences, is used to build an initial cluster. This process is repeated to determine additional seeds and clusters from the remaining sequences until each cluster is left with only one sequence (i.e., a singleton). The <italic>refinement</italic> step then calculates NW distance for each pair of <italic>seed</italic> sequences as well as the singletons determined in the <italic>initial clustering</italic> step and builds a refined network. The sequence to which the largest number of sequences is connected is treated as the <italic>refined seed</italic>. CLUSTOM then determines the first final cluster consisting of the <italic>refined seed</italic>, sequences in the refined network directly connected to the <italic>refined seed</italic> (neighbors) and sequences in the initial network directly connected to either the <italic>refined seed</italic> or its neighbors [<xref ref-type="bibr" rid="pone.0151064.ref011">11</xref>]. Next, final clusters are iteratively determined in the same manner as described in the <italic>initial clustering</italic> step. Although CLUSTOM-CLOUD clusters sequences in a similar way, the workflow is different because of distributed processing based on IMDG and additional enhancements. Below, we outline the workflow of CLUSTOM-CLOUD focusing primarily on the upgrades that led to significant performance improvement in sequence clustering (<xref ref-type="fig" rid="pone.0151064.g002">Fig 2</xref>). More methodological details and rationale for the CLUSTOM workflow can be found in [<xref ref-type="bibr" rid="pone.0151064.ref011">11</xref>].</p>
<fig id="pone.0151064.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0151064.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Schematic diagram of clustering workflow.</title>
<p>16S rRNA sequences in FASTA format are provided as input. Each input file, already checked for low-quality and chimera errors, is pre-processed by the removal of duplicates and transformation of <italic>k</italic>-mer into numeric values. A fixed number of sequence pairs are distributed to each cluster node for <italic>k</italic>-mer (initial) and NW (refinement) distance calculation. Processed results are merged upon completion of each unit task. Clusters are determined based on criteria described previously [<xref ref-type="bibr" rid="pone.0151064.ref011">11</xref>] and in text. Output files are created and data are cleared from memory.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Preprocessing</title>
<p>Before loading data into IMDG, each input FASTA file consisting of 16S rRNA reads is preprocessed by, (i) the removal of duplicate sequences and (ii) transformation of <italic>k</italic>-mer strings into numeric values (<xref ref-type="fig" rid="pone.0151064.g002">Fig 2</xref>). Sequence data produced by microbial diversity projects may contain duplicate sequences depending on the properties of microbial diversity in samples [<xref ref-type="bibr" rid="pone.0151064.ref021">21</xref>]. In CLUSTOM, duplicates were used to find the most connected nodes during the <italic>initial clustering</italic> and <italic>refinement</italic> steps. However, they were retained through the entire clustering procedure and unnecessarily consumed additional computing time and resources. Therefore, an additional feature of CLUSTOM-CLOUD is the dynamic treatment of duplicate reads. Specifically, duplicates are removed before loading data into IMDG but are recovered during the clustering steps. Similar to other clustering programs (e.g., mothur, ESPRIT-Tree, UCLUST, Swarm, etc.), the dereplication contributes to reducing the overall processing time. Similarly, calculation of <italic>k</italic>-mer distances between each pair of input sequences was the most time-consuming step in CLUSTOM, requiring polynomial complexity <italic>O(N</italic><sup><italic>2</italic></sup><italic>)</italic>, with <italic>N</italic> representing the total number of sequences. Therefore, performance could be significantly improved if <italic>k</italic>-mer distance calculation time was somehow accelerated. We accomplished this task by loading all <italic>k</italic>-mer strings and their corresponding number of occurrences directly into memory before distance calculation. Because this operation still involved a huge number of comparisons between <italic>k</italic>-mer strings, we transformed <italic>k</italic>-mers into numeric values using the hash map data structure (<xref ref-type="fig" rid="pone.0151064.g003">Fig 3A</xref>). Specifically, each <italic>k</italic>-mer in sequence (key) was transformed into a non-redundant numeric value corresponding to each key in the hash map (<xref ref-type="fig" rid="pone.0151064.g003">Fig 3B</xref>). For <italic>k</italic>-mer strings not present in the hash map, a new <italic>key</italic> and <italic>value</italic> was dynamically created.</p>
<fig id="pone.0151064.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0151064.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Representation of <italic>k</italic>-mer transformation method.</title>
<p>The diagram summarizes the layout of the <italic>k</italic>-mer transformation method. (A) All <italic>k</italic>-mer strings in the input sequence dataset along with non-redundant numeric values are loaded into hash map. (B) All <italic>k</italic>-mer in each sequence are replaced with numeric values corresponding to each key in hash map.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Initial clustering</title>
<p>The <italic>k</italic>-mer distance between each input sequence pair is calculated using parallel and distributed computing (<xref ref-type="fig" rid="pone.0151064.g002">Fig 2A</xref>). All tasks are distributed to <italic>Cluster Nodes</italic> sequentially by the <italic>Job Tracker</italic> and then processed in parallel using multi-threads by <italic>Task Tracker</italic>. To reduce communication overhead associated with sending data between nodes and IMDG, intermediate results generated during the process of the unit task are first saved in the local memory of the processing node. Upon completion of the unit task, processed results are merged sequentially into IMDG (<xref ref-type="fig" rid="pone.0151064.g002">Fig 2B</xref>, Merge phase) with simultaneous removal of intermediate data from the local memory. The workflow is similar to that of Hadoop MapReduce [<xref ref-type="bibr" rid="pone.0151064.ref022">22</xref>] but differs in the timing of when processed results are merged. In MapReduce, results are merged upon completion of all distributed tasks. In turn, CLUSTOM-CLOUD merges processed results after each task is finished to prevent shortage of memory in local nodes. Once all tasks are completed and results are merged, a set of representative initial clusters is determined (<xref ref-type="fig" rid="pone.0151064.g002">Fig 2C</xref>) based on <italic>k</italic>-mer distance calculations and <italic>seed</italic> selection. Clusters are chosen via parallel processing on the <italic>Application</italic> node because cluster-determination via distributed processing can be relatively less efficient due to higher communication cost and load imbalance. However, distributed processing functionality is also supported as an alternative in CLUSTOM-CLOUD.</p>
</sec>
<sec id="sec007">
<title>Refinement</title>
<p>For each pair of the most connected sequences in the <italic>initial clustering</italic> step, NW distances are calculated as described above (<xref ref-type="fig" rid="pone.0151064.g002">Fig 2D and 2E</xref>). Once all distributed tasks are finished, final clusters are determined, similar to CLUSTOM [<xref ref-type="bibr" rid="pone.0151064.ref011">11</xref>] (see also <xref ref-type="fig" rid="pone.0151064.g002">Fig 2F</xref>).</p>
</sec>
<sec id="sec008">
<title>Output</title>
<p>Results are archived to the local file system of <italic>Application</italic>. Three output files identical in format and structure to CLUSTOM are generated from the final cluster analysis (<xref ref-type="fig" rid="pone.0151064.g002">Fig 2</xref>): (i) sequences per OTU (FASTA), (ii) representative sequences of OTUs (FASTA), and (iii) number of sequences per OTU (Plain text). All data are cleared from IMDG following output generation.</p>
</sec>
<sec id="sec009">
<title>Dataset preparation for evaluation of running time</title>
<p>The composition of microbial populations largely depends on the features of the natural environment [<xref ref-type="bibr" rid="pone.0151064.ref023">23</xref>]. Some habitats favor the growth of certain species while restrict the others. Therefore, sequence data extracted from different environmental samples exhibit varying levels of microbial complexity and this property naturally relates to the performance of clustering algorithms. Therefore, we prepared test datasets with varying levels of microbial complexity to assess the running time of CLUSTOM-CLOUD. We first retrieved 16S rRNA sequences corresponding to 18 different human body sites from the data archive of the Human Microbiome Project (<ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org/HM16STR" xlink:type="simple">http://hmpdacc.org/HM16STR</ext-link>, download date: May 14, 2015). Microbiome sequences were generated using the Roche-454 FLX Titanium platform (hereafter 454-HMP) and were already trimmed and error-corrected. Additionally, we filtered out sequences below 300 bp from each of the 18 sampled locations. A set of 10 K sequences was then randomly extracted from each sampled location and was analyzed by CLUSTOM for richness and evenness, two well-known indicators of microbial diversity [<xref ref-type="bibr" rid="pone.0151064.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0151064.ref004">4</xref>]. Based on the alpha-diversity patterns, body sites were pooled into three datasets exhibiting <italic>high</italic> (2,666,826 total reads containing ~19.67% duplicates), <italic>intermediate</italic> (2,520,233 reads containing~25.77% duplicates), and <italic>low</italic> (1,234,923 reads containing ~36.73% duplicates) microbial complexity (<xref ref-type="supplementary-material" rid="pone.0151064.s001">S1 Fig</xref>). From each pooled dataset, we randomly extracted 50 K, 100 K, 150 K, and 200 K sequences (average sequence length 474–482 bp with a standard deviation of 55–57) for performance analysis. Additionally, we randomly sampled one million reads (~23.58% duplicates, average length = 478 bp, standard deviation = 56) from the three datasets to evaluate the running time of CLUSTOM-CLOUD under the Amazon EC2 cloud-computing environment.</p>
</sec>
<sec id="sec010">
<title>Test environment</title>
<p>The running time evaluation was conducted on a small computer cluster consisting of one <italic>Application</italic> and 10 <italic>Cluster Nodes</italic> using the three datasets described above (<italic>high</italic>, <italic>intermediate</italic>, and <italic>low</italic>). Each node was equipped with a single quad-core Intel(R) Xeon(R) CPU E3-1270 v3 @ 3.50GHz, 32 G of ECC RAM, 2 TB hard disk (40 total cores, 320 GB total memory), and a Cent OS 6.4 operating system connected to 1 Gigabit Ethernet. In addition, Amazon EC2 clusters of one <italic>Application</italic> and 20, 30, and 40 <italic>Cluster Nodes</italic> were tested under the cloud-computing environment using one million reads. In each case, <italic>Application</italic> was a High-CPU Extra Large Instance (virtualized 64-bit computer with 60 GB of memory) equivalent to 32 processor cores clocked at approximately 2.8 GHz, whereas each <italic>Cluster Node</italic> was an EC2 High-Memory Extra Large Instance (virtualized 64-bit computer with 30.5 GB of memory) equivalent to four processor cores clocked at approximately 2.5 GHz.</p>
</sec>
<sec id="sec011">
<title>Determination of optimal granularity</title>
<p>The amount of work assigned to parallel and distributed tasks (granularity) is the major factor influencing the performance of parallel and distributed computing systems [<xref ref-type="bibr" rid="pone.0151064.ref024">24</xref>]. If granularity is too fine (small size), communication overhead between tasks may take longer than computation, resulting in performance degradation. In contrast, coarse granularity (large size) implies improved performance but may cause load imbalance due to unequal allocation of workload, leading to some nodes or processors being idle [<xref ref-type="bibr" rid="pone.0151064.ref025">25</xref>]. To determinate the optimal granularity of CLUSTOM-CLOUD, we measured the computational time required for calculating <italic>k</italic>-mer (<italic>initial clustering</italic>) and NW (<italic>refinement</italic>) distances for a 100 K sample of <italic>high</italic> complexity by repeatedly changing the number of sequence pairs distributed to each <italic>Cluster Node</italic> (1 K, 1.5 K, 2 K, 2.5 K and 3 K) and the total number of nodes (5 and 10) under the test environment described above (i.e., small computer cluster connected to 1 Gigabit Ethernet). Although granularity could also fluctuate somewhat based on the network environment, we executed tests at 1 Gigabit network speed, which is the recommended and default speed to execute CLUSTOM-CLOUD. Moreover, users can customize the number of sequence pairs distributed to each task. Therefore, optimal granularity calculated in the test environment is expected to be a close approximation of the real environment.</p>
</sec>
<sec id="sec012">
<title>Fine-grained task distribution</title>
<p>Calculation of <italic>k</italic>-mer and NW distances between every sequence pair was the major contributing factor to computational time in CLUSTOM. Because all distributed tasks were processed independently in each node, performance could suffer from load imbalance. To overcome these limitations, we developed a fine-grained task distribution method in CLUSTOM-CLOUD (<xref ref-type="fig" rid="pone.0151064.g004">Fig 4</xref>): (i) for <italic>n</italic> sequences, the total number of sequence pairs to be compared are given by the relation <italic>n*(n-1)/2</italic>, shown as the right-angled triangle in <xref ref-type="fig" rid="pone.0151064.g004">Fig 4A</xref>; (ii) a fixed number of sequence pairs are assigned to each task based on the optimal granularity of the system (e.g., fixed-size chunks of 2 K sequence pairs shown in <xref ref-type="fig" rid="pone.0151064.g004">Fig 4B</xref>); (iii) tasks are evenly distributed to cluster nodes by <italic>Job Tracker</italic> in the order of top to bottom and left to right (<xref ref-type="fig" rid="pone.0151064.g004">Fig 4C and 4D</xref>); and (iv) then processed in parallel using multi-threading by <italic>Task Tracker</italic> in <xref ref-type="fig" rid="pone.0151064.g004">Fig 4E</xref>. The task (T<sub><italic>i</italic></sub>) assigned by <italic>Job Tracker</italic> of <italic>Application</italic> will be divided into smaller sub-tasks (t<sub><italic>j</italic></sub>) by <italic>Task Tracker</italic> on each cluster node. The sub-tasks (t<sub><italic>j</italic></sub>) will be processed in parallel way using multi-threads (w<sub><italic>k</italic></sub>) in compliance with the number of threads of each cluster node. <xref ref-type="table" rid="pone.0151064.t001">Table 1</xref> shows the execution time of the cluster node.</p>
<fig id="pone.0151064.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0151064.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Fine-grained task distribution in CLUSTOM-CLOUD.</title>
<p>The figure summarizes the workflow of distributed processing in CLUSTOM-CLOUD. (A) The number of all possible sequence pairs that need to be compared for distance calculation is represented as a right-angled triangle; <italic>n</italic> represents the total number of sequences. (B) A chunk-size based on system granularity is determined to distribute only a fixed number of sequence pairs (shown here with 2 K) to each cluster node. (C) Each task (e.g., T<sub><italic>i</italic></sub>) is assigned to nodes from top to bottom and left to right. (D) Each node takes and processes tasks in the order of task priority. (E) The assigned task (T<sub><italic>i</italic></sub>) is divided into smaller sub-tasks (t<sub><italic>j</italic></sub>) and processed in parallel using multi-threads (w<sub>k</sub>) depending on the number of threads on the cluster node.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.g004" xlink:type="simple"/>
</fig>
<table-wrap id="pone.0151064.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0151064.t001</object-id>
<label>Table 1</label> <caption><title>CLUSTOM-CLOUD running time for each step according to the complexity of the microbial diversity<xref ref-type="table-fn" rid="t001fn001"><sup>a</sup></xref>.</title></caption>
<alternatives>
<graphic id="pone.0151064.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" colspan="2"/>
<th align="center" colspan="2"><italic>Initial clustering</italic></th>
<th align="center" colspan="2"><italic>Refinement</italic></th>
<th align="center"/>
</tr>
<tr>
<th align="center">Dataset</th>
<th align="center">Size</th>
<th align="center"><italic>k</italic>-mer distance calculation<xref ref-type="table-fn" rid="t001fn002"><sup>b</sup></xref></th>
<th align="center">Cluster determination</th>
<th align="center">NW calculation</th>
<th align="center">Cluster determination</th>
<th align="center">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold><italic>High</italic></bold></td>
<td align="center">50 K</td>
<td align="center">8.6 m</td>
<td align="center">0.2 m</td>
<td align="center">25.1 m</td>
<td align="center">0.6 m</td>
<td align="center">34.5 m</td>
</tr>
<tr>
<td align="center"/>
<td align="center">100 K</td>
<td align="center">30.2 m</td>
<td align="center">1 m</td>
<td align="center">26 m</td>
<td align="center">1.4 m</td>
<td align="center">58.6 m</td>
</tr>
<tr>
<td align="center"/>
<td align="center">150 K</td>
<td align="center">68.2 m</td>
<td align="center">2.6 m</td>
<td align="center">45.9 m</td>
<td align="center">2.6 m</td>
<td align="center">119.3 m</td>
</tr>
<tr>
<td align="center"/>
<td align="center">200 K</td>
<td align="center">111.8 m</td>
<td align="center">7.1 m</td>
<td align="center">56.2 m</td>
<td align="center">2.7 m</td>
<td align="center">177.8 m</td>
</tr>
<tr>
<td align="left"><bold><italic>Intermediate</italic></bold></td>
<td align="center">50 K</td>
<td align="center">8.2 m</td>
<td align="center">0.2 m</td>
<td align="center">19.7 m</td>
<td align="center">0.6 m</td>
<td align="center">28.7 m</td>
</tr>
<tr>
<td align="center"/>
<td align="center">100 K</td>
<td align="center">26.2 m</td>
<td align="center">0.8 m</td>
<td align="center">22.5 m</td>
<td align="center">1.4 m</td>
<td align="center">50.9 m</td>
</tr>
<tr>
<td align="center"/>
<td align="center">150 K</td>
<td align="center">55.3 m</td>
<td align="center">2.4 m</td>
<td align="center">24.9 m</td>
<td align="center">1.9 m</td>
<td align="center">84.5 m</td>
</tr>
<tr>
<td align="center"/>
<td align="center">200 K</td>
<td align="center">96.8 m</td>
<td align="center">5.6 m</td>
<td align="center">24.5 m</td>
<td align="center">2.8 m</td>
<td align="center">129.7 m</td>
</tr>
<tr>
<td align="left"><bold><italic>Low</italic></bold></td>
<td align="center">50 K</td>
<td align="center">6.3 m</td>
<td align="center">0.3 m</td>
<td align="center">7.1 m</td>
<td align="center">0.6 m</td>
<td align="center">14.3 m</td>
</tr>
<tr>
<td align="center"/>
<td align="center">100 K</td>
<td align="center">19.4 m</td>
<td align="center">1.4 m</td>
<td align="center">16.9 m</td>
<td align="center">1.2 m</td>
<td align="center">38.9 m</td>
</tr>
<tr>
<td align="center"/>
<td align="center">150 K</td>
<td align="center">41.1 m</td>
<td align="center">4.2 m</td>
<td align="center">18.5 m</td>
<td align="center">1.8 m</td>
<td align="center">65.6 m</td>
</tr>
<tr>
<td align="center"/>
<td align="center">200 K</td>
<td align="center">68 m</td>
<td align="center">9.1 m</td>
<td align="center">20.2 m</td>
<td align="center">2.4 m</td>
<td align="center">99.7 m</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p><sup>a</sup> measured using one application node and 10 cluster nodes, each equipped with a single quad-core Intel(R) Xeon(R) CPU E3-1270 v3 @ 3.50GHz and 32 GB of RAM.</p></fn>
<fn id="t001fn002"><p><sup>b</sup> This includes running time required at the steps of dereplication and <italic>k-mer threshold determination</italic>.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec013">
<title>Evaluation of <italic>k</italic>-mer transformation approach</title>
<p>To evaluate whether implementation of <italic>k</italic>-mer transformation improved clustering efficiency in terms of running time and memory usage, we analyzed 100K sequence datasets (<italic>high</italic>-, <italic>intermediate</italic>- and <italic>low</italic>-complexity) using CLUSTOM-CLOUD <italic>with</italic>- and <italic>without k-mer transformation method</italic>. In this exercise, we avoided sequence dereplication that significantly influences the <italic>k</italic>-mer distance calculation time. Tests were conducted three times for each dataset on the small computer cluster in the lab.</p>
</sec>
<sec id="sec014">
<title>Speed performance evaluation in the small computer cluster in the lab</title>
<p>To evaluate the speed of CLUSTOM-CLOUD in clustering sequence datasets exhibiting <italic>high</italic>, <italic>intermediate</italic>, and <italic>low</italic> microbial complexity, we measured the running time and memory usage for analyzing 50 K, 100 K, 150 K, and 200 K samples by repeating three times per each dataset. All experiments were conducted using the small computer cluster in the lab. Since running time also depends on genetic distance thresholds and other program options, we used 3% dissimilarity threshold, which is regarded as standard to resolve species [<xref ref-type="bibr" rid="pone.0151064.ref007">7</xref>, <xref ref-type="bibr" rid="pone.0151064.ref026">26</xref>], and other default options. Even though a global threshold may not appropriately and accurately delimit different OTUs, the 3% dissimilarity of 16S sequences is the most conventional threshold in the fields of molecular-sequence based microbial ecology. So, the adoption of a single threshold is not problematic in evaluating the performance of CLUSTOM-CLOUD under the given computing environment.</p>
</sec>
<sec id="sec015">
<title>Speed performance evaluation under the cloud-computing environment</title>
<p>To evaluate the speed performance and scalability of CLUSTOM-CLOUD in analyzing large amount of sequence data, we measured the running time for processing one million reads using Amazon EC2 clusters consisting of one <italic>Application</italic> unit and 20, 30, and 40 <italic>Cluster Nodes</italic>. All tests were performed under default options and a distance threshold of 3%.</p>
</sec>
<sec id="sec016">
<title>Running time comparison to CLUSTOM</title>
<p>CLUSTOM was optimized for parallel processing in a single node. In turn, CLUSTOM-CLOUD is designed to operate under distributed computing environment based on IMDG data structure. Therefore, performance of CLUSTOM-CLOUD deteriorated in a single node likely caused by network overhead to connect IMDG. To provide a realistic assessment of CLUSTOM-CLOUD performance relative to CLUSTOM, we developed a new Java-based version of CLUSTOM (CLUSTOM-J) optimized for parallel processing in a single node and identical to the implementation of CLUSTOM-CLOUD except that it did not use the IMDG data structure. To evaluate clustering performance between CLUSTOM-J and CLUSTOM, we measured the running time for analyzing 100 K sequences extracted from each of the three datasets (<italic>high</italic>, <italic>intermediate</italic>, and <italic>low</italic>) using the single node under default options and distance threshold of 3%. Since CLUSTOM can only be executed under Linux environment installed with GCC 4.1.2 or an earlier version, we prepared a single computing node equipped with 64-core AMD Opteron 2.3GHz processor and 256 GB of ECC RAM.</p>
</sec>
<sec id="sec017">
<title>Implementation</title>
<p>CLUSTOM-CLOUD is implemented in Java (ver. 1.7). Hazelcast (ver. 3.3.5) (<ext-link ext-link-type="uri" xlink:href="http://hazelcast.com/" xlink:type="simple">http://hazelcast.com</ext-link>) was used to implement the distributed processing system based on IMDG and to support platform independence and various computing environments. The program is composed of two executables for IMDG: <italic>Cluster</italic> and <italic>Application</italic>. Input to CLUSTOM-CLOUD is a FASTA file of 16S rRNA sequences and an XML configuration file (see <xref ref-type="supplementary-material" rid="pone.0151064.s003">S1 Text</xref>) that includes the IP addresses of <italic>Cluster Nodes</italic>, data size for allocation, and number of threads per node. All the details of computing system requirements, installation and configuration that are necessary for running CLUSTOM-CLOUD can be found in <xref ref-type="supplementary-material" rid="pone.0151064.s004">S2 Text</xref>. Output is three files, similar to CLUSTOM: (i) sequences per OTU (FASTA), (ii) the representative sequences of OTUs (FASTA), and (iii) the number of sequences per OTU (plain text). CLUSTOM-CLOUD and its user guide are freely available at <ext-link ext-link-type="uri" xlink:href="http://clustomcloud.kopri.re.kr/" xlink:type="simple">http://clustomcloud.kopri.re.kr</ext-link>.</p>
</sec>
<sec id="sec018">
<title>Clustering accuracy evaluation</title>
<p>In order to compare the clustering accuracy of existing programs against CLUSTOM-CLOUD, we prepared a mock community sequence dataset. We first retrieved 16S rRNA pyrosequences of a mock community that was constructed by pooled DNA of 21 human-associated prokaryotic strains with even concentration (SRR072219 download on December 28, 2015). Tags and low-quality reads were trimmed out using PyroTrimmer [<xref ref-type="bibr" rid="pone.0151064.ref002">2</xref>] prior to sequence clustering. The V1-3 region of sequences was extracted using an in-house script. Next, individual sequences were BLASTn-searched against the dataset of [<xref ref-type="bibr" rid="pone.0151064.ref027">27</xref>] containing 16S sequences of the 21 strains. Taxonomic information of the top BLAST hits was then assigned to the corresponding query sequences. From 35,106 sequences with taxonomic information, 10 K sequences (hereafter HMP-Mock-community, average length = 439 bp, standard deviation = 46) were randomly extracted and clustered using CLUSTOM-CLOUD, CLUSTOM, DOTUR-AL-PSA (AL = average-linkage; PSA = pairwise sequence alignment), ESPRIT-Tree, mothur-AL-MSA (MSA = multiple sequence alignment), mothur-AL-PSA, UCLUST and Swarm. In case of Swarm, two different distance thresholds (<italic>d</italic> = 1 and 3) were used in clustering while the remaining programs were ran using 3% (species-like) and 5% (genus-like) conventional thresholds. Specifically, UPARSE that discards singletons by default may result in the elimination of rare OTUs followed by distortion of natural microbial community [<xref ref-type="bibr" rid="pone.0151064.ref028">28</xref>, <xref ref-type="bibr" rid="pone.0151064.ref029">29</xref>]. Since low abundance taxa sometimes play important roles in certain environments, they should be retained in evaluating the clustering accuracy of programs. Therefore, we used UCLUST in this comparative exercise that is the previous version of UPARSE and still produces singletons in its clustering results. We then evaluated the clustering accuracy of individual programs by counting how many pairs of sequences were correctly clustered. Each of the possible sequence pairs were assigned to one of the four different status categories: true positive (TP), false positive (FP), true negative (TN) and false negative (FN). Sequence pairs derived from the same strain and clustered together in a single OTU were regarded as TP. Sequence pairs clustered in an OTU but originated from different strains were regarded FPs. Sequence pairs originated from the same strain but belonging to different OTUs were FNs. While, the remaining sequence pairs were regarded as TNs. We then calculated precision TP/ (TP+FP) and recall TP/ (TP+FN). Consequently, precision increased when the OTUs included greater number of sequences derived from same strain while the recall decreased when the sequences from a single strain were more evenly distributed in different OTUs. The harmonic mean of the precision and recall was computed using formula of F-measure II (<italic>F</italic><sub><italic>2</italic></sub>) [<xref ref-type="bibr" rid="pone.0151064.ref030">30</xref>].</p>
</sec>
</sec>
<sec id="sec019" sec-type="results">
<title>Results</title>
<sec id="sec020">
<title>Determination of optimal granularity</title>
<p>Determining optimal granularity is critical for the success of each algorithm in parallel and distributed computing. Here, granularity refers to the optimal number of sequence pairs to be compared by each <italic>Cluster Node</italic> and was determined by repeatedly assigning 1 K, 1.5 K, 2 K, 2.5 K, and 3 K sequence pairs from 100 K <italic>high</italic>-complexity dataset to 5 and 10 nodes (<xref ref-type="supplementary-material" rid="pone.0151064.s002">S2 Fig</xref>). The computational time required for calculation of <italic>k</italic>-mer and NW distances was then compared to determine the optimal number of sequence pairs and nodes required for maximum performance. The experiment revealed that distance calculation for 2 K sequence pairs required minimum processing time in either 5 (~5,500 seconds) or 10 nodes (3,300 seconds). In turn, calculation time increased considerably when the number of sequence pairs was reduced below 2 K (~7,300 and 5,900 seconds for 5 nodes and ~3,500 and 3,400 seconds for 10 nodes), likely caused by communication overhead. Similar patterns were observed when the number of sequence pairs was increased to either 2.5 K (6,160 seconds in 5 nodes and 3,660 for 10) or 3 K (5,700 and 4,350), resulting in extra running time likely caused by low computation-to-communication ratio. In other words, merging the processed results for a larger number of sequence pairs after the completion of each task required more communication time than merging results from smaller datasets. Therefore, we selected 2 K sequence pairs as the optimal granularity in the distributed task of CLUSTOM-CLOUD, which is set as the default option but can be customized by users.</p>
</sec>
<sec id="sec021">
<title><italic>k</italic>-mer transformation utilized less memory and enabled faster execution</title>
<p>We assessed the running time (minutes) and memory usage (MB) by processing 100 K sequences in consideration of both cases of <italic>with</italic>- and <italic>without the k-mer transformation method</italic> (<xref ref-type="fig" rid="pone.0151064.g005">Fig 5</xref>). The 100 K datasets of <italic>high</italic>-, <italic>intermediate</italic>- and <italic>low</italic>-complexity were prepared from the 454-HMP data. This sampling was repeated twice independently. Each of the six datasets was analyzed three times. For this exercise, sequence dereplication was not conducted because it significantly influenced the <italic>k</italic>-mer distance calculation time. The exercise revealed that using the <italic>k</italic>-mer transformation required approximately 42.8 (42.6 in the second sampling), 42.4 (41.9), and 43.5 (45.1) minutes of running time (<xref ref-type="fig" rid="pone.0151064.g005">Fig 5B</xref>) and approximately 385 (387), 413 (409), and 465 (454) MB of memory in decreasing order of dataset complexity (<xref ref-type="fig" rid="pone.0151064.g005">Fig 5A</xref>). In turn, the running time without implementing the <italic>k</italic>-mer transformation was approximately 113.7 (113.2), 120.9 (120.7), and 131.3 (131.1) minutes respectively (<xref ref-type="fig" rid="pone.0151064.g005">Fig 5B</xref>), and memory usage was approximately 531.2 (530.8), 544.2 (544.9), and 555.2 (555.7) MB, respectively (<xref ref-type="fig" rid="pone.0151064.g005">Fig 5A</xref>). Therefore, <italic>k</italic>-mer transformation significantly decreased both running time (by at least two-fold) and memory usage (down by 16–27%). Importantly, <italic>k</italic>-mer transformation was largely neutral to dataset complexity, as relatively similar time and memory storage were required for processing data from each of the three complexity datasets. Strictly, the result revealed that decreasing data complexity required slightly more memory and running time (<xref ref-type="fig" rid="pone.0151064.g005">Fig 5A and 5B</xref>). In fact, this is not a surprising trend in both CLUSTOM and CLUSTOM-CLOUD. The sequence datasets of the <italic>low</italic> complexity include larger number of nearly identical 16S sequences than the datasets of either <italic>intermediate</italic> or <italic>high</italic> complexities. Consequently, increasing the number of highly similar sequences results in increasing the number of sequence pairs that satisfy the <italic>k</italic>-mer distance threshold (e.g., conventionally 3% dissimilarity of 16S sequences). Since the selected sequence pairs should be loaded to the RAM, the <italic>low</italic> complexity data requires more memory and running time than the other datasets. In short, <italic>k</italic>-mer transformation feature is a useful add-on in CLUSTOM-CLOUD that enables at least two-fold decrease in processing time while utilizing significantly less memory.</p>
<fig id="pone.0151064.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0151064.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Running time and memory usage evaluation of the <italic>k</italic>-mer transformation method.</title>
<p>Comparison of the memory usage (A) and running time (B) were performed with and without <italic>k</italic>-mer transformation method only at the <italic>k</italic>-mer distance calculation step. Two of 100K 16S sequences were independently and randomly extracted from the sequence datasets of <italic>high</italic>-, <italic>intermediate</italic>- and <italic>low</italic>-complexity. For each of the six different sequence datasets, the running time and memory usage were measured three times independently.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec022">
<title>Clustering speed performance is indifferent to the nature of dataset</title>
<p>We compared the performance of CLUSTOM-CLOUD in processing 50 K, 100 K, 150 K, and 200 K reads randomly extracted from the <italic>high</italic>-, <italic>intermediate</italic>-, and <italic>low</italic>-complexity datasets. The analysis revealed that running time was primarily determined by the size of the input dataset (as expected) and was secondary to sample’s complexity (<xref ref-type="fig" rid="pone.0151064.g006">Fig 6</xref>). For example, processing time for smaller datasets (e.g., 50 K and 100 K) from each of the three complexity classes did not differ significantly. However, running time gap widened significantly when the number of input reads was increased to either 150 K or 200 K (<xref ref-type="fig" rid="pone.0151064.g006">Fig 6B</xref>). Because high-complexity datasets possess fewer duplicates, additional time is required to calculate <italic>k</italic>-mer and NW distances, resulting in extra processing time (<xref ref-type="table" rid="pone.0151064.t001">Table 1</xref>). In turn, memory usage was largely indifferent to the complexity of microbial diversity and was only dependent on the number of input sequence reads (<xref ref-type="fig" rid="pone.0151064.g006">Fig 6A</xref>). Because CLUSTOM-CLOUD allocates a certain amount of total memory in advance to improve performance, memory usage was nearly consistent at ~10 GB per node for 100 K, 150 K, and 200 K samples (<xref ref-type="fig" rid="pone.0151064.g006">Fig 6A</xref>).</p>
<fig id="pone.0151064.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0151064.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Running time of the whole process according to the complexity of the microbial diversity.</title>
<p>Running time (A) and memory usage (B) of CLUSTOM-CLOUD were measured by analyzing 50 K, 100 K, 150 K, and 200 K sequences in <italic>high</italic>-, <italic>intermediate</italic>-, and <italic>low</italic>-complexity datasets (3% distance threshold). The measures were repeated three times per dataset and the average values are plotted.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec023">
<title>Cloud-computing performance in Amazon EC2</title>
<p>To evaluate the performance and scalability of CLUSTOM-CLOUD, we performed separate experiments using 20, 30, and 40 EC2 High-Memory Extra Large Instance <italic>Cluster Nodes</italic> (plus one High-CPU Extra Large Instance node of <italic>Application</italic>) for one million sequences. <xref ref-type="table" rid="pone.0151064.t002">Table 2</xref> shows the wall-clock running time for each experiment. Remarkably, CLUSTOM-CLOUD is capable of clustering one million reads in less than 12 hours of wall-clock time using 40 <italic>Cluster Nodes</italic> despite the polynomial complexity <italic>O(N</italic><sup><italic>2</italic></sup><italic>)</italic> of the <italic>k</italic>-mer distance calculation step. The running time of CLUSTOM-CLOUD on 160 cores of the EC2 cluster was approximately two-fold faster than 80 cores of the EC2 cluster, indicating high scalability with the increasing number of cores. Typically, distributed and parallel computing systems exhibit sub-linear growth in speed with increasing numbers of cores. Although CLUSTOM-CLOUD shows a similar sub-linear performance growth, the deviation is very slight. It implies that CLUSTOM-CLOUD is relatively more effective for distributed and parallel processing. To summarize, CLUSTOM-CLOUD can rapidly and stably cluster a large number of sequences under the cloud-computing environment.</p>
<table-wrap id="pone.0151064.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0151064.t002</object-id>
<label>Table 2</label> <caption><title>Time and cost of running one million reads on CLUSTOM-CLOUD.</title></caption>
<alternatives>
<graphic id="pone.0151064.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">EC2 nodes</th>
<th align="left">1 app<xref ref-type="table-fn" rid="t002fn001"><sup>a</sup></xref>, 20 clusters<xref ref-type="table-fn" rid="t002fn002"><sup>b</sup></xref></th>
<th align="left">1 app<xref ref-type="table-fn" rid="t002fn001"><sup>a</sup></xref>, 30 clusters<xref ref-type="table-fn" rid="t002fn002"><sup>b</sup></xref></th>
<th align="left">1 app<xref ref-type="table-fn" rid="t002fn001"><sup>a</sup></xref>, 40 clusters<xref ref-type="table-fn" rid="t002fn002"><sup>b</sup></xref></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>Processor cores</bold></td>
<td align="left">80</td>
<td align="left">120</td>
<td align="left">160</td>
</tr>
<tr>
<td align="left"><bold>Wall clock time</bold></td>
<td align="left">20 h:38 m</td>
<td align="left">14 h:05 m</td>
<td align="left">11 h:34 m</td>
</tr>
<tr>
<td align="justify"><bold>Cluster setup time</bold></td>
<td align="left">5 m</td>
<td align="left">5 m</td>
<td align="left">5 m</td>
</tr>
<tr>
<td align="left"><bold>Reads uploading time</bold></td>
<td align="left">36 m</td>
<td align="left">36 m</td>
<td align="left">36 m</td>
</tr>
<tr>
<td align="left"><bold><italic>k</italic>-mer distance calculation time</bold></td>
<td align="left">16 h:34 m</td>
<td align="left">11 h:03 m</td>
<td align="left">8 h:50 m</td>
</tr>
<tr>
<td align="left"><bold>Initial cluster determination time</bold></td>
<td align="left">55 m</td>
<td align="left">27 m</td>
<td align="left">25 m</td>
</tr>
<tr>
<td align="left"><bold>NW distance calculation time</bold></td>
<td align="left">2 h:11 m</td>
<td align="left">1 h:38 m</td>
<td align="left">1 h:22 m</td>
</tr>
<tr>
<td align="left"><bold>Final cluster determination time</bold></td>
<td align="left">17 m</td>
<td align="left">16 m</td>
<td align="left">16 m</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p><sup>a</sup> specification of an application node in Amazon EC2 is c3.8xlarge.</p></fn>
<fn id="t002fn002"><p><sup>b</sup> specification of a cluster node in Amazon EC2 is c4.2xlarge.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec024">
<title>CLUSTOM-CLOUD can be up to five times faster than CLUSTOM</title>
<p>We compared the running time (minutes) difference between CLUSTOM and CLUSTOM-J for analyzing 100 K sequences extracted from <italic>high</italic>-, <italic>intermediate</italic>-, and low-complexity datasets in a single node. CLUSTOM-J using 20 CPU cores required ~207, 120, and 79 minutes for <italic>high</italic>, <italic>intermediate</italic>, and <italic>low</italic> datasets respectively. In turn, CLUSTOM under similar conditions required ~ 237, 378, and 407 minutes respectively. For all experiments, CLUSTOM-J was much faster than CLUSTOM despite the difference in programming language (Java versus C). Remarkably, CLUSTOM-J was about five times faster than CLUSTOM in processing the <italic>low</italic> complexity dataset. The experiment indicated that implementation of IMDG and its additional enhancements in CLUSTOM-CLOUD significantly improved the overall clustering performance of CLUSTOM.</p>
</sec>
<sec id="sec025">
<title>Comparative exercise on the clustering accuracy</title>
<p>Comparative analysis using HMP-Mock-community was performed to evaluate the clustering accuracy of CLUSTOM-CLOUD with other programs. We ran CLUSTOM, CLUSTOM-CLOUD, DOTUR-AL-PSA, ESPRIT-Tree, mothur-AL-PSA, mothur-AL-MSA and UCLUST using 3% and 5% conventional distance thresholds that likely correspond to the taxonomic levels of species and genus, respectively. As mentioned in Methods, we used distance value (<italic>d</italic>) of 1 and 3 to cluster sequences using Swarm. The clustering results revealed that the number of OTUs determined by individual programs varied. For example, CLUSTOM-CLOUD produced 97 and 49 OTUs at 3% and 5%, respectively. Other programs produces OTUs as follows: CLUSTOM (65 and 30 at 3% and 5%, respectively), DOTUR-AL-PSA (125 and 52 at 3% and 5%), ESPRIT-Tree (300 and 145 at 3% and 5%), mothur-AL-MSA (356 and 217 at 3% and 5%), mothur-AL-PSA (150 and 60 at 3% and 5%) and UCLUST (454 and 226 at 3% and 5%). The number of OTUs determined by Swarm with <italic>d</italic> = 1 (3,579) was larger than 2,473 OTUs with <italic>d</italic> = 3. Consequently, the average-linkage-based clustering algorithms (CLUSTOM, CLUSTOM-CLOUD, DOTUR-AL-PSA, mothur-AL-PSA and mothur-AL-MSA) produced smaller number of OTUs than UCLUST (greedy-heuristic) and Swarm (single-linkage hierarchical clustering). The accuracy test revealed that the precision values of all the programs reached 100% nearly or completely (<xref ref-type="fig" rid="pone.0151064.g007">Fig 7</xref>). On the other hand, the recall accuracy of the programs largely varied. For example, the recall values of Swarm (36% at <italic>d</italic> = 1 and 52% at <italic>d</italic> = 3, respectively) and UCLUST (42% and 53% at 3% and 5%, respectively) were significant lower than those of other programs. The recall values in details are as follows: CLUSTOM-CLOUD (95% and 99% at 3% and 5%), CLUSTOM (96% and 98% at 3% and 5%, respectively), DOTUR-AL-PSA (90% and 96% at 3% and 5%), ESPRIT-Tree (83% and 85% at 3% and 5%), mothur-AL-MSA (86% and 88% at 3% and 5%) and mothur-AL-PSA (89% and 96% at 3% and 5%). Consequently, the harmonic means, <italic>F</italic><sub><italic>2</italic></sub> values, show that both CLUSTOM-CLOUD and CLUSTOM are accurate relative to the other average-linkage based hierarchical clustering programs and significantly more accurate than greedy-heuristic clustering (UCLUST) and single-linkage hierarchical clustering (Swarm) programs.</p>
<fig id="pone.0151064.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0151064.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Comparative accuracy test of existing clustering programs.</title>
<p>The clustering accuracy of CLUSTOM, CLUSTOM-CLOUD, DOTUR-AL-PSA, ESPRIT-Tree, mothur-AL-PSA, mothur-AL-MSA, UCLUST and Swarm was performed based on 16S rRNA pyrosequences of a mock community that was constructed by pooled DNA of 21 human-associated prokaryotic strains with even concentration (HMP-Mock-community). The precision and recall metrics as well as their <italic>F</italic><sub><italic>2</italic></sub> values were used to compare the clustering accuracy of the eight programs at the species (A) and genus (B) levels.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.g007" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec026" sec-type="conclusions">
<title>Discussion</title>
<p>We present CLUSTOM-CLOUD, a distributed clustering program that can efficiently and accurately cluster 16S sequences under distributed and cloud-computing environments. CLUSTOM-CLOUD is a significant upgrade to its predecessor, CLUSTOM. The enhancements include: (i) implementation of <italic>k</italic>-mer transformation, (ii) removal of duplicate sequences (dereplication), and importantly (iii) the implementation of IMDG technology to store data directly into RAM rather than hard disks of individual nodes. Importantly, CLUSTOM-CLOUD inherits the high accuracy of its ancestor CLUSTOM, as also confirmed by the comparative exercise (<xref ref-type="fig" rid="pone.0151064.g007">Fig 7</xref>). The <italic>k</italic>-mer transformation helps to reduce the <italic>k</italic>-mer distance calculation time during <italic>initial clustering</italic>. Since all <italic>k</italic>-mer strings are transformed into small-byte numerical values using hash map, this implementation significantly reduced both the running time (twice as fast) and memory utilization (down by 16–27%) relative to implementation without <italic>k</italic>-mer transformation (<xref ref-type="fig" rid="pone.0151064.g005">Fig 5</xref>). Consequently, <italic>k</italic>-mer transformation method is a useful add-on to calculate <italic>k</italic>-mer distances for datasets. In turn, duplicates are important to determine the initial and final clusters but are not required during other steps of processing. Therefore, CLUSTOM-CLOUD removes duplicates before loading data into <italic>Cluster Nodes</italic> and recovers them later for cluster determination. In contrast, duplicates were part of the entire clustering process in CLUSTOM, costing more computational time and resources. Both features confer ~5 times faster execution in CLUSTOM-CLOUD relative to CLUSTOM. Finally, compared to other commonly used existing distributed computing technologies such as MPI and MapReduce of Hadoop, IMDG provides parallel and distributed computing using in-memory storage to allow rapid processing of sequence datasets and relatively convenient execution. By using IMDG technology, CLUSTOM-CLOUD supports various computing environments including cloud computing with relatively easier installation and configuration steps than the other distributed and cloud-computing programs. These considerations identify the IMDG-based distributed computing architecture of CLUSTOM-CLOUD as a better alternative to either MPI or MapReduce of Hadoop.</p>
<p>To assess the running time of CLUSTOM-CLOUD, we analyzed randomly sampled 454-HMP datasets of various sizes exhibiting <italic>high</italic>, <italic>intermediate</italic>, and <italic>low</italic> microbial complexity. Processing 200 K reads from each dataset required only between 100 and 178 minutes when ran on a small laboratory computer cluster with 10 nodes (<xref ref-type="table" rid="pone.0151064.t001">Table 1</xref>). This indicates that CLUSTOM-CLOUD is still useful to cluster hundreds of thousands of 16S sequences without the need for expensive high-performance machines, although greedy-heuristic or single-linkage based programs such as UCLUST and Swarm require significantly less computing resources. To demonstrate the scalability of CLUSTOM-CLOUD, we analyzed one million sequences using 20, 30, and 40 nodes on Amazon EC2 that required ~20, 14, and 11 hours, respectively (<xref ref-type="table" rid="pone.0151064.t002">Table 2</xref>). This represents how CLUSTOM-CLOUD shows substantial improvement in running time by the addition of computing nodes indicating high scalability. Moreover, millions of sequences can be analyzed under the cloud-computing environment (e.g., Amazon EC2) supported by CLUSTOM-CLOUD.</p>
<p>Different factors influence the speed performance of CLUSTOM-CLOUD. As expected, the amount of input data is directly related to running time (<xref ref-type="fig" rid="pone.0151064.g006">Fig 6B</xref>). Running time also increases for datasets exhibiting high complexity, especially for large datasets (<xref ref-type="fig" rid="pone.0151064.g006">Fig 6</xref>). This is largely due to the presence of fewer duplicates in high-complexity datasets [<xref ref-type="bibr" rid="pone.0151064.ref021">21</xref>] that require additional computation time in calculating <italic>k</italic>-mer and NW distances. For example, running time for small datasets (below 100 K) was not significantly different. However, for larger datasets (e.g., 150 K and 200 K), processing time for the <italic>low</italic>-complexity dataset was ~1.3–1.8 times faster than for the <italic>intermediate</italic> and <italic>high</italic> datasets. Since IMDG allows us to rapidly access and process data in the shared memory pool, overall performance is greatly affected by the network environment. A network with high stability and over 1 Gigabit speed is therefore recommended for superior performance. Finally, parallel processing in the <italic>Application</italic> node is used as default to determine the initial and final clusters. Therefore, equipping the <italic>Application</italic> node with extra cores will directly increase performance.</p>
<p>The relationship between accuracy and computational complexity is a trade-off in all algorithms and CLUSTOM-CLOUD is no different. Although CUSTOM-CLOUD significantly reduces memory usage and running time of CLUSTOM through dereplication and <italic>k</italic>-mer transformation methods, it is slower than greedy heuristic based clustering algorithms (actual needs of computing resources and speed) because its computational complexity is quadratic. However, as shown in <xref ref-type="fig" rid="pone.0151064.g007">Fig 7</xref>, the average-linkage based hierarchical clustering methods show accurate results compared to the greedy heuristic clustering algorithm such as UCLUST. Among clustering methods, CLUSTOM and CLUSTOM-CLOUD exhibited the highest accuracy rate than any other program. Swarm that is based on single-linkage hierarchical clustering achieves clustering accuracy similar to UCLUST. In fact, the previous study of Swarm showed that it performed robustly regardless of the value <italic>d</italic> [<xref ref-type="bibr" rid="pone.0151064.ref012">12</xref>]. Therefore, it is hard to expect that the accuracy of Swarm increases by adjusting the <italic>d</italic> values. Although applying a breaking phase helps Swarm delimit the natural limit of OTUs, it still seems to suffer from the chain reaction problem of the single-linkage hierarchical clustering methods. However, the result of the comparative accuracy test may differ depending on alignment quality, distance calculation method, sequencing filtering, the selected region of 16S sequence, sequencing platforms, clustering distance thresholds and metrics for measuring the accuracy. Therefore, it is further necessary to conduct more comprehensive and precise experiments on the evaluation of the clustering algorithms.</p>
<p>In conclusion, CLUSTOM-CLOUD is limited to relatively smaller datasets and is slower than ultrafast sequence clustering programs such as UCLUST and Swarm. However, it outperforms several other accurate clustering alternatives such as CLUSTOM, DOTUR-AL-PSA, mothur-AL-PSA and mothur-AL-MSA in terms of computational speed and handling of relatively larger datasets. Therefore, CLUSTOM-CLOUD is a good alternative to rapidly and accurately cluster large 16 rRNA sequences that cannot be handled by several other accurate clustering programs. It also becomes the ideal algorithm to implement when the laboratory has the infrastructure of many small computers that can be better utilized as distributed computing system. Although RAM is more expensive than hard disk, its cost is consistently declining. Therefore, in-memory computing technology such as IMDG provides a promising and reliable solution for the rapid analysis of biological data. To our knowledge, the present study is the first application of IMDG in bioinformatics. Its successful integration into CLUSTOM resulted in significant performance improvement and speedier execution. Evolution of CLUSTOM into CLUSTOM-CLOUD potentially serves as a starting point to consider the broader use of IMDG-based technologies in life sciences.</p>
</sec>
<sec id="sec027">
<title>Supporting Information</title>
<supplementary-material id="pone.0151064.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Classification of human microbiome datasets according to microbial complexity.</title>
<p>16S rRNA sequence data from 18 human body sites was analyzed for richness and evenness. Sampling sites were pooled into <italic>high</italic> (rectangle), <italic>intermediate</italic> (circle), and <italic>low</italic> (triangle) complexity datasets.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0151064.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Determination of optimal granularity.</title>
<p>Running time analysis for distributing different number of sequence pairs to 5 and 10 cluster nodes.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0151064.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.s003" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>XML configuration file example and description.</title>
<p>The properties of CLUSTOM-CLOUD application are defined into “clustom.xml” file.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0151064.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0151064.s004" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>The CLUSTOM-CLOUD manual.</title>
<p>The introduction, system requirements, configuration and usage are described.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank two anonymous reviewers for their invaluable comments, which helped to improve this paper significantly.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0151064.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peterson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Garges</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Giovanni</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>McInnes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Schloss</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>The NIH human microbiome project</article-title>. <source>Genome research</source>. <year>2009</year>;<volume>19</volume>(<issue>12</issue>):<fpage>2317</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.096651.109" xlink:type="simple">10.1101/gr.096651.109</ext-link></comment> <object-id pub-id-type="pmid">19819907</object-id></mixed-citation></ref>
<ref id="pone.0151064.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oh</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Cho</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Hong</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>KM</given-names></name>. <article-title>PyroTrimmer: a software with GUI for pre-processing 454 amplicon sequences</article-title>. <source>J Microbiol</source>. <year>2012</year>;<volume>50</volume>(<issue>5</issue>):<fpage>766</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s12275-012-2494-6" xlink:type="simple">10.1007/s12275-012-2494-6</ext-link></comment> <object-id pub-id-type="pmid">23124743</object-id>.</mixed-citation></ref>
<ref id="pone.0151064.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hill</surname> <given-names>MO</given-names></name>. <article-title>Diversity and evenness: a unifying notation and its consequences</article-title>. <source>Ecology</source>. <year>1973</year>;<volume>54</volume>(<issue>2</issue>):<fpage>427</fpage>–<lpage>32</lpage>.</mixed-citation></ref>
<ref id="pone.0151064.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tuomisto</surname> <given-names>H</given-names></name>. <article-title>A consistent terminology for quantifying species diversity? Yes, it does exist</article-title>. <source>Oecologia</source>. <year>2010</year>;<volume>164</volume>(<issue>4</issue>):<fpage>853</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00442-010-1812-0" xlink:type="simple">10.1007/s00442-010-1812-0</ext-link></comment> <object-id pub-id-type="pmid">20978798</object-id></mixed-citation></ref>
<ref id="pone.0151064.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>H</given-names></name>. <article-title>A comparison of methods for clustering 16S rRNA sequences into OTUs</article-title>. <source>PloS one</source>. <year>2013</year>;<volume>8</volume>(<issue>8</issue>):<fpage>e70837</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0070837" xlink:type="simple">10.1371/journal.pone.0070837</ext-link></comment> <object-id pub-id-type="pmid">23967117</object-id>; PubMed Central PMCID: PMC3742672.</mixed-citation></ref>
<ref id="pone.0151064.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schloss</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Handelsman</surname> <given-names>J</given-names></name>. <article-title>Introducing DOTUR, a computer program for defining operational taxonomic units and estimating species richness</article-title>. <source>Applied and environmental microbiology</source>. <year>2005</year>;<volume>71</volume>(<issue>3</issue>):<fpage>1501</fpage>–<lpage>6</lpage>. <object-id pub-id-type="pmid">15746353</object-id></mixed-citation></ref>
<ref id="pone.0151064.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Cai</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Farrell</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>McKendree</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>ESPRIT: estimating species richness using large collections of 16S rRNA pyrosequences</article-title>. <source>Nucleic acids research</source>. <year>2009</year>;<volume>37</volume>(<issue>10</issue>):<fpage>e76</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkp285" xlink:type="simple">10.1093/nar/gkp285</ext-link></comment> <object-id pub-id-type="pmid">19417062</object-id>; PubMed Central PMCID: PMC2691849.</mixed-citation></ref>
<ref id="pone.0151064.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Godzik</surname> <given-names>A</given-names></name>. <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1658</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl158" xlink:type="simple">10.1093/bioinformatics/btl158</ext-link></comment> <object-id pub-id-type="pmid">16731699</object-id>.</mixed-citation></ref>
<ref id="pone.0151064.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>19</issue>):<fpage>2460</fpage>–<lpage>1</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq461" xlink:type="simple">10.1093/bioinformatics/btq461</ext-link></comment> <object-id pub-id-type="pmid">20709691</object-id>.</mixed-citation></ref>
<ref id="pone.0151064.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schloss</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Westcott</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Ryabin</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Hartmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hollister</surname> <given-names>EB</given-names></name>, <etal>et al</etal>. <article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>. <source>Appl Environ Microbiol</source>. <year>2009</year>;<volume>75</volume>(<issue>23</issue>):<fpage>7537</fpage>–<lpage>41</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/AEM.01541-09" xlink:type="simple">10.1128/AEM.01541-09</ext-link></comment> <object-id pub-id-type="pmid">19801464</object-id>; PubMed Central PMCID: PMC2786419.</mixed-citation></ref>
<ref id="pone.0151064.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hwang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Oh</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Hou</surname> <given-names>BK</given-names></name>, <etal>et al</etal>. <article-title>CLUSTOM: a novel method for clustering 16S rRNA next generation sequences by overlap minimization</article-title>. <source>PloS one</source>. <year>2013</year>;<volume>8</volume>(<issue>5</issue>):<fpage>e62623</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0062623" xlink:type="simple">10.1371/journal.pone.0062623</ext-link></comment> <object-id pub-id-type="pmid">23650520</object-id>; PubMed Central PMCID: PMC3641076.</mixed-citation></ref>
<ref id="pone.0151064.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mahe</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Rognes</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Quince</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>de Vargas</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Dunthorn</surname> <given-names>M</given-names></name>. <article-title>Swarm: robust and fast clustering method for amplicon-based studies</article-title>. <source>PeerJ</source>. <year>2014</year>;<volume>2</volume>:<fpage>e593</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.7717/peerj.593" xlink:type="simple">10.7717/peerj.593</ext-link></comment> <object-id pub-id-type="pmid">25276506</object-id>; PubMed Central PMCID: PMCPMC4178461.</mixed-citation></ref>
<ref id="pone.0151064.ref013"><label>13</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Barney</surname> <given-names>B</given-names></name>. <source>Message Passing Interface (MPI)</source>: <publisher-name>Lawrence Livermore National Laboratory</publisher-name>; <year>2012</year>. [cited 2015 Feb 04]. Available: <ext-link ext-link-type="uri" xlink:href="https://computing.llnl.gov/tutorials/mpi/" xlink:type="simple">https://computing.llnl.gov/tutorials/mpi/</ext-link>.</mixed-citation></ref>
<ref id="pone.0151064.ref014"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Ekanayake J, Pallickara S, Fox G, editors. Mapreduce for data intensive scientific analyses. eScience, 2008 eScience'08 IEEE Fourth International Conference on; 2008: IEEE.</mixed-citation></ref>
<ref id="pone.0151064.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>K-H</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>Y-J</given-names></name>, <name name-style="western"><surname>Choi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Chung</surname> <given-names>YD</given-names></name>, <name name-style="western"><surname>Moon</surname> <given-names>B</given-names></name>. <article-title>Parallel data processing with MapReduce: a survey</article-title>. <source>AcM sIGMoD Record</source>. <year>2012</year>;<volume>40</volume>(<issue>4</issue>):<fpage>11</fpage>–<lpage>20</lpage>.</mixed-citation></ref>
<ref id="pone.0151064.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Taylor</surname> <given-names>RC</given-names></name>. <article-title>An overview of the Hadoop/MapReduce/HBase framework and its current applications in bioinformatics</article-title>. <source>BMC bioinformatics</source>. <year>2010</year>;<volume>11</volume>(<issue>Suppl 12</issue>):<fpage>S1</fpage>.</mixed-citation></ref>
<ref id="pone.0151064.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kang</surname> <given-names>S-H</given-names></name>, <name name-style="western"><surname>Koo</surname> <given-names>D-H</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>W-H</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>S-W</given-names></name>. <article-title>A case for flash memory ssd in hadoop applications</article-title>. <source>International Journal of Control and Automation</source>. <year>2013</year>;<volume>6</volume>:<fpage>201</fpage>–<lpage>10</lpage>.</mixed-citation></ref>
<ref id="pone.0151064.ref018"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Li B, Mazur E, Diao Y, McGregor A, Shenoy P, editors. A platform for scalable one-pass analytics using MapReduce. Proceedings of the 2011 ACM SIGMOD International Conference on Management of data; 2011: ACM.</mixed-citation></ref>
<ref id="pone.0151064.ref019"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">Mann S. Look out, Big Data: In-memory data grids start to go mainstream. [cited 2016 Feb 4]. Available: <ext-link ext-link-type="uri" xlink:href="http://searchsoa.techtarget.com/feature/Look-out-Big-Data-In-memory-data-grids-start-to-go-mainstream" xlink:type="simple">http://searchsoa.techtarget.com/feature/Look-out-Big-Data-In-memory-data-grids-start-to-go-mainstream</ext-link>.</mixed-citation></ref>
<ref id="pone.0151064.ref020"><label>20</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Johns</surname> <given-names>M</given-names></name>. <source>Getting Started with Hazelcast</source>. <edition>1st ed.</edition> <publisher-name>Packt Publishing Ltd</publisher-name>; <year>2013</year>.</mixed-citation></ref>
<ref id="pone.0151064.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Niu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Fu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>. <article-title>Artificial and natural duplicates in pyrosequencing reads of metagenomic data</article-title>. <source>BMC bioinformatics</source>. <year>2010</year>;<volume>11</volume>(<issue>1</issue>):<fpage>187</fpage>.</mixed-citation></ref>
<ref id="pone.0151064.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dean</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ghemawat</surname> <given-names>S</given-names></name>. <article-title>MapReduce: simplified data processing on large clusters</article-title>. <source>Communications of the ACM</source>. <year>2008</year>;<volume>51</volume>(<issue>1</issue>):<fpage>107</fpage>–<lpage>13</lpage>.</mixed-citation></ref>
<ref id="pone.0151064.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Winkler</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Kleerebezem</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>De Bruin</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Verheijen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Abbas</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Habermacher</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Microbial diversity differences within aerobic granular sludge and activated sludge flocs</article-title>. <source>Applied microbiology and biotechnology</source>. <year>2013</year>;<volume>97</volume>(<issue>16</issue>):<fpage>7447</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00253-012-4472-7" xlink:type="simple">10.1007/s00253-012-4472-7</ext-link></comment> <object-id pub-id-type="pmid">23064482</object-id></mixed-citation></ref>
<ref id="pone.0151064.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Laganà</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Crocchianti</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bolloni</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Piermarini</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Baraglia</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ferrini</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Computational granularity and parallel models to scale up reactive scattering calculations</article-title>. <source>Computer physics communications</source>. <year>2000</year>;<volume>128</volume>(<issue>1</issue>):<fpage>295</fpage>–<lpage>314</lpage>.</mixed-citation></ref>
<ref id="pone.0151064.ref025"><label>25</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Barney</surname> <given-names>B</given-names></name>. <chapter-title>Introduction to parallel computing</chapter-title>: <publisher-name>Lawrence Livermore National Laboratory</publisher-name>; <year>2010</year>. [cited 2016 Feb 4]. Available: <ext-link ext-link-type="uri" xlink:href="https://computing.llnl.gov/tutorials/parallel_comp/?ref=driverlayer.com/web" xlink:type="simple">https://computing.llnl.gov/tutorials/parallel_comp/?ref=driverlayer.com/web</ext-link>.</mixed-citation></ref>
<ref id="pone.0151064.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stackebrandt</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Goebel</surname> <given-names>B</given-names></name>. <article-title>Taxonomic note: a place for DNA-DNA reassociation and 16S rRNA sequence analysis in the present species definition in bacteriology</article-title>. <source>International Journal of Systematic Bacteriology</source>. <year>1994</year>;<volume>44</volume>(<issue>4</issue>):<fpage>846</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pone.0151064.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haas</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Gevers</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Earl</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Feldgarden</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ward</surname> <given-names>DV</given-names></name>, <name name-style="western"><surname>Giannoukos</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Chimeric 16S rRNA sequence formation and detection in Sanger and 454-pyrosequenced PCR amplicons</article-title>. <source>Genome research</source>. <year>2011</year>;<volume>21</volume>(<issue>3</issue>):<fpage>494</fpage>–<lpage>504</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.112730.110" xlink:type="simple">10.1101/gr.112730.110</ext-link></comment> <object-id pub-id-type="pmid">21212162</object-id></mixed-citation></ref>
<ref id="pone.0151064.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>UPARSE: highly accurate OTU sequences from microbial amplicon reads</article-title>. <source>Nature methods</source>. <year>2013</year>;<volume>10</volume>(<issue>10</issue>):<fpage>996</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2604" xlink:type="simple">10.1038/nmeth.2604</ext-link></comment> <object-id pub-id-type="pmid">23955772</object-id></mixed-citation></ref>
<ref id="pone.0151064.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Xiong</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>MacIsaac</surname> <given-names>HJ</given-names></name>. <article-title>Influence of artifact removal on rare species recovery in natural complex communities using high-throughput sequencing</article-title>. <source>PloS one</source>. <year>2014</year>;<volume>9</volume>(<issue>5</issue>):<fpage>e96928</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0096928" xlink:type="simple">10.1371/journal.pone.0096928</ext-link></comment> <object-id pub-id-type="pmid">24800821</object-id></mixed-citation></ref>
<ref id="pone.0151064.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wittkop</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Emig</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lange</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rahmann</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Albrecht</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>JH</given-names></name>, <etal>et al</etal>. <article-title>Partitioning biological data with transitivity clustering</article-title>. <source>Nature methods</source>. <year>2010</year>;<volume>7</volume>(<issue>6</issue>):<fpage>419</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth0610-419" xlink:type="simple">10.1038/nmeth0610-419</ext-link></comment> <object-id pub-id-type="pmid">20508635</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>