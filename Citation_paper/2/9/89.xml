<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-12-39868</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0073015</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories>
<title-group>
<article-title>Quality Score Based Identification and Correction of Pyrosequencing Errors</article-title>
<alt-title alt-title-type="running-head">Quality Based Pyrosequencing Error Correction</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Iyer</surname><given-names>Shyamala</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bouzek</surname><given-names>Heather</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="fn1"><sup>¤</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Deng</surname><given-names>Wenjie</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Larsen</surname><given-names>Brendan</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Casey</surname><given-names>Eleanor</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mullins</surname><given-names>James I.</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><addr-line>Department of Microbiology, University of Washington, Seattle, Washington, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Wei</surname><given-names>Zhi</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>New Jersey Institute of Technology, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">jmullins@uw.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist. The author currently employed at Micronics Inc. contributed to the work described in this manuscript while being employed full-time at University of Washington.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: SI HB WD JIM. Performed the experiments: SI HB EC BL. Analyzed the data: SI. Wrote the paper: SI JIM.</p></fn>
<fn id="fn1" fn-type="current-aff"><label>¤</label><p>Current address: Micronics Inc., Redmond, Washington, United States of America</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>5</day><month>9</month><year>2013</year></pub-date>
<volume>8</volume>
<issue>9</issue>
<elocation-id>e73015</elocation-id>
<history>
<date date-type="received"><day>19</day><month>12</month><year>2012</year></date>
<date date-type="accepted"><day>22</day><month>7</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Iyer et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Massively-parallel DNA sequencing using the 454/pyrosequencing platform allows in-depth probing of diverse sequence populations, such as within an HIV-1 infected individual. Analysis of this sequence data, however, remains challenging due to the shorter read lengths relative to that obtained by Sanger sequencing as well as errors introduced during DNA template amplification and during pyrosequencing. The ability to distinguish real variation from pyrosequencing errors with high sensitivity and specificity is crucial to interpreting sequence data. We introduce a new algorithm, CorQ (<underline>Cor</underline>rection through <underline>Q</underline>uality), which utilizes the inherent base quality in a sequence-specific context to correct for homopolymer and non-homopolymer insertion and deletion (indel) errors. CorQ also takes uneven read mapping into account for correcting pyrosequencing miscall errors and it identifies and corrects carry forward errors. We tested the ability of CorQ to correctly call SNPs on a set of pyrosequences derived from ten viral genomes from an HIV-1 infected individual, as well as on six simulated pyrosequencing datasets generated using non-zero error rates to emulate errors introduced by PCR. When combined with the AmpliconNoise error correction method developed to remove ambiguities in signal intensities, we attained a 97% reduction in indel errors, a 98% reduction in carry forward errors, and &gt;97% specificity of SNP detection. When compared to four other error correction methods, AmpliconNoise+CorQ performed at equal or higher SNP identification specificity, but the sensitivity of SNP detection was consistently higher (&gt;98%) than other methods tested. This combined procedure will therefore permit examination of complex genetic populations with improved accuracy.</p>
</abstract>
<funding-group><funding-statement>This work was funded by grants from National Institute of Allergy and Infectious Diseases to JIM (PO1AI057005, UM1AI068618 and R37AI47734) and the University of Washington Centers for AIDS Research Computational Biology Core (P30AI027757). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="9"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Massively parallel sequencing (MPS) or next generation (“next-gen”) sequencing technologies <xref ref-type="bibr" rid="pone.0073015-Margulies1">[1]</xref> allow for the generation of millions of sequence fragments (“sequence reads”) from a single specimen. These technologies have the potential to replace Sanger sequencing for many applications, including de-novo sequencing, re-sequencing and metagenomics <xref ref-type="bibr" rid="pone.0073015-Petrosino1">[2]</xref>, <xref ref-type="bibr" rid="pone.0073015-Loman1">[3]</xref>. However, the promise of MPS has to be balanced with its caveats. Each MPS platform has a much higher rate of error compared to Sanger sequencing <xref ref-type="bibr" rid="pone.0073015-Margulies1">[1]</xref>, <xref ref-type="bibr" rid="pone.0073015-Huse1">[4]</xref>, <xref ref-type="bibr" rid="pone.0073015-Gilles1">[5]</xref>. If the sample must be PCR-amplified prior to sequencing, the errors occurring during PCR are also present in the MP sequences and can be impossible to distinguish from real variation, except in cases when using random sequence tags coupled with oversequencing to generate consensus sequences from each amplicon <xref ref-type="bibr" rid="pone.0073015-Jabara1">[6]</xref>, <xref ref-type="bibr" rid="pone.0073015-Schmitt1">[7]</xref>. The 454/pyrosequencing platform results in uniquely high rates of overcalls and undercalls (resulting in erroneous insertions and deletions in the sequence reads) <xref ref-type="bibr" rid="pone.0073015-Margulies1">[1]</xref>, <xref ref-type="bibr" rid="pone.0073015-Gilles1">[5]</xref>. Carry forward errors are also unique to pyrosequencing and are caused by leftover nucleotides in a sequencing well <xref ref-type="bibr" rid="pone.0073015-Margulies1">[1]</xref>.</p>
<p>Error rates for the GS-FLX Titanium pyrosequencing technology have been estimated on an extensive dataset of Roche Corp. quality control DNA fragments and the sequences generated were found to have a mean error rate of 1.07% with errors showing a non-random distribution <xref ref-type="bibr" rid="pone.0073015-Gilles1">[5]</xref>. Error rates as high as 50% were reported in a few positions with the highest incidence of errors in homopolymer regions. Approximately 89% of the reads had some form of error. Thus, instead of removing reads with errors from downstream analysis, error correction methods are typically applied to an entire dataset to improve the overall accuracy of sequences, such as by filtering out regions of lower quality within reads <xref ref-type="bibr" rid="pone.0073015-Brockman1">[8]</xref>.</p>
<p>Pyrosequencing errors have been corrected using two approaches: correcting the measured light intensities (called flowgrams) <xref ref-type="bibr" rid="pone.0073015-Quince1">[9]</xref>, <xref ref-type="bibr" rid="pone.0073015-Quince2">[10]</xref>, or correcting the generated sequences <xref ref-type="bibr" rid="pone.0073015-Eriksson1">[11]</xref>–<xref ref-type="bibr" rid="pone.0073015-Prosperi2">[18]</xref>. Methods to correct errors in pyrosequences using a Poisson or binomial probability model have traditionally assumed, incorrectly <xref ref-type="bibr" rid="pone.0073015-Margulies1">[1]</xref>, <xref ref-type="bibr" rid="pone.0073015-Gilles1">[5]</xref>, <xref ref-type="bibr" rid="pone.0073015-Brockman1">[8]</xref>, that all base calls are of equal quality <xref ref-type="bibr" rid="pone.0073015-Eriksson1">[11]</xref>, <xref ref-type="bibr" rid="pone.0073015-Beerenwinkel1">[13]</xref>, <xref ref-type="bibr" rid="pone.0073015-Zagordi1">[16]</xref>, <xref ref-type="bibr" rid="pone.0073015-Wang1">[19]</xref>. Other error correction methods rely on comparing variants to an empirical control data set, mapping read segments to a consensus template and refining alignments locally <xref ref-type="bibr" rid="pone.0073015-Archer1">[12]</xref>. Salmela and colleagues corrected errors by taking sequences sharing common k-mers and forming multiple alignments with these reads. The reads are then corrected based on a consensus sequence made from the resulting alignments <xref ref-type="bibr" rid="pone.0073015-Salmela1">[15]</xref>. Other correction methods employ phase (co-variation) information within reads to distinguish between real variation and systematic error <xref ref-type="bibr" rid="pone.0073015-Macalalad1">[17]</xref>. These algorithms do not alter the flowgram data, instead they correct pyrosequencing errors on the translated bases. The program AmpliconNoise corrects pyrosequencing errors by clustering flowgrams and calculating the likelihood that each of the reads from these flowgrams was generated from a mixture of correct and incorrect sequences <xref ref-type="bibr" rid="pone.0073015-Quince1">[9]</xref>, <xref ref-type="bibr" rid="pone.0073015-Quince2">[10]</xref>. Following this, an expectation-maximization algorithm is applied to the clusters to determine a true sequence for each cluster. AmpliconNoise has been used in determining microbial diversities of the human gut <xref ref-type="bibr" rid="pone.0073015-Turnbaugh1">[20]</xref> and for viral population genetics <xref ref-type="bibr" rid="pone.0073015-Wang2">[21]</xref>.</p>
<p>Goals of the current study were twofold: to develop a widely applicable error correction method utilizing inherent base call quality and sequence context to correct pyrosequencing errors, and to make SNP calls based on the quality of the sequenced base. We developed a new error correction algorithm, CorQ that utilizes a multiple sequence alignment to map base qualities to the positions within the alignment. Reduction in base quality for an overcall/undercall error is detected by calculating the average drop in base quality between adjacent bases and the base in question, making use of quality scores from all the reads mapping to a position within the alignment. CorQ uses a set of sequences and associated quality files as a starting point for error correction. Carry forward errors that follow a specific pattern of single base insertions occurring after homopolymeric nucleotides are also identified and corrected as part of the program. In addition, we adapted CorQ to utilize sequence and associated quality files from other error correction and base recalibration algorithms <xref ref-type="bibr" rid="pone.0073015-Quince1">[9]</xref>, <xref ref-type="bibr" rid="pone.0073015-Quince2">[10]</xref>, <xref ref-type="bibr" rid="pone.0073015-Quinlan1">[22]</xref>. We compared our method to other recently developed error correction and SNP calling methods, including CORAL <xref ref-type="bibr" rid="pone.0073015-Salmela1">[15]</xref>, QuRe <xref ref-type="bibr" rid="pone.0073015-Prosperi2">[18]</xref>, SegminatorII <xref ref-type="bibr" rid="pone.0073015-Archer1">[12]</xref> and V-Phaser <xref ref-type="bibr" rid="pone.0073015-Macalalad1">[17]</xref>. We evaluated the sensitivity and specificity of these methods in identifying true SNPs found within a plasmid clone mixture of ten HIV-1 genomes derived from the blood plasma from one infected individual.</p>
<p>We also performed sensitivity and specificity analyses using CorQ and other error correction methods on six simulated pyrosequencing datasets. For these latter analyses we used two polymerase error rates 0.005, 0.01, selected based on experimental tests (Larsen <italic>et al</italic>., Manuscript under revision), to emulate errors generated during PCR amplification.</p>
</sec><sec id="s2" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s2a">
<title>Pyrosequencing of HIV-1 Genomes</title>
<p>Ten HIV-1 genome sequences were PCR amplified, cloned and sequenced using the Sanger method from one HIV-1 infected individual <xref ref-type="bibr" rid="pone.0073015-Herbeck1">[23]</xref>. We mixed these ten HIV-1 plasmid clones (GenBank accession numbers: JN024165–JN024168, JN024170–JN024173, JN024495 and JN024537) in equal proportion, linearized the DNA with a restriction enzyme, and performed pyrosequencing using the standard protocols provided in the GS-FLX Titanium Rapid Library preparation kit (454.com/products/gs-flx-system/index.asp).</p>
</sec><sec id="s2b">
<title>Generation of Simulated Pyrosequences</title>
<p>We generated a total of six additional simulated pyrosequencing datasets with Flowsim <xref ref-type="bibr" rid="pone.0073015-Balzer1">[24]</xref> using two starting configurations (<xref ref-type="supplementary-material" rid="pone.0073015.s003">Table S2</xref>). The first three datasets (Set 1a–c, <xref ref-type="supplementary-material" rid="pone.0073015.s003">Table S2</xref>) were generated using a single 1500 nt HIV-1 sequence as the starting template. Three simulation runs were conducted: The first had no additional SNP errors. The second and third had added SNP error rates of 0.005 and 0.01, respectively, set to approximate those generated during template PCR amplification, and were selected based on experimental tests (Larsen <italic>et al</italic>. Manuscript under revision). The templates for the fourth through sixth simulated pyrosequencing datasets (Set 2a–c, <xref ref-type="supplementary-material" rid="pone.0073015.s003">Table S2</xref>) were generated from a multiple sequence alignment of 28 previously published HIV-1 sequences <xref ref-type="bibr" rid="pone.0073015-Herbeck1">[23]</xref>. A 1500 nt region was selected (alignment positions: 1–1522, <xref ref-type="supplementary-material" rid="pone.0073015.s007">File S1</xref>) and used as input for Flowsim. Again, three simulation runs were conducted: with no additional SNP errors, and with SNP error rates of 0.005 or 0.01.</p>
</sec><sec id="s2c">
<title>Error Correction with AmpliconNoise</title>
<p>AmpliconNoise <xref ref-type="bibr" rid="pone.0073015-Quince2">[10]</xref> (version 1.24) was run on flowgrams using default settings. Error correction with AmpliconNoise suite of programs consists of two components, first clustering and correcting the flowgrams with AmpliconNoise followed by correcting PCR based errors with SeqNoise. In our preliminary evaluation we found that SeqNoise was computationally intensive yet it often failed on datasets larger than 20,000 reads and lacked important user definable parameters. Hence, we did not use the SeqNoise component for our subsequent analyses. The sequence and associated quality files obtained after AmpliconNoise flowgram correction were aligned with MOSAIK (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/marthlab/Mosaik" xlink:type="simple">http://bioinformatics.bc.edu/marthlab/Mosaik</ext-link>) using a sample-specific consensus sequence as reference. We adjusted the reference to query sequence mismatch parameter in MOSAIK to vary between 20–30%. This mismatch includes both SNP and indels and allowed mapping a greater number of reads to the reference sequence subsequently resulting in smaller loss of data.</p>
</sec><sec id="s2d">
<title>Read Filtering and Chimera Check</title>
<p>Sequences with ambiguous base calls (N) or less than 100 bases in length were removed, and we implemented an optional check to test for chimeric sequences. Chimeras are generated when sequences are amplified from a multi-template population <xref ref-type="bibr" rid="pone.0073015-Meyerhans1">[25]</xref> as well as naturally during HIV infection. The majority of in-vitro-generated chimeras arise due to incomplete primer extension during PCR <xref ref-type="bibr" rid="pone.0073015-Meyerhans1">[25]</xref>. To detect chimeras, we counted the number of SNP mismatches in a given read relative to the consensus sequence. In the CorQ analyses presented here we set this parameter to a default of 20% SNP mismatches between the consensus sequence and a given read to assign a sequence as a chimera, since this mismatch rate was optimal for chimera detection amongst several methods <xref ref-type="bibr" rid="pone.0073015-Haas1">[26]</xref>. For analyzing sequences with inherently greater diversity, we recommend varying this parameter to better distinguish a sequence variant from artificially generated chimeric sequence.</p>
</sec><sec id="s2e">
<title>CorQ Implementation: Correcting Poor Quality Indel and Miscall Errors</title>
<p>CorQ uses the filtered sequence alignment file to correct indel and miscall errors. First, quality values are mapped to the bases in a multiple sequence alignment, and positions (<xref ref-type="disp-formula" rid="pone.0073015.e001">Equation 1</xref>) with insertions and deletions in homopolymer and non-homopolymer regions are flagged. Two or more consecutive bases of the same kind are considered part of a homopolymer. In the flagged positions, the average base quality, Q<sub>i</sub>, of indel bases is estimated. The average base qualities of all called bases with associated qualities (A, G, T or C) in a non-indel position, Q<sub>i-1</sub> and Q<sub>i+1</sub>, adjacent to flagged positions are also estimated. For each indel occurring after a homopolymeric or non-homopolymeric sequence, the average base quality difference, Q<sub>reduction,i</sub>, between the flagged and adjacent column is compared against a distribution of quality reductions across the entire alignment (<xref ref-type="disp-formula" rid="pone.0073015.e001">Equation 1</xref>). Positions with greater than average base quality reduction are flagged for correction, handling single and multi-base indels in a similar manner. Indels present only in one read are also flagged for correction. Sequences containing flagged insertions are corrected by removing the incorrectly inserted base and sequences with flagged deletions are corrected by adding the consensus base. CorQ also creates an annotation file that tracks changes made to each corrected read.<disp-formula id="pone.0073015.e001"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0073015.e001" xlink:type="simple"/><label>(1)</label></disp-formula></p>
<p>To identify and flag potential sequencing miscalls, the difference between the average base quality of all consensus bases, Q<sub>i,consensus</sub>, and average base quality of variant, Q<sub>i,SNP</sub>, bases is calculated for all positions with a SNP relative to the consensus sequence (<xref ref-type="disp-formula" rid="pone.0073015.e002">Equation 2</xref>). The average reduction in SNP quality from the consensus is compared against a distribution of quality reductions for all SNPs and is flagged for correction if it is larger than the average in the distribution (<xref ref-type="disp-formula" rid="pone.0073015.e002">Equation 2</xref>). The consensus character at that position then replaces a flagged SNP. Positions with a SNP present only within a single read in the dataset are also flagged for correction.<disp-formula id="pone.0073015.e002"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0073015.e002" xlink:type="simple"/><label>(2)</label></disp-formula></p>
<p>To accommodate uneven read coverage (number of reads mapping to each base) from the two different sequencing orientations, we implemented additional checks when correcting potential sequencing miscalls. We have made read coverage difference as one of the input parameters in CorQ to allow users to set a coverage difference threshold that best captures the observed read coverage differences. SNPs that fall within regions of the designated fold difference are marked but not corrected, as we cannot rule out the possibility that a detected SNP is not “true” simply due to lack of adequate reads mapping to that position.</p>
<p>We also implemented a method within CorQ to identify and correct carry forward errors. Carry forward errors occur when insufficient flushing between the flows results in leftover nucleotides in a well, resulting in signal peaks at the wrong position during the next base incorporation <xref ref-type="bibr" rid="pone.0073015-Margulies1">[1]</xref>. The presence of homopolymers increases the likelihood of this type of errors <xref ref-type="bibr" rid="pone.0073015-Margulies1">[1]</xref>, <xref ref-type="bibr" rid="pone.0073015-Huse1">[4]</xref>. Carry forward events cause single base insertions usually near, but not adjacent to homopolymer regions <xref ref-type="bibr" rid="pone.0073015-Huse1">[4]</xref>. CorQ detects this specific pattern of single base insertions occurring after runs of homopolymeric nucleotides and flags them as carry forward errors if the inserted base is not the consensus at that position, and if it is the same base type as the preceding homopolymeric stretch. The flagged inserted bases are removed from reads.</p>
</sec><sec id="s2f">
<title>Comparison to other Error Correction Methods</title>
<p>We tested the sensitivity and specificity of CorQ to identify true SNPs within a dataset created by pyrosequencing ten HIV-1 genomes that had previously been sequenced, after cloning into plasmids, by the Sanger method, as well as the set of six simulated datasets. CorQ was tested against four other pyrosequencing error correction programs: CORAL <xref ref-type="bibr" rid="pone.0073015-Salmela1">[15]</xref>, Segminator II <xref ref-type="bibr" rid="pone.0073015-Archer1">[12]</xref>, QuRe <xref ref-type="bibr" rid="pone.0073015-Prosperi2">[18]</xref> and V-Phaser <xref ref-type="bibr" rid="pone.0073015-Macalalad1">[17]</xref> and the flowgram correction method AmpliconNoise <xref ref-type="bibr" rid="pone.0073015-Quince2">[10]</xref> using reads mapping to the three HIV genes <italic>gag</italic>, <italic>env</italic> and <italic>nef</italic>. All programs were run according to the default parameters recommended by the authors. We implemented CorQ on the following set of data files: a) uncorrected fasta and quality files, b) Flowgram corrected fasta and quality files (from AmpliconNoise) and c) files generated from the quality recalibration program Pyrobayes <xref ref-type="bibr" rid="pone.0073015-Quinlan1">[22]</xref>. Pyrobayes uses data likelihoods and prior distributions to determine the Bayesian posterior probability of the correct number of bases given a measured incorporation signal <xref ref-type="bibr" rid="pone.0073015-Quinlan1">[22]</xref> and results in a recalibrated base quality for each called base. We used the consensus of the Sanger sequences from the 10 viral genomes as the reference for generating multiple sequence alignments in all the above comparisons. V-Phaser results for simulated datasets were not included, as errors invariably occurred while running the program with these sequences that were not resolved in time for manuscript submission.</p>
<p>We also compared the performance of each program on indel attrition. The exact count of insertions and deletions are not obtained from the output from QuRe and SegminatorII, hence these programs were not included in this comparison.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<p>Pyrosequencing of 10 HIV-1 genomes resulted in 26,620 reads mapping to <italic>gag</italic>, 48,927 reads mapping to <italic>env</italic> and 21,963 reads mapping to the <italic>nef</italic> genes. Read coverage for both sequencing orientations is shown in <xref ref-type="fig" rid="pone-0073015-g001">Figure 1</xref>. While these coverage maps are more uneven than typical pyrosequencing runs performed by us (unpublished results), they highlight an important concern for algorithms calling SNPs in regions of poor read coverage and for determining the actual depth of population sampling across a genome – coverage and depth vary across the target sequences, and thus are poorly summarized by a single measure.</p>
<fig id="pone-0073015-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0073015.g001</object-id><label>Figure 1</label><caption>
<title>454 read coverage across the HIV-1 genome.</title>
<p>Locations of the <italic>gag</italic>, <italic>env</italic> and <italic>nef</italic> genes evaluated in this study are shown. A total of 26,620 reads mapped to <italic>gag</italic>, 48,927 to <italic>env</italic> and 21,963 to the <italic>nef</italic> gene. Reads were aligned to a sample-specific consensus using MOSAIK (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/marthlab/Mosaik" xlink:type="simple">http://bioinformatics.bc.edu/marthlab/Mosaik</ext-link>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0073015.g001" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pone-0073015-g002">Figure 2</xref> outlines the steps carried out by the CorQ error correction method. Following AmpliconNoise, a reference-guided multiple sequence alignment is generated with MOSAIK. Reads less than 100 bases and reads with ambiguous bases are removed as part of the preprocessing step. Short reads are generally a result of premature stops in strand synthesis or out-of-phase strand synthesis. These out-of-phase strands show early deterioration in signal quality, leading to shorter read lengths <xref ref-type="bibr" rid="pone.0073015-Margulies1">[1]</xref>, <xref ref-type="bibr" rid="pone.0073015-Gilles1">[5]</xref>. Regions within the multiple sequence alignment with insertions and deletions are classified as occurring in homopolymer (a region with two or more consecutive nucleotides of the same type) or non-homopolymer regions. The average difference in base quality between an indel position and adjacent positions are then calculated. The rationale for this step is that in the event a base corresponds to a sequencing overcall or undercall, the quality of that base should be lower than the neighboring bases – CorQ measures this drop in base quality relative to the adjacent bases. A distribution of average base quality reductions across indel positions within the alignment is used to make error correction calls. We observed similar patterns of quality reductions across the three gene regions (<xref ref-type="supplementary-material" rid="pone.0073015.s001">Figure S1</xref>). This bolsters our hypothesis that erroneous bases have poorer quality in the reads that contain them, and that the base quality adjacent to an erroneous base should be higher in the majority of reads. This allows CorQ to identify regions with a drop in average base quality across an alignment.</p>
<fig id="pone-0073015-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0073015.g002</object-id><label>Figure 2</label><caption>
<title>Overview of the CorQ 454 error correction methodology.</title>
<p>The starting point for the CorQ algorithm is a set of sequence and base quality files. MOSAIK (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/marthlab/Mosaik" xlink:type="simple">http://bioinformatics.bc.edu/marthlab/Mosaik</ext-link>) is used for reference-based alignment. Positions with out-of-frame insertions and deletions (indels) are identified within the alignment and average base qualities are calculated for these regions (See Materials and Methods <xref ref-type="disp-formula" rid="pone.0073015.e001">Equation 1</xref>). SNPs are similarly identified and called (See Materials and Methods <xref ref-type="disp-formula" rid="pone.0073015.e002">Equation 2</xref>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0073015.g002" position="float" xlink:type="simple"/></fig>
<p>Next, we compared the ability of CorQ and previously described algorithms for their ability to flag and correct sequencing overcalls and undercalls (<xref ref-type="fig" rid="pone-0073015-g003">Figure 3</xref>), using true indels observed within the Sanger sequences as an indicator of effectiveness. QuRe and SegminatorII programs did not output indel counts per position and hence we omitted these programs from this comparison. Vphaser run alone or the combination of AmpliconNoise flowgram correction followed by the CorQ algorithm on fasta and quality files reduced indel counts most effectively (95.4/96.7% reduction in <italic>gag</italic>, 95.3/94.7% in <italic>nef</italic> and 93/97% in <italic>env</italic>, respectively). CORAL, and Pyrobayes followed by CorQ did not result in a substantial reduction in erroneous indels (10–70%). Combinations of error correction methods performed better than applying a single correction method ranging from 93–97% reduction in indels. The combination of AmpliconNoise+CorQ and AmpliconNoise+CORAL performed better than other tested methods, achieving between 95–97% reduction in indels. Among the individual correction methods, VPhaser performed best, reducing indels by 92–96%.</p>
<fig id="pone-0073015-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0073015.g003</object-id><label>Figure 3</label><caption>
<title>Attrition in indel counts after application of error correction methods.</title>
<p>The percent reduction in number of indels within the HIV-1 ten-plasmid dataset compared to uncorrected sequences is presented. While Pyrobayes is not an error correction algorithm, but rather recalibrates quality values, the accuracy of recalibrated bases are meant to reflect overcalled and undercalled bases accurately. The % reduction in indels compared to uncorrected sequences is shown for <italic>gag</italic> (A), <italic>env</italic> (B) and <italic>nef</italic> (C), and all three genes combined (D).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0073015.g003" position="float" xlink:type="simple"/></fig>
<p>CorQ also corrects carry forward errors <xref ref-type="bibr" rid="pone.0073015-Margulies1">[1]</xref> near homopolymeric regions. The percent carry forward errors retained within reads after application of error correction methods is shown in <xref ref-type="fig" rid="pone-0073015-g004">Figure 4</xref>. Carry forward errors present in raw uncorrected reads are shown for comparison. In the uncorrected reads, carry forward insertion errors make up about 10–30% of the total insertions errors observed. Flowgram error correction (AmpliconNoise) corrects homopolymeric overcall insertion errors to a greater extent than carry forward insertion errors, hence, 20–30% of the insertion errors are of carry forward type after flowgram correction. Vphaser and CORAL corrected carry forward errors better than AmpliconNoise, but still retained about 10–15% of these errors. The combination of AmpliconNoise+CORAL performed only slightly better than using CORAL alone, retaining ∼10% of carry forward errors. The combination of Vphaser correction followed by the carry forward correction segment of the CorQ program resulted in a further, substantial reduction in the number of carry forward errors compared to correction with Vphaser alone, retaining between 2–5% of these errors. The combination of AmpliconNoise+CorQ removed the most carry forward insertion errors, retaining only ∼2%.</p>
<fig id="pone-0073015-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0073015.g004</object-id><label>Figure 4</label><caption>
<title>Carry forward errors retained after error correction.</title>
<p>Raw uncorrected values and the percentage of carry forward errors retained after error correction is plotted for each of the three gene regions <italic>gag</italic>, <italic>env</italic>, <italic>nef</italic> and all the three genes combined.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0073015.g004" position="float" xlink:type="simple"/></fig>
<p>The sensitivity and specificity of SNP identification was then compared for four pyrosequencing error correcting and variant calling algorithms within the <italic>gag</italic>, <italic>env</italic> and <italic>nef</italic> gene regions from our 10 HIV-1 genome dataset. Since the mixture was derived from ten whole genome plasmids mixed in equal proportion, the lowest observable valid SNP would be 10%, with SNPs calls in pyrosequences validated by comparison to variants identified in Sanger sequences <xref ref-type="bibr" rid="pone.0073015-Herbeck1">[23]</xref>. A total of 28 SNPs in <italic>gag</italic> (1500 nt positions), 61 in <italic>env</italic> (2550 nt) and 21 in <italic>nef</italic> (681 nt) were compared. As shown in <xref ref-type="table" rid="pone-0073015-t001">Table 1</xref>, the sensitivity of detection of variants was usually 97% or higher for most error methods, with the exception of the QuRe algorithm, which filters out regions with lower levels of coverage, and VPhaser when applied to the <italic>nef</italic> gene sequences. QuRe filtered out 3% of bases from correction for <italic>gag</italic> and <italic>nef</italic> but 33% of bases from correction in <italic>env</italic>. These filtered regions fell within areas of poor coverage, usually at the start of the gene. V-phaser had reduced sensitivity on the <italic>nef</italic> dataset (61%) due to a change of valid SNPs to consensus in a region with an in-frame 18 nt deletion present in 30% of the Sanger sequences. Changes to <italic>gapwindow</italic> size parameter (to match the gap size observed within the sequences) as part of the Vphaser correction program did not improve <italic>nef</italic> sensitivity. A combination of AmpliconNoise+CORAL also showed reduced sensitivity, with values falling lower than each of these correction methods used individually. CORAL corrects errors by forming a multiple sequence alignment and generating a consensus sequence from these alignments. It is possible that the low frequency of “real” SNPs that are seen after flowgram correction are removed in CORAL when consensus sequences are generated, thus leading to a higher incidence of false negatives and reducing sensitivity. Similarly, we observed a reduced sensitivity when we combined AmpliconNoise with Vphaser, with sensitivity values falling lower than each of these correction methods used individually. The combination of AmpliconNoise+CorQ consistently resulted in higher sensitivity than the other tested error correction methods used individually or in combination.</p>
<table-wrap id="pone-0073015-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0073015.t001</object-id><label>Table 1</label><caption>
<title>Sensitivity and specificity of error correction algorithms in SNP variant calling.</title>
</caption><alternatives><graphic id="pone-0073015-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0073015.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Method</td>
<td colspan="3" align="left" rowspan="1">Sensitivity</td>
<td align="left" rowspan="1" colspan="1"/>
<td colspan="3" align="left" rowspan="1">Specificity</td>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><italic>gag</italic></td>
<td align="left" rowspan="1" colspan="1"><italic>nef</italic></td>
<td align="left" rowspan="1" colspan="1"><italic>env</italic></td>
<td align="left" rowspan="1" colspan="1">combined</td>
<td align="left" rowspan="1" colspan="1"><italic>gag</italic></td>
<td align="left" rowspan="1" colspan="1"><italic>nef</italic></td>
<td align="left" rowspan="1" colspan="1"><italic>env</italic></td>
<td align="left" rowspan="1" colspan="1">combined</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>Uncorrected 454 reads</bold></td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.37</td>
<td align="left" rowspan="1" colspan="1">0.34</td>
<td align="left" rowspan="1" colspan="1">0.5</td>
<td align="left" rowspan="1" colspan="1">0.44</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>CorQ</bold></td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.79</td>
<td align="left" rowspan="1" colspan="1">0.86</td>
<td align="left" rowspan="1" colspan="1">0.94</td>
<td align="left" rowspan="1" colspan="1">0.88</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>AmpliconNoise</bold></td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.88</td>
<td align="left" rowspan="1" colspan="1">0.71</td>
<td align="left" rowspan="1" colspan="1">0.69</td>
<td align="left" rowspan="1" colspan="1">0.76</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>AmpliconNoise+CorQ</bold></td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.97</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>Pyrobayes+CorQ</bold></td>
<td align="left" rowspan="1" colspan="1">0.97</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.78</td>
<td align="left" rowspan="1" colspan="1">0.7</td>
<td align="left" rowspan="1" colspan="1">0.78</td>
<td align="left" rowspan="1" colspan="1">0.77</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>CORAL</bold></td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.96</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.92</td>
<td align="left" rowspan="1" colspan="1">0.88</td>
<td align="left" rowspan="1" colspan="1">0.94</td>
<td align="left" rowspan="1" colspan="1">0.91</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>AmpliconNoise+CORAL</bold></td>
<td align="left" rowspan="1" colspan="1">0.5</td>
<td align="left" rowspan="1" colspan="1">0.93</td>
<td align="left" rowspan="1" colspan="1">0.27</td>
<td align="left" rowspan="1" colspan="1">0.53</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.86</td>
<td align="left" rowspan="1" colspan="1">0.95</td>
<td align="left" rowspan="1" colspan="1">0.95</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>QuRe</bold></td>
<td align="left" rowspan="1" colspan="1">0.96 (0.41)<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1">0.97 (0.61)<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1">0.98 (0.04)<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1">0.97 (0.11)<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1">0.97</td>
<td align="left" rowspan="1" colspan="1">0.92</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.96</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>SegminatorII</bold></td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.97</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.2</td>
<td align="left" rowspan="1" colspan="1">0.24</td>
<td align="left" rowspan="1" colspan="1">0.47</td>
<td align="left" rowspan="1" colspan="1">0.35</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>VPhaser</bold></td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.61</td>
<td align="left" rowspan="1" colspan="1">0.95</td>
<td align="left" rowspan="1" colspan="1">0.86</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.98</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>AmpliconNoise+VPhaser</bold></td>
<td align="left" rowspan="1" colspan="1">0.54</td>
<td align="left" rowspan="1" colspan="1">0.25</td>
<td align="left" rowspan="1" colspan="1">0.41</td>
<td align="left" rowspan="1" colspan="1">0.38</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>Comparison of CorQ against other pyrosequence error correction and SNP calling algorithms. <italic>gag</italic>, <italic>env</italic> and <italic>nef</italic> gene regions were used to compare the sensitivity and specificity of various algorithms. Sensitivity measures the proportion of true SNPs present in the ten HIV-1 genomes, and correctly identified by the various SNP calling programs. Specificity measures the proportion of true negatives (positions in the gene regions that are invariant) that are correctly identified by the compared programs.</p></fn><fn id="nt102"><label>*</label><p>Shown in parenthesis are values from QuRe when the poor coverage regions excluded from sensitivity analysis are included as false negatives.</p></fn></table-wrap-foot></table-wrap>
<p>With regard to specificity, the uncorrected reads had a high false positive rate (low specificity), and with the exception of SegminatorII each of the correction pipelines resulted in an increase in specificity. Repeated analyses with SegminatorII produced a high number of false positives, despite using a sample-specific consensus sequence as reference for the alignment and default settings recommended by the program authors. VPhaser alone, or flowgram correction (AmpliconNoise) in combination with CorQ, consistently produced the highest specificity for variant detection. Overall, combinations of error correction methods (AmpliconNoise+CORAL, AmpliconNoise+Vphaser and AmpliconNoise+CorQ) consistently exhibited between 86–100% specificity.</p>
<p>We also performed a test to assess the effects of read coverage differences across sequencing orientations on the sensitivity and specificity of CorQ to detect and correct SNPs. We used pyrosequences mapping to the ∼2500 nt <italic>env</italic> region from the ten HIV-1 plasmid clones for this comparison and ran the combination of AmpliconNoise+CorQ with 2-fold, 5-fold, 10-fold and 20-fold coverage differences as thresholds for SNP correction (<xref ref-type="supplementary-material" rid="pone.0073015.s002">Table S1</xref>). As expected with a lower read coverage difference threshold (2- or 5-fold), more positions were marked to be poor coverage regions – SNPs falling within these regions are not corrected, resulting in higher false positives (reducing specificity to 95%). With higher coverage difference thresholds (20-fold), more regions with SNPs are corrected, resulting in correction of real variation present within the sequences and giving more false negatives (reduced sensitivity to 95%). We therefore used a 10-fold coverage difference (98% sensitivity and 99% specificity) with CorQ to achieve a balance between sensitivity and specificity.</p>
<p>We tested the ability of error correction algorithms to reduce indel and substitution error rates in both homopolymeric and non-homopolymeric regions (<xref ref-type="supplementary-material" rid="pone.0073015.s004">Tables S3</xref> and <xref ref-type="supplementary-material" rid="pone.0073015.s005">S4</xref>, respectively) on simulated pyrosequences generated with a single starting template (Sets 1a–c, <xref ref-type="supplementary-material" rid="pone.0073015.s003">Table S2</xref>). QuRe was not included in this analysis since it generates indel-removed haplotypes as the final result. SegminatorII was also excluded since it does not give indel information in the final results. The combination of AmpliconNoise+CORAL gives the highest reduction in substitution error rates for these simulated datasets. This mostly likely is a result of CORAL error correction whereby a regional consensus sequence is used to correct for low frequency variants. In the case where multiple sequencing templates are present, this correction method runs a risk of removing “true” low frequency variants (as we have shown with our sensitivity analyses), whereas in this case where only a single template was used for simulation, correction of low frequency variants is more efficient. Similar trends for indel and SNP error rate reduction was observed in homopolymeric and non-homopolymeric regions (compare <xref ref-type="supplementary-material" rid="pone.0073015.s004">Tables S3</xref> and <xref ref-type="supplementary-material" rid="pone.0073015.s005">S4</xref>).</p>
<p>Lastly we also evaluated the sensitivity and specificity of SNP identification on simulated pyrosequencing datasets. We used the three simulated datasets (Sets 2a–c, <xref ref-type="supplementary-material" rid="pone.0073015.s003">Table S2</xref>) with multiple starting templates (28 templates) for this analysis. Prior Sanger sequencing had shown a total of 145 positions with SNPs within these 28 templates <xref ref-type="bibr" rid="pone.0073015-Herbeck1">[23]</xref>. We did not include SegminatorII in this comparison since our previous analysis with this program (<xref ref-type="table" rid="pone-0073015-t001">Table 1</xref>) had shown that it led to lower specificity than raw uncorrected reads. Vphaser was also excluded as errors in the program led to consistently failed runs (see Materials and Methods). When we compared the simulated sequences that lacked introduced SNP errors (<xref ref-type="table" rid="pone-0073015-t002">Table 2</xref>), we observed very similar trends as observed with previous comparisons with the ten HIV-1 genome dataset (<xref ref-type="table" rid="pone-0073015-t001">Table 1</xref>). As shown in <xref ref-type="table" rid="pone-0073015-t002">Table 2</xref>, the sensitivity of detection was usually 95% or higher except in the combination of AmpliconNoise+CORAL that again showed a trend towards reduced sensitivity when combined. QuRe also showed reduced sensitivity when we included the poor coverage regions excluded by QuRe into our sensitivity calculations. When considering a balance between sensitivity and specificity, AmpliconNoise+CorQ performed the best amongst all the methods tested. As highlighted previously, PCR errors are harder for error correction algorithms to remove since these mutations are present within the sequencing templates. All error correction methods we tested on simulated pyrosequences with additional SNP errors added to emulate PCR errors fared poorly for the removal of false positives with the best being AmpliconNoise+CorQ, with a specificity of 40% (<xref ref-type="supplementary-material" rid="pone.0073015.s006">Table S5</xref>).</p>
<table-wrap id="pone-0073015-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0073015.t002</object-id><label>Table 2</label><caption>
<title>Sensitivity and specificity of error correction algorithms in SNP variant calling in simulated pyrosequences (simulated datasets 2a–c).</title>
</caption><alternatives><graphic id="pone-0073015-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0073015.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Method</td>
<td colspan="2" align="left" rowspan="1">Flowsim simulated pyrosequences</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Sensitivity</td>
<td align="left" rowspan="1" colspan="1">Specificity</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>Uncorrected 454 reads</bold></td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.15</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>CorQ</bold></td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.7</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>AmpliconNoise</bold></td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.89</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>AmpliconNoise+CorQ</bold></td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.95</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>Pyrobayes+CorQ</bold></td>
<td align="left" rowspan="1" colspan="1">0.98</td>
<td align="left" rowspan="1" colspan="1">0.71</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>CORAL</bold></td>
<td align="left" rowspan="1" colspan="1">0.95</td>
<td align="left" rowspan="1" colspan="1">0.88</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>AmpliconNoise+CORAL</bold></td>
<td align="left" rowspan="1" colspan="1">0.2</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>QuRe</bold></td>
<td align="left" rowspan="1" colspan="1">0.99 (0.44)<xref ref-type="table-fn" rid="nt104">*</xref></td>
<td align="left" rowspan="1" colspan="1">0.98</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt103"><label/><p>Comparison of CorQ algorithm against other pyrosequence error correction and SNP calling algorithms. Simulated pyrosequences generated from 28 HIV-1 sequences as the starting template were used to compare the sensitivity and specificity of error correction algorithms. Sensitivity measures the proportion of true SNPs present within the HIV-1 templates used for simulation, and correctly identified as such by the various SNP calling programs. Specificity measures the proportion of true negatives (positions in the gene regions that are invariant) that are correctly identified as such by the compared programs.</p></fn><fn id="nt104"><label>*</label><p>Values from QuRe are shown when the poor coverage regions excluded from sensitivity analysis are included as false negatives (shown in parenthesis).</p></fn></table-wrap-foot></table-wrap></sec><sec id="s4">
<title>Discussion</title>
<p>We described a new pyrosequence error correction algorithm, CorQ that can identify and correct homopolymer and non-homopolymer indel errors, sequencing misincorporation errors and carry forward errors associated with homopolymeric regions. When applied to a control set of ten HIV-1 genomes (without PCR amplification), the combination of AmpliconNoise+CorQ reduced indel errors in the gene regions <italic>gag</italic>, <italic>env</italic> and <italic>nef</italic> by 94 to 97%. In addition to testing CorQ in combination with flowgram correction (AmpliconNoise) and base quality recalibration (Pyrobayes) programs, we also compared it to four recently published pyrosequencing variant callers, CORAL, QuRe, SegminatorII and V-Phaser. We found that when CorQ error correction is used on flowgram-corrected fasta and quality files produced by AmpliconNoise, we get consistently higher sensitivity and specificity of SNP detection. To tease apart the contribution of CorQ and AmpliconNoise, we ran the programs separately, and found that CorQ by itself improved SNP detection specificity to a range of 79% to 94%, whereas AmpliconNoise by itself improved specificity to a range of 69% to 88%, whereas uncorrected reads had a SNP detection specificity ranging from 34% to 50%. Combining AmpliconNoise and CorQ, however, consistently gave the highest combined SNP detection sensitivity and specificity amongst the error correction methods tested, with the specificity of VPhaser nearly equaling that of AmpliconNoise+CorQ. The combinations of AmpliconNoise+Vphaser and AmpliconNoise+CORAL while resulting in &gt;86% specificity, had poor sensitivity ranging from 25%–93%.</p>
<p>The advantage of using AmpliconNoise+CorQ was most pronounced for the reduction carry forward errors. We also observed reductions in carry forward errors when we combined corrected files from Vphaser with CorQ, indicating that CorQ can be used in combination with other error correction programs to maximize the number of error free pyrosequences. We observed similar trends in sensitivity and specificity when we compared error correction methods on simulated pyrosequencing datasets. One caveat we observed in using AmpliconNoise is that it is computationally intensive, with computing time increasing exponentially on datasets over 20,000 reads, making this algorithm impractical for large datasets without extensive computational resources. Furthermore, since AmpliconNoise relies on iterative clustering, we have observed that the frequencies of low-level SNPs do not correlate well with the frequencies found within uncorrected reads for sequences generated through amplicon sequencing on the Roche 454 platform (unpublished results). We therefore recommend use of AmpliconNoise for library pyrosequencing only, as described here.</p>
<p>CorQ takes read coverage into account when making SNP calls, particularly in regions in which there is a large discrepancy between the number of reads obtained in one sequencing orientation compared to the other. Other pyrosequencing error correction methods we tested here do not explicitly address read coverage variation across the target sequence or in different sequencing orientations. We addressed this by requiring a SNP to be present in both orientations. We also made read coverage difference threshold an input parameter for CorQ so that users can use the fold coverage that appropriately represents the data they are analyzing. We settled on a default setting of 10-fold coverage difference after initial tests showed this to achieve a good balance between SNP detection sensitivity and specificity. Thus, in regions with over a 10-fold difference in read coverage across sequencing orientations, SNPs are not corrected (by CorQ) due solely to inadequate information. While this criterion does not address all possible scenarios of read coverage across sequenced positions, we have observed that most regions with coverage discrepancies also tend to have inadequate or lack of reads in one of the sequencing orientations (unpublished observations).</p>
<p>As expected, none of programs evaluated were able to correct SNPs present in sequences as a result of misincorporation events occurring during PCR of the template preparation, unless, in the case of CorQ, these SNPs also had reduced base quality. This makes identification of SNP errors as a result of PCR amplification challenging by any method as shown by our error correction tests run on simulated pyrosequences with typical PCR error rates applied.</p>
<p>We selected HIV-1 sequences as templates for generating additional simulated pyrosequences as this technology has become widespread in studying HIV-1 genomes. The genetic diversity of HIV-1 found within an infected individual in chronic infection is comparable to the global genetic variation seen in the influenza virus <xref ref-type="bibr" rid="pone.0073015-Korber1">[27]</xref>. The most prominent source of HIV-1 mutation is error prone nucleic acid synthesis during replication, with rates estimated in the range of 1.4×10<sup>–5</sup> errors per base pair, per replication cycle <xref ref-type="bibr" rid="pone.0073015-Abram1">[28]</xref>. Viral diversity also differs in different genes and with the length of infection. The diversity of a viral population within an infected individual starts low immediately after infection but increases during the course of infection at a rate of 1% (within the <italic>env</italic> region) reaching up to 15% or more in long term infected individuals <xref ref-type="bibr" rid="pone.0073015-Shankarappa1">[29]</xref>. This extent of diversity makes pyrosequencing both a useful and challenging tool to study HIV-1. The information gleaned from pyrosequences thus has to be judged carefully for errors from both the sequencing methodology and PCR amplification.</p>
<p>CorQ lists frequencies of SNPs and outputs a multiple sequence alignment that can be used for downstream analysis of a variety of datasets, including microbial communities. Other error correction methods such as QuRe and V-Phaser that were tested here also generate reconstructed haplotypes that can be useful in studying microbial communities. Researchers interested in studying diverse microbial communities can use the information provided here to make decisions on selecting the right set of error correction tools. While we have tested CorQ on data derived from pyrosequencing, this algorithm is general enough to be applied to sequences generated from other high throughput platforms that generate both sequence and associated quality files, making it a method with widespread applications in variant detection. Perl scripts that implement each step in the CorQ pipeline are available for download at: <ext-link ext-link-type="uri" xlink:href="http://mullinslab.microbiol.washington.edu/publications/iyer_2012/" xlink:type="simple">http://mullinslab.microbiol.washington.edu/publications/iyer_2012/</ext-link>.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pone.0073015.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pone.0073015.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Average reduction in base quality for indels found in homopolymer and non-homopolymer regions.</bold> Reduction in base quality was measured as the average difference in quality between flagged positions with indels and the adjacent columns (See Materials and Methods, <xref ref-type="disp-formula" rid="pone.0073015.e001">Equation 1</xref>). Base qualities from uncorrected sequences (raw 454), and sequences corrected with AmpliconNoise and Pyrobayes are shown for indels found in non-homopolymer regions (length of 1) and varying homopolymer lengths. Reduction in base quality is shown for indels within <italic>gag</italic> (A), <italic>env</italic> (B), <italic>nef</italic> (C) and the three genes combined (D).</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pone.0073015.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pone.0073015.s002" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p><bold>Effect of varying coverage threshold on sensitivity and specificity of SNP variant calling.</bold> AmpliconNoise+CorQ error correction was used on pyrosequences mapping to the <italic>env</italic> region (∼2500 nt) from the ten HIV-1 genome control dataset. Different fold coverage values were used as input parameters in CorQ. Sensitivity and specificity of SNP variant detection within this region is calculated for each fold coverage value.</p>
<p>(DOCX)</p>
</caption></supplementary-material><supplementary-material id="pone.0073015.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pone.0073015.s003" position="float" xlink:type="simple"><label>Table S2</label><caption>
<p><bold>Average number of reads and average read length for simulated pyrosequences.</bold> Two sets of simulated pyrosequences generated using Flowsim are shown here. The first set (Set 1a, b and c) is comprised of simulated reads generated using a single 1500 nt HIV-1 sequence as the starting template. The second set (Set 2a, b and c) is comprised of simulated reads generated using a 1500 nt region located within 28 HIV-1 sequences as starting templates. Simulations were done without additional SNP errors (1a, 2a) and with two different SNP error rates, 0.005 and 0.01 (1b,c and 2b,c).</p>
<p>(DOCX)</p>
</caption></supplementary-material><supplementary-material id="pone.0073015.s004" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pone.0073015.s004" position="float" xlink:type="simple"><label>Table S3</label><caption>
<p><bold>Comparison of insertion, deletion and substitution error rates in homopolymeric regions after error correction on simulated pyrosequences.</bold> Simulated reads were generated using Flowsim using a single 1500 nt HIV-1 sequence as the starting template (Simulated datasets 1a–c). Average insertion, deletion and substitution error rates within homopolymeric regions are shown after correction with no additional SNP errors, and SNP error rates of 0.005 and 0.01.</p>
<p>(DOCX)</p>
</caption></supplementary-material><supplementary-material id="pone.0073015.s005" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pone.0073015.s005" position="float" xlink:type="simple"><label>Table S4</label><caption>
<p><bold>Comparison of insertion, deletion and substitution error rates in non-homopolymeric regions after error correction on simulated pyrosequences.</bold> The simulated reads were generated in Flowsim using a single 1500 nt HIV-1 sequence as the starting template (Simulated datasets 1a–c). Average insertion, deletion and substitution error rates within non-homopolymeric regions are shown after correction with no additional SNP errors, and SNP error rates of 0.005 and 0.01.</p>
<p>(DOCX)</p>
</caption></supplementary-material><supplementary-material id="pone.0073015.s006" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pone.0073015.s006" position="float" xlink:type="simple"><label>Table S5</label><caption>
<p><bold>Sensitivity and specificity comparison of error correction and SNP calling algorithms on simulated pyrosequences.</bold> Simulated datasets 2a–c was used to compare the sensitivity and specificity of error correction algorithms. Sensitivity measures the proportion of true SNPs present within the HIV-1 templates, and correctly identified as such by the various SNP calling programs. Specificity measures the proportion of true negatives (positions in the gene regions that are invariant) that are correctly identified as such by the compared programs. Note that QuRe failed when used on simulated pyrosequences generated with a SNP error rate of 0.005. * Values from QuRe are shown when the poor coverage regions were excluded from sensitivity analysis and when these regions are included as false negatives during analysis (the latter values are shown in parenthesis).</p>
<p>(DOCX)</p>
</caption></supplementary-material><supplementary-material id="pone.0073015.s007" xlink:href="info:doi/10.1371/journal.pone.0073015.s007" mimetype="text/plain" position="float" xlink:type="simple"><label>File S1</label><caption>
<p><bold>Sequences for generating simulated pyrosequences.</bold></p>
<p>(TXT)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank Brandon Maust for computing support and helpful comments throughout the development of this method.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0073015-Margulies1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Margulies</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Egholm</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Altman</surname><given-names>WE</given-names></name>, <name name-style="western"><surname>Attiya</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Bader</surname><given-names>JS</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Genome sequencing in microfabricated high-density picolitre reactors</article-title>. <source>Nature</source> <volume>437</volume>: <fpage>376</fpage>–<lpage>380</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Petrosino1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Petrosino</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Highlander</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Luna</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Gibbs</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Versalovic</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>Metagenomic pyrosequencing and microbial identification</article-title>. <source>Clin Chem</source> <volume>55</volume>: <fpage>856</fpage>–<lpage>866</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Loman1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Loman</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Constantinidou</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Chan</surname><given-names>JZ</given-names></name>, <name name-style="western"><surname>Halachev</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sergeant</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>High-throughput bacterial genome sequencing: an embarrassment of choice, a world of opportunity</article-title>. <source>Nat Rev Microbiol</source> <volume>10</volume>: <fpage>599</fpage>–<lpage>606</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Huse1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huse</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Morrison</surname><given-names>HG</given-names></name>, <name name-style="western"><surname>Sogin</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Welch</surname><given-names>DM</given-names></name> (<year>2007</year>) <article-title>Accuracy and quality of massively parallel DNA pyrosequencing</article-title>. <source>Genome Biol</source> <volume>8</volume>: <fpage>R143</fpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Gilles1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gilles</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Meglecz</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Pech</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Ferreira</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Malausa</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Accuracy and quality assessment of 454 GS-FLX Titanium pyrosequencing</article-title>. <source>BMC Genomics</source> <volume>12</volume>: <fpage>245</fpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Jabara1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jabara</surname><given-names>CB</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>CD</given-names></name>, <name name-style="western"><surname>Roach</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Anderson</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Swanstrom</surname><given-names>R</given-names></name> (<year>2011</year>) <article-title>Accurate sampling and deep sequencing of the HIV-1 protease gene using a Primer ID</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>20166</fpage>–<lpage>20171</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Schmitt1"><label>7</label>
<mixed-citation publication-type="other" xlink:type="simple">Schmitt MW, Kennedy SR, Salk JJ, Fox EJ, Hiatt JB, <etal>et al</etal>.. (2012) Detection of ultra-rare mutations by next-generation sequencing. Proc Natl Acad Sci U S A.</mixed-citation>
</ref>
<ref id="pone.0073015-Brockman1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brockman</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Alvarez</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Young</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Garber</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Giannoukos</surname><given-names>G</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Quality scores and SNP detection in sequencing-by-synthesis systems</article-title>. <source>Genome Res</source> <volume>18</volume>: <fpage>763</fpage>–<lpage>770</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Quince1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quince</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lanzen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Curtis</surname><given-names>TP</given-names></name>, <name name-style="western"><surname>Davenport</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Hall</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Accurate determination of microbial diversity from 454 pyrosequencing data</article-title>. <source>Nat Methods</source> <volume>6</volume>: <fpage>639</fpage>–<lpage>641</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Quince2"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quince</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lanzen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Davenport</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name> (<year>2011</year>) <article-title>Removing noise from pyrosequenced amplicons</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>38</fpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Eriksson1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eriksson</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Mitsuya</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Rhee</surname><given-names>SY</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Viral population estimation using pyrosequencing</article-title>. <source>PLoS Comput Biol</source> <volume>4</volume>: <fpage>e1000074</fpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Archer1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Archer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Taillon</surname><given-names>BE</given-names></name>, <name name-style="western"><surname>Harrigan</surname><given-names>PR</given-names></name>, <name name-style="western"><surname>Lewis</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>The evolutionary analysis of emerging low frequency HIV-1 CXCR4 using variants through time–an ultra-deep approach</article-title>. <source>PLoS Comput Biol</source> <volume>6</volume>: <fpage>e1001022</fpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Beerenwinkel1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Zagordi</surname><given-names>O</given-names></name> (<year>2011</year>) <article-title>Ultra-deep sequencing for the analysis of viral populations</article-title>. <source>Curr Opin Virol</source> <volume>1</volume>: <fpage>413</fpage>–<lpage>418</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Prosperi1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prosperi</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Prosperi</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Bruselles</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Abbate</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Rozera</surname><given-names>G</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Combinatorial analysis and algorithms for quasispecies reconstruction using next-generation sequencing</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>5</fpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Salmela1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salmela</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Schroder</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Correcting errors in short reads by multiple alignments</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>1455</fpage>–<lpage>1461</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Zagordi1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zagordi</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Bhattacharya</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Eriksson</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name> (<year>2011</year>) <article-title>ShoRAH: estimating the genetic diversity of a mixed sample from next-generation sequencing data</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>119</fpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Macalalad1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Macalalad</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Zody</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Charlebois</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lennon</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Newman</surname><given-names>RM</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Highly Sensitive and Specific Detection of Rare Variants in Mixed Viral Populations from Massively Parallel Sequence Data</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>e1002417</fpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Prosperi2"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prosperi</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Salemi</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>QuRe: software for viral quasispecies reconstruction from next-generation sequencing data</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>132</fpage>–<lpage>133</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Wang1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Mitsuya</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Gharizadeh</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Ronaghi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Shafer</surname><given-names>RW</given-names></name> (<year>2007</year>) <article-title>Characterization of mutation spectra with ultra-deep pyrosequencing: application to HIV-1 drug resistance</article-title>. <source>Genome Res</source> <volume>17</volume>: <fpage>1195</fpage>–<lpage>1201</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Turnbaugh1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Quince</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Faith</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>McHardy</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Yatsunenko</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Organismal, genetic, and transcriptional variation in the deeply sequenced gut microbiomes of identical twins</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>107</volume>: <fpage>7503</fpage>–<lpage>7508</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Wang2"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>GP</given-names></name>, <name name-style="western"><surname>Sherrill-Mix</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Chang</surname><given-names>KM</given-names></name>, <name name-style="western"><surname>Quince</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Bushman</surname><given-names>FD</given-names></name> (<year>2010</year>) <article-title>Hepatitis C virus transmission bottlenecks analyzed by deep sequencing</article-title>. <source>J Virol</source> <volume>84</volume>: <fpage>6218</fpage>–<lpage>6228</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Quinlan1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quinlan</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Stewart</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Stromberg</surname><given-names>MP</given-names></name>, <name name-style="western"><surname>Marth</surname><given-names>GT</given-names></name> (<year>2008</year>) <article-title>Pyrobayes: an improved base caller for SNP discovery in pyrosequences</article-title>. <source>Nature methods</source> <volume>5</volume>: <fpage>179</fpage>–<lpage>181</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Herbeck1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Herbeck</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Rolland</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>McLaughlin</surname><given-names>S</given-names></name>, <name name-style="western"><surname>McNevin</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Demographic processes affect HIV-1 evolution in primary infection before the onset of selective processes</article-title>. <source>Journal of virology</source> <volume>85</volume>: <fpage>7523</fpage>–<lpage>7534</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Balzer1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balzer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Malde</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Lanzen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sharma</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Jonassen</surname><given-names>I</given-names></name> (<year>2010</year>) <article-title>Characteristics of 454 pyrosequencing data–enabling realistic simulation with flowsim</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>i420</fpage>–<lpage>425</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Meyerhans1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyerhans</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Vartanian</surname><given-names>J-P</given-names></name>, <name name-style="western"><surname>Wain-Hobson</surname><given-names>S</given-names></name> (<year>1990</year>) <article-title>DNA recombination during PCR</article-title>. <source>Nuc Acids Res</source> <volume>18</volume>: <fpage>1687</fpage>–<lpage>1691</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Haas1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haas</surname><given-names>BJ</given-names></name>, <name name-style="western"><surname>Gevers</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Earl</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Feldgarden</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ward</surname><given-names>DV</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Chimeric 16S rRNA sequence formation and detection in Sanger and 454-pyrosequenced PCR amplicons</article-title>. <source>Genome Res</source> <volume>21</volume>: <fpage>494</fpage>–<lpage>504</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Korber1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Korber</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Gaschen</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Yusim</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Thakallapally</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kesmir</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Evolutionary and immunological implications of contemporary HIV-1 variation</article-title>. <source>Br Med Bull</source> <volume>58</volume>: <fpage>19</fpage>–<lpage>42</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Abram1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abram</surname><given-names>ME</given-names></name>, <name name-style="western"><surname>Ferris</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Shao</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Alvord</surname><given-names>WG</given-names></name>, <name name-style="western"><surname>Hughes</surname><given-names>SH</given-names></name> (<year>2010</year>) <article-title>Nature, position, and frequency of mutations made in a single cycle of HIV-1 replication</article-title>. <source>J Virol</source> <volume>84</volume>: <fpage>9864</fpage>–<lpage>9878</lpage>.</mixed-citation>
</ref>
<ref id="pone.0073015-Shankarappa1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shankarappa</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Margolick</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Gange</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Rodrigo</surname><given-names>AG</given-names></name>, <name name-style="western"><surname>Upchurch</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>1999</year>) <article-title>Consistent viral evolutionary changes associated with the progression of human immunodeficiency virus type 1 infection</article-title>. <source>J Virol</source> <volume>73</volume>: <fpage>10489</fpage>–<lpage>10502</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>