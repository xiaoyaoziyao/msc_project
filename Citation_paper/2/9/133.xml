<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-11-14476</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0036427</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
              <subj-group>
                <subject>Genome analysis tools</subject>
                <subject>Genome sequencing</subject>
                <subject>Metagenomics</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Sequence analysis</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Ecology</subject>
            <subj-group>
              <subject>Microbial ecology</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome analysis tools</subject>
              <subject>Genome sequencing</subject>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Microbiology</subject>
            <subj-group>
              <subject>Medical microbiology</subject>
              <subject>Microbial ecology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Microbiology</subject>
          <subject>Computational Biology</subject>
          <subject>Ecology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Optimizing Read Mapping to Reference Genomes to Determine Composition and Species Prevalence in Microbial Communities</article-title><alt-title alt-title-type="running-head">Optimizing Read Mapping to Reference Genomes</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Martin</surname>
            <given-names>John</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Sykes</surname>
            <given-names>Sean</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Young</surname>
            <given-names>Sarah</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Kota</surname>
            <given-names>Karthik</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Sanka</surname>
            <given-names>Ravi</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Sheth</surname>
            <given-names>Nihar</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Orvis</surname>
            <given-names>Joshua</given-names>
          </name>
          <xref ref-type="aff" rid="aff5">
            <sup>5</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Sodergren</surname>
            <given-names>Erica</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff6">
            <sup>6</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Wang</surname>
            <given-names>Zhengyuan</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Weinstock</surname>
            <given-names>George M.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff6">
            <sup>6</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Mitreva</surname>
            <given-names>Makedonka</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff6">
            <sup>6</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>The Genome Institute, Washington University School of Medicine, St. Louis, Missouri, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>The Broad Institute of MIT and Harvard, Cambridge, Massachusetts, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>J. Craig Venter Institute, Rockville, Maryland, United States of America</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Virginia Commonwealth University, Center for Study of Biological Complexity, Richmond, Virginia, United States of America</addr-line>       </aff><aff id="aff5"><label>5</label><addr-line>Insitute for Genome Sciences, University of Maryland School of Medicine, Baltimore, Maryland, United States of America</addr-line>       </aff><aff id="aff6"><label>6</label><addr-line>Department of Genetics, Washington University School of Medicine, St. Louis, Missouri, United States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Golden</surname>
            <given-names>Aaron Alain-Jon</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Albert Einstein College of Medicine, United States of America</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">mmitreva@watson.wustl.edu</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: MM GMW ES. Analyzed the data: JM SS SY KK RS NS JO ZW. Wrote the paper: JM GMW MM.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>13</day>
        <month>6</month>
        <year>2012</year>
      </pub-date><volume>7</volume><issue>6</issue><elocation-id>e36427</elocation-id><history>
        <date date-type="received">
          <day>22</day>
          <month>7</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>2</day>
          <month>4</month>
          <year>2012</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Martin et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>The Human Microbiome Project (HMP) aims to characterize the microbial communities of 18 body sites from healthy individuals. To accomplish this, the HMP generated two types of shotgun data: reference shotgun sequences isolated from different anatomical sites on the human body and shotgun metagenomic sequences from the microbial communities of each site. The alignment strategy for characterizing these metagenomic communities using available reference sequence is important to the success of HMP data analysis. Six next-generation aligners were used to align a community of known composition against a database comprising reference organisms known to be present in that community. All aligners report nearly complete genome coverage (&gt;97%) for strains with over 6X depth of coverage, however they differ in speed, memory requirement and ease of use issues such as database size limitations and supported mapping strategies. The selected aligner was tested across a range of parameters to maximize sensitivity while maintaining a low false positive rate. We found that constraining alignment length had more impact on sensitivity than does constraining similarity in all cases tested. However, when reference species were replaced with phylogenetic neighbors, similarity begins to play a larger role in detection. We also show that choosing the top hit randomly when multiple, equally strong mappings are available increases overall sensitivity at the expense of taxonomic resolution. The results of this study identified a strategy that was used to map over 3 tera-bases of microbial sequence against a database of more than 5,000 reference genomes in just over a month.</p>
      </abstract><funding-group><funding-statement>Research at Washington University was supported by National Institutes of Health (NIH) grants NIH-NHGRI U54HG003079 and U54HG004968, at the Broad Institute by grant U54HG004969, at the J. Craig Venter Institute U54AI084844 and research at Virginia Commonwealth University was supported by grant NIH-NIAID UH3AI083263. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="15"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>A key goal of the Human Microbiome Project (HMP) is the characterization of the microbial communities present in different body habitats <xref ref-type="bibr" rid="pone.0036427-Peterson1">[1]</xref>. An important part of this characterization is determining the presence and abundance of organisms within each habitat. The HMP generated three types of sequence data, sequences of the genes coding 16S rRNA and two types of shotgun data: reference sequences isolated from different anatomical sites on the human body and shotgun metagenomic sequences from the microbial communities of each site. The most widely used approach to report on species abundance in metagenomic collections is by surveying the bacterial 16S rRNA genes (e.g. <italic>see</italic> <xref ref-type="bibr" rid="pone.0036427-Handelsman1">[2]</xref>–<xref ref-type="bibr" rid="pone.0036427-Riesenfeld1">[3]</xref>). For metagenomic samples where there has been deep sequencing of 16S RNA, alignments are generated using a number of tools (such as ARB <xref ref-type="bibr" rid="pone.0036427-Kumar1">[4]</xref> and the NAST <xref ref-type="bibr" rid="pone.0036427-DeSantis1">[5]</xref>), and profiles of species presence and abundance from different sources are displayed individually or together in a plot. The 16S rRNA sequences are explored in phylogenetic or phylogeny-independent space <xref ref-type="bibr" rid="pone.0036427-Schloss1">[6]</xref>. However, while well defined and frequently used, 16S rRNA based community profiling has its limitations, such as the use of degenerate primers for 16S amplification that do not capture all community members, variable copy numbers of 16S rRNA genes in different species, the fact that PCR amplification is involved, the use of incomplete 16S rRNA databases and the inability to capture viruses and eukaryotes.</p>
      <p>An alternative method to characterize the structure of microbial communities is to generate shotgun metagenomic sequence, which provides advantages such as the exclusion of biases introduced by using 16S marker gene for community profiling. Shotgun sequencing bias is introduced mainly from the sequencing platform used and thus provides a better absolute measurement of species abundances than do 16S rRNA measurements assuming adequate coverage is generated. Hence, aligning the shotgun metagenomic sequences generated from samples originating from the different body habitats against microbial reference genomes can generate abundance tables that contain information for comparative metagenomics that are free of typical 16s biases. The best method for generating comprehensive abundance tables is to align the metagenomic shotgun reads against a collection of reference genomes comprising the whole genome sequences of all available microorganisms (including the four major superkingdoms, Archaea, Bacteria, Eukaryota and Viruses). To accomplish this in a timely and robust manner for the HMP, which generated over 7 tera-bases of sequence data, effort was invested in the exploration of available tools and methods.</p>
      <p>A wide variety of short read alignment software has been developed in recent years <xref ref-type="bibr" rid="pone.0036427-Li1">[7]</xref>, presenting the HMP with many potential tools capable of performing the analysis. We chose to limit this comparison to aligners with which members of the HMP Data Processing Group had experience. Since many short read aligners were designed for human re-sequencing which has limited sequence diversity, we relied on a prior knowledge of the variables each parameter represents in reaching our goal of choosing and optimizing an aligner for mapping shotgun metagenomic sequences to a database of reference genomes. We evaluated the performance of six aligners with regards to the identification of microbial sequences in shotgun metagenomic samples, and their correctness in taxonomic assignment and estimation of prevalence with the goal of ensuring that this analysis be both robust and timely. The aligners were evaluated on i) Accuracy, ii) Sensitivity, iii) Speed &amp; Scalability and iv) Convenience of use. The selected aligner was further evaluated, optimized alignment parameters were identified and the effect of mapping strategy on the ability to resolve hits at different taxonomic levels was investigated. Finally, taking into consideration that in many cases metagenomic reads originate from unculturable organisms or organisms not having a reference genome, we investigated the behavior of the aligner when the species known to be present in a community were removed, leaving only neighboring species from the same genus to be mapped against. This paper discusses these aligner optimizations in detail, describes the creation of the reference database and outlines the HMP’s read mapping Standard Operating Procedure.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>Reference Database Creation</title>
        <p>The final Reference Genome Database (RGD)(<xref ref-type="fig" rid="pone-0036427-g001">Figure 1</xref>) that was used in the ‘Mapping resolution’ analysis contained 1,751 bacterial genomes spread over 1,253 species. The other components of the database covered: i) Archaea: 131 genomes over 97 species, ii) Lower eukaryotes: 326 genomes over 326 species and iii) Viruses: 3,683 genomes over 1,420 species. The process of removing highly redundant bacterial strains (<italic>see</italic> <xref ref-type="sec" rid="s4">Methods</xref>) resulted in the elimination of 2,265 complete and draft bacterial genomes and corresponding plasmid sequences, resulting in 5891 remaining genomes across the four superkingdoms.</p>
        <fig id="pone-0036427-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036427.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Reference Genome Database creation.</title>
            <p>An overview of the process of creating our Reference Genome Database (RGD). Complete and WGS genomes were downloaded from GenBank, plasmid sequences were removed to simplify redundancy screening, and then the Mauve genome assembly tool was used to identify redundant strains that were subsequently removed (except for HMP stains which were always kept). For strains remaining after redundancy removal, their corresponding plasmids were restored into the database. This database was periodically updated as new strains became available over the course of the project.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.g001" xlink:type="simple"/>
        </fig>
        <p>The Mock Metagenomic Database (MMD) that was used for aligner comparisons and parameter optimization comprised 20 bacterial genomes from 17 genera and one archaeal strain (<italic>see</italic> <xref ref-type="sec" rid="s4">Methods</xref>). These 21 organisms are represented by 51 sequences in a fasta database about 82 Mb in size (<xref ref-type="supplementary-material" rid="pone.0036427.s001">Text S1</xref>).</p>
      </sec>
      <sec id="s2b">
        <title>Aligner Comparison</title>
        <p>The percentage of the 22,735,802 mock community reads that mapped to the Mock Metagenomic Database (MMD) ranged from 63% to 92%, with the two extremes being from SMALT and SOAP (<xref ref-type="table" rid="pone-0036427-t001">Table 1</xref>). All the aligners correctly show near-complete coverage of most genomes in the MMD with relatively similar abundances (<xref ref-type="table" rid="pone-0036427-t002">Table 2</xref>). Differences observed for the MAP and SMALT aligners may result from their inability to report alignments in which the query maps equally well to multiple locations. The MAP aligner was set to report hits using its topN setting of 5, and for SMALT, only the reads mapped uniquely were reported. The SOAP aligner showed uniformly less coverage across all genomes (<xref ref-type="table" rid="pone-0036427-t003">Table 3</xref>), and a statistically significant difference in depth of coverage was detected (at p = 0.05, Chi-square test). On average across all aligners, 82% of mock reads were mapped back to the MMD. When the detected strain abundances was compared to the actual mock community concentrations using Spearman’s rank test the correlation coefficients were between 0.7-0.8 (<xref ref-type="table" rid="pone-0036427-t004">Table 4</xref>).</p>
        <table-wrap id="pone-0036427-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0036427.t001</object-id><label>Table 1</label><caption>
            <title>Aligner metrics, requirements and performance.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0036427-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Aligners</td>
                <td align="left" colspan="1" rowspan="1">Default Parameters</td>
                <td align="left" colspan="1" rowspan="1">Mapping Style</td>
                <td align="left" colspan="1" rowspan="1">Memory Footprint (Gb)</td>
                <td align="left" colspan="1" rowspan="1">Databasesize limit limit</td>
                <td align="left" colspan="1" rowspan="1">Paired and fragment reads map together</td>
                <td align="left" colspan="1" rowspan="1">Time of run (minutes)</td>
                <td align="left" colspan="2" rowspan="1">Reads mapped</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">(#)</td>
                <td align="left" colspan="1" rowspan="1">% of total</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">SOAP</td>
                <td align="left" colspan="1" rowspan="1">M = 4 r = 1 m = 150 x = 600</td>
                <td align="left" colspan="1" rowspan="1">top random</td>
                <td align="left" colspan="1" rowspan="1">&lt;4</td>
                <td align="left" colspan="1" rowspan="1">4 Gb</td>
                <td align="left" colspan="1" rowspan="1">no</td>
                <td align="left" colspan="1" rowspan="1">84</td>
                <td align="left" colspan="1" rowspan="1">14,376,440</td>
                <td align="left" colspan="1" rowspan="1">63.23</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">MAP</td>
                <td align="left" colspan="1" rowspan="1">w = 16 a = 3–legacy-cigar</td>
                <td align="left" colspan="1" rowspan="1">topN = 5</td>
                <td align="left" colspan="1" rowspan="1">14</td>
                <td align="left" colspan="1" rowspan="1">no limit</td>
                <td align="left" colspan="1" rowspan="1">no</td>
                <td align="left" colspan="1" rowspan="1">24</td>
                <td align="left" colspan="1" rowspan="1">19,491,796</td>
                <td align="left" colspan="1" rowspan="1">85.73</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">SMALT</td>
                <td align="left" colspan="1" rowspan="1">f = samsoft</td>
                <td align="left" colspan="1" rowspan="1">unique only</td>
                <td align="left" colspan="1" rowspan="1">&lt;4</td>
                <td align="left" colspan="1" rowspan="1">varies<xref ref-type="table-fn" rid="nt101">*</xref></td>
                <td align="left" colspan="1" rowspan="1">no</td>
                <td align="left" colspan="1" rowspan="1">165</td>
                <td align="left" colspan="1" rowspan="1">20,874,489</td>
                <td align="left" colspan="1" rowspan="1">91.81</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">BWA</td>
                <td align="left" colspan="1" rowspan="1">&lt;default&gt;</td>
                <td align="left" colspan="1" rowspan="1">top random</td>
                <td align="left" colspan="1" rowspan="1">&lt;4</td>
                <td align="left" colspan="1" rowspan="1">4 Gb</td>
                <td align="left" colspan="1" rowspan="1">no</td>
                <td align="left" colspan="1" rowspan="1">120</td>
                <td align="left" colspan="1" rowspan="1">18,446,241</td>
                <td align="left" colspan="1" rowspan="1">81.13</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">CLC</td>
                <td align="left" colspan="1" rowspan="1">q p fb ss 180 250</td>
                <td align="left" colspan="1" rowspan="1">top random</td>
                <td align="left" colspan="1" rowspan="1">∼2</td>
                <td align="left" colspan="1" rowspan="1">no limit</td>
                <td align="left" colspan="1" rowspan="1">yes</td>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">20,184,374</td>
                <td align="left" colspan="1" rowspan="1">88.78</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">NOVOALIGN</td>
                <td align="left" colspan="1" rowspan="1">-F STDFQ -r Random -o SAM -I PE 215,50</td>
                <td align="left" colspan="1" rowspan="1">top random</td>
                <td align="left" colspan="1" rowspan="1">&lt;1</td>
                <td align="left" colspan="1" rowspan="1">20 Gb<xref ref-type="table-fn" rid="nt102">**</xref></td>
                <td align="left" colspan="1" rowspan="1">no</td>
                <td align="left" colspan="1" rowspan="1">206</td>
                <td align="left" colspan="1" rowspan="1">19,330,244</td>
                <td align="left" colspan="1" rowspan="1">85.02</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label>*</label>
              <p>varies depending on search window size.</p>
            </fn>
            <fn id="nt102">
              <label>**</label>
              <p>4 Gb x step size limit of aligner (max value 5).</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <table-wrap id="pone-0036427-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0036427.t002</object-id><label>Table 2</label><caption>
            <title>Sensitivity and specificity comparison.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0036427-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.t002" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="center" colspan="1" rowspan="1"/>
                <td align="center" colspan="1" rowspan="1"/>
                <td align="left" colspan="12" rowspan="1">Aligner and coverage</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="center" colspan="1" rowspan="1"/>
                <td align="center" colspan="1" rowspan="1"/>
                <td align="left" colspan="2" rowspan="1">BWA</td>
                <td align="left" colspan="2" rowspan="1">MAP</td>
                <td align="left" colspan="2" rowspan="1">CLC</td>
                <td align="left" colspan="2" rowspan="1">SMALT</td>
                <td align="left" colspan="2" rowspan="1">SOAP</td>
                <td align="left" colspan="2" rowspan="1">NOVOALIGN</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">Species</td>
                <td align="left" colspan="1" rowspan="1">Breadth</td>
                <td align="left" colspan="1" rowspan="1">Depth</td>
                <td align="left" colspan="1" rowspan="1">Breadth</td>
                <td align="left" colspan="1" rowspan="1">Depth</td>
                <td align="left" colspan="1" rowspan="1">Breadth</td>
                <td align="left" colspan="1" rowspan="1">Depth</td>
                <td align="left" colspan="1" rowspan="1">Breadth</td>
                <td align="left" colspan="1" rowspan="1">Depth</td>
                <td align="left" colspan="1" rowspan="1">Breadth</td>
                <td align="left" colspan="1" rowspan="1">Depth</td>
                <td align="left" colspan="1" rowspan="1">Breadth</td>
                <td align="left" colspan="1" rowspan="1">Depth</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Deinococcus radiodurans R1</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.98</td>
                <td align="left" colspan="1" rowspan="1">237.75</td>
                <td align="left" colspan="1" rowspan="1">98.79</td>
                <td align="left" colspan="1" rowspan="1">252.83</td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">295.15</td>
                <td align="left" colspan="1" rowspan="1">99.46</td>
                <td align="left" colspan="1" rowspan="1">292.42</td>
                <td align="left" colspan="1" rowspan="1">99.87</td>
                <td align="left" colspan="1" rowspan="1">165.49</td>
                <td align="left" colspan="1" rowspan="1">99.97</td>
                <td align="left" colspan="1" rowspan="1">245.59</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Acinetobacter baumannii ATCC 17978</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.98</td>
                <td align="left" colspan="1" rowspan="1">73.02</td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">76.73</td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">76.25</td>
                <td align="left" colspan="1" rowspan="1">99.52</td>
                <td align="left" colspan="1" rowspan="1">76.06</td>
                <td align="left" colspan="1" rowspan="1">99.90</td>
                <td align="left" colspan="1" rowspan="1">68.53</td>
                <td align="left" colspan="1" rowspan="1">99.98</td>
                <td align="left" colspan="1" rowspan="1">73.62</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Staphylococcus</italic>
                  <italic>epidermidis ATCC 12228</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">40.39</td>
                <td align="left" colspan="1" rowspan="1">99.55</td>
                <td align="left" colspan="1" rowspan="1">37.28</td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">42.22</td>
                <td align="left" colspan="1" rowspan="1">98.66</td>
                <td align="left" colspan="1" rowspan="1">41.99</td>
                <td align="left" colspan="1" rowspan="1">99.97</td>
                <td align="left" colspan="1" rowspan="1">38.94</td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">40.70</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Helicobacter pylori 26695</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.96</td>
                <td align="left" colspan="1" rowspan="1">38.76</td>
                <td align="left" colspan="1" rowspan="1">99.98</td>
                <td align="left" colspan="1" rowspan="1">41.64</td>
                <td align="left" colspan="1" rowspan="1">99.97</td>
                <td align="left" colspan="1" rowspan="1">40.43</td>
                <td align="left" colspan="1" rowspan="1">98.10</td>
                <td align="left" colspan="1" rowspan="1">39.45</td>
                <td align="left" colspan="1" rowspan="1">99.97</td>
                <td align="left" colspan="1" rowspan="1">36.66</td>
                <td align="left" colspan="1" rowspan="1">99.95</td>
                <td align="left" colspan="1" rowspan="1">39.04</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Bacteroides vulgatus</italic>
                  <italic>ATCC 8482</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">36.95</td>
                <td align="left" colspan="1" rowspan="1">99.51</td>
                <td align="left" colspan="1" rowspan="1">39.47</td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">38.75</td>
                <td align="left" colspan="1" rowspan="1">96.98</td>
                <td align="left" colspan="1" rowspan="1">37.53</td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">34.62</td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">37.24</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Propionibacterium acnes KPA171202</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.98</td>
                <td align="left" colspan="1" rowspan="1">34.96</td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">37.75</td>
                <td align="left" colspan="1" rowspan="1">99.98</td>
                <td align="left" colspan="1" rowspan="1">39.28</td>
                <td align="left" colspan="1" rowspan="1">99.52</td>
                <td align="left" colspan="1" rowspan="1">39.41</td>
                <td align="left" colspan="1" rowspan="1">99.98</td>
                <td align="left" colspan="1" rowspan="1">28.20</td>
                <td align="left" colspan="1" rowspan="1">99.98</td>
                <td align="left" colspan="1" rowspan="1">35.53</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Streptococcus</italic>
                  <italic>pneumoniae TI GR4</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">34.48</td>
                <td align="left" colspan="1" rowspan="1">99.38</td>
                <td align="left" colspan="1" rowspan="1">36.70</td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">35.88</td>
                <td align="left" colspan="1" rowspan="1">97.85</td>
                <td align="left" colspan="1" rowspan="1">34.97</td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">32.79</td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">34.74</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Streptococcus mutans UA159</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">22.15</td>
                <td align="left" colspan="1" rowspan="1">99.85</td>
                <td align="left" colspan="1" rowspan="1">23.74</td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">23.02</td>
                <td align="left" colspan="1" rowspan="1">98.24</td>
                <td align="left" colspan="1" rowspan="1">22.78</td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">21.11</td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">22.29</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Neisseria meningitidis MC58</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">21.60</td>
                <td align="left" colspan="1" rowspan="1">99.85</td>
                <td align="left" colspan="1" rowspan="1">24.94</td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">23.97</td>
                <td align="left" colspan="1" rowspan="1">95.00</td>
                <td align="left" colspan="1" rowspan="1">22.62</td>
                <td align="left" colspan="1" rowspan="1">99.89</td>
                <td align="left" colspan="1" rowspan="1">18.25</td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">21.85</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Staphylococcus aureus USA300_TCH1516</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">91.46</td>
                <td align="left" colspan="1" rowspan="1">20.90</td>
                <td align="left" colspan="1" rowspan="1">92.03</td>
                <td align="left" colspan="1" rowspan="1">22.64</td>
                <td align="left" colspan="1" rowspan="1">92.56</td>
                <td align="left" colspan="1" rowspan="1">22.91</td>
                <td align="left" colspan="1" rowspan="1">92.09</td>
                <td align="left" colspan="1" rowspan="1">22.75</td>
                <td align="left" colspan="1" rowspan="1">88.25</td>
                <td align="left" colspan="1" rowspan="1">20.73</td>
                <td align="left" colspan="1" rowspan="1">91.57</td>
                <td align="left" colspan="1" rowspan="1">21.52</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Actinomyces</italic>
                  <italic>odontolyticus ATCC 17982</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.90</td>
                <td align="left" colspan="1" rowspan="1">18.88</td>
                <td align="left" colspan="1" rowspan="1">99.94</td>
                <td align="left" colspan="1" rowspan="1">21.15</td>
                <td align="left" colspan="1" rowspan="1">99.94</td>
                <td align="left" colspan="1" rowspan="1">22.58</td>
                <td align="left" colspan="1" rowspan="1">99.37</td>
                <td align="left" colspan="1" rowspan="1">22.87</td>
                <td align="left" colspan="1" rowspan="1">99.51</td>
                <td align="left" colspan="1" rowspan="1">13.91</td>
                <td align="left" colspan="1" rowspan="1">99.91</td>
                <td align="left" colspan="1" rowspan="1">19.44</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Listeria monocytogenes EGD-e</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">15.52</td>
                <td align="left" colspan="1" rowspan="1">99.32</td>
                <td align="left" colspan="1" rowspan="1">15.85</td>
                <td align="left" colspan="1" rowspan="1">100.00</td>
                <td align="left" colspan="1" rowspan="1">16.12</td>
                <td align="left" colspan="1" rowspan="1">99.07</td>
                <td align="left" colspan="1" rowspan="1">16.15</td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">14.79</td>
                <td align="left" colspan="1" rowspan="1">99.99</td>
                <td align="left" colspan="1" rowspan="1">15.62</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Rhodobacter sphaeroides 2.4.1</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.05</td>
                <td align="left" colspan="1" rowspan="1">12.87</td>
                <td align="left" colspan="1" rowspan="1">99.23</td>
                <td align="left" colspan="1" rowspan="1">15.12</td>
                <td align="left" colspan="1" rowspan="1">99.60</td>
                <td align="left" colspan="1" rowspan="1">16.99</td>
                <td align="left" colspan="1" rowspan="1">99.41</td>
                <td align="left" colspan="1" rowspan="1">17.50</td>
                <td align="left" colspan="1" rowspan="1">95.12</td>
                <td align="left" colspan="1" rowspan="1">8.74</td>
                <td align="left" colspan="1" rowspan="1">98.92</td>
                <td align="left" colspan="1" rowspan="1">13.39</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Enterococcus faecalis OG1RF</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.96</td>
                <td align="left" colspan="1" rowspan="1">11.09</td>
                <td align="left" colspan="1" rowspan="1">99.97</td>
                <td align="left" colspan="1" rowspan="1">11.55</td>
                <td align="left" colspan="1" rowspan="1">99.97</td>
                <td align="left" colspan="1" rowspan="1">11.55</td>
                <td align="left" colspan="1" rowspan="1">99.26</td>
                <td align="left" colspan="1" rowspan="1">11.61</td>
                <td align="left" colspan="1" rowspan="1">99.92</td>
                <td align="left" colspan="1" rowspan="1">10.55</td>
                <td align="left" colspan="1" rowspan="1">99.95</td>
                <td align="left" colspan="1" rowspan="1">11.16</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Clostridium beijerinckii NCIMB 8052</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.90</td>
                <td align="left" colspan="1" rowspan="1">10.25</td>
                <td align="left" colspan="1" rowspan="1">98.99</td>
                <td align="left" colspan="1" rowspan="1">10.44</td>
                <td align="left" colspan="1" rowspan="1">99.91</td>
                <td align="left" colspan="1" rowspan="1">10.64</td>
                <td align="left" colspan="1" rowspan="1">98.65</td>
                <td align="left" colspan="1" rowspan="1">10.64</td>
                <td align="left" colspan="1" rowspan="1">99.88</td>
                <td align="left" colspan="1" rowspan="1">9.92</td>
                <td align="left" colspan="1" rowspan="1">99.90</td>
                <td align="left" colspan="1" rowspan="1">10.32</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Escherichia coli K12</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">99.48</td>
                <td align="left" colspan="1" rowspan="1">7.40</td>
                <td align="left" colspan="1" rowspan="1">98.95</td>
                <td align="left" colspan="1" rowspan="1">7.76</td>
                <td align="left" colspan="1" rowspan="1">99.62</td>
                <td align="left" colspan="1" rowspan="1">7.96</td>
                <td align="left" colspan="1" rowspan="1">98.49</td>
                <td align="left" colspan="1" rowspan="1">8.02</td>
                <td align="left" colspan="1" rowspan="1">98.72</td>
                <td align="left" colspan="1" rowspan="1">6.63</td>
                <td align="left" colspan="1" rowspan="1">99.40</td>
                <td align="left" colspan="1" rowspan="1">7.46</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Methanobrevibacter</italic>
                  <italic>smithii ATCC 35061</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">97.91</td>
                <td align="left" colspan="1" rowspan="1">6.54</td>
                <td align="left" colspan="1" rowspan="1">97.35</td>
                <td align="left" colspan="1" rowspan="1">6.72</td>
                <td align="left" colspan="1" rowspan="1">98.19</td>
                <td align="left" colspan="1" rowspan="1">6.79</td>
                <td align="left" colspan="1" rowspan="1">97.01</td>
                <td align="left" colspan="1" rowspan="1">6.87</td>
                <td align="left" colspan="1" rowspan="1">97.70</td>
                <td align="left" colspan="1" rowspan="1">6.46</td>
                <td align="left" colspan="1" rowspan="1">97.90</td>
                <td align="left" colspan="1" rowspan="1">6.59</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Bacillus cereus ATCC</italic>
                  <italic>10987</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">89.60</td>
                <td align="left" colspan="1" rowspan="1">3.18</td>
                <td align="left" colspan="1" rowspan="1">89.28</td>
                <td align="left" colspan="1" rowspan="1">3.26</td>
                <td align="left" colspan="1" rowspan="1">90.17</td>
                <td align="left" colspan="1" rowspan="1">3.30</td>
                <td align="left" colspan="1" rowspan="1">89.72</td>
                <td align="left" colspan="1" rowspan="1">3.38</td>
                <td align="left" colspan="1" rowspan="1">88.70</td>
                <td align="left" colspan="1" rowspan="1">3.44</td>
                <td align="left" colspan="1" rowspan="1">89.58</td>
                <td align="left" colspan="1" rowspan="1">3.21</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Pseudomonas aeruginosa PAO1</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">80.50</td>
                <td align="left" colspan="1" rowspan="1">2.24</td>
                <td align="left" colspan="1" rowspan="1">82.50</td>
                <td align="left" colspan="1" rowspan="1">2.59</td>
                <td align="left" colspan="1" rowspan="1">86.18</td>
                <td align="left" colspan="1" rowspan="1">2.84</td>
                <td align="left" colspan="1" rowspan="1">89.41</td>
                <td align="left" colspan="1" rowspan="1">3.16</td>
                <td align="left" colspan="1" rowspan="1">65.73</td>
                <td align="left" colspan="1" rowspan="1">2.31</td>
                <td align="left" colspan="1" rowspan="1">79.80</td>
                <td align="left" colspan="1" rowspan="1">2.32</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Streptococcus agalactiae 2603V/R</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">47.94</td>
                <td align="left" colspan="1" rowspan="1">0.91</td>
                <td align="left" colspan="1" rowspan="1">47.76</td>
                <td align="left" colspan="1" rowspan="1">0.92</td>
                <td align="left" colspan="1" rowspan="1">49.00</td>
                <td align="left" colspan="1" rowspan="1">0.96</td>
                <td align="left" colspan="1" rowspan="1">51.63</td>
                <td align="left" colspan="1" rowspan="1">1.03</td>
                <td align="left" colspan="1" rowspan="1">46.94</td>
                <td align="left" colspan="1" rowspan="1">1.88</td>
                <td align="left" colspan="1" rowspan="1">48.02</td>
                <td align="left" colspan="1" rowspan="1">0.92</td>
              </tr>
              <tr>
                <td align="left" colspan="3" rowspan="1">
                  <italic>Lactobacillus gasseri</italic>
                  <italic>ATCC 33323</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">20.05</td>
                <td align="left" colspan="1" rowspan="1">0.31</td>
                <td align="left" colspan="1" rowspan="1">20.98</td>
                <td align="left" colspan="1" rowspan="1">0.33</td>
                <td align="left" colspan="1" rowspan="1">20.73</td>
                <td align="left" colspan="1" rowspan="1">0.32</td>
                <td align="left" colspan="1" rowspan="1">25.98</td>
                <td align="left" colspan="1" rowspan="1">0.42</td>
                <td align="left" colspan="1" rowspan="1">19.64</td>
                <td align="left" colspan="1" rowspan="1">1.53</td>
                <td align="left" colspan="1" rowspan="1">20.11</td>
                <td align="left" colspan="1" rowspan="1">0.31</td>
              </tr>
            </tbody>
          </table></alternatives></table-wrap>
        <p>A detection cutoff of 1% breadth and 0.01x depth of coverage was used allowing the detection of low abundance species (such as <italic>Escherichia coli</italic> in the gut, e.g. <xref ref-type="bibr" rid="pone.0036427-Eckburg1">[8]</xref>) while reducing the incidence of only spurious alignments being reported. All programs identified the most abundant species present in the proper order of prevalence, and in fact were able to detect all 21 bacterial species present in the mock community mixture. Some key aberrations include the observation that the SOAP aligner found a notably smaller depth of coverage for the most abundant organism (<italic>Deinococcus radiodurans R1</italic>) and also found a noticeably lower breadth of coverage for one of the less abundant species (<italic>Pseudomonas aeruginosa PAO1</italic>). The alignment softwares were also benchmarked for their performance and other limitations such as the maximum size of the database that can be searched against. The database size for BWA and SOAP is limited to 4 Gb (<xref ref-type="table" rid="pone-0036427-t001">Table 1</xref>), and while SMALT claims to allow larger database sizes as the default search window size is increased, we had difficulties getting anything larger than a 6 Gb database to work reliably on available hardware. Novoalign supports searches against databases of up to 4 Gb x the ‘step size limit’ of the aligner, which has a maximum value of 5, resulting in a limit of 20 Gb. Using default settings for Novoalign we were able to handle the 7.3 Gb RGD, however it was the slowest aligner tested (<xref ref-type="table" rid="pone-0036427-t001">Table 1</xref>). Both MAP and CLC are limited only by how much memory can be made available on the machine running the alignment software although it appears that the CLC aligner is somewhat more memory efficient in comparison to MAP. CLC also proved to be the only aligner capable of mapping both paired end reads and fragment reads from a sample in a single execution while taking advantage of pairing information. In summary, the CLC aligner displayed the best speed and a small memory footprint, is able to handle the 7.3 Gb RGD in a single alignment on our current hardware and it has the ability to map both paired end reads and fragment reads in a single execution while taking advantage of pairing information (<xref ref-type="table" rid="pone-0036427-t001">Table 1</xref>). Therefore, the CLC aligner was chosen for further analyses reported in this paper.</p>
      </sec>
      <sec id="s2c">
        <title>Parameter Optimization</title>
        <p>We looked first at the total number of reads mapped at each parameter combination. The Illumina GAIIx reads from the mock community (22,735,802 reads) were aligned to the MMD, which contained genome sequences for all organisms in the mock community. We found that the minimum length of alignment required (in terms of query length) has more of an effect on mapping sensitivity than does varying the percent identity required within the length of the alignment (<xref ref-type="fig" rid="pone-0036427-g002">Figure 2</xref>, Mock vs. Mock data). The two less-stringent length settings perform similarly well, while the 100% length requirement results in a significant decrease in hits detected. In all cases, decreasing the percent identity requirement causes a minor increase in the number of hits detected, but this change is trivial compared to reducing the length constraint below 100%.</p>
        <p>The different parameter combinations were also evaluated in regards to their ability to identify each genus independently by looking at the effects on the breadth and depth of coverage for all the genomes present in the mock community. <xref ref-type="supplementary-material" rid="pone.0036427.s006">Figure S2A</xref> shows the parameter effects on breadth of coverage, and <xref ref-type="supplementary-material" rid="pone.0036427.s006">Figure S2B</xref> shows the effect on depth of coverage at the genus level. In both breadth and depth of coverage, only the 100% length requirement seems to have an impact on the ability to detect organisms at the genus level. That most stringent length criteria fails to identify almost 15% of the <italic>P. aeruginosa PAO1</italic> reference sequence that can be picked up by the less conservative cutoffs (<xref ref-type="supplementary-material" rid="pone.0036427.s006">Figure S2A</xref>). Looking at the detected depth of coverage also shows a significant loss of sensitivity when using the 100% length cutoff. In this case the most obvious effect can be seen in the most abundant genus <italic>Deinococcus</italic>, reducing the depth of coverage by 100 fold when subjected to the more stringent length requirement. Similar but smaller effects can be seen in most of the other genera (<xref ref-type="supplementary-material" rid="pone.0036427.s006">Figure S2B</xref>).</p>
        <table-wrap id="pone-0036427-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0036427.t003</object-id><label>Table 3</label><caption>
            <title>Chi-square comparison of detected abundances<xref ref-type="table-fn" rid="nt103">*</xref>.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0036427-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.t003" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">SOAP</td>
                <td align="left" colspan="1" rowspan="1">MAP</td>
                <td align="left" colspan="1" rowspan="1">SMALT</td>
                <td align="left" colspan="1" rowspan="1">BWA</td>
                <td align="left" colspan="1" rowspan="1">CLC</td>
                <td align="left" colspan="1" rowspan="1">NOVOALIGN</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">SOAP</td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">0.28385</td>
                <td align="left" colspan="1" rowspan="1">0.0217</td>
                <td align="left" colspan="1" rowspan="1">0.49387</td>
                <td align="left" colspan="1" rowspan="1">0.01281</td>
                <td align="left" colspan="1" rowspan="1">0.37475</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">MAP</td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">0.99972</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0.99992</td>
                <td align="left" colspan="1" rowspan="1">1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">SMALT</td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">0.9992</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0.99991</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">BWA</td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">0.99989</td>
                <td align="left" colspan="1" rowspan="1">1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">CLC</td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">0.99997</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">NOVOALIGN</td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt103">
              <label>*</label>
              <p>Based on depth of coverage per genome. Values &gt; = 0.05 are considered significantly similar.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <table-wrap id="pone-0036427-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0036427.t004</object-id><label>Table 4</label><caption>
            <title>Spearman's rank correlation with true MMD concentration.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0036427-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.t004" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Aligner</td>
                <td align="left" colspan="1" rowspan="1">Correlation coefficient</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">SOAP</td>
                <td align="left" colspan="1" rowspan="1">0.6960784</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">MAP</td>
                <td align="left" colspan="1" rowspan="1">0.7720588</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">SMALT</td>
                <td align="left" colspan="1" rowspan="1">0.7941176</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">BWA</td>
                <td align="left" colspan="1" rowspan="1">0.7573529</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">CLC</td>
                <td align="left" colspan="1" rowspan="1">0.7916667</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">NOVOALIGN</td>
                <td align="left" colspan="1" rowspan="1">0.7720588</td>
              </tr>
            </tbody>
          </table></alternatives></table-wrap>
        <p>Often the genome of the exact strain present in a microbial community is not represented in the RGD. Therefore, we tested the parameters under low identity conditions, when the exact query strain is not present in the reference, but a taxonomically related organism from the same genus is (<xref ref-type="table" rid="pone-0036427-t005">Table 5</xref>). The same set of alignment parameters was used, but the MMD was amended by replacing several of the strains present with other organisms of the same genus (<xref ref-type="table" rid="pone-0036427-t005">Table 5</xref> describes the amended MMD strains and their similarity to the original strain that they replaced and <xref ref-type="fig" rid="pone-0036427-g003">Figure 3</xref> displays a 16S rRNA tree showing the phylogeny of the original 21 organisms and the 4 new amended ones). When recording the total numbers of reads mapped at each cutoff combination, the major effect was still the same, i.e., varying the length constraint has the largest effect on alignment sensitivity. But this time we observed that the less stringent 80% identity cutoff can map ∼5% more reads than the more stringent 90% cutoff (<xref ref-type="fig" rid="pone-0036427-g002">Figure 2</xref>). These additional identifications are likely due to conservation between phylogenetically related species (<xref ref-type="fig" rid="pone-0036427-g002">Figure 2</xref>, Mock vs. Amended data). The number of reads hitting the modified MMD drops from ∼80% down to ∼45% overall because one of the species swapped out was the most abundant organism in the mock community, <italic>D. radiodurans R1</italic>. A large number of possible mappings for the mock query set were lost when <italic>Deinococcus geothermalis,</italic> a species only ∼46% similar at the genome level, was swapped in for <italic>D. radiodurans R1</italic>.</p>
        <fig id="pone-0036427-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036427.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Parameter effects on mapping against the MMD and the amended MMD.</title>
            <p>This plot shows the percent of total mock queries able to be mapped to the mock database at each given CLC parameter combination. The Mock vs. Mock data (dark blue) uses the original MMD, which contains all strains present in the mock community. The Mock vs. Amended data (light blue) shows the same results when the mock query is mapped to an amended MMD where several strains were removed and other strains from the same genus were included in their place.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.g002" xlink:type="simple"/>
        </fig>
        <p>Looking into the coverage of the amended MMD (<xref ref-type="supplementary-material" rid="pone.0036427.s007">Figure S3</xref>), we observed that the strains that were replaced all suffer a loss of both depth and breadth of coverage, but this time a more pronounced effect was seen from the percent similarity requirement on these alignments. Also, while the depth and breadth covered across all 5 amended genera did drop, they did not drop to zero, suggesting retained coverage of the conserved regions among the original and replaced genomes. <xref ref-type="fig" rid="pone-0036427-g004">Figure 4</xref> gives an overview of these effects, showing that the 4 genera with amended strains fall off the diagonal when plotting log transformed depth values between mappings to the original MMD and mappings to the amended MMD. The genus <italic>Streptococcus</italic> was also amended, but this genus was one of two genera in the mock community represented by more than a single species (the other being <italic>Staphylococcus</italic>). Rather than replacing all 3 <italic>Streptococcus</italic> species, in this case 2 of the 3 original species were removed, leaving only <italic>Streptococcus mutans UA159</italic>. Depth values for these multi-species genera were calculated as the mean of the member species and the depth of coverage for <italic>S. mutans UA159</italic> alone is very close to the mean depth of all 3 <italic>Streptococcus</italic> species. Thus it falls on the diagonal along with the other, un-amended genera.</p>
        <fig id="pone-0036427-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036427.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Phylogenetic tree view of MMD strains and amended MMD strains based on 16S genes.</title>
            <p>This image displays a phylogenetic tree based on 16S data for all 21 strains in the MMD, and also the 4 strains used as replacements in the amended MMD (<italic>D. geothermalis</italic>, <italic>Helicobacter hepaticus</italic>, <italic>Neisseria gonorrheae</italic> and <italic>Escherichia fergusonii</italic>). The shaded regions indicate the genera containing the amended strains (yellow: <italic>Escherichia</italic>, blue: <italic>Neisseria</italic>, red: <italic>Helicobacter</italic>, brown: <italic>Streptococcus</italic> and green: <italic>Deinococcus</italic>).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.g003" xlink:type="simple"/>
        </fig>
        <p>Basing the decision on these observations, the suggested cutoff for community profiling using shotgun metagenomic sequences is 80% identity over 75% of the length of the query. This setting represents a good balance between sensitivity and accuracy, even in an environment where not all strains in the community will be represented in the reference database.</p>
        <table-wrap id="pone-0036427-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0036427.t005</object-id><label>Table 5</label><caption>
            <title>Amended strain similarity to original MMD strains.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0036427-t005-5" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.t005" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Genus</td>
                <td align="left" colspan="1" rowspan="1">Original strain in mock community</td>
                <td align="left" colspan="1" rowspan="1">Replacement strain</td>
                <td align="left" colspan="1" rowspan="1">Genome wide similarity</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Deinococcus</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Deinococcus radiodurans R1</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Deinococcus geothermalis</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">∼46%</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Helicobacter</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Helicobacter pylori</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Helicobacter hepaticus</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">∼15%</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Neisseria</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Neisseria meningitidis</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Neisseria gonorrheae</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">∼81%</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Escherichia</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Escherichia coli K12</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Escherichia fergusonii</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">∼78%</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Streptococcus agalactiae 2603V/R</italic>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Streptococcus</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Streptococcus mutans UA159</italic>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Streptococcus mutans UA159</italic>
                  <xref ref-type="table-fn" rid="nt104">*</xref>
                </td>
                <td align="left" colspan="1" rowspan="1">na</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">
                  <italic>Streptococcus pneumoniae TIGR4</italic>
                </td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt104">
              <label>*</label>
              <p>For <italic>Streptococcus</italic>, 2 of the 3 strains were removed, leaving only S.mutans UA159.</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
      <sec id="s2d">
        <title>Mapping Resolution Analysis</title>
        <p>We next mapped the reads from the mock community against the RGD. When using the ‘top random’ mapping strategy (when the aligner randomly reports one hit in the case of multiple equally high scoring top hits) with 80% identity and a 75% fraction of length cutoff, 67% of all mappings are to the correct strains present in the mock community, 21% map to non-mock community strains but within the correct genus, 12% of reads don’t map at all and close to 0% of reads (63,321 out of 22,735,802) map to an organism of the wrong genus (<xref ref-type="fig" rid="pone-0036427-g005">Figure 5A</xref>). When using the same alignments re-parsed under ‘unique placement only’ rules (query aligning equally well to more than a single location in the reference is not reported as a hit), only 58% of the reads are mapping to the correct strain, with the majority of the remainder not able to map uniquely (<xref ref-type="fig" rid="pone-0036427-g005">Figure 5B</xref>).</p>
        <p>Considering these results at the species rather than the genus level, we find that under the top random mapping strategy, about 4% of the reads that had previously been classified to the correct genus were not able to be assigned to the correct species (<xref ref-type="fig" rid="pone-0036427-g005">Figure 5C</xref>). This 4% false positive rate is not seen when using the unique only alignment strategy. Under unique only rules, reads that do map can be annotated at the species level with almost the same confidence as they can be at the genus level.</p>
        <fig id="pone-0036427-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036427.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>A comparison of mock and amended MMD depth of coverage.</title>
            <p>This plot shows the log transformed depth values for the mock query versus the amended MMD on the y-axis, and the mock query versus the original MMD on the x-axis. Unaffected genera should lie along the diagonal, while those showing a change in depth of coverage will fall off the diagonal. The amended genera are indicated, and the 4 that were swapped do stand off the diagonal. The genus <italic>Streptococcus</italic> was represented by 3 strains in the mock community, and was amended by removing two of the three strains leaving only <italic>S. mutans UA159</italic> in the amended MMD. The depth value of this multi-strain genus was the read normalized average value of the 3 member strains, and after being pruned down to a single strain, the single strain depth remained similar to the original, averaged value.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.g004" xlink:type="simple"/>
        </fig>
        <p>We also plotted the detected coverage of mock strains when the 22,735,802 mock query sequences were aligned against both the MMD and RGD under both top random and unique placement only mapping strategies. When mapped against the MMD, both strategies displayed very similar coverage for all strains (<xref ref-type="fig" rid="pone-0036427-g006">Figure 6A</xref>). However, results against the RGD show that the number of strains represented in the database within each genus has a significant effect on the coverage of the specific organism in the mock community (<xref ref-type="fig" rid="pone-0036427-g006">Figure 6B</xref>). Mock community organisms with many similar strains available within the reference database show good breadth of coverage under top random rules, but poor coverage under unique placement only rules (e.g. <italic>Bacteroides vulgatus ATCC 8482</italic>, the <italic>Streptococcus</italic> strains and the <italic>Staphylococcus</italic> strains). While organisms with very few related genomes show similar detected coverage under both rule sets (e.g. <italic>D. radiodurans R1</italic>, <italic>Rhodobacter sphaeroides 2.4.1</italic> and <italic>Methanobrevibacter smithii ATCC 35061</italic>).</p>
        <fig id="pone-0036427-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036427.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Mapping Resolution.</title>
            <p>(<bold>A</bold>). <bold>Using a top random mapping strategy to classify at the strain or genus level.</bold> This image shows the mapping fate of all 22,735,802 mock queries when mapped to the RGD under a top random mapping strategy, falling back to genus level annotations when the strain cannot be identified. (<bold>B</bold>). <bold>Using a unique only mapping strategy to classify at the strain or genus level.</bold> This image shows the mapping fate of all 22,735,802 mock queries when mapped to the RGD under a unique only mapping strategy, falling back to genus level annotations when the strain cannot be identified. (<bold>C</bold>). <bold>Using a top random mapping strategy to classify at the strain or species level.</bold> This image shows the mapping fate of all 22,735,802 mock queries when mapped to the RGD under a top random mapping strategy, falling back to species level annotations when the strain cannot be identified. (<bold>D</bold>). <bold>Using a unique only mapping strategy to classify at the strain or species level.</bold> This image shows the mapping fate of all 22,735,802 mock queries when mapped to the RGD under a unique only mapping strategy, falling back to species level annotations when the strain cannot be identified.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.g005" xlink:type="simple"/>
        </fig>
        <p>We found two cases for which this observation did not hold true. The mock strains <italic>Bacillus cereus ATCC 10987</italic> and <italic>Clostridium beijerinckii NCIMB 8052</italic> have 104 and 63 strains available within their genera respectively, yet demonstrated similar coverage results under both top random and unique only strategies. To investigate this effect we examined the coverage of all <italic>Bacillus</italic> strains and all <italic>Clostridium</italic> strains available in the RGD independently under both mapping strategies. <xref ref-type="fig" rid="pone-0036427-g007">Figures 7A and 7B</xref> show the top 20 most covered strains in each case under both alignment strategies. In both experiments it can be seen that the only strain with significant coverage under either strategy is the strain represented in the mock community. Conversely, we performed a similar experiment using two strains that behaved more as expected, <italic>B. vulgatus ATCC 8482</italic> and <italic>E. coli K-12 MG1655</italic>. <xref ref-type="fig" rid="pone-0036427-g007">Figures 7C and 7D</xref> show that in both cases there is significant bleed over coverage into neighboring, non-mock community strains that prevents the unique only mapping strategy from detecting significant coverage (since few reads are uniquely mappable in these strains), while top random coverage is divided amongst a number of conserved strains.</p>
        <fig id="pone-0036427-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036427.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Mock strain coverage.</title>
            <p>(<bold>A</bold>). <bold>Coverage of mock strains in the MMD.</bold> This image shows the results of mapping the mock community query against the MMD under both top random and unique only mapping strategies. (<bold>B</bold>). <bold>Coverage of mock strains in the RGD.</bold> This image shows the results of mapping the mock community query against the RGD under both top random and unique only mapping strategies. The numbers printed in the plot reflect the number of strains present in the RGD for the genus in which the displayed strain belongs.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.g006" xlink:type="simple"/>
        </fig>
        <fig id="pone-0036427-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0036427.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>The effect of strain representation within the RGD and mapping strategy on mapping resolution.</title>
            <p>(<bold>A</bold>). <bold>Top 20 most covered strains from the genus </bold><bold><italic>Bacillus</italic></bold><bold> found in mock vs. RGD mapping.</bold> This figure shows the detected coverage using both mapping strategies when aligning the mock community queries against the full RGD for <italic>Bacillus</italic> strains. Note that the strain present in the mock community (<italic>B. cereus ATCC 10987</italic>) is indicated in the image. (<bold>B</bold>). <bold>Top 20 most covered strains from the genus </bold><bold><italic>Clostridium</italic></bold><bold> found in mock vs. RGD mapping.</bold> This figure shows the detected coverage using both mapping strategies when aligning the mock community queries against the full RGD for <italic>Clostridium</italic> strains. Note that the strain present in the mock community (<italic>C. beijerinckii NCIMB 8052</italic>) is indicated in the image. (<bold>C</bold>). <bold>Top 20 most covered strains from the genus </bold><bold><italic>Bacteroides</italic></bold><bold> found in mock vs. RGD mapping.</bold> This figure shows the detected coverage using both mapping strategies when aligning the mock community queries against the full RGD for <italic>Bacteroides</italic> strains. Note that the strain present in the mock community (<italic>B. vulgatus ATCC 8482</italic>) is indicated in the image. (<bold>D</bold>). <bold>Top 20 most covered strains from the genus </bold><bold><italic>Escherichia</italic></bold><bold> found in mock vs. RGD mapping.</bold> This figure shows the detected coverage using both mapping strategies when aligning the mock community queries against the full RGD for <italic>Escherichia</italic> strains. Note that the strain present in the mock community (<italic>E. coli K-12 MG1655</italic>) is indicated in the image.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.g007" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>The accuracy was similar for most of the tested aligners, therefore primarily convenience issues, such as which tool has the smallest memory footprint and which tool benchmarks the fastest, drove the choice of aligner. Additional major determining factors were, i) which aligner could handle the size of our reference database, and ii) which aligner could map both paired end reads and fragment reads in a single execution. The number of reference genomes is increasing with a rapid rate. For example, only the HMP project is committed to sequencing 3,000 bacterial genomes over its course, resulting in an ever-increasing size of the RGD (presently 7.3 Gb). Many available next generation aligners impose a 4 Gb database size limitation, which is a technical hurdle for mapping algorithms that use the Burrows-Wheeler transform in their implementation (e.g. <xref ref-type="bibr" rid="pone.0036427-Li2">[9]</xref>, <xref ref-type="bibr" rid="pone.0036427-Li3">[10]</xref>). Additionally, steps within the read mapping process (see <xref ref-type="supplementary-material" rid="pone.0036427.s002">Text S2</xref>) prior to alignment result in a fraction of the paired end reads being orphaned during low complexity screening, resulting in a sample having both a set of paired end reads, and a fragment read file that both need to be aligned. These issues together would have been a computational hurdle because they would have required us to run four alignments per sample to scan the full breadth of the RGD.</p>
      <p>The SOAP aligner was a statistically significant outlier, detecting fewer hits to all strains in the MMD as compared to the other aligners. BWA’s primary weakness was its inability to handle a database larger than 4 Gb in size. The SMALT aligner, while claiming to be able support larger databases if the user increases search window size, was unable to handle a database larger than 6 Gb in our hands. In addition, the loss of sensitivity prompted by an increased window size (data not shown) was of concern. Novoalign displayed the smallest memory footprint of all aligners tested during our benchmarking. Its limitation proved to be speed, clocking in as the slowest aligner tested (over 10 fold slower than the frontrunner). MAP performed similarly to CLC, and was able to support the large database size we required, but the version tested was limited in that the only available mapping strategy revolved around their topN setting, which will only report hits with that number or fewer identical top hits (i.e. topN = 5 tells MAP not to report a query that aligns equally well to &gt;5 spots in the reference). Drastically increasing the topN value to ensure we are not missing hits caused a significant increase in the amount of memory needed to complete the alignment. Note that parameter modifications have since been made in MAP to address this issue (Brian Hilbush, RealTime Genomics, personal communication), but only after this evaluation had been completed. Finally, only the CLC aligner was able to map both fragment and paired end reads in a single execution while still considering read paring information. While several aligners achieved similar levels of sensitivity and accuracy, the overall feature set that CLC offered tipped the balance and so it was selected for the optimization related analysis in our study.</p>
      <p>None of the aligners compared were able to map 100% of the 22,735,802 mock community reads back to the MMD. Depending on the aligner, only 63% to 92% of the mock community queries could be aligned (<xref ref-type="table" rid="pone-0036427-t001">Table 1</xref>). This is attributed in part to the fact that the mock query data had not been screened for low complexity. The DUST application <xref ref-type="bibr" rid="pone.0036427-Hancock1">[11]</xref> was used to mask low complexity sequence and subsequently remove it from the query set. This filtering accounted for 3-4% of the unmappable queries (data not shown). The inability to map the remainder of the reads is likely due to the fact that: i) of the 21 genomes included in the MMD, 2 are based on draft assemblies (<italic>Actinomyces odontolyticus ATCC 17982</italic> and <italic>Enterococcus faecalis OG1RF</italic>) therefore may not be complete representations of their respective genomes and ii) not all plasmid sequences associated with each strain were available in GenBank when the MMD was created.</p>
      <p>The CLC parameters were tested to achieve maximum sensitivity while minimizing false positives on a gross level. Due to limitations in the availability of bacterial organisms for inclusion in the reference database, no amount of parameter tweaking will be able to completely overcome problems with false positives detection, but by considering the problem at a higher taxonomic level (the genus level), where we do have good representation across the phylogeny, we were able to arrive at a parameter combination that could provide a relatively good profiling of a microbial community.</p>
      <p>Based on the results, in the ideal case when all organisms in the query pool are represented in the database (as in the case of aligning the mock query data against the MMD), it is apparent that the length constraint has a much stronger impact on sensitivity than did the various similarity settings tested. And it was also apparent that only the most stringent length requirements hampered sensitivity. But when we attempted to model the state of live data by replacing several strains with other organisms from within the same genus, we began to see a difference in community structure reflecting changes of required percent identity. This is expected when sequences are mapped to more divergent strains. Furthermore, there is a significant overall decrease in detection caused by the substitution of <italic>D. geothermalis</italic> <xref ref-type="bibr" rid="pone.0036427-Makarova1">[12]</xref> for <italic>D. radiodurans R1</italic>. <italic>D. radiodurans R1</italic> <xref ref-type="bibr" rid="pone.0036427-White1">[13]</xref> is by far the most abundant strain present in the mock community, and its replacement (<italic>D. geothermalis</italic>) is only ∼46% similar at a genome wide level, so this was an expected result. Somewhat surprising is the fact that when the genus <italic>Streptococcus</italic> was modified by removing two of the three mock species present <xref ref-type="bibr" rid="pone.0036427-Ajdic1">[14]</xref>, <xref ref-type="bibr" rid="pone.0036427-Tettelin1">[15]</xref>, <xref ref-type="bibr" rid="pone.0036427-Tettelin2">[16]</xref>, the depth found for the remaining genome alone was approximately equivalent to the average depth found across all three <italic>Streptococcus</italic> species in the original MMD. One could have expected that under a top random mapping strategy the remaining species would have captured the reads that had originally mapped to the now missing species, increasing its reported depth of coverage. But instead we observed the same depth of coverage for the remaining species as was originally seen. A possible explanation for this is that the two removed species were diverse enough from <italic>S. mutans UA159</italic> to prevent any kind of cross mapping. Consistent with this, genome-wide pair-wise alignments between <italic>S. mutans UA159</italic> and the other two genomes shows a ∼51% and ∼35% similarity to <italic>Streptococcus agalactiae 2603V/R</italic> and <italic>Streptococcus pneumoniae TIGR4</italic> respectively.</p>
      <p>The experiment investigating the effects of mapping strategy on taxonomic resolution (i.e. the ability to correctly identify an organism at a given taxonomic level) showed a clear trade-off between the fraction of the reads representing a sample that can be characterized and the accuracy of that classification. As shown in <xref ref-type="fig" rid="pone-0036427-g005">Figure 5</xref>, 88% of all reads can find a hit under the top random mapping strategy, but 21% of those alignments are incorrect at the strain level. Thus, using this strategy, we can only confidently classify reads to higher order taxonomies (the genus level in this figure). Under the unique placement only strategy we are able to annotate only 58% of reads, but in this case the characterization is accurate at the strain level. This ability to classify data to the strain level represents a key advantage that shotgun metagenomic sequences have over 16s rRNA characterizations made with the commonly-used RDP algorithm <xref ref-type="bibr" rid="pone.0036427-Wang1">[17]</xref> which typically makes identifications (at 0.8 level of confidence) at the genus level.</p>
      <p>Looking into the effect of strain representation within the reference database on mapping resolution, we found a relationship between the number of strains available in the RGD under a given genus and our ability to resolve down to the strain level. Mappings performed against the MMD, where only the mock strains known to be present were available, showed that mapping strategy played little role in the ability to detect coverage. In such a perfect scenario almost any hit will be to the correct strain because there are no phylogenetically closely related neighbors to compete for alignment within conserved regions that could preclude its detection under unique placement only rules. But when a query metagenomic shotgun sequence is mapped to the RGD, strains with many similar neighbors available in the database preclude accurate mappings to finer grained taxonomic levels. In summary, genera with many strains available in the reference database, such as <italic>Bacteroides</italic>, <italic>Lactobacillus</italic>, <italic>Staphylococcus</italic> and <italic>Streptococcus</italic> will present a challenge when trying to resolve to the strain level using the unique only mapping strategy. Genera with few strains available will offer strong resolving power using either mapping strategy. In the two examples where this did not hold true, the mock community strains were considerably divergent from other organisms within their genus (<xref ref-type="fig" rid="pone-0036427-g007">Figure 7</xref>) <xref ref-type="bibr" rid="pone.0036427-Rasko1">[18]</xref>.</p>
      <p>Furthermore, based on alignments of the mock queries against the RGD under the top random alignment strategy, we found that the number of false positive identifications at the species level is higher than what is seen when taxonomic assignments are made at the genus level. Approximately 4% of these classifications are incorrect at the species level, but all of those reads can be mapped to the correct genus. When using the unique only mapping protocol, we did find a few more false positive classifications at the species level, but the overall misclassification rate was not significantly inflated (0.3% false positive rate). This is expected because the only time a misclassification can happen under unique only rules is when the sequence’s strain of origin is missing from the RGD, but the read happens to fall into a region that is divergent from other close neighbors within the same species, but conserved in some other organism represented in the database. Based on our results, this is a very rare event.</p>
      <p>In future studies, the more advanced approach would be to generate a pan-genome (e.g. <xref ref-type="bibr" rid="pone.0036427-Medini1">[19]</xref>) reference database in which only the unique portions of genomes are represented. By maintaining only single instances of highly conserved regions, and by tracking which genomes share these unique conserved regions, one could confidently classify the shotgun metagenomic sequences to a lower taxonomic resolution more confidently. Using a pan-genome reference would allow either mapping strategy, top random and unique only, to see conserved sequence and offers solid annotation for all genomes sharing that region. This will allow the user to fine tune the taxonomic resolution based on available information, sometimes allowing annotation down to the species level where previously one could only assign a genus level classification.</p>
      <p>In conclusion, we compared six short read aligners for the purpose of identifying an aligner and parameters that will enable accurate profiling of metagenomic communities for any project that uses large NGS datasets and aims at completing the analysis within a reasonable timeframe. We used a mock community sample of known composition and aligned it against the MMD, which comprises genome sequences of all organisms in the community. Five of the six aligners perform similarly well, with the notable exception of the SOAP aligner, which seemed to detect less coverage in general. The selection of CLC aligner was prompted by several practical factors: i) the ability to handle large databases, ii) its ability to map both paired end and fragment sequence data in a single operation and iii) its speed and small memory footprint. The MAP aligner held a respectable second place, but its lack of support for traditional top random &amp; unique only mapping strategies (at the time of this evaluation) and its inability to map both paired end and fragment reads simultaneously kept it from taking the lead.</p>
      <p>Once the best performing aligner was chosen, we focused on identifying appropriate parameters for mapping shotgun metagenomic data. When the database provided the exact strain targets for all reads in the query, we found that that length of alignment constraint had the strongest effect on mapping sensitivity, with the percent identity (considering only two fairly stringent settings) having only a minimal effect. But when swapping out several MMD strains with other organisms from the same genus, the percent similarity setting becomes more important. When the genome of an exact strain present in the metagenomic community is not sequenced (therefore absent from the reference database) but the genome of a close relative is sequenced, having a slightly more lenient similarity cutoff can improve sensitivity at the species or genus level. The suggested parameter settings for profiling microbial community structure using metagenomic shotgun sequences are 80% similarity over 75% length of the query being required to align.</p>
      <p>We further explored the issue of mapping resolution and the effects of taxonomic density (i.e. the number of closely related strains available under a species or genus) within the RGD. We considered the cost of the top random mapping strategy in loss of resolution at the strain level to the benefit of being able to map a larger fraction of samples to the genus level. While identifying a larger percentage of samples at a lower resolution might have more immediate value for some applications than correctly identifying a smaller portion of the samples at a finer grained taxonomic level, its of importance to note that by using the unique placement only alignment strategy the capability to map to a greater degree of taxonomic clarity exists. We also showed that the number of conserved strains or species present within a genus both increases the likelihood of correctly identifying the genus of a read, while lessening the likelihood of correctly identifying the exact strain (or species) under the top random mapping strategy. The final Read Mapping Standard Operating Procedure is described in <xref ref-type="supplementary-material" rid="pone.0036427.s002">Text S2</xref>.</p>
    </sec>
    <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <sec id="s4a">
        <title>Mock Database Creation</title>
        <p>For a number of the analyses described in this paper we used a mock community comprising 20 bacterial and 1 archaeal species, mixed together at different concentrations per strain <xref ref-type="bibr" rid="pone.0036427-Haas1">[20]</xref> and sequenced on Illumina GAIIx (100 bp paired-end reads). The Illumina sequences are available in GenBank under Accession: PRJNA48475, ID: 48475. These 20 bacterial and 1 archaeal strains have genome sequence available in GenBank <xref ref-type="bibr" rid="pone.0036427-Benson1">[21]</xref>. The fasta sequence of these 21 strains is what is referred to as the ‘Mock Metagenomic Database’ (MMD)(<xref ref-type="supplementary-material" rid="pone.0036427.s001">Text S1</xref>).</p>
      </sec>
      <sec id="s4b">
        <title>Reference Database Creation</title>
        <p>For the ‘Mapping resolution’ analysis we generated a database comprising archaeal, bacterial, lower eukaryotic and viral organisms available in GenBank, referred to as the ‘Reference Genome Database’ (RGD). These sequences were downloaded via keyword search from the NCBI’s GenBank database on 11/10/2009. The bacterial component underwent special processing as described below, but for the other three superkingdoms, we used the keywords “Archaea[ORGN]”, “Virus[ORGN]” and “Eukaryota[ORGN] NOT Bilateria[ORGN] NOT Streptophyta[ORGN]” (for Archaea, Virus, and lower Eukaryotes respectively), along with the descriptor “complete” and/or “WGS”. All archaeal, viral and lower eukaryotic strains found in that manner were included in the RGD. For the bacterial component of the RGD, a similar keyword search was used, “Bacteria[ORGN] and complete” and “Bacteria[ORGN] and WGS”, followed by removing highly redundant strains that were not part of the HMP. For this redundancy removal step, all sequences from a given genome were first tagged with a prefix unique to that strain. This allows a hit to any component of a draft genome to be easily related back to its parent genome, and was a required step to enable the creation of abundance metrics per genome. The complete and draft genomes were categorized on per species level, resulting in categories including anywhere from single strains to those including many strains per species (e.g. <italic>E. coli</italic> and <italic>Bacillus anthracis</italic>, 57 and 11 strains respectively at the time of the original construction). For selecting representatives among multiple strains within a species, the mauveAligner module of Mauve <xref ref-type="bibr" rid="pone.0036427-Darling1">[22]</xref> was wrapped into custom-built PERL scripts to automate most of the process (<xref ref-type="supplementary-material" rid="pone.0036427.s005">Figure S1</xref> shows an example mauve alignment). The criterion for exclusion was a similarity of over 90% on a genome-wide level (pair-wise comparisons) and the genome that is longer and provides the most unique sequence was kept. While this process worked well for cases with a small number of strains per species, the challenge grew as the number of sequences increased and the homology decreased among greater numbers of genomic pieces. In some cases many pair-wise alignments were done and the sequences were eliminated progressively. In the case of a large numbers of strains, a slightly relaxed homology (as low as 83%) was used. Bacterial strains that were collected from humans as part of the HMP were retained without being subject to redundancy removal because these strains were deemed informative to the project. Finally plasmids corresponding to the non-redundant genomes that were selected through the above analysis were also incorporated in the database. <xref ref-type="fig" rid="pone-0036427-g001">Figure 1</xref> shows an overview of this process. The RGD fasta database is provided as <xref ref-type="supplementary-material" rid="pone.0036427.s003">Text S3</xref>, and an index describing the strain-prefix relationship is provided as <xref ref-type="supplementary-material" rid="pone.0036427.s004">Text S4</xref>.</p>
      </sec>
      <sec id="s4c">
        <title>Aligner Comparison</title>
        <p>Six aligners were tested, BWA <xref ref-type="bibr" rid="pone.0036427-Li2">[9]</xref>, CLC <xref ref-type="bibr" rid="pone.0036427-CLCbio1">[23]</xref>, MAP <xref ref-type="bibr" rid="pone.0036427-Reumers1">[24]</xref>, SMALT <xref ref-type="bibr" rid="pone.0036427-SMALT1">[25]</xref>, SOAP <xref ref-type="bibr" rid="pone.0036427-Li3">[10]</xref> and Novoalign (<ext-link ext-link-type="uri" xlink:href="http://www.novocraft.com" xlink:type="simple">www.novocraft.com</ext-link>, unpublished), using roughly default parameters for each program (see <xref ref-type="table" rid="pone-0036427-t001">Table 1</xref>) by aligning 22,735,802 reads generated from the Microbial mock community and sequenced on the Illumina GAIIx against the MMD described above.</p>
        <p>Alignments from each aligner were collected using a random top-hit strategy for all programs that supported it (BWA, CLC, SOAP, Novoalign), and the default mapping strategy of the aligner for the others (MAP, SMALT). The top random mapping strategy involves reporting only a single, best hit per query, and in the case of a query having multiple, equally strong best hits (i.e. mapping quality 0 <xref ref-type="bibr" rid="pone.0036427-Li4">[26]</xref>), one of those hits is chosen at random. The MAP aligner supports a novel approach for its mapping strategy where the user sets a ‘topN’ value that sets the maximum number of equally scoring best hits that will be reported. In cases where a query has that many equally scoring best hits or fewer, all hits are reported. If more than those numbers of equal placements are found, no hit is reported. The SMALT aligner only supports 2 mapping strategies. The first reports all hits regardless of the number of tied, best hits, and the default mode is unique only placement, where only queries with a single, best placement are reported.</p>
        <p>The breadth (defined as the percentage of covered bases over the length of the reference genome) and depth (defined as the sum of the depths of each covered base divided by the length of the genome) of coverage were calculated based on all alignments of each genome represented in the MMD using a software package called RefCov (<ext-link ext-link-type="uri" xlink:href="http://gmt.genome.wustl.edu/gmt-refcov" xlink:type="simple">http://gmt.genome.wustl.edu/gmt-refcov</ext-link>) and results were compared.</p>
      </sec>
      <sec id="s4d">
        <title>Parameter Optimization</title>
        <p>Parameter optimization was performed only for the aligner that best fulfilled all the required criteria (CLC bio’s CLC Assembly Cell) by varying the minimum similarity setting (-similarity) and the minimum length of alignment setting (-lengthfraction) across 6 different combinations. The tested combinations include: i) 50% length +80% identity (default), ii) 50% length +90% identity, iii) 75% length +80% identity, iv) 75% length +90% identity, v) 100% length +80% identity and vi) 100% length +90% identity. The 64bit version of the CLC Assembly Cell long read alignment program, clc_ref_assemble_long, was used with the parameters “–l &lt;% length&gt; -s &lt;% identity&gt; -p fb ss 180 250” where the –l &amp; -s values were varied as described above. The castosam program was used to extract a sam format file <xref ref-type="bibr" rid="pone.0036427-Li5">[27]</xref> from the cas format output of clc_ref_assemble_long program, and analysis was performed on the sam files. A top random mapping strategy was applied for the parameter tuning analysis, which in the case of multiple, equally strong best mappings, will randomly report one of those mappings as the hit.</p>
      </sec>
      <sec id="s4e">
        <title>Mapping Resolution Analysis</title>
        <p>The effects on mapping accuracy and sensitivity resulting from changing mapping strategies was tested by aligning 22,735,802 illumina GAIIx reads prepared from the mock community against both the RGD and the MMD. CLC Assembly Cell alignments were run using the 64bit version of the program clc_ref_assembly_long with the parameters “–l &lt;% length&gt; -s &lt;% identity&gt; -p fb ss 180 250” where the &lt;% length&gt; + &lt;% identity&gt; settings varied across: i) 50% length +80% identity (default), ii) 50% length +90% identity, iii) 75% length +80% identity, iv) 75% length +90% identity, v) 100% length +80% identity and vi) 100% length +90% identity, and then sam files were produced from alignment outputs as described in the mapping resolution analysis section above, We report the number of hits to the exact mock strains, to the genera represented by those mock strains, to the species represented by those mock strains, false positive organism assignments and those with no hits at all. The hits were reported using both the top random and unique only mapping strategies against both the RGD and the MMD. We also report how many strains were present in the RGD per genera represented in the mock community.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pone.0036427.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.s001" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>
            <bold>Mock Metagenomic community database</bold>
          </p>
          <p>(DOCX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0036427.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.s002" xlink:type="simple">
        <label>Text S2</label>
        <caption>
          <p>
            <bold>Read mapping Standard Operating Procedure</bold>
          </p>
          <p>(DOCX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0036427.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.s003" xlink:type="simple">
        <label>Text S3</label>
        <caption>
          <p>
            <bold>Reference Genome database</bold>
          </p>
          <p>(DOCX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0036427.s004" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.s004" xlink:type="simple">
        <label>Text S4</label>
        <caption>
          <p>
            <bold>Prefix-Strain index for Reference Genome database</bold>
          </p>
          <p>(DOCX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0036427.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.s005" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>Example Mauve alignment.</bold> This picture shows a screenshot of an example Mauve alignment of 8 similar strains of <italic>B. cereus.</italic> Colored blocks show regions of homology between organisms with the amplitude shown within each box showing the strength of the similarity. Lines between strains show smaller regions of homology between sequences.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0036427.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.s006" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p><bold>Alignment parameter effects on breadth and depth of coverage of original MMD strains. (A). Parameter effects on genome coverage of the MMD at the genus level.</bold> This chart shows the effect of varying the parameters on the coverage of the mock genomes on the genus level. For the genera <italic>Streptococcus</italic> and <italic>Staphylococcus</italic>, which are represented by more than a single strain in the mock community pool, the values are averaged across each member strain. The genus <italic>Pseudomonas</italic>, represented in the mock community by the strain <italic>P. aeruginosa PAO1</italic>, displays a marked decrease in coverage when using the stringent 100% length cutoff. <bold>(B). Parameter effects on genome depth of coverage of the MMD at the genus level.</bold> This chart shows the effect of varying the parameters on the depth of coverage found for the mock genomes on the genus level. For the genera <italic>Streptococcus</italic> and <italic>Staphylococcus</italic>, which are represented by more than a single strain in our mock community pool, the values are averaged across each member strain. The genus <italic>Deinococcus</italic>, which in the mock community is represented by the strain <italic>D. radiodurans</italic> R1, shows a marked decrease in estimated depth of coverage for parameter combinations that require 100% length to align.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pone.0036427.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pone.0036427.s007" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p><bold>Alignment parameter effects on breadth and depth of coverage of amended MMD strains. (A). Parameter effects on genome coverage of the amended MMD at the genus level.</bold> This chart shows the effect of varying the parameters on the breadth of coverage of the mock genomes on the genus level. The most affected genera are the ones where the strain membership was modified before running the alignments. For <italic>Deinococcus, Escherichia, Helicobacter</italic> and <italic>Neisseria</italic>, the member strain was removed, and a non-mock strain from the same genus was put in its place, and for <italic>Streptococcus</italic>, two of the three strains were removed, leaving the original <italic>S.mutans UA159</italic> strain intact. This figure illustrates that for those genera not having strains present in the mock community, the similarity value begins to have more of an effect on the numbers able to align. <bold>(B). Parameter effects on genome depth of coverage of the amended MMD at the genus level.</bold> This chart shows the effect of varying the parameters on the depth of coverage of the mock genomes on the genus level. The most affected genera are the ones where the strain membership was modified before running the alignments. For <italic>Deinococcus, Escherichia, Helicobacter</italic> and <italic>Neisseria</italic>, the member strain was removed, and a non-mock strain from the same genus was put in its place, and for <italic>Streptococcus</italic>, two of the three strains were removed, leaving the original <italic>S.mutans UA159</italic> strain intact. This figure illustrates that for those genera not having strains present in the mock community, the similarity value begins to have more of an effect on the numbers able to align.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank Sarah K. Highlander for the generation and information on the mock community used for the evaluations.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pone.0036427-Peterson1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Peterson</surname><given-names>J</given-names></name><name name-style="western"><surname>Garges</surname><given-names>S</given-names></name><name name-style="western"><surname>Giovanni</surname><given-names>M</given-names></name><name name-style="western"><surname>McInnes</surname><given-names>P</given-names></name><name name-style="western"><surname>Wang</surname><given-names>L</given-names></name></person-group>             <year>2009</year>             <article-title>The NIH Human Microbiome Project.</article-title>             <source>Genome Res</source>             <volume>19</volume>             <fpage>2317</fpage>             <page-range>2323</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Handelsman1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Handelsman</surname><given-names>J</given-names></name></person-group>             <year>2004</year>             <article-title>Metagenomics: application of genomics to uncultured microorganisms.</article-title>             <source>Microbiol Mol Biol Rev</source>             <volume>68</volume>             <fpage>669</fpage>             <page-range>685</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Riesenfeld1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Riesenfeld</surname><given-names>CS</given-names></name><name name-style="western"><surname>Goodman</surname><given-names>RM</given-names></name><name name-style="western"><surname>Handelsman</surname><given-names>J</given-names></name></person-group>             <year>2004</year>             <article-title>Uncultured soil bacteria are a reservoir of new antibiotic resistance genes.</article-title>             <source>Environ Microbiol</source>             <volume>6</volume>             <fpage>981</fpage>             <page-range>989</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Kumar1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kumar</surname><given-names>Y</given-names></name><name name-style="western"><surname>Westram</surname><given-names>R</given-names></name><name name-style="western"><surname>Kipfer</surname><given-names>P</given-names></name><name name-style="western"><surname>Meier</surname><given-names>H</given-names></name><name name-style="western"><surname>Ludwig</surname><given-names>W</given-names></name></person-group>             <year>2006</year>             <article-title>Evaluation of sequence alignments and oligonucleotide probes with respect to three-dimensional structure of ribosomal RNA using ARB software package.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <fpage>240</fpage>          </element-citation>
      </ref>
      <ref id="pone.0036427-DeSantis1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>DeSantis</surname><given-names>TZ</given-names><suffix>Jr</suffix></name><name name-style="western"><surname>Hugenholtz</surname><given-names>P</given-names></name><name name-style="western"><surname>Keller</surname><given-names>K</given-names></name><name name-style="western"><surname>Brodie</surname><given-names>EL</given-names></name><name name-style="western"><surname>Larsen</surname><given-names>N</given-names></name></person-group>             <year>2006</year>             <article-title>NAST: a multiple sequence alignment server for comparative analysis of 16S rRNA genes.</article-title>             <source>Nucleic Acids Res</source>             <volume>34</volume>             <fpage>W394</fpage>             <page-range>399</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Schloss1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schloss</surname><given-names>PD</given-names></name><name name-style="western"><surname>Westcott</surname><given-names>SL</given-names></name></person-group>             <year>2011</year>             <article-title>Assessing and Improving Methods Used in Operational Taxonomic Unit-Based Approaches for 16S rRNA Gene Sequence Analysis.</article-title>             <source>Appl Environ Microbiol</source>             <volume>77</volume>             <fpage>3219</fpage>             <page-range>3226</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Li1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name><name name-style="western"><surname>Homer</surname><given-names>N</given-names></name></person-group>             <year>2010</year>             <article-title>A survey of sequence alignment algorithms for next-generation sequencing.</article-title>             <source>Brief Bioinform</source>             <volume>11</volume>             <fpage>473</fpage>             <page-range>483</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Eckburg1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eckburg</surname><given-names>PB</given-names></name><name name-style="western"><surname>Bik</surname><given-names>EM</given-names></name><name name-style="western"><surname>Bernstein</surname><given-names>CN</given-names></name><name name-style="western"><surname>Purdom</surname><given-names>E</given-names></name><name name-style="western"><surname>Dethlefsen</surname><given-names>L</given-names></name></person-group>             <year>2005</year>             <article-title>Diversity of the human intestinal microbial flora.</article-title>             <source>Science</source>             <volume>308</volume>             <fpage>1635</fpage>             <page-range>1638</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Li2">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name></person-group>             <year>2009</year>             <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>1754</fpage>             <page-range>1760</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Li3">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>R</given-names></name><name name-style="western"><surname>Yu</surname><given-names>C</given-names></name><name name-style="western"><surname>Li</surname><given-names>Y</given-names></name><name name-style="western"><surname>Lam</surname><given-names>TW</given-names></name><name name-style="western"><surname>Yiu</surname><given-names>SM</given-names></name></person-group>             <year>2009</year>             <article-title>SOAP2: an improved ultrafast tool for short read alignment.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>1966</fpage>             <page-range>1967</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Hancock1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hancock</surname><given-names>JM</given-names></name><name name-style="western"><surname>Armstrong</surname><given-names>JS</given-names></name></person-group>             <year>1994</year>             <article-title>SIMPLE34: an improved and enhanced implementation for VAX and Sun computers of the SIMPLE algorithm for analysis of clustered repetitive motifs in nucleotide sequences.</article-title>             <source>Comput Appl Biosci</source>             <volume>10</volume>             <fpage>67</fpage>             <page-range>70</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Makarova1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Makarova</surname><given-names>KS</given-names></name><name name-style="western"><surname>Omelchenko</surname><given-names>MV</given-names></name><name name-style="western"><surname>Gaidamakova</surname><given-names>EK</given-names></name><name name-style="western"><surname>Matrosova</surname><given-names>VY</given-names></name><name name-style="western"><surname>Vasilenko</surname><given-names>A</given-names></name></person-group>             <year>2007</year>             <article-title>Deinococcus geothermalis: the pool of extreme radiation resistance genes shrinks.</article-title>             <source>PLoS One</source>             <volume>2</volume>             <fpage>e955</fpage>          </element-citation>
      </ref>
      <ref id="pone.0036427-White1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>White</surname><given-names>O</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>JA</given-names></name><name name-style="western"><surname>Heidelberg</surname><given-names>JF</given-names></name><name name-style="western"><surname>Hickey</surname><given-names>EK</given-names></name><name name-style="western"><surname>Peterson</surname><given-names>JD</given-names></name></person-group>             <year>1999</year>             <article-title>Genome sequence of the radioresistant bacterium Deinococcus radiodurans R1.</article-title>             <source>Science</source>             <volume>286</volume>             <fpage>1571</fpage>             <page-range>1577</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Ajdic1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ajdic</surname><given-names>D</given-names></name><name name-style="western"><surname>McShan</surname><given-names>WM</given-names></name><name name-style="western"><surname>McLaughlin</surname><given-names>RE</given-names></name><name name-style="western"><surname>Savic</surname><given-names>G</given-names></name><name name-style="western"><surname>Chang</surname><given-names>J</given-names></name></person-group>             <year>2002</year>             <article-title>Genome sequence of Streptococcus mutans UA159, a cariogenic dental pathogen.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>99</volume>             <fpage>14434</fpage>             <page-range>14439</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Tettelin1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tettelin</surname><given-names>H</given-names></name><name name-style="western"><surname>Masignani</surname><given-names>V</given-names></name><name name-style="western"><surname>Cieslewicz</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>JA</given-names></name><name name-style="western"><surname>Peterson</surname><given-names>S</given-names></name></person-group>             <year>2002</year>             <article-title>Complete genome sequence and comparative genomic analysis of an emerging human pathogen, serotype V Streptococcus agalactiae.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>99</volume>             <fpage>12391</fpage>             <page-range>12396</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Tettelin2">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tettelin</surname><given-names>H</given-names></name><name name-style="western"><surname>Nelson</surname><given-names>KE</given-names></name><name name-style="western"><surname>Paulsen</surname><given-names>IT</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>JA</given-names></name><name name-style="western"><surname>Read</surname><given-names>TD</given-names></name></person-group>             <year>2001</year>             <article-title>Complete genome sequence of a virulent isolate of Streptococcus pneumoniae.</article-title>             <source>Science</source>             <volume>293</volume>             <fpage>498</fpage>             <page-range>506</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Wang1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Q</given-names></name><name name-style="western"><surname>Garrity</surname><given-names>GM</given-names></name><name name-style="western"><surname>Tiedje</surname><given-names>JM</given-names></name><name name-style="western"><surname>Cole</surname><given-names>JR</given-names></name></person-group>             <year>2007</year>             <article-title>Naive Bayesian classifier for rapid assignment of rRNA sequences into the new bacterial taxonomy.</article-title>             <source>Appl Environ Microbiol</source>             <volume>73</volume>             <fpage>5261</fpage>             <page-range>5267</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Rasko1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rasko</surname><given-names>DA</given-names></name><name name-style="western"><surname>Ravel</surname><given-names>J</given-names></name><name name-style="western"><surname>Okstad</surname><given-names>OA</given-names></name><name name-style="western"><surname>Helgason</surname><given-names>E</given-names></name><name name-style="western"><surname>Cer</surname><given-names>RZ</given-names></name></person-group>             <year>2004</year>             <article-title>The genome sequence of Bacillus cereus ATCC 10987 reveals metabolic adaptations and a large plasmid related to Bacillus anthracis pXO1.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>977</fpage>             <page-range>988</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Medini1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Medini</surname><given-names>D</given-names></name><name name-style="western"><surname>Donati</surname><given-names>C</given-names></name><name name-style="western"><surname>Tettelin</surname><given-names>H</given-names></name><name name-style="western"><surname>Masignani</surname><given-names>V</given-names></name><name name-style="western"><surname>Rappuoli</surname><given-names>R</given-names></name></person-group>             <year>2005</year>             <article-title>The microbial pan-genome.</article-title>             <source>Curr Opin Genet Dev</source>             <volume>15</volume>             <fpage>589</fpage>             <page-range>594</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Haas1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Haas</surname><given-names>BJ</given-names></name><name name-style="western"><surname>Gevers</surname><given-names>D</given-names></name><name name-style="western"><surname>Earl</surname><given-names>AM</given-names></name><name name-style="western"><surname>Feldgarden</surname><given-names>M</given-names></name><name name-style="western"><surname>Ward</surname><given-names>DV</given-names></name></person-group>             <year>2011</year>             <article-title>Chimeric 16S rRNA sequence formation and detection in Sanger and 454-pyrosequenced PCR amplicons.</article-title>             <source>Genome Res</source>             <volume>21</volume>             <fpage>494</fpage>             <page-range>504</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Benson1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Benson</surname><given-names>DA</given-names></name><name name-style="western"><surname>Karsch-Mizrachi</surname><given-names>I</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Ostell</surname><given-names>J</given-names></name><name name-style="western"><surname>Sayers</surname><given-names>EW</given-names></name></person-group>             <year>2011</year>             <article-title>GenBank.</article-title>             <source>Nucleic Acids Res</source>             <volume>39</volume>             <fpage>D32</fpage>             <page-range>37</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Darling1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Darling</surname><given-names>AC</given-names></name><name name-style="western"><surname>Mau</surname><given-names>B</given-names></name><name name-style="western"><surname>Blattner</surname><given-names>FR</given-names></name><name name-style="western"><surname>Perna</surname><given-names>NT</given-names></name></person-group>             <year>2004</year>             <article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements.</article-title>             <source>Genome Res</source>             <volume>14</volume>             <fpage>1394</fpage>             <page-range>1403</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-CLCbio1">
        <label>23</label>
        <element-citation publication-type="other" xlink:type="simple">             <article-title>CLCbio website.</article-title>             <comment><ext-link ext-link-type="uri" xlink:href="http://www.clcbio.com" xlink:type="simple">http://www.clcbio.com</ext-link> Accessed 2012 April 9.</comment>                    </element-citation>
      </ref>
      <ref id="pone.0036427-Reumers1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Reumers</surname><given-names>J</given-names></name><name name-style="western"><surname>De Rijk</surname><given-names>P</given-names></name><name name-style="western"><surname>Zhao</surname><given-names>H</given-names></name><name name-style="western"><surname>Liekens</surname><given-names>A</given-names></name><name name-style="western"><surname>Smeets</surname><given-names>D</given-names></name></person-group>             <year>2012</year>             <article-title>Optimized filtering reduces the error rate in detecting genomic variants by short-read sequencing.</article-title>             <source>Nat Biotechnol</source>             <volume>30</volume>             <fpage>61</fpage>             <page-range>68</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-SMALT1">
        <label>25</label>
        <element-citation publication-type="other" xlink:type="simple">             <article-title>SMALT website.</article-title>             <comment><ext-link ext-link-type="uri" xlink:href="http://www.sanger.ac.uk/resources/software/smalt/" xlink:type="simple">http://www.sanger.ac.uk/resources/software/smalt/</ext-link> Accessed 2012 April 9.</comment>          </element-citation>
      </ref>
      <ref id="pone.0036427-Li4">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name><name name-style="western"><surname>Ruan</surname><given-names>J</given-names></name><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name></person-group>             <year>2008</year>             <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores.</article-title>             <source>Genome Res</source>             <volume>18</volume>             <fpage>1851</fpage>             <page-range>1858</page-range>          </element-citation>
      </ref>
      <ref id="pone.0036427-Li5">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name><name name-style="western"><surname>Handsaker</surname><given-names>B</given-names></name><name name-style="western"><surname>Wysoker</surname><given-names>A</given-names></name><name name-style="western"><surname>Fennell</surname><given-names>T</given-names></name><name name-style="western"><surname>Ruan</surname><given-names>J</given-names></name></person-group>             <year>2009</year>             <article-title>The Sequence Alignment/Map format and SAMtools.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>2078</fpage>             <page-range>2079</page-range>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>