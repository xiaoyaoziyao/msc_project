<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-13-38556</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0109277</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A Toolkit for ARB to Integrate Custom Databases and Externally Built Phylogenies</article-title>
<alt-title alt-title-type="running-head">Toolkit for ARB</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Essinger</surname>
<given-names>Steven D.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Reichenberger</surname>
<given-names>Erin</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Morrison</surname>
<given-names>Calvin</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Blackwood</surname>
<given-names>Christopher B.</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Rosen</surname>
<given-names>Gail L.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Electrical &amp; Computer Engineering, Drexel University, Philadelphia, Pennsylvania, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Biomedical Engineering, Science, and Health Systems, Drexel University, Philadelphia, Pennsylvania, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Biological Sciences, Kent State University, Kent, Ohio, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Donlin</surname>
<given-names>Maureen J.</given-names>
</name>
<role>Academic Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Saint Louis University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con" id="contrib001"><p>Conceived and designed the experiments: SE ER CBB GLR. Performed the experiments: SE ER. Analyzed the data: SE ER CBB GLR. Wrote the paper: SE. Software Debugging: CM.</p></fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">gailr@ece.drexel.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>21</day>
<month>1</month>
<year>2015</year>
</pub-date>
<volume>10</volume>
<issue>1</issue>
<elocation-id>e0109277</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>9</month>
<year>2013</year>
</date>
<date date-type="accepted">
<day>10</day>
<month>9</month>
<year>2014</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Essinger et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0109277" xlink:type="simple"/>
<abstract>
<p>Researchers are perpetually amassing biological sequence data. The computational approaches employed by ecologists for organizing this data (e.g. alignment, phylogeny, etc.) typically scale nonlinearly in execution time with the size of the dataset. This often serves as a bottleneck for processing experimental data since many molecular studies are characterized by massive datasets. To keep up with experimental data demands, ecologists are forced to choose between continually upgrading expensive in-house computer hardware or outsourcing the most demanding computations to the cloud. Outsourcing is attractive since it is the least expensive option, but does not necessarily allow direct user interaction with the data for exploratory analysis. Desktop analytical tools such as ARB are indispensable for this purpose, but they do not necessarily offer a convenient solution for the coordination and integration of datasets between local and outsourced destinations. Therefore, researchers are currently left with an undesirable tradeoff between computational throughput and analytical capability. To mitigate this tradeoff we introduce a software package to leverage the utility of the interactive exploratory tools offered by ARB with the computational throughput of cloud-based resources. Our pipeline serves as middleware between the desktop and the cloud allowing researchers to form local custom databases containing sequences and metadata from multiple resources and a method for linking data outsourced for computation back to the local database. A tutorial implementation of the toolkit is provided in the supporting information, <xref ref-type="supplementary-material" rid="pone.0109277.s001">S1 Tutorial</xref>. Availability: <ext-link ext-link-type="uri" xlink:href="http://www.ece.drexel.edu/gailr/EESI/tutorial.php" xlink:type="simple">http://www.ece.drexel.edu/gailr/EESI/tutorial.php</ext-link>.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by Department of Energy Grant DE-SC0004335. No additional external funding was received for this study. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="1"/>
<table-count count="1"/>
<page-count count="7"/>
</counts>
</article-meta>
</front>
<body>
<sec sec-type="intro" id="sec001">
<title>Introduction</title>
<p>Dealing with large biological sequence datasets can be a computational burden. Unless one has access to supercomputing facilities, the scope of experimental research may be limited by in-house computational power. Fortunately, computing clusters that are easily accessible via the Internet circumvent this issue and have become an inexpensive alternative to upgrading in-house computing resources [<xref ref-type="bibr" rid="pone.0109277.ref001">1</xref>]. Outsourcing the heavy data crunching also enables greater flexibility in the choice of algorithm, thus enabling researchers to try novel approaches as they are published without first requiring their integration into popular desktop applications such as ARB, MacClade and DAMBE5 [<xref ref-type="bibr" rid="pone.0109277.ref002">2</xref>, <xref ref-type="bibr" rid="pone.0109277.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0109277.ref004">4</xref>].</p>
<p>While outsourcing computation to the cloud is becoming more commonplace, it is still largely inconvenient to analyze and interpret results remotely. Popular online tools do not all-inclusively support exploratory data analysis or other tedious tasks such as alignment curation and primer design. Generalist web-based tools such as Galaxy and MG-RAST support various data processing pipelines, but have limited integrated algorithms for alignment and phylogeny [<xref ref-type="bibr" rid="pone.0109277.ref005">5</xref>, <xref ref-type="bibr" rid="pone.0109277.ref006">6</xref>]. They also lack the rich data curation and interactive user interfaces afforded by some of the desktop applications, particularly ARB.</p>
<p>Our toolkit development was motivated by the need to perform massive bacterial and fungal sequence analysis. In particular, we collected genomic sequences along with pertinent metadata from multiple online repositories, aligned the sequences, constructed a phylogeny, identified clades of interest on the tree using our metadata and then designed primers for further experimental research. The datasets we employed consisted of thousands of sequences that precluded us from using local computational resources (see <xref ref-type="sec" rid="sec003">Results</xref>). Since our data analysis was exploratory in nature, we required a full-featured interactive application that employed a graphical user interface and possessed the computational throughput of cloud-based resources.</p>
<p><xref ref-type="table" rid="pone.0109277.t001">Table 1</xref> highlights some of the more popular desktop and online tools potentially suited for our purpose [<xref ref-type="bibr" rid="pone.0109277.ref002">2</xref>, <xref ref-type="bibr" rid="pone.0109277.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0109277.ref004">4</xref>, <xref ref-type="bibr" rid="pone.0109277.ref005">5</xref>, <xref ref-type="bibr" rid="pone.0109277.ref006">6</xref>, <xref ref-type="bibr" rid="pone.0109277.ref007">7</xref>, <xref ref-type="bibr" rid="pone.0109277.ref008">8</xref>, <xref ref-type="bibr" rid="pone.0109277.ref009">9</xref>, <xref ref-type="bibr" rid="pone.0109277.ref010">10</xref>, <xref ref-type="bibr" rid="pone.0109277.ref011">11</xref>]. We considered software solutions that support database functions for the selection of sequences based on metadata content, alignment and phylogenetic construction capability, user interactive interfaces for tree manipulation and cost. The three leading options based on these criteria were ARB, DAMBE5, and Geneious. We chose to focus on ARB because it 1) includes a custom import data filter feature that enables the use of a user-supplied database consisting of custom tailored metadata, 2) is a popular, open-source, freely available solution with a lengthy history of use in the biological community.</p>
<table-wrap id="pone.0109277.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0109277.t001</object-id>
<label>Table 1</label>
<caption>
<title>This table comprises a list of potential software solutions for typical genomic data analysis tasks in molecular ecology (e.g. alignment, phylogenetics, data exploration, etc.).</title>
</caption>
<alternatives>
<graphic id="pone.0109277.t001g" mimetype="image" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pone.0109277.t001"/>
<table frame="hsides" rules="groups">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top" rowspan="1" colspan="1"><bold>Software</bold></th>
<th align="left" valign="top" rowspan="1" colspan="1"><bold>Purpose</bold></th>
<th align="left" valign="top" rowspan="1" colspan="1"><bold>Support</bold></th>
<th align="left" valign="top" rowspan="1" colspan="1"><bold>Cited</bold></th>
<th align="left" valign="top" rowspan="1" colspan="1"><bold>Cost</bold></th>
<th align="left" valign="top" rowspan="1" colspan="1"><bold>Availability</bold></th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">ARB</td>
<td align="left" valign="top" rowspan="1" colspan="1">Database Mining/Alignment/Phylogenetics/Interactive Inference</td>
<td align="left" valign="top" rowspan="1" colspan="1">MacOS, Linux</td>
<td align="left" valign="top" rowspan="1" colspan="1">3484</td>
<td align="left" valign="top" rowspan="1" colspan="1">Free</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://www.arb-home.de/" xlink:type="simple">http://www.arb-home.de/</ext-link></td>
</tr>
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">DAMBE</td>
<td align="left" valign="top" rowspan="1" colspan="1">Alignment/Phylogenetics/Interactive Inference</td>
<td align="left" valign="top" rowspan="1" colspan="1">PC, MacOS, Linux</td>
<td align="left" valign="top" rowspan="1" colspan="1">1574</td>
<td align="left" valign="top" rowspan="1" colspan="1">Free</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://dambe.bio.uottawa.ca/dambe.asp" xlink:type="simple">http://dambe.bio.uottawa.ca/dambe.asp</ext-link></td>
</tr>
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">Galaxy</td>
<td align="left" valign="top" rowspan="1" colspan="1">Alignment/Phylogeny/Metagenomics/Statistical Analysis</td>
<td align="left" valign="top" rowspan="1" colspan="1">Web, MacOS, Linux</td>
<td align="left" valign="top" rowspan="1" colspan="1">544</td>
<td align="left" valign="top" rowspan="1" colspan="1">Free</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://galaxyproject.org/" xlink:type="simple">http://galaxyproject.org/</ext-link></td>
</tr>
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">Geneious</td>
<td align="left" valign="top" rowspan="1" colspan="1">Database Mining/Alignment/Phylogenetics/Gene Annotation</td>
<td align="left" valign="top" rowspan="1" colspan="1">PC, MacOS, Linux</td>
<td align="left" valign="top" rowspan="1" colspan="1">933</td>
<td align="left" valign="top" rowspan="1" colspan="1">$795</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://www.geneious.com/" xlink:type="simple">http://www.geneious.com/</ext-link></td>
</tr>
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">MacClade</td>
<td align="left" valign="top" rowspan="1" colspan="1">Sequence Editing/Phylogenetics/Interactive Inference</td>
<td align="left" valign="top" rowspan="1" colspan="1">MacOS</td>
<td align="left" valign="top" rowspan="1" colspan="1">6466</td>
<td align="left" valign="top" rowspan="1" colspan="1">Free</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://macclade.org/" xlink:type="simple">http://macclade.org/</ext-link></td>
</tr>
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">MEGA</td>
<td align="left" valign="top" rowspan="1" colspan="1">Web-based Data Mining/Alignment/Phylogenetics/Inference</td>
<td align="left" valign="top" rowspan="1" colspan="1">PC, MacOS</td>
<td align="left" valign="top" rowspan="1" colspan="1">27888</td>
<td align="left" valign="top" rowspan="1" colspan="1">Free</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://www.megasoftware.net/" xlink:type="simple">http://www.megasoftware.net/</ext-link></td>
</tr>
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">MG-RAST</td>
<td align="left" valign="top" rowspan="1" colspan="1">Metagenomic Statistical Analysis</td>
<td align="left" valign="top" rowspan="1" colspan="1">Web</td>
<td align="left" valign="top" rowspan="1" colspan="1">513</td>
<td align="left" valign="top" rowspan="1" colspan="1">Free</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://metagenomics.anl.gov/" xlink:type="simple">http://metagenomics.anl.gov/</ext-link></td>
</tr>
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">Mothur</td>
<td align="left" valign="top" rowspan="1" colspan="1">Sequence Processing/Alignment/Clustering/Taxonomic Analysis</td>
<td align="left" valign="top" rowspan="1" colspan="1">PC, MacOS, Linux</td>
<td align="left" valign="top" rowspan="1" colspan="1">1419</td>
<td align="left" valign="top" rowspan="1" colspan="1">Free</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://www.mothur.org/" xlink:type="simple">http://www.mothur.org/</ext-link></td>
</tr>
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">PAUP*</td>
<td align="left" valign="top" rowspan="1" colspan="1">Parsimony-based Phylogenetic Tree Building</td>
<td align="left" valign="top" rowspan="1" colspan="1">PC, MacOS, Linux</td>
<td align="left" valign="top" rowspan="1" colspan="1">6414</td>
<td align="left" valign="top" rowspan="1" colspan="1">$100</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://paup.csit.fsu.edu/" xlink:type="simple">http://paup.csit.fsu.edu/</ext-link></td>
</tr>
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">Phylip</td>
<td align="left" valign="top" rowspan="1" colspan="1">Phylogenetic Tree Building &amp; Inference (No GUI)</td>
<td align="left" valign="top" rowspan="1" colspan="1">PC, MacOS, Linux</td>
<td align="left" valign="top" rowspan="1" colspan="1">19571</td>
<td align="left" valign="top" rowspan="1" colspan="1">Free</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://evolution.genetics.washington.edu" xlink:type="simple">http://evolution.genetics.washington.edu</ext-link></td>
</tr>
<tr>
<td align="left" valign="top" rowspan="1" colspan="1">SeaView</td>
<td align="left" valign="top" rowspan="1" colspan="1">Alignment/Phylogenetic Tree Building &amp; Inference</td>
<td align="left" valign="top" rowspan="1" colspan="1">PC, MacOS, Linux</td>
<td align="left" valign="top" rowspan="1" colspan="1">628</td>
<td align="left" valign="top" rowspan="1" colspan="1">Free</td>
<td align="left" valign="top" rowspan="1" colspan="1"><ext-link ext-link-type="uri" xlink:href="http://pbil.univ-lyon1.fr/software/seaview" xlink:type="simple">http://pbil.univ-lyon1.fr/software/seaview</ext-link></td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>Both desktop and web-based solutions are included.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>As described in the results section, the size of our dataset precluded us from performing alignment and phylogenetic tree construction locally within the ARB environment. Furthermore, we wanted to use MAFFT for our alignment algorithm, which was not supported within ARB [<xref ref-type="bibr" rid="pone.0109277.ref012">12</xref>]. We found the Cipres Science Gateway cloud based computing cluster, which is supported by the NSF XSEDE, to be sufficient for this task [<xref ref-type="bibr" rid="pone.0109277.ref013">13</xref>]. Conveniently, Cipres also supported RAxML, which we chose as the phylogenetic tree construction algorithm [<xref ref-type="bibr" rid="pone.0109277.ref014">14</xref>]. To complete our data analysis pipeline we developed a python toolkit to serve as the middleware between ARB on the desktop and Cipres in the cloud.</p>
</sec>
<sec sec-type="materials|methods" id="sec002">
<title>Materials and Methods</title>
<p>The toolkit serves as middleware between the desktop application ARB and cloud based computing resources. It includes a set of python scripts for:
<list list-type="order">
<list-item><p>Forming a custom database: Extracting biological sequence and metadata information from a variety of resources.</p></list-item>
<list-item><p>Generating an ARB import filter for this custom database of sequence information.</p></list-item>
<list-item><p>Constructing alignments and phylogenetic trees remotely, importing results back to ARB for analysis and linking results with metadata in the custom database.</p></list-item>
</list></p>
<p>All python scripts and a tutorial are available at:</p>
<p><ext-link ext-link-type="uri" xlink:href="http://www.ece.drexel.edu/gailr/EESI/tutorial.php" xlink:type="simple">http://www.ece.drexel.edu/gailr/EESI/tutorial.php</ext-link>.</p>
<p>Additionally, we have included a second example of the utility of our toolkit in the supporting information, <xref ref-type="supplementary-material" rid="pone.0109277.s001">S1 Tutorial</xref>. The standard implementation using our toolkit is shown in <xref ref-type="fig" rid="pone.0109277.g001">Fig. 1</xref>. Each step of the pipeline is now described below in greater detail.</p>
<fig id="pone.0109277.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0109277.g001</object-id>
<label>Figure 1</label>
<caption>
<title>Pipeline of Toolkit: A set of steps, items and scripts for leveraging remote computational resources with local ARB installations.</title>
<p>The scripts included methods for metadata extraction from NCBI taxonomy and GenBank files, generation of ARB import filters and assignment of unique IDs to preserve the sequence/data relationships when moving between local/remote platforms. This pipeline enables local exploration of massive datasets, while outsourcing the heavy computational alignments and tree construction.</p>
</caption>
<graphic mimetype="image" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pone.0109277.g001"/>
</fig>
<sec id="sec002a">
<title>A: Meta-Labels</title>
<p>A user supplied text file containing the names of the metadata fields. For each sequence in the database, all corresponding metadata will be assigned to its respective name from this file. Metadata examples include, but not limited to: Identification (e.g. Accession, GI, PFAM, etc.), Taxonomy (e.g. Species, Genus, Phylum, etc.), Environmental (e.g. pH, Salinity, Temperature, etc.), Functional (e.g. Gene Product, Locus, Size, etc.) and Publication (e.g. Date, Author, Journal, etc.).</p>
</sec>
<sec id="sec002b">
<title>B: Sequence Data</title>
<p>Sequence records (e.g. GenBank records) from which to extract desired sequences and metadata information.</p>
</sec>
<sec id="sec002c">
<title>C: Data Extraction</title>
<p>A python script for extracting information from GenBank files and the NCBI Taxonomy. This script also generates a unique identification number for each database entry. The unique ID serves two purposes:
<list list-type="order">
<list-item><p>Alignments and phylogenetic trees constructed outside of ARB may be imported into ARB and associated with metadata.</p></list-item>
<list-item><p>Future metadata may be added to existing sequence records within the ARB environment.</p></list-item>
</list></p>
</sec>
<sec id="sec002d">
<title>D: Custom Database</title>
<p>This is the FASTA formatted custom database. Each entry consists of a tab-delimited header followed by a sequence on the next line. The header information starts with the unique ID followed by all corresponding metadata, ordered according to the list of metadata names provided in the meta-labels text file described in section A.</p>
</sec>
<sec id="sec002e">
<title>E: Sequences and Unique IDs</title>
<p>This is the sequence file for alignment and phylogenetic tree building using external algorithms and computing resources of choice. It is a FASTA formatted file containing only the unique ID in the header.</p>
</sec>
<sec id="sec002f">
<title>F: Build ARB Import Filter</title>
<p>This is a python script for creating the import filter for the custom database. The meta-labels text file described in section A is all that is required by the script to build the filter. The script will output a file called custom_import_filter.ift.</p>
</sec>
<sec id="sec002g">
<title>G: ARB Import Filter</title>
<p>This is the custom .ift ARB import filter for your database, which is automatically generated by the python script described above in section F. The filter must be placed into the ARB import filter directory ‘/arb/lib/import/’. To import your custom database, follow the standard ARB procedure for creating a new database.</p>
</sec>
<sec id="sec002h">
<title>H: Alignment/Tree Building</title>
<p>The choice of tool(s) for alignment and phylogenetic tree building is at the discretion of the user. For example, you may be interested in building your tree using the maximum likelihood algorithm offered by RAxML [<xref ref-type="bibr" rid="pone.0109277.ref014">14</xref>], but desire to use external resources due to inadequate internal computational capabilities. The Cipres Science Gateway offers a potential solution for both sequence alignment (e.g. MAFFT) [<xref ref-type="bibr" rid="pone.0109277.ref012">12</xref>] and tree building (e.g. RAxML) using the XSEDE computing cluster. The user submits the sequences.fasta file from section E to Cipres and then builds a pipeline within Cipres to construct the tree. The tree output from this process would then by imported into ARB using the tree import function found under ‘Tree/Tree Admin/Import’ within ARB.</p>
</sec>
<sec id="sec002i">
<title>I: ARB</title>
<p>This is the ARB program. Information on downloading, installation and use may be found at the ARB website: <ext-link ext-link-type="uri" xlink:href="http://www.arb-home.de" xlink:type="simple">http://www.arb-home.de</ext-link>.</p>
</sec>
</sec>
<sec sec-type="results" id="sec003">
<title>Results</title>
<p>As described in the online tutorial (<ext-link ext-link-type="uri" xlink:href="http://www.ece.drexel.edu/gailr/EESI/tutorial.php" xlink:type="simple">http://www.ece.drexel.edu/gailr/EESI/tutorial.php</ext-link>), our toolkit development was motivated by ongoing research to identify and explore the evolution of microorganisms that have extracellular enzymes to degrade plant polymers and transporter proteins for the uptake of polymer degradation products. We focused on particularly relevant gene families of transporters and extracellular enzymes. We required an analysis pipeline capable of processing massive datasets of fungal and bacterial sequences to look for evolutionary patterns and conserved sequence regions amenable to primer design within these gene families. Our search conducted via the NCBI [<xref ref-type="bibr" rid="pone.0109277.ref015">15</xref>] and PFAM [<xref ref-type="bibr" rid="pone.0109277.ref016">16</xref>] databases produced hundreds of thousands of sequences along with over 50 different classes of metadata, some of which are nonstandard and not easily accessible via GenBank record parsing tools (e.g. source organism). To design the primers, one may be inclined to visualize the protein product on the leaves of the tree to isolate sub-classes. All the user has to do is re-label the leaves with the protein product. Users can also re-label the leaves according to phylogeny and one of the 50+ classes of metadata. Our toolkit therefore augments ARB’s probe design and editor tools for primer design purposes. The online tutorial walks the user through a subset of our data to illustrate the use of our toolkit for aligning tens of thousands of sequences with external resources to produce a tree and then using our tools to link the associated metadata to the tree in ARB.</p>
<p>As a second example illustrating the utility of our toolkit, the <xref ref-type="supplementary-material" rid="pone.0109277.s001">S1 Tutorial</xref> provided with this article shows the user how they can import a curated protein super-family (e.g. Major Facilitator Superfamily (MFS) Protein Family, 440 sequences) from the NCBI Conserved Domain Database (CDD) database [<xref ref-type="bibr" rid="pone.0109277.ref017">17</xref>, <xref ref-type="bibr" rid="pone.0109277.ref018">18</xref>] into ARB using our framework. Once imported, users now not only have access to a pre-computed alignment and phylogenetic tree but also have the power of viewing the GenBank records’ metadata on the leaves of the phylogenetic tree for further exploratory analysis in ARB. Our procedure can be applied to any protein family found in the CDD database and our framework expands the use of curated and well annotated multiple sequence alignment models provided by NCBI.</p>
</sec>
<sec sec-type="conclusions" id="sec004">
<title>Discussion</title>
<p>The described alignment and phylogenetic processing tasks are not well suited for local, non-high performance computational resources, yet users want interactive, local control over the data exploration of the results. For example, in our project, we found 10,752 sequences belonging to the Sugar Transporter protein family after accounting for duplicates. Using ARB’s Clustal W [<xref ref-type="bibr" rid="pone.0109277.ref019">19</xref>] accurate setting on a locally-based 2.8 GHz Apple Computer with 4G of RAM, we began to align the sequences and found that each pairwise alignment took approximately 0.019s to complete. Given that there are n*(n-1)/2 pairwise alignments required, where n is 10,752, it would take 13.29 days to complete the multiple alignment. Performing the alignment on the freely available web-based NSF funded Cipres computing infrastructure, and choosing the superior MAFFT algorithm (unavailable via ARB), the alignment completed in 14 minutes and 31 seconds when outsourced. Clearly, this is a remarkable increase in throughput and we were able to import the alignment and link it with our collected metadata in ARB in a matter of minutes. Therefore, researchers need the tools developed in our work, so that they can export computationally intensive tasks while maintaining local data exploration flexibility. After using the tools we developed, and receiving results in a matter of minutes, we were able to explore clades within our Sugar Transporter tree using various protein product metadata we had collected to aid us in our ultimate goal of choosing product-discriminative primers. If one was so inclined, with a few clicks one could re-label the tree using the publication date of the sequences to investigate the progression in which the proteins/organisms were discovered. The exploratory analysis capabilities using our toolkit are only limited by the metadata one could collect.</p>
</sec>
<sec sec-type="conclusions" id="sec005">
<title>Conclusion</title>
<p>A suite of software coupling the utility of the ARB environment with the scalable nature of computing cluster resources has been described. The software we provide allows users to outsource computationally intensive tasks while maintaining local data analysis flexibility. An example of the utility of this pipeline is provided in <xref ref-type="supplementary-material" rid="pone.0109277.s001">S1 Tutorial</xref> and <xref ref-type="supplementary-material" rid="pone.0109277.s002">S1 Scripts</xref>. All scripts, datasets, descriptions used in the pipeline and a second example of usage is provided in a tutorial at: <ext-link ext-link-type="uri" xlink:href="http://www.ece.drexel.edu/gailr/EESI/tutorial.php" xlink:type="simple">http://www.ece.drexel.edu/gailr/EESI/tutorial.php</ext-link>.</p>
</sec>
<sec id="sec006">
<title>Supporting Information</title>
<supplementary-material id="pone.0109277.s001" mimetype="application/pdf" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pone.0109277.s001">
<label>S1 Tutorial</label>
<caption>
<p>A step-by-step guide implementing the toolkit.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0109277.s002" mimetype="application/zip" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pone.0109277.s002">
<label>S1 Scripts</label>
<caption>
<p>Toolkit code and supporting scripts for <xref ref-type="supplementary-material" rid="pone.0109277.s001">S1 Tutorial</xref>.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>This research was supported in part by the National Science Foundation through the XSEDE Science Gateways program. We would like to thank the Cipres team at the SDSC for their exceptionally supported online tool suite.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0109277.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fusaro</surname> <given-names>VA</given-names></name>, <name name-style="western"><surname>Patil</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gafni</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Wall</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Tonellato</surname> <given-names>PJ</given-names></name> (<year>2011</year>) <article-title>Biomedical Cloud Computing With Amazon Web Services</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume>: <fpage>e1002147</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002147" xlink:type="simple">10.1371/journal.pcbi.1002147</ext-link></comment> <object-id pub-id-type="pmid">21901085</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ludwig</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Strunk</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Westram</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Richter</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Meier</surname> <given-names>H</given-names></name>, <etal>et al.</etal> (<year>2004</year>) <article-title>ARB: a software environment for sequence data</article-title>. <source>Nucleic Acids Research</source> <volume>32</volume>: <fpage>1363</fpage>–<lpage>1371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkh293" xlink:type="simple">10.1093/nar/gkh293</ext-link></comment> <object-id pub-id-type="pmid">14985472</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref003">
<label>3</label>
<mixed-citation publication-type="other" xlink:type="simple">Maddison DR, Maddison WP (2005) MacClade 4: Analysis of phylogeny and character evolution version 4.08a. Available: <ext-link ext-link-type="uri" xlink:href="http://macclade.org" xlink:type="simple">http://macclade.org</ext-link>. Accessed 2014 Jul 7.</mixed-citation>
</ref>
<ref id="pone.0109277.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xia</surname> <given-names>X</given-names></name> (<year>2013</year>) <article-title>DAMBE5: A Comprehensive Software Package for Data Analysis in Molecular Biology and Evolution</article-title>. <source>Molecular Biology and Evolution</source> <volume>30</volume>: <fpage>1720</fpage>–<lpage>1728</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/mst064" xlink:type="simple">10.1093/molbev/mst064</ext-link></comment> <object-id pub-id-type="pmid">23564938</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goecks</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nekrutenko</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Team</surname> <given-names>TG</given-names></name> (<year>2010</year>) <article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title>. <source>Genome Biology</source> <volume>11</volume>: <fpage>R86</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2010-11-8-r86" xlink:type="simple">10.1186/gb-2010-11-8-r86</ext-link></comment> <object-id pub-id-type="pmid">20738864</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Paarmann</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>D’Souza</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Olson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Glass</surname> <given-names>E</given-names></name>, <etal>et al.</etal> (<year>2008</year>) <article-title>The metagenomics RAST server—a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>. <source>BMC Bioinformatics</source> <volume>9</volume>: <fpage>386</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-9-386" xlink:type="simple">10.1186/1471-2105-9-386</ext-link></comment> <object-id pub-id-type="pmid">18803844</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref007">
<label>7</label>
<mixed-citation publication-type="other" xlink:type="simple">Biomatters Limited (2014) Geneious Version 6.1. Available: <ext-link ext-link-type="uri" xlink:href="http://www.geneious.com/" xlink:type="simple">http://www.geneious.com/</ext-link>. Accessed 2014 Jan 25.</mixed-citation>
</ref>
<ref id="pone.0109277.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tamura</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Stecher</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Nei</surname> <given-names>M</given-names></name>, <etal>et al.</etal> (<year>2011</year>) <article-title>MEGA5: Molecular Evolutionary Genetics Analysis Using Maximum Likelihood, Evolutionary Distance, and Maximum Parsimony Methods</article-title>. <source>Molecular Biology and Evolution</source> <volume>28</volume>: <fpage>2731</fpage>–<lpage>2739</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msr121" xlink:type="simple">10.1093/molbev/msr121</ext-link></comment> <object-id pub-id-type="pmid">21546353</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schloss</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Westcott</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Ryabin</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Hartmann</surname> <given-names>M</given-names></name>, <etal>et al.</etal> (<year>2009</year>) <article-title>Introducing mothur: Open-Source, Platform-Independent, Community-Supported Software for Describing and Comparing Microbial Communities</article-title>. <source>Applied and Environmental Microbiology</source> <volume>75</volume>: <fpage>7537</fpage>–<lpage>7541</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/AEM.01541-09" xlink:type="simple">10.1128/AEM.01541-09</ext-link></comment> <object-id pub-id-type="pmid">19801464</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gouy</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Guindon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gascuel</surname> <given-names>O</given-names></name> (<year>2010</year>) <article-title>SeaView Version 4: A Multiplatform Graphical User Interface for Sequence Alignment and Phylogenetic Tree Building</article-title>. <source>Molecular Biology and Evolution</source> <volume>27</volume>: <fpage>221</fpage>–<lpage>224</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msp259" xlink:type="simple">10.1093/molbev/msp259</ext-link></comment> <object-id pub-id-type="pmid">19854763</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref011">
<label>11</label>
<mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Swofford</surname> <given-names>DL</given-names></name> (<year>2003</year>) <article-title>PAUP* Phylogenetic Analysis Using Parsimony (* and Other Methods) Version 4</article-title>. <publisher-name>Sinauer Associates</publisher-name>, <publisher-loc>Sunderland, Massachusetts</publisher-loc>.</mixed-citation>
</ref>
<ref id="pone.0109277.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Misawa</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kuma</surname> <given-names>Ki</given-names></name>, <name name-style="western"><surname>Miyata</surname> <given-names>T</given-names></name> (<year>2002</year>) <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>. <source>Nucleic Acids Research</source> <volume>30</volume>: <fpage>3059</fpage>–<lpage>3066</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkf436" xlink:type="simple">10.1093/nar/gkf436</ext-link></comment> <object-id pub-id-type="pmid">12136088</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref013">
<label>13</label>
<mixed-citation publication-type="other" xlink:type="simple">Miller M, Holder M, Vos R (2009) CIPRES. Available: <ext-link ext-link-type="uri" xlink:href="http://www.phylo.org/sub_sections/portal/" xlink:type="simple">http://www.phylo.org/sub_sections/portal/</ext-link>. Accessed 2014 Aug 15.</mixed-citation>
</ref>
<ref id="pone.0109277.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stamatakis</surname> <given-names>A</given-names></name> (<year>2006</year>) <article-title>RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title>. <source>Bioinformatics</source> <volume>22</volume>: <fpage>2688</fpage>–<lpage>2690</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl446" xlink:type="simple">10.1093/bioinformatics/btl446</ext-link></comment> <object-id pub-id-type="pmid">16928733</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Geer</surname> <given-names>LY</given-names></name>, <name name-style="western"><surname>Marchler-Bauer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Geer</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Han</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>J</given-names></name>, <etal>et al.</etal> (<year>2010</year>) <article-title>The NCBI BioSystems database</article-title>. <source>Nucleic Acids Research</source> <volume>38</volume>: <fpage>D492</fpage>–<lpage>D496</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkp858" xlink:type="simple">10.1093/nar/gkp858</ext-link></comment> <object-id pub-id-type="pmid">19854944</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Punta</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Coggill</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Eberhardt</surname> <given-names>RY</given-names></name>, <name name-style="western"><surname>Mistry</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tate</surname> <given-names>J</given-names></name>, <etal>et al.</etal> (<year>2012</year>) <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Research</source> <volume>40</volume>: <fpage>D290</fpage>–<lpage>D301</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1065" xlink:type="simple">10.1093/nar/gkr1065</ext-link></comment> <object-id pub-id-type="pmid">22127870</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref017">
<label>17</label>
<mixed-citation publication-type="other" xlink:type="simple">Derbyshire MK, Lanczycki CJ, Bryant SH, Marchler-Bauer A (2012) Annotation of functional sites with the Conserved Domain Database. Database 2012.</mixed-citation>
</ref>
<ref id="pone.0109277.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marchler-Bauer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zheng</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Chitsaz</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Derbyshire</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Geer</surname> <given-names>LY</given-names></name>, <etal>et al.</etal> (<year>2013</year>) <article-title>CDD: conserved domains and protein three-dimensional structure</article-title>. <source>Nucleic Acids Research</source> <volume>41</volume>: <fpage>D348</fpage>–<lpage>D352</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks1243" xlink:type="simple">10.1093/nar/gks1243</ext-link></comment> <object-id pub-id-type="pmid">23197659</object-id>
</mixed-citation>
</ref>
<ref id="pone.0109277.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Larkin</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Blackshields</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>NP</given-names></name>, <name name-style="western"><surname>Chenna</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>McGettigan</surname> <given-names>PA</given-names></name>, <etal>et al.</etal> (<year>2007</year>) <article-title>Clustal W and Clustal X version 2.0</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>2947</fpage>–<lpage>2948</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm404" xlink:type="simple">10.1093/bioinformatics/btm404</ext-link></comment> <object-id pub-id-type="pmid">17846036</object-id>
</mixed-citation>
</ref>
</ref-list>
</back>
</article>