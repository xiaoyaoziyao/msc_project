<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-14-13611</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0105942</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Gene regulatory networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Mathematical modeling</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Inference of Gene Regulatory Networks Incorporating Multi-Source Biological Knowledge via a State Space Model with <italic>L</italic>1 Regularization</article-title>
<alt-title alt-title-type="running-head">GRNs Inference Using VAR-SSM with <italic>L</italic>1 Regularization</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hasegawa</surname><given-names>Takanori</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Yamaguchi</surname><given-names>Rui</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Nagasaki</surname><given-names>Masao</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Miyano</surname><given-names>Satoru</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Imoto</surname><given-names>Seiya</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Bioinformatics Center, Institute for Chemical Research, Kyoto University, Uji, Kyoto, Japan</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Human Genome Center, The Institute of Medical Science, The University of Tokyo, Minato-ku, Tokyo, Japan</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Integrative Genomics, Tohoku Medical Megabank Organization, Tohoku University, Sendai, Miyagi, Japan</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Emmert-Streib</surname><given-names>Frank</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Queen's University Belfast, United Kingdom</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">t-hasegw@kuicr.kyoto-u.ac.jp</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: TH RY MN. Performed the experiments: TH. Analyzed the data: TH. Contributed reagents/materials/analysis tools: TH RY. Contributed to the writing of the manuscript: TH RY MN SI SM.</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>27</day><month>8</month><year>2014</year></pub-date>
<volume>9</volume>
<issue>8</issue>
<elocation-id>e105942</elocation-id>
<history>
<date date-type="received"><day>27</day><month>3</month><year>2014</year></date>
<date date-type="accepted"><day>25</day><month>7</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Hasegawa et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Comprehensive understanding of gene regulatory networks (GRNs) is a major challenge in the field of systems biology. Currently, there are two main approaches in GRN analysis using time-course observation data, namely an ordinary differential equation (ODE)-based approach and a statistical model-based approach. The ODE-based approach can generate complex dynamics of GRNs according to biologically validated nonlinear models. However, it cannot be applied to ten or more genes to simultaneously estimate system dynamics and regulatory relationships due to the computational difficulties. The statistical model-based approach uses highly abstract models to simply describe biological systems and to infer relationships among several hundreds of genes from the data. However, the high abstraction generates false regulations that are not permitted biologically. Thus, when dealing with several tens of genes of which the relationships are partially known, a method that can infer regulatory relationships based on a model with low abstraction and that can emulate the dynamics of ODE-based models while incorporating prior knowledge is urgently required. To accomplish this, we propose a method for inference of GRNs using a state space representation of a vector auto-regressive (VAR) model with <italic>L</italic>1 regularization. This method can estimate the dynamic behavior of genes based on linear time-series modeling constructed from an ODE-based model and can infer the regulatory structure among several tens of genes maximizing prediction ability for the observational data. Furthermore, the method is capable of incorporating various types of existing biological knowledge, <italic>e.g.</italic>, drug kinetics and literature-recorded pathways. The effectiveness of the proposed method is shown through a comparison of simulation studies with several previous methods. For an application example, we evaluated mRNA expression profiles over time upon corticosteroid stimulation in rats, thus incorporating corticosteroid kinetics/dynamics, literature-recorded pathways and transcription factor (TF) information.</p>
</abstract>
<funding-group><funding-statement>This work was supported by Grant-in-Aid for JSPS Fellows (24-9639) received by TH (<ext-link ext-link-type="uri" xlink:href="http://www.jsps.go.jp/english/index.html" xlink:type="simple">http://www.jsps.go.jp/english/index.html</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="19"/></counts><custom-meta-group><custom-meta id="data-availability" xlink:type="simple"><meta-name>Data Availability</meta-name><meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All synthetic data are within the paper and its Supporting Information files. All microarray files are available from the the NCBI Gene Expression Omnibus database (GSE490).</meta-value></custom-meta></custom-meta-group></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Transcriptional regulation, which is controlled by several factors, plays essential roles to sustain complex biological systems in cells. Thus, identifying the structure and dynamics of such regulation can facilitate recognition of and control over systems for many practical purposes, <italic>e.g.</italic>, treatment of diseases. To accomplish this, many mathematical methods have been developed for the analysis of high-throughput biological data, <italic>e.g.</italic>, time-course microarray data <xref ref-type="bibr" rid="pone.0105942-Friedman1">[1]</xref>–<xref ref-type="bibr" rid="pone.0105942-Margolin1">[3]</xref>. In addition, recent technological advances have facilitated experimental discoveries, <italic>e.g.</italic>, DNA-protein interactions and the pharmacogenomics of chemical compounds. These contributions have allowed the knowledge of GRNs to accumulate.</p>
<p>For elucidation of GRN dynamics, time-course observational data have been generally used. Currently, one strategy to elucidate transcriptional regulation using observational data is to apply an ordinary differential equation (ODE)-based approach, which can represent the dynamic behavior of biomolecular reactions based on biologically reliable models, <italic>e.g.</italic>, the Michaelis-Menten equation <xref ref-type="bibr" rid="pone.0105942-Savageau1">[4]</xref> or the S-system <xref ref-type="bibr" rid="pone.0105942-Savageau2">[5]</xref>, which are described by differential equations. Thus, this approach can recapitulate the complex dynamic behavior of biological systems <xref ref-type="bibr" rid="pone.0105942-Lawrence1">[6]</xref>, <xref ref-type="bibr" rid="pone.0105942-Rogers1">[7]</xref>. In this approach, several methods have been proposed to infer regulatory structures <xref ref-type="bibr" rid="pone.0105942-Opper1">[8]</xref>, <xref ref-type="bibr" rid="pone.0105942-Henderson1">[9]</xref>, to reproduce the dynamic behavior of biological systems recorded in the literature <xref ref-type="bibr" rid="pone.0105942-Nakamura1">[10]</xref>–<xref ref-type="bibr" rid="pone.0105942-Quach1">[13]</xref> and also to improve literature-recorded pathways so as to be consistent with the data <xref ref-type="bibr" rid="pone.0105942-Hasegawa1">[14]</xref>. However, nonlinearity of the system results in an analytically intractable problem of estimating the parameter values that minimize loss function with updating simulated results. Thus, under this statistically efficient paradigm <xref ref-type="bibr" rid="pone.0105942-Bard1">[15]</xref>, this approach cannot be applied to ten or more genes to infer regulatory structures if the missing information is extensive <xref ref-type="bibr" rid="pone.0105942-Nakamura1">[10]</xref>.</p>
<p>In contrast, a statistical model-based approach using highly abstracted models, <italic>e.g.</italic>, Bayesian networks <xref ref-type="bibr" rid="pone.0105942-Friedman2">[16]</xref>–<xref ref-type="bibr" rid="pone.0105942-Zacher1">[18]</xref> and the state space model <xref ref-type="bibr" rid="pone.0105942-Barenco1">[19]</xref>–<xref ref-type="bibr" rid="pone.0105942-Rangel1">[22]</xref>, has been successfully applied to infer the structure of transcriptional regulation from biological observational data. Because these methods simply describe biological systems, hundreds of genes can be handled computationally with ease. Whereas methods relying purely on data need to consider all possibilities of transcriptional regulation, some studies have further incorporated other information, <italic>e.g.</italic>, protein-protein interaction networks (PINs), literature-recorded pathways and transcription factor information <xref ref-type="bibr" rid="pone.0105942-Sabatti1">[23]</xref>–<xref ref-type="bibr" rid="pone.0105942-Greenfield1">[27]</xref>. Although these methods can infer relationships among hundreds of genes simultaneously, high levels of abstraction can also generate false regulations that are difficult to interpret biologically. Thus, when several tens of genes are handled with partially understood relationships, highly abstract models can be insufficient to represent biological systems. In this case, there is an urgent need for a method that can infer system dynamics and the structure of GRNs based on a model with a low abstraction that can emulate the dynamics of ODE-based gene regulatory models incorporating existing biological knowledge.</p>
<p>We propose a novel method for inference of GRNs based on a newly developed model that uses a state space representation of a vector auto-regressive model (VAR-SSM) <xref ref-type="bibr" rid="pone.0105942-Hirose1">[21]</xref>, <xref ref-type="bibr" rid="pone.0105942-Dong1">[28]</xref>, <xref ref-type="bibr" rid="pone.0105942-Kojima1">[29]</xref>. The model is a type of state space models constructed from a typical gene regulatory system that is described by differential equations within a linear Gaussian model. The method can infer the dynamic behavior of gene expression profiles and the regulatory structure for several tens of genes by assimilating time-course observational data. Furthermore, the method is capable of integrating the existing biological knowledge, <italic>e.g.</italic>, literature-recorded pathways and intracellular kinetics/dynamics of chemical compounds, and can deal with even non-equally spaced time-course observational data. A regulatory structure is inferred by maximization of the <italic>L</italic>1 regularized likelihood. To this end, we developed a new algorithm to obtain active sets of parameters and estimate a maximizer of the <italic>L</italic>1 regularized likelihood using the EM algorithm.</p>
<p>To demonstrate its effectiveness, we compared this method to a state space model (SSM) <xref ref-type="bibr" rid="pone.0105942-Hirose1">[21]</xref>, a general VAR model using LARS-LASSO algorithm <xref ref-type="bibr" rid="pone.0105942-Efron1">[30]</xref>, GeneNet <xref ref-type="bibr" rid="pone.0105942-Schfer1">[31]</xref>, <xref ref-type="bibr" rid="pone.0105942-OpgenRhein1">[32]</xref> based on an empirical graphical Gaussian model (GGM), dynamic Bayesian networks using first order conditional dependencies <xref ref-type="bibr" rid="pone.0105942-Lbre1">[33]</xref>, GLASSO <xref ref-type="bibr" rid="pone.0105942-Friedman3">[34]</xref> based on sparse GGM and the mutual information-based network inference algorithms: ARACNE <xref ref-type="bibr" rid="pone.0105942-Margolin1">[3]</xref>, CLR <xref ref-type="bibr" rid="pone.0105942-Faith1">[35]</xref> and MRNET <xref ref-type="bibr" rid="pone.0105942-Meyer1">[36]</xref> by implementing artificial simulation models. The first two observational datasets are generated by two simulation models representing pharmacogenomic pathways <xref ref-type="bibr" rid="pone.0105942-Almon1">[37]</xref>, <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref>, including drug kinetics/dynamics, described by difference and differential equations, respectively. These pathways are initiated by the drug stimulation and observational data are obtained as non-equally spaced time-course data. The next observational dataset is generated by GeneNetWaver <xref ref-type="bibr" rid="pone.0105942-Marbach1">[39]</xref>, <xref ref-type="bibr" rid="pone.0105942-Schaffter1">[40]</xref> using a yeast network that is a part of DREAM4 (Dialogue for Reverse Engineering Assessments and Methods) challenge. As an application example, we applied the proposed method to corticosteroid pharmacogenomics in rat skeletal muscle <xref ref-type="bibr" rid="pone.0105942-Almon1">[37]</xref>, <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref>, <xref ref-type="bibr" rid="pone.0105942-Shimizu1">[41]</xref>. Because this system has been investigated previously through biological experiments, corticosteroid kinetics/dynamics and the related genes are already partly elucidated. Therefore, we incorporated time-course mRNA expression data (observational data), candidate genes/pathways related to corticosteroids, intracellular corticosteroid kinetics/dynamics and, additionally, TF information from ITFP (Integrated Transcription Factor Platform) <xref ref-type="bibr" rid="pone.0105942-Zheng1">[42]</xref>. As in the simulation experiment, the observational data were obtained as non-equally spaced time-course data (GSE490) after stimulating rat skeletal muscle with corticosteroid. Consequently, we propose candidate pathways for extensions of corticosteroid-related pathways and their simulation dynamics in the presence of corticosteroid.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<sec id="s2a">
<title>Linear Description of Biological Systems from ODE-based Models</title>
<p>For gene regulatory systems, we postulate a general hill function-based model of transcriptional control, in which each gene has a synthesis process (regulated by other factors) and a degradation process, described by a differential equation <xref ref-type="bibr" rid="pone.0105942-Elowitz1">[43]</xref>, <xref ref-type="bibr" rid="pone.0105942-deJong1">[44]</xref>. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e001" xlink:type="simple"/></inline-formula> be a time-dependent function representing the abundance of the <italic>n</italic>th (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e002" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e003" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e004" xlink:type="simple"/></inline-formula>) mRNA in a cell, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e005" xlink:type="simple"/></inline-formula> means time. Further, we consider subsets of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e006" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e007" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e008" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e009" xlink:type="simple"/></inline-formula>, whose regulatory functions are described by two different forms <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref>, <xref ref-type="bibr" rid="pone.0105942-Hazra1">[45]</xref>, <xref ref-type="bibr" rid="pone.0105942-Jin1">[46]</xref>. Then, the time-evolution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e010" xlink:type="simple"/></inline-formula> is represented by<disp-formula id="pone.0105942.e011"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e011" xlink:type="simple"/><label>(1)</label></disp-formula><disp-formula id="pone.0105942.e012"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e012" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e013" xlink:type="simple"/></inline-formula> represents the regulatory effect of the <italic>k</italic>th gene on the <italic>n</italic>th gene as a hill-function, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e014" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e015" xlink:type="simple"/></inline-formula> are the synthesis and degradation rates of the mRNA, respectively. For example, in a previous pharmacogenomic study <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e016" xlink:type="simple"/></inline-formula> was represented by<disp-formula id="pone.0105942.e017"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e017" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e018" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e019" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e020" xlink:type="simple"/></inline-formula> are tuning parameters.</p>
<p>In inferring the regulatory structure of GRNs consisting of several tens of genes, hill-function based differential equations, <italic>e.g.</italic>, <xref ref-type="disp-formula" rid="pone.0105942.e011">Eqs. (1)</xref> and <xref ref-type="disp-formula" rid="pone.0105942.e012">(2)</xref>, become intractable. Therefore, we consider discretization and linearization of gene regulatory systems <xref ref-type="bibr" rid="pone.0105942-Opper1">[8]</xref>, <xref ref-type="bibr" rid="pone.0105942-Barenco1">[19]</xref>–<xref ref-type="bibr" rid="pone.0105942-Rangel1">[22]</xref>, <xref ref-type="bibr" rid="pone.0105942-Greenfield1">[27]</xref>, <xref ref-type="bibr" rid="pone.0105942-Kojima1">[29]</xref>, <xref ref-type="bibr" rid="pone.0105942-deJong1">[44]</xref>. Here, linear functions are substituted for hill-functions and higher than quadratic terms are neglected. Furthermore, we assume that biological processes should include the effects by noise <xref ref-type="bibr" rid="pone.0105942-Chen1">[47]</xref>. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e021" xlink:type="simple"/></inline-formula> be a series of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e022" xlink:type="simple"/></inline-formula> dimensional vectors containing expression levels of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e023" xlink:type="simple"/></inline-formula> genes at the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e024" xlink:type="simple"/></inline-formula>th time point. Then, we consider a gene regulatory system represented by<disp-formula id="pone.0105942.e025"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e025" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e026" xlink:type="simple"/></inline-formula> is an <italic>N</italic>-dimensional vector including regulatory effects on the <italic>n</italic>th gene by other genes, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e027" xlink:type="simple"/></inline-formula> is the effects by noise at the <italic>t</italic>th time point, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e028" xlink:type="simple"/></inline-formula> indicates a minute displacement. Then, a VAR model for GRNs simulation can be constructed.</p>
<p>In constructing gene regulatory models, we make an assumption that observational data are measured with observational noise. Under this assumption, to separately handle a system model (<italic>i.e.</italic>, <xref ref-type="disp-formula" rid="pone.0105942.e025">Eq. (4)</xref>) and biological observational data, we utilize a state space representation <xref ref-type="bibr" rid="pone.0105942-Quach1">[13]</xref>, <xref ref-type="bibr" rid="pone.0105942-Hirose1">[21]</xref>, <xref ref-type="bibr" rid="pone.0105942-Asif1">[24]</xref>, <xref ref-type="bibr" rid="pone.0105942-Kojima1">[29]</xref>, <xref ref-type="bibr" rid="pone.0105942-Lillacci1">[48]</xref>. Here, a minimum observational time step and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e029" xlink:type="simple"/></inline-formula> are usually handled as 1 for reducing computational cost, however, we can set any value for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e030" xlink:type="simple"/></inline-formula> less than a minimum observational time step. Therefore, we evaluated the influence of changing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e031" xlink:type="simple"/></inline-formula> in the results section and describe the case of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e032" xlink:type="simple"/></inline-formula> in the following for simplicity. Consequently, we consider a model described by<disp-formula id="pone.0105942.e033"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e033" xlink:type="simple"/><label>(5)</label></disp-formula><disp-formula id="pone.0105942.e034"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e034" xlink:type="simple"/><label>(6)</label></disp-formula><disp-formula id="pone.0105942.e035"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e035" xlink:type="simple"/><label>(7)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e036" xlink:type="simple"/></inline-formula> is an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e037" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e038" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e039" xlink:type="simple"/></inline-formula> matrix representing regulation among genes, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e040" xlink:type="simple"/></inline-formula> is an <italic>N</italic>-dimensional hidden state variable, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e041" xlink:type="simple"/></inline-formula> is an <italic>N</italic>-dimensional vector including synthesis rates, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e042" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e043" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e044" xlink:type="simple"/></inline-formula> is a series of vectors containing observed expression levels of <italic>N</italic> genes at the <italic>t</italic>th time point and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e045" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e046" xlink:type="simple"/></inline-formula> is observational noise. Here, we define a set of all points of time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e047" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e048" xlink:type="simple"/></inline-formula>), consisting of the observed time set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e049" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e050" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e051" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e052" xlink:type="simple"/></inline-formula>). We set system noise <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e053" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e054" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e055" xlink:type="simple"/></inline-formula> and observation noise <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e056" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e057" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e058" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e059" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e060" xlink:type="simple"/></inline-formula> are <italic>N</italic>×<italic>N</italic> diagonal matrices. The initial state vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e061" xlink:type="simple"/></inline-formula> is assumed to be a Gaussian random vector with mean vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e062" xlink:type="simple"/></inline-formula> and covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e063" xlink:type="simple"/></inline-formula>, <italic>i.e.</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e064" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e065" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e066" xlink:type="simple"/></inline-formula>. Note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e067" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e068" xlink:type="simple"/></inline-formula> must be dense vectors; nevertheless, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e069" xlink:type="simple"/></inline-formula> should be a sparse matrix, and activation and repression correspond to positive and negative values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e070" xlink:type="simple"/></inline-formula>, respectively, because hill-functions are monotonic.</p>
<p>Contrary to the derivation of <xref ref-type="disp-formula" rid="pone.0105942.e033">Eq. (5)</xref>, in previous linear state space models for GRN analysis <xref ref-type="bibr" rid="pone.0105942-Hirose1">[21]</xref>, <xref ref-type="bibr" rid="pone.0105942-Kojima1">[29]</xref>, a simulation model was constructed as<disp-formula id="pone.0105942.e071"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e071" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e072" xlink:type="simple"/></inline-formula> is an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e073" xlink:type="simple"/></inline-formula> matrix in which the <italic>n</italic>th row and <italic>k</italic>th column element is represented by</p>
<p><disp-formula id="pone.0105942.e074"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e074" xlink:type="simple"/><label>(9)</label></disp-formula>In this model, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e075" xlink:type="simple"/></inline-formula> is removed by shifting the average of the observed time-course data for each element to 0, <italic>i.e.</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e076" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e077" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e078" xlink:type="simple"/></inline-formula> is the <italic>n</italic>th row element of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e079" xlink:type="simple"/></inline-formula>, as a normalization procedure. However, this model may cause marked difficulty in estimating gene regulatory relationships if the observed time-course includes a steady state. <xref ref-type="fig" rid="pone-0105942-g001">Fig. 1</xref> exemplifies such a situation.</p>
<fig id="pone-0105942-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.g001</object-id><label>Figure 1</label><caption>
<title>The problem of deleting a term representing a synthesis rate.</title>
<p>A toy model indicating the problem of deleting a synthesis rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e080" xlink:type="simple"/></inline-formula> by shifting an average of observed time-course data for each element to 0, <italic>i.e.</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e081" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e082" xlink:type="simple"/></inline-formula> as a normalization procedure. The true network and the adjusted data are illustrated in the left panel in (a) and (b), respectively. As shown in the right panel in (a), some false positive edges are possibly estimated in comparison to the true relationships.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g001" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pone-0105942-g001">Fig. 1</xref> shows a small pathway consisting of three genes (left panel in <xref ref-type="fig" rid="pone-0105942-g001">Fig. 1</xref> (a)) and the averages of the observed time-course data for each element are shifted to 0 (<xref ref-type="fig" rid="pone-0105942-g001">Fig. 1(b)</xref>). By applying <xref ref-type="disp-formula" rid="pone.0105942.e071">Eq. (8)</xref> to the observed data, we expect to obtain three false edges added to the true pathway (right panel in <xref ref-type="fig" rid="pone-0105942-g001">Fig. 1(a)</xref>) because nodes must retain a constant steady state regardless of their negative steady state values and positive regulation from negative nodes. In some cases, such additional false regulation possibly hide true regulation. The above result encourages us to use a model explicitly implementing terms to represent a steady state of gene expressions to estimate gene regulatory relationships precisely. Furthermore, in using <xref ref-type="disp-formula" rid="pone.0105942.e071">Eq. (8)</xref>, when elements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e083" xlink:type="simple"/></inline-formula> are regularized to be selected non-zero elements, even <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e084" xlink:type="simple"/></inline-formula> is regularized and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e085" xlink:type="simple"/></inline-formula> can be zero. To penalize the regulatory effect <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e086" xlink:type="simple"/></inline-formula> only, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e087" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e088" xlink:type="simple"/></inline-formula> are separately described in our proposed model.</p>
</sec><sec id="s2b">
<title>Incorporation of Biomolecules Affecting Biological Systems</title>
<p>When simulating the dynamic behavior of GRNs including biomolecules that cannot be represented by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e089" xlink:type="simple"/></inline-formula> and can affect biological systems, <italic>e.g.</italic>, corticosteroids in corticosteroid-stimulated GRNs, we should consider the concentration of such biomolecules. For these cases, we remodel <xref ref-type="disp-formula" rid="pone.0105942.e033">Eq. (5)</xref> to add a term representing the concentration of such biomolecules as<disp-formula id="pone.0105942.e090"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e090" xlink:type="simple"/><label>(10)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e091" xlink:type="simple"/></inline-formula> is an <italic>M</italic>-dimensional vector containing the concentration of the biomolecules at the <italic>t</italic>th time point, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e092" xlink:type="simple"/></inline-formula> is an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e093" xlink:type="simple"/></inline-formula> matrix and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e094" xlink:type="simple"/></inline-formula> is an <italic>M</italic>-dimensional vector representing their regulatory effects on the <italic>n</italic>th gene. We consider the case that the concentration is known or can be simulated. In the results section, for an application example, we deal with corticosteroid drug pathways that have been well studied previously <xref ref-type="bibr" rid="pone.0105942-Almon1">[37]</xref>, <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref>, <xref ref-type="bibr" rid="pone.0105942-Shimizu1">[41]</xref>; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e095" xlink:type="simple"/></inline-formula> is given the concentration of the intra-nuclear corticosteroid-receptor complex employed in Yao <italic>et al.</italic> <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref>.</p>
</sec><sec id="s2c">
<title>State Space Model and Kalman Filter for Estimating the Hidden State</title>
<p>Recently, many types of state space models have been proposed and applied in the context of systems biology <xref ref-type="bibr" rid="pone.0105942-Quach1">[13]</xref>, <xref ref-type="bibr" rid="pone.0105942-Barenco1">[19]</xref>–<xref ref-type="bibr" rid="pone.0105942-Hirose1">[21]</xref>, <xref ref-type="bibr" rid="pone.0105942-Sabatti1">[23]</xref>, <xref ref-type="bibr" rid="pone.0105942-Lillacci1">[48]</xref>, <xref ref-type="bibr" rid="pone.0105942-Sun1">[49]</xref>. They are roughly divided into two major classes, <italic>i.e.</italic>, linear and nonlinear models. In using linear state space models, posterior probability densities of the hidden state can be obtained as Gaussian distributions and the optimal mean and covariance matrices can be analytically calculated by the Kalman filter algorithm <xref ref-type="bibr" rid="pone.0105942-Kalman1">[50]</xref>, <xref ref-type="bibr" rid="pone.0105942-Shumway1">[51]</xref>. In contrast, for nonlinear state space models, because the analytical form can be intractable, several extensions of the Kalman filter algorithm, <italic>e.g.</italic>, extended Kalman filter <xref ref-type="bibr" rid="pone.0105942-Maybeck1">[52]</xref>, unscented Kalman filter <xref ref-type="bibr" rid="pone.0105942-Julier1">[53]</xref>, <xref ref-type="bibr" rid="pone.0105942-Julier2">[54]</xref> and particle filter <xref ref-type="bibr" rid="pone.0105942-Kitagawa1">[55]</xref>, which utilize approximation techniques, have been applied to obtain posterior probability densities of hidden state and parameters <xref ref-type="bibr" rid="pone.0105942-Quach1">[13]</xref>, <xref ref-type="bibr" rid="pone.0105942-Asif1">[24]</xref>, <xref ref-type="bibr" rid="pone.0105942-Lillacci1">[48]</xref>, <xref ref-type="bibr" rid="pone.0105942-Sun1">[49]</xref>, <xref ref-type="bibr" rid="pone.0105942-Liu1">[56]</xref>. In using linear state space models <xref ref-type="bibr" rid="pone.0105942-Barenco1">[19]</xref>–<xref ref-type="bibr" rid="pone.0105942-Rangel1">[22]</xref>, the main concern is to infer causal relationships among genes, for which regulatory structure is assumed to be sparse, <italic>i.e.</italic>, genes are regulated by only a few specific regulators. Imposing such a sparse constraint to regression approaches is a general problem, but for state space models to simultaneously estimate optimal hidden state and parameter values (including penalization parameters), it is not a trivial problem <xref ref-type="bibr" rid="pone.0105942-Greenfield1">[27]</xref>–<xref ref-type="bibr" rid="pone.0105942-Efron1">[30]</xref>, <xref ref-type="bibr" rid="pone.0105942-Shimamura1">[57]</xref>. Then, for example, a sparse regulatory structure was extracted by statistical tests after estimating parameter values <xref ref-type="bibr" rid="pone.0105942-Hirose1">[21]</xref>. In this article, under the framework of a state space representation of a VAR model, we intend to infer the parameter values and the hidden state maximizing prediction ability for observational data with a sparse regulatory structure. For this purpose, we apply the EM algorithm <xref ref-type="bibr" rid="pone.0105942-Dempster1">[58]</xref> in the next subsection and the conditional expectations of hidden state are given by using the Kalman filter algorithm.</p>
</sec><sec id="s2d">
<title>Kalman Filter Algorithm for VAR-SSM</title>
<p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e096" xlink:type="simple"/></inline-formula> be the sum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e097" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e098" xlink:type="simple"/></inline-formula>. For simplicity, we here use <italic>F</italic> in <xref ref-type="disp-formula" rid="pone.0105942.e071">Eq. (8)</xref> rather than <italic>A</italic>. The prediction, filtering, and smoothing of the Kalman filter are calculated by the following formulas:</p>
<list list-type="bullet"><list-item>
<p>Prediction:</p>
</list-item></list>
<p><disp-formula id="pone.0105942.e099"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e099" xlink:type="simple"/><label>(11)</label></disp-formula><disp-formula id="pone.0105942.e100"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e100" xlink:type="simple"/><label>(12)</label></disp-formula></p>
<list list-type="bullet"><list-item>
<p>Filtering:</p>
</list-item></list>
<p><disp-formula id="pone.0105942.e101"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e101" xlink:type="simple"/><label>(13)</label></disp-formula><disp-formula id="pone.0105942.e102"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e102" xlink:type="simple"/><label>(14)</label></disp-formula></p>
<list list-type="bullet"><list-item>
<p>Smoothing</p>
</list-item></list>
<p><disp-formula id="pone.0105942.e103"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e103" xlink:type="simple"/><label>(15)</label></disp-formula><disp-formula id="pone.0105942.e104"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e104" xlink:type="simple"/><label>(16)</label></disp-formula><disp-formula id="pone.0105942.e105"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e105" xlink:type="simple"/><label>(17)</label></disp-formula><disp-formula id="pone.0105942.e106"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e106" xlink:type="simple"/><label>(18)</label></disp-formula><disp-formula id="pone.0105942.e107"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e107" xlink:type="simple"/><label>(19)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e108" xlink:type="simple"/></inline-formula> given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e109" xlink:type="simple"/></inline-formula> is represented by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e110" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e111" xlink:type="simple"/></inline-formula> given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e112" xlink:type="simple"/></inline-formula> is represented by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e113" xlink:type="simple"/></inline-formula>. To calculate an inverse of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e114" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e115" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e116" xlink:type="simple"/></inline-formula> matrix, we use a matrix inversion theorem <xref ref-type="bibr" rid="pone.0105942-Kojima1">[29]</xref>.</p>
</sec><sec id="s2e">
<title>Maximum Likelihood Estimation Using the EM Algorithm with L1 Regularization</title>
<p>In biological systems, most genes are regulated by a few specific genes, <italic>i.e.</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e117" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e118" xlink:type="simple"/></inline-formula> can be sparse matrices. Thus, we applied <italic>L</italic>1 regularization to select effective sets of elements for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e119" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e120" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e121" xlink:type="simple"/></inline-formula> be the complete data set, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e122" xlink:type="simple"/></inline-formula> is the set of observed data and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e123" xlink:type="simple"/></inline-formula> is the set of state variables. Furthermore, let the probability densities <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e124" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e125" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e126" xlink:type="simple"/></inline-formula> be the <italic>N</italic>-dimensional Gaussian distributions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e127" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e128" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e129" xlink:type="simple"/></inline-formula>, respectively. Then joint likelihood for the complete data set is given by<disp-formula id="pone.0105942.e130"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e130" xlink:type="simple"/><label>(20)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e131" xlink:type="simple"/></inline-formula>. In this study, we used the EM algorithm <xref ref-type="bibr" rid="pone.0105942-Dempster1">[58]</xref> to search for the parameter vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e132" xlink:type="simple"/></inline-formula> that maximizes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e133" xlink:type="simple"/></inline-formula> under <italic>L</italic>1 regularization. The <italic>L</italic>1 regularized log-likelihood is given by<disp-formula id="pone.0105942.e134"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e134" xlink:type="simple"/><label>(21)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e135" xlink:type="simple"/></inline-formula> is the <italic>L</italic>1 regularization term for the <italic>n</italic>th row. In the EM algorithm, the conditional expectation of the joint log-likelihood of the complete data set<disp-formula id="pone.0105942.e136"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e136" xlink:type="simple"/><label>(22)</label></disp-formula>is iteratively maximized with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e137" xlink:type="simple"/></inline-formula> until convergence, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e138" xlink:type="simple"/></inline-formula> is the parameter vector obtained at the <italic>i</italic>th (previous) iteration.</p>
<p>The detailed solution for estimating parameter values using the EM algorithm for VAR-SSM with <italic>L</italic>1 regularization can be found in <xref ref-type="supplementary-material" rid="pone.0105942.s001">Method S1</xref>.</p>
</sec><sec id="s2f">
<title>Parameter Optimization Algorithm with <italic>L</italic>1 Regularization</title>
<p>Because of the combination of the regularization terms and a state space representation, updating an element of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e139" xlink:type="simple"/></inline-formula> influences the other active sets. Thus, it is difficult to select the optimal active sets <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e140" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e141" xlink:type="simple"/></inline-formula>, the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e142" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e143" xlink:type="simple"/></inline-formula> at the same time. Therefore, we proposed a novel algorithm to separately update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e144" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e145" xlink:type="simple"/></inline-formula> in each row as follows. In this algorithm, we consider candidates of active sets for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e146" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e147" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e148" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e149" xlink:type="simple"/></inline-formula>, respectively. In the EM algorithm in <xref ref-type="supplementary-material" rid="pone.0105942.s001">Method S1</xref>, we constraint that the active sets <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e150" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e151" xlink:type="simple"/></inline-formula> can be selected from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e152" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e153" xlink:type="simple"/></inline-formula>, respectively, <italic>i.e.</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e154" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e155" xlink:type="simple"/></inline-formula></p>
</sec><sec id="s2g">
<title>Algorithm</title>
<list list-type="simple"><list-item>
<p>-Initial Settings</p>
<list list-type="simple"><list-item>
<p>1. Set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e156" xlink:type="simple"/></inline-formula> and recursively update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e157" xlink:type="simple"/></inline-formula> to obtain <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e158" xlink:type="simple"/></inline-formula> using the EM algorithm until convergence is attained. In this step, active sets <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e159" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e160" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e161" xlink:type="simple"/></inline-formula> consist of all elements, <italic>i.e.</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e162" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e163" xlink:type="simple"/></inline-formula> become dense matrices, since the regularization terms can be neglected. Thus, the solution of the EM algorithm is directly obtained from Eqs. (SI–11)–(SI–17) in <xref ref-type="supplementary-material" rid="pone.0105942.s001">Method S1</xref>.</p>
</list-item><list-item>
<p>2. Set the maximum number of iterations to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e164" xlink:type="simple"/></inline-formula>, the maximum number of regulatory edges for each gene to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e165" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e166" xlink:type="simple"/></inline-formula> to be sufficiently high to allow all elements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e167" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e168" xlink:type="simple"/></inline-formula> to become 0, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e169" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e170" xlink:type="simple"/></inline-formula> to be full. Alternatively, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e171" xlink:type="simple"/></inline-formula> can be set as a value when the Bayesian information criterion (BIC) <xref ref-type="bibr" rid="pone.0105942-Schwarz1">[59]</xref>–<xref ref-type="bibr" rid="pone.0105942-Zou1">[61]</xref>, which are used to select the best model in this algorithms, is not updated through iterations and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e172" xlink:type="simple"/></inline-formula> can be set a sufficiently high value, <italic>e.g.</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e173" xlink:type="simple"/></inline-formula>. The BIC score in this algorithm is defined as</p>
</list-item></list>
</list-item></list>
<p><disp-formula id="pone.0105942.e174"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e174" xlink:type="simple"/><label>(23)</label></disp-formula><disp-formula id="pone.0105942.e175"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e175" xlink:type="simple"/><label>(24)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e176" xlink:type="simple"/></inline-formula> is the degree of freedom, <italic>i.e.</italic>, the number of active parameters <xref ref-type="bibr" rid="pone.0105942-Zou1">[61]</xref>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e177" xlink:type="simple"/></inline-formula> is the number of samples.</p>
<list list-type="bullet"><list-item>
<list list-type="simple"><list-item>
<p>3. Set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e178" xlink:type="simple"/></inline-formula> and recursively update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e179" xlink:type="simple"/></inline-formula> as follows. Note that, at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e180" xlink:type="simple"/></inline-formula>, we fix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e181" xlink:type="simple"/></inline-formula> as the values obtained at Step 1, except for the updating elements indicated as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e182" xlink:type="simple"/></inline-formula> in the next step. Thus, we only update the values of the parameters for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e183" xlink:type="simple"/></inline-formula>th row at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e184" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
</list-item><list-item>
<p>-Main Routine</p>
<list list-type="simple"><list-item>
<p>4. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e185" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e186" xlink:type="simple"/></inline-formula></p>
<list list-type="alpha-lower"><list-item>
<p>(a) Set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e187" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e188" xlink:type="simple"/></inline-formula> full and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e189" xlink:type="simple"/></inline-formula> sufficiently high to allow all elements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e190" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e191" xlink:type="simple"/></inline-formula> become <bold>0</bold>. Through the following steps, fixing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e192" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e193" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e194" xlink:type="simple"/></inline-formula> is gradually decreased to find an optimum <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e195" xlink:type="simple"/></inline-formula> for which the BIC score is minimized.</p>
</list-item><list-item>
<p>(b) Calculate conditional expectations using the Kalman filter.</p>
<p>(c) Update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e196" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e197" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e198" xlink:type="simple"/></inline-formula> by Eqs. (SI–11)–(SI–19) in <xref ref-type="supplementary-material" rid="pone.0105942.s001">Method S1</xref>. Here, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e199" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e200" xlink:type="simple"/></inline-formula> of Eqs. (SI–18)–(SI–19) in <xref ref-type="supplementary-material" rid="pone.0105942.s001">Method S1</xref> can be constructed from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e201" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e202" xlink:type="simple"/></inline-formula>, respectively.</p>
<p>(d) Calculate the BIC score and decrease <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e203" xlink:type="simple"/></inline-formula> if the regularized log-likelihood of <xref ref-type="disp-formula" rid="pone.0105942.e134">Eq. (21)</xref> is converged. Then, repeat from step (b) until the sum total of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e204" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e205" xlink:type="simple"/></inline-formula> becomes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e206" xlink:type="simple"/></inline-formula>.</p>
<p>(e) Set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e207" xlink:type="simple"/></inline-formula> as the value with the lowest BIC score obtained through the above described steps. Furthermore, set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e208" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e209" xlink:type="simple"/></inline-formula>.</p>
<p>(f) Consider the set of all subsets of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e210" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e211" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e212" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e213" xlink:type="simple"/></inline-formula>, respectively. For all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e214" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e215" xlink:type="simple"/></inline-formula>, setting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e216" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e217" xlink:type="simple"/></inline-formula>, repeat steps 4(b) and (c), and then obtain the BIC scores of converged log-likelihood.</p>
<p>(g) Set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e218" xlink:type="simple"/></inline-formula> as the value with the lowest BIC score. Furthermore, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e219" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e220" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
</list-item><list-item>
<p>5. Set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e221" xlink:type="simple"/></inline-formula> and repeat from step 4 until <italic>i</italic> becomes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e222" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
</list-item></list>
<p>A conceptual view and a pseudo code of the algorithm are shown in <xref ref-type="fig" rid="pone-0105942-g002">Figure 2</xref> and Algorithm 1 in <xref ref-type="table" rid="pone-0105942-t001">Table 1</xref>, respectively. We should note that, since the active sets <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e223" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e224" xlink:type="simple"/></inline-formula> obtained at step 4(e) may not be the optimal ones for the selected <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e225" xlink:type="simple"/></inline-formula>, <italic>i.e.</italic>, there can exist better ones having lower BIC scores for the selected <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e226" xlink:type="simple"/></inline-formula>, the proposed algorithm further explores such better ones by evaluating subsets of the obtained active sets at step 4(e) through steps 4(f) and (g).</p>
<fig id="pone-0105942-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.g002</object-id><label>Figure 2</label><caption>
<title>The conceptual view of the proposed algorithm.</title>
<p>This figure illustrates a conceptual view of the proposed algorithm. The notations ‘Step’ correspond to those of the proposed algorithm. Solid, dashed and chain lines represent flowchart of the algorithm, setting the parameter values and active sets, and setting candidates of active sets used for selecting active sets.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g002" position="float" xlink:type="simple"/></fig><table-wrap id="pone-0105942-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.t001</object-id><label>Table 1</label><caption>
<title>Algorithm 1: A pseudo code of Main Routine (step 4 and 5) in the proposed algorithm.</title>
</caption><alternatives><graphic id="pone-0105942-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/></colgroup>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e227" xlink:type="simple"/></inline-formula>;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2: <bold>for</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e228" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e229" xlink:type="simple"/></inline-formula> <bold>do</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3:  <bold>for</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e230" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e231" xlink:type="simple"/></inline-formula> <bold>do</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">4:   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e232" xlink:type="simple"/></inline-formula> a sufficiently high value;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">5:   <bold>while</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e233" xlink:type="simple"/></inline-formula> <bold>do</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">6:    <bold>while</bold> convergence criterion is not satisfied <bold>do</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">7:     Update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e234" xlink:type="simple"/></inline-formula> and parameter values using the Kalman filter and the EM-algorithm;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">8:    <bold>end while</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">9:    <bold>if</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e235" xlink:type="simple"/></inline-formula>; <bold>then</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">10:     <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e236" xlink:type="simple"/></inline-formula>; Store the current parameter values;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">11:     where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e237" xlink:type="simple"/></inline-formula> is the BIC score of the current parameter values</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">12:    <bold>end if</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">13:    Decrease <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e238" xlink:type="simple"/></inline-formula>;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">14:   <bold>end while</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">15:   Set the stored parameter values as the current parameter values;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">16:   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e239" xlink:type="simple"/></inline-formula> the set of all subsets of the current <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e240" xlink:type="simple"/></inline-formula>;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">17:   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e241" xlink:type="simple"/></inline-formula> the set of all subsets of the current <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e242" xlink:type="simple"/></inline-formula>;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">18:   <bold>for all</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e243" xlink:type="simple"/></inline-formula> <bold>do</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">19:    <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e244" xlink:type="simple"/></inline-formula>;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">20:    <bold>for all</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e245" xlink:type="simple"/></inline-formula> <bold>do</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">21:     <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e246" xlink:type="simple"/></inline-formula>;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">22:     <bold>while</bold> convergence criterion is not satisfied <bold>do</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">23:      Update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e247" xlink:type="simple"/></inline-formula> and parameter values using the Kalman filter and the EM-algorithm;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">24:     <bold>end while</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">25:     <bold>if</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e248" xlink:type="simple"/></inline-formula> <bold>then</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">26:      <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e249" xlink:type="simple"/></inline-formula>; Store the current parameter values;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">27:      <bold>end if</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">28:     <bold>end for</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">29:    <bold>end for</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">30:    Set the stored parameter values as the current parameter values;</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">31:   <bold>end for</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">32: <bold>end for</bold></td>
</tr>
</tbody>
</table>
</alternatives></table-wrap></sec><sec id="s2h">
<title>Weighting Known Regulations</title>
<p>To weight parameters of known regulations, <italic>e.g.</italic>, as recorded in the literature, we derive the weighted regularization <xref ref-type="bibr" rid="pone.0105942-Shimamura2">[62]</xref>. For the <italic>n</italic>th row, we define the weight vectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e250" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e251" xlink:type="simple"/></inline-formula>. The elements of these vectors for known regulations are set to less than 1 or, otherwise set to 1. Then, in the M step of the EM algorithm and the regularized log-likelihood, regularization terms are handled as<disp-formula id="pone.0105942.e252"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e252" xlink:type="simple"/><label>(25)</label></disp-formula></p>
<p><disp-formula id="pone.0105942.e253"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0105942.e253" xlink:type="simple"/><label>(26)</label></disp-formula></p>
<p>In practice, the purpose of the weight is to select known regulation in the instance where multiple candidates are highly correlated with the same gene. Thus, when the correlation of a known regulation is still a low value, the regulation should not be selected as an active regulation. For example, weights for literature-recorded pathways and regulations by TFs are set as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e254" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e255" xlink:type="simple"/></inline-formula> in the real data experiment, respectively. The effectiveness of the weighted regularization is demonstrated in the results section.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Comparison Results</title>
<p>To show the effectiveness of the proposed method, we compared it with other GRN inference methods, <italic>i.e.</italic>, a state space model (SSM) <xref ref-type="bibr" rid="pone.0105942-Hirose1">[21]</xref>, <xref ref-type="bibr" rid="pone.0105942-Tamada1">[63]</xref>, a general VAR model using the LARS-LASSO algorithm <xref ref-type="bibr" rid="pone.0105942-Efron1">[30]</xref>, <xref ref-type="bibr" rid="pone.0105942-Zou1">[61]</xref>, GeneNet <xref ref-type="bibr" rid="pone.0105942-Schfer1">[31]</xref>, <xref ref-type="bibr" rid="pone.0105942-OpgenRhein1">[32]</xref> based on an empirical graphical Gaussian model (GGM), dynamic Bayesian networks using first order conditional dependencies (G1DBN) <xref ref-type="bibr" rid="pone.0105942-Lbre1">[33]</xref>, GLASSO <xref ref-type="bibr" rid="pone.0105942-Friedman3">[34]</xref> based on sparse GGM and the mutual information-based network inference algorithms: ARACNE <xref ref-type="bibr" rid="pone.0105942-Margolin1">[3]</xref>, CLR <xref ref-type="bibr" rid="pone.0105942-Faith1">[35]</xref> and MRNET <xref ref-type="bibr" rid="pone.0105942-Meyer1">[36]</xref>. We applied these inference methods by using R-package (‘GeneNet’, ‘G1DBN’, ‘glasso’ and ‘parmigene’) and implementing the others. The comparison analysis was performed using three artificial data, which were generated based on pharmacogenomic pathways that we assumed and a yeast network that was produced as a part of the DREAM4 (Dialogue for Reverse Engineering Assessments and Methods) challenge. We should note that, because ARACNE, CLR and MRNET are intended to infer static relationships between genes, we considered time-course observational data as static data utilizing a time-lag matrix, in which the <italic>t</italic>th row vector consists of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e256" xlink:type="simple"/></inline-formula>, according to Shimamura <italic>et al.</italic> <xref ref-type="bibr" rid="pone.0105942-Shimamura1">[57]</xref>. Note that the Jar file of the proposed method is available at: <ext-link ext-link-type="uri" xlink:href="http://sunflower.kuicr.kyoto-u.ac.jp" xlink:type="simple">http://sunflower.kuicr.kyoto-u.ac.jp</ext-link>.</p>
</sec><sec id="s3b">
<title>Comparison Using Pharmacogenomic Pathways</title>
<p>For the comparison, we first generated two time-courses from (i) linear difference equations as <xref ref-type="disp-formula" rid="pone.0105942.e025">Eq. (4)</xref> and (ii) nonlinear differential equations as <xref ref-type="disp-formula" rid="pone.0105942.e011">Eqs. (1)</xref>–<xref ref-type="disp-formula" rid="pone.0105942.e017">(3)</xref> representing pharmacogenomic pathways (<italic>e.g.</italic>, Yao <italic>et al.</italic> <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref>) using Cell Illustrator 5.0 (<ext-link ext-link-type="uri" xlink:href="http://www.cellillustrator.com/home" xlink:type="simple">http://www.cellillustrator.com/home</ext-link>). The details of the artificial simulation models are as follows.</p>
<list list-type="simple"><list-item>
<p><italic>-Dataset</italic>(<italic>i</italic>)</p>
<list list-type="order"><list-item>
<p>The number of genes is 18.</p>
</list-item><list-item>
<p>Each gene undergoes synthesis and degradation processes, and genes are mutually regulated as shown in <xref ref-type="fig" rid="pone-0105942-g003">Fig 3</xref> (The details of the figure are explained below).</p>
</list-item><list-item>
<p>A drug is added at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e263" xlink:type="simple"/></inline-formula> and its concentration gradually decreases according to one compartment model, <italic>i.e.</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e264" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e265" xlink:type="simple"/></inline-formula> is the concentration of the drug as a function of time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e266" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e267" xlink:type="simple"/></inline-formula> is the degradation rate. The simulated expression profiles of the genes are initiated by the drug at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e268" xlink:type="simple"/></inline-formula> and gradually converge to their steady states as illustrated in <xref ref-type="fig" rid="pone-0105942-g004">Fig. 4</xref>.</p>
</list-item><list-item>
<p>The expression data is observed at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e269" xlink:type="simple"/></inline-formula> = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e270" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e271" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e272" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e273" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e274" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e275" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e276" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e277" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e278" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e279" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e280" xlink:type="simple"/></inline-formula> with Gaussian observation noise of mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e281" xlink:type="simple"/></inline-formula> and a variance that is proportional to the intensity.</p>
</list-item><list-item>
<p>The number of replicated observations with different observational noise for each time point is three.</p>
</list-item><list-item>
<p>The simulated expression is updated according to the linear difference equations represented by <xref ref-type="disp-formula" rid="pone.0105942.e025">Eq. (4)</xref> at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e282" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>The observational data and the values of the parameters are available at <xref ref-type="supplementary-material" rid="pone.0105942.s002">Model S1</xref>.</p>
</list-item></list>
</list-item><list-item>
<p><italic>-Dataset</italic>(<italic>ii</italic>)</p>
</list-item></list>
<fig id="pone-0105942-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.g003</object-id><label>Figure 3</label><caption>
<title>A pharmacogenomic pathway of the artificial simulation model.</title>
<p>The figure illustrates the pathway of the artificial simulation model used for datasets (i) and (ii). Each regulation is represented by (i) a linear and (ii) a nonlinear function, such as <xref ref-type="disp-formula" rid="pone.0105942.e017">Eq. (3)</xref>. For dataset (ii), descriptions on edges as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e257" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e258" xlink:type="simple"/></inline-formula> means a linear function and a hill function, described in <xref ref-type="disp-formula" rid="pone.0105942.e017">Eq. (3)</xref> when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e259" xlink:type="simple"/></inline-formula>, respectively. The system is stable at first (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e260" xlink:type="simple"/></inline-formula>) and undergoes stimulation by a drug at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e261" xlink:type="simple"/></inline-formula>. The concentration of the drug is gradually decreased according to the drug kinetics. A solid arrow and a dotted arrow mean activation and repression, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g003" position="float" xlink:type="simple"/></fig><fig id="pone-0105942-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.g004</object-id><label>Figure 4</label><caption>
<title>The simulation expression profiles of genes of the artificial simulation model.</title>
<p>This illustrates the simulation expression profiles of genes of the artificial simulation model used for dataset (ii). The simulated data for datasets (i) and (ii) have both dynamic and steady state, and stimulated by the drug at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e262" xlink:type="simple"/></inline-formula>. Observational time-course data is obtained with Gaussian noise from the simulation expression at the time points that are indicated on the bottom axis. The observational data, parameter values and simulation models are available at <xref ref-type="supplementary-material" rid="pone.0105942.s002">Models S1</xref> and <xref ref-type="supplementary-material" rid="pone.0105942.s003">S2</xref>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g004" position="float" xlink:type="simple"/></fig>
<p>1 to 5 of dataset (i) are also satisfied in dataset (ii).</p>
<list list-type="simple"><list-item>
<list list-type="simple"><list-item>
<p>6. The simulated expression is updated according to the differential equations. Regulatory relationships are the same as in (i) but the regulatory effects are represented by hill functions, such as <xref ref-type="disp-formula" rid="pone.0105942.e011">Eqs. (1)</xref>–<xref ref-type="disp-formula" rid="pone.0105942.e017">(3)</xref>, or linear functions, as illustrated in <xref ref-type="fig" rid="pone-0105942-g003">Fig 3</xref>. In this figure, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e283" xlink:type="simple"/></inline-formula> indicates that the regulation is described by <xref ref-type="disp-formula" rid="pone.0105942.e017">Eq. (3)</xref> when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e284" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>7. The observational data and the csml (cell system markup language) file are available at <xref ref-type="supplementary-material" rid="pone.0105942.s003">Model S2</xref>.</p>
</list-item></list>
</list-item></list>
<p>A true positive (TP), false positive (FP), false negative (FN), precision rate (PR = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e285" xlink:type="simple"/></inline-formula>), and recall rate (RR = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e286" xlink:type="simple"/></inline-formula>) were used to measure the performance. At first, in applying the proposed method to the data, we changed the simulation time interval of <xref ref-type="disp-formula" rid="pone.0105942.e025">Eq. (4)</xref> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e287" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e288" xlink:type="simple"/></inline-formula>, and estimated active sets of regulation (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e289" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e290" xlink:type="simple"/></inline-formula>) and the values of the parameters for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e291" xlink:type="simple"/></inline-formula> for each dataset. The results for datasets (i) and (ii) are illustrated in <xref ref-type="fig" rid="pone-0105942-g005">Figs. 5</xref> and <xref ref-type="fig" rid="pone-0105942-g006">6</xref>, respectively. The precision and recall rates in <xref ref-type="fig" rid="pone-0105942-g005">Figs. 5</xref> and <xref ref-type="fig" rid="pone-0105942-g006">6</xref> show that the performance of the structure inference gradually increases from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e292" xlink:type="simple"/></inline-formula> and is optimal at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e293" xlink:type="simple"/></inline-formula> for (i) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e294" xlink:type="simple"/></inline-formula> for (ii). This indicates that the simulation time interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e295" xlink:type="simple"/></inline-formula> can influence the performance of structure inference and we should carefully design <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e296" xlink:type="simple"/></inline-formula> for biological simulations. In order to determine <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e297" xlink:type="simple"/></inline-formula>, we measured the BIC scores and the sum of squared prediction errors (SPE) at three time points (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e298" xlink:type="simple"/></inline-formula> and 12) for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e299" xlink:type="simple"/></inline-formula> using (i) and (ii), as represented in <xref ref-type="fig" rid="pone-0105942-g007">Fig. 7</xref> and <xref ref-type="fig" rid="pone-0105942-g008">Fig. 8</xref>, respectively. Here, we measured the prediction errors for each time point by optimizing the values of the estimated parameters without using the observational data at the corresponding time point (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e300" xlink:type="simple"/></inline-formula>).</p>
<fig id="pone-0105942-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.g005</object-id><label>Figure 5</label><caption>
<title>The results of the structure inference using dataset (i) of a pharmacogenomic pathway by the proposed method.</title>
<p>This figure illustrates the results of the structure inference after applying the proposed method to dataset (i) for each simulation time interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e301" xlink:type="simple"/></inline-formula>. The histogram represents the number of true positive (TP), false positive (FP), and false negative (FN) findings for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e302" xlink:type="simple"/></inline-formula> as red, blue, and green bars, respectively. Black lines with circles and crosses represent ‘precision rate (PR = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e303" xlink:type="simple"/></inline-formula>)’ and ‘recall rate (RR = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e304" xlink:type="simple"/></inline-formula>)’, respectively. The values of the histogram and lines correspond to the left and right axes, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g005" position="float" xlink:type="simple"/></fig><fig id="pone-0105942-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.g006</object-id><label>Figure 6</label><caption>
<title>The results of the structure inference using dataset (ii) of a pharmacogenomic pathway by the proposed method.</title>
<p>This figure illustrates the results of the structure inference after applying the proposed method to dataset (ii) for each simulation time interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e305" xlink:type="simple"/></inline-formula>. The histogram represents the number of true positive (TP), false positive (FP), and false negative (FN) findings for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e306" xlink:type="simple"/></inline-formula> as red, blue, and green bars, respectively. Black lines with circles and crosses represent ‘precision rate (PR = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e307" xlink:type="simple"/></inline-formula>)’ and ‘recall rate (RR = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e308" xlink:type="simple"/></inline-formula>)’, respectively. The values of the histogram and lines correspond to the left and right axes, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g006" position="float" xlink:type="simple"/></fig><fig id="pone-0105942-g007" position="float"><label>Figure 7</label><caption>
<title>The result of the BIC scores and SPE for each simulation time interval using dataset (i).</title>
<p>This illustrates the BIC scores and SPE (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e309" xlink:type="simple"/></inline-formula>) for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e310" xlink:type="simple"/></inline-formula> for dataset (i). The values of the BIC scores and SPE correspond to the left and right axes, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g007" position="float" xlink:type="simple"/></fig><fig id="pone-0105942-g008" position="float"><label>Figure 8</label><caption>
<title>The result of the BIC scores and SPE for each simulation time interval using dataset (ii).</title>
<p>This illustrates the BIC scores and SPE (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e311" xlink:type="simple"/></inline-formula>) for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e312" xlink:type="simple"/></inline-formula> for dataset (ii). The values of the BIC scores and SPE correspond to the left and right axes, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g008" position="float" xlink:type="simple"/></fig>
<p>For dataset (i), although the PR and RR values peak at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e313" xlink:type="simple"/></inline-formula>, the BIC scores become lowest at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e314" xlink:type="simple"/></inline-formula>. Similarly, the BIC score becomes lowest at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e315" xlink:type="simple"/></inline-formula> but peaks at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e316" xlink:type="simple"/></inline-formula> for dataset (ii). SPE gradually converges when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e317" xlink:type="simple"/></inline-formula> becomes large and has the lowest value at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e318" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e319" xlink:type="simple"/></inline-formula> for datasets (i) and (ii), respectively. Therefore, SPE can be an indicator for determining the best time interval for this hill function-based system of pharmacogenomics. Note that the measured time points for the prediction errors should be the points that are not steady state values.</p>
<p>Next, we compared the results of (a) the proposed VAR-SSM with the lowest BIC and (b) the proposed VAR-SSM with the lowest SPE to (c) SSM <xref ref-type="bibr" rid="pone.0105942-Hirose1">[21]</xref>, <xref ref-type="bibr" rid="pone.0105942-Tamada1">[63]</xref> (permutation tests were utilized to select regulations), (d) VAR model with <italic>L</italic>1 regularization using the LARS-LASSO algorithm <xref ref-type="bibr" rid="pone.0105942-Efron1">[30]</xref>, <xref ref-type="bibr" rid="pone.0105942-Zou1">[61]</xref> (the BIC score is used to determine the value of the regularization parameters), GeneNet <xref ref-type="bibr" rid="pone.0105942-Schfer1">[31]</xref>, <xref ref-type="bibr" rid="pone.0105942-OpgenRhein1">[32]</xref>, G1DBN <xref ref-type="bibr" rid="pone.0105942-Lbre1">[33]</xref>, GLASSO <xref ref-type="bibr" rid="pone.0105942-Friedman3">[34]</xref>, ARACNE <xref ref-type="bibr" rid="pone.0105942-Margolin1">[3]</xref>, CLR <xref ref-type="bibr" rid="pone.0105942-Faith1">[35]</xref> and MRNET <xref ref-type="bibr" rid="pone.0105942-Meyer1">[36]</xref>. The comparison results for datasets (i) and (ii) are listed in <xref ref-type="table" rid="pone-0105942-t002">Tables 2</xref> and <xref ref-type="table" rid="pone-0105942-t003">3</xref>, respectively. In these comparisons, we added the drug profiles to the observational data and did not count regulations in response to drugs and self-regulation. For the methods inferring undirected regulations, <italic>i.e.</italic>, GeneNet, GLASSO, ARACNE, CLR and MRNET, we considered the true network (directed network) as an undirected network and then measured the performance by comparing this undirected network to the inferred networks. Additionally, for GeneNet, G1DBN and mutual information-based methods (ARACNE, CLR and MRNET), which are required to set a threshold value to determine the existence of regulation, we checked the results of setting the threshold <italic>q</italic>-value (GeneNet) and posterior probability (G1DBN) to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e320" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e321" xlink:type="simple"/></inline-formula> and a cut-off value (ARACNE, CLR and MRNET) to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e322" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e323" xlink:type="simple"/></inline-formula>, and adopted the best thresholds with respect to <italic>F</italic>-<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e324" xlink:type="simple"/></inline-formula>. We should note that the simulation time interval of SSM is set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e325" xlink:type="simple"/></inline-formula> (no other choice is available) due to the implementation of Tamada <italic>et al.</italic> <xref ref-type="bibr" rid="pone.0105942-Tamada1">[63]</xref>. It is hard to make the simulation time interval short; hence, the simulated expression profiles often oscillated in such situations.</p>
<table-wrap id="pone-0105942-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.t002</object-id><label>Table 2</label><caption>
<title>Comparison of the proposed method and the existing methods using dataset (i).</title>
</caption><alternatives><graphic id="pone-0105942-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">PR</td>
<td align="left" rowspan="1" colspan="1">RR</td>
<td align="left" rowspan="1" colspan="1">TP</td>
<td align="left" rowspan="1" colspan="1">FP</td>
<td align="left" rowspan="1" colspan="1">TN</td>
<td align="left" rowspan="1" colspan="1">FN</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e326" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.467</td>
<td align="left" rowspan="1" colspan="1">0.634</td>
<td align="left" rowspan="1" colspan="1">14</td>
<td align="left" rowspan="1" colspan="1">16</td>
<td align="left" rowspan="1" colspan="1">286</td>
<td align="left" rowspan="1" colspan="1">8</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e327" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.600</td>
<td align="left" rowspan="1" colspan="1">0.818</td>
<td align="left" rowspan="1" colspan="1">18</td>
<td align="left" rowspan="1" colspan="1">12</td>
<td align="left" rowspan="1" colspan="1">290</td>
<td align="left" rowspan="1" colspan="1">4</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e328" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.308</td>
<td align="left" rowspan="1" colspan="1">0.182</td>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">9</td>
<td align="left" rowspan="1" colspan="1">293</td>
<td align="left" rowspan="1" colspan="1">18</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e329" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.150</td>
<td align="left" rowspan="1" colspan="1">0.773</td>
<td align="left" rowspan="1" colspan="1">17</td>
<td align="left" rowspan="1" colspan="1">97</td>
<td align="left" rowspan="1" colspan="1">205</td>
<td align="left" rowspan="1" colspan="1">5</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e330" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.280</td>
<td align="left" rowspan="1" colspan="1">0.667</td>
<td align="left" rowspan="1" colspan="1">14</td>
<td align="left" rowspan="1" colspan="1">36</td>
<td align="left" rowspan="1" colspan="1">114</td>
<td align="left" rowspan="1" colspan="1">7</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e331" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.314</td>
<td align="left" rowspan="1" colspan="1">0.500</td>
<td align="left" rowspan="1" colspan="1">11</td>
<td align="left" rowspan="1" colspan="1">24</td>
<td align="left" rowspan="1" colspan="1">278</td>
<td align="left" rowspan="1" colspan="1">11</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e332" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.094</td>
<td align="left" rowspan="1" colspan="1">0.286</td>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1">58</td>
<td align="left" rowspan="1" colspan="1">92</td>
<td align="left" rowspan="1" colspan="1">15</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e333" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.131</td>
<td align="left" rowspan="1" colspan="1">0.524</td>
<td align="left" rowspan="1" colspan="1">11</td>
<td align="left" rowspan="1" colspan="1">71</td>
<td align="left" rowspan="1" colspan="1">79</td>
<td align="left" rowspan="1" colspan="1">10</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e334" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.135</td>
<td align="left" rowspan="1" colspan="1">0.619</td>
<td align="left" rowspan="1" colspan="1">13</td>
<td align="left" rowspan="1" colspan="1">83</td>
<td align="left" rowspan="1" colspan="1">67</td>
<td align="left" rowspan="1" colspan="1">8</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e335" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.121</td>
<td align="left" rowspan="1" colspan="1">0.571</td>
<td align="left" rowspan="1" colspan="1">12</td>
<td align="left" rowspan="1" colspan="1">87</td>
<td align="left" rowspan="1" colspan="1">63</td>
<td align="left" rowspan="1" colspan="1">9</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap><table-wrap id="pone-0105942-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.t003</object-id><label>Table 3</label><caption>
<title>Comparison of the proposed method and the existing methods using dataset (ii).</title>
</caption><alternatives><graphic id="pone-0105942-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.t003" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">PR</td>
<td align="left" rowspan="1" colspan="1">RR</td>
<td align="left" rowspan="1" colspan="1">TP</td>
<td align="left" rowspan="1" colspan="1">FP</td>
<td align="left" rowspan="1" colspan="1">TN</td>
<td align="left" rowspan="1" colspan="1">FN</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e336" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.563</td>
<td align="left" rowspan="1" colspan="1">0.818</td>
<td align="left" rowspan="1" colspan="1">18</td>
<td align="left" rowspan="1" colspan="1">14</td>
<td align="left" rowspan="1" colspan="1">288</td>
<td align="left" rowspan="1" colspan="1">4</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e337" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.613</td>
<td align="left" rowspan="1" colspan="1">0.864</td>
<td align="left" rowspan="1" colspan="1">19</td>
<td align="left" rowspan="1" colspan="1">12</td>
<td align="left" rowspan="1" colspan="1">290</td>
<td align="left" rowspan="1" colspan="1">3</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e338" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.234</td>
<td align="left" rowspan="1" colspan="1">0.318</td>
<td align="left" rowspan="1" colspan="1">7</td>
<td align="left" rowspan="1" colspan="1">23</td>
<td align="left" rowspan="1" colspan="1">279</td>
<td align="left" rowspan="1" colspan="1">15</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e339" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.206</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
<td align="left" rowspan="1" colspan="1">22</td>
<td align="left" rowspan="1" colspan="1">84</td>
<td align="left" rowspan="1" colspan="1">236</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e340" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.278</td>
<td align="left" rowspan="1" colspan="1">0.714</td>
<td align="left" rowspan="1" colspan="1">15</td>
<td align="left" rowspan="1" colspan="1">39</td>
<td align="left" rowspan="1" colspan="1">111</td>
<td align="left" rowspan="1" colspan="1">6</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e341" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.647</td>
<td align="left" rowspan="1" colspan="1">0.500</td>
<td align="left" rowspan="1" colspan="1">11</td>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1">296</td>
<td align="left" rowspan="1" colspan="1">11</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e342" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.052</td>
<td align="left" rowspan="1" colspan="1">0.143</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">55</td>
<td align="left" rowspan="1" colspan="1">95</td>
<td align="left" rowspan="1" colspan="1">18</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e343" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.191</td>
<td align="left" rowspan="1" colspan="1">0.429</td>
<td align="left" rowspan="1" colspan="1">9</td>
<td align="left" rowspan="1" colspan="1">38</td>
<td align="left" rowspan="1" colspan="1">112</td>
<td align="left" rowspan="1" colspan="1">12</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e344" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.156</td>
<td align="left" rowspan="1" colspan="1">0.667</td>
<td align="left" rowspan="1" colspan="1">14</td>
<td align="left" rowspan="1" colspan="1">76</td>
<td align="left" rowspan="1" colspan="1">74</td>
<td align="left" rowspan="1" colspan="1">7</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e345" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.156</td>
<td align="left" rowspan="1" colspan="1">0.667</td>
<td align="left" rowspan="1" colspan="1">14</td>
<td align="left" rowspan="1" colspan="1">76</td>
<td align="left" rowspan="1" colspan="1">74</td>
<td align="left" rowspan="1" colspan="1">7</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>Consequently, the proposed method achieved a low false positive rate while maintaining a high true positive rate. These results may be acceptable because the system model of the proposed method is the same as or similar to the artificial simulation models. Thus, it is conceivable that the proposed method is highly capable of inferring the regulatory structure of the assumed hill-function based model. Furthermore, we demonstrated the effectiveness of the weighted regularization for known prior information using dataset (ii). To evaluate the performance, we adapted a simulation time interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e346" xlink:type="simple"/></inline-formula>. Setting weights for true regulations as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e347" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e348" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e349" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e350" xlink:type="simple"/></inline-formula>, PR and RR were evaluated as illustrated in <xref ref-type="fig" rid="pone-0105942-g009">Fig. 9</xref>. The correct weights reduced the FP and FN edges, and the performance was gradually improved according to the increase in the weight coefficient. In contrast, several FP edges still exist even when the weight coefficients take on high values. It can be considered that the simplification of the true regulatory system using the proposed model generates these false edges to effectively predict the data.</p>
<fig id="pone-0105942-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.g009</object-id><label>Figure 9</label><caption>
<title>The performance of using prior knowledge as the weighted regularization.</title>
<p>This figure illustrates the effectiveness of the weighted regularization (prior knowledge) at simulation time interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e351" xlink:type="simple"/></inline-formula> using dataset (ii). The histogram represents the number of true positive (TP), false positive (FP), and false negative (FN) findings for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e352" xlink:type="simple"/></inline-formula> as red, blue, and green bars, respectively. Black lines with circles and crosses represent ‘precision rate (PR<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e353" xlink:type="simple"/></inline-formula>)’ and ‘recall rate (RR<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e354" xlink:type="simple"/></inline-formula>)’, respectively. The values of the histogram and lines correspond to the left and right axes, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g009" position="float" xlink:type="simple"/></fig></sec><sec id="s3c">
<title>Comparison Using Yeast Network of a Part of the DREAM4 Challenge</title>
<p>In contrast to the previous comparisons, for which the data were based on the assumed models as <xref ref-type="disp-formula" rid="pone.0105942.e011">Eqs. (1)</xref>–<xref ref-type="disp-formula" rid="pone.0105942.e025">(4)</xref>, we next prepared data generated by GeneNetWaver <xref ref-type="bibr" rid="pone.0105942-Marbach1">[39]</xref>, <xref ref-type="bibr" rid="pone.0105942-Schaffter1">[40]</xref> using a 10-node yeast network (<italic>yeast 1</italic>) of a part of the DREAM4 challenge (in silico network challenge). To measure the performance of the proposed method, in this comparison, we generated dataset (iii), which was a set of 100 time-course observational data, in which the measured time points were <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e355" xlink:type="simple"/></inline-formula>.</p>
<p>According to the original setting, three genes, which were randomly selected for each time-course, were perturbed among <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e356" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e357" xlink:type="simple"/></inline-formula>. Here, since we intended to consider the case that observational data have a steady state, the number of time points was to be set larger than those of the original setting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e358" xlink:type="simple"/></inline-formula>. The dataset (iii) is available at <xref ref-type="supplementary-material" rid="pone.0105942.s004">Model S3</xref>.</p>
<p>We applied the methods (a)–(j) to dataset (iii); however, since SSM <xref ref-type="bibr" rid="pone.0105942-Hirose1">[21]</xref>, <xref ref-type="bibr" rid="pone.0105942-Tamada1">[63]</xref> requires large computational costs to perform permutation tests for each time-course, we neglected SSM for this comparison. The time points to calculate SPE for the proposed method are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e359" xlink:type="simple"/></inline-formula>, which are the time points shortly after removal of perturbations. For each method, we summed the existence of the estimated regulation on the <italic>i</italic>th gene by <italic>j</italic>th gene as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e360" xlink:type="simple"/></inline-formula> and considered the values <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e361" xlink:type="simple"/></inline-formula> as the confidence level for the regulation. Then, TP rate (TPR = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e362" xlink:type="simple"/></inline-formula>), FP rate (FPR = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e363" xlink:type="simple"/></inline-formula>), precision rate (PR = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e364" xlink:type="simple"/></inline-formula>) and recall rate (RR = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e365" xlink:type="simple"/></inline-formula>) were calculated to draw ROC and PR curves. Using these curves, we measured the performance with respect to the AUROC (area under the ROC curve) and AUPR (area under the PR curve). These comparison results are illustrated in <xref ref-type="fig" rid="pone-0105942-g010">Fig. 10</xref>. Note that, similarly to the previous experiments, we selected the best threshold values with respect to AUROC for the methods (e), (f) and (h)–(j).</p>
<fig id="pone-0105942-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.g010</object-id><label>Figure 10</label><caption>
<title>The ROC and PR curves using dataset (iii).</title>
<p>The left and the right figures illustrate the ROC and PR curves for dataset (iii), respectively. In the left figure, the vertical axis and horizontal axis correspond to TP rate and FP rate, respectively. In the right figure, the vertical axis and horizontal axis correspond to PR and RR, respectively. AUROC and AUPR are represented at the right side of the inference methods.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g010" position="float" xlink:type="simple"/></fig>
<p>As a result, although the simulation model for dataset (iii) is different from the models that we assumed, the proposed method using SPE outperformed the other methods in terms of both AUROC and AUPR. The number of selected simulation time intervals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e366" xlink:type="simple"/></inline-formula> is shown in <xref ref-type="table" rid="pone-0105942-t004">Table 4</xref>. These results indicate that the proposed method has good ability for inferring the regulatory relationships using time-course observational data for which regulations are not based on the model that we assumed. Furthermore, we can consider the SPE as a good indicator for determining the simulation time interval.</p>
<table-wrap id="pone-0105942-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.t004</object-id><label>Table 4</label><caption>
<title>The number of selected simulation time intervals for dataset (iii).</title>
</caption><alternatives><graphic id="pone-0105942-t004-4" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.t004" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1">7</td>
<td align="left" rowspan="1" colspan="1">8</td>
<td align="left" rowspan="1" colspan="1">9</td>
<td align="left" rowspan="1" colspan="1">10</td>
<td align="left" rowspan="1" colspan="1">11</td>
<td align="left" rowspan="1" colspan="1">12</td>
<td align="left" rowspan="1" colspan="1">13</td>
<td align="left" rowspan="1" colspan="1">14</td>
<td align="left" rowspan="1" colspan="1">15</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e367" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">99</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e368" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">13</td>
<td align="left" rowspan="1" colspan="1">9</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">11</td>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1">12</td>
<td align="left" rowspan="1" colspan="1">19</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap></sec><sec id="s3d">
<title>Application to Corticosteroid Pathways in Rats</title>
<p>As an application example, we analyzed microarray time-course gene expression data from rat skeletal muscle <xref ref-type="bibr" rid="pone.0105942-Almon1">[37]</xref>, <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref>, which is assumed to have the same system used in simulation studies. The microarray data were downloaded from the GEO database (GSE490). The time-course gene expression was measured at 0, 0.25, 0.5, 0.75, 1, 2, 4, 5, 5.5, 7, 8, 12, 18, 30, 48, and 72 [h] (16 time points) after the glucocorticoid was applied. The data at time 0 represent controls (untreated). There were two, three, or four replicated observations for each time point.</p>
<p>Because corticosteroid pharmacokinetics/dynamics in skeletal muscle have been modeled based on differential equations <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref> as shown in <xref ref-type="supplementary-material" rid="pone.0105942.s005">Model S4</xref>, the time-dependent concentration of corticosteroid in rat skeletal muscle can be obtained as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e369" xlink:type="simple"/></inline-formula>. Furthermore, corticosteroid catabolic/anabolic processes in rat skeletal muscle have been partly established <xref ref-type="bibr" rid="pone.0105942-Shimizu1">[41]</xref>; thus, these regulatory relationships can also be used. Given this information, we included <italic>Mtor</italic>, <italic>Anxa3</italic>, <italic>Bnip3</italic>, <italic>Bcat2</italic>, <italic>Foxo1</italic>, <italic>Trim63</italic>, <italic>Akt1</italic>, <italic>Akt2</italic>, <italic>Akt3</italic>, <italic>Rheb</italic>, <italic>Igf1</italic>, <italic>Igf1r</italic>, <italic>Pik3c3</italic>, <italic>Pik3cd</italic>, <italic>Pik3cb</italic>, <italic>Pik3c2g</italic>, <italic>Slc2a4</italic>, and <italic>Mstn</italic>. Note that the microarray (GSE490) does not include three genes in the original pathway <xref ref-type="bibr" rid="pone.0105942-Shimizu1">[41]</xref>, <italic>Redd1</italic>, <italic>Bcaa</italic> and <italic>Klf15</italic>. In addition, we employed the genes, <italic>Irs1</italic>, <italic>Srebf1</italic>, <italic>Rxrg</italic>, <italic>Scarb1</italic>, <italic>Gpam</italic>, <italic>Scd</italic>, <italic>Gpd2</italic>, <italic>Mapk6</italic>, <italic>Ace</italic>, <italic>Ptpn1</italic>, <italic>Ptprf</italic>, <italic>Edn1</italic>, <italic>Agtr1a</italic>, <italic>Ppard</italic>, <italic>Hmgcs2</italic>, <italic>Serpine1</italic>, <italic>Cebpb</italic>, <italic>Cebpd</italic>, <italic>Il6r</italic>, <italic>Mapk14</italic>, <italic>Ucp3</italic>, and <italic>Pdk4</italic>, which have been suggested to be corticosteroid-induced genes <xref ref-type="bibr" rid="pone.0105942-Almon1">[37]</xref>. In summary, we applied the method to these 40 genes with weights for the established pathway and the concentration of corticosteroid.</p>
<p>First, to determine the simulation time interval from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e370" xlink:type="simple"/></inline-formula>, we evaluated the BIC scores and SPE (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e371" xlink:type="simple"/></inline-formula>). The results are shown in <xref ref-type="fig" rid="pone-0105942-g011">Fig. 11</xref>. Interestingly, even for the observational data, we obtained the same tendency for both indicators. Therefore, we obtained <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e372" xlink:type="simple"/></inline-formula> for the lowest SPE. Next, we analyzed the result of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e373" xlink:type="simple"/></inline-formula>. The inferred structure with some simulated expression profiles are illustrated in <xref ref-type="fig" rid="pone-0105942-g012">Fig. 12</xref>. From the figure, we can capture the propagation of gene expression stimulated by <italic>corticosteroid</italic> and hub genes regulating other genes. However, these results may be difficult to biologically interpret because some mRNAs are not considered to regulate other genes. Therefore, to exploit biological meaning correctly and demonstrate the effectiveness of incorporating prior information in the case of real biological data, we finally performed an experiment using TF information from ITFP (Integrated Transcription Factor Platform) <xref ref-type="bibr" rid="pone.0105942-Zheng1">[42]</xref>. Then, weights for regulations by TFs, <italic>Trim63</italic>, <italic>Akt1</italic>, <italic>Akt2</italic>, <italic>Mstn</italic>, <italic>Irs1</italic>, <italic>Srebf1</italic>, <italic>Gpam</italic>, <italic>Cebpb</italic>, and <italic>Cebpd</italic>, were set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e374" xlink:type="simple"/></inline-formula>. The inferred structure at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e375" xlink:type="simple"/></inline-formula> using the TF information is illustrated in <xref ref-type="fig" rid="pone-0105942-g013">Fig. 13</xref>.</p>
<fig id="pone-0105942-g011" position="float"><label>Figure 11</label><caption>
<title>The result of the BIC scores and SPE for each simulation time interval using the real data.</title>
<p>This illustrates the BIC scores and SPE <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e376" xlink:type="simple"/></inline-formula> for each time interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e377" xlink:type="simple"/></inline-formula>. The values of these indicators corresponds to the left and right axes, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g011" position="float" xlink:type="simple"/></fig><fig id="pone-0105942-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.g012</object-id><label>Figure 12</label><caption>
<title>The estimated network with weighting literature-recorded pathways.</title>
<p>This figure illustrates the inferred gene regulatory network with weights for literature-recorded pathways. <italic>Corticosteroid</italic> and genes of TFs are drawn as a red circle and green circles, respectively. Estimated edges with weights are illustrated as orange. Further, on some genes, simulation expression profiles are attached as examples. Red and blue profiles are roughly distinguished to up-regulated and down-regulated genes, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g012" position="float" xlink:type="simple"/></fig><fig id="pone-0105942-g013" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.g013</object-id><label>Figure 13</label><caption>
<title>The estimated network with weighting literature-recorded pathways and regulations by TFs.</title>
<p>This figure illustrates the inferred gene regulatory network with weights for literature-recorded pathways and regulations by TFs. <italic>Corticosteroid</italic> and genes of TFs are drawn as a red circle and green circles, respectively. Estimated edges with weights for literature derived regulations are illustrated as orange. Red and blue simulation profiles are roughly distinguished to up-regulated and down-regulated genes, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.g013" position="float" xlink:type="simple"/></fig>
<p>In <xref ref-type="fig" rid="pone-0105942-g012">Figs. 12</xref> and <xref ref-type="fig" rid="pone-0105942-g013">13</xref>, there are some interesting observations. At first, some genes are directly regulated by corticosteroids, which are included in the model as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e378" xlink:type="simple"/></inline-formula>. Thus, other models that do not include the drug terms cannot estimate such regulation. Second, only weighted regulations, <italic>i.e.</italic>, literature-recorded pathways and regulation by TFs, were inferred in contrast to the non-weighted network in <xref ref-type="fig" rid="pone-0105942-g012">Fig. 12</xref>. Thus, we could successfully incorporate prior knowledge, and further candidates may extend our understanding of regulation not yet reported in literature. Additionally, some weighted genes, <italic>Cebpb</italic>, <italic>Mstn</italic>, <italic>Cebpd</italic>, and <italic>Trim63</italic>, were also selected as hub genes with no weight in <xref ref-type="fig" rid="pone-0105942-g012">Fig. 12</xref>. Third, <italic>Cebpb</italic>, which is known as a transcription factor related to immune and inflammatory responses, is indicated as a hub gene (illustrated as a green circle). <italic>Cebpd</italic> and <italic>Cebpb</italic> are assumed to be candidate genes for insulin-related transcription factors <xref ref-type="bibr" rid="pone.0105942-Foti1">[64]</xref>. This finding may confirm the findings of previous studies <xref ref-type="bibr" rid="pone.0105942-Almon1">[37]</xref>, <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref> indicating that corticosteroid stimulation of skeletal muscle can induce the expression of insulin.</p>
<p>Finally, we applied the other methods, <italic>i.e.</italic>, GeneNet and G1DBN, to the pharmacogenomic data and attached significance levels (<italic>q</italic>-val and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0105942.e379" xlink:type="simple"/></inline-formula> for GeneNet and G1DBN, respectively) for the regulations inferred by the proposed method. The results are presented in <xref ref-type="table" rid="pone-0105942-t005">Table 5</xref>. Interestingly, some regulations have very high significance levels but others do not. For example, regulations of <italic>Srebf1</italic>, <italic>Agtr1a</italic>, <italic>Cebpb</italic> and <italic>Cepbd</italic> by a <italic>corticosteroid</italic> are quite probable. In contrast, some regulations were not significant when using these methods. We can suppose, for example, that differences between the models, the prior weights for TF candidates and literature derived pathways, steady state gene expression profiles and corticosteroid drug dynamics in the proposed model may have caused the results. Although some inferred regulations had low significance levels in other approaches, we believe that these regulations can be candidates for true regulation in corticosteroid pharmacogenomic pathways because the proposed method outperformed the other methods through the comparison using synthetic pharmacogenomic pathways.</p>
<table-wrap id="pone-0105942-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0105942.t005</object-id><label>Table 5</label><caption>
<title>The confidence levels of estimated pharmacogenomic regulations using GeneNet and G1DBN.</title>
</caption><alternatives><graphic id="pone-0105942-t005-5" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0105942.t005" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Regulator</td>
<td align="left" rowspan="1" colspan="1">Target</td>
<td align="left" rowspan="1" colspan="1"><italic>q</italic>–val</td>
<td align="left" rowspan="1" colspan="1">post–prob.</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Srebf1</td>
<td align="left" rowspan="1" colspan="1">0.101</td>
<td align="left" rowspan="1" colspan="1">0.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Agtr1a</td>
<td align="left" rowspan="1" colspan="1">0.864</td>
<td align="left" rowspan="1" colspan="1">0.002</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Cebpd</td>
<td align="left" rowspan="1" colspan="1">0.021</td>
<td align="left" rowspan="1" colspan="1">0.003</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Cebpb</td>
<td align="left" rowspan="1" colspan="1">0.747</td>
<td align="left" rowspan="1" colspan="1">0.003</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Trim63</td>
<td align="left" rowspan="1" colspan="1">Serpine1</td>
<td align="left" rowspan="1" colspan="1">0.375</td>
<td align="left" rowspan="1" colspan="1">0.005</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Mstn</td>
<td align="left" rowspan="1" colspan="1">0.198</td>
<td align="left" rowspan="1" colspan="1">0.012</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Trim63</td>
<td align="left" rowspan="1" colspan="1">Irs1</td>
<td align="left" rowspan="1" colspan="1">0.385</td>
<td align="left" rowspan="1" colspan="1">0.065</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Scd</td>
<td align="left" rowspan="1" colspan="1">0.905</td>
<td align="left" rowspan="1" colspan="1">0.068</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Akt2</td>
<td align="left" rowspan="1" colspan="1">Mtor</td>
<td align="left" rowspan="1" colspan="1">0.881</td>
<td align="left" rowspan="1" colspan="1">0.069</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Cebpb</td>
<td align="left" rowspan="1" colspan="1">Il6r</td>
<td align="left" rowspan="1" colspan="1">0.836</td>
<td align="left" rowspan="1" colspan="1">0.102</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Trim63</td>
<td align="left" rowspan="1" colspan="1">Ppard</td>
<td align="left" rowspan="1" colspan="1">0.395</td>
<td align="left" rowspan="1" colspan="1">0.105</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Trim63</td>
<td align="left" rowspan="1" colspan="1">Slc2a4</td>
<td align="left" rowspan="1" colspan="1">0.915</td>
<td align="left" rowspan="1" colspan="1">0.189</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Ucp3</td>
<td align="left" rowspan="1" colspan="1">0.663</td>
<td align="left" rowspan="1" colspan="1">0.195</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Trim63</td>
<td align="left" rowspan="1" colspan="1">Bnip3</td>
<td align="left" rowspan="1" colspan="1">0.629</td>
<td align="left" rowspan="1" colspan="1">0.217</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Trim63</td>
<td align="left" rowspan="1" colspan="1">Mstn</td>
<td align="left" rowspan="1" colspan="1">0.935</td>
<td align="left" rowspan="1" colspan="1">0.273</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mstn</td>
<td align="left" rowspan="1" colspan="1">Cebpd</td>
<td align="left" rowspan="1" colspan="1">0.413</td>
<td align="left" rowspan="1" colspan="1">0.280</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Irs1</td>
<td align="left" rowspan="1" colspan="1">Ptprf</td>
<td align="left" rowspan="1" colspan="1">0.928</td>
<td align="left" rowspan="1" colspan="1">0.452</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Igf1</td>
<td align="left" rowspan="1" colspan="1">Pik3cd</td>
<td align="left" rowspan="1" colspan="1">0.897</td>
<td align="left" rowspan="1" colspan="1">0.457</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Trim63</td>
<td align="left" rowspan="1" colspan="1">Mapk14</td>
<td align="left" rowspan="1" colspan="1">0.909</td>
<td align="left" rowspan="1" colspan="1">0.503</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Irs1</td>
<td align="left" rowspan="1" colspan="1">Anxa3</td>
<td align="left" rowspan="1" colspan="1">0.107</td>
<td align="left" rowspan="1" colspan="1">0.632</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Irs1</td>
<td align="left" rowspan="1" colspan="1">Gpd2</td>
<td align="left" rowspan="1" colspan="1">0.853</td>
<td align="left" rowspan="1" colspan="1">0.749</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Edn1</td>
<td align="left" rowspan="1" colspan="1">0.833</td>
<td align="left" rowspan="1" colspan="1">0.799</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Pik3c2g</td>
<td align="left" rowspan="1" colspan="1">0.929</td>
<td align="left" rowspan="1" colspan="1">0.821</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Cebpb</td>
<td align="left" rowspan="1" colspan="1">Trim63</td>
<td align="left" rowspan="1" colspan="1">0.864</td>
<td align="left" rowspan="1" colspan="1">0.991</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Irs1</td>
<td align="left" rowspan="1" colspan="1">Akt3</td>
<td align="left" rowspan="1" colspan="1">0.396</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Srebf1</td>
<td align="left" rowspan="1" colspan="1">Mapk6</td>
<td align="left" rowspan="1" colspan="1">0.453</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Scarb1</td>
<td align="left" rowspan="1" colspan="1">0.651</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Cebpb</td>
<td align="left" rowspan="1" colspan="1">Rxrg</td>
<td align="left" rowspan="1" colspan="1">0.734</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Ptpn1</td>
<td align="left" rowspan="1" colspan="1">0.827</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Srebf1</td>
<td align="left" rowspan="1" colspan="1">Irs1</td>
<td align="left" rowspan="1" colspan="1">0.832</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Akt2</td>
<td align="left" rowspan="1" colspan="1">Cebpb</td>
<td align="left" rowspan="1" colspan="1">0.863</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Pdk4</td>
<td align="left" rowspan="1" colspan="1">0.871</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Cebpd</td>
<td align="left" rowspan="1" colspan="1">Pik3c2g</td>
<td align="left" rowspan="1" colspan="1">0.888</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Irs1</td>
<td align="left" rowspan="1" colspan="1">Foxo1</td>
<td align="left" rowspan="1" colspan="1">0.894</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Cebpb</td>
<td align="left" rowspan="1" colspan="1">Hmgcs2</td>
<td align="left" rowspan="1" colspan="1">0.897</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Corticosteroid</td>
<td align="left" rowspan="1" colspan="1">Igf1</td>
<td align="left" rowspan="1" colspan="1">0.908</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Trim63</td>
<td align="left" rowspan="1" colspan="1">Akt3</td>
<td align="left" rowspan="1" colspan="1">0.913</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Cebpd</td>
<td align="left" rowspan="1" colspan="1">Igf1</td>
<td align="left" rowspan="1" colspan="1">0.924</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Irs1</td>
<td align="left" rowspan="1" colspan="1">Bnip3</td>
<td align="left" rowspan="1" colspan="1">0.925</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Cebpd</td>
<td align="left" rowspan="1" colspan="1">Rheb</td>
<td align="left" rowspan="1" colspan="1">0.935</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Trim63</td>
<td align="left" rowspan="1" colspan="1">Ace</td>
<td align="left" rowspan="1" colspan="1">0.936</td>
<td align="left" rowspan="1" colspan="1">1.000</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>Although we actually used 40 genes, only 35 genes were found to be regulated because the expression of residual genes did not vary through the time-course. Hence the expression of these genes can represent only synthesis and degradation processes, for which regulation was not estimated.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>In this study, we proposed a novel method for inference of gene regulatory networks incorporating existing biological knowledge and time-course observation data. The properties of the method are as follows; (i) the dynamics of the gene expression profiles can be estimated based on the proposed linear model with a hidden state, (ii) <italic>L</italic>1 regularized log-likelihood is maximized to infer the active sets of regulation, (iii) the dynamics of other biomolecules can be included in the model, (iv) existing biological knowledge, <italic>e.g.</italic>, literature-recorded pathways and TF information, can be integrated. Furthermore, we proposed an indicator for selecting a simulation time interval for the inference.</p>
<p>To show the effectiveness of the proposed method, we compared it to the previously reported GRNs inference methods using hill function-based pharmacogenomic pathways <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref> and a yeast network that is a part of the DREAM4 challenge <xref ref-type="bibr" rid="pone.0105942-Marbach1">[39]</xref>, <xref ref-type="bibr" rid="pone.0105942-Schaffter1">[40]</xref>. Since the artificial simulation models were described by differential equations or difference equations, in which the time intervals were smaller than the measurement interval, to reproduce a realistic biological system, the simulated expressions was updated in detail. In this situation, we assumed that the simulation time interval for the method is crucial for inference. As we expected, the results demonstrated that inference of the regulatory structure depends greatly on the simulation time interval. This indicates that we should carefully design the simulation time interval even for analysis of real observational data. For this purpose, we introduced indicators to determine the simulation time interval and measured their validity. Here, since the tendency of the indicator for the simulation time interval depends on the analyzed biological system, it is recommended to check the tendency by using simulation models. Upon comparison of the inferred structures, the proposed method using the indicator showed the highest performance in terms of precision and recall rates for all three data types. The fact that the proposed method outperformed the other methods in using synthetic datasets, which includes the model we do not assume, indicates the adaptability of our proposed method.</p>
<p>For an application example, we applied the proposed method to a corticosteroid-stimulated pathway in rat skeletal muscle. Because pathways and genes related to corticosteroids have been widely investigated, we were able to obtain the concentration of the drug as a function of time from the corticosteroid kinetics/dynamics and the literature-recorded pathways. By incorporating time-course mRNA expression data, corticosteroid kinetics/dynamics, literature-recorded pathways and TF information, we inferred the regulatory relationships among 40 genes that are candidate or known corticosteroid-related genes. The tendency of the BIC scores and the SPE for the simulated time intervals were the same as in the simulation studies, in which the regulatory systems were based on the previous corticosteroid pharmacogenomic studies, and interesting findings for corticosteroid regulation were obtained. For example, genes that are suggested to be significant factors in corticosteroid pharmacogenomics were predicted to be hub genes regulating other genes in the results both with and without prior information. Furthermore, we found that the properties of the proposed method, <italic>i.e.</italic>, the weighted regularization and inclusion of a term for other biomolecules, influenced the results of selecting potential regulators and introducing drug effects to genes, respectively. Finally, these inferred regulations were evaluated by GeneNet and G1DBN, and some of the regulations had high significance. Since our approach imposed prior weights for reliable regulations and included drug terms to explicitly represent their dynamics, not only these regulations but also regulations that are evaluated as non-significant could be candidate regulations for corticosteroid pharmacogenomics. These results indicate that the proposed method can help to elucidate candidates that will allow extension of GRNs in which the regulation among genes is partly understood by incorporating multi-source biological knowledge.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pone.0105942.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0105942.s001" position="float" xlink:type="simple"><label>Method S1</label><caption>
<p><bold>A solution for estimating parameter values and active sets.</bold> The detailed solution of estimating parameter values using the EM-algorithm for VAR-SSM with <italic>L</italic>1 regularization.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pone.0105942.s002" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pone.0105942.s002" position="float" xlink:type="simple"><label>Model S1</label><caption>
<p><bold>Artificial data and parameter values for dataset (i).</bold> The artificial observational data and parameter values for dataset (i).</p>
<p>(ZIP)</p>
</caption></supplementary-material><supplementary-material id="pone.0105942.s003" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pone.0105942.s003" position="float" xlink:type="simple"><label>Model S2</label><caption>
<p><bold>Artificial data and simulation files for dataset (ii).</bold> The artificial observational data and a csml file for dataset (ii).</p>
<p>(ZIP)</p>
</caption></supplementary-material><supplementary-material id="pone.0105942.s004" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pone.0105942.s004" position="float" xlink:type="simple"><label>Model S3</label><caption>
<p><bold>Artificial data for dataset (iii).</bold> The artificial observational data (100 time-courses) for dataset (iii).</p>
<p>(ZIP)</p>
</caption></supplementary-material><supplementary-material id="pone.0105942.s005" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pone.0105942.s005" position="float" xlink:type="simple"><label>Model S4</label><caption>
<p><bold>Corticosteroid pharmacokinetics/dynamics in rat muscle.</bold> A corticosteroid pharmacokinetics/dynamics described in differentia equations in rat muscle <xref ref-type="bibr" rid="pone.0105942-Yao1">[38]</xref>.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>The super-computing resource was provided by Human Genome Center, the Institute of Medical Science, the University of Tokyo (<ext-link ext-link-type="uri" xlink:href="http://sc.hgc.jp/shirokane.html" xlink:type="simple">http://sc.hgc.jp/shirokane.html</ext-link>).</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0105942-Friedman1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Linial</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Nachman</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Pe'er</surname><given-names>D</given-names></name> (<year>2000</year>) <article-title>Using Bayesian networks to analyze expression data</article-title>. <source>Journal of Computational Biology</source> <volume>7</volume>: <fpage>601</fpage>–<lpage>620</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Imoto1"><label>2</label>
<mixed-citation publication-type="other" xlink:type="simple">Imoto S, Goto T, Miyano S (2002) Estimation of genetic networks and functional structures between genes by using bayesian networks and nonparametric regression. In: Pacific Symposium on Biocomputing. pp.175–186.</mixed-citation>
</ref>
<ref id="pone.0105942-Margolin1"><label>3</label>
<mixed-citation publication-type="other" xlink:type="simple">Margolin A, Nemenman I, Basso K, Wiggins C, Stolovitzky G, <etal>et al</etal>.. (2006) ARACNE: An Algorithm for the Reconstruction of Gene Regulatory Networks in a Mammalian Cellular Context. BMC Bioinformatics <volume>7</volume> : S7+.</mixed-citation>
</ref>
<ref id="pone.0105942-Savageau1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Savageau</surname><given-names>MA</given-names></name> (<year>1969</year>) <article-title>Biochemical systems analysis: II. The steady-state solutions for an n-pool system using a power-law approximation</article-title>. <source>Journal of Theoretical Biology</source> <volume>25</volume>: <fpage>370</fpage>–<lpage>379</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Savageau2"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Savageau</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Voit</surname><given-names>EO</given-names></name> (<year>1987</year>) <article-title>Recasting nonlinear differential equations as s-systems: a canonical nonlinear form</article-title>. <source>Mathematical Biosciences</source> <volume>87</volume>: <fpage>83</fpage>–<lpage>115</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Lawrence1"><label>6</label>
<mixed-citation publication-type="other" xlink:type="simple">Lawrence ND, Sanguinetti G, Rattray M (2006) Modelling transcriptional regulation using gaussian processes. In: NIPS. MIT Press, pp.785–792.</mixed-citation>
</ref>
<ref id="pone.0105942-Rogers1"><label>7</label>
<mixed-citation publication-type="other" xlink:type="simple">Rogers S, Khanin R, Girolami M (2007) Bayesian model-based inference of transcription factor activity. BMC Bioinformatics 8.</mixed-citation>
</ref>
<ref id="pone.0105942-Opper1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Opper</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sanguinetti</surname><given-names>G</given-names></name> (<year>2010</year>) <article-title>Learning combinatorial transcriptional dynamics from gene expression data</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>1623</fpage>–<lpage>1629</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Henderson1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henderson</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Michailidis</surname><given-names>G</given-names></name> (<year>2014</year>) <article-title>Network reconstruction using nonparametric additive ode models</article-title>. <source>PLoS ONE</source> <volume>9</volume>: <fpage>e94003</fpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Nakamura1"><label>10</label>
<mixed-citation publication-type="other" xlink:type="simple">Nakamura K, Yoshida R, Nagasaki M, Miyano S, Higuchi T (2009) Parameter estimation of <italic>in silico</italic> biological pathways with particle filtering toward a petascale computing. In: Pacific Symposium on Biocomputing 2009. volume 14, pp.227–238.</mixed-citation>
</ref>
<ref id="pone.0105942-Nagasaki1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nagasaki</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Yamaguchi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Yoshida</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Imoto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Doi</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Genomic data assimilation for estimating hybrid functional petri net from time-course gene expression data</article-title>. <source>Genome Informatics</source> <volume>17(1)</volume>: <fpage>46</fpage>–<lpage>61</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Ramsay1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ramsay</surname><given-names>JO</given-names></name>, <name name-style="western"><surname>Hooker</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Campbell</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Cao</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Parameter estimation for differential equations: a generalized smoothing approach</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source> <volume>69</volume>: <fpage>741</fpage>–<lpage>796</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Quach1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quach</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>d'Alche Buc</surname><given-names>F</given-names></name> (<year>2007</year>) <article-title>Estimating parameters and hidden variables in non-linear state-space models based on odes for biological networks inference</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>3209</fpage>–<lpage>3216</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Hasegawa1"><label>14</label>
<mixed-citation publication-type="other" xlink:type="simple">Hasegawa T, Yamaguchi R, Nagasaki M, Imoto S, Miyano S (2011) Comprehensive pharmacogenomic pathway screening by data assimilation. In: Proceedings of the 7th international conference on Bioinformatics research and applications. Berlin, Heidelberg: Springer-Verlag, ISBRA'11, pp.160–171.</mixed-citation>
</ref>
<ref id="pone.0105942-Bard1"><label>15</label>
<mixed-citation publication-type="other" xlink:type="simple">Bard Y (1974) Nonlinear parameter estimation. New York: Academic Press.</mixed-citation>
</ref>
<ref id="pone.0105942-Friedman2"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name> (<year>2007</year>) <article-title>Sparse inverse covariance estimation with the graphical lasso</article-title>. <source>Biostatistics</source> <volume>9</volume>: <fpage>432</fpage>–<lpage>441</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Kim1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Imoto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Miyano</surname><given-names>S</given-names></name> (<year>2004</year>) <article-title>Dynamic bayesian network and nonparametric regression for nonlinear modeling of gene networks from time series gene expression data</article-title>. <source>Biosystems</source> <volume>75(1–3)</volume>: <fpage>57</fpage>–<lpage>65</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Zacher1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zacher</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Abnaof</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Gade</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Younesi</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Tresch</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Joint Bayesian inference of condition-specific miRNA and transcription factor activities from combined gene and microRNA expression data</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>1714</fpage>–<lpage>1720</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Barenco1"><label>19</label>
<mixed-citation publication-type="other" xlink:type="simple">Barenco M, Tomescu D, Brewer D, Callard R, Stark J, <etal>et al</etal>.. (2006) Ranked prediction of p53 targets using hidden variable dynamic modeling. Genome Biology <volume>7</volume> : R25+.</mixed-citation>
</ref>
<ref id="pone.0105942-Beal1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beal</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Falciani</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Ghahramani</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Rangel</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Wild</surname><given-names>DL</given-names></name> (<year>2005</year>) <article-title>A bayesian approach to reconstructing genetic regulatory networks with hidden factors</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>349</fpage>–<lpage>356</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Hirose1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hirose</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Yoshida</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Imoto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yamaguchi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Higuchi</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Statistical inference of transcriptional module-based gene networks from time course gene expression profiles by using state space models</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>932</fpage>–<lpage>942</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Rangel1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rangel</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Angus</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ghahramani</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Lioumi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sotheran</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Modeling t-cell activation using gene expression profiling and state-space models</article-title>. <source>Bioinformatics</source> <volume>20</volume>: <fpage>1361</fpage>–<lpage>1372</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Sabatti1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sabatti</surname><given-names>C</given-names></name>, <name name-style="western"><surname>James</surname><given-names>GM</given-names></name> (<year>2006</year>) <article-title>Bayesian sparse hidden components analysis for transcription regulation networks</article-title>. <source>Bioinformatics</source> <volume>22</volume>: <fpage>739</fpage>–<lpage>746</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Asif1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Asif</surname><given-names>HMS</given-names></name>, <name name-style="western"><surname>Sanguinetti</surname><given-names>G</given-names></name> (<year>2011</year>) <article-title>Large-scale learning of combinatorial transcriptional dynamics from gene expression</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>1277</fpage>–<lpage>1283</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Eduati1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eduati</surname><given-names>F</given-names></name>, <name name-style="western"><surname>De Las Rivas</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Di Camillo</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Toffolo</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Saez-Rodriguez</surname><given-names>J</given-names></name> (<year>2012</year>) <article-title>Integrating literatureconstrained and data-driven inference of signalling networks</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>2311</fpage>–<lpage>2317</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-doRego1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>do Rego</surname><given-names>TG</given-names></name>, <name name-style="western"><surname>Roider</surname><given-names>HG</given-names></name>, <name name-style="western"><surname>de Carvalho</surname><given-names>FAT</given-names></name>, <name name-style="western"><surname>Costa</surname><given-names>IG</given-names></name> (<year>2012</year>) <article-title>Inferring epigenetic and transcriptional regulation during blood cell development with a mixture of sparse linear models</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>2297</fpage>–<lpage>2303</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Greenfield1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greenfield</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hafemeister</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Bonneau</surname><given-names>R</given-names></name> (<year>2013</year>) <article-title>Robust data-driven incorporation of prior knowledge into the inference of dynamic regulatory networks</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>1060</fpage>–<lpage>1067</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Dong1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dong</surname><given-names>CY</given-names></name>, <name name-style="western"><surname>Shin</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Joo</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Nam</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Cho</surname><given-names>KH</given-names></name> (<year>2012</year>) <article-title>Identification of feedback loops in neural networks based on multi-step granger causality</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>2146</fpage>–<lpage>2153</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Kojima1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kojima</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Yamaguchi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Imoto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yamauchi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Nagasaki</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>A state space representation of var models with sparse learning for dynamic gene networks</article-title>. <source>Genome informatics International Conference on Genome Informatics</source> <volume>22</volume>: <fpage>56</fpage>–<lpage>68</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Efron1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Efron</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Johnstone</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name> (<year>2004</year>) <article-title>Least angle regression</article-title>. <source>Annals of Statistics</source> <volume>32</volume>: <fpage>407</fpage>–<lpage>499</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Schfer1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schäfer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Strimmer</surname><given-names>K</given-names></name> (<year>2005</year>) <article-title>An empirical bayes approach to inferring large-scale gene association networks</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>754</fpage>–<lpage>764</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-OpgenRhein1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Opgen-Rhein</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Strimmer</surname><given-names>K</given-names></name> (<year>2007</year>) <article-title>From correlation to causation networks: a simple approximate learning algorithm and its application to high-dimensional plant gene expression data</article-title>. <source>BMC Systems Biology</source> <volume>1</volume>: <fpage>37</fpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Lbre1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lébre</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>Inferring dynamic genetic networks with low order independencies</article-title>. <source>Statistical Applications in Genetics and Molecular Biology</source> <volume>8</volume>: <fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Friedman3"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>Sparse inverse covariance estimation with the graphical lasso</article-title>. <source>Biostatistics</source> <volume>9</volume>: <fpage>432</fpage>–<lpage>441</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Faith1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Faith</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Hayete</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Thaden</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Mogno</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Wierzbowski</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Large-scale mapping and validation of <italic>escherichia coli</italic> transcriptional regulation from a compendium of expression profiles</article-title>. <source>PLoS Biol</source> <volume>5</volume>: <fpage>e8</fpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Meyer1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Kontos</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Lafitte</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Bontempi</surname><given-names>G</given-names></name> (<year>2007</year>) <article-title>Information-theoretic inference of large transcriptional regulatory networks</article-title>. <source>EURASIP Journal on Bioinformatics and Systems Biology</source> <volume>2007</volume>: <fpage>79879</fpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Almon1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Almon</surname><given-names>RR</given-names></name>, <name name-style="western"><surname>DuBois</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Jin</surname><given-names>JY</given-names></name>, <name name-style="western"><surname>Jusko</surname><given-names>WJ</given-names></name> (<year>2005</year>) <article-title>Temporal profiling of the transcriptional basis for the development of corticosteroid-induced insulin resistance in rat muscle</article-title>. <source>Journal of Endocrinology</source> <volume>184</volume>: <fpage>219</fpage>–<lpage>232</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Yao1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yao</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Hoffman</surname><given-names>EP</given-names></name>, <name name-style="western"><surname>Ghimbovschi</surname><given-names>S</given-names></name>, <name name-style="western"><surname>DuBois</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Almon</surname><given-names>RR</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Mathematical modeling of corticosteroid pharmacogenomics in rat muscle following acute and chronic methylprednisolone dosing</article-title>. <source>Molecular Pharmaceutics</source> <volume>5</volume>: <fpage>328</fpage>–<lpage>339</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Marbach1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marbach</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Schaffter</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Mattiussi</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Floreano</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>Generating Realistic In Silico Gene Networks for Performance Assessment of Reverse Engineering Methods</article-title>. <source>Journal of Computational Biology</source> <volume>16</volume>: <fpage>229</fpage>–<lpage>239</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Schaffter1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schaffter</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Marbach</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Floreano</surname><given-names>D</given-names></name> (<year>2011</year>) <article-title>Genenetweaver: in silico benchmark generation and performance profiling of network inference methods</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>2263</fpage>–<lpage>2270</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Shimizu1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shimizu</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Yoshikawa</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Ito</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Maruyama</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Suzuki</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Crosstalk between Glucocorticoid Receptor and Nutritional Sensor mTOR in Skeletal Muscle</article-title>. <source>Cell metabolism</source> <volume>13</volume>: <fpage>170</fpage>–<lpage>182</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Zheng1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zheng</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Tu</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Xiong</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Wei</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Itfp: an integrated platform of mammalian transcription factors</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>2416</fpage>–<lpage>2417</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Elowitz1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name>, <name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name> (<year>2000</year>) <article-title>A synthetic oscillatory network of transcriptional regulators</article-title>. <source>Nature</source> <volume>403</volume>: <fpage>335</fpage>–<lpage>338</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-deJong1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>de Jong</surname><given-names>H</given-names></name> (<year>2002</year>) <article-title>Modeling and simulation of genetic regulatory systems: A literature review</article-title>. <source>Journal of Computational Biology</source> <volume>9</volume>: <fpage>67</fpage>–<lpage>103</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Hazra1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hazra</surname><given-names>A</given-names></name>, <name name-style="western"><surname>DuBois</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Almon</surname><given-names>RR</given-names></name>, <name name-style="western"><surname>Snyder</surname><given-names>GH</given-names></name>, <name name-style="western"><surname>Jusko</surname><given-names>WJ</given-names></name> (<year>2008</year>) <article-title>Pharmacodynamic modeling of acute and chronic effects of methylprednisolone on hepatic urea cycle genes in rats</article-title>. <source>Gene Regulation and Systems Biology</source> <volume>2</volume>: <fpage>1</fpage>–<lpage>19</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Jin1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jin</surname><given-names>JY</given-names></name>, <name name-style="western"><surname>Almon</surname><given-names>RR</given-names></name>, <name name-style="western"><surname>DuBois</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Jusko</surname><given-names>WJ</given-names></name> (<year>2003</year>) <article-title>Modeling of corticosteroid pharmacogenomics in rat liver using gene microarrays</article-title>. <source>Journal of Pharmacology and Experimental Therapeutics</source> <volume>307</volume>: <fpage>93</fpage>–<lpage>109</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Chen1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname><given-names>KC</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>TY</given-names></name>, <name name-style="western"><surname>Tseng</surname><given-names>HH</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>CYF</given-names></name>, <name name-style="western"><surname>Kao</surname><given-names>CY</given-names></name> (<year>2005</year>) <article-title>A stochastic differential equation model for quantifying transcriptional regulatory network in saccharomyces cerevisiae</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>2883</fpage>–<lpage>2890</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Lillacci1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lillacci</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Khammash</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Parameter estimation and model selection in computational biology</article-title>. <source>PLoS Comput Biol</source> <volume>6</volume>: <fpage>e1000696</fpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Sun1"><label>49</label>
<mixed-citation publication-type="other" xlink:type="simple">Sun X, Jin L, Xiong M (2008) Extended Kalman Filter for Estimation of Parameters in Nonlinear State-Space Models of Biochemical Networks. PLoS ONE <volume>3</volume> : e3758+.</mixed-citation>
</ref>
<ref id="pone.0105942-Kalman1"><label>50</label>
<mixed-citation publication-type="other" xlink:type="simple">Kalman RE (1960) A New Approach to Linear Filtering and Prediction Problems. Transactions of the ASME - Journal of Basic Engineering: 35–45.</mixed-citation>
</ref>
<ref id="pone.0105942-Shumway1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shumway</surname><given-names>RH</given-names></name>, <name name-style="western"><surname>Stoffer</surname><given-names>DS</given-names></name> (<year>1982</year>) <article-title>An approach to time series smoothing and forecasting using the em algorithm</article-title>. <source>Journal of Time Series Analysis</source> <volume>3</volume>: <fpage>253</fpage>–<lpage>264</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Maybeck1"><label>52</label>
<mixed-citation publication-type="other" xlink:type="simple">Maybeck PS (1979) Stochastic models, estimation and control. Volume I. Academic Press.</mixed-citation>
</ref>
<ref id="pone.0105942-Julier1"><label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">Julier SJ, Uhlmann JK (1997) A new extension of the kalman filter to nonlinear systems. In: Proc. of AeroSense: The 11th Int. Symp. on Aerospace/Defense Sensing, Simulations and Controls. pp.182–193.</mixed-citation>
</ref>
<ref id="pone.0105942-Julier2"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Julier</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Uhlmann</surname><given-names>J</given-names></name> (<year>2004</year>) <article-title>Unscented filtering and nonlinear estimation</article-title>. <source>Proceedings of the IEEE</source> <volume>92</volume>: <fpage>401</fpage>–<lpage>422</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Kitagawa1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kitagawa</surname><given-names>G</given-names></name> (<year>1996</year>) <article-title>Monte Carlo Filter and Smoother for Non-Gaussian Nonlinear State Space Models</article-title>. <source>Journal of Computational and Graphical Statistics</source> <volume>5</volume>: <fpage>1</fpage>–<lpage>25</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Liu1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Niranjan</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>State and parameter estimation of the heat shock response system using kalman and particle filters</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>1501</fpage>–<lpage>1507</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Shimamura1"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shimamura</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Imoto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yamaguchi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Nagasaki</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Miyano</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Inferring dynamic gene networks under varying conditions for transcriptomic network comparison</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>1064</fpage>–<lpage>1072</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Dempster1"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dempster</surname><given-names>AP</given-names></name>, <name name-style="western"><surname>Laird</surname><given-names>NM</given-names></name>, <name name-style="western"><surname>Rubin</surname><given-names>DB</given-names></name> (<year>1977</year>) <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>Journal of the Royal Statistical Society: Series B</source> <volume>39</volume>: <fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Schwarz1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwarz</surname><given-names>G</given-names></name> (<year>1978</year>) <article-title>Estimating the dimension of a model</article-title>. <source>The Annals of Statistics</source> <volume>6</volume>: <fpage>461</fpage>–<lpage>464</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Yamaguchi1"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yamaguchi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Higuchi</surname><given-names>T</given-names></name> (<year>2006</year>) <article-title>State space approach with the maximum likelihood principle to identify the system generating time-course gene expression data of yeast</article-title>. <source>Int J Data Min Bioinformatics</source> <volume>1</volume>: <fpage>77</fpage>–<lpage>87</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Zou1"><label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zou</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name> (<year>2007</year>) <article-title>On the “degrees of freedom” of the lasso</article-title>. <source>The Annals of Statistics</source> <volume>35</volume>: <fpage>2173</fpage>–<lpage>2192</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Shimamura2"><label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shimamura</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Imoto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yamaguchi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Fujita</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Nagasaki</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Recursive regularization for inferring gene networks from time-course gene expression profiles</article-title>. <source>BMC systems biology</source> <volume>3</volume>: <fpage>41</fpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Tamada1"><label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tamada</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Yamaguchi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Imoto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Hirose</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Yoshida</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Sign-ssm: open source parallel software for estimating gene networks with state space models</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>1172</fpage>–<lpage>1173</lpage>.</mixed-citation>
</ref>
<ref id="pone.0105942-Foti1"><label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Foti</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Iuliano</surname><given-names>R</given-names></name> (<year>2003</year>) <collab xlink:type="simple">Chiefari E, Brunetti A</collab> (<year>2003</year>) <article-title>A nucleoprotein complex containing sp1, c/ebpb, and hmgi-y controls human insulin receptor gene transcription</article-title>. <source>Molecular and Cellular Biology</source> <volume>23</volume>: <fpage>2720</fpage>–<lpage>2732</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>