<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00276</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005072</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Stem cells</subject><subj-group><subject>Hematopoietic stem cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject><subj-group><subject>Gene regulation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject><subj-group><subject>DNA transcription</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Developmental biology</subject><subj-group><subject>Cell differentiation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>Messenger RNA</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Hematology</subject><subj-group><subject>Hematopoiesis</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Determining Physical Mechanisms of Gene Expression Regulation from Single Cell Gene Expression Data</article-title>
<alt-title alt-title-type="running-head">Bursting Dynamics Analysis of Single Cell Gene Expression Data</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1685-6909</contrib-id>
<name name-style="western">
<surname>Ezer</surname> <given-names>Daphne</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Moignard</surname> <given-names>Victoria</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Göttgens</surname> <given-names>Berthold</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Adryan</surname> <given-names>Boris</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Genetics, Systems Biology Centre, University of Cambridge, Cambridge, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Sainsbury Laboratory, University of Cambridge, Cambridge, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Haematology, Wellcome Trust and MRC Cambridge Stem Cell Institute and Cambridge Institute for Medical Research, University of Cambridge, Cambridge, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ioshikhes</surname> <given-names>Ilya</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Ottawa University, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple">
<list-item><p><bold>Conceived and designed the experiments:</bold> DE VM BG BA.</p></list-item>
<list-item><p><bold>Performed the experiments:</bold> DE VM.</p></list-item>
<list-item><p><bold>Analyzed the data:</bold> DE.</p></list-item>
<list-item><p><bold>Contributed reagents/materials/analysis tools:</bold> BG BA.</p></list-item>
<list-item><p><bold>Wrote the paper:</bold> DE VM BG BA.</p></list-item></list></p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">Daphne.Ezer@slcu.cam.ac.uk</email> (DE); <email xlink:type="simple">adryan@sysbiol.cam.ac.uk</email> (BA)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>23</day>
<month>8</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>8</issue>
<elocation-id>e1005072</elocation-id>
<history>
<date date-type="received">
<day>19</day>
<month>2</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>20</day>
<month>7</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Ezer et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005072"/>
<abstract>
<p>Many genes are expressed in bursts, which can contribute to cell-to-cell heterogeneity. It is now possible to measure this heterogeneity with high throughput single cell gene expression assays (single cell qPCR and RNA-seq). These experimental approaches generate gene expression distributions which can be used to estimate the kinetic parameters of gene expression bursting, namely the rate that genes turn on, the rate that genes turn off, and the rate of transcription. We construct a complete pipeline for the analysis of single cell qPCR data that uses the mathematics behind bursty expression to develop more accurate and robust algorithms for analyzing the origin of heterogeneity in experimental samples, specifically an algorithm for clustering cells by their bursting behavior (Simulated Annealing for Bursty Expression Clustering, SABEC) and a statistical tool for comparing the kinetic parameters of bursty expression across populations of cells (Estimation of Parameter changes in Kinetics, EPiK). We applied these methods to hematopoiesis, including a new single cell dataset in which transcription factors (TFs) involved in the earliest branchpoint of blood differentiation were individually up- and down-regulated. We could identify two unique sub-populations within a seemingly homogenous group of hematopoietic stem cells. In addition, we could predict regulatory mechanisms controlling the expression levels of eighteen key hematopoietic transcription factors throughout differentiation. Detailed information about gene regulatory mechanisms can therefore be obtained simply from high throughput single cell gene expression data, which should be widely applicable given the rapid expansion of single cell genomics.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Many genes are expressed in bursts, which can contribute to cell-to-cell variability. We construct a pipeline for analyzing single cell gene expression data that uses the mathematics behind bursty expression. This pipeline includes one algorithm for clustering cells (Simulated Annealing for Bursty Expression Clustering, SABEC) and a statistical tool for comparing the kinetic parameters of bursty expression across populations of cells (Estimation of Parameter changes in Kinetics, EPiK). We applied these methods to blood development, including a new single cell dataset in which TFs involved in the earliest branchpoint of blood differentiation were individually up- and down-regulated.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100005189</institution-id>
<institution>Leukemia and Lymphoma Society</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Göttgens</surname> <given-names>Berthold</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000265</institution-id>
<institution>Medical Research Council</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Göttgens</surname> <given-names>Berthold</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Göttgens</surname> <given-names>Berthold</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000288</institution-id>
<institution>Royal Society</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Adryan</surname> <given-names>Boris</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution>Marshall Scholarship</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1685-6909</contrib-id>
<name name-style="western">
<surname>Ezer</surname> <given-names>Daphne</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by: Royal Society Research Fellowship, Marshall Scholarship, Medical Research Council, the Leukemia and Lymphoma Society and core support grants from the Wellcome Trust to the Cambridge Institute for Medical Research and the Wellcome Trust and MRC Cambridge Stem Cell Institute. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data and code are all available from Supporting Information files and <ext-link ext-link-type="uri" xlink:href="https://github.com/ezer/SingleCellPipelineOverview" xlink:type="simple">https://github.com/ezer/SingleCellPipelineOverview</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Many genes are expressed in stochastic bursts: there are time periods where many transcripts are quickly produced, interspersed randomly with gaps of little or no transcriptional activity. Bursting gene expression was initially proposed as a mechanism to explain why cells in a seemingly uniform cell culture responded heterogeneously to steroids [<xref ref-type="bibr" rid="pcbi.1005072.ref001">1</xref>]. Two decades later, new live imaging technologies enabled researchers to <italic>observe</italic> transcriptional and translational bursting in real-time, finally confirming that bursting gene expression is a widespread phenomenon [<xref ref-type="bibr" rid="pcbi.1005072.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1005072.ref004">4</xref>]. In fact, Dar et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref005">5</xref>] tested 8,000 human genes and found that all of them were expressed in episodic bursts.</p>
<p>Ko et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref006">6</xref>] described bursting gene expression using a <italic>two-state model of gene expression</italic>, depicted in <xref ref-type="fig" rid="pcbi.1005072.g001">Fig 1A</xref>. In this model, each gene can either be in an <italic>on</italic> or an <italic>off</italic> state, and the gene stochastically transitions between these states, with transcription only taking place when the gene is on. The distribution of mRNA across a population of cells is determined by the following three kinetic parameters: the rate the gene turns on (<italic>K</italic><sub><italic>on</italic></sub>), the rate the gene turns off (<italic>K</italic><sub><italic>off</italic></sub>) and the rate of transcription when the gene is on (<italic>K</italic><sub><italic>t</italic></sub>), all normalized to the rate of mRNA degradation [<xref ref-type="bibr" rid="pcbi.1005072.ref007">7</xref>]. The values of these three kinetic parameters determine the distribution of mRNA transcripts within a population of cells (<xref ref-type="fig" rid="pcbi.1005072.g001">Fig 1B</xref>).</p>
<fig id="pcbi.1005072.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005072.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Two-state model of bursty gene expression.</title>
<p>The distribution of gene expression in a population of cells is partially caused by bursts of gene expression. (A) In the two state model of bursting gene expression, a gene stochastically turns on at rate <italic>K</italic><sub><italic>on</italic></sub> and off at rate <italic>K</italic><sub><italic>off</italic></sub>. When the gene is on, it transcribes mRNA at a rate of <italic>K</italic><sub><italic>t</italic></sub>. Note that all three rates are normalised to the rate of mRNA degradation (<italic>K</italic><sub><italic>d</italic></sub>). (B) These kinetic parameters control the shape of the gene expression distribution. In this figure, we keep <italic>K</italic><sub><italic>t</italic></sub> = 100 and vary <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>off</italic></sub>. At high <italic>K</italic><sub><italic>on</italic></sub> the distribution of mRNA transcripts is similar to a Poisson distribution (i), at high <italic>K</italic><sub><italic>off</italic></sub> the distribution of mRNA transcripts is similar to a negative binomial (ii), and at low values for <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>off</italic></sub> the distribution is bimodal (iii).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.g001" xlink:type="simple"/>
</fig>
<p>Predicting the rate at which genes turn on, turn off, and transcribe mRNA can provide insights into how genes are regulated. For instance, TFs which are <italic>necessary</italic> for transcription would control the rate at which the genes turn on (<italic>K</italic><sub><italic>on</italic></sub>). One example of such a TF would be a <italic>pioneering factor</italic>, which opens up the chromatin to allow transcription. Brown et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref008">8</xref>] found that switching between active/inactive states corresponded to distinct chromatin changes in PHO5. This is consistent with the results in Dadiani et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref009">9</xref>], which show that manipulating nucleosome-disfavoring sequences in yeast can influence the burst frequency. On the other hand, TFs that control <italic>K</italic><sub><italic>t</italic></sub> are responsible for modulating the levels of gene expression of genes that are already on [<xref ref-type="bibr" rid="pcbi.1005072.ref010">10</xref>]. For instance, they may be involved in polymerase II (PolII) recruitment or transcriptional elongation. Therefore, estimating these kinetic parameters could help generate hypotheses for gene regulation mechanisms.</p>
<p>Until now, the study of transcriptional bursting has been limited by the available experimental approaches. The most common high-throughput strategies (conventional RNA-seq or qPCR) for measuring gene expression require biological material from thousands of cells. These bulk strategies only measure the <italic>average</italic> levels of gene expression in populations of cells, data that cannot be used to make functional predictions about the bursting dynamics of transcription. While transcriptional bursting can be visualized in real-time in single cells, this is a low-throughput approach which can only measure expression for a single gene per cell [<xref ref-type="bibr" rid="pcbi.1005072.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005072.ref004">4</xref>]. Recently, there has been an emergence of single cell resolution RNA-seq and qPCR technologies, which can observe the full profile of gene expression in a population of cells. However, these are <italic>snapshot</italic> methods, which can only measure gene expression at a single point in time, because they involve lysing the cells.</p>
<p>Nevertheless, preliminary studies have shown that it is possible to utilize the shape of the distribution of gene expression at a single point in time to estimate the kinetic parameters of the two-state model. Raj et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref011">11</xref>] used a variation of the mathematical analysis done by Peccoud and Ycart [<xref ref-type="bibr" rid="pcbi.1005072.ref007">7</xref>] to estimate the kinetic parameters in fluorescent in situ hybridization (FISH)-based expression studies, and Kim and Marioni [<xref ref-type="bibr" rid="pcbi.1005072.ref012">12</xref>] developed a strategy to estimate kinetic parameters in RNA-seq data. In addition, Teles et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref013">13</xref>] applied a similar approach to a single cell qPCR dataset in the context of a hematopoietic developmental system.</p>
<p>As it is now accepted that bursting dynamics can in principle be resolved from single cell <italic>snapshot</italic> datasets, we can take advantage of this type of analysis to develop new algorithms that can answer a wide range of biological questions. In this paper, we apply our understanding of bursting gene expression to develop a more effective clustering algorithm for single cell gene expression data, which we call Simulated Annealing for Bursty Expression Clustering (SABEC). This can help researchers identify previously uncharacterized sub-populations of cells within their single cell data. Secondly, we develop a statistical tool for identifying whether the burst frequency (<italic>K</italic><sub><italic>on</italic></sub> or <italic>K</italic><sub><italic>off</italic></sub>) or burst magnitude (<italic>K</italic><sub><italic>t</italic></sub>) are the source of gene expression variations between experimental samples. Instead of simply observing whether gene expression increases or decreases across two populations of cells, this Estimation of Parameter changes in Kinetics (EPiK) toolkit allows researchers to make inferences about the underlying regulatory mechanisms affecting gene expression. We provide a complete pipeline in R for analyzing single cell qPCR data, including data normalization steps, SABEC clustering and EPiK cluster comparisons.</p>
<p>This pipeline can be utilized in a wide range of biological contexts. We apply it to study how some of the key transcription factors in hematopoiesis are being regulated, discovering that the hematopoietic stem cells studied in Moignard et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>] formed two distinct sub-populations, distinguishable by Tel and Gata1 expression levels. Then, by manipulating the expression levels of two of the TFs involved in early differentiation (Gfi1 and Gata2), we predict that the primary mechanisms by which these TFs influence their downstream targets is by manipulating <italic>K</italic><sub><italic>on</italic></sub>. Finally, we compare the mechanisms by which cell surface markers are regulated in healthy and leukemic cells based on data previously reported in Guo et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref015">15</xref>].</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>A pipeline for analyzing single cell gene expression data</title>
<p>We have developed a pipeline for analyzing single cell qPCR data in order to determine the mechanism by which TFs were regulated during differentiation (<xref ref-type="fig" rid="pcbi.1005072.g002">Fig 2</xref>).</p>
<fig id="pcbi.1005072.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005072.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Pipeline for the analysis of single cell gene expression data.</title>
<p>This paper develops several new tools for single cell analysis. (A) The kinetic parameters are estimated using a large look-up table. The likelihoods for each possible parameter set are found by multiplying the experimental data by the lookup table, and then the maximum likelihood is identified. (B) The SABEC algorithm is used to identify clusters of cells with uniform bursting kinetics– this iterative algorithm alternates between assigning cells to clusters and estimating bursting kinetic parameters for each cluster. This clustering algorithm is run 50 times and the results are summarized in a consensus matrix, which represents the frequency of each pair of cells being found in the same cluster. (C) Finally, the EPiK tool identifies the most likely set of parameters to have varied for a gene across two different cell populations, using a combination of the Bayesian Information Criterion (BIC), Marginal Probability (MP), and a Subsampling-based method, as described in (C). BIC calculates the likelihood for each possible set of parameters, penalised by the number of free parameters. The MP score calculates the likelihood of each parameter changing, independent of the behaviour of the other parameters. In the subsampling method, random sets of cells are selected, the kinetic parameters estimated for each population of cells; then, the distributions of estimated kinetic parameters are compared. (D) These new tools are combined to form a pipeline for analyzing single cell qPCR data. The details for each step of this pipeline are described in the <italic>Methods</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.g002" xlink:type="simple"/>
</fig>
<p>The input data consists of single cell qPCR data for a set of genes, where the cells have been sorted into their <italic>expected</italic> cell populations, using fluorescence-activated cell sorting (FACS). There are two main outputs of the pipeline. Firstly, cells are divided into populations (clusters) based on their bursting behaviour– each gene has the similar rates of activation (<italic>K</italic><sub><italic>on</italic></sub>), rates of inactivation (<italic>K</italic><sub><italic>off</italic></sub>) and rates of transcription (<italic>K</italic><sub><italic>t</italic></sub>) across all cells within each cluster. Secondly, the pipeline compares between each pair of cell populations and predicts the mechanism by which each gene changes its expression– by changing the rate the gene turned on and off or by changing the rate of transcription once the gene is already active.</p>
<p>A key component in the pipeline is our strategy for estimating the kinetic parameters. Previous approaches for estimating the kinetic parameters were slow to compute, because they involved iterative algorithms, such as simulated annealing [<xref ref-type="bibr" rid="pcbi.1005072.ref013">13</xref>], expectation maximisation [<xref ref-type="bibr" rid="pcbi.1005072.ref011">11</xref>], or Gibbs Sampling [<xref ref-type="bibr" rid="pcbi.1005072.ref012">12</xref>]. Meanwhile, we have a pre-computed look-up table for <italic>P</italic>(<italic>x</italic>|<italic>K</italic><sub><italic>on</italic></sub>, <italic>K</italic><sub><italic>off</italic></sub>, <italic>K</italic><sub><italic>t</italic></sub>), the probability of seeing <italic>x</italic> mRNA transcripts, given a set of kinetic parameters (<xref ref-type="fig" rid="pcbi.1005072.g002">Fig 2A</xref> and <xref ref-type="disp-formula" rid="pcbi.1005072.e001">Eq 1</xref>). This table can be used to compute the most likely set of kinetic parameters using a single matrix multiplication– a very efficient computation (<xref ref-type="disp-formula" rid="pcbi.1005072.e002">Eq 2</xref>).</p>
<p>In the pipeline, first we normalize the measurements from the qPCR and transform them into estimated mRNA counts (See <xref ref-type="disp-formula" rid="pcbi.1005072.e006">Eq 6</xref>). Next, these measurements are input into a newly developed unsupervised clustering algorithm (SABEC) which identifies populations of cells with uniform bursting kinetics. SABEC is an iterative algorithm that starts by randomly assigning cells to clusters; next, the algorithm alternates between estimating the kinetic parameters for each gene within each cluster (using <xref ref-type="disp-formula" rid="pcbi.1005072.e002">Eq 2</xref>) and probabilistically re-assigning cells to clusters based on their likelihood of belonging to each cluster (using <xref ref-type="disp-formula" rid="pcbi.1005072.e009">Eq 9</xref>), until the algorithm converges– i.e. when fewer than 5% of cells swap clusters. SABEC is run fifty times using different initial sets of randomly assigned clusters, and the results are summarised as a consensus matrix– a matrix that records the number of times two cells were grouped together. The number of clusters can be determined by one of the following methods: the proportion ambiguously clustered (PAC), Variable Information (VI) or the corrected Rand score (See <xref ref-type="fig" rid="pcbi.1005072.g002">Fig 2B</xref>).</p>
<p>Finally, each <italic>pair</italic> of populations is compared using a statistical tool we developed called EPiK, in order to identify whether each gene is regulated by modifying the rate the gene turns on (burst frequency) or the level of transcription once the gene is active (burst magnitude). EPiK is a compilation of three different methods: the Bayesian Information Criteria (BIC), a Marginal Probability (MP) Score, and a subsampling method. Since for each gene there can be between 0 and 3 parameters that can differ across a pair of populations, BIC identifies the set of parameters most likely to differ after penalising parameter sets that are larger (See <xref ref-type="disp-formula" rid="pcbi.1005072.e012">Eq 12</xref>). The MP score separately calculates the likelihood of each parameter changing, independent of whether the other parameters change or stay the same (See <xref ref-type="disp-formula" rid="pcbi.1005072.e015">Eq 15</xref>). In the subsampling method, the kinetic parameters are calculated for small random subsets of cells, then the distributions of estimated kinetic parameters for the subsets are compared by the Kolmagorov-Smirnov statistic(<xref ref-type="fig" rid="pcbi.1005072.g002">Fig 2C</xref>).</p>
<p>All together, our R data processing scripts, SABEC, and EPiK come together to form a pipeline that utilizes the mathematics of bursting gene expression to determine how genes are differentially regulated across populations of cells (<xref ref-type="fig" rid="pcbi.1005072.g002">Fig 2D</xref>).</p>
</sec>
<sec id="sec004">
<title>Validation of methods with <italic>in silico</italic> datasets</title>
<p>These methods were all tested <italic>in silico</italic> using data sets that have similar structures to the experimental datasets. Each of the three methods introduced in this paper (ML approach for kinetic parameter estimation, SABEC and EPiK) required a different set of simulated data.</p>
<p>The ML method for kinetic parameter estimation was benchmarked populations of cells with known kinetic parameters to allow us to quantify the accuracy of the method. 3,000 parameter sets were randomly selected (uniformly distributed) with <italic>K</italic><sub><italic>on</italic></sub> between 0 and 5, <italic>K</italic><sub><italic>off</italic></sub> between 0 and 20, and <italic>K</italic><sub><italic>t</italic></sub> between 0 and 600. We randomly sampled 10% of the transcripts from each of the simulated cell, to represent the technical noise caused by the loss of 90% of the starting material during sample preparation. We included a stochastic loss of mRNA transcripts to account for material loss during cDNA library construction– Islam et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref033">33</xref>] estimates that only 48% of transcripts are reverse transcribed into cDNA, and Wu et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref034">34</xref>] could capture 42% of the total unique transcripts that were identified in bulk RNA-seq.</p>
<p>The simulated datasets for testing the SABEC method were chosen to be as similar to the experimental datasets as possible. 100 simulation sets were generated, with each completely parallel to the Moignard dataset; Each simulation set consisted of five populations of 124 cells with 18 genes each, with their kinetic parameters equal to those estimated by the ML method for the experimental data.</p>
<p>Finally, to test the final method of comparing kinetic parameters between two populations of cells, 1600 simulated datasets were generated, each one consisted of a pair of populations of 124 cells with 1 gene each. There are eight combinations of kinetic parameters that can change (none, all, three ways one parameter can change and three ways two parameters can change). Two hundred pairs of populations were selected for each of these eight scenarios, with 100 simulations with 0 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 5 and 100 simulations with 5 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 10. The range of the other parameters were 0 &lt; <italic>K</italic><sub><italic>on</italic></sub> &lt; 5 and 0 &lt; <italic>K</italic><sub><italic>t</italic></sub> &lt; 600. In these simulations we also simulated the random loss of 90% of the mRNAs.</p>
<p>Even after simulating 90% loss of biological material, the predicted parameters correlated well with their real values, although <italic>K</italic><sub><italic>off</italic></sub> was the most difficult parameter to predict (See <xref ref-type="fig" rid="pcbi.1005072.g003">Fig 3A–3C</xref>), especially at wider parameter ranges (<xref ref-type="supplementary-material" rid="pcbi.1005072.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005072.s002">S2</xref> Figs), but it still performed better than the Kim and Marioni Method (<xref ref-type="supplementary-material" rid="pcbi.1005072.s003">S3 Fig</xref>). These <italic>in silico</italic> results emphasize that the cDNA library efficiency can have a large impact on the absolute values of predicted parameters, which suggests that raw parameter values are not comparable across different experiments. SABEC also accurately predicted clusters of simulated datasets, with similar population structures and parameter ranges to the experimental dataset (<xref ref-type="fig" rid="pcbi.1005072.g003">Fig 3D–3F</xref>). Finally, we found that the EPiK method was very conservative, with approximately a 0.05% false positive rate when the methods were intersected (<xref ref-type="fig" rid="pcbi.1005072.g003">Fig 3G and 3H</xref>). Further details about the validations and comparisons with alternative methods are described in depth in the <italic>Methods</italic>. Next, we applied these methods to experimental datasets.</p>
<fig id="pcbi.1005072.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005072.g003</object-id>
<label>Fig 3</label>
<caption>
<title><italic>In silico</italic> validation of single cell analysis pipeline.</title>
<p>In order to estimate the accuracy of the new tools developed in this paper, each tool was evaluated against simulated datasets. (A-C) The kinetic parameter estimation method was tested against simulated data in which 90% of the data was randomly discarded, to simulate the loss of biological material through inefficient cDNA preparation. The known kinetic parameters and the estimated kinetic parameters were compared for <italic>K</italic><sub><italic>on</italic></sub> (A), <italic>K</italic><sub><italic>off</italic></sub> (B) and <italic>K</italic><sub><italic>t</italic></sub> (C). (D-F) Next, SABEC was tested against simulated datasets that had the same kinetic parameters as those estimated for the cell populations in the Moignard single cell dataset (124 simulated cells for each of the 5 cell populations)—SABEC was tested on 100 of such simulated datasets and the robustness of the clustering was measured by calculating the proportion of ambiguously clustered cells (PAC). This figure depicts a hierarchical clustering of the consensus matrices that come from (D) the dataset whose clustering had the worst PAC score, (E) a randomly selected dataset, and (F) the dataset whose clustering had the best PAC score. The coloured bars along the side and bottom represent the true class labels of each cell. (G-H) Next, the true positive and false positive rates were calculated for each proposed component of EPiK, the union of the MP and subset method, and the intersection of all three methods. For the MP and Subset methods, thresholds were set so the false positive rate would be approximately 2%– receiver operating characteristic (ROC) curves for these are found in S13 and S14.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Single cell analysis of hematopoietic stem cells and progenitors</title>
<p>The dataset we use to test our pipeline comes from Moignard et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>], which is a high quality single cell qPCR dataset that includes approximately 124 cells each from five different populations of cells during hematopoeisis. Hematopoiesis is the process by which hematopoietic stem cells (HSC) in the bone marrow differentiate into different types of red and white blood cell types. This process can be depicted as a differentiation tree, in which each cell must make multiple “decisions” at each branching point in the tree that will determine its final cell fate. Moignard et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>] includes two key branching points: i) HSC cells can become lymphoid-primed multipotential progenitors (LMPPs) or premegakaryocytes (PreMegEs, also referred to as PreMs in figures) and ii) LMPP cells can become granulocyte-macrophage progenitors (GMPs) or common lymphoid progenitors (CLP).</p>
<p>The focus of this study is on the densely interconnected TF regulatory network that has been shown to contribute to cell fate decisions. There is strong evidence that at least seven of these TFs directly interact with one another, potentially forming a SCL/Lyl1/Gata2/Runx1/Lmo2/Fli-1/Erg heptad, with some TFs directly binding to the DNA (such as Gata2 and SCL) and other TFs serving a bridge between the DNA bound components (such as LMO2) [<xref ref-type="bibr" rid="pcbi.1005072.ref016">16</xref>]. Other key TFs that were profiled in Moignard et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>] were PU.1, Meis1, Hhex, Tel, Nfe2, Eto2, Mitf and Ldb1.</p>
<p>There are a number of open questions about the differentiation of HSC into the various progenitor cell populations. Firstly, although the cells were assigned to their populations via FACS, it is unclear whether these sub-populations are truly uniform. For instance, some HSC cells may be biased towards self-renewal or producing cells in the lymphoid or myeloid lineages.</p>
<p>Secondly, the specific mechanisms by which these TFs are being regulated are as yet uncharacterized. Influencing the rate at which genes turns on (<italic>K</italic><sub><italic>on</italic></sub>) could increase the proportion of cells with an active copy of a gene; whereas manipulating the transcription rate (<italic>K</italic><sub><italic>t</italic></sub>) would result in there being higher concentrations of mRNA, while maintaining the same proportion of cells with an active gene. In hematopoiesis, cellular TF concentrations help determine which branch the cell will take as it differentiates towards its final cell fate. Therefore, choosing to manipulate <italic>K</italic><sub><italic>on</italic></sub> instead of <italic>K</italic><sub><italic>t</italic></sub> could influence the proportion of cells that enter a certain differentiation trajectory. In addition, since the expression of these TFs is tightly linked, one gene’s bursting dynamics could have repercussions on the dynamics of the entire network.</p>
</sec>
<sec id="sec006">
<title>Hematopoietic stem cell populations have heterogeneous bursting kinetics</title>
<p>Although the cells that we study have been sorted into distinct subpopulations using FACS, this does not guarantee that the populations are indeed transcriptionally uniform. Some cells may be misclassified by FACS (expected misclassification rate is 1% for the Moignard dataset), and some of the known populations may be composed of as yet unidentified subpopulations. In addition, extrinsic variability, such as having cells in different stages of the cell cycle, could cause the populations to be heterogeneous.</p>
<p>It can be difficult to accurately identify homogenous subpopulations using standard clustering approaches like K-means or hierarchical clustering (<xref ref-type="supplementary-material" rid="pcbi.1005072.s005">S5 Fig</xref>). For instance, K-means is most effective when each cluster is normally distributed and has similar variances. Due to bursting, gene expression is unlikely to come from such a distribution; gene expression distributions can look like a Poisson distribution, a negative binomial distribution, or even a bimodal distribution, depending on <italic>K</italic><sub><italic>on</italic></sub>, <italic>K</italic><sub><italic>off</italic></sub>, and <italic>K</italic><sub><italic>t</italic></sub>. Therefore, we developed a simulated annealing strategy (Simulated Annealing for Bursty Expression Clustering, SABEC), which takes into account bursting gene expression, in order to have more robust clustering. SABEC was rigorously tested against simulated datasets that were designed to be as close as possible to the structure of the experimental data (<xref ref-type="supplementary-material" rid="pcbi.1005072.s006">S6 Fig</xref>). Additionally, the algorithm was tested on a wide range of simulated datasets, to see if this method could perform well under varied conditions, such as on data with different numbers of genes measured in each cell and different numbers of cells in each population (<xref ref-type="supplementary-material" rid="pcbi.1005072.s007">S7 Fig</xref>).</p>
<p>Next, SABEC was applied to the experimental single cell qPCR data from Moignard et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>]. The final clustering is depicted in <xref ref-type="fig" rid="pcbi.1005072.g004">Fig 4A</xref>. Although the predicted hematopoiesis differentiation tree is expected to look like <xref ref-type="fig" rid="pcbi.1005072.g004">Fig 4Bi</xref>, we found that HSC is divided into two distinct subpopulations. One of these populations had 12.8% of cells expressing Gata1, while the other population had none. Since Gata1 is uncommon in HSC cells, but often found in multi-potent progenitor populations (MPP, the earliest progenitor population formed by HSCs [<xref ref-type="bibr" rid="pcbi.1005072.ref017">17</xref>]), we hypothesized that the populations of cells without Gata1 may be self-renewal HSCs and the other may be HSCs poised for differentiation.</p>
<fig id="pcbi.1005072.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005072.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Application of SABEC to hematopoietic stem cells and progenitor populations.</title>
<p>SABEC was used to identify subpopulations of cells in the Moignard et al. dataset and to identify specific cells that do not cluster well with the other cells of the same type. (A) Hierarchical clustering was applied to the SABEC consensus matrix to reveal six subpopulations of HSC in subfigure. (Bi) The expected hematopoiesis differentiation tree is shown–the names of the cell populations are color-coded to match the vertical and horizontal bars in A. (Bii) We hypothesized a possible alternative differentiation tree, based on the clustering results. (C) Another application of this clustering method is to remove possible outliers, which may have arisen due to poorly sorted cells or extrinsic variability. Within each cell population (i.e. CLP (i), GMP (ii), HSC (iii), LMPP (iv) and PreM (v)), we sorted the cells by how often the cells are clustered with other cells from the same FACS label (% match). The vertical lines depict thresholds selected to approximately correspond to the region with the steepest slope– cells to the left are disregarded as outliers in the EPiK analysis.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.g004" xlink:type="simple"/>
</fig>
<p>Our clustering with SABEC was based solely on the expression of 18 TFs. However, Moignard et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>] also profiled cell surface protein tyrosine kinase c-Kit. It is known that low levels of c-Kit correlate to greater self-renewal potential in HSCs [<xref ref-type="bibr" rid="pcbi.1005072.ref018">18</xref>]. Even though all of the HSC cells were positive for the c-Kit protein according to FACS, not all the cells had high levels of c-Kit transcripts. Our hypothesized self-renewal HSC population had significantly lower levels of c-Kit than our poised-to-divide population (p-value 9.117e-06 with Kolmogorov-Smirnov test). Even though c-Kit was not one of the genes used to cluster the cells, there was substantial difference in expression levels, suggesting the tree topology depicted in <xref ref-type="fig" rid="pcbi.1005072.g004">Fig 4Bii</xref>. Further evidence for this arrangement is in <xref ref-type="supplementary-material" rid="pcbi.1005072.s009">S9 Fig</xref>.</p>
<p>The SABEC algorithm has provided us with subpopulations that appear to have uniform bursting kinetics. In the next section we will identify which kinetic parameters were most likely adjusted across each pair of cell populations, using EPiK. EPiK works best when cell populations have uniform bursting dynamics; <xref ref-type="supplementary-material" rid="pcbi.1005072.s011">S11 Fig</xref> shows how having mixed cell types can influence estimates of kinetic parameters. Therefore, we remove cells that do not cluster well with other cells of the same type, with cutoff thresholds designated by the vertical lines in <xref ref-type="fig" rid="pcbi.1005072.g004">Fig 4C</xref>, which is determined by the region of the curve with the steepest slope. However, this pruning protocol could bias parameter estimation if it were to eliminate cells that are falsely identified as outliers (<xref ref-type="supplementary-material" rid="pcbi.1005072.s010">S10 Fig</xref>). Therefore, we run EPiK both on the pruned and unpruned datasets, and only consider parameters that are consistently found to have changed under both conditions. It is important to note that the proposed outlier cells may be of biological interest– for instance, they may be rare cell types or cells in the process of differentiation. The pruned dataset is only for use to boost the accuracy of predictions with EPiK, but <italic>all</italic> cells should be observed for other types of analysis.</p>
</sec>
<sec id="sec007">
<title>Transcription factors involved in hematopoiesis are regulated by different mechanisms at each stage of differentiation</title>
<p>EPiK incorporates three different metrics for evaluating whether kinetic parameter changes are significant. By taking the intersection of these three prediction methods, the false positive rate decreases without a significant drop in the true positive rate. This gives us a very conservative list of probable kinetic parameter changes (a 0.05% false positive rate with our simulated dataset).</p>
<p>The first method is the Bayesian Information Criterion (BIC) (<xref ref-type="supplementary-material" rid="pcbi.1005072.s012">S12 Fig</xref>), and the second method is the marginal probability (MP), which is the log likelihood of a certain parameter being varied, independent of whether the other two parameters vary or stay the same (<xref ref-type="supplementary-material" rid="pcbi.1005072.s013">S13 Fig</xref>). In the third method, we repeatedly subsample cells from each population and estimate the kinetic parameters for each subset, comparing the maximum distance between the cumulative density functions of the distributions (<xref ref-type="supplementary-material" rid="pcbi.1005072.s014">S14 Fig</xref>).</p>
<p>These three methods were applied to the experimental data from Moignard et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>]. Each of the methods is based on slightly different assumptions, so they each have different distributions of parameters being varied (See <xref ref-type="supplementary-material" rid="pcbi.1005072.s015">S15 Fig</xref>). For instance, BIC predicts that <italic>K</italic><sub><italic>off</italic></sub> is adjusted in a few cases, but this is not deemed significant by either the MP or subset methods. In addition, there are more significant parameter changes in the case of the pruned populations compared to the complete populations, because these populations are more distinct from one another.</p>
<p>We can now take a closer look at a few examples of TFs that have predicted kinetic parameter changes during differentiation (<xref ref-type="fig" rid="pcbi.1005072.g005">Fig 5</xref>). The predictions from each method are drawn along the branches of the hematopoiesis differentiation tree (<xref ref-type="fig" rid="pcbi.1005072.g005">Fig 5A–5E</xref>). To demonstrate the magnitude and direction of these kinetic parameter changes, <xref ref-type="fig" rid="pcbi.1005072.g005">Fig 5E–5H</xref> illustrates the kinetic parameter estimates for each population of cells.</p>
<fig id="pcbi.1005072.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005072.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Transcription factor-specific kinetic parameter changes.</title>
<p>For each specific gene, it is possible to use EPiK to predict which kinetic parameters vary throughout differentiation. (A-D) For each transition between populations of cells, the kinetic parameter changes are predicted for each TF using all six methods shown in the key, which we represent by six colored rectangles– the color corresponds to the parameters predicted to have changed, as designated in the key. If there are not enough cells with a certain gene expressed in order to calculate parameter changes, then the rectangles are depicted as white. The results are shown for a selection of TFs: Eto2 (A), Mitf (B), Nfe2 (C), and PU.1 (D). (E-H) To demonstrate that EPiK provides reasonable results, we depict the maximum likelihood estimates for <italic>K</italic><sub><italic>t</italic></sub> and <italic>K</italic><sub><italic>on</italic></sub> for each population of cells (pruned dataset). If there is a predominant change in <italic>K</italic><sub><italic>on</italic></sub> (red), <italic>K</italic><sub><italic>t</italic></sub> (yellow), or both variables (orange), then these populations are connected by lines of the corresponding color.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.g005" xlink:type="simple"/>
</fig>
<p>In <xref ref-type="fig" rid="pcbi.1005072.g005">Fig 5A and 5F</xref>, four out of the six methods predict that Eto2 is up-regulated by increasing <italic>K</italic><sub><italic>on</italic></sub> (red) during the HSC to PreM transition, which is consistent with Eto2 having a role in increasing the proportion of cells that differentiate into PreM [<xref ref-type="bibr" rid="pcbi.1005072.ref019">19</xref>].</p>
<p>One striking feature of <xref ref-type="fig" rid="pcbi.1005072.g005">Fig 5A–5E</xref> is that Eto2, Mitf, and PU.1 are regulated by different kinetic parameters in different stages of blood differentiation. PU.1 has known cell-type-specific enhancer elements [<xref ref-type="bibr" rid="pcbi.1005072.ref020">20</xref>], and our results may suggest that each of these may regulate PU.1 through different mechanisms. On the other hand, Nfe2 is <italic>consistently</italic> regulated by <italic>K</italic><sub><italic>t</italic></sub> throughout differentiation.</p>
<p>In some instances, all six methods come to a consensus as to which kinetic parameter was the source of gene expression variability for a particular TF, and these are shown in <xref ref-type="fig" rid="pcbi.1005072.g006">Fig 6A</xref>. Throughout hematopoiesis, most of the differences in gene expression come from changes of <italic>K</italic><sub><italic>on</italic></sub>, but Lmo2, Nfe2 and Meis1 are regulated by <italic>K</italic><sub><italic>t</italic></sub> in the transition from LMPP to GMP. Recall that in the previous section, we identified that HSC forms two distinct sub-populations. We compared the two HSC sub populations with their child populations (LMPP and PreM) (see <xref ref-type="fig" rid="pcbi.1005072.g006">Fig 6</xref>). Between HSC1 and HSC2 only Tel seemed to consistently change its kinetic parameter (<italic>K</italic><sub><italic>on</italic></sub>). As expected, the cell population with higher Gata1 and c-Kit expression has more in common with LMPP and PreM cells than the other HSC subpopulation.</p>
<fig id="pcbi.1005072.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005072.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Most significant kinetic parameters variations during hematopoiesis.</title>
<p>This figure illustrates kinetic parameter change predictions that are consistent across all six methods illustrated in the key of <xref ref-type="fig" rid="pcbi.1005072.g005">Fig 5</xref>– in other words, this is the intersection of BIC, MP, and the subset methods, as applied to both pruned and un-pruned datasets. Just as in <xref ref-type="fig" rid="pcbi.1005072.g005">Fig 5</xref>, red boxes designate that <italic>K</italic><sub><italic>on</italic></sub> varies, yellow boxes designate that <italic>K</italic><sub><italic>t</italic></sub> varies and orange boxes designate that both parameters change. A positive/negative signifies that gene expression increases/decreases along the line (top to bottom; or in the case of horizontal lines left to right). (A) The most significant kinetic parameter changes are shown for the expected hematopoietic tree. (B) Based on the SABEC clustering analysis, it appeared as if there were two distinct HSC subpopulations– the differences between these two subpopulations and LMPP and PreM subpopulations were also calculated.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.g006" xlink:type="simple"/>
</fig>
<p>In summary, our methods have allowed us to not only identify which genes have changed their expression, but also what physical mechanism caused that change.</p>
</sec>
<sec id="sec008">
<title>Gata2 and Gfi1 may regulate transcription by influencing the rate genes turn on</title>
<p>In the previous section, we identified TFs that were regulated by <italic>K</italic><sub><italic>on</italic></sub> or <italic>K</italic><sub><italic>t</italic></sub> during blood differentiation, but it is unclear which TFs were <italic>controlling</italic> these changes. It may be possible to discover the specific mechanistic role of a TF by manipulating its expression experimentally and then calculating the change in kinetic parameters of its downstream targets.</p>
<p>We decided to focus on the Gfi1-Gfi1b-Gata2 subnetwork that was identified as being important at the first branching point of HSCs to LMPP and PreMegEs [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>]. Primary HSCs are difficult to isolate in large quantities, culture and manipulate, so we turned to HPC7 cells, a model cell line for hematopoietic stem and progenitor cells which has some differentiation potential towards more mature blood cells [<xref ref-type="bibr" rid="pcbi.1005072.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005072.ref021">21</xref>]. Similarly to HSCs, HPC7 cells express Gata2 and Gfi1b, but little or no Gfi1. We therefore up-regulated Gfi1 expression and down-regulated Gata2 expression and performed single cell gene expression analysis for the gene set described by Moignard et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>], as well as some additional genes involved in HSC differentiation. We analysed 81 cells expressing an shRNA against Gata2 and 77 cells control cells expressing an shRNA against Luciferase, and 72 cells overexpressing Gfi1 and 45 control cells expressing an empty vector.</p>
<p>There are a number of strategies by which a TF could reduce gene expression: by decreasing the rate a gene turns on, by increasing the rate a gene turns off, or by decreasing the rate of transcription of an active gene, and each of these strategies would result in different temporal dynamics of gene expression bursting. All six methods came to a consensus that up-regulating Gfi1 seemed to significantly alter Erg, Gfi1b, Hhex and Mpl, by lowering <italic>K</italic><sub><italic>on</italic></sub>. Previous research suggests that Gfi1 is usually a repressor that either keeps the chromatin in a condensed state or actively competes for binding with activators [<xref ref-type="bibr" rid="pcbi.1005072.ref022">22</xref>]. Both of these mechanisms of action are consistent with Gfi1 down regulating its targets by lowering <italic>K</italic><sub><italic>on</italic></sub>. Based on ChIP-seq experiments from Sanchez-Castillo et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref023">23</xref>], Gfi1 binds in or near all four of these potential targets (see <xref ref-type="supplementary-material" rid="pcbi.1005072.s021">S1 Table</xref>).</p>
<p>In the other experiment, Gata2 was down-regulated; however, this was not a complete knockdown, with only a slight overall decrease in expression (<xref ref-type="supplementary-material" rid="pcbi.1005072.s020">S20 Fig</xref>). All six methods suggest that Gfi1b expression was decreased via a change in <italic>K</italic><sub><italic>on</italic></sub> as Gata2 levels decreased. In the pruned population of cells, Procr (also known as EPCR, a known target of Gata2) had higher <italic>K</italic><sub><italic>on</italic></sub> after the knockdown [<xref ref-type="bibr" rid="pcbi.1005072.ref024">24</xref>].</p>
<p>When Gata2 and Gfi1 were down- and up-regulated, our methods could only detect changes in <italic>K</italic><sub><italic>on</italic></sub>. Therefore, we can hypothesize that this could be the mechanism of action of these two TFs.</p>
</sec>
<sec id="sec009">
<title>Gene expression variations in leukemia</title>
<p>Our pipeline for the identification of differential kinetic parameter values can also be applied to compare healthy and diseased cell populations. In particular, we apply it to four of the cell populations isolated in Guo et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref015">15</xref>]: two cell types from a healthy mouse (GMP, Lin+) and two from a leukemic mouse (LGMP, LLin+), whose leukemic cells came from a MLL-AF9 fusion protein [<xref ref-type="bibr" rid="pcbi.1005072.ref025">25</xref>]. The most significant kinetic parameter changes are shown in <xref ref-type="fig" rid="pcbi.1005072.g007">Fig 7</xref>. Some of the genes profiled by Guo et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref015">15</xref>] were found in fewer than 10 cells in one or more cell population, and these were excluded from kinetic parameter comparisons.</p>
<fig id="pcbi.1005072.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005072.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Kinetic parameter differences between leukemic and healthy cells.</title>
<p>This figure illustrates kinetic parameter change predictions for the single cell qPCR data in Guo et al. Just as in Figs <xref ref-type="fig" rid="pcbi.1005072.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1005072.g006">6</xref>, red boxes indicate that <italic>K</italic><sub><italic>on</italic></sub> varies, yellow boxes indicate that <italic>K</italic><sub><italic>t</italic></sub> varies and orange boxes signify that both parameters change. The blue box indicates that <italic>K</italic><sub><italic>off</italic></sub> varies. A positive/negative signifies that gene expression increases/decreases along the line (top to bottom; or in the case of horizontal lines left to right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.g007" xlink:type="simple"/>
</fig>
<p>Some of the genes are enriched in a single cell population; for instance, TLR9, a factor whose expression influences the prognosis of leukemia [<xref ref-type="bibr" rid="pcbi.1005072.ref026">26</xref>], is found predominantly in the LLin+ cells, and appears to be regulated by <italic>K</italic><sub><italic>on</italic></sub>. Most of the identified kinetic parameter changes were in <italic>K</italic><sub><italic>on</italic></sub> or a combination of <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub>. However, MUC13 and SIGLEC5 were predicted to have been regulated by only <italic>K</italic><sub><italic>t</italic></sub> and IL3RA was predicted to be regulated by <italic>K</italic><sub><italic>off</italic></sub>. Interestingly, IL3RA is the only example where all methods predict changes in <italic>K</italic><sub><italic>off</italic></sub>, which suggests that this is a promising gene to focus on in future research.</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>In this study, we exploit established mathematical models of bursting gene expression to develop a new pipeline for analyzing single cell qPCR data to more robustly cluster biological samples and provide insight into the mechanics of gene regulation. We apply these methods to study gene regulation in hematopoietic stem cell and progenitor populations. Even though single cell qPCR data can only provide snapshots of gene expression in a population of cells across different time points, we can infer the temporal dynamics of gene expression in these cells, and use this information to infer the population substructure (via SABEC) or regulatory mechanisms (via EPiK). This pipeline can be applied to study how genes are regulated during the natural process of differentiation or as cells progress into a diseased state. In addition, by manipulating the expression of a TF within its cell culture, we can infer its specific regulatory role. These algorithms perform well in simulated datasets (<xref ref-type="supplementary-material" rid="pcbi.1005072.s001">S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005072.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005072.s006">S6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005072.s007">S7</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005072.s008">S8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005072.s012">S12</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005072.s013">S13</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005072.s014">S14</xref> Figs), performing better than similar computational tools (Figs <xref ref-type="fig" rid="pcbi.1005072.g008">8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005072.s003">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005072.s005">S5</xref>).</p>
<fig id="pcbi.1005072.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005072.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Consensus clustering comparison of SABEC and K-means.</title>
<p>In the case of the Moignard dataset, SABEC is better than K-means at grouping cells by their FACS label. (A, B) For each pair of cells, we can count the number of times a pair of cells cluster together– a cumulative density function of these values, for K varying from 5 to 10, is shown in for SABEC (A) and K-means (B). Pairs of cells that are grouped together greater than 10% of the time and less than 90% of the time–represented by the vertical lines in (A) and (B)– are considered to be ambiguously clustered. (C) The proportion of cells that are ambiguously clustered (PAC) for SABEC and K-means is used to evaluate the robustness of the clustering approach. (D, E) Next we quantify the accuracy of the clusters, as compared to the labelled values (as per FACS). Specifically, this was done using the variable information (VI) (D) and the corrected Rand index (corrected Rand) (E). (F, G) The full consensus matrix, by cell type label according to FACS, for <italic>K</italic> = 6 are shown for SABEC (F) and K-means (G).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.g008" xlink:type="simple"/>
</fig>
<p>Instead of simply observing how much gene expression heterogeneity there is in a sample, it is now possible to predict the specific regulatory mechanisms that contributed to heterogeneity. Most crucially, this type of analysis can be done in a high-throughput manner.</p>
<p>In addition, commonplace clustering algorithms like K-means and hierarchical clustering are not meant to cluster data drawn from Poisson, negative binomal, and bimodal distributions, as is the case for single cell gene expression data. For instance, K-means performs best on data that comes from normal distributions with similar standard deviations. For this reason, it is critical to use a clustering algorithm that incorporates information about the shape of the gene expression distributions when analyzing single cell resolution datasets.</p>
<p>However, it is unclear how the cell cycle could influence our results, so future experiments ought to include cell cycle markers as controls [<xref ref-type="bibr" rid="pcbi.1005072.ref027">27</xref>]. In addition, our approach assumes that the gene expression distributions are close to equilibrium. Fortunately, Peccoud and Ycart [<xref ref-type="bibr" rid="pcbi.1005072.ref007">7</xref>] demonstrated that the two state model approaches the equilibrium distribution very rapidly (at an exponential rate), so this assumption likely holds. Other researchers have attempted to fit a multi-state model to data, instead of a two state model [<xref ref-type="bibr" rid="pcbi.1005072.ref028">28</xref>], but unless there is strong evidence for a more complex model, it is wise to use the simplest approach to avoid over-fitting the data. In the future, it may be possible to modify the model to detect cells that are in the process of transitioning between cell populations– for instance, these may be cells that have estimated kinetic parameters that are between two other populations. In addition, Teles et. al. [<xref ref-type="bibr" rid="pcbi.1005072.ref013">13</xref>] estimated the probability of transition between cell populations using machine learning methods, but this is beyond the scope of this paper.</p>
<p>One particularly useful application of this pipeline is the validation of assumptions used to model specific sub-networks of genes important in differentiation. Often, these models assume certain mechanisms by which the TFs influence one another. For instance, Narula et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref029">29</xref>] constructed a mathematical model of a hematopoietic sub-network under the assumption that <italic>K</italic><sub><italic>off</italic></sub> was the parameter that is biologically regulated, in the absence of any experimental data. Instead of arbitrarily selecting a modeling strategy, we can now choose one that fits the data best. In addition, we have discovered that different TFs are regulated through different mechanisms in each stage of differentiation, implying that a single model of a gene network might not universally apply. Therefore, these strategies would allow us to make more biologically plausible models of gene subnetworks. Having a better understanding of gene regulation processes is important in order to learn how these are perturbed in disease, and also to develop protocols that produce desired cell types for cell therapy.</p>
<p>A modified version of this pipeline for RNA-seq data would be an important future development. The kinetic parameter estimation strategy and EPiK may be applied to single cell RNA-seq, as long as there is sufficient sequencing depth to capture the population-wide distribution of gene expression. Both these methods scale approximately linearly with the number of cells and genes under study, and could also be run in parallel for very large datasets. However, SABEC would not scale well with the large number of genes analysed in RNA-seq experiments, so alternative clustering approaches must be tested in an RNA-seq context.</p>
<p>The transcription process is a multi-step chemical reaction: chromatin must enter the correct state, TFs must bind in the right places, the general transcription machinery must be recruited and initiated, etc. It is currently impossible to distinguish the effects of all of these mechanisms in a high-throughput way. Our pipeline provides a first attempt to understand how the kinetic parameters underlying complex transcriptional processes influence heterogeneity within and across cell populations, through the analysis of single cell gene expression data.</p>
</sec>
<sec id="sec011" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec012">
<title>Cell culture</title>
<p>HPC7 cells [<xref ref-type="bibr" rid="pcbi.1005072.ref021">21</xref>] were grown in suspension in Iscove’s Modified Eagle’s Medium (IMDM, Gibco) with 10% FCS, 10% stem cell factor-conditioned medium, 1% penicillin/streptomycin (Sigma) and 1.5 × 10<sup>−4</sup> M monothioglycerol (MTG) at 37°C and 5% <italic>CO</italic><sub>2</sub>. Cells were passaged every two days to maintain a concentration of 0.5 − 2 × 10<sup>6</sup> cells/ml.</p>
</sec>
<sec id="sec013">
<title>Retroviral transduction</title>
<p>For knockdown experiments, shRNA fragments were cloned into pMSCV/LTRmiR30-PIG (pLMP, Open Biosystems): Luciferase (control, 5’ CACGTACGCGGAATACTTCGAA 3’, [<xref ref-type="bibr" rid="pcbi.1005072.ref030">30</xref>]), Gata2 (5’ CGCCGCCATTACTGTGAATATT 3’, [<xref ref-type="bibr" rid="pcbi.1005072.ref031">31</xref>]). For overexpression experiments, the mouse Gfi1 cDNA was inserted into pMSCV-ires-GFP (Addgene plasmid 20672), with the empty vector used as a control. Retrovirus was produced using the pCL-Eco Retrovirus Packaging Vector (Imgenex) in 293T cells.</p>
<p>HPC7 cells were infected with retrovirus by centrifugation at 800 xg at 32°C for 1.5 hours with 4 <italic>μ</italic>g/ml polybrene (Sigma), after which the retroviral supernatant was replaced with fresh media and cells were cultured as normal. Transduction efficiency was monitored by flow cytometry for GFP.</p>
</sec>
<sec id="sec014">
<title>Single cell gene expression analysis</title>
<p>Single GFP+ cells were sorted by FACS into individual wells of 96 well plates and single cell RT-qPCR was carried out as described previously [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>]. Cells were captured 48 hours after retroviral transduction for Gfi1 overexpression and 72 hours after transduction for Gata2 knockdown (<xref ref-type="supplementary-material" rid="pcbi.1005072.s021">S1 Table</xref>).</p>
</sec>
<sec id="sec015">
<title>Estimation of kinetic parameters</title>
<p>Bursting gene expression can lead to a number of different distributions of gene expression in a population of cells (See <xref ref-type="fig" rid="pcbi.1005072.g001">Fig 1B</xref>), ranging from a bimodal distribution (when <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>off</italic></sub> are low) to a Poisson distribution (when <italic>K</italic><sub><italic>on</italic></sub> is much higher than <italic>K</italic><sub><italic>off</italic></sub>) to an exponential decay-like distribution (when <italic>K</italic><sub><italic>off</italic></sub> is much higher than <italic>K</italic><sub><italic>on</italic></sub>). The probability of having <italic>x</italic> mRNA molecules in a cell with kinetic parameters <italic>K</italic><sub><italic>on</italic></sub>, <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> is given by the analytical solution developed by [<xref ref-type="bibr" rid="pcbi.1005072.ref011">11</xref>]:
<disp-formula id="pcbi.1005072.e001"><alternatives><graphic id="pcbi.1005072.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>K</mml:mi> <mml:mi>t</mml:mi> <mml:mi>x</mml:mi></mml:msubsup></mml:mrow> <mml:mrow><mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mn>1</mml:mn> <mml:mi>F</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>In this equation, 1<italic>F</italic>1 represents the confluent hypergeometric function of the first kind, a summation over an infinite series that is time intensive to compute. To improve our runtimes, we precomputed an extensive lookup table of values of <italic>P</italic>(<italic>x</italic>|<italic>K</italic><sub><italic>on</italic></sub>, <italic>K</italic><sub><italic>off</italic></sub>, <italic>K</italic><sub><italic>t</italic></sub>). Let us say that we have <italic>n</italic> cells, each with an mRNA molecule count (for a particular gene) of <italic>x</italic><sub><italic>i</italic></sub>, and let <italic>X</italic> = {<italic>x</italic><sub>0</sub>, <italic>x</italic><sub>1</sub>, …<italic>x</italic><sub><italic>n</italic></sub>}. Given this list of mRNA counts from a semi-uniform population, we can assess the log likelihood of each possible set of parameters:
<disp-formula id="pcbi.1005072.e002"><alternatives><graphic id="pcbi.1005072.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>X</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">ln</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>The set of kinetic parameters that has the maximum likelihood is chosen. However, it is important to note that some areas of the parameter space are more sensitive to parameter changes than others. For instance, [<xref ref-type="bibr" rid="pcbi.1005072.ref011">11</xref>] notes that at large values of <italic>K</italic><sub><italic>off</italic></sub> the equation of <italic>P</italic>(<italic>x</italic>|<italic>K</italic><sub><italic>on</italic></sub>, <italic>K</italic><sub><italic>off</italic></sub>, <italic>K</italic><sub><italic>t</italic></sub>) approaches:
<disp-formula id="pcbi.1005072.e003"><alternatives><graphic id="pcbi.1005072.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mrow><mml:msup><mml:mi>P</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mfrac><mml:msub><mml:mi>K</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mfrac><mml:msub><mml:mi>K</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mfrac><mml:msub><mml:mi>K</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mfrac></mml:mfenced> <mml:mi>x</mml:mi></mml:msup></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>This equation depends of the ratio of <italic>K</italic><sub><italic>t</italic></sub>/<italic>K</italic><sub><italic>off</italic></sub> rather than <italic>K</italic><sub><italic>t</italic></sub> and <italic>K</italic><sub><italic>off</italic></sub> separately, which means that <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> are more difficult to distinguish as <italic>K</italic><sub><italic>off</italic></sub> increases. The practical implication of this observation is illustrated in <xref ref-type="fig" rid="pcbi.1005072.g009">Fig 9A and 9B</xref>, which depict the log likelihoods at different kinetic parameter values for GFI1b in HSC cells, with regions that have log likelihoods close to the peak value coloured in (specifically, within 0.5 of the maximum likelihood). Although there is only a narrow range of possible <italic>K</italic><sub><italic>on</italic></sub> values (A), there is a range of values where <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> can partially compensate for one another (B). A specific example is illustrated with simulated data in <xref ref-type="fig" rid="pcbi.1005072.g009">Fig 9C</xref>: while the original distribution of gene expression (grey) varies visibly when <italic>K</italic><sub><italic>off</italic></sub> (blue) or <italic>K</italic><sub><italic>t</italic></sub> (red) are varied, it is possible to change both variables (purple) and almost recover the original distribution. Furthermore, this analysis suggests that it would be difficult to incorporate any additional parameters into the system and find unique estimates for each of them.</p>
<fig id="pcbi.1005072.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005072.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Properties of two-state model and kinetic parameter estimation strategy.</title>
<p>Kinetic parameters control the shape of the gene expression distribution. Kinetic parameters are estimated by calculating the maximum likelihood from <xref ref-type="disp-formula" rid="pcbi.1005072.e002">Eq 2</xref>. (A-B) In order to illustrate some properties of the two-state model, the likelihoods of various kinetic parameter sets were calculated for a toy example–specifically GFI1b gene expression data in hematopoietic stem cells (HSC). (A) For each possible <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>off</italic></sub> value, we calculated the maximum log likelihood across all possible <italic>K</italic><sub><italic>t</italic></sub> values. The overall log-maximum likelihood was 603.66 and only values that were within 0.5 of this value were coloured in, with the maximum value in dark red. (B) The maximum log likelihood of all possible <italic>K</italic><sub><italic>on</italic></sub> values were also calculated, as <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> were varied. There is a region in subfigure B where <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> can compensate for one another. (C) An example of parameter compensation was simulated: the original distribution (grey) has visible changes when <italic>K</italic><sub><italic>off</italic></sub> (blue) and <italic>K</italic><sub><italic>t</italic></sub> (red) are varied, but the distributions are barely distinguishable when both parameters are varied (purple). (D) Finally, we show our method’s estimates of <italic>K</italic><sub><italic>on</italic></sub> and <italic>ln</italic>(<italic>K</italic><sub><italic>off</italic></sub>/<italic>K</italic><sub><italic>t</italic></sub>) for each TF in each population of FACS cells.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.g009" xlink:type="simple"/>
</fig>
<p>In <xref ref-type="supplementary-material" rid="pcbi.1005072.s001">S1 Fig</xref>, we test the performance of this strategy of kinetic parameter estimation on simulated data, including artificial technical noise. Although <italic>K</italic><sub><italic>off</italic></sub> cannot be accurately identified when <italic>K</italic><sub><italic>off</italic></sub> &gt; 5, the ratio of <italic>K</italic><sub><italic>off</italic></sub> to <italic>K</italic><sub><italic>t</italic></sub> is accurately predicted (<xref ref-type="supplementary-material" rid="pcbi.1005072.s002">S2 Fig</xref>). Our method also performs better than the Gibbs Sampling based approach developed by Kim and Marioni, 2012 (<xref ref-type="supplementary-material" rid="pcbi.1005072.s003">S3 Fig</xref>).</p>
<p>Next, we applied this maximum likelihood approach for kinetic parameter estimation on hematopoietic stem cell and progenitor populations (CLP, GMP, CLP, LMPP and PreM cells) from [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>]. The values for <italic>K</italic><sub><italic>on</italic></sub> and <italic>ln</italic>(<italic>K</italic><sub><italic>off</italic></sub>/<italic>K</italic><sub><italic>t</italic></sub>) for the Moignard data are shown in <xref ref-type="fig" rid="pcbi.1005072.g009">Fig 9F</xref>. Note that many of the TFs were particularly chosen due to their importance in early differentiation of HSCs, so one would expect a lower level of gene expression (and therefore a higher <italic>K</italic><sub><italic>off</italic></sub>/<italic>K</italic><sub><italic>t</italic></sub> ratio) in later stage progenitor populations such as CLP and GMP. There is a wide range of estimated kinetic parameter values across the TFs in each cell population; however, we need to ensure that these kinetic parameter estimates are not being skewed by mis-classified cells before we can evaluate whether these differences are statistically significant.</p>
</sec>
<sec id="sec016">
<title>Parameter range and look-up table</title>
<p>It is crucial to select a table of appropriate range and point density for applying to the experimental data. The criteria for selecting this table were: i) fewer than 5% of the experimental points were at the maximum parameter value for the <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> parameters. ii) <italic>K</italic><sub><italic>off</italic></sub> had to be high enough in order to include the parameter range in which only the ratio of <italic>K</italic><sub><italic>t</italic></sub> to <italic>K</italic><sub><italic>off</italic></sub> matter ii) the density of points was sufficient to minimise artifacts arising from the discretization of the parameter space.</p>
<p>Given these constraints, the range of parameters was chosen to be 0 &lt; <italic>K</italic><sub><italic>on</italic></sub> &lt; 5, 0 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 20 and 0 &lt; <italic>K</italic><sub><italic>t</italic></sub> &lt; 200 and possible mRNA counts as 0 &lt; <italic>x</italic> &lt; 200. The sampling density for <italic>K</italic><sub><italic>on</italic></sub> was every 0.1, for <italic>K</italic><sub><italic>off</italic></sub> every 0.4 and for <italic>K</italic><sub><italic>t</italic></sub> every 5 for a total of 395000 possible parameter sets.</p>
<p>We deposited the look-up table, the code used to generate the table in Mathematica and the code for calculating the maximum likelihood in R on Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/ezer/SingleCellPipelineOverview" xlink:type="simple">https://github.com/ezer/SingleCellPipelineOverview</ext-link>.</p>
</sec>
<sec id="sec017">
<title>Scaling qPCR data to mRNA counts</title>
<p>The main source of data analysed in this paper comes from Moignard et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>], and contains single cell qPCR data from five populations of hematopoietic stem cell and progenitor cells (CLP, GMP, HSC, LMPP, PreM), as determined by FACS, with approximately 124 cells in each population. The genes profiled by the qPCR include 18 TFs with crucial roles in cell fate, which were normalised to two “housekeeping” genes (PolII and Ubc), as described in Moignard et al. [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>].</p>
<p>The outcome of a PCR experiment is a normalised <italic>C</italic><sub><italic>t</italic></sub> value, which relates to mRNA molecules (<italic>x</italic>) as follows:
<disp-formula id="pcbi.1005072.e004"><alternatives><graphic id="pcbi.1005072.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>=</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi> <mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:mo>·</mml:mo> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where <italic>a</italic> and <italic>b</italic> are constants. For each TF, we chose <italic>b</italic>:
<disp-formula id="pcbi.1005072.e005"><alternatives><graphic id="pcbi.1005072.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mi>F</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>x</mml:mi> <mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:msub> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mi>F</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>x</italic><sub><italic>max</italic></sub> = 200 is the maximum number of mRNA pre-calculated in our lookup table and <italic>X</italic><sub><italic>TF</italic></sub> is the set of mRNA counts for the particular TF. This choice of <italic>b</italic><sub><italic>TF</italic></sub> stretches the values of <italic>x</italic> to have as wide a range as possible. It also removes the need to set an <italic>a</italic> parameter, since the equation for calculating <italic>x</italic> can be simplified to:
<disp-formula id="pcbi.1005072.e006"><alternatives><graphic id="pcbi.1005072.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>=</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>·</mml:mo> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mi>F</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula></p>
<p>It is important to note that while a different <italic>b</italic> parameter was chosen for each TF, this <italic>b</italic> factor is consistent across all five populations of cells, which is crucial for our later attempts to compare kinetic parameter values between cell populations. Even though the choice of <italic>b</italic> changes the absolute value of the kinetic parameters that are estimated, it has minimal effects on the strength of the linear correlation between the known and estimated values.</p>
</sec>
<sec id="sec018">
<title>Simulated Annealing for Bursty Expression Clustering (SABEC)</title>
<p>SABEC begins by assigning each cell to a random population 1 to K. Note that the total number of clusters K must be set at the start of the algorithm. Next, SABEC iteratively calculates the kinetic parameters of each of the K populations, and the cells are reassigned to new populations probabilistically.</p>
<p>In a standard Expectation Maximisation clustering algorithm, the probability of assigning a cell to a population is proportional to the ratio of the likelihoods of the cell coming from each population. Let the kinetic parameter set for a single population be <italic>S</italic><sub><italic>i</italic></sub>(<italic>g</italic>) = (<italic>K</italic><sub><italic>on</italic></sub>(<italic>g</italic>), <italic>K</italic><sub><italic>off</italic></sub>(<italic>g</italic>), <italic>K</italic><sub><italic>t</italic></sub>(<italic>g</italic>)), where <italic>g</italic> is the gene (between 1 and G) and <italic>i</italic> labels the population (between 1 and K), and let <bold>x</bold>(<italic>g</italic>) be the vector of mRNA counts for each gene, for a particular cell. The log likelihood for a certain population can be calculated as follows:
<disp-formula id="pcbi.1005072.e007"><alternatives><graphic id="pcbi.1005072.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>G</mml:mi></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">ln</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>If the sum of the likelihoods for each population is <italic>L</italic><sub><italic>tot</italic></sub>, this value can be scaled as such:
<disp-formula id="pcbi.1005072.e008"><alternatives><graphic id="pcbi.1005072.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:msup><mml:mi>L</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula></p>
<p>Since it would take a long time for this algorithm to converge if the clusters are close to one another, we add a temperature parameter, so that initially it is easy for cells to be assigned to different clusters, but it becomes harder and harder to swap clusters over time:
<disp-formula id="pcbi.1005072.e009"><alternatives><graphic id="pcbi.1005072.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mrow><mml:msup><mml:mi>L</mml:mi> <mml:mrow><mml:mo>″</mml:mo> </mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>L</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>τ</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
where <italic>τ</italic> is the temperature parameter and <italic>t</italic> is the iteration number of the algorithm (a counter that increments each time the cells are reassigned to new clusters). A cell is probabilistically assigned to a new cluster based on the relative values of <italic>L</italic>″(<italic>S</italic><sub><italic>i</italic></sub>|<bold>x</bold>) for each population. The algorithm terminates when fewer than 5% of the cells swap clusters in an iteration, or after 100 iterations. <xref ref-type="supplementary-material" rid="pcbi.1005072.s004">S4 Fig</xref> shows how the accuracy of the algorithm depends of the temperature parameter, <italic>τ</italic>.</p>
<p>Since this algorithm is randomized and since it is possible for certain runs of the algorithm to fall into local optima, we run this algorithm 50 times and conduct a secondary consensus clustering step. In this step, a consensus matrix is produced, in which each cell of the matrix represents the number of times that two cells are found in the same cluster. A plot of the cumulative density function of the values of this matrix can help visualise the robustness of the clustering (See <xref ref-type="fig" rid="pcbi.1005072.g008">Fig 8A</xref>). For comparison and to show the necessity for SABEC, consensus clustering of K-means was also conducted (See <xref ref-type="fig" rid="pcbi.1005072.g008">Fig 8B</xref>).</p>
<p>
<xref ref-type="fig" rid="pcbi.1005072.g008">Fig 8</xref> shows the cumulative density functions for the number of times two cells cluster together for SABEC (<italic>A</italic>) and K-means (<italic>B</italic>). [<xref ref-type="bibr" rid="pcbi.1005072.ref032">32</xref>] determined that the most robust metric for comparing the consistency of consensus clustering methods is the Proportion Ambiguously Clustered (PAC) score, which is defined as the proportion of cell pairs that cluster together in 10% and 90% of the repeated runs of the algorithm. This corresponds to the proportion of cell pairs that lie between the vertical lines in the cumulative distribution functions in <xref ref-type="fig" rid="pcbi.1005072.g008">Fig 8(A) and 8(B)</xref>. The PAC scores for SABEC and K-means are compared in C, illustrating that SABEC usually has more consistent outcomes than K-means, with the fewest ambiguously clustered cells at <italic>K</italic> = 7.</p>
<p>In addition, to estimate the accuracy of our method, we can assume that the expected cluster assignment (as determined by FACS) is our gold standard. By comparing the results of our clustering approach with the gold standard, we can estimate the accuracy of our method on the experimental data. To do this, we cluster each of our consensus matrices into five clusters using partitioning around medoids (PAM), a clustering approach similar to K-means (but more consistent since it uses data points as centres). We can then compare our results to the gold standard labels using metrics such as VI (See <xref ref-type="fig" rid="pcbi.1005072.g008">Fig 8D</xref>) and the corrected Rand index (See <xref ref-type="fig" rid="pcbi.1005072.g008">Fig 8E</xref>). SABEC performs better than K-means by these two metrics, with the estimated number of clusters equal to 6. The one exception is that the corrected Rand index suggests that K-means performs slightly better than SABEC when <italic>K</italic> = 5; however, SABEC provides substantially better outcomes at <italic>K</italic> = 6. Based on simulated datasets with values similar to the experimental data, we determined that these latter two methods provide more accurate estimates of the number of clusters than the PAC method, which can sometimes overestimate the appropriate number of clusters (<xref ref-type="supplementary-material" rid="pcbi.1005072.s008">S8 Fig</xref>).</p>
<p>Figs <xref ref-type="fig" rid="pcbi.1005072.g008">8F</xref> and <xref ref-type="fig" rid="pcbi.1005072.g002">2G</xref> compare the consensus matrices for <italic>K</italic> = 6 for SABEC (<italic>F</italic>) and K-means (<italic>G</italic>), with the cells sorted by their FACS-determined labels. SABEC results appear more consistent, with cells frequently clustering with other cells of the same type. In addition, any cells that are “misclassified” tend to cluster instead with cell populations of their parent or children populations. For instance, some HSC cells cluster with their child populations (PreM and LMPP), and some GMP and CLP cells cluster with their parent population (LMPP).</p>
<p>The R script for SABEC is available in Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/ezer/SingleCellPipelineOverview" xlink:type="simple">https://github.com/ezer/SingleCellPipelineOverview</ext-link>, including a sample input file to run in parallel on a Condor cluster, and appropriately merge the outputs.</p>
</sec>
<sec id="sec019">
<title>Parameters chosen for K-means and hierarchical clustering</title>
<p>The SABEC method was compared to hierarchical clustering and K-means approaches. The hierarchical clustering approach used was the default one associated with the heatmap function in R (Euclidean distance metric and complete clustering). The K-means approach used the default algorithm in R (Hartigan and Wong), but the maximum iterations was increased to 100 in order to be more comparable to the SABEC approach. K-means was repeated 50 times and an additional consensus clustering step was taken, in order to provide a fairer comparison to SABEC. Note that the input to both the hierarchical clustering and K-means algorithms were the normalised <italic>C</italic><sub><italic>t</italic></sub> values, while the input to SABEC is the scaled mRNA counts. These algorithm and distance metrics were chosen since they are the most commonly used. Other variations of hierarchical clustering and K-means were tested, but none of the results were significantly better or different than the ones shown.</p>
</sec>
<sec id="sec020">
<title>Estimation of Pairwise changes in Kinetics (EPiK)</title>
<p>The R script for determining which kinetic parameters vary across populations is available in Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/ezer/SingleCellPipelineOverview" xlink:type="simple">https://github.com/ezer/SingleCellPipelineOverview</ext-link>.</p>
<p>Three methods were tested on simulated datasets of genes with randomly selected kinetic parameters. We conducted these simulation tests for two different ranges of the kinetic parameters to illustrate that there is different sensitivity to parameter changes in different regions of the parameter space (<xref ref-type="supplementary-material" rid="pcbi.1005072.s012">S12</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005072.s013">S13</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005072.s014">S14</xref> Figs). These results suggest that changes in <italic>K</italic><sub><italic>off</italic></sub> cannot be accurately detected when <italic>K</italic><sub><italic>off</italic></sub> &gt; 5. In addition, the methods often performs better when fewer kinetic parameters change at once (<xref ref-type="supplementary-material" rid="pcbi.1005072.s012">S12</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005072.s017">S17</xref> Figs). The correctly identified simulated cases were those that have the largest magnitude of kinetic parameter change (<xref ref-type="supplementary-material" rid="pcbi.1005072.s018">S18 Fig</xref>) and had average kinetic parameter values closer to the origin, where the kinetic parameters are more accurately estimated (<xref ref-type="supplementary-material" rid="pcbi.1005072.s019">S19 Fig</xref>).</p>
<p>Two of the methods (MP and Subset methods), have continuous-valued outputs, and so a threshold must be set for determining whether or not a change in a kinetic parameter is likely significant. The thresholds were set to have approximately a 2% false positive rate, based on the <italic>in silico</italic> validation tests. The threshold values for the MP method when <italic>K</italic><sub><italic>off</italic></sub> &lt; 5 are −6.3, −8.5 and −6.8 for <italic>K</italic><sub><italic>on</italic></sub>, <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub>, and −4.9 and −6.0 for <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> when <italic>K</italic><sub><italic>off</italic></sub> &gt; 5. For the subset method, the thresholds are 0.77, 0.91 and 0.86 (<italic>K</italic><sub><italic>on</italic></sub>, <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub>, respectively) when <italic>K</italic><sub><italic>off</italic></sub> &lt; 5, and 0.681 and 0.870 (<italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub>) when <italic>K</italic><sub><italic>off</italic></sub> &gt; 5.</p>
<sec id="sec021">
<title>BICs-based method</title>
<p>There are eight possible parameter sets that could have varied across the two populations of cells for each TF (no parameters adjusted, all parameters adjusted, three cases with one parameter adjusted and three cases with two parameters adjusted). It is possible to calculate the maximum likelihood of each scenario occurring. Let us assume we have a matrix <italic>L</italic><sub><italic>p</italic>,<italic>m</italic></sub> that lists the likelihoods for each population of cells <italic>p</italic> = 1, 2 and parameter set in the lookup table <italic>m</italic> = 1 to <italic>356,000</italic>. The maximum likelihood score when no parameter is being adjusted is:
<disp-formula id="pcbi.1005072.e010"><alternatives><graphic id="pcbi.1005072.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi>m</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula></p>
<p>Meanwhile, the maximum likelihood score when all the parameters are being adjusted is:
<disp-formula id="pcbi.1005072.e011"><alternatives><graphic id="pcbi.1005072.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mrow><mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>l</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi>m</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi>m</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula></p>
<p>Clearly, <italic>L</italic><sub><italic>all</italic></sub> will always be greater than or equal to <italic>L</italic><sub><italic>none</italic></sub>. Therefore, we must adjust these likelihoods to take into account that fact that they involve different numbers of parameters being adjusted. This is done as follows:
<disp-formula id="pcbi.1005072.e012"><alternatives><graphic id="pcbi.1005072.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi> <mml:mi>I</mml:mi> <mml:mi>C</mml:mi></mml:mrow> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mi>L</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
Where <italic>i</italic> indices the set of parameters being adjusted, <italic>N</italic><sub><italic>i</italic></sub> is the number of parameters presumed adjusted, <italic>n</italic> is the number of cells and <italic>L</italic><sub><italic>i</italic></sub> is the likelihoods, for example, <italic>L</italic><sub><italic>none</italic></sub> or <italic>L</italic><sub><italic>all</italic></sub> calculated above.</p>
</sec>
<sec id="sec022">
<title>Marginal probability-based method</title>
<p>To calculate an MP score for <italic>K</italic><sub><italic>on</italic></sub>, let us make two matrices <italic>A</italic>(<italic>i</italic>, <italic>j</italic>) and <italic>B</italic>(<italic>i</italic>, <italic>j</italic>), one for each of the two populations of cells we are trying to compare. Each contains <italic>L</italic>(<italic>K</italic><sub><italic>on</italic></sub>, <italic>K</italic><sub><italic>off</italic></sub>, <italic>K</italic><sub><italic>t</italic></sub>|<italic>X</italic>), with <italic>i</italic> indexing the unique set of <italic>K</italic><sub><italic>on</italic></sub> values (with <italic>i</italic> = 1 to <italic>I</italic>) and <italic>j</italic> indexing a unique set of (<italic>K</italic><sub><italic>off</italic></sub>, <italic>K</italic><sub><italic>t</italic></sub>) pairs (with <italic>j</italic> = 1 to <italic>J</italic>).
<disp-formula id="pcbi.1005072.e013"><alternatives><graphic id="pcbi.1005072.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>I</mml:mi></mml:munderover> <mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>J</mml:mi></mml:munderover> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>A</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula> <disp-formula id="pcbi.1005072.e014"><alternatives><graphic id="pcbi.1005072.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:msup><mml:mi>A</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>J</mml:mi></mml:munderover> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula></p>
<p><italic>B</italic>′(<italic>i</italic>) can be calculated in the same way as <italic>A</italic>′(<italic>i</italic>).
<disp-formula id="pcbi.1005072.e015"><alternatives><graphic id="pcbi.1005072.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:mi>M</mml:mi> <mml:msub><mml:mi>P</mml:mi> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>I</mml:mi></mml:munderover> <mml:msup><mml:mi>e</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>A</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>B</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:msup></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula></p>
<p>However, it is important to implement this strategy in such a way as to minimize the rounding errors caused by taking the exponent of negative number with large magnitude. This can be accomplished thanks to the following statement:
<disp-formula id="pcbi.1005072.e016"><alternatives><graphic id="pcbi.1005072.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005072.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mi>a</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mi>b</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mi>x</mml:mi></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:mi>x</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula></p>
<p>By choosing <italic>x</italic> to be close to <italic>a</italic> or <italic>b</italic>, it is possible to avoid such errors. This strategy is employed in all the calculations above involving summing exponents.</p>
</sec>
<sec id="sec023">
<title>Subsetting method</title>
<p>In the third method, we repeatedly subsample 25% of the cells (100 times) and estimate the kinetic parameters for each subset. For each of the three options for the kinetic parameter, we calculate the absolute distance between the cumulative density functions of the two distributions, aka the Kolmogorov-Smirnov Statistic (<xref ref-type="supplementary-material" rid="pcbi.1005072.s014">S14 Fig</xref>). Note that we cannot use the p-values from the Kolmogorov-Smirnov test, because we re-sample points many times, so this statistic would be biased towards lower p-values. The threshold for the K-S statistic that was deemed significant was the one with a 2% false positive rate. Changing the size of the subsamples only had a small effect on the accuracy of this strategy (<xref ref-type="supplementary-material" rid="pcbi.1005072.s016">S16 Fig</xref>).</p>
</sec>
</sec>
</sec>
<sec id="sec024">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005072.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Parameter estimates for simulated data.</title>
<p>Subfigures A-C show parameter estimates for simulated parameter sets randomly drawn from 0 &lt; <italic>K</italic><sub><italic>on</italic></sub> &lt; 5, 0 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 10 and 0 &lt; <italic>K</italic><sub><italic>t</italic></sub> &lt; 600, for <italic>K</italic><sub><italic>on</italic></sub> (A), <italic>K</italic><sub><italic>off</italic></sub> (B) and <italic>K</italic><sub><italic>t</italic></sub> (C). Subfigures D-F show the same, but with 10 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 20, also for <italic>K</italic><sub><italic>on</italic></sub> (D), <italic>K</italic><sub><italic>off</italic></sub> (E) and <italic>K</italic><sub><italic>t</italic></sub> (F). Note that the known and estimated kinetic parameter values are all linearly correlated, except for <italic>K</italic><sub><italic>off</italic></sub> when it is greater than approximately 5.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Estimates of <italic>K</italic><sub><italic>t</italic></sub>/<italic>K</italic><sub><italic>off</italic></sub> ratios in simulated datasets.</title>
<p>These figures compare known and estimates <italic>K</italic><sub><italic>t</italic></sub>/<italic>K</italic><sub><italic>off</italic></sub> ratios for the same datasets depicted in <xref ref-type="supplementary-material" rid="pcbi.1005072.s001">S1 Fig</xref> with (A) depicting simulations where 0 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 10 and (B) depicting simulations where 10 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 20. In both cases, the known and estimated ratio of <italic>K</italic><sub><italic>t</italic></sub>/<italic>K</italic><sub><italic>off</italic></sub> is linearly correlated.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Parameter estimation with Gibb’s Sampling.</title>
<p>The kinetic parameters of the simulated datasets were estimated using the Gibb’s Sampling approach introduced by [<xref ref-type="bibr" rid="pcbi.1005072.ref012">12</xref>]. This method was designed for RNA-seq, so the gene <italic>length</italic> is a required input, but 10,000bp was included for all genes and all the mRNA counts were multiplied by this value. <italic>K</italic><sub><italic>on</italic></sub> is always between 0 and 5, and <italic>K</italic><sub><italic>t</italic></sub> is always between 0 and 600, and 90% of the mRNA molecules are randomly removed. Subfigures <italic>A-C</italic> are for simulations with 0 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 2, <italic>D-F</italic> are for 0 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 10 and <italic>G-I</italic> are for 10 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 20. <italic>K</italic><sub><italic>on</italic></sub> is estimated in subfigures <italic>A, D, G</italic>, <italic>K</italic><sub><italic>off</italic></sub> is estimated in subfigures <italic>B, E, H</italic> and <italic>K</italic><sub><italic>t</italic></sub> is estimated in subfigures <italic>C, F, I</italic>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Choosing the temperature parameter.</title>
<p>SABEC requires a choice of a temperature parameter (we chose 10 for most of this paper), which speeds convergence of the algorithm. 100 simulation datasets were clustered with SABEC (each repeated 50 times). The y-axes of <italic>A</italic> shows the average number of iterations before convergence across these 50 repeats. Convergence is defined as the number of iterations of the algorithm until fewer than 5% of the cells swapping clusters, but it is capped at a maximum of 100 iterations. The grey shaded area represents the full range of average values across all 100 simulated datasets and the black line represents the overall average number of iterations. This subfigure illustrates that the larger the temperature, the quicker the algorithm converges. Subfigures <italic>B,C</italic> illustrate how temperature influences the accuracy of the algorithm, as per the average variable information (VI) and corrected Rand index across all 100 simulated datasets. Both these metrics illustrate that the higher the temperature, the less accurate the algorithm. The aberration when the temperature parameter has a value of 6 comes from the fact that the number of iterations is capped at 100, so in some cases the algorithm did not fully converge. Note that we choose a temperature of 10 elsewhere in this paper.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Hierarchical clustering of hematopoietic stem cell and progenitor populations.</title>
<p>Here are the results of the hierarchical clustering of the normalised qPCR data, color coded the same way as <xref ref-type="fig" rid="pcbi.1005072.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Example results of SABEC for simulated dataset.</title>
<p>Out of the 100 simulated datasets that were generated, three examples are illustrated here, with their consensus matrices shown in subfigures <italic>A-C</italic> and the clustered heatmaps of these in <italic>D-F</italic>. These include the dataset that had the worst robustness by PAC score (<italic>A,D</italic>), the best robustness (<italic>C, F</italic>) and a randomly selected third example (<italic>B,E</italic>). The colours in <italic>D-F</italic> are blue for CLP, red for GMP, green for HSC, purple for LMPP and orange for PreM. Note that the clustering is more robust than the experimental dataset. In fact, manual inspection of 100 clusterings found no example of HSC being split into two clusters, while GMP/CLP being clustered together (the scenario observed in the experimental dataset), suggesting that the subdivision of HSC into two clusters is probably not an artifact of the SABEC method.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>SABEC applied to simulated datasets with different numbers of genes and cells.</title>
<p>First, we generated a list of 100 parameter sets that were randomly selected from a normal distribution around the experimentally determined kinetic parameter values, with a standard deviation equal to 5% of the parameter range in our look-up table (specifically, 0.25, 1 and 10, for <italic>K</italic><sub><italic>on</italic></sub>, <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> respectively). This created a kinetic parameter distribution that was similar to the distribution estimated for the experimental data by [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>]. For each simulated dataset, we randomly selected kinetic parameter sets from this list, varying the number of genes and the number of cells, but keeping the number of populations at 5. For each choice of number of genes and number of cells, we repeated this procedure with 5 different simulated datasets. In each case, the SABEC method was used to cluster the dataset (including the consensus clustering step). Subfigure <italic>A</italic> illustrates the variable information (VI) and <italic>B</italic> shows the corrected Rand index. Subfigure <italic>C</italic> shows the average number of iterations of SABEC until convergence.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Estimating K for simulated datasets.</title>
<p>We wished to determine how reliable PAC, VI and the corrected Rand index were at predicting the correct number of clusters when interpreting SABEC data. For instance, it could be that the SABEC method consistently causes there to appear to be more clusters than there actually are, which could mean that the division of HSC into two clusters is spurious. After predicting the number of clusters in the simulated datasets, with each of the 100 resulting curves drawn for PAC (<italic>A</italic>), VI (<italic>B</italic>) and the corrected Rand index (<italic>C</italic>), we see that PAC often predicts a spurious cluster, but VI and the correct Rand index do not. This is one of the reasons we selected <italic>K</italic> = 6, trusting VI and the corrected Rand index more than the PAC score.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>HSC subpopulations are separated before CLP/GMP populations separate.</title>
<p>Here we show clustered heatmaps of HSC (green), LMPP (purple) and PreM (orange) cells (<italic>A-C</italic>) and LMPP (purple), CLP (blue) and GMP (red) (<italic>D-F</italic>) for the number of clusters <italic>K</italic> = 5 (<italic>A,D</italic>), <italic>K</italic> = 6 (<italic>B, E</italic>) and <italic>K</italic> = 7 (<italic>C,F</italic>). Specifically note how the distinction between the two subpopulations of HSC is defined even in <italic>K</italic> = 5, but CLP and GMP are not distinguished until <italic>K</italic> = 6.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Comparison of parameter predictions before and after pruning.</title>
<p>Cells that did not cluster well with other cells of their labelled population were removed in a pruning step, because these cells may not have uniform gene expression bursting kinetics compared to the other cells in their population. However, we were worried whether this would create a consistent bias in the parameter estimates. The line of best fit is designated as the red dashed line. Subfigures <italic>A-D</italic> compare the original estimates of the kinetic parameters on the complete dataset with the parameter estimates for the pruned datasets in the [<xref ref-type="bibr" rid="pcbi.1005072.ref014">14</xref>] data, for <italic>K</italic><sub><italic>on</italic></sub> (<italic>A</italic>), <italic>K</italic><sub><italic>off</italic></sub>(<italic>B</italic>), <italic>K</italic><sub><italic>t</italic></sub>(<italic>C</italic>) and <italic>K</italic><sub><italic>t</italic></sub>/<italic>K</italic><sub><italic>off</italic></sub>(<italic>D</italic>). Subfigures <italic>E-H</italic> also compare the parameter estimate changes in the complete and pruned datasets, but for the 100 simulated datasets. Note that removing outliers does bias the kinetic parameter estimates, in the same direction as observed in the experimental data, but to a much smaller extent. In particular, estimated <italic>K</italic><sub><italic>on</italic></sub> parameters increase and <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> values decrease after the pruning procedure, in both cases.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s011" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Bias in kinetic parameter predictions can be caused my mixed cell types.</title>
<p>Another potential cause of the change in kinetic parameter estimates after pruning observed in <xref ref-type="fig" rid="pcbi.1005072.g004">Fig 4</xref> is that the pruning procedure correctly removed cells that did not have homogenous bursting kinetics. In this figure, we compare the kinetic parameter estimates when cell populations are mixed with cells of a different type to the kinetic parameter estimates when the cell populations are pure. For each of the 100 simulated datasets, 10 cells of each population were re-labelled as coming from an incorrect cell type. A comparison of the estimated kinetic parameters in the mixed and pure cell populations are shown for CLP (<italic>A</italic>–<italic>C</italic>), GMP (<italic>D</italic>–<italic>F</italic>), HSC (<italic>G</italic>–<italic>I</italic>), LMPP (<italic>J</italic>–<italic>L</italic>) and PreM (<italic>M</italic>–<italic>O</italic>). The red line designates the line-of-best fit. Note that the bias observed in <xref ref-type="supplementary-material" rid="pcbi.1005072.s010">S10 Fig</xref> is seen prominently here: <italic>K</italic><sub><italic>on</italic></sub> estimates are higher in mixed cell populations, while <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> estimates are lower, and the magnitude of the change is much more consistent with that seen in the experimental data. Nevertheless, we cannot neglect the fact that removing false negative cells can also bias the kinetic parameter estimates.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s012" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>BIC results for simulated datasets.</title>
<p>800 simulated datasets with <italic>K</italic><sub><italic>off</italic></sub> &lt; 5 (<italic>A</italic>) and 800 simulated datasets with 5 &lt; <italic>K</italic><sub><italic>off</italic></sub> &lt; 10 (<italic>B</italic>) were generated, with 100 examples of each possible type of kinetic parameter set change (x-axis). For each of these, BIC was used to predict the kinetic parameter change, as shown by the colors in the stacked bar plot. Grey represents the case that none of the parameters change and black represents the case that all the kinetic parameters change. The primary colors (red, blue, yellow) correspond with the case of one kinetic parameter changes (<italic>K</italic><sub><italic>on</italic></sub>, <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub>, respectively). The secondary colors correspond with the cases where two kinetic parameters change, with purple as <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>off</italic></sub>, orange as <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> and green as <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub>. Clearly, BIC enriches for the correct set of parameters, although it is a bit conservative when more than one kinetic parameter is varied. Note that when <italic>K</italic><sub><italic>off</italic></sub> &gt; 5, <italic>K</italic><sub><italic>off</italic></sub> is often mislabeled as <italic>none</italic> and sometimes as <italic>K</italic><sub><italic>t</italic></sub>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s013" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s013" xlink:type="simple">
<label>S13 Fig</label>
<caption>
<title>MP results for simulated datasets.</title>
<p>These are the ROC curves for <italic>K</italic><sub><italic>off</italic></sub> &lt; 5 (<italic>A</italic>–<italic>C</italic>) and <italic>K</italic><sub><italic>off</italic></sub> &gt; 5 (<italic>D</italic>–<italic>F</italic>), with the area under the curve (AUC) listed for each figure. Based on the high values of AUC, this method is predictive for <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub>, but less so for <italic>K</italic><sub><italic>off</italic></sub>. Note that predictive power for <italic>K</italic><sub><italic>off</italic></sub> completely disappears at higher values, although it does not seem to substantially increase <italic>K</italic><sub><italic>t</italic></sub> false positive rates.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s014" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s014" xlink:type="simple">
<label>S14 Fig</label>
<caption>
<title>Subset results for simulated datasets.</title>
<p>In black are the ROC curves for <italic>K</italic><sub><italic>off</italic></sub> &lt; 5 (<italic>A</italic>–<italic>C</italic>) and <italic>K</italic><sub><italic>off</italic></sub> &gt; 5 (<italic>D</italic>–<italic>F</italic>), with the area under the curve (AUC) listed for each figure. The corresponding MP ROC curves are drawn in grey for comparison. The results are fairly similar, although notably the results are worse than MP for <italic>K</italic><sub><italic>t</italic></sub> when <italic>K</italic><sub><italic>off</italic></sub> &gt; 5.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s015" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s015" xlink:type="simple">
<label>S15 Fig</label>
<caption>
<title>Distribution of kinetic parameter estimates under different methods.</title>
<p>These pie charts display the proportion of different kinetic parameter combinations deemed to have varied for each TF between pairs of populations of cells connected by lines in <xref ref-type="fig" rid="pcbi.1005072.g004">Fig 4(Bi)</xref>. The colors designate which kinetic parameter was adjusted, yellow for <italic>K</italic><sub><italic>t</italic></sub>, red for <italic>K</italic><sub><italic>on</italic></sub>, blue for <italic>K</italic><sub><italic>off</italic></sub>, orange for <italic>K</italic><sub><italic>t</italic></sub> and <italic>K</italic><sub><italic>on</italic></sub>, green for <italic>K</italic><sub><italic>t</italic></sub> and <italic>K</italic><sub><italic>off</italic></sub>, purple for <italic>K</italic><sub><italic>on</italic></sub> and <italic>K</italic><sub><italic>off</italic></sub>, grey for no changes and black for all parameters. Subfigures <italic>A</italic>–<italic>B</italic> are for BIC, <italic>C</italic>–<italic>D</italic> for marginal probability (MP) and <italic>E</italic>–<italic>F</italic> for the subset method (Sub). Each of the methods was applied to the dataset where potential outliers were pruned (<italic>A</italic>, <italic>C</italic> and <italic>E</italic>) and the complete datasets before the pruning step (<italic>B</italic>, <italic>D</italic> and <italic>F</italic>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s016" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s016" xlink:type="simple">
<label>S16 Fig</label>
<caption>
<title>Varying subsample size.</title>
<p>In order to determine whether the specificity and sensitivity of the method depends significantly on the size of the subsamples, we re-ran the subsample method, but sample half the cells (62) instead of a quarter of the cells, as shown in <xref ref-type="supplementary-material" rid="pcbi.1005072.s014">S14 Fig</xref>. The grey line still represents the ROC curve for the MP method. The AUC scores are similar across both subset sizes.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s017" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s017" xlink:type="simple">
<label>S17 Fig</label>
<caption>
<title>How assumptions about frequency of parameter changes influence accuracy of MP and subset method.</title>
<p>The simulated datasets which were used to test the accuracy of these three methods have an equal number of examples from each of the eight possible sets of parameters that can change. However, we saw in <xref ref-type="supplementary-material" rid="pcbi.1005072.s012">S12 Fig</xref> that BIC misses many true positives when more than one kinetic parameter varies. We wondered whether the accuracy of the MP and subset methods are influenced by the assumptions of the number of kinetic parameters that were varied. The black lines and corresponding black AUC values consider the 400 simulated datasets where only 0 or 1 kinetic parameters are varied, while the blue lines and blue AUC values consider the other 400 simulated datasets, where 2 or 3 kinetic parameters are varied. Subfigures <italic>A</italic>–<italic>C</italic> show the results for the MP method and <italic>D</italic>–<italic>E</italic> show the results for the subset method. In both cases, only the examples when with <italic>K</italic><sub><italic>off</italic></sub> &lt; 5 are shown. Estimates for <italic>K</italic><sub><italic>on</italic></sub> appear to be similar under both assumptions, but the estimates for <italic>K</italic><sub><italic>off</italic></sub> and <italic>K</italic><sub><italic>t</italic></sub> drop slightly when there are more kinetic parameters that vary (the blue line).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s018" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s018" xlink:type="simple">
<label>S18 Fig</label>
<caption>
<title>Influence of magnitude of kinetic parameter changes on sensitivity of the intersection method.</title>
<p>This histogram shows the full distribution of the magnitude of kinetic parameter variation among simulated datasets in which that kinetic parameter varied (positives) for <italic>K</italic><sub><italic>on</italic></sub> (<italic>A</italic>), <italic>K</italic><sub><italic>off</italic></sub> (B) and <italic>K</italic><sub><italic>t</italic></sub> (<italic>C</italic>). The samples that were correctly identified by the intersection of the three methods (the true positives) are shaded dark grey, while the false negatives are light grey. Note that the proportion of true positive values increases as the magnitude of the kinetic parameter change increases.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s019" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s019" xlink:type="simple">
<label>S19 Fig</label>
<caption>
<title>Influence of average kinetic parameter values on sensitivity of the intersection method.</title>
<p>This figure is parallel to <xref ref-type="supplementary-material" rid="pcbi.1005072.s018">S18 Fig</xref>, except instead of subtracting the two kinetic parameters assigned to the pair of populations, these two values are <italic>averaged</italic>. For <italic>K</italic><sub><italic>on</italic></sub> (A), <italic>K</italic><sub><italic>off</italic></sub> (B) and to a lesser extent <italic>K</italic><sub><italic>t</italic></sub> (C), there is a higher rate of detection when the values are closest to the origin, the region where the kinetic parameters are more easily discernible.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s020" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s020" xlink:type="simple">
<label>S20 Fig</label>
<caption>
<title>Effectiveness of experiments to up regulate GFI1 and down regulate GATA2.</title>
<p>These histograms depict the normalised Ct values for the GATA2 down regulation experiment (<italic>A</italic>), the GATA2 control HPC7 cells (<italic>B</italic>), the GFI1 up regulation experiment (<italic>C</italic>), and the GFI1 control HPC7 cells (<italic>D</italic>). The values where Ct is 15 are cells where there was no visible expression of the gene. GFI1 up regulation was successful for all of the cell, but GATA2 down regulation only slightly decreased its overall expression compared to the controls.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005072.s021" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005072.s021" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Single cell gene expression dataset.</title>
<p>This table includes the raw single cell gene cell qPCR data from HPC7 cells for the Gfi1 overexpression and Gata2 knockdown experiments.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank John Marioni for many helpful discussions, and Mark Calleja for his support with CamGrid.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005072.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ko</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nakauchi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>N</given-names></name>. <article-title>The dose dependence of glucocorticoid-inducible gene expression results from changes in the number of transcriptionally active templates</article-title>. <source>The EMBO journal</source>. <year>1990</year>;<volume>9</volume>(<issue>9</issue>):<fpage>2835</fpage>. <object-id pub-id-type="pmid">2167833</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Xiao</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ren</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Lao</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>XS</given-names></name>. <article-title>Probing gene expression in live cells, one protein molecule at a time</article-title>. <source>Science</source>. <year>2006</year>;<volume>311</volume>(<issue>5767</issue>):<fpage>1600</fpage>–<lpage>1603</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1119623" xlink:type="simple">10.1126/science.1119623</ext-link></comment> <object-id pub-id-type="pmid">16543458</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Muramoto</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cannon</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gierlinski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Corrigan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Barton</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Chubb</surname> <given-names>JR</given-names></name>. <article-title>Live imaging of nascent RNA dynamics reveals distinct types of transcriptional pulse regulation</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2012</year> <month>May</month>;<volume>109</volume>(<issue>19</issue>):<fpage>7350</fpage>–<lpage>7355</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1117603109" xlink:type="simple">10.1073/pnas.1117603109</ext-link></comment> <object-id pub-id-type="pmid">22529358</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suter</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Molina</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Gatfield</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Schibler</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Naef</surname> <given-names>F</given-names></name>. <article-title>Mammalian genes are transcribed with widely different bursting kinetics</article-title>. <source>Science</source>. <year>2011</year> <month>Apr</month>;<volume>332</volume>(<issue>6028</issue>):<fpage>472</fpage>–<lpage>474</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1198817" xlink:type="simple">10.1126/science.1198817</ext-link></comment> <object-id pub-id-type="pmid">21415320</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dar</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Razooky</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Trimeloni</surname> <given-names>TV</given-names></name>, <name name-style="western"><surname>McCollum</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Cox</surname> <given-names>CD</given-names></name>, <etal>et al</etal>. <article-title>Transcriptional burst frequency and burst size are equally modulated across the human genome</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>43</issue>):<fpage>17454</fpage>–<lpage>17459</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1213530109" xlink:type="simple">10.1073/pnas.1213530109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ko</surname> <given-names>MS</given-names></name>. <article-title>A stochastic model for gene induction</article-title>. <source>Journal of Theoretical Biology</source>. <year>1991</year>;<volume>153</volume>(<issue>2</issue>):<fpage>181</fpage>–<lpage>194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0022-5193(05)80421-7" xlink:type="simple">10.1016/S0022-5193(05)80421-7</ext-link></comment> <object-id pub-id-type="pmid">1787735</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Peccoud</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ycart</surname> <given-names>B</given-names></name>. <article-title>Markovian modeling of gene-product synthesis</article-title>. <source>Theoretical population biology</source>. <year>1995</year>;<volume>48</volume>(<issue>2</issue>):<fpage>222</fpage>–<lpage>234</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/tpbi.1995.1027" xlink:type="simple">10.1006/tpbi.1995.1027</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Mao</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Falkovskaia</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Jurica</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Boeger</surname> <given-names>H</given-names></name>. <article-title>Linking stochastic fluctuations in chromatin structure and gene expression</article-title>. <source>PLoS Biol</source>. <year>2013</year>;<volume>11</volume>(<issue>8</issue>):<fpage>e1001621</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1001621" xlink:type="simple">10.1371/journal.pbio.1001621</ext-link></comment> <object-id pub-id-type="pmid">23940458</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dadiani</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>van Dijk</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Segal</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Field</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ben-Artzi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Raveh-Sadka</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Two DNA-encoded strategies for increasing expression with opposing effects on promoter dynamics and transcriptional noise</article-title>. <source>Genome research</source>. <year>2013</year>;<volume>23</volume>(<issue>6</issue>):<fpage>966</fpage>–<lpage>976</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.149096.112" xlink:type="simple">10.1101/gr.149096.112</ext-link></comment> <object-id pub-id-type="pmid">23403035</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pennington</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Marr</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Chirn</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Marr</surname> <given-names>MT</given-names></name>. <article-title>Holo-TFIID controls the magnitude of a transcription burst and fine-tuning of transcription</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>19</issue>):<fpage>7678</fpage>–<lpage>7683</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1221712110" xlink:type="simple">10.1073/pnas.1221712110</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raj</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Peskin</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Tranchina</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Vargas</surname> <given-names>DY</given-names></name>, <name name-style="western"><surname>Tyagi</surname> <given-names>S</given-names></name>. <article-title>Stochastic mRNA synthesis in mammalian cells</article-title>. <source>PLoS Biol</source>. <year>2006</year> <month>Oct</month>;<volume>4</volume>(<issue>10</issue>):<fpage>e309</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0040309" xlink:type="simple">10.1371/journal.pbio.0040309</ext-link></comment> <object-id pub-id-type="pmid">17048983</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Marioni</surname> <given-names>JC</given-names></name>. <article-title>Inferring the kinetics of stochastic gene expression from single-cell RNA-sequencing data</article-title>. <source>Genome Biol</source>. <year>2013</year> <month>Jan</month>;<volume>14</volume>(<issue>1</issue>):<fpage>R7</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2013-14-1-r7" xlink:type="simple">10.1186/gb-2013-14-1-r7</ext-link></comment> <object-id pub-id-type="pmid">23360624</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Teles</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pina</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ohlsson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Enver</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>C</given-names></name>. <article-title>Transcriptional regulation of lineage commitment–a stochastic model of cell fate decisions</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year> <month>Aug</month>;<volume>9</volume>(<issue>8</issue>):<fpage>e1003197</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003197" xlink:type="simple">10.1371/journal.pcbi.1003197</ext-link></comment> <object-id pub-id-type="pmid">23990771</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moignard</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Macaulay</surname> <given-names>IC</given-names></name>, <name name-style="western"><surname>Swiers</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Buettner</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Schütte</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Calero-Nieto</surname> <given-names>FJ</given-names></name>, <etal>et al</etal>. <article-title>Characterization of transcriptional networks in blood stem and progenitor cells using high-throughput single-cell gene expression analysis</article-title>. <source>Nat Cell Biol</source>. <year>2013</year> <month>Apr</month>;<volume>15</volume>(<issue>4</issue>):<fpage>363</fpage>–<lpage>372</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncb2709" xlink:type="simple">10.1038/ncb2709</ext-link></comment> <object-id pub-id-type="pmid">23524953</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Guo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Luc</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Marco</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>TW</given-names></name>, <name name-style="western"><surname>Peng</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kerenyi</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Mapping cellular hierarchy by single-cell analysis of the cell surface repertoire</article-title>. <source>Cell Stem Cell</source>. <year>2013</year> <month>Oct</month>;<volume>13</volume>(<issue>4</issue>):<fpage>492</fpage>–<lpage>505</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.stem.2013.07.017" xlink:type="simple">10.1016/j.stem.2013.07.017</ext-link></comment> <object-id pub-id-type="pmid">24035353</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Foster</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Knezevic</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Schütte</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kaimakis</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Combinatorial transcriptional control in blood stem/progenitor cells: genome-wide analysis of ten major transcriptional regulators</article-title>. <source>Cell stem cell</source>. <year>2010</year>;<volume>7</volume>(<issue>4</issue>):<fpage>532</fpage>–<lpage>544</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.stem.2010.07.016" xlink:type="simple">10.1016/j.stem.2010.07.016</ext-link></comment> <object-id pub-id-type="pmid">20887958</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Arinobu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Mizuno</surname> <given-names>Si</given-names></name>, <name name-style="western"><surname>Chong</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shigematsu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Iino</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Iwasaki</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Reciprocal activation of GATA-1 and PU. 1 marks initial specification of hematopoietic stem cells into myeloerythroid and myelolymphoid lineages</article-title>. <source>Cell stem cell</source>. <year>2007</year>;<volume>1</volume>(<issue>4</issue>):<fpage>416</fpage>–<lpage>427</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.stem.2007.07.004" xlink:type="simple">10.1016/j.stem.2007.07.004</ext-link></comment> <object-id pub-id-type="pmid">18371378</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shin</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Naramura</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>CY</given-names></name>. <article-title>High c-Kit expression identifies hematopoietic stem cells with impaired self-renewal and megakaryocytic bias</article-title>. <source>The Journal of experimental medicine</source>. <year>2014</year>;<volume>211</volume>(<issue>2</issue>):<fpage>217</fpage>–<lpage>231</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1084/jem.20131128" xlink:type="simple">10.1084/jem.20131128</ext-link></comment> <object-id pub-id-type="pmid">24446491</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chyla</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Moreno-Miralles</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Steapleton</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Bhaskara</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Engel</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Deletion of Mtg16, a target of t (16; 21), alters hematopoietic progenitor cell proliferation and lineage allocation</article-title>. <source>Molecular and cellular biology</source>. <year>2008</year>;<volume>28</volume>(<issue>20</issue>):<fpage>6234</fpage>–<lpage>6247</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/MCB.00404-08" xlink:type="simple">10.1128/MCB.00404-08</ext-link></comment> <object-id pub-id-type="pmid">18710942</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Okuno</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Radomska</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>Hm</given-names></name>, <name name-style="western"><surname>Iwasaki</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Regulation of the PU. 1 gene by distal elements</article-title>. <source>Blood</source>. <year>2001</year>;<volume>98</volume>(<issue>10</issue>):<fpage>2958</fpage>–<lpage>2965</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1182/blood.V98.10.2958" xlink:type="simple">10.1182/blood.V98.10.2958</ext-link></comment> <object-id pub-id-type="pmid">11698277</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pinto do O</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kolterud</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlsson</surname> <given-names>L</given-names></name>. <article-title>Expression of the LIM-homeobox gene LH2 generates immortalized steel factor-dependent multipotent hematopoietic precursors</article-title>. <source>EMBO J</source>. <year>1998</year> <month>Oct</month>;<volume>17</volume>(<issue>19</issue>):<fpage>5744</fpage>–<lpage>5756</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/emboj/17.19.5744" xlink:type="simple">10.1093/emboj/17.19.5744</ext-link></comment> <object-id pub-id-type="pmid">9755174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van der Meer</surname> <given-names>LT</given-names></name>, <name name-style="western"><surname>Jansen</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>van der Reijden</surname> <given-names>BA</given-names></name>. <article-title>Gfi1 and Gfi1b: key regulators of hematopoiesis</article-title>. <source>Leukemia</source>. <year>2010</year> <month>Nov</month>;<volume>24</volume>(<issue>11</issue>):<fpage>1834</fpage>–<lpage>1843</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/leu.2010.195" xlink:type="simple">10.1038/leu.2010.195</ext-link></comment> <object-id pub-id-type="pmid">20861919</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sánchez-Castillo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ruau</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wilkinson</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Ng</surname> <given-names>FSL</given-names></name>, <name name-style="western"><surname>Hannah</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Diamanti</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>CODEX: a next-generation sequencing experiment database for the haematopoietic and embryonic stem cell communities</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year> <month>Jan</month>;<volume>43</volume>(<issue>Database issue</issue>):<fpage>D1117</fpage>–<lpage>D1123</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gku895" xlink:type="simple">10.1093/nar/gku895</ext-link></comment> <object-id pub-id-type="pmid">25270877</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mollica</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>Crawley</surname> <given-names>JTB</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Rance</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Cockerill</surname> <given-names>PN</given-names></name>, <name name-style="western"><surname>Follows</surname> <given-names>GA</given-names></name>, <etal>et al</etal>. <article-title>Role of a 5’-enhancer in the transcriptional regulation of the human endothelial cell protein C receptor gene</article-title>. <source>Blood</source>. <year>2006</year> <month>Aug</month>;<volume>108</volume>(<issue>4</issue>):<fpage>1251</fpage>–<lpage>1259</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1182/blood-2006-02-001461" xlink:type="simple">10.1182/blood-2006-02-001461</ext-link></comment> <object-id pub-id-type="pmid">16627757</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krivtsov</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Twomey</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Stubbs</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Faber</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Transformation from committed progenitor to leukaemia stem cell initiated by MLL–AF9</article-title>. <source>Nature</source>. <year>2006</year>;<volume>442</volume>(<issue>7104</issue>):<fpage>818</fpage>–<lpage>822</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature04980" xlink:type="simple">10.1038/nature04980</ext-link></comment> <object-id pub-id-type="pmid">16862118</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Efremov</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Bomben</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gobessi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gattei</surname> <given-names>V</given-names></name>. <article-title>TLR9 signaling defines distinct prognostic subsets in CLL</article-title>. <source>Front Biosci (Landmark Ed)</source>. <year>2013</year>;<volume>18</volume>:<fpage>371</fpage>–<lpage>386</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2741/4108" xlink:type="simple">10.2741/4108</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buettner</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Natarajan</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Casale</surname> <given-names>FP</given-names></name>, <name name-style="western"><surname>Proserpio</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Scialdone</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>FJ</given-names></name>, <etal>et al</etal>. <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>. <source>Nat Biotechnol</source>. <year>2015</year> <month>Feb</month>;<volume>33</volume>(<issue>2</issue>):<fpage>155</fpage>–<lpage>160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.3102" xlink:type="simple">10.1038/nbt.3102</ext-link></comment> <object-id pub-id-type="pmid">25599176</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhou</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>. <article-title>Analytical results for a multistate gene model</article-title>. <source>SIAM Journal on Applied Mathematics</source>. <year>2012</year>;<volume>72</volume>(<issue>3</issue>):<fpage>789</fpage>–<lpage>818</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/110852887" xlink:type="simple">10.1137/110852887</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Narula</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Gottgens</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Igoshin</surname> <given-names>OA</given-names></name>. <article-title>Modeling reveals bistability and low-pass filtering in the network module determining blood stem cell fate</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year> <month>May</month>;<volume>6</volume>(<issue>5</issue>):<fpage>e1000771</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000771" xlink:type="simple">10.1371/journal.pcbi.1000771</ext-link></comment> <object-id pub-id-type="pmid">20463872</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bot</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Van Eck</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Van Santbrink</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Groot</surname> <given-names>PH</given-names></name>, <name name-style="western"><surname>Hildebrand</surname> <given-names>RB</given-names></name>, <etal>et al</etal>. <article-title>Lentiviral shRNA silencing of murine bone marrow cell CCR2 leads to persistent knockdown of CCR2 function in vivo</article-title>. <source>Blood</source>. <year>2005</year>;<volume>106</volume>(<issue>4</issue>):<fpage>1147</fpage>–<lpage>1153</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1182/blood-2004-12-4839" xlink:type="simple">10.1182/blood-2004-12-4839</ext-link></comment> <object-id pub-id-type="pmid">15886324</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Dore</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Orkin</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>GATA-2 reinforces megakaryocyte development in the absence of GATA-1</article-title>. <source>Mol Cell Biol</source>. <year>2009</year> <month>Sep</month>;<volume>29</volume>(<issue>18</issue>):<fpage>5168</fpage>–<lpage>5180</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/MCB.00482-09" xlink:type="simple">10.1128/MCB.00482-09</ext-link></comment> <object-id pub-id-type="pmid">19620289</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Senbabaoglu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Michailidis</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>JZ</given-names></name>. <article-title>Critical limitations of consensus clustering in class discovery</article-title>. <source>Sci Rep</source>. <year>2014</year>;<volume>4</volume>:<fpage>6207</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/srep06207" xlink:type="simple">10.1038/srep06207</ext-link></comment> <object-id pub-id-type="pmid">25158761</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Islam</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zeisel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Joost</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>La Manno</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Zajac</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kasper</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>. <source>Nature methods</source>. <year>2014</year>;<volume>11</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>166</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2772" xlink:type="simple">10.1038/nmeth.2772</ext-link></comment> <object-id pub-id-type="pmid">24363023</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005072.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wu</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Neff</surname> <given-names>NF</given-names></name>, <name name-style="western"><surname>Kalisky</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Dalerba</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Treutlein</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Rothenberg</surname> <given-names>ME</given-names></name>, <etal>et al</etal>. <article-title>Quantitative assessment of single-cell RNA-sequencing methods</article-title>. <source>Nature methods</source>. <year>2014</year>;<volume>11</volume>(<issue>1</issue>):<fpage>41</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2694" xlink:type="simple">10.1038/nmeth.2694</ext-link></comment> <object-id pub-id-type="pmid">24141493</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>