<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="pmc">plosone</journal-id>
      <journal-title-group>
        <journal-title>PLoS ONE</journal-title>
      </journal-title-group>
      <issn pub-type="epub">1932-6203</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PONE-D-12-25496</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pone.0054383</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Computational neuroscience</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Neuroscience</subject>
            <subj-group>
              <subject>Computational neuroscience</subject>
              <subject>Neural networks</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Systems biology</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
          <subj-group>
            <subject>Computer modeling</subject>
          </subj-group>
          <subj-group>
            <subject>Computerized simulations</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied mathematics</subject>
            <subj-group>
              <subject>Complex systems</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Physics</subject>
          <subj-group>
            <subject>Interdisciplinary physics</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Computational Biology</subject>
          <subject>Neuroscience</subject>
          <subject>Computer Science</subject>
          <subject>Physics</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Spectral Characterization of Hierarchical Network Modularity and Limits of Modularity Detection</article-title>
        <alt-title alt-title-type="running-head">Spectral Limits of Network Hierarchical-Modularity</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Sarkar</surname>
            <given-names>Somwrita</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Henderson</surname>
            <given-names>James A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Robinson</surname>
            <given-names>Peter A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <label>1</label>
        <addr-line>School of Physics, University of Sydney, Sydney, New South Wales, Australia</addr-line>
      </aff>
      <aff id="aff2">
        <label>2</label>
        <addr-line>Brain Dynamics Center, Sydney Medical School – Western, University of Sydney, Westmead, New South Wales, Australia</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Gomez-Gardenes</surname>
            <given-names>Jesus</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>Universidad de Zarazoga, Spain</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">sarkar@physics.usyd.edu.au</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Contributed reagents/materials/analysis tools: SS JAH PAR. Wrote the paper: SS JAH PAR.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <year>2013</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>28</day>
        <month>1</month>
        <year>2013</year>
      </pub-date>
      <volume>8</volume>
      <issue>1</issue>
      <elocation-id>e54383</elocation-id>
      <history>
        <date date-type="received">
          <day>23</day>
          <month>8</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>11</day>
          <month>12</month>
          <year>2012</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2013</copyright-year>
        <copyright-holder>Sarkar et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>Many real world networks are reported to have hierarchically modular organization. However, there exists no algorithm-independent metric to characterize hierarchical modularity in a complex system. The main results of the paper are a set of methods to address this problem. First, classical results from random matrix theory are used to derive the spectrum of a typical stochastic block model hierarchical modular network form. Second, it is shown that hierarchical modularity can be fingerprinted using the spectrum of its largest eigenvalues and gaps between clusters of closely spaced eigenvalues that are well separated from the bulk distribution of eigenvalues around the origin. Third, some well-known results on fingerprinting non-hierarchical modularity in networks automatically follow as special cases, threreby unifying these previously fragmented results. Finally, using these spectral results, it is found that the limits of detection of modularity can be empirically established by studying the mean values of the largest eigenvalues and the limits of the bulk distribution of eigenvalues for an ensemble of networks. It is shown that even when modularity and hierarchical modularity are present in a weak form in the network, they are impossible to detect, because some of the leading eigenvalues fall within the bulk distribution. This provides a threshold for the detection of modularity. Eigenvalue distributions of some technological, social, and biological networks are studied, and the implications of detecting hierarchical modularity in real world networks are discussed.</p>
      </abstract>
      <funding-group>
        <funding-statement>The Australian Research Council and Westmead Millenium Institute supported this work. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="11"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Many real world networks have been reported to have modular or hierarchical modular organization, including social networks <xref ref-type="bibr" rid="pone.0054383-Fortunato1">[1]</xref>, collaboration networks <xref ref-type="bibr" rid="pone.0054383-Fortunato1">[1]</xref>, biological networks such as structural and functional brain networks <xref ref-type="bibr" rid="pone.0054383-Sporns1">[2]</xref>–<xref ref-type="bibr" rid="pone.0054383-Meunier2">[5]</xref>, metabolic networks <xref ref-type="bibr" rid="pone.0054383-Ravasz1">[6]</xref>, and gene expression networks <xref ref-type="bibr" rid="pone.0054383-Trevino1">[7]</xref>, and technological networks such as the Internet, the World Wide Web, and the global air transportation network <xref ref-type="bibr" rid="pone.0054383-Fortunato1">[1]</xref>. Reliably detecting the hierarchical and modular organization of complex systems provides us with a way to understand how their microscale structure scales up to the macroscale, and how the system is able to perform specific behaviors and functions.</p>
      <p>Despite the importance of hierarchy and modularity, there exists no algorithm-independent way to characterize how “hierarchically modular” a network is. Since detection of modularity is dependent upon the assumptions made in specific modularity detection algorithms, these assumptions significantly affect the results. For example, a modularity detection algorithm that is based on strict graph partitioning techniques will fail to find overlaps between communities and hierarchical organization, unless specifically modified. In addition, there are many algorithms that will find optimal partitions in networks with no modularity. For example, an algorithm that is designed to locate optimal partitions will do so even for nonmodular networks. Second, many of the algorithms are based on optimizing the modularity metric <italic>Q</italic> <xref ref-type="bibr" rid="pone.0054383-Fortunato1">[1]</xref>, <xref ref-type="bibr" rid="pone.0054383-Newman1">[8]</xref>, which is computed for a particular division of a network into communities by comparing this division to that of a null reference model – a random graph with the same size and degree distribution, but no community structure. The modularity metric <italic>Q</italic> has been shown to suffer from a resolution limit problem, meaning that it cannot detect the smallest size communities relative to network size <xref ref-type="bibr" rid="pone.0054383-Fortunato2">[9]</xref>. Further, the computation of <italic>Q</italic> requires that the network first be divided into modules before it can be evaluated, and provides no information on the uniqueness of the postulated modules; i.e., which solution should be preferred if two solutions have the same <italic>Q</italic> value. Further, no such well accepted metric exists for measurement of hierarchical modularity in networks, although there exist some modularity detection algorithms based on quantifying the quality of hierarchical modularity and partitions in network structure <xref ref-type="bibr" rid="pone.0054383-Lancechinetti1">[10]</xref>.</p>
      <p>In this paper, the main results are a set of methods to address the above gap. We present an algorithm-independent manner of characterizing network modularity. We use results from random matrix theory and spectral graph theory to derive the spectrum of eigenvalues for hierarchically modular networks generated using a stochastic block model and show that the spectrum contains clear fingerprints of hierarchical modularity. Further, we rederive some known results about the spectra of modular networks, which are simply shown to be a special case of hierarchically modular networks with a single hierarchical level. Using the spectral results, we empirically derive the limits of modularity detection; i.e., a way to compare the degree of modularity that actually exists in the network, versus its actual detectability, by varying the degree of probabilities of instantiating edges at various hierarchical levels. It is shown that even when modularity and hierarchical modularity are present in a sufficiently weak form in the network, it is impossible to detect them, because some of the leading eigenvalues fall within the bulk distribution of eigenvalues around the origin and are no more separated from it. The point at which this happens is estimated in terms of the edge instantiation probabilities, and sets a threshold beyond which modularity cannot be detected even when present in the network. Eigenvalue distributions of some technological, social, and biological networks are studied, and the implications of detecting hierarchical modularity in real world networks are discussed.</p>
      <p>Some previous work <xref ref-type="bibr" rid="pone.0054383-Fortunato2">[9]</xref> and a very recent study <xref ref-type="bibr" rid="pone.0054383-Nadakuditi1">[11]</xref> has shown a similar result for modular networks (a subcase in our work), but not hierarchically modular networks, thereby making the results in this paper more general. They derived analytical results for the threshold of modularity detection in undirected, modular graphs. Our findings agree with their results, but our results in this paper are valid for both directed and undirected graphs, and we include hierarchical modularity. Modular networks are shown as a special case of the general framework. The work in <xref ref-type="bibr" rid="pone.0054383-Nadakuditi1">[11]</xref> asserted that the spectral signatures of modularity detection are optimal in the sense that no other method can detect modularity in a regime where the spectral methods fail. This establishes that the results we present in this paper on the limits of modularity detection are general in the sense that if the spectral fingerprint fails to detect weak forms of modularity in a network, then any of the current methods and algorithms using spectral approaches for modularity detection are likely to be unable to detect it.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <p>In this section, we derive and illustrate the methods that constitute the main results of this paper. Our main results are (i) derivation of the spectrum of hierarchically modular graphs; i.e., the mean expected values of the largest eigenvalues of the adjacency matrix of the graph, (ii) establishing the limits of “how modular” a real world system is through a study of the properties of the spectrum and its distribution, and (iii) establishing the limits of detection of hierarchical modularity and modularity as permitted by the spectral approach; i.e., given the amount or degree of modularity, how much of this modularity can (or cannot) be detected using the spectral approach.</p>
      <p>Thus, in this work, we characterize the hierarchical modularity of a network in an algorithm-independent manner. The spectrum of modular networks with no hierarchy is shown to be a special case of the framework, and some known results on the spectrum of modular networks are thus automatically reproduced, thereby providing a unified basis to characterize network modularity in general. Finally, we empirically show that when probability parameters for instantiating edges in networks are varied, there is a threshold set by the probabilities and the limits of the bulk distribution of eigenvalues around the origin beyond which hierarchical modularity and modularity cannot be detected even if present.</p>
      <sec id="s2a">
        <title>Spectrum of Hierarchically Modular Networks</title>
        <p>We follow a typical stochastic block model form for contructing a hierarchical network, similar to <xref ref-type="bibr" rid="pone.0054383-Robinson1">[12]</xref>. This process involves construction of a hierarchically modular network by recursively placing random matrix blocks with decreasing levels of connecitivity between nodes in hierarchical levels in a block diagonal form. We consider the matrix<disp-formula id="pone.0054383.e001"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e001" xlink:type="simple"/><label>(1)</label></disp-formula>where <bold>A</bold> is a random network of size <italic>s</italic> and edge probability <italic>p</italic>, and <bold>P</bold> is a random network of size <italic>s</italic> and edge probability <italic>pq</italic>. Here, the parameter <italic>q</italic> sets the level of decrease in connectivity between the various hierarchical levels. That is, <italic>q</italic> is a numeric parameter which is varied to define the connectivity of the first level hierarchy off-diagonal blocks or networks represented by <bold>P</bold>. For example, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e002" xlink:type="simple"/></inline-formula>, then the connectivity in <bold>P</bold> is 50% of the connectivity in <bold>A</bold>. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e003" xlink:type="simple"/></inline-formula>, the network will no longer be hierarchical, but will simply be a random network of size 2<italic>s</italic> with connection probability <italic>p</italic> (since, in this case, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e004" xlink:type="simple"/></inline-formula>). It is clear from the formulation that lower the value of <italic>q</italic>, stronger the hierarchical modular structure, and higher the value of <italic>q</italic> (to 1), weaker the hierarchical modular structure. This point is important in the following section on establishing the limits of detection of modularity. We know from the random matrix theorems established in <italic>Methods</italic> that the expected value of the largest eigenvalue of <bold>A</bold> is <italic>sp</italic> and that of <bold>P</bold> is <italic>spq</italic>. We thus rewrite <bold>A′</bold> as a sum of deterministic matrices <bold>A</bold><italic><sup>E</sup></italic> and <bold>P</bold><italic><sup>E</sup></italic> with entries <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e005" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e006" xlink:type="simple"/></inline-formula>, respectively, and a matrix of fluctuations around these means, obtaining</p>
        <p><disp-formula id="pone.0054383.e007"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e007" xlink:type="simple"/><label>(2)</label></disp-formula>The spectrum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e008" xlink:type="simple"/></inline-formula> can now be decribed by independently describing the spectra of matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e010" xlink:type="simple"/></inline-formula>.</p>
        <p>First, it can be easily proved that the deterministic matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e011" xlink:type="simple"/></inline-formula> has the eigenvalue distribution<disp-formula id="pone.0054383.e012"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e012" xlink:type="simple"/><label>(3)</label></disp-formula>and it gives us the mean expected values of the largest two eigenvalues and the mean value of rest of the bulk distribution of eigenvalues of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e013" xlink:type="simple"/></inline-formula>. Consider a vector of the form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e014" xlink:type="simple"/></inline-formula>, where the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e015" xlink:type="simple"/></inline-formula> vectors have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e016" xlink:type="simple"/></inline-formula> entries each. Then,</p>
        <p>
          <disp-formula id="pone.0054383.e017">
            <graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e017" xlink:type="simple"/>
            <label>(4)</label>
          </disp-formula>
          <inline-formula>
            <inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e018" xlink:type="simple"/>
          </inline-formula>
        </p>
        <p>Thus, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e019" xlink:type="simple"/></inline-formula> is an eigenvector of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e020" xlink:type="simple"/></inline-formula> with the eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e021" xlink:type="simple"/></inline-formula>. Similarly, consider vectors of the form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e022" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e023" xlink:type="simple"/></inline-formula>, again with vectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e024" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e025" xlink:type="simple"/></inline-formula> of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e026" xlink:type="simple"/></inline-formula>. Then, by similar reasoning as above, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e027" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e028" xlink:type="simple"/></inline-formula> can be shown to be eigenvectors of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e029" xlink:type="simple"/></inline-formula> with eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e030" xlink:type="simple"/></inline-formula>. The other eigenvalues will all be 0.</p>
        <p>Next we consider the spectrum of the fluctuation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e031" xlink:type="simple"/></inline-formula>. The expectation value of the entries of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e032" xlink:type="simple"/></inline-formula> is 0 by definition, since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e033" xlink:type="simple"/></inline-formula>. Thus, by Eq.(20), (see <italic>Methods</italic>) the spectrum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e034" xlink:type="simple"/></inline-formula> has a zero mean value, and all its eigenvalues are bounded by the spread limit <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e035" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e036" xlink:type="simple"/></inline-formula> stands for the standard deviation of the values in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e037" xlink:type="simple"/></inline-formula>. This <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e038" xlink:type="simple"/></inline-formula> gives us the spread of the bulk distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e039" xlink:type="simple"/></inline-formula> with zero mean.</p>
        <p>Thus, putting together the above results, the spectrum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e040" xlink:type="simple"/></inline-formula> is<disp-formula id="pone.0054383.e041"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e041" xlink:type="simple"/><label>(6)</label></disp-formula>showing that there will be two large eigenvalues separated from a bulk distribution of eigenvalues around the origin. <xref ref-type="fig" rid="pone-0054383-g001">Figure 1</xref> shows examples of the actual eigenvalues and analytical predictions by Eq. (3) along with the actual eigenvalues of the fluctuation matrix.</p>
        <fig id="pone-0054383-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0054383.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>First level hierarchical network spectrum.</title>
            <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e042" xlink:type="simple"/></inline-formula> node network, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e043" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e044" xlink:type="simple"/></inline-formula>, Black circles (below green circles) show actual spectrum. Red circles, centred on the point, show analytic prediction of mean expected eigenvalues from Eq. (3). Green circles show distribution of eigenvalues of the fluctuation matrix.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054383.g001" position="float" xlink:type="simple"/>
        </fig>
        <p>We now define the second level of perturbation, where<disp-formula id="pone.0054383.e045"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e045" xlink:type="simple"/><label>(7)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e046" xlink:type="simple"/></inline-formula> is the matrix defined in Eq. (1) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e047" xlink:type="simple"/></inline-formula> is a random network or matrix of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e048" xlink:type="simple"/></inline-formula> and edge probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e049" xlink:type="simple"/></inline-formula>. Note here the second hierarchical level: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e050" xlink:type="simple"/></inline-formula> already has the first level of hierarchy built in as described previously, with the first level off-diagonal blocks having connectivity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e051" xlink:type="simple"/></inline-formula> and the diagonal blocks having connectivity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e052" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e053" xlink:type="simple"/></inline-formula>. Now, the second level off-digonal blocks, represented by matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e054" xlink:type="simple"/></inline-formula>, have connectivity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e055" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e056" xlink:type="simple"/></inline-formula>. In general, the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e057" xlink:type="simple"/></inline-formula> defines each successive level <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e058" xlink:type="simple"/></inline-formula> of perturbations of increasing size (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e059" xlink:type="simple"/></inline-formula>) and decreasing probability of connection (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e060" xlink:type="simple"/></inline-formula>), producing an extra level of hierarchical modular structure with each perturbation level.</p>
        <p>Once again, we define this matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e061" xlink:type="simple"/></inline-formula> as a sum of a deterministic matrix and a fluctuation matrix in a form similar to described above, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e062" xlink:type="simple"/></inline-formula>. The mean expected values of the eigenvalues of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e063" xlink:type="simple"/></inline-formula>, using similar analysis as before, are shown to be<disp-formula id="pone.0054383.e064"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e064" xlink:type="simple"/><label>(8)</label></disp-formula></p>
        <p>In general, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e065" xlink:type="simple"/></inline-formula> hierarchical levels, the expectation values of the eigenvalues of a hierarchical network <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e066" xlink:type="simple"/></inline-formula>, along with their multiplicities, are<disp-formula id="pone.0054383.e067"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e067" xlink:type="simple"/><label>(9)</label></disp-formula></p>
        <p><xref ref-type="fig" rid="pone-0054383-g002">Figure 2</xref> shows the spectra of 100 hierarchical networks, the eigenvalues of the fluctuation matrices, and the analytically predicted mean expected values for the largest eigenvalues for a network with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e068" xlink:type="simple"/></inline-formula> and 5 hierarchical levels with 1024 nodes at the coarsest level, followed by 2 clusters of 512 nodes, 4 clusters of 256 nodes, 8 clusters of 128 nodes, and 64 clusters of 16 nodes. Note that the spectrum and the predicted mean expected values of the 16 largest eigenvalues echo this pattern: there are 5 clusters of eigenvalues separated with large gaps, with the largest 2, 4, 8, and 16 eigenvalues in each cluster.</p>
        <fig id="pone-0054383-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0054383.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Full hierarchical network spectrum.</title>
            <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e069" xlink:type="simple"/></inline-formula> node network, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e070" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e071" xlink:type="simple"/></inline-formula>. Black circles (below green circles) show actual spectrum. Red circles, centred on the point, show analytic prediction of mean expected eigenvalues from Eq. (9). Green circles show distribution of eigenvalues of the fluctuation matrix.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054383.g002" position="float" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2b">
        <title>Spectrum of Perturbed Modular, Nonhierarchical Networks</title>
        <p>It is known that if a modular network has <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e072" xlink:type="simple"/></inline-formula> modules, then its spectrum will show <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e073" xlink:type="simple"/></inline-formula> large eigenvalues <xref ref-type="bibr" rid="pone.0054383-Chauhan1">[13]</xref>, <xref ref-type="bibr" rid="pone.0054383-Sarkar1">[14]</xref>. This result is easily rederived as a special case of the above framework. We consider an unperturbed modular network <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e074" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e075" xlink:type="simple"/></inline-formula> nodes and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e076" xlink:type="simple"/></inline-formula> equally sized disconnected modules that are random networks of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e077" xlink:type="simple"/></inline-formula> and nodes connected with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e078" xlink:type="simple"/></inline-formula>, as defined in the previous section. The adjacency matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e079" xlink:type="simple"/></inline-formula> for this network has <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e080" xlink:type="simple"/></inline-formula> random blocks on the diagonal.</p>
        <p>We now perturb this ideal modular network with block matrices of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e081" xlink:type="simple"/></inline-formula>, each of which is random network of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e082" xlink:type="simple"/></inline-formula> nodes with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e083" xlink:type="simple"/></inline-formula> of an edge between two nodes, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e084" xlink:type="simple"/></inline-formula> sets a rate of decrease in probability of an edge between two nodes. As above, we call these the perturbation matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e085" xlink:type="simple"/></inline-formula>. The perturbed modular network is represented by matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e086" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e087" xlink:type="simple"/></inline-formula> has the block form<disp-formula id="pone.0054383.e088"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e088" xlink:type="simple"/><label>(10)</label></disp-formula></p>
        <p>Thus, instead of considering higher powers of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e089" xlink:type="simple"/></inline-formula> to set the levels of decrease of connectivity, we set q to a single value to produce a single levelled perturbed modular network. Using Eq. (9), and substituting the correct values for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e090" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e091" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e092" xlink:type="simple"/></inline-formula>, it can be easily shown that the spectrum of the perturbed modular network <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e093" xlink:type="simple"/></inline-formula> is<disp-formula id="pone.0054383.e094"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e094" xlink:type="simple"/><label>(11)</label></disp-formula></p>
        <p>The largest eigenvalue of the perturbed matrix has a mean expected value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e095" xlink:type="simple"/></inline-formula> and the next <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e096" xlink:type="simple"/></inline-formula> largest eigenvalues have a mean expected value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e097" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pone-0054383-g003">Figure 3</xref> shows the actual, predicted, and fluctuation matrix eigenvalue distributions for a non-hierarchical modular network.</p>
        <fig id="pone-0054383-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0054383.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Full modular non-hierarchical network spectrum.</title>
            <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e098" xlink:type="simple"/></inline-formula> node network, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e099" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e100" xlink:type="simple"/></inline-formula>. Black circles (below green circles) show actual spectrum. Red circles, centred on the point, show analytic prediction of mean expected eigenvalues from Eq. (11). Green circles show distribution of eigenvalues of the fluctuation matrix.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054383.g003" position="float" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2c">
        <title>Empirical Limits of Modularity Detection</title>
        <p>From the above sections we see that the mean expected eigenvalues depend upon the network size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e101" xlink:type="simple"/></inline-formula>, the number of modules <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e102" xlink:type="simple"/></inline-formula>, the size of each module <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e103" xlink:type="simple"/></inline-formula>, and the probability parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e104" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e105" xlink:type="simple"/></inline-formula>. We vary all these parameters, and especially <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e106" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e107" xlink:type="simple"/></inline-formula> for given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e108" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e109" xlink:type="simple"/></inline-formula>, to explore how the mean expected eigenvalues vary. It is clear that the gaps between the largest eigenvalues and the bulk of the distribution provides us with the capacity to detect community structure. Therefore, at the point where the principal or largest eigenvalues are no longer separated from the bulk distribution is also the point where we lose the capacity to detect the community structure. It might be expected that this point will occur when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e110" xlink:type="simple"/></inline-formula>, thereby making the probability of edges outside modules equal to that for those inside modules; i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e111" xlink:type="simple"/></inline-formula>. However, using the spectral results above, we find that this is not the case. We find that even when modularity is present in a weak form in the network, it will not be possible to detect it. Thus, for a given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e112" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e113" xlink:type="simple"/></inline-formula>, certain values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e114" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e115" xlink:type="simple"/></inline-formula> provide a detectability threshold beyond which it is not possible to detect modularity structure in networks, even if some modularity is present. We present the empirical location of this threshold for any network, in terms of the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e116" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e117" xlink:type="simple"/></inline-formula>. Very recently, a study has found similar results for modular networks <xref ref-type="bibr" rid="pone.0054383-Nadakuditi1">[11]</xref>, but we know of no other such studies for hierarchically modular networks. The study in <xref ref-type="bibr" rid="pone.0054383-Nadakuditi1">[11]</xref> also asserts and demonstrates that if spectral modularity detection methods fail to detect community structure then no other method will detect it.</p>
        <sec id="s2c1">
          <title>Limits of modularity detection in modular networks</title>
          <p>In a modular network, the mean expected value of the largest eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e118" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e119" xlink:type="simple"/></inline-formula>, that of the second largest eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e120" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e121" xlink:type="simple"/></inline-formula>, and the limits of the bulk distribution (all the other eigenvalues are denoted as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e122" xlink:type="simple"/></inline-formula>), are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e123" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e124" xlink:type="simple"/></inline-formula> is the standard deviation of the entries in the fluctuation matrix as described in the previous section. The difference between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e125" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e126" xlink:type="simple"/></inline-formula> is<disp-formula id="pone.0054383.e127"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e127" xlink:type="simple"/><label>(12)</label></disp-formula>which grows when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e128" xlink:type="simple"/></inline-formula> is increased relative to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e129" xlink:type="simple"/></inline-formula> because <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e130" xlink:type="simple"/></inline-formula> will grow and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e131" xlink:type="simple"/></inline-formula> will become smaller as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e132" xlink:type="simple"/></inline-formula> increases. The difference between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e133" xlink:type="simple"/></inline-formula> and the limits of the bulk distribution is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e134" xlink:type="simple"/></inline-formula></p>
          <p><disp-formula id="pone.0054383.e135"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e135" xlink:type="simple"/><label>(13)</label></disp-formula>As <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e136" xlink:type="simple"/></inline-formula> gets smaller with increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e137" xlink:type="simple"/></inline-formula>, and the limits of the bulk distribution grow larger with increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e138" xlink:type="simple"/></inline-formula>, the point at which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e139" xlink:type="simple"/></inline-formula> falls within the limits of the bulk distribution it will no longer be possible to detect the modularity structure. At <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e140" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e141" xlink:type="simple"/></inline-formula>, because <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e142" xlink:type="simple"/></inline-formula>. Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e143" xlink:type="simple"/></inline-formula>, this point falls when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e144" xlink:type="simple"/></inline-formula>, which implies that even when weak modularity is present in the network, it is no longer possible to detect it. This is seen in <xref ref-type="fig" rid="pone-0054383-g004">Figure 4</xref> that shows <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e145" xlink:type="simple"/></inline-formula> for chosen values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e146" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e147" xlink:type="simple"/></inline-formula> for given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e148" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e149" xlink:type="simple"/></inline-formula>. Thus, the condition that<disp-formula id="pone.0054383.e150"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e150" xlink:type="simple"/><label>(14)</label></disp-formula>provides the criterion for modularity detection, with the threshold given by the condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e151" xlink:type="simple"/></inline-formula>. When the condition is violated, it will be impossible to detect modularity structure even when present. For example, in <xref ref-type="fig" rid="pone-0054383-g004">Fig. 4(b)</xref>, it is easily observed that at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e152" xlink:type="simple"/></inline-formula>, some weak modularity is present, but cannot be detected.</p>
          <fig id="pone-0054383-g004" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0054383.g004</object-id>
            <label>Figure 4</label>
            <caption>
              <title>Limits of modularity detection in modular networks.</title>
              <p>Expectation value of second largest eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e153" xlink:type="simple"/></inline-formula> (red lines) and limits of bulk distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e154" xlink:type="simple"/></inline-formula> (black lines) are plotted for values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e155" xlink:type="simple"/></inline-formula> and (a) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e156" xlink:type="simple"/></inline-formula>, (black line below red line: modularity can be detected for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e157" xlink:type="simple"/></inline-formula>), (b) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e158" xlink:type="simple"/></inline-formula>, (modularity can only be detected for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e159" xlink:type="simple"/></inline-formula>, i.e., region with black line below red line), (c) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e160" xlink:type="simple"/></inline-formula> (modularity can only be detected for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e161" xlink:type="simple"/></inline-formula>, i.e., region with black line below red line). Threshold of detection is the point where the two lines cross. In (b), eigenvalue distributions are plotted for 100 networks at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e162" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e163" xlink:type="simple"/></inline-formula>. Black circles: actual eigenvalues, green circles: eigenvalues of fluctuation matrix, red circles: analytically predicted expectation values of second largest and bulk distribution of eigenvalues, blue pluses: predicted limits of bulk distribution of fluctuation matrix. Before threshold point, second largest eigenvalue falls within the bulk distribution, after threshold point, it falls outside the bulk distribution.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054383.g004" position="float" xlink:type="simple"/>
          </fig>
          <p><xref ref-type="disp-formula" rid="pone.0054383.e150">Equation (14</xref>) also shows that as the number of modules <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e164" xlink:type="simple"/></inline-formula> increases, and the size of modules <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e165" xlink:type="simple"/></inline-formula> decreases, for a certain <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e166" xlink:type="simple"/></inline-formula>, this threshold is violated for smaller and smaller values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e167" xlink:type="simple"/></inline-formula>. On the other hand, when the size of modules <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e168" xlink:type="simple"/></inline-formula> is larger, the number of modules <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e169" xlink:type="simple"/></inline-formula> grows smaller, larger values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e170" xlink:type="simple"/></inline-formula> will not violate the threshold condition. Qualitatively, this implies that as network size increases, it gets harder to detect the smallest modules in the network.</p>
        </sec>
        <sec id="s2c2">
          <title>Limits of modularity detection in hierarchical networks</title>
          <p>We recall that in a hierarchically modular network, the mean expected values of the largest eigenvalues are given by Eq. (9), and the limits of the bulk distribution (all the other eigenvalues are denoted as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e171" xlink:type="simple"/></inline-formula>), are described by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e172" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e173" xlink:type="simple"/></inline-formula> is the standard deviation of the entries in the fluctuation matrix as described in the previous section. From the spectrum we can see that the largest eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e174" xlink:type="simple"/></inline-formula> grows with increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e175" xlink:type="simple"/></inline-formula>, while the subsequent eigenvalues outside the bulk distribution get smaller. Further, the limits of the bulk distribution of the fluctuation matrix will also grow with increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e176" xlink:type="simple"/></inline-formula>. At the point where the leading eigenvalues fall within the limits specified by the bulk distribution of eigenvalues, it will be no longer possible to detect the corresponding hierarchical levels or the modules at these levels. These threshold conditions, starting from the cluster of eigenvalues signifying the finest hierarchical level in the network, are given by<disp-formula id="pone.0054383.e177"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e177" xlink:type="simple"/><label>(15)</label></disp-formula><disp-formula id="pone.0054383.e178"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e178" xlink:type="simple"/><label>(16)</label></disp-formula>and in general</p>
          <p><disp-formula id="pone.0054383.e179"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e179" xlink:type="simple"/><label>(17)</label></disp-formula><xref ref-type="fig" rid="pone-0054383-g005">Figure 5</xref> shows <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e180" xlink:type="simple"/></inline-formula> for chosen values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e181" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e182" xlink:type="simple"/></inline-formula> for given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e183" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e184" xlink:type="simple"/></inline-formula>. The points at which the threshold conditions stated above are violated, it is impossible to detect the modularity structure present in the network. Specifically, in the hierarchical case, the number of eigenvalue clusters that fall within the bulk distribution equals the number of hierarchical levels and modules at these levels that go undetected. For example, in <xref ref-type="fig" rid="pone-0054383-g005">Fig. 5(c)</xref>, it is easily observed that for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e185" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e186" xlink:type="simple"/></inline-formula> at the finest hierarchical levels, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e187" xlink:type="simple"/></inline-formula>, the first two (finest) hierarchical levels cannot be detected at any value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e188" xlink:type="simple"/></inline-formula>, even though hierarchical modularity is present.</p>
          <fig id="pone-0054383-g005" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0054383.g005</object-id>
            <label>Figure 5</label>
            <caption>
              <title>Limits of modularity detection in hierarchically modular networks.</title>
              <p>Mean expected value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e189" xlink:type="simple"/></inline-formula> (red, blue, green, purple, cyan lines, respectively) and limits of bulk distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e190" xlink:type="simple"/></inline-formula> (black lines) are plotted for a 4 level hierarchical network with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e191" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e192" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e193" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e194" xlink:type="simple"/></inline-formula> and (a) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e195" xlink:type="simple"/></inline-formula> and (b) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e196" xlink:type="simple"/></inline-formula>, and for a 5-level hierarchical network <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e197" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e198" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e199" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e200" xlink:type="simple"/></inline-formula> and (c) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e201" xlink:type="simple"/></inline-formula> and (d) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e202" xlink:type="simple"/></inline-formula>. The points where the black lines cross the colored lines show thresholds of detection for the corresponding hierarchical levels. Modularity can only be detected above the black lines. Comparing (a) and (b), as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e203" xlink:type="simple"/></inline-formula> increases, the number of colored lines falling below the black lines increases. Comparing (b) and (d), as the number of hierarchical levels increase and module sizes at finer hierarchical levels become smaller, at the same <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e204" xlink:type="simple"/></inline-formula> value, a larger number of colored lines fall below the black lines.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054383.g005" position="float" xlink:type="simple"/>
          </fig>
          <p>From the threshold conditions, it is also seen that as the sizes of modules <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e205" xlink:type="simple"/></inline-formula> get smaller and the number of modules <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e206" xlink:type="simple"/></inline-formula> higher relative to network size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e207" xlink:type="simple"/></inline-formula>, it will get harder and harder to detect the smallest sized modules at the finest levels of hierarchy for smaller and smaller values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e208" xlink:type="simple"/></inline-formula>. For example, in <xref ref-type="fig" rid="pone-0054383-g005">Fig. 5(f)</xref>, the first 3 hierarchical levels cannot be detected, because the smallest module size is 32 instead of 64, as in <xref ref-type="fig" rid="pone-0054383-g005">Fig. 5(c)</xref>. Thus, while the overall large scale hierarchy is detectable, finer levels of hierarchy signified by the eigenvalues that fall within the bulk distribution of eigenvalues lie undetected. As we show in the next section, this observation has significant implications for detection of modularity in real world networks that are known to have extraordinary complexity and multiscale levels of organization, such as human brain networks.</p>
        </sec>
      </sec>
      <sec id="s2d">
        <title>Real World Networks</title>
        <sec id="s2d1">
          <title>Evolving peer to peer internet networks</title>
          <p>Peer-to-peer or P2P networks are decentralized, self-organized systems, in which individual computers connect to each other and communicate directly for the purposes of sharing information and resources, without dedicated or centralized servers <xref ref-type="bibr" rid="pone.0054383-Ripeanu1">[15]</xref>. Though these systems are guided by common goals (for example, of sharing CPU cycles and storage space), there is no central guiding authority. The resulting network topology and the dynamics of communication occurring on it are emergent; i.e., individual users interacting locally with other users determine the local decisions, but the large scale system behavior cannot be determined trivially from the local interactions alone. The highly decentralized self-organized nature of these evolving networks ensures large fluctuations in network size and numbers of edges, as the size and resulting topology of the network are completely determined by how many individual users are joining and leaving the network. Since many self-organized systems in nature and society show modular organization, we were interested in looking at the modularity properties of large scale evolving peer to peer networks, and to chart how modular organization of a guided self-organized system evolves dynamically over time.</p>
          <p>To explore the modular organization of these networks, we explore the eigenvalue spectra of temporal snapshots of the peer-to-peer Gnutella file sharing network (data from <xref ref-type="bibr" rid="pone.0054383-Leskovec1">[16]</xref>). The data represents a sequence of 8 snapshots of the P2P Gnutella network, collected in August 2002 (from 4 Aug 2002 to 30 Aug 2002, smallest network size [6301 nodes, 20777 edges] to largest network size [36682 nodes, 88328 edges]), with the nodes representing hosts and edges representing connections between hosts. <xref ref-type="fig" rid="pone-0054383-g006">Figure 6</xref> shows the spectra for 8 temporal snapshots of this evolving network.</p>
          <fig id="pone-0054383-g006" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0054383.g006</object-id>
            <label>Figure 6</label>
            <caption>
              <title>Gnutella evolving network spectra.</title>
              <p>8 network snapshots captured from 4 Aug 2002 to 30 Aug 2002, data from <xref ref-type="bibr" rid="pone.0054383-Leskovec1">[16]</xref>. Only 600 largest eigenvalues computed and plotted for the last snapshot in part (h), showing principal eigenvalue and perimeter of bulk distribution.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054383.g006" position="float" xlink:type="simple"/>
          </fig>
          <p>The results show a striking absence of large modules in all the 8 networks. The eigenvalue spectra show only one large eigenvalue well separated from the eigenvalue cloud, distinctly showing that there is no significant modularity present in the network. If there is any modularity present, we surmise that it is local; i.e., the size of the module is insignificant as compared to the size of the system, and that the modularity is very weak so as to be rendered undetectable by the spectral approach. As opposed to this signature, if there was any significant modularity present, the spectrum would have shown more than one eigenvalue well separated from the eigenvalue cloud. This was a very surprising result. One principle driving modularity in P2P systems could be that users on the P2P network are likely to have specific file sharing or information needs and exercise freedom in connecting to other users. Thus, an expected trend could be that modularity emerges in the network, even with the possibility that it is transient. Thus, it is remarkable that the evolving Gnutella P2P network (at least over a month of observations) shows a distinct absence of modularity. The random nature of user connections that is used as a model for the Gnutella network may explain the result. This finding has implications for P2P system design and performance. We note that the non-scalability of existing P2P Gnutella architecture, its reported mismatch with the underlying Internet topology, and new strategies for designing scalable and robust P2P systems has been the topic of much research <xref ref-type="bibr" rid="pone.0054383-Ripeanu1">[15]</xref>. Our analysis shows that these can be related to the finding that existing self-organized P2P systems appear to be non-modular, and that modularity and hierarchical organization are considered essential organizing principles in self-organized systems that maintain scalability of the system.</p>
        </sec>
        <sec id="s2d2">
          <title>Social networks</title>
          <p>As opposed to many technological and biological systems, social network data is usually available on smaller scales; i.e., the sizes of social networks are smaller in nature. Due to their small size, detailed study of community structure is possible, and some classic social networks with known modularity structure are often used as benchmark cases for modularity detection approaches and algorithms. Here, we explore the eigenvalue spectra of several social networks that are used as benchmark test cases. In all cases, the number of largest eigenvalues separated from the bulk distribution correctly predicts the known number of modules in the networks. <xref ref-type="fig" rid="pone-0054383-g007">Figure 7</xref> shows the results for the well known Zachary Karate Club network, Dolphins social network <xref ref-type="bibr" rid="pone.0054383-Lusseau1">[17]</xref>, <xref ref-type="bibr" rid="pone.0054383-Lusseau2">[18]</xref> and the American College Football data set <xref ref-type="bibr" rid="pone.0054383-Girvan1">[19]</xref>.</p>
          <fig id="pone-0054383-g007" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0054383.g007</object-id>
            <label>Figure 7</label>
            <caption>
              <title>Social network spectra for benchmark test cases.</title>
              <p>Eigenvalues are all real because the networks are undirected. (a) Spectrum of Zachary Karate Club network data of 34 nodes from <xref ref-type="bibr" rid="pone.0054383-Zachary1">[20]</xref>. Inset (i) shows original adjacency matrix. Insets (ii) and (iii) show 2 dimensional and 4 dimensional approximations of original matrix. (b) Spectrum of Dolphins social network of 62 dolphins from <xref ref-type="bibr" rid="pone.0054383-Lusseau1">[17]</xref>. (c) Spectrum of American Football Teams social network from <xref ref-type="bibr" rid="pone.0054383-Girvan1">[19]</xref>. Left inset shows unordered original network data. Right inset shows the same network, where rows and columns have been reordered using algorithm in <xref ref-type="bibr" rid="pone.0054383-Sarkar1">[14]</xref> to show modules along the main diagonal.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054383.g007" position="float" xlink:type="simple"/>
          </fig>
          <p>The Zachary Karate Club network is one of the most studied social network data sets in the literature <xref ref-type="bibr" rid="pone.0054383-Fortunato1">[1]</xref>, <xref ref-type="bibr" rid="pone.0054383-Zachary1">[20]</xref>. Its small size and known partitions render it usable as “real world” test data for community detection techniques and algorithms. Members of a Karate club, 34 in number, split into 2 known communities follwing a disagreement between 2 leaders in the group. The split into 2 groups is known and well-documented and other authors have also studied the network for its hierarchical structure, and have shown that the two sub-groups split into smaller communities, showing 4 communities at a second hierarchical level <xref ref-type="bibr" rid="pone.0054383-Fortunato1">[1]</xref>. The eigenvalue spectrum clearly reveals this analysis. <xref ref-type="fig" rid="pone-0054383-g007">Figure 7(a)</xref> shows the eigenvalue spectrum with two largest eigenvalues (signifying the major split of the network into two main parts), and two more clustered eigenvalues separated from the bulk distribution (signifying the second hierarchical level with 4 communities). The inset (i) shows the original adjacency matrix. In insets (ii) and (iii), following the algorithm presented in <xref ref-type="bibr" rid="pone.0054383-Sarkar1">[14]</xref>, we have produced 2 dimensional and 4 dimensional approximations of the original adjacency matrix by preserving, respectively, 2 and 4 largest eigenvalues and associated eigenvectors. It can be clearly seen in the lower dimensional approximations that at 2 eigenvalues the network shows 2 communities, and at 4 eigenvalues, these larger communities have split into two each, showing 4 communities. In both approximations, some nodes fall in overlaps between communities. These results correctly reveal the <italic>exact</italic> known partitions in the network <xref ref-type="bibr" rid="pone.0054383-Fortunato1">[1]</xref>.</p>
          <p>The undirected Dolphin social network <xref ref-type="bibr" rid="pone.0054383-Lusseau1">[17]</xref>, <xref ref-type="bibr" rid="pone.0054383-Lusseau2">[18]</xref> is a widely-cited example in the community detection literature. A group of dolphins were observed over a period of time, after which the groups split into two following the disappearence of a few members that were on the boundary of the group. Nodes in the social network represent these dolphins, and edges represent regular social contact. The group has a known community structure, with two well separated groups into which the bigger group split, and the larger of the groups showing further submodules. The spectra shows a clear indication of this hierarchical structure [<xref ref-type="fig" rid="pone-0054383-g007">Fig. 7(b)</xref>], with two largest eigenvalues being followed by a cluster of 3–4 eigenvalues that are well separated from the bulk distribution. We have previously studied the hierarchical structure of this network using an alternate spectral approach in detail and the results are in <xref ref-type="bibr" rid="pone.0054383-Sarkar1">[14]</xref>. The insets show the unordered network data, and reordered organization to show the modules. The hierarchical structure is clearly visible.</p>
          <p>The undirected American College Football dataset <xref ref-type="bibr" rid="pone.0054383-Girvan1">[19]</xref> is another well known dataset with a known community structure. There are 115 college teams that all play against each other. However, they are organized in “conferences” such that more frequent games occur between teams in a conference than between teams belonging to separate conferences. The known community structure corresponds to 12 conferences into which the teams are divided. The spectrum distinctly shows 12 large eigenvalues well separated from the bulk distribution [<xref ref-type="fig" rid="pone-0054383-g007">Fig. 7(c)</xref>], and the insets show the original unordered data, and the reordered matrix to show the 12 teams. We have performed the reordering using the algorithm described in <xref ref-type="bibr" rid="pone.0054383-Sarkar1">[14]</xref>.</p>
        </sec>
        <sec id="s2d3">
          <title>Structural brain networks</title>
          <p>Brains have fine-scale regular structure, to a first approximation, with high connectivity between nearby neurons <xref ref-type="bibr" rid="pone.0054383-Braitenberg1">[21]</xref>. Connectivity decreases as distance between neurons increases. Paradoxically, the brain also shows large scale specialization, with specific regions devoted to specific sets of functions <xref ref-type="bibr" rid="pone.0054383-Sporns1">[2]</xref>–<xref ref-type="bibr" rid="pone.0054383-Meunier2">[5]</xref>. The assumption is that these areas, often termed <italic>modules</italic>, are tightly connected together to perform certain functions and are only sparsely connected to other specialized areas. This assumption and experimental evidence supporting modularity is in apparent contradiction with the observed fine scale (nonmodular) homogeneity. Thus, reliably characterizing the structure of the brain is an unsolved problem. In a future paper, we use the methods reported here to resolve this contradiction between and simultaneous presence of fine scale regularity and large scale modularity in brain networks <xref ref-type="bibr" rid="pone.0054383-Sarkar2">[22]</xref>.</p>
          <p>Here, we examine the eigenvalue spectrum of a human brain structural connectivity network. The human brain structural network was obtained from <xref ref-type="bibr" rid="pone.0054383-Hagmann1">[23]</xref>. They performed high resolution diffusion spectrum MRI (DSI) of the human cortex. They then defined 66 cortical regions with anatomical landmarks. Each of these 66 cortical regions was then individually subdivided into 998 regions of interest (ROIs). Weighted undirected networks were produced at two resolutions, a fine resolution network of 998 nodes and a coarse resolution network of 66 nodes. We study the spectrum of the fine scale 998 node network here. <xref ref-type="fig" rid="pone-0054383-g008">Figure 8</xref> shows the results. The spectrum shows clusters of leading eigenvalues and a bulk distribution. However, the distinction between these clusters is highly smoothed, meaning that there are no clear gaps visible between hierarchical levels, with the leading eigenvalues gradually merging into the bulk distribution.</p>
          <fig id="pone-0054383-g008" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pone.0054383.g008</object-id>
            <label>Figure 8</label>
            <caption>
              <title>Human brain structural connection network spectrum.</title>
              <p>998 node structural connection network spectrum (black pluses) compared with a 6 level 1024 node hierarchical network spectrum (green pluses). Both spectra have been divided by the corresponding largest eigenvalue to allow for superimposition to show relative scaling and relationship to each other.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054383.g008" position="float" xlink:type="simple"/>
          </fig>
          <p>In the previous sections of <italic>Results</italic> on hierarchical networks, we showed that the above signature is typical of a network in which if it has many levels of hierarchy with the finer level hierarchical levels having smaller modules, then some of the leading eigenvalues get subsumed into the bulk distribution and hence cannot be detected. Thus, we generate a typical 6-level hierarchical modular network with 64 modules of size 16, followed by 32 modules of size 32, 16 modules of size 64, 8 modules of size 128, 4 modules of size 256, and 2 modules of size 512, following the stochastic block model network generation model described in the section <italic>Spectrum of hierarchically modular networks</italic> <xref ref-type="bibr" rid="pone.0054383-Robinson1">[12]</xref>. We set a low <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e211" xlink:type="simple"/></inline-formula> and high <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e212" xlink:type="simple"/></inline-formula>. However, generating these hierarchical networks using the simple stochastic block model form does not produce a spectrum that matches the brain connectivity spectrum, although it successfully explains why the finer hierarchical levels with smallest module sizes cannot be detected.</p>
          <p>Since the stochastic block model form is too simple to capture the properties of real world networks, we used a more sophisticated modified version of the stochastic block model, discussed in <xref ref-type="bibr" rid="pone.0054383-Robinson1">[12]</xref>, <xref ref-type="bibr" rid="pone.0054383-Sarkar2">[22]</xref>, <xref ref-type="bibr" rid="pone.0054383-Gray1">[24]</xref> to generate hierarchical networks with the above stated parameters. In this modified network generation model, instead of placing random blocks in successive hierarchical levels, we generate a hierarchical network by starting with a perfect modular network (fully connected modules) and successively rewiring it with decreasing probabilities at subsequent hierarchical levels. <xref ref-type="fig" rid="pone-0054383-g008">Figure 8</xref> we superimpose (green pluses) the spectrum of this hierarchical network, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e213" xlink:type="simple"/></inline-formula>, over the human brain network spectrum. The close match between the two spectra is clearly visible. This finding explains the observation that in human brain networks, 5 to 6 large modules are frequently detected <xref ref-type="bibr" rid="pone.0054383-Meunier1">[4]</xref>, <xref ref-type="bibr" rid="pone.0054383-Meunier2">[5]</xref>, <xref ref-type="bibr" rid="pone.0054383-Sarkar2">[22]</xref>, <xref ref-type="bibr" rid="pone.0054383-Hagmann1">[23]</xref>. As shown by the spectrum, this large scale modularity is visible via the 5–7 leading eigenvalues in clusters separated from the bulk distribution. However, on finer scales the network appears nonmodular because the finest level modules are impossible to detect – the corresponding eigenvalues are subsumed in the bulk distribution. We note here that this undetectability, in an algorithm-independent manner, and notwithstanding the weakness inherent in any detection algorithm, may be a characteristic property of a natural system in which there are multiple hierarchical levels present. In such a system, the smallest sized modules may be so small as compared to the system size so that intermodular connection probabilities approaching close to the intramodular connection probabilities at that level cannot be avoided, thus making the modular structure extremely weak and rendering it undetectable.</p>
        </sec>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>In this paper, we address the problem of characterizing the hierarchical modularity of a network. The main results are a set of methods in which we develop a spectral approach to characterize the hierarchical modularity of networks in an algorithm independent manner, establish conditions for the detectability or undetectability of modularity in networks, and illustrate these results with synthetic and real world test cases. Our main results are:</p>
      <list list-type="roman-lower">
        <list-item>
          <p>We derive the spectrum of hierarchically modular graphs generated using a stochastic block model form. Specifically, using theorems from random matrix theory, we derive the mean expected values for the set of largest eigenvalues of the adjacency matrix of a hierarchically modular graph. We show that hierarchical modularity of this model can be fingerprinted using the spectrum of its largest eigenvalues and gaps between clusters of closely spaced eigenvalues that are well separated from the bulk distribution of eigenvalues around the origin.</p>
        </list-item>
        <list-item>
          <p>We establish the limits of “how” modular a real world system is through a study of the properties of the spectrum and its distribution. The spectrum of modular networks with no hierarchy is shown to be a special case of our more general results, and some known results on the spectrum of modular networks are thus reproduced within our common framework for characterizing network modularity in general.</p>
        </list-item>
        <list-item>
          <p>We establish the limits of detection of hierarchical modularity and modularity as permitted by the spectral approach; i.e., given the amount or degree of modularity, we determine how much of this modularity can be (or cannot be) detected using the spectral approach. We empirically show that when probability parameters for instantiating edges in networks are varied, there is a threshold set by the probabilities and the limits of the bulk distribution of eigenvalues around the origin beyond which hierarchy and modularity cannot be detected even if weakly present.</p>
        </list-item>
      </list>
      <p>As noted in the recent work of <xref ref-type="bibr" rid="pone.0054383-Nadakuditi1">[11]</xref>, spectral signatures of modularity detection are optimal in the sense that no other method can detect modularity in a regime where the spectral methods fail. This establishes that the results we present in this paper on the limits of modularity detection are general in the sense that if the spectral fingerprint fails to detect weak forms of modularity in a network, then any of the current spectral based methods and algorithms used for modularity detection are likely to be unable to detect it.</p>
      <p>We studied the eigenvalue distributions of some technological, social, and biological networks, and showed that the spectrum can successfully capture information about the modular, hierarchically modular, or even non modular structure of real world networks (as for the case of P2P networks). This detection does not rest on the specific assumptions of any modularity detection algorithm. A study of the real world networks also revealed that the simple stochastic block model is insufficient to capture properties of real world networks (such as brain networks), and more sophisticated models are needed to capture these properties. In future work, analytical examination of the spectral properties of more sophisticated network models will allow us to address the problem of modularity and hierarchy detection more robustly.</p>
      <p>Very importantly, a detailed study of structural brain network spectra revealed that, notwithstanding the weakness inherent in any detection algorithm or approach, the undetectability of modules can be a characteristic property of a natural system in which there are multiple hierarchical levels present. In any such natural system, the smallest sized modules at the finest hierarchical levels may be very small as compared to the system size. Thus, an unavoidable condition in such a situation is that the intermodular connection probabilities approach very close to the intramodular connection probabilities (since the nodes within the smallest module <italic>have to</italic> connect to nodes from other such small modules, thus making the modular structure extremely weak and rendering it undetectable.</p>
    </sec>
    <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <p>Here we present some old, classically known results that we use to derive our new results in this paper.</p>
      <sec id="s4a">
        <title>Network Representation and Adjacency Matrix</title>
        <p>Throughout the paper, in a network (or graph) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e214" xlink:type="simple"/></inline-formula>, a node represents a component of the system, and edges represent structural or functional relationships between the nodes. In an adjacency or connection matrix representation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e215" xlink:type="simple"/></inline-formula>, denoted by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e216" xlink:type="simple"/></inline-formula>, the rows/columns represent the nodes and entries <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e217" xlink:type="simple"/></inline-formula> represent the weights of the edges. If the graph is undirected, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e218" xlink:type="simple"/></inline-formula>, leading to a symmetric adjacency matrix. A symmetric matrix always has real eigenvalues. If the graph is directed, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e219" xlink:type="simple"/></inline-formula> signifies an edge going from node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e220" xlink:type="simple"/></inline-formula> to node <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e221" xlink:type="simple"/></inline-formula>, and in general, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e222" xlink:type="simple"/></inline-formula>. A directed graph produces an asymmetric adjacency matrix with complex eigenvalues. We consider both asymmetric and symmetric matrices in deriving the approximate spectra of networks in this work, that represent directed and undirected graphs, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e223" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e224" xlink:type="simple"/></inline-formula>, respectively.</p>
        <p>We establish the main results in this paper using the following theorems from random graph theory and random matrix theory.</p>
      </sec>
      <sec id="s4b">
        <title>Spectrum of an Uncorrelated Random Graph</title>
        <p>An Erdös-Renyi uncorrelated random graph is a graph of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e225" xlink:type="simple"/></inline-formula> nodes where the probability for any two pairs of vertices in the graph being connected is the same, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e226" xlink:type="simple"/></inline-formula>, and these probabilities are independent variables <xref ref-type="bibr" rid="pone.0054383-Newman1">[8]</xref>. Thus, the entries have a common expectation (mean) value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e227" xlink:type="simple"/></inline-formula> with a variance of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e228" xlink:type="simple"/></inline-formula>. The main classically known results about the spectrum of uncorrelated random graphs that are of relevance in the present work relate to the distribution of its eigenvalues (see Ref. <xref ref-type="bibr" rid="pone.0054383-Farkas1">[25]</xref>). First, as the number of nodes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e229" xlink:type="simple"/></inline-formula> grows, the principal eigenvalue (the largest eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e230" xlink:type="simple"/></inline-formula>) grows much faster than the second eigenvalue with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e231" xlink:type="simple"/></inline-formula> with probability 1, whereas for every <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e232" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e233" xlink:type="simple"/></inline-formula>. The same relationship holds for the smallest eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e234" xlink:type="simple"/></inline-formula>. For every <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e235" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e236" xlink:type="simple"/></inline-formula>. Thus, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e237" xlink:type="simple"/></inline-formula> is the average degree of a vertex, then the largest eigenvalue <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e238" xlink:type="simple"/></inline-formula> scales as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e239" xlink:type="simple"/></inline-formula> and the other eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e240" xlink:type="simple"/></inline-formula> scale as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e241" xlink:type="simple"/></inline-formula>.</p>
        <p>These results were presented in a more detailed form in <xref ref-type="bibr" rid="pone.0054383-Furedi1">[26]</xref> for undirected graphs or symmetric random matrices. In <xref ref-type="bibr" rid="pone.0054383-Furedi1">[26]</xref>, a matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e242" xlink:type="simple"/></inline-formula> was considered with independent random variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e243" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e244" xlink:type="simple"/></inline-formula>, bounded with a common bound <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e245" xlink:type="simple"/></inline-formula>. The common bound implies that all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e246" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e247" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e248" xlink:type="simple"/></inline-formula>. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e249" xlink:type="simple"/></inline-formula>, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e250" xlink:type="simple"/></inline-formula> were considered to have a common expectation value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e251" xlink:type="simple"/></inline-formula> and variance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e252" xlink:type="simple"/></inline-formula>, and the expectation value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e253" xlink:type="simple"/></inline-formula> was considered to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e254" xlink:type="simple"/></inline-formula>. Then, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e255" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e256" xlink:type="simple"/></inline-formula> was defined by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e257" xlink:type="simple"/></inline-formula>. The numbers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e258" xlink:type="simple"/></inline-formula> are held fixed as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e259" xlink:type="simple"/></inline-formula>, and the mean expected values of the largest eigenvalue and the limits of the bulk distribution of the other eigenvalues were studied.</p>
        <p>From the results of <xref ref-type="bibr" rid="pone.0054383-Furedi1">[26]</xref>, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e260" xlink:type="simple"/></inline-formula> then the distribution of the largest eigenvalue of the random symmetric matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e261" xlink:type="simple"/></inline-formula> can be approximated in order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e262" xlink:type="simple"/></inline-formula> by a normal distribution of expectation<disp-formula id="pone.0054383.e263"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e263" xlink:type="simple"/><label>(18)</label></disp-formula>and variance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e264" xlink:type="simple"/></inline-formula>. Further, with probability tending to 1, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e265" xlink:type="simple"/></inline-formula>,</p>
        <p><disp-formula id="pone.0054383.e266"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e266" xlink:type="simple"/><label>(19)</label></disp-formula>If the expectation value of the diagonal elements <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e267" xlink:type="simple"/></inline-formula> is 0, as is the case with adjacency matrices of graphs with no self-connections, then the second term in Eq. (18) vanishes. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e268" xlink:type="simple"/></inline-formula>, as is the case with adjacency matrices of graphs with self connections allowed, then the first two terms become <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e269" xlink:type="simple"/></inline-formula>. If the variance is restricted to be small, then the contribution of the third term in Eq. (18) is small. Then, in general, the leading term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e270" xlink:type="simple"/></inline-formula> (for networks with self-connections allowed) or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e271" xlink:type="simple"/></inline-formula> (for networks with no self-connections) makes the biggest contribution to the largest eigenvalue. <xref ref-type="fig" rid="pone-0054383-g009">Figure 9</xref> shows the eigenvalue distribution of 100 random graphs with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e272" xlink:type="simple"/></inline-formula>, and analytical predictions from Eqs (18) and (19).</p>
        <fig id="pone-0054383-g009" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0054383.g009</object-id>
          <label>Figure 9</label>
          <caption>
            <title>Uncorrelated random graph spectrum and analytic prediction of eigenvalue distribution.</title>
            <p>Red plus shows analytic prediction of largest eigenvalue; green plusses show the limits <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e209" xlink:type="simple"/></inline-formula> of the rest of the distribution. Spectra of 100 graphs are plotted, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e210" xlink:type="simple"/></inline-formula></p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0054383.g009" position="float" xlink:type="simple"/>
        </fig>
        <p>If the common expectation value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e273" xlink:type="simple"/></inline-formula>, then<disp-formula id="pone.0054383.e274"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0054383.e274" xlink:type="simple"/><label>(20)</label></disp-formula>implying that all the eigenvalues will be contained by the limits specified in Eq. (20). We note here that the for directed graphs with asymmetric matrices, this bound is known to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e275" xlink:type="simple"/></inline-formula>, because in an undirected graph each value appears twice due to the condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0054383.e276" xlink:type="simple"/></inline-formula>.</p>
      </sec>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="pone.0054383-Fortunato1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fortunato</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Community detection in graphs</article-title>. <source>Phys Rep</source> <volume>486</volume>: <fpage>75</fpage>–<lpage>174</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Sporns1">
        <label>2</label>
        <mixed-citation publication-type="other" xlink:type="simple">Sporns O (2011) Networks of the brain. MIT Press.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Bullmore1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bullmore</surname><given-names>ET</given-names></name>, <name name-style="western"><surname>Sporns</surname><given-names>O</given-names></name> (<year>2009</year>) <article-title>Complex brain networks: graph theoretical analysis of structural and functional systems</article-title>. <source>Nat Rev Neurosci</source> <volume>10</volume>: <fpage>186</fpage>–<lpage>198</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Meunier1">
        <label>4</label>
        <mixed-citation publication-type="other" xlink:type="simple">Meunier D, Lamboitte R, Fornito A, Ersche K, Bullmore ET (2009) Hierarchical modularity in human brain functional networks. Front Neuroinform 3: Article 37.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Meunier2">
        <label>5</label>
        <mixed-citation publication-type="other" xlink:type="simple">Meunier D, Lamboitte R, Bullmore ET (2010) Modular and hierarchically modular organization of brain networks. Front Neurosci 4: Article 200.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Ravasz1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ravasz</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Somera</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Mongru</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Oltvai</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Barabasi</surname><given-names>A</given-names></name> (<year>2002</year>) <article-title>Science</article-title>. <volume>297</volume>: <fpage>1551</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Trevino1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trevino</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Cooper</surname><given-names>SY</given-names></name>, <name name-style="western"><surname>Bassler</surname><given-names>KE</given-names></name> (<year>2012</year>) <article-title>Robust detection of hierarchical communities from escherichia coli gene expression data</article-title>. <source>PLOS Comp Bio</source> <volume>8(2)</volume>: <fpage>e1002391</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Newman1">
        <label>8</label>
        <mixed-citation publication-type="other" xlink:type="simple">Newman MEJ (2010) Networks: An Introduction. Oxford University Press.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Fortunato2">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fortunato</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Barthelemy</surname><given-names>M</given-names></name> (<year>2006</year>) <article-title>Resolution limit in community detection</article-title>. <source>Proc Natl Acad Sci</source> <volume>104</volume>: <fpage>36</fpage>–<lpage>41</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Lancechinetti1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lancechinetti</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Fortunato</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Kertész</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>Detecting the overlapping and hierarchical community structure in networks</article-title>. <source>New Journal of Physics</source> <volume>11</volume>: <fpage>033015</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Nadakuditi1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nadakuditi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Newman</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>Graph spectra and the detectability of community structure in networks</article-title>. <source>Phys Rev Lett</source> <volume>108</volume>: <fpage>188701</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Robinson1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>Henderson</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Matar</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Riley</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Gray</surname><given-names>RT</given-names></name> (<year>2009</year>) <article-title>Dynamical reconnection and stability constraints on cortical network architecture</article-title>. <source>Phys Rev Lett</source> <volume>103</volume>: <fpage>108104</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Chauhan1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chauhan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Girvan</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ott</surname><given-names>E</given-names></name> (<year>2009</year>) <article-title>Spectral properties of networks with community structure</article-title>. <source>Phys Rev E</source> <volume>80</volume>: <fpage>056114</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Sarkar1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sarkar</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dong</surname><given-names>A</given-names></name> (<year>2011</year>) <article-title>Community detection in graphs using singular value decomposition</article-title>. <source>Phys Rev E</source> <volume>83</volume>: <fpage>046114</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Ripeanu1">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ripeanu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Foster</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Iamnitchi</surname><given-names>A</given-names></name> (<year>2002</year>) <article-title>Mapping the gnutella network: Properties of large scale peer to peer systems and implications for system design</article-title>. <source>IEEE Internet Computing</source> <volume>6(1)</volume>: <fpage>50</fpage>–<lpage>57</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Leskovec1">
        <label>16</label>
        <mixed-citation publication-type="other" xlink:type="simple">Leskovec J The stanford large network datasets. Available: <ext-link ext-link-type="uri" xlink:href="http://snap.stanford.edu/data/index.html" xlink:type="simple">http://snap.stanford.edu/data/index.html</ext-link>. Accessed 2012 20 Aug.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Lusseau1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lusseau</surname><given-names>D</given-names></name> (<year>2003</year>) <article-title>The emergent properties of a dolphin social network</article-title>. <source>Proc R Soc London, Ser B (Suppl)</source> <volume>270</volume>: <fpage>S186</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Lusseau2">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lusseau</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Newman</surname><given-names>MEJ</given-names></name> (<year>2004</year>) <article-title>Identifying the role that animals play in their social networks</article-title>. <source>Proc R Soc London, Ser B</source> <volume>271</volume>: <fpage>S477</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Girvan1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Girvan</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Newman</surname><given-names>MEJ</given-names></name> (<year>2002</year>) <article-title>Community structure in social and biological networks</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>99</volume>: <fpage>7821</fpage>–<lpage>7826</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Zachary1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zachary</surname><given-names>WW</given-names></name> (<year>1977</year>) <article-title>An information flow model for conict and fission in small groups</article-title>. <source>J Anthr Res</source> <volume>33</volume>: <fpage>452</fpage>–<lpage>473</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Braitenberg1">
        <label>21</label>
        <mixed-citation publication-type="other" xlink:type="simple">Braitenberg V, Schúz A (1998) Cortex: Statistics and Geometry of Neuronal Connectivity. Springer-Verlag, 2nd ed. edition.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Sarkar2">
        <label>22</label>
        <mixed-citation publication-type="other" xlink:type="simple">Sarkar S, Henderson JA, Robinson PA Network spectra reveal co-existence of non-modular homogeneity and large scale modularity in cortical architecture. working paper, unpublished.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Hagmann1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hagmann</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Cammoun</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Gigandet</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Meuli</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Honey</surname><given-names>CJ</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Mapping the structural core of the human cerebral cortex</article-title>. <source>PLOS Biol</source> <volume>6</volume>: <fpage>e159</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Gray1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gray</surname><given-names>RT</given-names></name>, <name name-style="western"><surname>Fung</surname><given-names>CKC</given-names></name>, <name name-style="western"><surname>Robinson</surname><given-names>PA</given-names></name> (<year>2009</year>) <article-title>Stability of random brain networks with excitatory and inhibitory connections</article-title>. <source>Neurocomp</source> <volume>72</volume>: <fpage>1565</fpage>–<lpage>1574</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Farkas1">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Farkas</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Derényi</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Barabási</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Vicsek</surname><given-names>T</given-names></name> (<year>2001</year>) <article-title>Spectra of “real-world” graphs: Beyond the semicircle law</article-title>. <source>Phys Rev E</source> <volume>64</volume>: <fpage>026704</fpage>.</mixed-citation>
      </ref>
      <ref id="pone.0054383-Furedi1">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Furedi</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Kolmos</surname><given-names>J</given-names></name> (<year>1981</year>) <article-title>The eigenvalues of random symmetric matrices</article-title>. <source>Combinatorica</source> <volume>1</volume>: <fpage>233</fpage>–<lpage>241</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>