<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">07-PONE-RA-01771R1</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0000879</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Dating Phylogenies with Hybrid Local Molecular Clocks</article-title><alt-title alt-title-type="running-head">Hybrid Ad Hoc Dating</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Aris-Brosou</surname><given-names>Stéphane</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="n101"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Biology, University of Ottawa, Ontario, Canada</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Mathematics and Statistics, University of Ottawa, Ontario, Canada</addr-line>       </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Pybus</surname><given-names>Oliver</given-names></name><role>Academic Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of Oxford, United Kingdom</aff><author-notes><corresp id="n101">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">sarisbro@uottawa.ca</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: SA. Performed the experiments: SA. Analyzed the data: SA. Contributed reagents/materials/analysis tools: SA. Wrote the paper: SA.</p></fn><fn fn-type="conflict"><p>The author has declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><year>2007</year></pub-date><pub-date pub-type="epub"><day>12</day><month>9</month><year>2007</year></pub-date><volume>2</volume><issue>9</issue><elocation-id>e879</elocation-id><history><date date-type="received"><day>16</day><month>7</month><year>2007</year></date><date date-type="accepted"><day>23</day><month>8</month><year>2007</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Stephane Aris-Brosou</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><sec><title>Background</title><p>Because rates of evolution and species divergence times cannot be estimated directly from molecular data, all current dating methods require that specific assumptions be made before inferring any divergence time. These assumptions typically bear either on rates of molecular evolution (molecular clock hypothesis, local clocks models) or on both rates and times (penalized likelihood, Bayesian methods). However, most of these assumptions can affect estimated dates, oftentimes because they underestimate large amounts of rate change.</p></sec><sec><title>Principal Findings</title><p>A significant modification to a recently proposed ad hoc rate-smoothing algorithm is described, in which local molecular clocks are automatically placed on a phylogeny. This modification makes use of hybrid approaches that borrow from recent theoretical developments in microarray data analysis. An ad hoc integration of phylogenetic uncertainty under these local clock models is also described. The performance and accuracy of the new methods are evaluated by reanalyzing three published data sets.</p></sec><sec><title>Conclusions</title><p>It is shown that the new maximum likelihood hybrid methods can perform better than penalized likelihood and almost as well as uncorrelated Bayesian models. However, the new methods still tend to underestimate the actual amount of rate change. This work demonstrates the difficulty of estimating divergence times using local molecular clocks.</p></sec></abstract><funding-group><funding-statement>This work was supported in part by the University of Ottawa and by a grant from the Natural Sciences and Engineering Research Council (DG 311625).</funding-statement></funding-group><counts><page-count count="8"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Estimating divergence times from molecular data is a special statistical endeavor, as the parameters of interest cannot be directly estimated from molecular sequences: only distances between pairs of sequences or site likelihood values can be estimated. Such distances are measured in terms of the expected number of changes per site along the molecule (DNA, RNA or protein). This is equivalent to taking the product of a rate of molecular evolution and of a time duration, two quantities of significant biological interest. Unfortunately, neither rates nor times are identifiable parameters. As a result, estimating divergence times demands that special assumptions be posited. To this end, four approaches are commonly used in a model-based framework.</p><p>Until recently, the approach of choice to estimating divergence times was to assume the molecular clock <xref ref-type="bibr" rid="pone.0000879-Zuckerkandl1">[1]</xref>, i.e. that rates are constant over the entire history of the genes under study. Under this hypothesis, branch lengths are directly proportional to time, and the common evolutionary rate is determined by the placement of at least one fossil calibration point on the phylogeny. However, the development of specific hypothesis tests (e.g., ref. <xref ref-type="bibr" rid="pone.0000879-Felsenstein1">[2]</xref>) showed that the molecular clock is too often untenable <xref ref-type="bibr" rid="pone.0000879-Bromham1">[3]</xref>.</p><p>A second approach to estimating times while relaxing the above assumption of the clock is to posit several local clocks. The incentive here is that the clock hypothesis is likely to hold for closely related species <xref ref-type="bibr" rid="pone.0000879-Kishino1">[4]</xref>–<xref ref-type="bibr" rid="pone.0000879-Yoder1">[6]</xref>. Local clock models were recently extended to incorporate multiple calibration points and multiple genes <xref ref-type="bibr" rid="pone.0000879-Yang1">[7]</xref>. However, one important shortcoming of this approach is that the placement of the different local molecular clocks on the tree is left to the user's discretion. I show below how this can affect inference.</p><p>A third and alternative approach, pioneered by Sanderson, is to consider that rates of evolution evolve from ancestral rates. This implies that rates of evolution are (auto-) correlated <xref ref-type="bibr" rid="pone.0000879-Sanderson1">[8]</xref>. More recently, Sanderson <xref ref-type="bibr" rid="pone.0000879-Sanderson2">[9]</xref> proposed to use an approach that maximizes a penalized likelihood <italic>p</italic>(<italic>X</italic>|<bold><italic>r</italic></bold>.<bold><italic>t</italic></bold>)–<italic>λ</italic> Φ(<bold><italic>r</italic></bold>), where <italic>X</italic> is the data alignment and <bold><italic>r</italic></bold>.<bold><italic>t</italic></bold> represents the branch lengths, i.e. the product of rates <bold><italic>r</italic></bold> and times <bold><italic>t</italic></bold>. The penalty function Φ(<bold><italic>r</italic></bold>) is chosen in such a way that it is large when rates vary rapidly over small regions of the tree; the smoothing parameter <italic>λ</italic> is estimated by cross-validation <xref ref-type="bibr" rid="pone.0000879-Hastie1">[10]</xref>.</p><p>Expanding on this idea, Thorne and coworkers <xref ref-type="bibr" rid="pone.0000879-Thorne1">[11]</xref> proposed a Bayesian approach for estimating divergence times. This fourth approach relies on prior models of speciation and of autocorrelated rate change. These prior models are in fact equivalent to a particular penalty function in Sanderson's approach <xref ref-type="bibr" rid="pone.0000879-Hastie1">[10]</xref>, so that both of these approaches are often referred to as “regularization methods” in the literature of supervised learning. Although prior distributions and implementation details vary, the Bayesian approach and penalized likelihood both have in common to smooth or minimize rate variation over evolutionary time by means of an autocorrelated process. Because this can lead to inaccurate dates when rates vary extensively <xref ref-type="bibr" rid="pone.0000879-Ho1">[12]</xref>, a class of prior models of uncorrelated rate change were recently described <xref ref-type="bibr" rid="pone.0000879-Drummond1">[13]</xref>. A different Bayesian approach has also been described <xref ref-type="bibr" rid="pone.0000879-Huelsenbeck1">[14]</xref>, where rate change events are modeled as point processes on a phylogeny. This approach does have the potential of accommodating rapid rate variation, but the specific model used in that study was shown to be overparameterized <xref ref-type="bibr" rid="pone.0000879-Rannala1">[15]</xref>. Another potential issue, this time common to all Bayesian approaches, is the need to specify prior assumptions: some, such as prior distributions on the speciation process, are potentially overly informative <xref ref-type="bibr" rid="pone.0000879-ArisBrosou1">[16]</xref>, <xref ref-type="bibr" rid="pone.0000879-Welch1">[17]</xref>, while others, such as the root rate, can be difficult to set <xref ref-type="bibr" rid="pone.0000879-Won1">[18]</xref>. Bayesian approaches can also be computationally demanding.</p><p>An alternative to regularization methods is to reconsider local clocks. These models are expected to be able to accommodate high levels of rate heterogeneity, and therefore to perform better. However, as noted above, there are two difficulties with local clock models. First, the number of local clocks has to be chosen and second, local molecular clocks must be placed on a given phylogeny. Yang <xref ref-type="bibr" rid="pone.0000879-Yang2">[19]</xref> suggested a clever hybrid algorithm to address the second difficulty. This approach, called ad hoc rate-smoothing (AHRS), involves three steps: (i) branch lengths are estimated for each gene on a pre-specified common gene tree without the restriction of the clock; (ii) first, initial branch-specific rates of evolution are approximated based on a parametric smoothing approach that minimizes rate variation; then, an ad hoc clustering algorithm is used to group these branch-specific rates into clusters that constitute the local clocks; (iii) divergence times are finally estimated by maximum likelihood following <xref ref-type="bibr" rid="pone.0000879-Yang1">[7]</xref>. Note that step (ii) actually consists of two distinct stages. Confidence intervals can be obtained following standard asymptotic methods either based on a normal approximation of the likelihood surface or on the support curve <xref ref-type="bibr" rid="pone.0000879-Yang3">[20]</xref>. While the AHRS algorithm makes it possible to place the local molecular clocks on a phylogeny, the number of clocks is still left to users' discretion–the first “difficulty” highlighted above.</p><p>Here I present four new ad hoc methods that improve on Yang's AHRS algorithm. The methods described below essentially modify one or both stages of step (ii) of the original AHRS algorithm. The four new methods borrow from recent advancements in the field of statistical analysis of microarray data. As these new methods all rely on maximum likelihood estimation, they are apparently immune to the common criticisms that Bayesian approaches occasionally draw in particular with respect to the choice of a prior <xref ref-type="bibr" rid="pone.0000879-Felsenstein1">[2]</xref>, <xref ref-type="bibr" rid="pone.0000879-Edwards1">[21]</xref>, and that they are computationally efficient. I compare these methods with penalized likelihood <xref ref-type="bibr" rid="pone.0000879-Sanderson2">[9]</xref> and with a Bayesian model of uncorrelated rate change <xref ref-type="bibr" rid="pone.0000879-Drummond1">[13]</xref>, suggest a way to integrate phylogenetic uncertainty, and evaluate the performance and accuracy of these methods on three previously published data sets. The source code and precompiled binaries for common 64-bit architectures (x86, ultra-sparc and PPC) are available at <ext-link ext-link-type="uri" xlink:href="http://aix1.uottawa.ca/∼sarisbro" xlink:type="simple">http://aix1.uottawa.ca/∼sarisbro</ext-link>.</p></sec><sec id="s2"><title>Methods</title><sec id="s2a"><title>First improvements with k-means and k-medoids</title><p>In the original AHRS algorithm, branch lengths are first estimated by maximum likelihood (ML) without assuming the clock–see step (i) above. The likelihood surface is then approximated by a multivariate normal distribution <italic>N</italic> (<bold><italic>B</italic></bold>,<bold><italic>Σ</italic></bold>) centered on the ML estimates (MLEs) <bold><italic>B</italic></bold> of the branch lengths. The variance-covariace matrix <bold><italic>Σ</italic></bold> is approximated by the diagonal variance matrix of the estimates of the branch lengths–note that these variances were previously estimated during the optimization in step (i). This approximation of <bold><italic>Σ</italic></bold> assumes that there is no correlation between these MLEs, which is computationally faster than the approximation based on the full Hessian matrix as e.g. in <xref ref-type="bibr" rid="pone.0000879-Thorne1">[11]</xref>, <xref ref-type="bibr" rid="pone.0000879-Yang2">[19]</xref>, <xref ref-type="bibr" rid="pone.0000879-Kishino2">[22]</xref>. A Brownian motion model <xref ref-type="bibr" rid="pone.0000879-Thorne1">[11]</xref>, <xref ref-type="bibr" rid="pone.0000879-Kishino2">[22]</xref> is then used to estimate by ML the initial branch-specific rates at beginning of step (ii) as in <xref ref-type="bibr" rid="pone.0000879-Yang2">[19]</xref>. Following this, the AHRS algorithm uses an ad hoc clustering scheme to group similar rates into local clocks. Briefly, the interval bounded by the smallest (<italic>m</italic>) and the largest (<italic>M</italic>) initial rate estimates is divided up into <italic>k</italic> groups; the coordinates of the cutoff points are solely a function of <italic>m</italic>, <italic>M</italic> and <italic>k</italic>. Here, I reused all these steps and modified the source code of PAML ver. 3.14 <xref ref-type="bibr" rid="pone.0000879-Yang4">[23]</xref> to incorporate two true clustering schemes: the k-means algorithm <xref ref-type="bibr" rid="pone.0000879-Hartigan1">[24]</xref> and the k-medoids algorithm <xref ref-type="bibr" rid="pone.0000879-Kaufman1">[25]</xref>. The k-means algorithm was run with 1,000 random starts to find the solution with lowest within-cluster sums of squared dissimilarities. Unlike k-means, k-medoids minimizes a sum of dissimilarities and is therefore expected to be more robust. Both algorithms were used as implemented in R (cran.r-project.org, in the stat and cluster packages). R was called externally from PAML.</p><p>The estimation of the number of clocks in a standard likelihood framework is not easy, as the models are generally not nested and are typically derived from the data. Instead, the number of clocks was in a first approach selected using an idea based on the gap statistic <xref ref-type="bibr" rid="pone.0000879-Tibshirani1">[26]</xref>: if there were actually <italic>k</italic>* clocks on the tree, then for <italic>k</italic>&lt;<italic>k</italic>*, each partition calculated by the algorithm would contain a subset of the actual groups of branches, and the algorithm would not assign branches as it “should”. Therefore, the likelihood should increase substantially each time <italic>k</italic> is increased. Now for <italic>k</italic>&gt;<italic>k</italic>*, one of the calculated clusters would partition one or more of the actual groups, which should tend to provide smaller likelihood increases. Indeed, splitting a genuine group is not expected to increase the likelihood more than partitioning the union of two clearly separated groups. As a result, when the log-likelihood is plotted as a function of <italic>k</italic>, there should be a kink in the plot. A natural estimate of <italic>k</italic>* can be taken at this value, that is, at the largest gap in likelihood values between two consecutive values of <italic>k</italic>.</p></sec><sec id="s2b"><title>Automatic estimation of the number of clocks with silhouettes and HOPACH</title><p>Our loose implementation of the gap statistic does not allow for a rigorous estimation of the number of local clocks. However, the k-medoids algorithm offers the possibility to select the number of clusters according to the Median Split Silhouette or MSS <xref ref-type="bibr" rid="pone.0000879-Pollard1">[27]</xref>. Based on normalized differences of dissimilarities, silhouettes measure the homogeneity of each element when grouped in a cluster compared to the situation where this element is left out. The median of these measures taken over all elements and over all clusters is a measure of the homogeneity of each cluster, and therefore constitutes an objective function to find the most appropriate number of clusters.</p><p>In cases where branch-specific rates of evolution vary rapidly, MSS may not be aggressive enough to find small clusters. A more recent method, the Hierarchical Ordered Partitioning and Collapsing Hybrid or HOPACH <xref ref-type="bibr" rid="pone.0000879-vanderLaan1">[28]</xref> aims at finding such small clusters. Although HOPACH makes use of a partitioning method based on k-medoids, it is actually a hierarchical method. As such, it involves the construction of a tree of clusters where the “root” of the hierarchy contains all the elements (here, all the branch-specific rates) and where each leaf contains one single element. HOPACH is an iterative algorithm that starts with all the elements at the root node of the hierarchy, and that cycles through partitioning, ordering and collapsing as follows. At each level of the hierarchy, the partitioning step uses k-medoids and silhouettes to determine the clusters, which are then ordered according to the dissimilarity between their medoids or centers. Below root-level, pairs of clusters are collapsed if and only if doing so improves the median split silhouette. The algorithm stops when each node contains at most two elements, or when a maximum number of levels is reached, whichever comes first. Because the elements contained at each level of the hierarchy are labeled with integers, this upper bound is set to 16 levels in the current implementation of the R package hopach (ver. 1.4.0) to avoid overflows.</p><p>However, for identifiability reasons, we cannot afford as many local clocks as there are branches in the tree. Under the multiple gene models used here, where branch-specific rates are estimated separately and independently for each of the <italic>g</italic> genes <xref ref-type="bibr" rid="pone.0000879-Yang1">[7]</xref>, there is a total of <italic>kg</italic> rate parameters when <italic>k</italic> local clocks are used. With <italic>n</italic> sequences and <italic>c</italic> calibration points, we want to estimate <italic>n</italic>–1–<italic>c</italic> divergence times, so that there is a total of <italic>n</italic>–1–<italic>c</italic>+<italic>kg</italic> parameters to estimate. The total number of identifiable parameters is (2<italic>n</italic>–3) <italic>g</italic>, so that <italic>k</italic>, the number of local clocks, should not exceed <italic>U</italic> = 2<italic>n</italic>–3–(<italic>n</italic>–1–<italic>c</italic>)/<italic>g</italic>. For this reason, the maximum number of clusters returned by MSS and HOPACH was limited to int(<italic>U</italic>), the integer part of <italic>U</italic>. Yet, even when <italic>k</italic>&lt;<italic>U</italic>, certain placements of the local clocks make it impossible to identify all model parameters–see <xref ref-type="bibr" rid="pone.0000879-Yoder1">[6]</xref> for a practical example. To help guarantee against this serious issue, convergence of our procedures was checked by running each likelihood analysis a thousand times starting from random initial parameters.</p></sec><sec id="s2c"><title>Improved initial branch-specific rates</title><p>Like the original AHRS algorithm, the new ad hoc methods presented here all critically rely on the initial ML estimation of the branch-specific rates of evolution (step (i) of AHRS). These rates are the starting point of the clustering procedures used to determine both the placement and the number of local clocks over the tree. Instead of estimating these initial branch-specific rates with Brownian motion model, these initial rates were also obtained with a Bayesian procedure, before being clustered into local clocks. Here I used the Bayesian approach detailed below to determine these rates under an uncorrelated lognormal model of rate change <xref ref-type="bibr" rid="pone.0000879-Drummond1">[13]</xref>.</p></sec><sec id="s2d"><title>Ad hoc integration of phylogenetic uncertainty</title><p>The objective here is not to implement a Bayesian version of local clock models, one that would integrate over tree topologies. However, I indicate two approximations for dealing with phylogenetic uncertainty with these models. The most appropriate ad hoc procedure would follow two steps. First, draw samples from the posterior distribution <italic>p</italic>(<italic>τ</italic> | <italic>X</italic>) = ∫<sub>Θ</sub> <italic>p</italic>(<italic>τ</italic>, <bold><italic>θ</italic></bold> | <italic>X</italic>) <italic>d</italic><bold><italic>θ</italic></bold> , where <italic>X</italic> represents the aligned data, <italic>τ</italic> is the tree topology and <bold><italic>θ</italic></bold> is a vector of nuisance parameters, typically the branch lengths and the parameters of the substitution model. The model should not enforce the clock. If the sampled trees are not rooted they should be rooted before moving on to the next step. Second, evaluate divergence times for all the samples drawn during the previous step. The “posterior” estimate of the divergence time at a given bipartition is then estimated as the average time estimated for each of the sampled trees, when this bipartition exists. The last restriction is equivalent to enforcing a number of monophyletic relationships. This second step is the most computationally demanding as it requires performing ML optimizations for each sample drawn from the Markov chain in step one. A similar two-step approach was previously used to infer the ancestral state of morphological characters in the presence of phylogenetic uncertainty <xref ref-type="bibr" rid="pone.0000879-Pagel1">[29]</xref>–see <xref ref-type="bibr" rid="pone.0000879-Prudhomme1">[30]</xref> for a recent application.</p><p>Rather than following this direction here, I used an even more ad hoc but faster procedure. Trees were sampled from their posterior distribution with MrBayes ver. 3.1.2 <xref ref-type="bibr" rid="pone.0000879-Ronquist1">[31]</xref> with tempering (four chains). Four such independent samplers were run for five million steps with thinning of 1,000 and a burn-in of a million. Divergence times were then estimated with the local clock models described above for each of the topologies contained in the 95% credibility set: the original AHRS, the k-means and the k-medoids algorithms (the number of clocks was estimated with the gap method for all these three), MSS and HOPACH. As above, the ML optimization procedures were repeated (only 20 times here) to check convergence and identifiability.</p></sec><sec id="s2e"><title>Data sets and models of evolution</title><p>I evaluated the performance of the new methods on three previously published data sets. The first one is a mouse lemur data set repeatedly used when developing dating methods <xref ref-type="bibr" rid="pone.0000879-Yang1">[7]</xref>, <xref ref-type="bibr" rid="pone.0000879-Yang2">[19]</xref>. This data set contains the concatenated sequences of two mitochondrial genes, COX-II and CYT-b, sampled over a total of 35 mammalian species. The objective of the original study <xref ref-type="bibr" rid="pone.0000879-Yang1">[7]</xref> was to estimate divergence times of mouse lemurs (genus: Microcebus), the world's smallest primates, endemic to Madagascar. The data contained 604 codons and the analyses assumed the one-ratio model <xref ref-type="bibr" rid="pone.0000879-Goldman1">[32]</xref>. All model parameters were estimated by ML, except equilibrium frequencies, calculated assuming the F3×4 model. Seven calibration points were used to estimate divergence times as in <xref ref-type="bibr" rid="pone.0000879-Yang2">[19]</xref>–seeSupp orting Information <xref ref-type="supplementary-material" rid="pone.0000879.s001">Figure S1</xref>. This data set was used here to test whether the new clustering methods can improve on some of the shortcomings of the original AHRS method.</p><p>The accuracy of the new methods was then evaluated by reanalyzing a sea urchin data set for which the fossil record is considered excellent <xref ref-type="bibr" rid="pone.0000879-Smith1">[33]</xref>. This data set consists of three rRNA genes, one mitochondrial (16S large subunit) and two nuclear (18S small subunit and 28S large subunit) genes. I used the unpartitioned alignment of 3,331bp for 28 species as the original authors (see Table 2 in <xref ref-type="bibr" rid="pone.0000879-Smith1">[33]</xref>). Because the GTR+Γ<sub>6</sub>+I substitution model <xref ref-type="bibr" rid="pone.0000879-Tavare1">[34]</xref>, <xref ref-type="bibr" rid="pone.0000879-Yang5">[35]</xref> used in <xref ref-type="bibr" rid="pone.0000879-Smith1">[33]</xref> is not available in PAML's local clock implementation, I used HKY+Γ<sub>5</sub> <xref ref-type="bibr" rid="pone.0000879-Hasegawa1">[36]</xref>; five rate categories were used for computational reasons. Unlike the quite unfavorable calibrating situation represented by the mouse lemur data, the four calibration points used by <xref ref-type="bibr" rid="pone.0000879-Smith1">[33]</xref> and here are quite evenly distributed over the tree, and vary from 55 to 210 MY of age.</p><p>A third data set was used to assess the impact of uncertainty over tree topologies when estimating species divergence times. I reused the alignment originally assembled by <xref ref-type="bibr" rid="pone.0000879-AmrineMadsen1">[37]</xref> and reanalyzed by <xref ref-type="bibr" rid="pone.0000879-Drummond1">[13]</xref>. The alignment contains five protein-coding genes (APOB, RAG1, IRBP, vWF, and BRCA1) for 24 taxa. All 3,772 positions were analyzed as one single partition. Four calibration points were used as in <xref ref-type="bibr" rid="pone.0000879-Drummond1">[13]</xref>. The Bayesian model placed normal priors of variance 5 MY on the three internal nodes and constrained the root node around 145 MY with an exponential prior as in <xref ref-type="bibr" rid="pone.0000879-Drummond1">[13]</xref>. The substitution model was again set to HKY+Γ<sub>5</sub>. This substitution model is slightly simpler than the one used by <xref ref-type="bibr" rid="pone.0000879-Drummond1">[13]</xref>, as the dating approaches described here do not allow for invariant sites or more complicated models such as GTR.</p></sec><sec id="s2f"><title>Comparison with other dating approaches</title><p>The methods described above were compared with two existing dating methods: penalized likelihood and an uncorrelated Bayesian model of rate change. Simulations are often considered as an important step in checking the validity of a method, as they permit to check that a method returns the correct answer, at least under simple scenarios. However, because real sequence data rarely evolve following simple models and because a given simulation model can bias the results towards a particular direction <xref ref-type="bibr" rid="pone.0000879-ArisBrosou2">[38]</xref>, <xref ref-type="bibr" rid="pone.0000879-ArisBrosou3">[39]</xref>, I resorted to a different approach here, and used the data set from <xref ref-type="bibr" rid="pone.0000879-Smith1">[33]</xref> for which the actual fossil record is unusually complete. For this specific data set, it was found <xref ref-type="bibr" rid="pone.0000879-Smith1">[33]</xref> that the penalized likelihood approach <xref ref-type="bibr" rid="pone.0000879-Sanderson2">[9]</xref> seemed to perform better than both nonparametric rate smoothing <xref ref-type="bibr" rid="pone.0000879-Sanderson1">[8]</xref> and a Bayesian approach <xref ref-type="bibr" rid="pone.0000879-Thorne1">[11]</xref>. As the objective here was not to reevaluate all existing dating methods against the ones presented here, I focused on the “best” method identified by <xref ref-type="bibr" rid="pone.0000879-Smith1">[33]</xref>, namely, penalized likelihood (PL). I recalculated date estimates using PL with r8s ver.1.70 <xref ref-type="bibr" rid="pone.0000879-Sanderson3">[40]</xref> following two approaches: PL<sup>(CV)</sup> and PL<sup>(SSD)</sup>, where CV and SSD stand for cross-validation and sum of the squared distances, respectively. The first, PL<sup>(CV)</sup>, used cross-validation <xref ref-type="bibr" rid="pone.0000879-Sanderson2">[9]</xref>; this is usually the only method that can be used when the actual dates are unknown. The accuracy of PL<sup>(CV)</sup> was determined with the second approach: PL<sup>(SSD)</sup>. When the actual divergence times are known for all the nodes on the tree, as with the sea urchin data set, it is possible to select the smoothing parameter <italic>λ</italic> that best fits the actual fossil dates. To this effect, <italic>λ</italic> was varied from 0 to 10<sup>5</sup> by increments of 10. The “best fit” was quantitatively measured by the sum of the squared distances (SSD) between each time estimate and its corresponding fossil age. The minimum SSD corresponds to the set of ages that is closest to the actual fossil dates. Note that by taking the square of these distances, this criterion penalizes methods that have large discrepancies between time estimates and fossil ages. This SSD criterion made it possible to assess the performance of PL and of the new ad hoc methods. The number of clocks <italic>k</italic> under k-medoids was optimized in a similar way.</p><p>The uncorrelated Bayesian model of rate change implemented in BEAST ver. 1.4.4 <xref ref-type="bibr" rid="pone.0000879-Drummond1">[13]</xref> was used to estimate divergence times and to determine rates. The substitution models matched those used for the ML analyses. I assumed the uncorrelated lognormal (UCLN) prior model of rate change, and a Yule or “pure-birth” prior process to model speciation. For each data set, two samplers were run independently with BEAST, each for 50 million steps with a thinning of 1,000. Five million steps were discarded as burn-in. Convergence of the Bayesian analyses, including the MrBayes runs for the ad hoc integration of phylogeny, was checked with Tracer (tree.bio.ed.ac.uk /software/tracer).</p></sec></sec><sec id="s3"><title>Results</title><sec id="s3a"><title>Mouse lemur data: the benchmark data</title><p>The first important question is to what extent the number <italic>k</italic> of local clocks can affect the estimation of divergence times. The divergence time of some nodes can be relatively insensitive to <italic>k</italic>. For instance, with the k-means clustering algorithm, the estimated dates for the hominoid divergence (node 59 in <xref ref-type="table" rid="pone-0000879-t001">Table 1</xref>) vary from 13.5 million years (MY) to 13 MY when the number of local clocks <italic>k</italic> is varied from one, which is the molecular clock assumption, to six. But the age of some other nodes can be more difficult to estimate. Such is the case with Microcebus diversification (node 45 in <xref ref-type="table" rid="pone-0000879-t001">Table 1</xref>). <xref ref-type="fig" rid="pone-0000879-g001">Figure 1</xref> shows that irrespective of the clustering algorithm used, the age of this diversification varies between about 8 MY with two clocks, to an age less than half this figure with more than 15 clocks. It is therefore quite important to have a means of estimating the most appropriate number of clocks.</p><fig id="pone-0000879-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0000879.g001</object-id><label>Figure 1</label><caption><title>Effect of the number of local clocks on the age of a node far from all calibration points.</title><p>Times were estimated using either the original AHRS algorithm or k-means and are given in million years ago (MYA). The focal node is the split at the origin of the mouse lemurs (genus Microcebus).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0000879.g001" xlink:type="simple"/></fig><table-wrap id="pone-0000879-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0000879.t001</object-id><label>Table 1</label><caption><title>Maximum likelihood estimates of divergence times for the mouse lemur data under nucleotide and codon models.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0000879-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0000879.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1">node #</td><td align="left" colspan="1" rowspan="1">split</td><td align="left" colspan="1" rowspan="1">original</td><td align="left" colspan="1" rowspan="1">kmeans</td><td align="left" colspan="1" rowspan="1">kmedoids</td><td align="left" colspan="1" rowspan="1">HOPACH</td><td align="left" colspan="1" rowspan="1">MSS</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">38</td><td align="left" colspan="1" rowspan="1">Strepsirrhine</td><td align="left" colspan="1" rowspan="1">56.3</td><td align="left" colspan="1" rowspan="1">50.1</td><td align="left" colspan="1" rowspan="1">50.3</td><td align="left" colspan="1" rowspan="1">50.6</td><td align="left" colspan="1" rowspan="1">62.0</td></tr><tr><td align="left" colspan="1" rowspan="1">39</td><td align="left" colspan="1" rowspan="1">lemuriform</td><td align="left" colspan="1" rowspan="1">47.3</td><td align="left" colspan="1" rowspan="1">43.8</td><td align="left" colspan="1" rowspan="1">44.2</td><td align="left" colspan="1" rowspan="1">44.5</td><td align="left" colspan="1" rowspan="1">55.0</td></tr><tr><td align="left" colspan="1" rowspan="1">43</td><td align="left" colspan="1" rowspan="1">Cheirogaleidae</td><td align="left" colspan="1" rowspan="1">17.7</td><td align="left" colspan="1" rowspan="1">14.9</td><td align="left" colspan="1" rowspan="1">12.9</td><td align="left" colspan="1" rowspan="1">13.8</td><td align="left" colspan="1" rowspan="1">29.8</td></tr><tr><td align="left" colspan="1" rowspan="1"><bold>45</bold></td><td align="left" colspan="1" rowspan="1"><bold>mouse lemurs</bold></td><td align="left" colspan="1" rowspan="1"><bold>7.6</bold></td><td align="left" colspan="1" rowspan="1"><bold>5.2</bold></td><td align="left" colspan="1" rowspan="1"><bold>4.5</bold></td><td align="left" colspan="1" rowspan="1"><bold>4.9</bold></td><td align="left" colspan="1" rowspan="1"><bold>12.0</bold></td></tr><tr><td align="left" colspan="1" rowspan="1">46</td><td align="left" colspan="1" rowspan="1">northern clade</td><td align="left" colspan="1" rowspan="1">6.0</td><td align="left" colspan="1" rowspan="1">4.1</td><td align="left" colspan="1" rowspan="1">3.5</td><td align="left" colspan="1" rowspan="1">3.9</td><td align="left" colspan="1" rowspan="1">9.6</td></tr><tr><td align="left" colspan="1" rowspan="1">52</td><td align="left" colspan="1" rowspan="1">southern clade</td><td align="left" colspan="1" rowspan="1">5.3</td><td align="left" colspan="1" rowspan="1">3.7</td><td align="left" colspan="1" rowspan="1">3.1</td><td align="left" colspan="1" rowspan="1">3.4</td><td align="left" colspan="1" rowspan="1">8.9</td></tr><tr><td align="left" colspan="1" rowspan="1">53</td><td align="left" colspan="1" rowspan="1">Lemuridae</td><td align="left" colspan="1" rowspan="1">21.4</td><td align="left" colspan="1" rowspan="1">18.9</td><td align="left" colspan="1" rowspan="1">19.1</td><td align="left" colspan="1" rowspan="1">19.2</td><td align="left" colspan="1" rowspan="1">24.1</td></tr><tr><td align="left" colspan="1" rowspan="1">56</td><td align="left" colspan="1" rowspan="1">lorisiform</td><td align="left" colspan="1" rowspan="1">31.6</td><td align="left" colspan="1" rowspan="1">25.9</td><td align="left" colspan="1" rowspan="1">25.9</td><td align="left" colspan="1" rowspan="1">26.0</td><td align="left" colspan="1" rowspan="1">33.3</td></tr><tr><td align="left" colspan="1" rowspan="1">57</td><td align="left" colspan="1" rowspan="1">anthropoid</td><td align="left" colspan="1" rowspan="1">58.8</td><td align="left" colspan="1" rowspan="1">59.6</td><td align="left" colspan="1" rowspan="1">59.6</td><td align="left" colspan="1" rowspan="1">59.6</td><td align="left" colspan="1" rowspan="1">60.7</td></tr><tr><td align="left" colspan="1" rowspan="1">59</td><td align="left" colspan="1" rowspan="1">hominoid</td><td align="left" colspan="1" rowspan="1">13.2</td><td align="left" colspan="1" rowspan="1">13.9</td><td align="left" colspan="1" rowspan="1">13.9</td><td align="left" colspan="1" rowspan="1">13.9</td><td align="left" colspan="1" rowspan="1">15.8</td></tr><tr><td align="left" colspan="1" rowspan="1"><bold>61</bold></td><td align="left" colspan="1" rowspan="1"><bold>human/chimp</bold></td><td align="left" colspan="1" rowspan="1"><bold>7.0</bold></td><td align="left" colspan="1" rowspan="1"><bold>7.3</bold></td><td align="left" colspan="1" rowspan="1"><bold>7.3</bold></td><td align="left" colspan="1" rowspan="1"><bold>7.3</bold></td><td align="left" colspan="1" rowspan="1"><bold>7.0</bold></td></tr><tr><td align="left" colspan="1" rowspan="1">64</td><td align="left" colspan="1" rowspan="1">dog/bear</td><td align="left" colspan="1" rowspan="1">40.9</td><td align="left" colspan="1" rowspan="1">45.4</td><td align="left" colspan="1" rowspan="1">45.4</td><td align="left" colspan="1" rowspan="1">45.4</td><td align="left" colspan="1" rowspan="1">41.4</td></tr><tr><td align="left" colspan="1" rowspan="1">lnL</td><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">−25053.27</td><td align="left" colspan="1" rowspan="1">−25060.11</td><td align="left" colspan="1" rowspan="1">−25060.35</td><td align="left" colspan="1" rowspan="1">−25060.54</td><td align="left" colspan="1" rowspan="1">−24869.79</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt101"><p>Times are in million years ago.</p></fn><fn id="nt102"><p>Notes–lnL: log-likelihood.</p></fn></table-wrap-foot></table-wrap><p>A second point should be made here. <xref ref-type="fig" rid="pone-0000879-g001">Figure 1</xref> also shows that local molecular clocks can experience some identifiability issues for some placements of the clocks (e.g., at <italic>k</italic> = 9) and further difficulties when the number of clocks becomes too large (over 17 clocks in the case of this data set). A careful examination revealed that when the number of clocks increases, the ad hoc clustering algorithm used in AHRS eventually returns a number of empty clusters. This is because once the lower and upper bounds of the initial rates are estimated (during step (i) of AHRS), cluster boundaries are set deterministically, disregarding the distribution of these initial rates. Standard clustering algorithms such as k-means appear to resolve this problem (<xref ref-type="fig" rid="pone-0000879-g001">Figure 1</xref>), at least in this specific example.</p><p>With a proper clustering algorithm, how difficult is it to find the appropriate number of clocks? Another important observation from <xref ref-type="fig" rid="pone-0000879-g001">Figure 1</xref> is that implementing two or three local clocks affects age estimates quite dramatically. These estimates range from 10.93 MY under a global clock to 7.5 MY with three local clocks. With more than three clocks, age estimates change less rapidly. <xref ref-type="fig" rid="pone-0000879-g002">Figure 2</xref> plots the log-likelihood under a codon model as a function of <italic>k</italic>. The application of the idea behind the gap statistic to this figure suggests that the appropriate number of clocks is three for this data set. As a more rigorous approach than our implementation of the gap statistic, HOPACH finds the same number of local clocks (<italic>k</italic>* = 3) and distributes them similarly to k-medoids over the phylogeny (Supporting Information <xref ref-type="supplementary-material" rid="pone.0000879.s001">Figure S1</xref>). The likelihood scores obtained under the codon model (<xref ref-type="table" rid="pone-0000879-t001">Table 1</xref>) are slightly smaller than in <xref ref-type="bibr" rid="pone.0000879-Yang2">[19]</xref> as our procedures consistently selected three local clocks instead of four <xref ref-type="bibr" rid="pone.0000879-Yang2">[19]</xref>. Both k-medoids and HOPACH suggest similar age estimates (<xref ref-type="table" rid="pone-0000879-t001">Table 1</xref>), with most notably a recent diversification (&lt;5 MY) of the genus Microcebus. MSS on the other hand suggests one additional clock, with a fragmented partition scheme over the phylogeny (Supporting Information <xref ref-type="supplementary-material" rid="pone.0000879.s001">Figure S1</xref>) and a dramatically different picture of the diversification of mouse lemurs, suggesting that these would date back to 12 MY ago (<xref ref-type="table" rid="pone-0000879-t001">Table 1</xref>). Because of a recently found 38–42 MY fossil for the ancestor of loris and galago <xref ref-type="bibr" rid="pone.0000879-Seiffert1">[41]</xref>, Yang suggested that an age of 5 MY is too young for the mouse lemur divergence, and found an age of 11.4 MY only after including the additional information about this extra fossil in the analysis <xref ref-type="bibr" rid="pone.0000879-Yang2">[19]</xref>. Our MSS results under a codon model (divergence at 12.0 MY) may suggest that sufficient information exists in the data without this additional calibration point. However, this result is not confirmed by the use of MSS under a nucleotide model (F84+Γ<sub>5</sub>: divergence at 6.6 MY). This difference is likely to be due to the relative number of clocks estimated under each model for a given data set: under a codon substitution model, MSS has here the largest number of clocks (Supporting Information <xref ref-type="supplementary-material" rid="pone.0000879.s001">Figure S1</xref>), while under a nucleotide substitution model, it is HOPACH that has the largest <italic>k</italic>* (Supporting Information <xref ref-type="supplementary-material" rid="pone.0000879.s002">Figure S2</xref>). This raises the important question about the accuracy of these approaches.</p><fig id="pone-0000879-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0000879.g002</object-id><label>Figure 2</label><caption><title>Maximum likelihood score as a function of the number of clocks.</title></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0000879.g002" xlink:type="simple"/></fig></sec><sec id="s3b"><title>Sea urchin data: accuracy against the fossil record</title><p>When only four calibration points are used, MSS had the second best accuracy (smallest SSD in <xref ref-type="table" rid="pone-0000879-t002">Table 2</xref>; disregarding the last column for now). However, when all the fossil dates are considered, PL<sup>(SSD)</sup> and k-medoids optimized for <italic>k</italic> show that even MSS tends to underestimate rate change, and hence the number of clocks. This suggests that it might be difficult to accommodate in a statistically sound manner actual amounts of rate variation in real data with these maximum likelihood methods.</p><table-wrap id="pone-0000879-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0000879.t002</object-id><label>Table 2</label><caption><title>Comparison of divergence times from fossils with those estimated from molecular data and four calibration points for the sea urchin data.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0000879-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0000879.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1">Smith nodes<xref ref-type="table-fn" rid="nt104">¶</xref></td><td align="left" colspan="1" rowspan="1">Fossil age <xref ref-type="table-fn" rid="nt104">†</xref></td><td align="left" colspan="1" rowspan="1">PL<sup>(CV)</sup> <xref ref-type="table-fn" rid="nt104">¥</xref></td><td align="left" colspan="1" rowspan="1">PL<sup>(SSD) </sup>(λ = 100)</td><td align="left" colspan="1" rowspan="1">k-med<xref ref-type="table-fn" rid="nt104">¥ </xref>k = 3</td><td align="left" colspan="1" rowspan="1">k-med k = 12</td><td align="left" colspan="1" rowspan="1">HOPACH<xref ref-type="table-fn" rid="nt104">¥</xref></td><td align="left" colspan="1" rowspan="1">MSS<xref ref-type="table-fn" rid="nt104">¥</xref></td><td align="left" colspan="1" rowspan="1">MSS+UCLN<xref ref-type="table-fn" rid="nt104">¥</xref></td><td align="left" colspan="1" rowspan="1">UCLN<xref ref-type="table-fn" rid="nt104">¥</xref></td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">root</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">255</td></tr><tr><td align="left" colspan="1" rowspan="1">1</td><td align="left" colspan="1" rowspan="1">220</td><td align="left" colspan="1" rowspan="1">189</td><td align="left" colspan="1" rowspan="1">190</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">225</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">255</td><td align="left" colspan="1" rowspan="1">233</td></tr><tr><td align="left" colspan="1" rowspan="1">2</td><td align="left" colspan="1" rowspan="1">210</td><td align="left" colspan="1" rowspan="1">187</td><td align="left" colspan="1" rowspan="1">189</td><td align="left" colspan="1" rowspan="1">245</td><td align="left" colspan="1" rowspan="1">210</td><td align="left" colspan="1" rowspan="1">239</td><td align="left" colspan="1" rowspan="1">241</td><td align="left" colspan="1" rowspan="1">225</td><td align="left" colspan="1" rowspan="1">246</td></tr><tr><td align="left" colspan="1" rowspan="1">3</td><td align="left" colspan="1" rowspan="1">210</td><td align="left" colspan="1" rowspan="1">163</td><td align="left" colspan="1" rowspan="1">171</td><td align="left" colspan="1" rowspan="1">245</td><td align="left" colspan="1" rowspan="1">210</td><td align="left" colspan="1" rowspan="1">239</td><td align="left" colspan="1" rowspan="1">241</td><td align="left" colspan="1" rowspan="1">225</td><td align="left" colspan="1" rowspan="1">216</td></tr><tr><td align="left" colspan="1" rowspan="1">4<xref ref-type="table-fn" rid="nt104">‡</xref></td><td align="left" colspan="1" rowspan="1">210</td><td align="left" colspan="1" rowspan="1">135</td><td align="left" colspan="1" rowspan="1">150</td><td align="left" colspan="1" rowspan="1">210</td><td align="left" colspan="1" rowspan="1">210</td><td align="left" colspan="1" rowspan="1">210</td><td align="left" colspan="1" rowspan="1">210</td><td align="left" colspan="1" rowspan="1">210</td><td align="left" colspan="1" rowspan="1">210</td></tr><tr><td align="left" colspan="1" rowspan="1">5</td><td align="left" colspan="1" rowspan="1">200</td><td align="left" colspan="1" rowspan="1">175</td><td align="left" colspan="1" rowspan="1">179</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">173</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">213</td></tr><tr><td align="left" colspan="1" rowspan="1">6</td><td align="left" colspan="1" rowspan="1">185</td><td align="left" colspan="1" rowspan="1">164</td><td align="left" colspan="1" rowspan="1">173</td><td align="left" colspan="1" rowspan="1">131</td><td align="left" colspan="1" rowspan="1">173</td><td align="left" colspan="1" rowspan="1">129</td><td align="left" colspan="1" rowspan="1">125</td><td align="left" colspan="1" rowspan="1">147</td><td align="left" colspan="1" rowspan="1">188</td></tr><tr><td align="left" colspan="1" rowspan="1">7</td><td align="left" colspan="1" rowspan="1">175</td><td align="left" colspan="1" rowspan="1">148</td><td align="left" colspan="1" rowspan="1">161</td><td align="left" colspan="1" rowspan="1">131</td><td align="left" colspan="1" rowspan="1">173</td><td align="left" colspan="1" rowspan="1">129</td><td align="left" colspan="1" rowspan="1">125</td><td align="left" colspan="1" rowspan="1">147</td><td align="left" colspan="1" rowspan="1">172</td></tr><tr><td align="left" colspan="1" rowspan="1">8</td><td align="left" colspan="1" rowspan="1">105</td><td align="left" colspan="1" rowspan="1">124</td><td align="left" colspan="1" rowspan="1">136</td><td align="left" colspan="1" rowspan="1">117</td><td align="left" colspan="1" rowspan="1">156</td><td align="left" colspan="1" rowspan="1">107</td><td align="left" colspan="1" rowspan="1">111</td><td align="left" colspan="1" rowspan="1">121</td><td align="left" colspan="1" rowspan="1">137</td></tr><tr><td align="left" colspan="1" rowspan="1">9</td><td align="left" colspan="1" rowspan="1">105</td><td align="left" colspan="1" rowspan="1">97</td><td align="left" colspan="1" rowspan="1">105</td><td align="left" colspan="1" rowspan="1">94</td><td align="left" colspan="1" rowspan="1">119</td><td align="left" colspan="1" rowspan="1">89</td><td align="left" colspan="1" rowspan="1">90</td><td align="left" colspan="1" rowspan="1">90</td><td align="left" colspan="1" rowspan="1">106</td></tr><tr><td align="left" colspan="1" rowspan="1">10</td><td align="left" colspan="1" rowspan="1">85</td><td align="left" colspan="1" rowspan="1">38</td><td align="left" colspan="1" rowspan="1">73</td><td align="left" colspan="1" rowspan="1">71</td><td align="left" colspan="1" rowspan="1">119</td><td align="left" colspan="1" rowspan="1">43</td><td align="left" colspan="1" rowspan="1">73</td><td align="left" colspan="1" rowspan="1">36</td><td align="left" colspan="1" rowspan="1">41</td></tr><tr><td align="left" colspan="1" rowspan="1">11<xref ref-type="table-fn" rid="nt104">‡</xref></td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">86</td><td align="left" colspan="1" rowspan="1">90</td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">89</td></tr><tr><td align="left" colspan="1" rowspan="1">12</td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">37</td><td align="left" colspan="1" rowspan="1">35</td><td align="left" colspan="1" rowspan="1">36</td><td align="left" colspan="1" rowspan="1">39</td><td align="left" colspan="1" rowspan="1">38</td><td align="left" colspan="1" rowspan="1">33</td><td align="left" colspan="1" rowspan="1">38</td><td align="left" colspan="1" rowspan="1">40</td></tr><tr><td align="left" colspan="1" rowspan="1">13</td><td align="left" colspan="1" rowspan="1">30</td><td align="left" colspan="1" rowspan="1">74</td><td align="left" colspan="1" rowspan="1">75</td><td align="left" colspan="1" rowspan="1">51</td><td align="left" colspan="1" rowspan="1">46</td><td align="left" colspan="1" rowspan="1">51</td><td align="left" colspan="1" rowspan="1">50</td><td align="left" colspan="1" rowspan="1">51</td><td align="left" colspan="1" rowspan="1">68</td></tr><tr><td align="left" colspan="1" rowspan="1">14</td><td align="left" colspan="1" rowspan="1">170</td><td align="left" colspan="1" rowspan="1">144</td><td align="left" colspan="1" rowspan="1">157</td><td align="left" colspan="1" rowspan="1">119</td><td align="left" colspan="1" rowspan="1">173</td><td align="left" colspan="1" rowspan="1">129</td><td align="left" colspan="1" rowspan="1">125</td><td align="left" colspan="1" rowspan="1">147</td><td align="left" colspan="1" rowspan="1">168</td></tr><tr><td align="left" colspan="1" rowspan="1">15<xref ref-type="table-fn" rid="nt104">‡</xref></td><td align="left" colspan="1" rowspan="1">95</td><td align="left" colspan="1" rowspan="1">95</td><td align="left" colspan="1" rowspan="1">95</td><td align="left" colspan="1" rowspan="1">95</td><td align="left" colspan="1" rowspan="1">95</td><td align="left" colspan="1" rowspan="1">95</td><td align="left" colspan="1" rowspan="1">95</td><td align="left" colspan="1" rowspan="1">95</td><td align="left" colspan="1" rowspan="1">94</td></tr><tr><td align="left" colspan="1" rowspan="1">16</td><td align="left" colspan="1" rowspan="1">80</td><td align="left" colspan="1" rowspan="1">68</td><td align="left" colspan="1" rowspan="1">78</td><td align="left" colspan="1" rowspan="1">33</td><td align="left" colspan="1" rowspan="1">68</td><td align="left" colspan="1" rowspan="1">47</td><td align="left" colspan="1" rowspan="1">50</td><td align="left" colspan="1" rowspan="1">58</td><td align="left" colspan="1" rowspan="1">67</td></tr><tr><td align="left" colspan="1" rowspan="1">17</td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">50</td><td align="left" colspan="1" rowspan="1">61</td><td align="left" colspan="1" rowspan="1">21</td><td align="left" colspan="1" rowspan="1">50</td><td align="left" colspan="1" rowspan="1">30</td><td align="left" colspan="1" rowspan="1">32</td><td align="left" colspan="1" rowspan="1">39</td><td align="left" colspan="1" rowspan="1">60</td></tr><tr><td align="left" colspan="1" rowspan="1">18</td><td align="left" colspan="1" rowspan="1">45</td><td align="left" colspan="1" rowspan="1">29</td><td align="left" colspan="1" rowspan="1">39</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">32</td></tr><tr><td align="left" colspan="1" rowspan="1">19</td><td align="left" colspan="1" rowspan="1">40</td><td align="left" colspan="1" rowspan="1">33</td><td align="left" colspan="1" rowspan="1">41</td><td align="left" colspan="1" rowspan="1">11</td><td align="left" colspan="1" rowspan="1">29</td><td align="left" colspan="1" rowspan="1">16</td><td align="left" colspan="1" rowspan="1">17</td><td align="left" colspan="1" rowspan="1">21</td><td align="left" colspan="1" rowspan="1">36</td></tr><tr><td align="left" colspan="1" rowspan="1">20</td><td align="left" colspan="1" rowspan="1">195</td><td align="left" colspan="1" rowspan="1">168</td><td align="left" colspan="1" rowspan="1">170</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">179</td></tr><tr><td align="left" colspan="1" rowspan="1">21<xref ref-type="table-fn" rid="nt104">‡</xref></td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">160</td><td align="left" colspan="1" rowspan="1">159</td></tr><tr><td align="left" colspan="1" rowspan="1">22</td><td align="left" colspan="1" rowspan="1">100</td><td align="left" colspan="1" rowspan="1">104</td><td align="left" colspan="1" rowspan="1">111</td><td align="left" colspan="1" rowspan="1">113</td><td align="left" colspan="1" rowspan="1">157</td><td align="left" colspan="1" rowspan="1">92</td><td align="left" colspan="1" rowspan="1">97</td><td align="left" colspan="1" rowspan="1">116</td><td align="left" colspan="1" rowspan="1">129</td></tr><tr><td align="left" colspan="1" rowspan="1">25</td><td align="left" colspan="1" rowspan="1">100</td><td align="left" colspan="1" rowspan="1">93</td><td align="left" colspan="1" rowspan="1">98</td><td align="left" colspan="1" rowspan="1">99</td><td align="left" colspan="1" rowspan="1">120</td><td align="left" colspan="1" rowspan="1">77</td><td align="left" colspan="1" rowspan="1">85</td><td align="left" colspan="1" rowspan="1">98</td><td align="left" colspan="1" rowspan="1">128</td></tr><tr><td align="left" colspan="1" rowspan="1">26</td><td align="left" colspan="1" rowspan="1">20</td><td align="left" colspan="1" rowspan="1">25</td><td align="left" colspan="1" rowspan="1">29</td><td align="left" colspan="1" rowspan="1">32</td><td align="left" colspan="1" rowspan="1">35</td><td align="left" colspan="1" rowspan="1">24</td><td align="left" colspan="1" rowspan="1">26</td><td align="left" colspan="1" rowspan="1">36</td><td align="left" colspan="1" rowspan="1">30</td></tr><tr><td align="left" colspan="1" rowspan="1">23</td><td align="left" colspan="1" rowspan="1">30</td><td align="left" colspan="1" rowspan="1">62</td><td align="left" colspan="1" rowspan="1">75</td><td align="left" colspan="1" rowspan="1">46</td><td align="left" colspan="1" rowspan="1">65</td><td align="left" colspan="1" rowspan="1">45</td><td align="left" colspan="1" rowspan="1">36</td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">44</td></tr><tr><td align="left" colspan="1" rowspan="1">24</td><td align="left" colspan="1" rowspan="1">25</td><td align="left" colspan="1" rowspan="1">58</td><td align="left" colspan="1" rowspan="1">70</td><td align="left" colspan="1" rowspan="1">46</td><td align="left" colspan="1" rowspan="1">65</td><td align="left" colspan="1" rowspan="1">45</td><td align="left" colspan="1" rowspan="1">36</td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">59</td></tr><tr><td align="left" colspan="1" rowspan="1">SSD</td><td align="left" colspan="1" rowspan="1">na</td><td align="left" colspan="1" rowspan="1">21056</td><td align="left" colspan="1" rowspan="1">17125</td><td align="left" colspan="1" rowspan="1">22458</td><td align="left" colspan="1" rowspan="1">15615</td><td align="left" colspan="1" rowspan="1">20968</td><td align="left" colspan="1" rowspan="1">19796</td><td align="left" colspan="1" rowspan="1">16036</td><td align="left" colspan="1" rowspan="1">11192</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt103"><p>For k-medoids (k-med), the optimal number of local clock is at k* = 3; the minimum sum of squared distance (SSD) is at k = 12.</p></fn><fn id="nt104"><p>Notes–From Smith <italic>et al</italic>. (2006): Fig. 5 (<sup>¶</sup>) and <xref ref-type="table" rid="pone-0000879-t002">Table 2</xref> (<sup>†</sup>). <sup>¥</sup> Naïve approaches, for which knowledge of the actual fossil dates is not taken into account to estimate divergence dates. <sup>‡</sup> Calibration points (set as minimum ages for PL); root age is fixed. na: not applicable. PL<sup>(CV)</sup> contains age estimates obtained by penalized likelihood with cross-validation; with PL<sup>(SSD)</sup>, the penalty is selected by minimizing SSD.</p></fn></table-wrap-foot></table-wrap><p>One potential reason why rate change is underestimated might be because of the way initial branch-specific rates are estimated. Recall that these initial estimates come from an autocorrelated Brownian motion model (see above) that minimizes rate change over the tree. To test the impact of such a procedure on our hybrid local clock procedures, I first obtained branch-specific rates under an uncorrelated model of rate change, and then fed these rates to the hybrid methods. These initial rates were estimated with BEAST under the UCLN model by running two MCMC samplers independently. The two BEAST runs proved very similar, so their results were combined. The effective size of the samples taken from the target distribution was 51,300. The posterior mean rates over the maximum a posteriori tree were used as starting point under MSS (MSS+UCLN in <xref ref-type="table" rid="pone-0000879-t002">Table 2</xref>). Posterior point estimates of divergence times (mean of the marginal distributions) are also reported in the last column of <xref ref-type="table" rid="pone-0000879-t002">Table 2</xref>.</p><p>SSD results show that for this data set, the use of Bayesian estimates of rates improves our MSS hybrid procedure. As expected, the SSD score obtained under MSS+UCLN (16,036) shows that this latter procedure still underestimates rate change, as k-medoids had a higher score (15,615) with <italic>k</italic> = 12. Finally, the UCLN results show that, quite as expected again, uncorrelated models of rate change performed better than any other approaches considered here.</p></sec><sec id="s3c"><title>Marsupial data: ad hoc dating with uncertain phylogenies</title><p>The analyses with the hybrid ML local clock models all assumed that the tree topology is known, which is not always a realistic assumption. To evaluate the impact of this assumption on date estimates, I reanalyzed the recently published marsupial data set. Date estimates were first obtained with BEAST. The effective size sampled from the target distribution of UCLN was 29,580. Point estimates of divergence times (mean of the marginal distributions) are reported in the first column of <xref ref-type="table" rid="pone-0000879-t003">Table 3</xref>.</p><table-wrap id="pone-0000879-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0000879.t003</object-id><label>Table 3</label><caption><title>Effect of neglecting phylogenetic uncertainty on estimates of divergence times under local clock models for the marsupial data.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0000879-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0000879.t003" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1">split</td><td align="left" colspan="1" rowspan="1">MSS: MAP tree</td><td align="left" colspan="1" rowspan="1">MSS: 95% CS</td><td align="left" colspan="1" rowspan="1">HOPACH: MAP tree</td><td align="left" colspan="1" rowspan="1">HOPACH: 95% CS</td><td align="left" colspan="1" rowspan="1">UCLN (BEAST)</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1"><italic>Sminthopsis/Phascogale</italic></td><td align="left" colspan="1" rowspan="1">24.76</td><td align="left" colspan="1" rowspan="1">24.77</td><td align="left" colspan="1" rowspan="1">23.55</td><td align="left" colspan="1" rowspan="1">23.71</td><td align="left" colspan="1" rowspan="1">23.96</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Sminthopsis/Echymipera</italic></td><td align="left" colspan="1" rowspan="1">57.92</td><td align="left" colspan="1" rowspan="1">57.87</td><td align="left" colspan="1" rowspan="1">55.55</td><td align="left" colspan="1" rowspan="1">55.49</td><td align="left" colspan="1" rowspan="1">56.06</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Echymipera/Perameles</italic></td><td align="left" colspan="1" rowspan="1">12.39</td><td align="left" colspan="1" rowspan="1">12.39</td><td align="left" colspan="1" rowspan="1">11.09</td><td align="left" colspan="1" rowspan="1">11.16</td><td align="left" colspan="1" rowspan="1">13.09</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Notoryctes/Sminthopsis</italic></td><td align="left" colspan="1" rowspan="1">61.05</td><td align="left" colspan="1" rowspan="1">60.96</td><td align="left" colspan="1" rowspan="1">59.07</td><td align="left" colspan="1" rowspan="1">59.10</td><td align="left" colspan="1" rowspan="1">59.72</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Dendrolagus/Pseudocheiridae</italic></td><td align="left" colspan="1" rowspan="1">35.07</td><td align="left" colspan="1" rowspan="1">35.26</td><td align="left" colspan="1" rowspan="1">45.12</td><td align="left" colspan="1" rowspan="1">44.19</td><td align="left" colspan="1" rowspan="1">33.26</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Dendrolagus/Phalanger</italic></td><td align="left" colspan="1" rowspan="1">37.92</td><td align="left" colspan="1" rowspan="1">37.92</td><td align="left" colspan="1" rowspan="1">48.52</td><td align="left" colspan="1" rowspan="1">47.73</td><td align="left" colspan="1" rowspan="1">39.58</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Phalanger/Vombatus</italic></td><td align="left" colspan="1" rowspan="1">40.46</td><td align="left" colspan="1" rowspan="1">40.61</td><td align="left" colspan="1" rowspan="1">50.67</td><td align="left" colspan="1" rowspan="1">50.09</td><td align="left" colspan="1" rowspan="1">46.25</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Vombatus/Phascolarctos</italic></td><td align="left" colspan="1" rowspan="1">26.27</td><td align="left" colspan="1" rowspan="1">26.35</td><td align="left" colspan="1" rowspan="1">33.77</td><td align="left" colspan="1" rowspan="1">33.01</td><td align="left" colspan="1" rowspan="1">31.29</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Vombatus/Dromiciops</italic></td><td align="left" colspan="1" rowspan="1">55.80</td><td align="left" colspan="1" rowspan="1">56.52</td><td align="left" colspan="1" rowspan="1">62.54</td><td align="left" colspan="1" rowspan="1">62.43</td><td align="left" colspan="1" rowspan="1">61.46</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Dasyurus/Rhyncholestes</italic></td><td align="left" colspan="1" rowspan="1">73.23</td><td align="left" colspan="1" rowspan="1">72.20</td><td align="left" colspan="1" rowspan="1">76.74</td><td align="left" colspan="1" rowspan="1">74.30</td><td align="left" colspan="1" rowspan="1">77.67</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Caenolestes/Rhyncholestes</italic></td><td align="left" colspan="1" rowspan="1">10.66</td><td align="left" colspan="1" rowspan="1">10.49</td><td align="left" colspan="1" rowspan="1">13.88</td><td align="left" colspan="1" rowspan="1">11.75</td><td align="left" colspan="1" rowspan="1">13.71</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Equus/Ceratomorpha</italic></td><td align="left" colspan="1" rowspan="1">46.29</td><td align="left" colspan="1" rowspan="1">46.29</td><td align="left" colspan="1" rowspan="1">43.65</td><td align="left" colspan="1" rowspan="1">43.44</td><td align="left" colspan="1" rowspan="1">43.20</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Cynocephalus/Leporidae</italic></td><td align="left" colspan="1" rowspan="1">67.24</td><td align="left" colspan="1" rowspan="1">67.27</td><td align="left" colspan="1" rowspan="1">63.71</td><td align="left" colspan="1" rowspan="1">64.40</td><td align="left" colspan="1" rowspan="1">64.74</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Cynocephalus/Ceratomorpha</italic></td><td align="left" colspan="1" rowspan="1">80.23</td><td align="left" colspan="1" rowspan="1">80.25</td><td align="left" colspan="1" rowspan="1">76.66</td><td align="left" colspan="1" rowspan="1">76.81</td><td align="left" colspan="1" rowspan="1">77.54</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Ceratomorpha/Bradypus</italic></td><td align="left" colspan="1" rowspan="1">90.88</td><td align="left" colspan="1" rowspan="1">90.88</td><td align="left" colspan="1" rowspan="1">92.15</td><td align="left" colspan="1" rowspan="1">92.05</td><td align="left" colspan="1" rowspan="1">87.94</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>Bradypus/Sirenia</italic></td><td align="left" colspan="1" rowspan="1">87.07</td><td align="left" colspan="1" rowspan="1">87.05</td><td align="left" colspan="1" rowspan="1">88.94</td><td align="left" colspan="1" rowspan="1">88.81</td><td align="left" colspan="1" rowspan="1">80.87</td></tr><tr><td align="left" colspan="1" rowspan="1">SSD</td><td align="left" colspan="1" rowspan="1">202.28</td><td align="left" colspan="1" rowspan="1">203.75</td><td align="left" colspan="1" rowspan="1">338.07</td><td align="left" colspan="1" rowspan="1">304.87</td><td align="left" colspan="1" rowspan="1">0.00</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt105"><p>Results for local clock models, MSS and HOPACH, are given both for the maximum a posteriori (MAP) tree and as a posterior probability weighted average over the 95% credibility set (CS) of topologies sampled from the appropriate target distribution. The uncorrelated models from BEAST (UCLN: uncorrelated lognormal) integrate over tree topologies, branch lengths and parameters of the substitution model. Times are in million years ago. SSD are computed with respect to UCLN (baseline).</p></fn></table-wrap-foot></table-wrap><p>I compared this uncorrelated Bayesian model with the local clock procedures with ad hoc integration of phylogenetic uncertainty. With MrBayes, the maximum a posteriori (MAP) tree had a posterior probability of .43, and the 95% credibility set included a total of nine tree topologies. The time estimates presented in <xref ref-type="table" rid="pone-0000879-t003">Table 3</xref> represent average estimates, weighted by the posterior probability of the tree topologies. Credibility intervals for time estimates can easily be obtained when times are estimated for each sample drawn from the Markov chain, but not under this latter ad hoc implementation of integrated local clocks. For this reason, no standard errors can be reported in <xref ref-type="table" rid="pone-0000879-t003">Table 3</xref>.</p><p>How do these Bayesian time estimates compare with those based on ML local clock? Two conclusions can be drawn from <xref ref-type="table" rid="pone-0000879-t003">Table 3</xref>. First, averaging over phylogenetic uncertainty had little impact on the estimates of divergence times, at least in this example: under a given method, only minor differences were found between estimates based on the MAP tree and ad hoc integration over the 95% credibility set of topologies. Second, the largest differences occur between MSS and HOPACH, the uncorrelated Bayesian approach giving somewhat intermediate results. This is in particular true for two splits, Dendrolagus/Phalanger and Phalanger/Vombatus, which can exhibit an age difference of up to 10 MY between the two methods. These two nodes have a posterior probability of one, so that phylogenetic uncertainty is not responsible for this difference in age estimates. SSD suggests that MSS give results that are the closest to UCLN.</p></sec></sec><sec id="s4"><title>Discussion</title><p>As always, it is advisable to use several methods to estimate a parameter of interest, such as divergence times between different species. Compared to regularization methods <xref ref-type="bibr" rid="pone.0000879-Sanderson2">[9]</xref>, <xref ref-type="bibr" rid="pone.0000879-Thorne1">[11]</xref>, local molecular clocks potentially have the advantage of accommodating rapid rate variation along lineages, without incurring the computational overhead of Bayesian uncorrelated methods <xref ref-type="bibr" rid="pone.0000879-Drummond1">[13]</xref>. The methods presented here constitute a significant improvement of the AHRS algorithm for the automatic placement of local molecular clocks by providing researchers with a means to determine how many clocks should be used to analyze their data. The results presented here show that these ML local clocks, based on hybrid statistical approaches, constitute a computationally quick alternative to Bayesian methods, without requiring the setting of reasonable prior distributions. Our results also demonstrate that the choice of a specific algorithm can have a dramatic impact on date estimates.</p><p>These hybrid methods however appear to present four potential limitations. The first one, common to both the original AHRS algorithm and these new hybrid methods, is the reliance on the initial estimation of approximate rates by ML in step (i) of the procedure <xref ref-type="bibr" rid="pone.0000879-Yang2">[19]</xref>. I showed here that better initial estimates of these rates can help improve the accuracy of the divergence dates estimated. But because these improved estimates were based on an MCMC sampler, the speed advantage of the hybrid methods disappears. A second important limitation of these hybrid methods is their underestimating rate change. The underestimation of rate change is not a surprise, since this is precisely the idea driving the use of local clocks: reducing the extent of rate variation. Third, all possible placements of local clocks on a tree do not lead to identifiable parameters <xref ref-type="bibr" rid="pone.0000879-Yoder1">[6]</xref>. In our implementation, this is still an important issue as no rigorous identifiability check is currently implemented. Finally, confidence intervals, not estimated here, are expected to be underestimated as uncertainty about model parameters is disregarded. Confidence intervals will also be difficult to obtain when the topology is integrated following the ad hoc procedure outlined above. Bayes empirical Bayes strategies, as recently employed to detect sites under adaptive evolution <xref ref-type="bibr" rid="pone.0000879-Yang6">[42]</xref>, could prove valuable for these ad hoc dating methods. As noted in <xref ref-type="bibr" rid="pone.0000879-Yang3">[20]</xref>, other limitations of the likelihood methods exist, in particular with respect to the incorporation of uncertainties about calibration points into an analysis; these limitations are however naturally dealt within a Bayesian framework <xref ref-type="bibr" rid="pone.0000879-Yang3">[20]</xref>.</p></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pone.0000879.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0000879.s001" xlink:type="simple"><label>Figure S1</label><caption><p>Maximum likelihood estimates of divergence times for the codon data partitioned according to the estimated local clock models. Times were estimated using (A) k-medoids with the gap statistic, (B) Median Silhouette Splits (MSS) and (C) Hierarchical Ordered Partitioning and Collapsing Hybrid (HOPACH) and are given in million years ago (MYA). Filled circles indicate the seven calibration points on the trees scaled to time (A–C); the other trees (D–F) are scaled to the expected number of substitutions per codon.</p><p>(0.45 MB PDF)</p></caption></supplementary-material><supplementary-material id="pone.0000879.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0000879.s002" xlink:type="simple"><label>Figure S2</label><caption><p>Maximum likelihood estimates of divergence times for the nucleotide data partitioned according to the three codon positions and the estimated local clock models. Times were estimated using k-medoids with the gap statistic, Median Silhouette Splits (MSS) and Hierarchical Ordered Partitioning and Collapsing Hybrid (HOPACH) and are given in million years ago (MYA). Filled circles indicate the seven calibration points on the trees scaled to time (leftmost column); the other trees are scaled to the expected number of substitutions per nucleotide site for the partitions over the three codon positions.</p><p>(0.38 MB PDF)</p></caption></supplementary-material></sec></body><back><ack><p>Andrew Rambaut kindly provided the marsupial data. Hervé Philippe, Xuhua Xia, Oliver Pybus and two anonymous reviewers provided comments that improved this manuscript.</p></ack><ref-list><title>References</title><ref id="pone.0000879-Zuckerkandl1"><label>1</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zuckerkandl</surname><given-names>E</given-names></name><name name-style="western"><surname>Pauling</surname><given-names>L</given-names></name><name name-style="western"><surname>Bryson</surname><given-names>V</given-names></name><name name-style="western"><surname>Vogel</surname><given-names>HJ</given-names></name></person-group>             <year>1965</year>             <article-title>Evolutionary divergence and convergence in proteins. Evolving genes and proteins.</article-title>             <publisher-loc>New York</publisher-loc>             <publisher-name>Academic Press</publisher-name>             <fpage>97</fpage>             <lpage>166</lpage>          </element-citation></ref><ref id="pone.0000879-Felsenstein1"><label>2</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name></person-group>             <year>2003</year>             <article-title>Inferring phylogenies.</article-title>             <publisher-loc>Sunderland, Massachusets</publisher-loc>             <publisher-name>Sinauer</publisher-name>          </element-citation></ref><ref id="pone.0000879-Bromham1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bromham</surname><given-names>L</given-names></name><name name-style="western"><surname>Penny</surname><given-names>D</given-names></name></person-group>             <year>2003</year>             <article-title>The modern molecular clock.</article-title>             <source>Nat Rev Genet</source>             <volume>4</volume>             <fpage>216</fpage>             <lpage>224</lpage>          </element-citation></ref><ref id="pone.0000879-Kishino1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name><name name-style="western"><surname>Hasegawa</surname><given-names>M</given-names></name></person-group>             <year>1990</year>             <article-title>Converting distance to time: application to human evolution.</article-title>             <source>Method Enzymol</source>             <volume>183</volume>             <fpage>550</fpage>             <lpage>570</lpage>          </element-citation></ref><ref id="pone.0000879-Rambaut1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name><name name-style="western"><surname>Bromham</surname><given-names>L</given-names></name></person-group>             <year>1998</year>             <article-title>Estimating divergence dates from molecular sequences.</article-title>             <source>Mol Biol Evol</source>             <volume>15</volume>             <fpage>442</fpage>             <lpage>448</lpage>          </element-citation></ref><ref id="pone.0000879-Yoder1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yoder</surname><given-names>AD</given-names></name><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name></person-group>             <year>2000</year>             <article-title>Estimation of primate speciation dates using local molecular clocks.</article-title>             <source>Mol Biol Evol</source>             <volume>17</volume>             <fpage>1081</fpage>             <lpage>1090</lpage>          </element-citation></ref><ref id="pone.0000879-Yang1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name><name name-style="western"><surname>Yoder</surname><given-names>AD</given-names></name></person-group>             <year>2003</year>             <article-title>Comparison of likelihood and Bayesian methods for estimating divergence times using multiple gene loci and calibration points, with application to a radiation of cute-looking mouse lemur species.</article-title>             <source>Syst Biol</source>             <volume>52</volume>             <fpage>705</fpage>             <lpage>716</lpage>          </element-citation></ref><ref id="pone.0000879-Sanderson1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sanderson</surname><given-names>MJ</given-names></name></person-group>             <year>1997</year>             <article-title>A nonparametric approach to estimating divergence times in the absence of rate constancy.</article-title>             <source>Mol Biol Evol</source>             <volume>14</volume>             <fpage>1218</fpage>             <lpage>1232</lpage>          </element-citation></ref><ref id="pone.0000879-Sanderson2"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sanderson</surname><given-names>MJ</given-names></name></person-group>             <year>2002</year>             <article-title>Estimating absolute rates of molecular evolution and divergence times: a penalized likelihood approach.</article-title>             <source>Mol Biol Evol</source>             <volume>19</volume>             <fpage>101</fpage>             <lpage>109</lpage>          </element-citation></ref><ref id="pone.0000879-Hastie1"><label>10</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name><name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name><name name-style="western"><surname>Friedman</surname><given-names>JH</given-names></name></person-group>             <year>2001</year>             <article-title>The elements of statistical learning.</article-title>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>          </element-citation></ref><ref id="pone.0000879-Thorne1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Thorne</surname><given-names>JL</given-names></name><name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name><name name-style="western"><surname>Painter</surname><given-names>IS</given-names></name></person-group>             <year>1998</year>             <article-title>Estimating the rate of evolution of the rate of molecular evolution.</article-title>             <source>Mol Biol Evol</source>             <volume>15</volume>             <fpage>1647</fpage>             <lpage>1657</lpage>          </element-citation></ref><ref id="pone.0000879-Ho1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ho</surname><given-names>SY</given-names></name><name name-style="western"><surname>Phillips</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name><name name-style="western"><surname>Cooper</surname><given-names>A</given-names></name></person-group>             <year>2005</year>             <article-title>Accuracy of rate estimation using relaxed-clock models with a critical focus on the early metazoan radiation.</article-title>             <source>Mol Biol Evol</source>             <volume>22</volume>             <fpage>1355</fpage>             <lpage>1363</lpage>          </element-citation></ref><ref id="pone.0000879-Drummond1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name><name name-style="western"><surname>Ho</surname><given-names>SY</given-names></name><name name-style="western"><surname>Phillips</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name></person-group>             <year>2006</year>             <article-title>Relaxed phylogenetics and dating with confidence.</article-title>             <source>PLoS Biol</source>             <volume>4</volume>             <fpage>e88</fpage>          </element-citation></ref><ref id="pone.0000879-Huelsenbeck1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name><name name-style="western"><surname>Larget</surname><given-names>B</given-names></name><name name-style="western"><surname>Swofford</surname><given-names>DL</given-names></name></person-group>             <year>2000</year>             <article-title>A compound Poisson process for relaxing the molecular clock.</article-title>             <source>Genetics</source>             <volume>154</volume>             <fpage>1879</fpage>             <lpage>1892</lpage>          </element-citation></ref><ref id="pone.0000879-Rannala1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rannala</surname><given-names>B</given-names></name></person-group>             <year>2002</year>             <article-title>Identifiability of parameters in MCMC Bayesian inference of phylogeny.</article-title>             <source>Syst Biol</source>             <volume>51</volume>             <fpage>754</fpage>             <lpage>760</lpage>          </element-citation></ref><ref id="pone.0000879-ArisBrosou1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Aris-Brosou</surname><given-names>S</given-names></name><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name></person-group>             <year>2003</year>             <article-title>Bayesian models of episodic evolution support a late precambrian explosive diversification of the metazoa.</article-title>             <source>Mol Biol Evol</source>             <volume>20</volume>             <fpage>1947</fpage>             <lpage>1954</lpage>          </element-citation></ref><ref id="pone.0000879-Welch1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Welch</surname><given-names>JJ</given-names></name><name name-style="western"><surname>Fontanillas</surname><given-names>E</given-names></name><name name-style="western"><surname>Bromham</surname><given-names>L</given-names></name></person-group>             <year>2005</year>             <article-title>Molecular dates for the “cambrian explosion”: the influence of prior assumptions.</article-title>             <source>Syst Biol</source>             <volume>54</volume>             <fpage>672</fpage>             <lpage>678</lpage>          </element-citation></ref><ref id="pone.0000879-Won1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Won</surname><given-names>H</given-names></name><name name-style="western"><surname>Renner</surname><given-names>S</given-names></name></person-group>             <year>2006</year>             <article-title>Dating dispersal and radiation in the Gymnosperm Gnetum (Gnetales)‚ clock calibration when outgroup relationships are uncertain.</article-title>             <source>Syst Biol</source>             <volume>55</volume>             <fpage>610</fpage>             <lpage>622</lpage>          </element-citation></ref><ref id="pone.0000879-Yang2"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name></person-group>             <year>2004</year>             <article-title>A heuristic rate smoothing procedure for maximum likelihood estimation of species divergence times.</article-title>             <source>Acta Zool Sinica</source>             <volume>50</volume>             <fpage>645</fpage>             <lpage>656</lpage>          </element-citation></ref><ref id="pone.0000879-Yang3"><label>20</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name></person-group>             <year>2006</year>             <article-title>Computational molecular evolution.</article-title>             <publisher-loc>Oxford</publisher-loc>             <publisher-name>Oxford University Press</publisher-name>             <fpage>xvi, 357</fpage>          </element-citation></ref><ref id="pone.0000879-Edwards1"><label>21</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Edwards</surname><given-names>AW</given-names></name></person-group>             <year>1992</year>             <article-title>Likelihood.</article-title>             <publisher-loc>Baltimore and London</publisher-loc>             <publisher-name>John Hopkins University Press</publisher-name>          </element-citation></ref><ref id="pone.0000879-Kishino2"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name><name name-style="western"><surname>Thorne</surname><given-names>JL</given-names></name><name name-style="western"><surname>Bruno</surname><given-names>WJ</given-names></name></person-group>             <year>2001</year>             <article-title>Performance of a divergence time estimation method under a probabilistic model of rate evolution.</article-title>             <source>Mol Biol Evol</source>             <volume>18</volume>             <fpage>352</fpage>             <lpage>361</lpage>          </element-citation></ref><ref id="pone.0000879-Yang4"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name></person-group>             <year>1997</year>             <article-title>PAML: a program package for phylogenetic analysis by maximum likelihood.</article-title>             <source>Comput Appl Biosci</source>             <volume>13</volume>             <fpage>555</fpage>             <lpage>556</lpage>          </element-citation></ref><ref id="pone.0000879-Hartigan1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hartigan</surname><given-names>JA</given-names></name><name name-style="western"><surname>Wong</surname><given-names>MA</given-names></name></person-group>             <year>1979</year>             <article-title>A K-means clustering algorithm.</article-title>             <source>Appl Stat</source>             <volume>28</volume>             <fpage>100</fpage>             <lpage>108</lpage>          </element-citation></ref><ref id="pone.0000879-Kaufman1"><label>25</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kaufman</surname><given-names>L</given-names></name><name name-style="western"><surname>Rousseeuw</surname><given-names>PJ</given-names></name></person-group>             <year>1990</year>             <article-title>Finding groups in data : an introduction to cluster analysis.</article-title>             <publisher-loc>New York</publisher-loc>             <publisher-name>Wiley</publisher-name>             <fpage>xiv, 342</fpage>          </element-citation></ref><ref id="pone.0000879-Tibshirani1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name><name name-style="western"><surname>Walther</surname><given-names>G</given-names></name><name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name></person-group>             <year>2001</year>             <article-title>Estimating the number of clusters in a data set via the gap statistic.</article-title>             <source>J Roy Stat Soc B</source>             <volume>63</volume>             <fpage>411</fpage>             <lpage>423</lpage>          </element-citation></ref><ref id="pone.0000879-Pollard1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pollard</surname><given-names>KS</given-names></name><name name-style="western"><surname>van der Laan</surname><given-names>MJ</given-names></name></person-group>             <year>2002</year>             <article-title>Statistical inference for simultaneous clustering of gene expression data.</article-title>             <source>Math Biosci</source>             <volume>176</volume>             <fpage>99</fpage>             <lpage>121</lpage>          </element-citation></ref><ref id="pone.0000879-vanderLaan1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>van der Laan</surname><given-names>M</given-names></name><name name-style="western"><surname>Pollard</surname><given-names>KS</given-names></name></person-group>             <year>2003</year>             <article-title>A new algorithm for hybrid hierarchical clustering with visualization and the bootstrap.</article-title>             <source>J Stat Plan Infer</source>             <volume>117</volume>             <fpage>275</fpage>             <lpage>303</lpage>          </element-citation></ref><ref id="pone.0000879-Pagel1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pagel</surname><given-names>M</given-names></name><name name-style="western"><surname>Meade</surname><given-names>A</given-names></name><name name-style="western"><surname>Barker</surname><given-names>D</given-names></name></person-group>             <year>2004</year>             <article-title>Bayesian estimation of ancestral character states on phylogenies.</article-title>             <source>Syst Biol</source>             <volume>53</volume>             <fpage>673</fpage>             <lpage>684</lpage>          </element-citation></ref><ref id="pone.0000879-Prudhomme1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Prud'homme</surname><given-names>B</given-names></name><name name-style="western"><surname>Gompel</surname><given-names>N</given-names></name><name name-style="western"><surname>Rokas</surname><given-names>A</given-names></name><name name-style="western"><surname>Kassner</surname><given-names>VA</given-names></name><name name-style="western"><surname>Williams</surname><given-names>TM</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Repeated morphological evolution through cis-regulatory changes in a pleiotropic gene.</article-title>             <source>Nature</source>             <volume>440</volume>             <fpage>1050</fpage>             <lpage>1053</lpage>          </element-citation></ref><ref id="pone.0000879-Ronquist1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ronquist</surname><given-names>F</given-names></name><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name></person-group>             <year>2003</year>             <article-title>MRBAYES 3: Bayesian phylogenetic inference under mixed models.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>1572</fpage>             <lpage>1574</lpage>          </element-citation></ref><ref id="pone.0000879-Goldman1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Goldman</surname><given-names>N</given-names></name><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name></person-group>             <year>1994</year>             <article-title>A codon-based model of nucleotide substitution for protein-coding DNA sequences.</article-title>             <source>Mol Biol Evol</source>             <volume>11</volume>             <fpage>725</fpage>             <lpage>736</lpage>          </element-citation></ref><ref id="pone.0000879-Smith1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>AB</given-names></name><name name-style="western"><surname>Pisani</surname><given-names>D</given-names></name><name name-style="western"><surname>Mackenzie-Dodds</surname><given-names>JA</given-names></name><name name-style="western"><surname>Stockley</surname><given-names>B</given-names></name><name name-style="western"><surname>Webster</surname><given-names>BL</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Testing the molecular clock: Molecular and paleontological estimates of divergence times in the Echinoidea (Echinodermata).</article-title>             <source>Mol Biol Evol</source>             <volume>23</volume>             <fpage>1832</fpage>             <lpage>1851</lpage>          </element-citation></ref><ref id="pone.0000879-Tavare1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tavare</surname><given-names>S</given-names></name></person-group>             <year>1986</year>             <article-title>Some probabilistic and statistical problems in the analysis of DNA sequences.</article-title>             <source>Lectures on Mathematics in the Life Sciences</source>             <volume>17</volume>             <fpage>57</fpage>             <lpage>86</lpage>          </element-citation></ref><ref id="pone.0000879-Yang5"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name></person-group>             <year>1994</year>             <article-title>Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: approximate methods.</article-title>             <source>J Mol Evol</source>             <volume>39</volume>             <fpage>306</fpage>             <lpage>314</lpage>          </element-citation></ref><ref id="pone.0000879-Hasegawa1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hasegawa</surname><given-names>M</given-names></name><name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name><name name-style="western"><surname>Yano</surname><given-names>T</given-names></name></person-group>             <year>1985</year>             <article-title>Dating of the human-ape splitting by a molecular clock of mitochondrial DNA.</article-title>             <source>J Mol Evol</source>             <volume>22</volume>             <fpage>160</fpage>             <lpage>174</lpage>          </element-citation></ref><ref id="pone.0000879-AmrineMadsen1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Amrine-Madsen</surname><given-names>H</given-names></name><name name-style="western"><surname>Scally</surname><given-names>M</given-names></name><name name-style="western"><surname>Westerman</surname><given-names>M</given-names></name><name name-style="western"><surname>Stanhope</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Krajewski</surname><given-names>C</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>Nuclear gene sequences provide evidence for the monophyly of australidelphian marsupials.</article-title>             <source>Mol Phylogenet Evol</source>             <volume>28</volume>             <fpage>186</fpage>             <lpage>196</lpage>          </element-citation></ref><ref id="pone.0000879-ArisBrosou2"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Aris-Brosou</surname><given-names>S</given-names></name><name name-style="western"><surname>Bielawski</surname><given-names>JP</given-names></name></person-group>             <year>2006</year>             <article-title>Large-scale analyses of synonymous substitution rates can be sensitive to assumptions about the process of mutation.</article-title>             <source>Gene</source>             <volume>378</volume>             <fpage>58</fpage>             <lpage>64</lpage>          </element-citation></ref><ref id="pone.0000879-ArisBrosou3"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Aris-Brosou</surname><given-names>S</given-names></name></person-group>             <year>2006</year>             <article-title>Identifying sites under positive selection with uncertain parameter estimates.</article-title>             <source>Genome</source>             <volume>49</volume>             <fpage>767</fpage>             <lpage>776</lpage>          </element-citation></ref><ref id="pone.0000879-Sanderson3"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sanderson</surname><given-names>MJ</given-names></name></person-group>             <year>2003</year>             <article-title>r8s: inferring absolute rates of molecular evolution and divergence times in the absence of a molecular clock.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>301</fpage>             <lpage>302</lpage>          </element-citation></ref><ref id="pone.0000879-Seiffert1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Seiffert</surname><given-names>ER</given-names></name><name name-style="western"><surname>Simons</surname><given-names>EL</given-names></name><name name-style="western"><surname>Attia</surname><given-names>Y</given-names></name></person-group>             <year>2003</year>             <article-title>Fossil evidence for an ancient divergence of lorises and galagos.</article-title>             <source>Nature</source>             <volume>422</volume>             <fpage>421</fpage>             <lpage>424</lpage>          </element-citation></ref><ref id="pone.0000879-Yang6"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name><name name-style="western"><surname>Wong</surname><given-names>WS</given-names></name><name name-style="western"><surname>Nielsen</surname><given-names>R</given-names></name></person-group>             <year>2005</year>             <article-title>Bayes empirical Bayes inference of amino acid sites under positive selection.</article-title>             <source>Mol Biol Evol</source>             <volume>22</volume>             <fpage>1107</fpage>             <lpage>1118</lpage>          </element-citation></ref></ref-list></back></article>