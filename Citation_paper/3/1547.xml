<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-12-21925</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0067019</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis tools</subject><subj-group><subject>Transcriptomes</subject></subj-group></subj-group></subj-group></subj-group><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis tools</subject><subj-group><subject>Transcriptomes</subject></subj-group></subj-group><subj-group><subject>Genome expression analysis</subject><subject>Metagenomics</subject></subj-group></subj-group><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subject>Microbial ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Mathematics</subject><subj-group><subject>Algebra</subject><subj-group><subject>Linear algebra</subject></subj-group></subj-group><subj-group><subject>Probability theory</subject><subj-group><subject>Bayes theorem</subject></subj-group></subj-group><subj-group><subject>Statistics</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>ANOVA-Like Differential Expression (ALDEx) Analysis for Mixed Population RNA-Seq</article-title>
<alt-title alt-title-type="running-head">ANOVA-Like Differential Gene Expression</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Fernandes</surname><given-names>Andrew D.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Macklaim</surname><given-names>Jean M.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Linn</surname><given-names>Thomas G.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Reid</surname><given-names>Gregor</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Gloor</surname><given-names>Gregory B.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff5"><sup>5</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>YouKaryote Genomics, London, Ontario, Canada</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Biochemistry, The University of Western Ontario, London, Ontario, Canada</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Microbiology &amp; Immunology, The University of Western Ontario, London, Ontario, Canada</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Department of Surgery, The University of Western Ontario, London, Ontario, Canada</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>Canadian Research &amp; Development Centre for Probiotics, Lawson Health Research Institute, London, Ontario, Canada</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Parkinson</surname><given-names>John</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Hospital for Sick Children, Canada</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">ggloor@uwo.ca</email></corresp>
<fn fn-type="conflict"><p>The authors have the following interests: coauthor Andrew D. Fernandes is employed by YouKaryote Genomics. There are no patents, products in development or marketed products to declare. This does not alter the authors' adherence to all the PLOS ONE policies on sharing data and materials.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: GG AF JM GR TL. Performed the experiments: AF GG JM. Analyzed the data: AF GG JM. Contributed reagents/materials/analysis tools: TL GR AF JM GG. Wrote the paper: AF GG. Designed the software used in analysis: AF. Tested the software and performed simulations: GG JM.</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>2</day><month>7</month><year>2013</year></pub-date>
<volume>8</volume>
<issue>7</issue>
<elocation-id>e67019</elocation-id>
<history>
<date date-type="received"><day>21</day><month>7</month><year>2012</year></date>
<date date-type="accepted"><day>17</day><month>5</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Fernandes et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Experimental variance is a major challenge when dealing with high-throughput sequencing data. This variance has several sources: sampling replication, technical replication, variability <italic>within</italic> biological conditions, and variability <italic>between</italic> biological conditions. The high per-sample cost of RNA-Seq often precludes the large number of experiments needed to partition observed variance into these categories as per standard ANOVA models. We show that the partitioning of within-condition to between-condition variation cannot reasonably be ignored, whether in single-organism RNA-Seq or in Meta-RNA-Seq experiments, and further find that commonly-used RNA-Seq analysis tools, as described in the literature, do not enforce the constraint that the sum of relative expression levels must be one, and thus report expression levels that are systematically distorted. These two factors lead to misleading inferences if not properly accommodated. As it is usually only the biological between-condition and within-condition differences that are of interest, we developed ALDEx, an ANOVA-like differential expression procedure, to identify genes with greater between- to within-condition differences. We show that the presence of differential expression and the magnitude of these comparative differences can be reasonably estimated with even very small sample sizes.</p>
</abstract>
<funding-group><funding-statement>Funding for this work was under TL by NSERC, GR by NSERC and CIHR, GG by NSERC, AF by NSERC PDF and JM by an Ontario Graduate Scholarship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="15"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>RNA-Seq has been widely adopted by the biomedical research community and used to interrogate gene expression in many organisms. The potential advantages of RNA-Seq as a gene-expression profiling method are indisputable<xref ref-type="bibr" rid="pone.0067019-Roy1">[1]</xref>. RNA-Seq, in principle, can be used even when the genome sequence of the organism is not available because the sequence of each transcript itself can be identified and compared to closely related organisms (e.g. <xref ref-type="bibr" rid="pone.0067019-Crawford1">[2]</xref>). In some cases <italic>de novo</italic> assembly is even possible<xref ref-type="bibr" rid="pone.0067019-Grabherr1">[3]</xref>. RNA-Seq can be used to discover unanticipated transcripts, to identify and characterize novel splice and promoter variants<xref ref-type="bibr" rid="pone.0067019-Trapnell1">[4]</xref>-<xref ref-type="bibr" rid="pone.0067019-Kim1">[6]</xref>, and has a much larger potential dynamic range than microarrays<xref ref-type="bibr" rid="pone.0067019-Smith1">[7]</xref>. There are fewer false positive transcripts identified with RNA-Seq than with microarrays<xref ref-type="bibr" rid="pone.0067019-vanBakel1">[8]</xref>. The underlying sequencing platforms display excellent within- and between-platform reproducibilities<xref ref-type="bibr" rid="pone.0067019-Smith1">[7]</xref>, <xref ref-type="bibr" rid="pone.0067019-McIntyre1">[9]</xref>, without the <italic>ad hoc</italic> corrections common with microarrays<xref ref-type="bibr" rid="pone.0067019-Wu1">[10]</xref>.</p>
<p>One expected outcome from an RNA-Seq experiment is a list of genes for which there is evidence of differential expression between two experimental conditions. A large number of tools have been developed to infer such a gene list, and these tools have evolved as researchers have used increasingly sophisticated statistical methods to estimate and compare relative transcript abundances from sequencing read counts<xref ref-type="bibr" rid="pone.0067019-Pachter1">[11]</xref>.</p>
<p>Existing RNA-seq analysis tools, reviewed in Pachter<xref ref-type="bibr" rid="pone.0067019-Pachter1">[11]</xref>, were designed to examine datasets derived from single organisms. These tools use a fixed-effect analysis to infer differential expression, where the observed gene expression level is equal to the expected expression level for that sample's experimental condition plus some general, random error. The single error term accounts for variation due to three sources: sampling and technical replication, as well as per-sample variability. Implicit in fixed-effect models is the assumption that within-condition differences are not of direct interest; expression level variation <italic>within</italic> an experimental condition is assumed to be either negligible compared-to or simply considered part-of the overall error. However, Meta-RNA-Seq involves changes in both organism abundance and transcript abundance, and these can be confounded using existing analysis tools.</p>
<p>The main purpose of this work is to show that within-condition variation <italic>cannot</italic> reasonably be ignored, especially in Meta-RNA-Seq experiments, and if such variation is not correctly accommodated for then misleading inference will occur. We show that single organism RNA-Seq and Meta-RNA-Seq datasets can be examined by robust statistical methods similar to traditional random-effect ANOVA models that decompose sample-to-sample variation into four parts: within-condition variation, between-condition variation, sampling variation, and general (unexplained) error. We propose that evidence for differential expression in these datasets can be accurately evaluated using both ''statistical significance'' and ''effect-size'' estimates derived from such models because these two values respectively describe the confidence we have that expression in the conditions are different, and the magnitude by which they differ. Others have argued that characterizing biological data in this way is more informative than decisions based upon <italic>p</italic>-value thresholds because <italic>p</italic>-values encourage acceptance or rejection of a null hypothesis rather than an explicit assessment of the evidence<xref ref-type="bibr" rid="pone.0067019-Nakagawa1">[12]</xref>, <xref ref-type="bibr" rid="pone.0067019-Parks1">[13]</xref>. We further model the data as ''compositional'' or ''proportional'' because the reads obtained on a high-throughput sequencing run are constrained to the total number of reads available, the total of which are, to a large extent, non-informative. Spurious correlations are observed when compositional data are analyzed<xref ref-type="bibr" rid="pone.0067019-Pearson1">[14]</xref> and recent methods to deal properly with high-dimensional proportional data have been developed<xref ref-type="bibr" rid="pone.0067019-Aitchison1">[15]</xref>–<xref ref-type="bibr" rid="pone.0067019-Egozcue2">[18]</xref>.</p>
</sec><sec id="s2">
<title>Results</title>
<p>Most RNA-seq datasets contain many genes with zero read counts (e.g. <xref ref-type="bibr" rid="pone.0067019-Crawford1">[2]</xref>, <xref ref-type="bibr" rid="pone.0067019-Marioni1">[19]</xref>–<xref ref-type="bibr" rid="pone.0067019-Rosenthal1">[21]</xref>) due to sparse sampling. The method described below explicitly accounts for the probability that genes with 0 read counts actually represent non-expressed genes as opposed to insufficient sequencing depth.</p>
<p>Most statistical analyses of RNA-Seq data model the read counts obtained from the sequencer as having come from a Poisson-like process such that for gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e004" xlink:type="simple"/></inline-formula> the number of counts observed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e005" xlink:type="simple"/></inline-formula> is a Poisson random variable from a process with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e006" xlink:type="simple"/></inline-formula>. These analyses seek to infer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e007" xlink:type="simple"/></inline-formula> given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e008" xlink:type="simple"/></inline-formula> for every gene in the sample. For a Poisson random variable the mean and variance equal both the rate, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e009" xlink:type="simple"/></inline-formula>. However, plots of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e010" xlink:type="simple"/></inline-formula> versus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e011" xlink:type="simple"/></inline-formula>, where each quantity is estimated through technical replicates, have been used to argue that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e012" xlink:type="simple"/></inline-formula> is over-dispersed. Thus when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e013" xlink:type="simple"/></inline-formula>, such over-dispersion implies that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e014" xlink:type="simple"/></inline-formula> are better modelled by a negative-binomial-like process <xref ref-type="bibr" rid="pone.0067019-Robinson1">[22]</xref>. As shown below the over-dispersion attributed to sampling variance is equally and independently well-explained by putative technical error or within-condition variance. In fact, the original observation of overdispersion was from the analysis of SAGE data <xref ref-type="bibr" rid="pone.0067019-Robinson1">[22]</xref> where the additional dispersion parameter was added to account for library-to-library variability. Note that the term ''technical replicate'' is imprecise as it may refer to error introduced by the sequencing technology or error introduced during sample preparation <xref ref-type="bibr" rid="pone.0067019-Marioni1">[19]</xref>, <xref ref-type="bibr" rid="pone.0067019-Anders1">[23]</xref>. In this work, ''technical replicate'' is used in the sense of Robinson and Smyth <xref ref-type="bibr" rid="pone.0067019-Robinson1">[22]</xref> that includes error due to sample preparation.</p>
<sec id="s2a">
<title>Inferring proportions from counts</title>
<p>The total number of reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e015" xlink:type="simple"/></inline-formula> observed from a single high-throughput sequencing run, although itself a random variable, provides little direct information about the sample and is generally not of interest. Instead, for each gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e016" xlink:type="simple"/></inline-formula> we use the set of counts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e017" xlink:type="simple"/></inline-formula> to infer its proportion <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e018" xlink:type="simple"/></inline-formula> within the sequenced sample. We do so by assuming that each gene's read count was sampled from a Poisson process, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e019" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e020" xlink:type="simple"/></inline-formula>. The equivalency between Poisson and multinomial processes can then be used to assert that the set of joint counts with given total has a multinomial distribution, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e021" xlink:type="simple"/></inline-formula> where each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e022" xlink:type="simple"/></inline-formula>.</p>
<p>Unlike previous methods, however, we exploit the fact that <italic>formal</italic> equivalence between Poisson and multinomial processes does not imply <italic>inferential</italic> equivalence. Specifically, rather than using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e023" xlink:type="simple"/></inline-formula> to estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e024" xlink:type="simple"/></inline-formula> and then using the set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e025" xlink:type="simple"/></inline-formula> to estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e026" xlink:type="simple"/></inline-formula>, we estimate the set of proportions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e027" xlink:type="simple"/></inline-formula> directly from the set of counts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e028" xlink:type="simple"/></inline-formula>. Critically, an often-overlooked fact with such estimates is that the traditional maximum-likelihood estimate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e029" xlink:type="simple"/></inline-formula> for multinomial processes is accurate only when none of the counts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e030" xlink:type="simple"/></inline-formula> are small or zero <xref ref-type="bibr" rid="pone.0067019-Newey1">[24]</xref>. Since most datasets of this type contain large numbers of genes with zero or small read counts, the maximum-likelihood estimate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e031" xlink:type="simple"/></inline-formula> is often exponentially inaccurate. For example, if a coin is flipped twice and comes up heads both times, the heads-to-tails counts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e032" xlink:type="simple"/></inline-formula> do not imply that the probability of tails <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e033" xlink:type="simple"/></inline-formula> is exactly zero. In fact, assuming that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e034" xlink:type="simple"/></inline-formula> is exactly zero is equivalent to the rather strong assumption that the coin has only one side. Equivalent statements hold for sequencing counts; the assumption that a read count of zero is equivalent to the transcript being ''not present'' has surprisingly large consequences on the overall analysis, as we show later.</p>
<p>Instead of maximum-likelihood, we use standard Bayesian techniques<xref ref-type="bibr" rid="pone.0067019-Jaynes1">[25]</xref> to infer the posterior distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e035" xlink:type="simple"/></inline-formula> as the product of the multinomial likelihood with a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e036" xlink:type="simple"/></inline-formula> prior. Note that by definition and construction, Dirichlet-distributed random variates always enforce conservation of proportion such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e037" xlink:type="simple"/></inline-formula>. For an overview of Dirichlet random variables, see Frigyik <italic>et al</italic><xref ref-type="bibr" rid="pone.0067019-BelaAFrigyik1">[26]</xref>. Further, this specific choice of prior and this choice alone has been shown to simultaneously maximize the information present in the data while minimizing the influence of the prior on the posterior when the relative frequencies of all genes are of equal interest<xref ref-type="bibr" rid="pone.0067019-Berger1">[27]</xref>, as is the case for RNA-Seq or other tag-sequencing type experiments. This is the only method of inferring frequencies from counts that is guaranteed to be invariant to reparameterization, have consistent sampling properties, and be immune to marginalization paradoxes <xref ref-type="bibr" rid="pone.0067019-Bernardo1">[28]</xref>, <xref ref-type="bibr" rid="pone.0067019-Berger2">[29]</xref>.</p>
<p>Due to the large variance and extreme non-normality of the marginal distributions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e038" xlink:type="simple"/></inline-formula> when the associated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e039" xlink:type="simple"/></inline-formula> are small, we do not summarize the posterior of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e040" xlink:type="simple"/></inline-formula> using point-estimates. Instead, all inferences are performed using the <italic>full</italic> posterior distribution of probabilities drawn from the Dirichlet distribution such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e041" xlink:type="simple"/></inline-formula>.</p>
<p>This multivariate distribution ensures that none of the inferred proportions are ever exactly zero even if the associated count is zero, and that probability is conserved (i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e042" xlink:type="simple"/></inline-formula>). The given posterior further explicitly accounts for the fact that a read count of 1 out of 100 total reads conveys much lower precision of an estimated proportion than does a read count of 100 out of 10000 total reads, even though they have the same fractional read count. Therefore, marginal distributions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e043" xlink:type="simple"/></inline-formula> are wide when the associated read count is low and narrow when the associated read count is large, as would be intuitively expected.</p>
<p>In other words, rather than transforming the observed data through an <italic>ad hoc</italic> normalization procedure and then inferring proportional expression, we instead prefer to infer proportional expression <italic>directly</italic> from the read count observations through a statistical model that, by construction, explicitly always enforces ''normalization'' of the inferred parameters.</p>
</sec><sec id="s2b">
<title>Transforming proportional data into independent components</title>
<p>It can be difficult to meaningfully compare between-sample values from proportional distributions because each set of proportions is constrained to have a constant sum. This means that the values cannot be independent; an increase in one or more proportions <italic>necessarily</italic> implies a concomitant decrease in one or more other proportions and <italic>vice versa</italic><xref ref-type="bibr" rid="pone.0067019-Pearson1">[14]</xref>. Fortunately, Aitchison and Egozcue, among others<xref ref-type="bibr" rid="pone.0067019-Aitchison1">[15]</xref>, <xref ref-type="bibr" rid="pone.0067019-Egozcue1">[17]</xref>, <xref ref-type="bibr" rid="pone.0067019-Egozcue2">[18]</xref> have developed procedures to transform component proportions into linearly independent components. The transformation can be understood by considering a hypothetical two-gene experiment where genes <italic>H</italic> and <italic>T</italic> are inferred to have proportional expression <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e044" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e045" xlink:type="simple"/></inline-formula>, respectively and that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e046" xlink:type="simple"/></inline-formula>. The sum, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e047" xlink:type="simple"/></inline-formula>, is a positive constant scaling factor that is usually equal to one (proportional data) or one hundred (percentile data). The proportional two-component vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e048" xlink:type="simple"/></inline-formula> is experimentally equivalent to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e049" xlink:type="simple"/></inline-formula> for any positive scale-factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e050" xlink:type="simple"/></inline-formula>. Taking component-wise logarithms, we see that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e051" xlink:type="simple"/></inline-formula>, which, after algebraic rearrangement can be written as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e052" xlink:type="simple"/></inline-formula>. Egozcue <italic>et al.</italic> showed that this space of log-proportions was equivalent to a Euclidean vector space<xref ref-type="bibr" rid="pone.0067019-Egozcue1">[17]</xref>, <xref ref-type="bibr" rid="pone.0067019-Egozcue2">[18]</xref> and as such, contributions from the subspace spanning <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e053" xlink:type="simple"/></inline-formula>, here termed the ''uninformative subspace,'' can be removed via standard techniques from linear algebra. More explicitly, for two or more dimensions the overall procedure for a set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e054" xlink:type="simple"/></inline-formula> proportions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e055" xlink:type="simple"/></inline-formula> involves taking component-wise logarithms and subtracting the constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e056" xlink:type="simple"/></inline-formula> from each log-proportion component. This results in the values <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e057" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e058" xlink:type="simple"/></inline-formula> is always zero, and this transformation from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e059" xlink:type="simple"/></inline-formula> has been named the Isometric Log-Ratio (ILR) transformation<xref ref-type="bibr" rid="pone.0067019-Egozcue2">[18]</xref>. Most importantly, projecting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e060" xlink:type="simple"/></inline-formula> onto any basis of its <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e061" xlink:type="simple"/></inline-formula>-dimensional span results in a vector with linearly independent components. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e062" xlink:type="simple"/></inline-formula> the ILR transformation is shown graphically in Supplementary Figure S1 in <xref ref-type="supplementary-material" rid="pone.0067019.s001">File S1</xref>.</p>
</sec><sec id="s2c">
<title>Properties of the transformed data</title>
<p>Removing the uninformative <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e063" xlink:type="simple"/></inline-formula> subspace has the critical effect of removing the possibly-large multivariate statistical bias introduced by the log-transformation (see Supplementary Figure S1 in <xref ref-type="supplementary-material" rid="pone.0067019.s001">File S1</xref>). Furthermore, although the constraint that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e064" xlink:type="simple"/></inline-formula> induces unavoidable covariation among genes, the covariance induced in the adjusted log-proportions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e065" xlink:type="simple"/></inline-formula> can be shown to be inversely proportional to the number of genes considered, as shown by the explicit formula for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e066" xlink:type="simple"/></inline-formula> given below. For high-throughput data where thousands of genes are simultaneously considered, this induced covariance becomes effectively zero. Although still not independent since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e067" xlink:type="simple"/></inline-formula>, carefully-constructed analyses can exploit this near-zero covariance in order to simplify numerical computations.</p>
<p>The adjusted log-proportion values <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e068" xlink:type="simple"/></inline-formula> correspond exactly to ''fold-based'' abundances from traditional expression analysis that have been shifted so that the mean log-expression value is zero. The result is that the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e069" xlink:type="simple"/></inline-formula> can be any real value centred on zero. Using base-two logarithms, for example, makes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e070" xlink:type="simple"/></inline-formula> represent the two-fold doubling or halving of proportional level. Next, since each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e071" xlink:type="simple"/></inline-formula>-dimensional vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e072" xlink:type="simple"/></inline-formula> can be exactly represented by a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e073" xlink:type="simple"/></inline-formula>-dimensional vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e074" xlink:type="simple"/></inline-formula> whose components are linearly independent, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e075" xlink:type="simple"/></inline-formula> and hence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e076" xlink:type="simple"/></inline-formula> can be analyzed in a traditional ANOVA-like framework. We emphasize that although the analytic distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e077" xlink:type="simple"/></inline-formula> is straightforward to compute given the Dirichlet-distributed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e078" xlink:type="simple"/></inline-formula>, it is cumbersome to use directly. Thus we estimate the distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e079" xlink:type="simple"/></inline-formula> from multiple Monte Carlo realizations of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e080" xlink:type="simple"/></inline-formula> given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e081" xlink:type="simple"/></inline-formula>. When summary statistics are necessary, however, we note that for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e082" xlink:type="simple"/></inline-formula> we have <disp-formula id="pone.0067019.e083"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0067019.e083" xlink:type="simple"/></disp-formula><disp-formula id="pone.0067019.e084"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0067019.e084" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e085" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e086" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e087" xlink:type="simple"/></inline-formula> represent the digamma, trigamma, and Kronecker-delta functions, respectively. These formulas are derived using the standard exponential family formula for the moment generating function of the sufficient statistic <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e088" xlink:type="simple"/></inline-formula> for the Dirichlet distribution. Note that since each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e089" xlink:type="simple"/></inline-formula> and the trigamma function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e090" xlink:type="simple"/></inline-formula> is roughly proportional to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e091" xlink:type="simple"/></inline-formula>, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e092" xlink:type="simple"/></inline-formula> matrix becomes diagonal at a rate inversely-proportional to both the total read count and the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e093" xlink:type="simple"/></inline-formula> of genes considered, when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e094" xlink:type="simple"/></inline-formula> is Dirichelt-distributed as described.</p>
</sec><sec id="s2d">
<title>Application of the method to real datasets</title>
<p><xref ref-type="table" rid="pone-0067019-t001">Table 1</xref> shows the characteristics of three distinct RNA-seq datasets used in the analysis. Each dataset contains four samples, two in each condition. The first dataset is an RNA-Seq experiment on the Illumina platform performed by Marioni et al<xref ref-type="bibr" rid="pone.0067019-Marioni1">[19]</xref> that contains technical replicate samples of gene expression in Liver and Kidney cells, where the error due to sample preparation is known <italic>a priori</italic> to be zero. We refer to this to as the ''L-K dataset'' and we used replicates 1 and 2 of Kidney and of Liver run in lanes 1 and 2. This dataset is often used to evaluate assumptions underlying RNA-Seq methods<xref ref-type="bibr" rid="pone.0067019-Anders1">[23]</xref>, <xref ref-type="bibr" rid="pone.0067019-Wang2">[30]</xref> and contains 32000 coding sequences (CDS). The second dataset is a very high sampling depth RNA-Seq experiment performed by our group on the ABI-SOLiD 4 platform to examine differential expression upon shift from growth at pH∶7.2 to 5.5 in <italic>Bacillus cereus</italic> 14579. One of the two samples in each growth condition contained a plasmid. Transcripts from the genes on the plasmid may be differential because of differential presence, differential expression, or both, and some chromosomal genes have differing expression because of the presence or absence of the plasmid. For simplicity, we will refer to these as plasmid-associated genes. In this data set, technical replicates <italic>included</italic> error due to sample preparation. The third dataset is a meta-RNA-Seq experiment performed to characterize the differences in gene abundance and expression in the vaginal bacterial communities found in two women with a micobiota associated with vaginal health and two women with a microbiota characteristic of a dysbiotic state called bacterial vaginosis<xref ref-type="bibr" rid="pone.0067019-Macklaim1">[31]</xref>. <xref ref-type="table" rid="pone-0067019-t002">Table 2</xref> shows the organism composition of these four samples. We will refer to this as the Meta dataset.</p>
<table-wrap id="pone-0067019-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.t001</object-id><label>Table 1</label><caption>
<title>Sample characteristics</title>
</caption><alternatives><graphic id="pone-0067019-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Sample</td>
<td align="left" rowspan="1" colspan="1">CDS</td>
<td align="left" rowspan="1" colspan="1">Reads/sample</td>
<td align="left" rowspan="1" colspan="1">0 read genes/sample</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">L–K</td>
<td align="left" rowspan="1" colspan="1">32000</td>
<td align="left" rowspan="1" colspan="1">1.43–1.98 M</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e001" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>B. cereus</italic></td>
<td align="left" rowspan="1" colspan="1">5378</td>
<td align="left" rowspan="1" colspan="1">16.7–23 M</td>
<td align="left" rowspan="1" colspan="1">50–63</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Meta</td>
<td align="left" rowspan="1" colspan="1">33412</td>
<td align="left" rowspan="1" colspan="1">5.5–10.6 M</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e002" xlink:type="simple"/></inline-formula> – <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e003" xlink:type="simple"/></inline-formula></td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>Sample names, coding sequence (CDS) numbers, the range in mappable reads per sample, and the number of genes with 0 reads in any sample are given.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pone-0067019-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.t002</object-id><label>Table 2</label><caption>
<title>Meta sample taxonomic abundance</title>
</caption><alternatives><graphic id="pone-0067019-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Taxon</td>
<td align="left" rowspan="1" colspan="1">N4</td>
<td align="left" rowspan="1" colspan="1">N30</td>
<td align="left" rowspan="1" colspan="1">B27</td>
<td align="left" rowspan="1" colspan="1">B31</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Gardnerella vaginalis</italic></td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">21.3</td>
<td align="left" rowspan="1" colspan="1">5.5</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Lactobacillus</italic></td>
<td align="left" rowspan="1" colspan="1">7.6</td>
<td align="left" rowspan="1" colspan="1">7.6</td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">2.4</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Lactobacillus acidophilus</italic></td>
<td align="left" rowspan="1" colspan="1">1.5</td>
<td align="left" rowspan="1" colspan="1">1.6</td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">0.4</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Lactobacillus crispatus</italic></td>
<td align="left" rowspan="1" colspan="1">86.0</td>
<td align="left" rowspan="1" colspan="1">79.7</td>
<td align="left" rowspan="1" colspan="1">0.2</td>
<td align="left" rowspan="1" colspan="1">23.4</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Lactobacillus iners</italic></td>
<td align="left" rowspan="1" colspan="1">1.1</td>
<td align="left" rowspan="1" colspan="1">7.0</td>
<td align="left" rowspan="1" colspan="1">25.8</td>
<td align="left" rowspan="1" colspan="1">53.4</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Lactobacillus jensenii</italic></td>
<td align="left" rowspan="1" colspan="1">2.9</td>
<td align="left" rowspan="1" colspan="1">3.2</td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">1.2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Megasphaera</italic> sp.</td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">9.1</td>
<td align="left" rowspan="1" colspan="1">0.3</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Prevotella amnii</italic></td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">40.5</td>
<td align="left" rowspan="1" colspan="1">6.9</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Prevotella disiens</italic></td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">0.1</td>
<td align="left" rowspan="1" colspan="1">1.2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Prevotella timonensis</italic></td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">0.0</td>
<td align="left" rowspan="1" colspan="1">0.3</td>
<td align="left" rowspan="1" colspan="1">2.0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">rare</td>
<td align="left" rowspan="1" colspan="1">0.8</td>
<td align="left" rowspan="1" colspan="1">0.8</td>
<td align="left" rowspan="1" colspan="1">2.5</td>
<td align="left" rowspan="1" colspan="1">3.3</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>The organism name and proportional abundance for the two clinical samples with normal Nugent scores (N) and the two samples with high Nugent scores indicitive of bacterial vaginosis (BV) are given. Totals may not sum to 1 because of rounding errors.</p></fn></table-wrap-foot></table-wrap>
<p>For each sample discussed below, sequencing reads were mapped to genes and hence gene transcripts using standard techniques<xref ref-type="bibr" rid="pone.0067019-Langmead1">[32]</xref> resulting in a set of read counts for every sample. The count tables for the L-K dataset were accessed from the supplementary data of Marioni et. al.<xref ref-type="bibr" rid="pone.0067019-Marioni1">[19]</xref>. For each sample, the set of read counts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e095" xlink:type="simple"/></inline-formula> was used to infer a posterior distribution for the relative abundances <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e096" xlink:type="simple"/></inline-formula>, as outlined above.</p>
<p><xref ref-type="fig" rid="pone-0067019-g001">Figure 1</xref> shows a plot of the dispersion caused by sampling variation for the L-K dataset. Marioni et. al.<xref ref-type="bibr" rid="pone.0067019-Marioni1">[19]</xref> assessed sampling variability by running the same library on separate Illumina lanes. As predicted, observed variability is large when a gene is covered by zero or few reads and small when a gene is covered by many reads. To assess the correspondence between the actual variability and the variability modelled by the Dirichlet distribution, the expected difference between the 1–99% quantiles for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e097" xlink:type="simple"/></inline-formula> are overlaid with Monte Carlo estimates of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e098" xlink:type="simple"/></inline-formula> computed from realizations of the posterior distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e099" xlink:type="simple"/></inline-formula>. The almost perfect overlay of these values strongly supports the idea that modelling proportions through a Dirichlet-multinomial process accurately accounts for the sampling variance inherent in RNA-Seq, and by extension in other high-throughput sequencing analyses, when technical or other errors are not predominant. Others have also suggested that this distribution is appropriate for these types of data<xref ref-type="bibr" rid="pone.0067019-Friedman1">[33]</xref>–<xref ref-type="bibr" rid="pone.0067019-Holmes1">[35]</xref>.</p>
<fig id="pone-0067019-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.g001</object-id><label>Figure 1</label><caption>
<title>Dirichlet-distributed proportions accurately account for the sampling variance.</title>
<p>This plot overlays the expected range between the 1–99% quantiles for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e100" xlink:type="simple"/></inline-formula> with observed range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e101" xlink:type="simple"/></inline-formula> computed for the Liver library replicates in the L–K dataset. Marioni et al<xref ref-type="bibr" rid="pone.0067019-Marioni1">[19]</xref> minimized technical error with an experimental design where the same Illumina library was run in two separate lanes. Monte Carlo Estimates of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e102" xlink:type="simple"/></inline-formula> are shown in red with the density of the values shown in orange, while 1–99% expected quantile ranges from the Dirichlet are shown in black. This demonstrates that the error inherent in high-throughput sequencing is greatest when the counts are small and least when the counts are large. The near-perfect overlay of actual and modelled values strongly support idea that modelling proportions through a Dirichlet-multinomial process accurately accounts for the sampling variance inherent in RNA-Seq, and by extension in other high-throughput sequencing analyses. The error in estimating the expected quantiles is observable by the size of the points plotted in black and becomes small when expression is non-trivial. Values on the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e103" xlink:type="simple"/></inline-formula>-axis were calculated with the given formula for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e104" xlink:type="simple"/></inline-formula> and were adjusted to remove the non-informative subspace as outlined in the text. Thus the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e105" xlink:type="simple"/></inline-formula>-axis value of zero corresponds to the expected per-gene log<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e106" xlink:type="simple"/></inline-formula>-expression value.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.g001" position="float" xlink:type="simple"/></fig>
<p>The importance of distinguishing sampling and technical variance from within-condition variance is illustrated by <xref ref-type="fig" rid="pone-0067019-g002">Figure 2</xref> which shows the maximum within-condition expression difference versus the median expression for the sampling replicate experiment described above and for the three datasets in <xref ref-type="table" rid="pone-0067019-t001">Table 1</xref>. The L-K and <italic>B. cereus</italic> RNA-Seq experiments were tightly controlled and much of the observed variance can be attributed <italic>a priori</italic> to sampling error. We observe that the majority of genes with high expression had their proportions estimated with high precision, and this precision was directly proportional to the expression level. The fourth panel of <xref ref-type="fig" rid="pone-0067019-g002">Figure 2</xref> shows a corresponding variance-<italic>vs.</italic>-median plot for the Meta-RNA-Seq analysis of the vaginal meta-transcriptome. Here, we see that biological variability is independent of expression level and much larger than can be explained by sampling variability alone. Thus, for the Meta-RNA-Seq data much higher variance due to biological variability is observed since organism abundances and the underlying gene abundances can vary in addition to transcript levels when samples contain multiple organisms.</p>
<fig id="pone-0067019-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.g002</object-id><label>Figure 2</label><caption>
<title>Sampling and technical variance is distinct from within-condition variance.</title>
<p>A comparison of within-condition gene expression-difference to the median expression level for three different experiments. The left panel shows the sampling variance for comparison and the three experiments are shown in subsequent panels. The L-K RNA-Seq data set compares gene expression in two liver and two kidney samples. The <italic>Bacillus cereus</italic> RNA-Seq data set for samples grown at neutral pH and two samples 20 minutes after shift to grown at low pH. Meta-RNA-Seq data is for microbial gene expression analysis of four clinical vaginal samples from two women with a healthy microbiota and two women with a microbiota indicative of bacterial vaginosis. The RNA-Seq experiments in the L-K and <italic>B. cereus</italic> datasets were from controlled conditions with identical gene content per condition and show that the vast majority of highly-expressed genes have small within-condition estimates of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e107" xlink:type="simple"/></inline-formula>, and that estimate only becomes imprecise as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e108" xlink:type="simple"/></inline-formula> becomes very small. The Meta-RNA-Seq panel shows that when within-condition variance is high, there is no relationship between the expression level and the within-condition variance. Note that base-2 logarithms were used throughout.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.g002" position="float" xlink:type="simple"/></fig></sec><sec id="s2e">
<title>Identifying differentially expressed genes</title>
<p>Pachter<xref ref-type="bibr" rid="pone.0067019-Pachter1">[11]</xref> has pointed out that the majority of existing RNA-Seq statistical analysis tools can be distilled down to one of a few basic methods, and all are expected to converge on the same result with asymptotically large data sets. Informally speaking, existing methods are essentially equivalent to the following fixed-effect ANOVA. Given gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e109" xlink:type="simple"/></inline-formula> in condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e110" xlink:type="simple"/></inline-formula> with replicate number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e111" xlink:type="simple"/></inline-formula>, they model</p>
<p><disp-formula id="pone.0067019.e112"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0067019.e112" xlink:type="simple"/></disp-formula>and test the hypotheses that</p>
<p><disp-formula id="pone.0067019.e113"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0067019.e113" xlink:type="simple"/></disp-formula>between conditions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e114" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e115" xlink:type="simple"/></inline-formula>, for all genes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e116" xlink:type="simple"/></inline-formula>. As is usual in discussions of ANOVA, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e117" xlink:type="simple"/></inline-formula> is assumed to be approximately Normal. It is important to realize that under this model, within-condition sample-to-sample variation is assumed to be small and essentially negligible compared to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e118" xlink:type="simple"/></inline-formula>. It is specifically this assumption that we believe to be generally untrue for RNA-Seq analyses.</p>
<p>In contrast, our model is fundamentally different from currently available general-purpose metagenomics analysis packages in its assumption that within-condition expression is itself a non-negligible random variable. For example, two metatranscriptomic samples taken from within the healthy condition may have substantially different gene expression due to the different microbial populations present in each sample. Random-effect ANOVA models specifically account for this type of within-condition variance and the one employed herein, informally speaking, models</p>
<p><disp-formula id="pone.0067019.e119"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0067019.e119" xlink:type="simple"/></disp-formula></p>
<p>Again as per the usual ANOVA assumptions, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e120" xlink:type="simple"/></inline-formula> is assumed to be approximately Normal. The distribution of the sampling error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e121" xlink:type="simple"/></inline-formula> is given by the adjusted log-marginal distributions of the Dirichlet posterior. As seen through empirical observation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e122" xlink:type="simple"/></inline-formula> is very Gaussian-like and sharply defined when its associated read counts are large and becomes progressively more diffuse and non-Normal as read counts drop. This empirical observation matches expected behavior since, prior to removal of the uninformative subspace, each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e123" xlink:type="simple"/></inline-formula> is the beta-distributed marginal of a Dirichlet distribution. The sample-specific expression <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e124" xlink:type="simple"/></inline-formula> represents the random differences between replicates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e125" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e126" xlink:type="simple"/></inline-formula> for gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e127" xlink:type="simple"/></inline-formula> in condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e128" xlink:type="simple"/></inline-formula> and can specifically account for factors such as technical differences or differing population structures. Subject to standard ANOVA identifiability constraints, we can also test the hypotheses <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e129" xlink:type="simple"/></inline-formula>. Although this hypothesis test can convey statistical significance, it does not imply that the conditions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e130" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e131" xlink:type="simple"/></inline-formula> are meaningfully different. Instead, such meaning can be inferred through an estimated effect-size that compares predicted between-condition differences to within-condition differences.</p>
<p>There is a vast literature describing the analysis of classic random-effect ANOVAs, but these are generally inapplicable to RNA-Seq data for three reasons. First, the extreme non-normality induced by genes with low read counts invalidates standard techniques such as those using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e132" xlink:type="simple"/></inline-formula>-tests or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e133" xlink:type="simple"/></inline-formula>-tests. Second, there are almost always too few samples to properly support or refute the ''equal variance'' postulates necessary to most ANOVA setups because it is still cost-prohibitive for most labs to sequence more than a few samples per condition. Finally, the constraint <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e134" xlink:type="simple"/></inline-formula> implies that estimates derived from component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e135" xlink:type="simple"/></inline-formula> values cannot be made independently among genes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e136" xlink:type="simple"/></inline-formula>. These reasons result in most RNA-Seq experiments leaving too few degrees of freedom to properly estimate all parameters even if normality of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e137" xlink:type="simple"/></inline-formula> is assumed; itself a rather strong assumption.</p>
<p>It is worth noting that Blekhman <italic>et al.</italic> <xref ref-type="bibr" rid="pone.0067019-Blekhman1">[36]</xref> used a similar model for the analysis of sex-specific and lineage-specific alternative splicing in primates, where the Poisson intensities were modelled as fixed effects with a random-effect error term. Our work differs from theirs in two important aspects, however. First, rather than normalizing intensities, treating them as point-estimates from the read counts, we effectively integrate over all intensities consistent with the observed counts. This is important when dealing with samples that have many genes and hence relatively few reads per gene. Second, our method is optimized to allow reasonable inference even when only two samples are given in each group. Rigourous statistical inferences are difficult to make in such situations as, depending on prior assumptions, the posterior distributions of various statistics are often vary heavy tailed.</p>
<p>To ameliorate these difficulties, we have developed an ''approximate ANOVA''-like procedure suitable for the analysis of small-replicate experiments such as the majority currently described in the literature. Robust estimators, i.e., medians rather than means, are used throughout in order to mitigate effects of heavy tails and skewness prevalent in low read count genes. In what follows, let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e138" xlink:type="simple"/></inline-formula> index genes, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e139" xlink:type="simple"/></inline-formula> index the condition, and let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e140" xlink:type="simple"/></inline-formula> index the replicate of a given condition. Recall that the set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e141" xlink:type="simple"/></inline-formula> are random variables since they represent the posterior distribution of parameter estimates. Similarly, the set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e142" xlink:type="simple"/></inline-formula> are random variables as they are simple functions of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e143" xlink:type="simple"/></inline-formula>. Now consider the following random variable mixtures.</p>
<list list-type="bullet"><list-item>
<p>The within-condition mixture <disp-formula id="pone.0067019.e144"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0067019.e144" xlink:type="simple"/></disp-formula></p>
</list-item><list-item>
<p>The absolute fold difference between-conditions <disp-formula id="pone.0067019.e145"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0067019.e145" xlink:type="simple"/></disp-formula></p>
</list-item><list-item>
<p>The between sample, within-condition difference <disp-formula id="pone.0067019.e146"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0067019.e146" xlink:type="simple"/></disp-formula></p>
</list-item><list-item>
<p>The relative effect-size <disp-formula id="pone.0067019.e147"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0067019.e147" xlink:type="simple"/></disp-formula></p>
</list-item></list>
<p>We emphasize that these quantities are random variables, not traditional point-estimates, and thus have distributions that can be trivially estimated via standard Monte Carlo realization. The distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e148" xlink:type="simple"/></inline-formula> is termed the ''within-condition distribution'' of gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e149" xlink:type="simple"/></inline-formula> within condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e150" xlink:type="simple"/></inline-formula>, and the distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e151" xlink:type="simple"/></inline-formula> is termed the ''between-condition'' distribution. Note that the ''max'' operator in the definition of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e152" xlink:type="simple"/></inline-formula> makes it a conservative surrogate for the pooled within-condition variance across all conditions. Since the distributions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e153" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e154" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e155" xlink:type="simple"/></inline-formula> are estimated from multiple independent Monte Carlo realizations of their underlying Dirichlet-distributed proportions for all genes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e156" xlink:type="simple"/></inline-formula> simultaneously, they intrinsically obey the requisite <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e157" xlink:type="simple"/></inline-formula> constraint and are thus invariant to differing total read counts. Note that although the denominator of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e158" xlink:type="simple"/></inline-formula> can be zero, this occurs with probability zero and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e159" xlink:type="simple"/></inline-formula> remains well defined, much as the Cauchy random variable can be described as the ratio of two Gaussian random variables.</p>
<p>Due to the small number of experimental replicates often used, the distributions of these random variables can be fairly broad or possess heavy tails. We therefore summarize them via their quantiles, using the notation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e160" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e161" xlink:type="simple"/></inline-formula> to denote the median, and 1-99% quantiles for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e162" xlink:type="simple"/></inline-formula>, respectively, and so on for the others. We further identify the quantile of zero in the distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e163" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e164" xlink:type="simple"/></inline-formula>. Note we use a symmetric variant of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e165" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e166" xlink:type="simple"/></inline-formula>. Importantly, we do not replace the estimators with their point-summaries too early, since for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e167" xlink:type="simple"/></inline-formula> the median of a ratio can be quite different than the ratio of medians.</p>
<p>A graphical depiction of our approximate-ANOVA is depicted in <xref ref-type="fig" rid="pone-0067019-g003">Figure 3</xref>. It begins by computing multiple Monte Carlo realizations of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e168" xlink:type="simple"/></inline-formula> via Dirichlet samples <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e169" xlink:type="simple"/></inline-formula> based on each sample's read count. Realizations are grouped (as if they were drawn from a mixture-distribution) across replicates and between-conditions to compute realizations of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e170" xlink:type="simple"/></inline-formula>. Grouping within-conditions and between samples yields realizations of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e171" xlink:type="simple"/></inline-formula>. The ratio of these two realizations yields a single realization of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e172" xlink:type="simple"/></inline-formula>.</p>
<fig id="pone-0067019-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.g003</object-id><label>Figure 3</label><caption>
<title>Approximate ANOVA via Absolute and Relative fold differences.</title>
<p>The figure shows how the method explicitly accounts for the within-condition dispersion using as an example two genes with similar absolute fold differences (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e173" xlink:type="simple"/></inline-formula>) of -1.17 and -1.13 but very different relative fold differences (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e174" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e175" xlink:type="simple"/></inline-formula> values in the L-K dataset. Dirichlet sampled distributions are generated from the raw read counts as described in the text. These distributions are log-transformed and the noninformative subspace is removed. Posterior distributions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e176" xlink:type="simple"/></inline-formula> are shown for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e177" xlink:type="simple"/></inline-formula> and for replicates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e178" xlink:type="simple"/></inline-formula>. Both genes are abundantly expressed in this dataset, with median expression levels between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e179" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e180" xlink:type="simple"/></inline-formula> greater than the mean across-gene expression level. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e181" xlink:type="simple"/></inline-formula> is computed by randomly sampling one of the red distributions, randomly sampling one of the blue distributions, and subtracting for all pairs of between-condition distributions. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e182" xlink:type="simple"/></inline-formula> is computed by sampling a light and a dark from each red and blue distributions, subtracting light and dark, and selecting the difference with the greatest magnitude. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e183" xlink:type="simple"/></inline-formula> is computed as the ratio of a single realization of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e184" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e185" xlink:type="simple"/></inline-formula>, and is computed for each realization of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e186" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e187" xlink:type="simple"/></inline-formula>. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e188" xlink:type="simple"/></inline-formula> distribution is narrower in A than in B implying a greater precision in estimating this value. This precision can be estimated by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e189" xlink:type="simple"/></inline-formula>, the quantile of zero in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e190" xlink:type="simple"/></inline-formula>, which is shown graphically as the black-filled area under the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e191" xlink:type="simple"/></inline-formula> distribution curves. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e192" xlink:type="simple"/></inline-formula> values are 0.0001 and 0.035 in panels A and B respectively. The vertical arrows show the median values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e193" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e194" xlink:type="simple"/></inline-formula>. Thus, the between-condition expression values for the gene in Panel A are scored as separable by ALDEx (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e195" xlink:type="simple"/></inline-formula>) but not for the gene in Panel B (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e196" xlink:type="simple"/></inline-formula>). These conclusions agree with inspection-based intuition from examining the initial adjusted log-expression distributions that are shown in the left panel.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.g003" position="float" xlink:type="simple"/></fig>
<p>Being an estimated effect-size, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e197" xlink:type="simple"/></inline-formula> can be used to identify genes where expected between-condition differential expression is likely to be meaningfully larger than expected within-condition differential expression. The ability of different <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e198" xlink:type="simple"/></inline-formula> values to distinguish those genes that have larger between-condition than within-condition variance is shown in <xref ref-type="fig" rid="pone-0067019-g004">Figure 4</xref>. As a theoretical minimum, the criterion that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e199" xlink:type="simple"/></inline-formula> can be used to select genes where expected between-condition changes are of the same order or greater than the expected within-condition changes. However, this figure shows that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e200" xlink:type="simple"/></inline-formula> is too inclusive.</p>
<fig id="pone-0067019-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.g004</object-id><label>Figure 4</label><caption>
<title>Fold-change to variance (MW) plots of different ALDEx cutoff values.</title>
<p>Plotted here are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e201" xlink:type="simple"/></inline-formula> (i.e., the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e202" xlink:type="simple"/></inline-formula>-fold expression changes) vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e203" xlink:type="simple"/></inline-formula> (i.e., the maximum within-condition expression differences) for the L-K and Meta-RNA-Seq datasets. The grey background shows the density plot of the values. By construction, threshold <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e204" xlink:type="simple"/></inline-formula> values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e205" xlink:type="simple"/></inline-formula> should select genes for which the between-condition variation is reasonably likely to be at least twice the within-condition variation. This threshold is illustrated by the solid grey line, and the within/between-condition equivalence line is shown as the dashed grey line. The effect of altering the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e206" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e207" xlink:type="simple"/></inline-formula> cutoffs is shown. Large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e208" xlink:type="simple"/></inline-formula> values identify genes with a larger between-condition differential expression than within-condition variation. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e209" xlink:type="simple"/></inline-formula> values were <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e210" xlink:type="simple"/></inline-formula> (blue), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e211" xlink:type="simple"/></inline-formula> (cyan), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e212" xlink:type="simple"/></inline-formula> (yellow) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e213" xlink:type="simple"/></inline-formula> (red). There are a number of points where the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e214" xlink:type="simple"/></inline-formula> values exceed the chosen threshold in both the L-K and Meta datasets. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e215" xlink:type="simple"/></inline-formula> column shows the effect of identifying genes based on the estimated proportion of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e216" xlink:type="simple"/></inline-formula>. These are plotted for values of 0.1, 0.05, 0.01 and 0.001 in the two datasets, again coloured as blue, cyan, yellow or red respectively. Here we observed that the 0.01 and 0.001 cutoffs were very similar and the larger cutoffs admitted many more genes with high within-condition variation. The third panel shows the effect of enforcing the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e217" xlink:type="simple"/></inline-formula> along with each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e218" xlink:type="simple"/></inline-formula> cutoff values. In this case we observe that a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e219" xlink:type="simple"/></inline-formula> combined with an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e220" xlink:type="simple"/></inline-formula> is sufficient to ensure that genes identified as differentially expressed always have lower <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e221" xlink:type="simple"/></inline-formula> than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e222" xlink:type="simple"/></inline-formula> values in both datasets. Using both values in combination allows arbitrarily small fold expression differences to be identified if they are supported by high within-condition concordance.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.g004" position="float" xlink:type="simple"/></fig>
<p>For genes with low read counts, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e223" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e224" xlink:type="simple"/></inline-formula> distributions can be overly-broad with long tails. Thus we introduce a further criterion that is loosely analogous to a fixed-effect ANOVA <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e225" xlink:type="simple"/></inline-formula>-test. Supplementary Figure S2 in <xref ref-type="supplementary-material" rid="pone.0067019.s001">File S1</xref> shows that enforcing the criterion whereby <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e226" xlink:type="simple"/></inline-formula> is small selects against genes with low read counts, and the <italic>within</italic> and <italic>between</italic> condition variation characteristics of genes selected by different values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e227" xlink:type="simple"/></inline-formula> are shown in <xref ref-type="fig" rid="pone-0067019-g004">Figure 4</xref>. The results of using the combined <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e228" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e229" xlink:type="simple"/></inline-formula> criteria are described by the third panel of <xref ref-type="fig" rid="pone-0067019-g004">Figure 4</xref>. In practice, we find that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e230" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e231" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e232" xlink:type="simple"/></inline-formula> is a minimum practical threshold that avoids an overabundance of false-positive identifications regardless of the dataset, and recommend <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e233" xlink:type="simple"/></inline-formula> for use when a conservative estimate is required. We emphasize that, especially for experiments with small replicate numbers, it is critical to examine the suggested criteria to ensure there is a match between the characteristics of the data being examined and the threshold values chosen. This will ensure that the decision as to which genes are identified as differentially expressed is based on analyses similar to the plot in <xref ref-type="fig" rid="pone-0067019-g004">Figure 4</xref>. Changing threshold values corresponds to adjusting the stringency of a hypothesis test, with concomitant trade-off in resultant Type-I and Type-II errors. However, as shown in <xref ref-type="fig" rid="pone-0067019-g004">Figure 4</xref> the cutoffs chosen ensure that no genes with large within-condition variance relative to between-condition variance are identified as differentially-expressed in any of the datasets tested.</p>
</sec><sec id="s2f">
<title>Inputs and Outputs</title>
<p>The method has been implemented as the ALDEx (ANOVA-Like Differential Expression) version 1.0 package for the R statistical software system. The ALDEx package takes as input a table containing per-gene sequencing counts for each replicate and a list indicating which replicate should be grouped in what condition. Each sample is a column, and per-gene counts are in rows. It currently requires two or more samples in two conditions. It computes one table for all genes containing the following: individual median expression data for each gene in each sample, the median expression for each gene in each condition, the median expression level across conditions (A), the median absolute fold difference (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e234" xlink:type="simple"/></inline-formula>), the median effect-size (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e235" xlink:type="simple"/></inline-formula>), the median within-condition difference (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e236" xlink:type="simple"/></inline-formula>) and the quantile of zero in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e237" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e238" xlink:type="simple"/></inline-formula>). Optionally, multiple quantiles in addition to the median are also returned. Graphically, these data may be displayed as Bland-Altman (MA)<xref ref-type="bibr" rid="pone.0067019-Altman1">[37]</xref> and MW plots similar to those in <xref ref-type="fig" rid="pone-0067019-g005">Figure 5</xref> and Supplementary Figure S2 in <xref ref-type="supplementary-material" rid="pone.0067019.s001">File S1</xref>.</p>
<fig id="pone-0067019-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.g005</object-id><label>Figure 5</label><caption>
<title>Comparison of four differential expression methods in the <italic>B. cereus</italic> dataset.</title>
<p>Transcript abundances identified as differential by the first three methods are highlighted in red on a background density plot. Default false discovery rates for each program were used, 0.05 for CuffDiff and 0.1 for both edgeR and DESeq, since these reflect the configurations in which most users will use these programs. In the case of ALDEx transcripts with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e239" xlink:type="simple"/></inline-formula> are highlighted in red and orange for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e240" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e241" xlink:type="simple"/></inline-formula>. Transcripts originating from genes contained on the plasmid that is found in one sample from each condition are circled. The top row shows typical Bland-Altman style (MA) plots where the median absolute fold change (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e242" xlink:type="simple"/></inline-formula>) is plotted vs. the mean expression value (Expression). The mean expression value on x-axis is 0 for the reasons outlined in the text. Notice that the edgeR method identifies differentially-expressed transcripts with much lower abundances than the other three methods. The plasmid-encoded genes are not differentiated on the Bland-Altman-style plots. The bottom row shows an MW plot of the median absolute fold change between-conditions (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e243" xlink:type="simple"/></inline-formula>) vs. the maximum within-condition difference (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e244" xlink:type="simple"/></inline-formula>) of the same data. Here it is clear that transcripts originating from the plasmid-encoded genes exhibit very large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e245" xlink:type="simple"/></inline-formula> values. Interestingly, there are a number of chromosomally-encoded genes in this dataset, and in the other two (see previous figure) that also show large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e246" xlink:type="simple"/></inline-formula> values, demonstrating that within-condition variation can be problematic even for samples derived from well-controlled conditions. Both CuffDiff and edgeR identified as differentially expressed a significant fraction of the plasmid-derived transcripts.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.g005" position="float" xlink:type="simple"/></fig></sec><sec id="s2g">
<title>Comparison of ALDEx to existing methods</title>
<p>We initially compared the ability of ALDEx, DESeq<xref ref-type="bibr" rid="pone.0067019-Anders1">[23]</xref>, edgeR <xref ref-type="bibr" rid="pone.0067019-Robinson2">[38]</xref> and CuffDiff<xref ref-type="bibr" rid="pone.0067019-Trapnell2">[39]</xref> to identify differentially expressed transcripts in the <italic>B. cereus</italic> dataset. Gene expression was evaluated for <italic>B. cereus</italic> ATCC 14579 grown <italic>in vitro</italic>. This dataset contained four samples in two conditions, two samples before and two samples 30 minutes after a pH∶7.2 to pH∶5.5 shift. Importantly, only one sample per condition contained the plasmid pBClin15. In this experimental design chromosomal genes exhibited high between-condition expression differences while, the genes on the plasmid and those controlled by genes on the plasmid exhibited both high within-condition variability and high between-condition expression differences.</p>
<p>The results are shown in <xref ref-type="fig" rid="pone-0067019-g005">Figures 5</xref> and <xref ref-type="fig" rid="pone-0067019-g006">6</xref>. The between-condition fold change (M) vs. mean expression (A) plots in the top row in <xref ref-type="fig" rid="pone-0067019-g005">Figure 5</xref> show that the identification of differentially expressed genes is tightly and directly linked to their expression level for each tool. In order to be identified as differentially-expressed, transcript abundances must pass a threshold that is a composite of the mean expression level and the between-condition expression difference. This type of plot, while commonly used, obscures the relationship between within- and between-condition variation since the plasmid-associated genes circled in black are not obviously separated from the rest.</p>
<fig id="pone-0067019-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.g006</object-id><label>Figure 6</label><caption>
<title>Venn diagram of the four differential expression methods in the <italic>B. cereus</italic> dataset.</title>
<p>Transcript abundances were identified as differential as in <xref ref-type="fig" rid="pone-0067019-g005">Figure 5</xref>. The overlap between the number of differentially expressed transcripts for each method is given in the individual cells of the diagram. The number of differentially regulated transcripts for each method is: ALDEx 1614, DESeq 1587, edgeR 1393, CuffDiff 1465. The diagram was prepared using the Venny web tool(Available: <ext-link ext-link-type="uri" xlink:href="http://bioinfogp.cnb.csic.es/tools/venny" xlink:type="simple">http://bioinfogp.cnb.csic.es/tools/venny</ext-link>. Accessed May 23, 2013) <xref ref-type="bibr" rid="pone.0067019-Oliveros1">[57]</xref>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.g006" position="float" xlink:type="simple"/></fig>
<p>The bottom row of <xref ref-type="fig" rid="pone-0067019-g005">Figure 5</xref> shows a plot of the between-condition fold change (M) vs. within-condition fold change (W) (MW). Here the majority of the plasmid-associated transcripts, circled in black, are clear outliers on the within-condition axis. Note that the within-condition transcript variation ranges from a value of approximately 2 to greater than 15. This is because the gene itself is present in one sample from each condition, but the transcript abundance varies greatly. Therefore, the expression difference for a given transcript is controlled both by gene presence and by transcript abundance. Transcripts from these genes should not rationally be identified as differentially expressed between-conditions. Both CuffDiff and edgeR identified approximately half of these transcripts as differentially expressed, but DESeq and ALDEx did not. However, all tools except ALDEx identified many differentially expressed transcripts where the within-condition variation was larger than the between-condition variation, with DESeq identifying the fewest.</p>
<p>The number of differentially-expressed transcripts identified by each method is shown in the Venn diagram in <xref ref-type="fig" rid="pone-0067019-g006">Figure 6</xref>. ALDEx identified the largest number of differentially-regulated genes in this dataset, but over 75% of these were also identified by the other 3 methods. Only 4.5% of the differentially-regulated genes identified by ALDEx were unique. One recent paper used microarrays to characterize the response of <italic>B. subtillus</italic> ATCC 14579 to a variety of acid responses, including a 30 minute acid downshock with HCl to pH∶5.0<xref ref-type="bibr" rid="pone.0067019-Mols1">[40]</xref> at various times after the downshift. We extracted the list of genes that responded to HCl, but not organic acids from the supplementary tables as those that were up- or down-regulated in the following categories: responds to all acid downshocks in microarray, responds to HCl but not acetic or lactic, responds to nonlethal acid downshocks by any acid, and responds to HCl only with retarded growth. We examined the overlap between the four RNA-Seq analysis methods and the microarray analysis of acid response and found that all four methods were able to identify equivalent numbers of the 423 genes that responded to specifically to HCl in this experiment (number of differentially-regulated genes identified by method: edgeR 376, ALDEx 377, DESeq 383, CuffDiff 390). While the experimental design of the microarray is not an exact duplicate of our analysis, these results shows that all four methods, including ALDEx, are able to identify the genes that are differentially regulated during a known biological response.</p>
<p>In addition, we compared ALDEx to DESeq and edgeR using a synthetic dataset based on the <italic>B. cereus</italic> dataset. Here, an additional 22 synthetic genes were known to be differentially expressed by fold differences ranging between 1.1 and 10 with initial read counts ranging between 1 and 1024. Technical variance within and between the conditions was modelled by Dirichlet sampling. <xref ref-type="fig" rid="pone-0067019-g007">Figure 7</xref> shows the results. As expected, we observed that the ability of DESeq and edgeR to identify true positive expression differences were nearly indistinguishable, as was their average per-gene false positive rate when examined at the same false discovery rate cutoff. When ALDEx was used with the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e247" xlink:type="simple"/></inline-formula> of 1.5, it performed nearly as well in these simulated datasets as did the other two, but was slightly less sensitive at low simulated gene expression levels. This result is entirely consistent with the underlying ALDEx algorithm, as the technical variance is large when expression levels are low (<xref ref-type="fig" rid="pone-0067019-g001">Figure 1</xref>). As expected ALDEx with a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e248" xlink:type="simple"/></inline-formula> cutoff of 2.0 was even more restrictive at low expression levels, and was somewhat less sensitive than the other methods, although the difference is small when the minimum expression level was greater than 4 counts per gene. The right panel shows the per-gene false positive rate calculated for ALDEx at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e249" xlink:type="simple"/></inline-formula> of 1.5 and 2.0, and for the other two methods at a FDR of 5% and 10%. All three methods were found to have low false positive rates. ALDEx with a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e250" xlink:type="simple"/></inline-formula> of 1.5 was the highest, although even here the per-gene false positive rate translates into approximately 1.5 false positive gene identifications in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e251" xlink:type="simple"/></inline-formula> gene dataset. The ALDEx <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e252" xlink:type="simple"/></inline-formula> cutoff of 2.0 had a per-gene false positive rate that was essentially the same as a FDR of 10% for the DESeq and edgeR algorithms.</p>
<fig id="pone-0067019-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.g007</object-id><label>Figure 7</label><caption>
<title>True and False positive identification in simulated data.</title>
<p>A set of eleven genes with simulated read counts between 1 and 1024 in two-fold increments were appended twice to a single sample of the <italic>B. cereus</italic> dataset. Two conditions were generated by multiplying the counts for a single set of simulated genes in each condition by the fold-difference values indicated in the True positive panel on the left, and two simulated technical replicates were generated for each condition by sampling from the Dirichlet distribution which accurately models technical variance in these datasets (<xref ref-type="fig" rid="pone-0067019-g001">Figure 1</xref>). The resulting four samples were examined by DESeq, edgeR and ALDEx for the ability of each method to identify the simulated differentially-expressed genes. The fold change varied between 1.1 and 10 and 100 simulations were run for each fold change. The fold change value is overlaid on the corresponding curve in the left panel. The line colors are black for edgeR, blue for DESeq and red for ALDEx, and the symbols are the same for each fold change value across each method. The ALDEx <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e253" xlink:type="simple"/></inline-formula> cutoff of 1.5 is a solid and 2.0 is a dashed line. The right panel shows the per-gene false positive rate for each method at two cutoffs. False positive events in this model can only arise through outliers in the Dirichlet sampling procedure. The rate was calculated by dividing the number of false positive genes identified in each trial by the number of genes in the dataset (5358). The boxplot shows the range of false positive rates observed for each method across all trials and all expression levels. A rate of 0.0002 corresponds to approximately 1 false positive per trial in this dataset.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.g007" position="float" xlink:type="simple"/></fig>
<p>We next compared ALDEx, edgeR and DESeq on the highly variable Meta-RNA-Seq dataset. CuffDiff was not used as it was not practical to generate the required input gff files from the mixed-species sample. This dataset contained two clinical samples from vaginal swabs obtained from non-BV (bacterial vaginosis) women and one each from a women with intermediate- or full-grade BV<xref ref-type="bibr" rid="pone.0067019-Macklaim1">[31]</xref>. The non-BV samples were composed largely of reads mapping to <italic>Lactobacillus crispatus</italic> and <italic>Lactobacillus iners</italic> and two BV samples contained reads from a more diverse population of organisms including the two <italic>Lactobacillus</italic> species, <italic>Gardnerella vaginalis</italic>, <italic>Prevotella</italic> species and others.</p>
<p>The three tools behaved very differently in this dataset as shown in <xref ref-type="fig" rid="pone-0067019-g008">Figure 8</xref>. ALDEx and edgeR identified a large number of transcripts as being differentially expressed, although it is apparent that there was minimal overlap between the transcripts identified. The MA and MW plots for ALDEx illustrate that this tool identified as differentially expressed those transcripts that met the following criteria: non-negligible expression, and within-condition variation lower than between-condition variation. In contrast, edgeR identified transcripts with large fold expression differences regardless of the average expression level or the within-condition variation. DESeq was very conservative and identified only a handful of differentially-expressed transcripts, all with extremely high mean expression levels.</p>
<fig id="pone-0067019-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.g008</object-id><label>Figure 8</label><caption>
<title>Comparison of three differential expression methods in the Meta dataset.</title>
<p>This dataset contains extreme transcript abundance variation within- and between-conditions. In this dataset the ALDEx method exhibits similar characteristics as in the <italic>B. cereus</italic> dataset, in that it identifies as differential those transcripts that exhibit high between-condition variation and low within-condition variation. This is illustrated by the left column that shows an MA-like plot and an MW plot. It is obvious that the high levels of variation in the Meta dataset is a poor fit to the negative binomial model used by both edgeR and DESeq. The edgeR package appeared to enforce a relatively high between-condition differential expression level regardless of the mean expression value. This leads to many poorly expressed transcripts being identified as differentially expressed. In contrast, the DESeq package identified as differentially expressed a small number of highly expressed genes. As before, transcripts with differential abundances are coloured red (and orange) as per the rules outlined in <xref ref-type="fig" rid="pone-0067019-g005">Figure 5</xref>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.g008" position="float" xlink:type="simple"/></fig>
<p>It is likely that both edgeR and DESeq performed poorly because the underlying assumptions of their statistical models was a poor fit for the data. In particular, the points in <xref ref-type="fig" rid="pone-0067019-g008">Figure 8</xref> appear to have some underlying structure. This was explored by overlaying the organism-of-origin of each seed sequence for each clustered gene on top of these graphs, and highlighting the differentially-expressed transcripts identified by ALDEx. Three different patterns were observed and are shown in <xref ref-type="fig" rid="pone-0067019-g009">Figure 9</xref>. <italic>L. iners</italic> exemplifies the first pattern, where the organism is found in either 3 or 4 samples. Here, the transcript abundances and within- and between-condition differences are distributed widely throughout the plots. The second pattern is similar to that for <italic>Gardnerella vaginalis</italic> and is typical for organisms that are abundant in both samples of one condition and absent from both samples of the other condition. Here the transcripts are abundant in one condition only, exhibit a wide range of expression values and tend to the lower end of the within-group difference. The final pattern is similar to that for <italic>Megasphera</italic>, which was abundant in only one sample of one condition, and rare or absent in the others. Here the average expression values tend to the lower average expression range and the within-condition difference is at the upper range of values. Note the difference between the number of differential transcripts for <italic>Gardnerella</italic> vs. for <italic>Megasphaera</italic> which reflects the typically lower within-condition transcript variation. Taken together, these plots show that the expression levels of a transcript in a Meta-RNA-Seq experiment, and the variation of those levels within- and between-conditions are driven by two factors. The first, is the abundance of an organism across samples, and the second is the transcript abundance within an organism. Transcripts derived from organisms that are found in all samples form a subset that have distributions similar to those for single-organism RNA-Seq, and therefore <italic>in isolation</italic> might be amenable to analysis with existing tools. However, transcripts derived from organisms that are found in only one condition, or only one sample, clearly deviate from this ideal and identifying differential transcripts using ALDEx provides an approach that can find those genes that are consistently different between conditions benefits from this approach.</p>
<fig id="pone-0067019-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067019.g009</object-id><label>Figure 9</label><caption>
<title>The effect of organism abundance on transcript abundance in the Meta dataset.</title>
<p>In each panel, the dark colour indicates a gene that maps to that organism (or organism group) and the bright colour indicates a gene that is differentially expressed according to the rules enforced by ALDEx. The Meta dataset contains different mixtures of organisms in each sample as shown in <xref ref-type="table" rid="pone-0067019-t002">Table 2</xref>. This leads to widely different distributions of transcript abundance in this dataset, which can be classified into three general patterns. Transcripts from organisms that are abundant (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e254" xlink:type="simple"/></inline-formula>) in three or four samples can exhibit both up and down regulation in the two conditions. For example, transcripts that were derived from <italic>L. iners</italic> are seen to be both up- and down-regulated in this dataset. Transcripts from organisms that are abundant in both samples of one condition (e.g. <italic>G. vaginalis</italic>), exhibit a change in one direction only, and show the full range of within-condition variation. In this case, many genes from the organism are expressed concordantly, and can be identified as differential. Transcripts from organisms that are abundant in only one sample of one condition, e.g. <italic>Megasphaera</italic> species, show a similar pattern as the previous one, but there is much more extreme variation within-conditions, and only those few genes that are expressed at extremely high levels can be reliably called as differentially expressed.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0067019.g009" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s3">
<title>Discussion</title>
<p>While the cost of high-throughput sequencing continues to fall, conducting an RNA-Seq experiment is still a relatively expensive undertaking. Extracting and analyzing the results adds an under-appreciated layer of complexity and cost<xref ref-type="bibr" rid="pone.0067019-Sboner1">[41]</xref>. The analysis of single-organism RNA-Seq has largely been informative with fixed-effect models, although the recent versions of both DESeq and edgeR have incorporated statistical methods to better deal with intra-condition variation<xref ref-type="bibr" rid="pone.0067019-Anders1">[23]</xref>, <xref ref-type="bibr" rid="pone.0067019-Robinson2">[38]</xref>, <xref ref-type="bibr" rid="pone.0067019-Kvam1">[42]</xref>. However, as shown here and discussed elsewhere<xref ref-type="bibr" rid="pone.0067019-Hamady1">[43]</xref> there are acknowledged challenges that are magnified in the examination of Meta-RNA-Seq datasets.</p>
<p>One current approach to examining metatranscriptomics has been championed by the marine metagenomics community that uses pyrosequencing and a non-parametric bootstrap test<xref ref-type="bibr" rid="pone.0067019-RodriguezBrito1">[44]</xref> to evaluate differences in gene content and gene expression. However, Parks and Beiko<xref ref-type="bibr" rid="pone.0067019-Parks1">[13]</xref> recently demonstrated that the level of significance achieved by this method is sensitive to the number of bootstrap samples. Drawing more samples from the pooled dataset results in smaller <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e255" xlink:type="simple"/></inline-formula> values and in more features being identified as significant. Sensitivity to the number of bootstrap samples is indicative of there not being enough data for the bootstrap procedure itself to be valid<xref ref-type="bibr" rid="pone.0067019-Efron1">[45]</xref>. Aside from numerical convergence, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e256" xlink:type="simple"/></inline-formula>-values cannot be interpreted as effect-sizes. Thus while non-parametric bootstrapping has been widely adopted in the marine metagenomics community (where a defined protocol is followed <xref ref-type="bibr" rid="pone.0067019-Polymenakou1">[20]</xref>, <xref ref-type="bibr" rid="pone.0067019-Gilbert1">[46]</xref>-<xref ref-type="bibr" rid="pone.0067019-McCarren1">[48]</xref>) it is unlikely to be adopted for use by the wider community.</p>
<p>Others have used the Illumina platform to generate Meta-RNA-Seq data composed of millions of reads and have used more diverse statistical tools drawn from the metagenomic armamentarium that are largely concerned with identifying gene presence or absence as opposed to gene abundance over a large range. Statistical analyses in these studies have ranged from simple, such as listing those genes with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e257" xlink:type="simple"/></inline-formula>-fold changes<xref ref-type="bibr" rid="pone.0067019-Rosenthal1">[21]</xref>, to sophisticated, such as the adaptation of the Metastats differential 16S rRNA abundance tool for RNA-Seq<xref ref-type="bibr" rid="pone.0067019-White1">[49]</xref> or the application of the well-known meta-genomic program, ShotgunFunctionalizeR<xref ref-type="bibr" rid="pone.0067019-Faith1">[50]</xref>, <xref ref-type="bibr" rid="pone.0067019-Turnbaugh1">[51]</xref>. Note that the ShotgunFunctionalizeR program<xref ref-type="bibr" rid="pone.0067019-Kristiansson1">[52]</xref> uses a Poisson-based model to characterize the differences in gene count between meta-genomic samples, and so is expected to have similar properties as DESeq or edgeR with highly dispersed data.</p>
<p>To our knowledge, ALDEx is the only method capable of producing an estimate of the ratio of between-condition difference to variability seen within the different conditions for RNA-Seq data since it assumes a random-effects model. We examined the behaviour of two widely-used tools based on fixed-effect models: edgeR and DESeq, both based on negative binomial models. It is important to note that, in essence, both tools effectively estimate <italic>two</italic> parameters from <italic>one</italic> value by assuming that the data follows idealized behaviour. This approach works acceptably in datasets with high intra-condition reproducibility, but is prone to error if the dataset deviates from that ideal, as is likely true for the majority of Meta-RNA-Seq data. For example, the <italic>B. cereus</italic> dataset, while having an extremely high read density, does not display a high concordance with either of these fixed-effect-model methods. As outlined below, this is caused, in part, by the failure of existing tools to centre the data in such a way that proportionality is preserved.</p>
<p>ALDEx uses a Dirichlet-multinomial model to infer transcript-abundance from read counts, followed by mixture-modelling to explicitly account for within- and between-condition variation among experimental samples. These data are examined in an ANOVA-like framework with conservative cutoff values that identify differentially-expressed genes where the within-condition expression variance is much smaller than the between-condition variance. A further innovation is that the data is transformed by removing the scaling-dependent subspace inherent when proportional data is log-transformed, ultimately removing a potential large source of multivariate statistical bias (see Supplementary Figure S1 in <xref ref-type="supplementary-material" rid="pone.0067019.s001">File S1</xref>). This simple manipulation sets the gene expression coordinates of the experiment to the origin and removes the bias inherent in the log-transform; the across-gene mean log-expression value for a given sample is zero, and the mean expression change between-conditions is also zero (as is typical of ANOVA designs). One important feature of this transform is that it removes the necessity for an empirical LOWESS correction. Furthermore, the transform also converts all the relative-expression values to points in a Euclidean space that can then be added, scaled, or grouped in a manner that, while perhaps counterintuitive, are entirely consistent with the intuitive properties of objects for which the ''total amount'' is irrelevant <xref ref-type="bibr" rid="pone.0067019-Egozcue1">[17]</xref>.</p>
<p>We use both relative fold difference (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e258" xlink:type="simple"/></inline-formula>), a measure of the effect size, and the distribution of absolute fold differences (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e259" xlink:type="simple"/></inline-formula>) to identify differentially expressed genes. The procedure ensures that no gene is called as differentially expressed if the within-condition variation is less than some multiple of the between-condition variation. This makes intuitive statistical sense because we have weak evidence for differential expression if the within-condition variation is large. We have attempted to design and describe ALDEx in a manner that formally captures an intuitive procedure that helps answer the question ''is this gene differentially expressed between conditions'' when (a) sample sizes are prohibitively small, (b) read counts are relatively low thus implying that point-estimates of expression intensities will be imprecise, and (c) we do <italic>not</italic> wish to make assumptions about variance-sharing, preferring instead techniques more in line with robust estimation methods. ALDEx therefore attempts to robustly address the question ''is the observed between-group difference somehow `substantially bigger' than the within-group difference?'', a statement suggestive of classical ANOVA. However, rather than assuming normality, then assuming that a 5% FDR implies cutoffs of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e260" xlink:type="simple"/></inline-formula>, we simply say ''if the between-group difference is greater than four times the within-group difference'', corresponding to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e261" xlink:type="simple"/></inline-formula> cutoffs of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e262" xlink:type="simple"/></inline-formula>, then that gene is of interest.</p>
<p>At least one other RNA-Seq analysis method, baySeq<xref ref-type="bibr" rid="pone.0067019-Hardcastle1">[53]</xref>, has used a Bayesian framework to estimate the likelihood of differential gene expression. There are several differences between the Bayesian methods implemented in ALDEx and those implemented in baySeq. Firstly, baySeq estimates the posterior likelihood of differential gene expression in the context of a negative binomial model. Secondly, baySeq assumes that genes with 0 reads are not expressed, while ALDEx uses the more general assumption that genes with 0 reads are either not expressed or are expressed below the threshold of detection. Thirdly, ALDEx normalizes the estimated proportion vector using the isometric log transformation<xref ref-type="bibr" rid="pone.0067019-Egozcue2">[18]</xref> while baySeq and all other existing methods do not. It is worth noting that a recent comparison of baySeq, DESeq and edgeR using a deeply-sequenced and validated dataset showed that DESeq and edgeR were more discordant with each other than either was with baySeq<xref ref-type="bibr" rid="pone.0067019-Nookaew1">[54]</xref>, suggesting that baySeq exhibits a lower false positive rate than either of the other methods. Finally, baySeq can deal with more complex study designs than can ALDEx.</p>
<p>In Meta-RNA-Seq datasets, i.e, multiple-organism, multiple-condition datasets, existing methods based on idealized behaviour are prone to both over- and under-calling differentially-expressed genes especially if within-condition variance is not explicitly accounted for. However, ALDEx maintains the logical consistency of only identifying genes with low within-condition dispersion and high between-condition differences. This approach has been used successfully to examine differences in gene expression of a vaginal community in two states<xref ref-type="bibr" rid="pone.0067019-Macklaim1">[31]</xref>. The approach should be applicable to other situations where high-throughput sequencing is used such as metagenomic analysis of differential gene abundance and ChIP-Seq.</p>
</sec><sec id="s4" sec-type="materials|methods">
<title>Materials and Methods</title>
<p><italic>Bacillus cereus</italic> 14579 and an isogenic derivative that carries a deletion of a chromosomal encoded minor sigma factor gene and has lost the pBClin15 plasmid were each grown at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e263" xlink:type="simple"/></inline-formula> with aeration in LB medium buffered with 10 mM MES and 10 mM MOPS. When the culture reached an optical density (OD600) of 0.5 a sample was taken (pH∶7.2) before addition of 1 N HCl to shift the culture to pH∶5.46. After incubation for 20 minutes the low pH sample was taken. Both samples were processed identically by immediately adding the aliquot to an equal volume of acid-phenol:chloroform (5∶1) pH∶4.5 (Ambion) at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e264" xlink:type="simple"/></inline-formula>. After 5 minutes with periodic mixing the aqueous and organic layers were resolved by centrifugation. The aqueous layer was further extracted at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e265" xlink:type="simple"/></inline-formula> with 1 volume of phenol:chloroform:isoamyl alcohol (25∶24∶1) pH∶6.6 (Ambion). RNA was recovered from the aqueous phase by precipitation with isopropanol and then dissolved in TE buffer (10 mM Tris-HCl, pH∶7.5, 1 mM EDTA) buffer. Residual DNA was removed by treatment with TURBO-DNase (Ambion) followed by purification of the RNA on a RNeasy mini-column (Qiagen). Ribosomal RNA was subsequently depleted with the MICROBExpress procedure (Ambion).</p>
<sec id="s4a">
<title>Ethics Statement</title>
<p>The Health Sciences Research Ethics Board at the University of Western Ontario granted ethical approval for the study under approval number REB16183E. Participants gave their signed informed consent before the start of the study. Premenopausal women between the ages of 18-40 years were recruited at the Victoria Family Medical Center in London, Canada. Participants were excluded from the study if they reached menopause, were menstruating, had a urogenital infection other than BV in the past 6 months, were pregnant, had a history of gonorrhoea, chlamydia, estrogen-dependent neoplasia, abnormal renal function or pyelonephritis, were taking prednisone, immunosuppresives or antimicrobial medication, had undiagnosed abnormal vaginal bleeding, had engaged in oral or vaginal intercourse or consumed probiotic ements or foods in the 48 hours prior to the clinical visit.</p>
</sec><sec id="s4b">
<title>Clinical Samples and RNA preparation</title>
<p>Vaginal swabs were collected from four women: two with BV and two considered to have a non-BV vaginal biota as diagnosed by Nugent scoring<xref ref-type="bibr" rid="pone.0067019-Nugent1">[55]</xref>, and vaginal pH. Nurses obtained vaginal samples for RNA-seq using a Dacron polyester-tipped swab rolled against the mid-vaginal wall and immediately suspended in RNAprotect (Qiagen) containing 100 µg/ml rifampicin. Vaginal pH was measured using the pHem-alert applicator (Gynex). Samples for RNA extraction were incubated at room temperature for at least 10 minutes (to a maximum of 3 hours), and then centrifuged before discarding the supernatant and freezing the remaining pellet at 80<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e266" xlink:type="simple"/></inline-formula>C. Lysis and RNA extraction were performed within 3 weeks of storage. RNA was isolated as for the <italic>B. cereus</italic> samples.</p>
<p>Reference sequence clustering and mapping. A total of 110 accessions representing 103 organisms (of 31 genera, and 63 species) isolated from or detected in the vagina were included in a reference sequence set for mapping. These 234,991 sequences (including 230,031 coding sequences) were clustered by sequence identity (95% nucleotide identity over 90% sequence length) using CD-HIT<xref ref-type="bibr" rid="pone.0067019-Li1">[56]</xref> to remove redundancy in the reference mapping set. A representative sequence (''refseq'') from each of the resulting 163,014 clusters was used to build a Bowtie<xref ref-type="bibr" rid="pone.0067019-Langmead1">[32]</xref> colorspace reference library for mapping the RNA-seq reads. Reads mapped uniquely by Bowtie to a coding refseq were included in the differential expression analysis (all other unmapped reads were discarded). Reads were trimmed from the 3<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0067019.e267" xlink:type="simple"/></inline-formula> end to 40 nt, and up to 2 mismatches were allowed.</p>
<p>ALDEX version 1.0.3 was used. It can be accessed at: <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/aldex/" xlink:type="simple">http://code.google.com/p/aldex/</ext-link>. DESeq version 1.6.1 was used for these analyses using the per-gene dispersion estimates. The edgeR version 2.4.6 package was used. A false discovery rate of 0.1 was used to identify putative differentially-expressed transcripts as recommended by the documentation. Cuffdiff version 1.3.0 was used with a mean fragment length of 200 bp and the default false discovery rate of 0.05.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pone.0067019.s001" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pone.0067019.s001" position="float" xlink:type="simple"><label>File S1</label><caption>
<p>Supporting information.</p>
<p>(ZIP)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pone.0067019-Roy1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roy</surname><given-names>NC</given-names></name>, <name name-style="western"><surname>Altermann</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Park</surname><given-names>ZA</given-names></name>, <name name-style="western"><surname>McNabb</surname><given-names>WC</given-names></name> (<year>2011</year>) <article-title>A comparison of analog and next-generation transcriptomic tools for mammalian studies</article-title>. <source>Brief Funct Genomics</source> <volume>10</volume>: <fpage>135</fpage>–<lpage>50</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Crawford1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Crawford</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Guelbeogo</surname><given-names>WM</given-names></name>, <name name-style="western"><surname>Sanou</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Traoré</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Vernick</surname><given-names>KD</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>De novo transcriptome sequencing in Anopheles funestus using Illumina RNA-Seq technology</article-title>. <source>PLoS One</source> <volume>5</volume>: <fpage>e14202</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Grabherr1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grabherr</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Haas</surname><given-names>BJ</given-names></name>, <name name-style="western"><surname>Yassour</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Levin</surname><given-names>JZ</given-names></name>, <name name-style="western"><surname>Thompson</surname><given-names>DA</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Full-length transcriptome assembly from RNA-Seq data without a reference genome</article-title>. <source>Nat Biotechnol</source> <volume>29</volume>: <fpage>644</fpage>–<lpage>52</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Trapnell1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trapnell</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2009</year>) <article-title>Tophat: discovering splice junctions with RNA-Seq</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1105</fpage>–<lpage>11</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Wang1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Singh</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Zeng</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Coleman</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Mapsplice: accurate mapping of RNA-Seq reads for splice junction discovery</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>: <fpage>e178</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Kim1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2011</year>) <article-title>Tophat-fusion: an algorithm for discovery of novel fusion transcripts</article-title>. <source>Genome Biol</source> <volume>12</volume>: <fpage>R72</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Smith1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Heisler</surname><given-names>LE</given-names></name>, <name name-style="western"><surname>St Onge</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Farias-Hesson</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Wallace</surname><given-names>IM</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Highly-multiplexed barcode sequencing: an efficient method for parallel analysis of pooled samples</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>: <fpage>e142</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-vanBakel1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van Bakel</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Nislow</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Blencowe</surname><given-names>BJ</given-names></name>, <name name-style="western"><surname>Hughes</surname><given-names>TR</given-names></name> (<year>2010</year>) <article-title>Most "dark matter" transcripts are associated with known genes</article-title>. <source>PLoS Biol</source> <volume>8</volume>: <fpage>e1000371</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-McIntyre1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McIntyre</surname><given-names>LM</given-names></name>, <name name-style="western"><surname>Lopiano</surname><given-names>KK</given-names></name>, <name name-style="western"><surname>Morse</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Amin</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Oberg</surname><given-names>AL</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Rna-Seq: technical variability and sampling</article-title>. <source>BMC Genomics</source> <volume>12</volume>: <fpage>293</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Wu1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>Z</given-names></name> (<year>2009</year>) <article-title>A review of statistical methods for preprocessing oligonucleotide microarrays</article-title>. <source>Stat Methods Med Res</source> <volume>18</volume>: <fpage>533</fpage>–<lpage>41</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Pachter1"><label>11</label>
<mixed-citation publication-type="other" xlink:type="simple">Pachter L (2011) Models for transcript quantification from RNA-Seq. ArXiv 1104.3889.</mixed-citation>
</ref>
<ref id="pone.0067019-Nakagawa1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nakagawa</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Cuthill</surname><given-names>IC</given-names></name> (<year>2007</year>) <article-title>Effect size, confidence interval and statistical significance: a practical guide for biologists</article-title>. <source>Biol Rev Camb Philos Soc</source> <volume>82</volume>: <fpage>591</fpage>–<lpage>605</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Parks1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parks</surname><given-names>DH</given-names></name>, <name name-style="western"><surname>Beiko</surname><given-names>RG</given-names></name> (<year>2010</year>) <article-title>Identifying biologically relevant differences between metagenomic communities</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>715</fpage>–<lpage>21</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Pearson1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pearson</surname><given-names>K</given-names></name> (<year>1896</year>) <article-title>Mathematical contributions to the theory of evolution. { on a form of spurious correlation which may arise when indices are used in the measurement of organs</article-title>. <source>Proceedings ofthe Royal Society of London</source> <volume>60</volume>: <fpage>489</fpage>–<lpage>498</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Aitchison1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aitchison</surname><given-names>J</given-names></name>, <name name-style="western"><surname>J Egozcue</surname><given-names>J</given-names></name> (<year>2005</year>) <article-title>Compositional data analysis: Where are we and where should we be heading?</article-title> <source>Mathematical Geology</source> <volume>37</volume>: <fpage>829</fpage>–<lpage>850</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-PawlowskyGlahn1"><label>16</label>
<mixed-citation publication-type="book" xlink:type="simple">Pawlowsky-Glahn V, Egozcue JJ (2006) Compositional data and their analysis: an introduction. Geological Society, London, Special Publications <volume>264</volume>: : 1–10.</mixed-citation>
</ref>
<ref id="pone.0067019-Egozcue1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Egozcue</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name> (<year>2005</year>) <article-title>Groups of parts and their balances in compositional data analysis</article-title>. <source>Mathematical Geology</source> <volume>37</volume>: <fpage>795</fpage>–<lpage>828</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Egozcue2"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Egozcue</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Mateu-Figueras</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Barcel O-Vidal</surname><given-names>C</given-names></name> (<year>2003</year>) <article-title>Isometric logratio transformations for compositional data analysis. mathematical geology</article-title>. <source>Math Geol</source> <volume>35</volume>: <fpage>279</fpage>–<lpage>300</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Marioni1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marioni</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Mason</surname><given-names>CE</given-names></name>, <name name-style="western"><surname>Mane</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gilad</surname><given-names>Y</given-names></name> (<year>2008</year>) <article-title>Rna-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>. <source>Genome Res</source> <volume>18</volume>: <fpage>1509</fpage>–<lpage>17</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Polymenakou1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Polymenakou</surname><given-names>PN</given-names></name>, <name name-style="western"><surname>Lampadariou</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Mandalakis</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Tselepides</surname><given-names>A</given-names></name> (<year>2009</year>) <month>Feb</month> <article-title> Phylogenetic diversity of sediment bacteria from the southern cretan margin, eastern mediterranean sea</article-title>. <source>Syst Appl Microbiol</source> <volume>32</volume>: <fpage>17</fpage>–<lpage>26</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Rosenthal1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rosenthal</surname><given-names>AZ</given-names></name>, <name name-style="western"><surname>Matson</surname><given-names>EG</given-names></name>, <name name-style="western"><surname>Eldar</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Leadbetter</surname><given-names>JR</given-names></name> (<year>2011</year>) <article-title>Rna-Seq reveals cooperative metabolic interactions between two termite-gut spirochete species in co-culture</article-title>. <source>ISME J</source> <volume>5</volume>: <fpage>1133</fpage>–<lpage>42</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Robinson1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Smyth</surname><given-names>GK</given-names></name> (<year>2008</year>) <article-title>Small-sample estimation of negative binomial dispersion, with applications to sage data</article-title>. <source>Biostatistics</source> <volume>9</volume>: <fpage>321</fpage>–<lpage>332</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Anders1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anders</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>W</given-names></name> (<year>2010</year>) <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source> <volume>11</volume>: <fpage>R106</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Newey1"><label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Newey WK, McFadden D (1994) Large sample estimation and hypothesis testing. In:Engle R, McFadden D, editors, Handbook of Econometrics, Elsevier Science, volume 4, chapter 35. pp. 2111–2245.</mixed-citation>
</ref>
<ref id="pone.0067019-Jaynes1"><label>25</label>
<mixed-citation publication-type="book" xlink:type="simple">Jaynes ET, Bretthorst GL (2003) Probability theory: the logic of science.  Cambridge, UK:Cambridge University Press. URL <ext-link ext-link-type="uri" xlink:href="http://www.loc.gov/catdir/samples/cam033/2002071486.html" xlink:type="simple">http://www.loc.gov/catdir/samples/cam033/2002071486.html</ext-link>.</mixed-citation>
</ref>
<ref id="pone.0067019-BelaAFrigyik1"><label>26</label>
<mixed-citation publication-type="book" xlink:type="simple">Bela A Frigyik AK, Gupta MR (2010) Introduction to the Dirichlet distribution and related processes.  Technical Report UWEETR-2010-0006, Department of Electrical Engineering, University of Washington. URL <ext-link ext-link-type="uri" xlink:href="http://www.ee.washington.edu/research/guptalab/publications/UWEETR-2010-0006.pdf" xlink:type="simple">http://www.ee.washington.edu/research/guptalab/publications/UWEETR-2010-0006.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pone.0067019-Berger1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berger</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bernardo</surname><given-names>J</given-names></name> (<year>1992</year>) <article-title>Ordered group reference priors with application to the multinomial problem</article-title>. <source>Biometrika</source> <volume>79</volume>: <fpage>25</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Bernardo1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bernardo</surname><given-names>J</given-names></name> (<year>2005</year>) <article-title>Reference analysis</article-title>. <source>Bayesian Thinking, Modeling and Computation</source> <volume>25</volume>: <fpage>17</fpage>–<lpage>90</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Berger2"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berger</surname><given-names>JO</given-names></name>, <name name-style="western"><surname>Bernardo</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>The formal definition of reference priors</article-title>. <source>Annals of Statistics</source> <volume>37</volume>: <fpage>905</fpage>–<lpage>938</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Wang2"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Feng</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>X</given-names></name> (<year>2010</year>) <article-title>DEGSeq: an R package for identifying differentially expressed genes from RNA-Seq data</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>136</fpage>–<lpage>8</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Macklaim1"><label>31</label>
<mixed-citation publication-type="other" xlink:type="simple">Macklaim MJ, Fernandes DA, Di Bella MJ, Hammond JA, Reid G, <etal>et al</etal>.. (2013) Comparative meta-RNA-Seq of the vaginal microbiota and differential expression by lactobacillus iners in health and dysbiosis. Microbiome doi: 10.1186/2049-2618-1-12.</mixed-citation>
</ref>
<ref id="pone.0067019-Langmead1"><label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Langmead B (2010) Aligning short sequencing reads with bowtie. Curr Protoc Bioinformatics Chapter 11: Unit 11.7.</mixed-citation>
</ref>
<ref id="pone.0067019-Friedman1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Alm</surname><given-names>EJ</given-names></name> (<year>2012</year>) <article-title>Inferring correlation networks from genomic survey data</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>e1002687</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-LaRosa1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>La Rosa</surname><given-names>PS</given-names></name>, <name name-style="western"><surname>Brooks</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Deych</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Boone</surname><given-names>EL</given-names></name>, <name name-style="western"><surname>Edwards</surname><given-names>DJ</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Hypothesis testing and power calculations for taxonomic-based human microbiome data</article-title>. <source>PLoS One</source> <volume>7</volume>: <fpage>e52078</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Holmes1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Harris</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Quince</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>Dirichlet multinomial mixtures: generative models for microbial metagenomics</article-title>. <source>PLoS One</source> <volume>7</volume>: <fpage>e30126</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Blekhman1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blekhman</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Marioni</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Zumbo</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gilad</surname><given-names>Y</given-names></name> (<year>2010</year>) <article-title>Sex-specific and lineage-specific alternative splicing in primates</article-title>. <source>Genome Research</source> <volume>20</volume>: <fpage>180</fpage>–<lpage>189</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Altman1"><label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Altman DG, Bland JM (1983) Measurement in medicine: The analysis of method comparison studies. Journal of the Royal Statistical Society Series D (The Statistician)<volume>32</volume> :pp. 307–317.</mixed-citation>
</ref>
<ref id="pone.0067019-Robinson2"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>McCarthy</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Smyth</surname><given-names>GK</given-names></name> (<year>2010</year>) <article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>139</fpage>–<lpage>40</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Trapnell2"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trapnell</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>BA</given-names></name>, <name name-style="western"><surname>Pertea</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Mortazavi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kwan</surname><given-names>G</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat Biotechnol</source> <volume>28</volume>: <fpage>511</fpage>–<lpage>5</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Mols1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mols</surname><given-names>M</given-names></name>, <name name-style="western"><surname>van Kranenburg</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Tempelaars</surname><given-names>MH</given-names></name>, <name name-style="western"><surname>van Schaik</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Moezelaar</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Comparative analysis of transcriptional and physiological responses of bacillus cereus to organic and inorganic acid shocks</article-title>. <source>Int J Food Microbiol</source> <volume>137</volume>: <fpage>13</fpage>–<lpage>21</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Sboner1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sboner</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Mu</surname><given-names>XJ</given-names></name>, <name name-style="western"><surname>Greenbaum</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Auerbach</surname><given-names>RK</given-names></name>, <name name-style="western"><surname>Gerstein</surname><given-names>MB</given-names></name> (<year>2011</year>) <article-title>The real cost of sequencing: higher than you think! </article-title>. <source>Genome Biol</source> <volume>12</volume>: <fpage>125</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Kvam1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kvam</surname><given-names>VM</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Si</surname><given-names>Y</given-names></name> (<year>2012</year>) <article-title>A comparison of statistical methods for detecting differentially expressed genes from RNA-Seq data</article-title>. <source>Am J Bot</source> <volume>99</volume>: <fpage>248</fpage>–<lpage>56</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Hamady1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Microbial community profiling for human microbiome projects: Tools, techniques, and challenges</article-title>. <source>Genome Res</source> <volume>19</volume>: <fpage>1141</fpage>–<lpage>52</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-RodriguezBrito1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rodriguez-Brito</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Rohwer</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Edwards</surname><given-names>RA</given-names></name> (<year>2006</year>) <article-title>An application of statistics to comparative metagenomics</article-title>. <source>BMC Bioinformatics</source> <volume>7</volume>: <fpage>162</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Efron1"><label>45</label>
<mixed-citation publication-type="book" xlink:type="simple">Efron B, Tibshirani R (1993) An introduction to the bootstrap, volume 57. New York:Chapman &amp; Hall. URL <ext-link ext-link-type="uri" xlink:href="http://www.loc.gov/catdir/enhancements/fy0730/93004489-d.html" xlink:type="simple">http://www.loc.gov/catdir/enhancements/fy0730/93004489-d.html</ext-link>.</mixed-citation>
</ref>
<ref id="pone.0067019-Gilbert1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gilbert</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Field</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Edwards</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>W</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Detection of large numbers of novel sequences in the metatranscriptomes of complex marine microbial communities</article-title>. <source>PLoS One</source> <volume>3</volume>: <fpage>e3042</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Gilbert2"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gilbert</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Meyer</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Schriml</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Joint</surname><given-names>IR</given-names></name>, <name name-style="western"><surname>Muhling</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Metagenomes and metatranscriptomes from the l4 long-term coastal monitoring station in the western English Channel</article-title>. <source>Stand Genomic Sci</source> <volume>3</volume>: <fpage>183</fpage>–<lpage>93</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-McCarren1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McCarren</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Becker</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Repeta</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Shi</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Young</surname><given-names>CR</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Microbial community transcriptomes reveal microbes and metabolic pathways associated with dissolved organic matter turnover in the sea</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>107</volume>: <fpage>16420</fpage>–<lpage>7</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-White1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Nagarajan</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Pop</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Statistical methods for detecting differentially abundant features in clinical metagenomic samples</article-title>. <source>PLoS Comput Biol</source> <volume>5</volume>: <fpage>e1000352</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Faith1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Faith</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>McNulty</surname><given-names>NP</given-names></name>, <name name-style="western"><surname>Rey</surname><given-names>FE</given-names></name>, <name name-style="western"><surname>Gordon</surname><given-names>JI</given-names></name> (<year>2011</year>) <article-title>Predicting a human gut microbiota's response to diet in gnotobiotic mice</article-title>. <source>Science</source> <volume>333</volume>: <fpage>101</fpage>–<lpage>4</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Turnbaugh1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Turnbaugh</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Quince</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Faith</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>McHardy</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Yatsunenko</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Organismal, genetic, and transcriptional variation in the deeply sequenced gut microbiomes of identical twins</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>107</volume>: <fpage>7503</fpage>–<lpage>8</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Kristiansson1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kristiansson</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Dalevi</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>ShotgunFunctionalizeR: an R-package for functional comparison of metagenomes</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>2737</fpage>–<lpage>8</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Hardcastle1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hardcastle</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Kelly</surname><given-names>KA</given-names></name> (<year>2013</year>) <article-title>Empirical bayesian analysis of paired high-throughput sequencing data with a beta-binomial distribution</article-title>. <source>BMC Bioinformatics</source> <volume>14</volume>: <fpage>135</fpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Nookaew1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nookaew</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Papini</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Pornputtapong</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Scalcinati</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Fagerberg</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>A comprehensive comparison of RNA-Seq-based transcriptome analysis from reads to differential gene expression and cross-comparison with microarrays: a case study in Saccharomyces cerevisiae</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>: <fpage>10084</fpage>–<lpage>97</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Nugent1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nugent</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Krohn</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Hillier</surname><given-names>SL</given-names></name> (<year>1991</year>) <article-title>Reliability of diagnosing bacterial vaginosis is improved by a standardized method of gram stain interpretation</article-title>. <source>J Clin Microbiol</source> <volume>29</volume>: <fpage>297</fpage>–<lpage>301</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Li1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Godzik</surname><given-names>A</given-names></name> (<year>2006</year>) <article-title>CD-Hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source> <volume>22</volume>: <fpage>1658</fpage>–<lpage>9</lpage>.</mixed-citation>
</ref>
<ref id="pone.0067019-Oliveros1"><label>57</label>
<mixed-citation publication-type="other" xlink:type="simple">Oliveros JC (2007). Venny. an interactive tool for comparing lists with Venn diagrams. URL<ext-link ext-link-type="uri" xlink:href="http://bioinfogp.cnb.csic.es/tools/venny/index.html" xlink:type="simple">http://bioinfogp.cnb.csic.es/tools/venny/index.html</ext-link>.</mixed-citation>
</ref>
</ref-list></back>
</article>