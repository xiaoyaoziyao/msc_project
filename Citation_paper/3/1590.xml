<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0175944</article-id>
<article-id pub-id-type="publisher-id">PONE-D-16-46771</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Heredity</subject><subj-group><subject>Genetic mapping</subject><subj-group><subject>Haplotypes</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>People and places</subject><subj-group><subject>Demography</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genetic loci</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Mutation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Heredity</subject><subj-group><subject>Gene flow</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Gene flow</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Gene flow</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Gene flow</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>HacDivSel: Two new methods (haplotype-based and outlier-based) for the detection of divergent selection in pairs of populations</article-title>
<alt-title alt-title-type="running-head">HacDivSel: Detection of divergent selection</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6242-3581</contrib-id>
<name name-style="western">
<surname>Carvajal-Rodríguez</surname>
<given-names>Antonio</given-names>
</name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Departamento de Bioquímica, Genética e Inmunología, Universidad de Vigo, Vigo, Spain</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Li</surname>
<given-names>Yun</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of North Carolina at Chapel Hill, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"><list-item>
<p><bold>Conceptualization:</bold> AC-R.</p></list-item> <list-item>
<p><bold>Data curation:</bold> AC-R.</p></list-item> <list-item>
<p><bold>Formal analysis:</bold> AC-R.</p></list-item> <list-item>
<p><bold>Investigation:</bold> AC-R.</p></list-item> <list-item>
<p><bold>Methodology:</bold> AC-R.</p></list-item> <list-item>
<p><bold>Software:</bold> AC-R.</p></list-item> <list-item>
<p><bold>Supervision:</bold> AC-R.</p></list-item> <list-item>
<p><bold>Validation:</bold> AC-R.</p></list-item> <list-item>
<p><bold>Visualization:</bold> AC-R.</p></list-item> <list-item>
<p><bold>Writing – original draft:</bold> AC-R.</p></list-item> <list-item>
<p><bold>Writing – review &amp; editing:</bold> AC-R.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">acraaj@uvigo.es</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>19</day>
<month>4</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<year>2017</year>
</pub-date>
<volume>12</volume>
<issue>4</issue>
<elocation-id>e0175944</elocation-id>
<history>
<date date-type="received">
<day>25</day>
<month>11</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>3</day>
<month>4</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Antonio Carvajal-Rodríguez</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0175944"/>
<abstract>
<p>The detection of genomic regions involved in local adaptation is an important topic in current population genetics. There are several detection strategies available depending on the kind of genetic and demographic information at hand. A common drawback is the high risk of false positives. In this study we introduce two complementary methods for the detection of divergent selection from populations connected by migration. Both methods have been developed with the aim of being robust to false positives. The first method combines haplotype information with inter-population differentiation (<italic>F</italic><sub>ST</sub>). Evidence of divergent selection is concluded only when both the haplotype pattern and the <italic>F</italic><sub>ST</sub> value support it. The second method is developed for independently segregating markers i.e. there is no haplotype information. In this case, the power to detect selection is attained by developing a new outlier test based on detecting a bimodal distribution. The test computes the <italic>F</italic><sub>ST</sub> outliers and then assumes that those of interest would have a different mode. We demonstrate the utility of the two methods through simulations and the analysis of real data. The simulation results showed power ranging from 60–95% in several of the scenarios whilst the false positive rate was controlled below the nominal level. The analysis of real samples consisted of phased data from the HapMap project and unphased data from intertidal marine snail ecotypes. The results illustrate that the proposed methods could be useful for detecting locally adapted polymorphisms. The software HacDivSel implements the methods explained in this manuscript.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Xunta de Galicia (Grupo de Referencia Competitiva) Fondos FEDER (“Unha maneira de facer Europa”))</institution>
</funding-source>
<award-id>ED431C2016-037</award-id>
<principal-award-recipient>Antonio Carvajal-Rodriguez</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Ministerio de Economía y Competitividad</institution>
</funding-source>
<award-id>CGL2016-75482-P</award-id>
<principal-award-recipient>Antonio Carvajal-Rodriguez</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003329</institution-id>
<institution>Ministerio de Economía y Competitividad</institution>
</institution-wrap>
</funding-source>
<award-id>BFU2013-44635-P</award-id>
<principal-award-recipient>Antonio Carvajal-Rodriguez</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003329</institution-id>
<institution>Ministerio de Economía y competitividad</institution>
</institution-wrap>
</funding-source>
<award-id>CGL2012-39861-C02-01</award-id>
<principal-award-recipient>Antonio Carvajal-Rodriguez</principal-award-recipient>
</award-group>
<funding-statement>Support was provided by: 1) Xunta de Galicia (Grupo de Referencia Competitiva, ED431C2016-037. Fondos FEDER (“Unha maneira de facer Europa”)); 2) Ministerio de Economía y Competitividad (BFU2013-44635-P, CGL2012-39861-C02-01 and CGL2016-75482-P). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="2"/>
<table-count count="8"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Current population genetics has an important focus on the detection of the signature of natural selection at the molecular level. The detection of the selection effect in a given DNA region is important because it may connect that region with a key functionality, or past or ongoing selective events, to have a deeper understanding of the evolutionary processes. Indeed, it may also help to understand the evolutionary mechanisms allowing the species adaptation to local conditions. The study of local adaptation processes implies that some genetic variant is favored by the environmental conditions. The positively selected locus increases in frequency and the pattern of variation around that locus will change, a process known as selective sweep [<xref ref-type="bibr" rid="pone.0175944.ref001">1</xref>, <xref ref-type="bibr" rid="pone.0175944.ref002">2</xref>].</p>
<p>There are many tests designed for detecting different kinds of effects produced by selective sweeps. Such effects can involve skewed site frequency spectra, high linkage disequilibrium or high rates of genetic divergence [<xref ref-type="bibr" rid="pone.0175944.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0175944.ref004">4</xref>]. The information required by those tests is variable: they could need knowledge about candidate adaptive loci, their haplotypic phase, their recombination rates, or the ancestral/derived status at each segregating site. This kind of information is often available for model organisms and so, in previous years, most of the effort was focused in humans and other model species.</p>
<p>For non-model organisms, the most useful methods for studying local adaptation have been those based on measuring genetic differentiation between populations. The idea behind these methods is that the loci involved in local adaptation would be outliers, i.e. would have unusually large values of <italic>F</italic><sub>ST</sub>. From its original formulation (LK test [<xref ref-type="bibr" rid="pone.0175944.ref005">5</xref>]), this technique has been improved in several ways depending on the summary statistic’s -the <italic>F</italic><sub>ST</sub> or any other differentiation index—expected neutral distribution. That is, in order to account for more realistic situations, the different methods change the assumptions of the null demographic model (reviewed in [<xref ref-type="bibr" rid="pone.0175944.ref006">6</xref>]).</p>
<p>However, one of the main drawbacks of the outlier-based methods is the difficulty of defining an accurate null model since there are several historical events and demographic scenarios (other than local selection) that can produce similar <italic>F</italic><sub>ST</sub> patterns. Even in the presence of local adaptation, we can expect different <italic>F</italic><sub>ST</sub> patterns. This is because the involved populations may be more or less connected by migration, and this event will influence the structure of the genetic variation both at intra and inter-population levels. Consequently, the outlier based methods tested against the deviation over an expected demographic null model, always face the risk of having an excess of false positives [<xref ref-type="bibr" rid="pone.0175944.ref007">7</xref>–<xref ref-type="bibr" rid="pone.0175944.ref010">10</xref>].</p>
<p>Another problem concerning outlier-based methods is that they have low power when the overall <italic>F</italic><sub>ST</sub> is high as it can happen when the genetic basis of the adaptation is polygenic (since each particular gene may not have a strong difference with the overall <italic>F</italic><sub>ST</sub>, hindering the detection of outliers), or when the populations under study are subspecies [<xref ref-type="bibr" rid="pone.0175944.ref006">6</xref>, <xref ref-type="bibr" rid="pone.0175944.ref011">11</xref>]. Fortunately, over recent years, the amount of information available on the genomes of several species has increased [<xref ref-type="bibr" rid="pone.0175944.ref012">12</xref>] and consequently new and more sophisticated methods can now be applied to detect local adaptation in non-model organisms.</p>
<p>As mentioned above, the linkage disequilibrium (LD) is the basis for several computational methods used in the detection of selective sweeps (reviewed in [<xref ref-type="bibr" rid="pone.0175944.ref013">13</xref>]). Some LD-based methods try to identify maximized LD regions [<xref ref-type="bibr" rid="pone.0175944.ref014">14</xref>, <xref ref-type="bibr" rid="pone.0175944.ref015">15</xref>] while others explore the pattern of LD decay from different candidate SNPs [<xref ref-type="bibr" rid="pone.0175944.ref016">16</xref>, <xref ref-type="bibr" rid="pone.0175944.ref017">17</xref>]. However, only a few LD-based methods have considered structured populations as the evolutionary scenario of interest. Still, there are different scenarios that can be evaluated under structured populations [<xref ref-type="bibr" rid="pone.0175944.ref018">18</xref>]. Therefore, although LD-based tests can be powerful and robust for detecting selective sweeps (in isolated or simple structured population scenarios) with low migration rate, they fail to detect it, under several other realistic scenarios [<xref ref-type="bibr" rid="pone.0175944.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0175944.ref013">13</xref>, <xref ref-type="bibr" rid="pone.0175944.ref018">18</xref>, <xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>].</p>
<p>In addition, the possibility of observing local adaptation with gene flow depends on the demography, and on the genetic basis of the traits involved [<xref ref-type="bibr" rid="pone.0175944.ref020">20</xref>]. This decreases the performance of the methods under moderate-to-high migration scenarios which may result into high rate of false positives [<xref ref-type="bibr" rid="pone.0175944.ref018">18</xref>]. Thus, even if haplotype phase information is at hand, specific methods should be developed to detect local adaptation under structured population scenarios [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>].</p>
<p>The aim of this paper is to present two complementary methods (for linked and unlinked markers) specialized for detecting divergent selection in pairs of populations with gene flow. The main advantage of both methods proposed here over the existing ones is that they were especially designed to be robust to false positives. Both methods are suitable for working with non-model species, although the first (linked markers) requires an approximate knowledge of the phase of the SNPs under study. Notably, this method still performs quite well under 10–40% of phasing error depending on the marker density. If the SNPs under evaluation are not linked, then the second method should be applied. Our working definition of non-model species includes those for which we could have partial information about the haplotypic phase but a) no estimates of recombination rates, b) no information on potentially adaptive loci and c) knowledge the ancestral/derived status at each segregating site. This definition also implies that we barely know the demography of the populations under study, and if so, we cannot reliably use a simulated neutral distribution to assess significance.</p>
<p>The first method (<italic>nvdF</italic><sub><italic>ST</italic></sub>) combines haplotype-based information with a diversity-based <italic>F</italic><sub>ST</sub> measure. It is a sliding-window approach that uses automatic decision-making () to apply different window sizes. On the other hand, the second method (EOS) is not haplotype-based but performs a two-step <italic>F</italic><sub>ST</sub> outlier test. The first step of the algorithm consists of a heuristic search for different outlier clusters, while the second step is just a conditional LK test that takes place only if more than one cluster is found. In this latter case, the test is applied through the cluster with the higher <italic>F</italic><sub>ST</sub> values.</p>
<p>The design of the work is as follows: in the first part of the article the rationale of the methods is explained. After that, we give the results of the application of both methods to the simulated scenarios. This permits to appreciate their performance in terms of power and number of false positives. Finally, the <italic>nvdF</italic><sub>ST</sub> method is applied to genome-wide phased data from the HapMap project [<xref ref-type="bibr" rid="pone.0175944.ref021">21</xref>]. This allows to check its performance compared with other methods previously applied to the same data. Additionally, the EOS test is applied to a recently published data set of <italic>Littorina saxatilis</italic> species. More extensive details and a full mathematical description of the methods is given in the <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>.</p>
</sec>
<sec id="sec002">
<title>Models and methods</title>
<sec id="sec003">
<title>The nvdF<sub>ST</sub> model</title>
<p>In this section we improve a previous haplotype-based method to detect divergent selection [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>, <xref ref-type="bibr" rid="pone.0175944.ref022">22</xref>]. The new statistic is called <italic>nvdF</italic><sub>ST</sub> because it combines a normalized variance difference (<italic>nvd</italic>) with the <italic>F</italic><sub>ST</sub> index. The <italic>nvd</italic> part performs a sliding-window approach to identify sites with specific selective patterns. When combined with the <italic>F</italic><sub>ST</sub>, it allows the significance of the candidate sites to be assessed without the need of simulating neutral demography scenarios. Before developing the <italic>nvd</italic> formula, we review some concepts related to haplotype allelic classes.</p>
<sec id="sec004">
<title>Generalized HAC variance difference</title>
<p>A major-allele-reference haplotype (MARH) is a haplotype that carries only major frequency alleles [<xref ref-type="bibr" rid="pone.0175944.ref022">22</xref>]. Therefore, we can define the mutational distance between any haplotype and MARH as the number of sites (SNPs) carrying a non-major (i.e. minor) allele. Each group of haplotypes having the same mutational distance will constitute a haplotype allelic class (HAC). Therefore (with some abuse of notation) we also call HAC to the value of the mutational distance corresponding to each haplotype allelic class. That is, every haplotype having the same number of minor alleles belongs to the same HAC class and its HAC value corresponds to the number of minor alleles it carries.</p>
<p>Given the definitions above, consider a sample of <italic>n</italic> haplotypes of length <italic>L</italic> SNPs. For each evaluated SNP <italic>i</italic> (<italic>i ∈</italic> [1,<italic>L</italic>]) we can perform a partition of the haplotypes (and their HAC classes) into <italic>P</italic><sub>1</sub>, the subset carrying the most frequent (major) allele at the SNP <italic>i</italic> and <italic>P</italic><sub>2</sub> the subset with the remaining haplotypes carrying the minor allele at <italic>i</italic>. That is, let ‘0’ to be the major allele for the SNP <italic>i</italic> and ‘1’ the minor. Then, <italic>P</italic><sub>1</sub> includes every haplotype carrying the allele ‘0’ for the SNP <italic>i</italic> and <italic>P</italic><sub>2</sub> the remaining haplotypes carrying ‘1” for that SNP. In <italic>P</italic><sub>1</sub> we have different HAC values depending on the distance of each haplotype from MARH and similarly in <italic>P</italic><sub>2</sub>. Within each subset we can compute the variance of the HACs. Thus, in <italic>P</italic><sub>1</sub> we have the variance <italic>S</italic><sup>2</sup><sub>1i</sub> and correspondingly variance <italic>S</italic><sup>2</sup><sub>2i</sub> in <italic>P</italic><sub>2</sub> where <italic>i</italic> refer to the SNP for which we have performed the partition.</p>
<p>The rationale of the HAC-based methods relies on the sweeping effect of the selectively favored alleles. Therefore, if the SNP <italic>i</italic> is under ongoing selection then the variance in the partition 1 (<italic>S</italic><sup>2</sup><sub>1i</sub>) will tend to be zero because the allele at higher frequency (i.e. the allele of the SNP <italic>i</italic> in the partition 1) is being favored and the sweeping effect will make the HAC values in this partition to be lower (because of sweeping of other major frequency alleles) consequently provoking lower variance values [<xref ref-type="bibr" rid="pone.0175944.ref022">22</xref>]. The variance in the second partition (<italic>S</italic><sup>2</sup><sub>2i</sub>) should not be affected by the sweeping effect because it does not carry the favored allele. So, the difference <italic>S</italic><sup>2</sup><sub>2i</sub> - <italic>S</italic><sup>2</sup><sub>1i</sub> would be highly positive in the presence of selection and not so otherwise. For a window size of <italic>L</italic> SNPs, the variance difference between <italic>P</italic><sub>2</sub> and <italic>P</italic><sub>1</sub> can be computed to obtain a summary statistic called Svd [<xref ref-type="bibr" rid="pone.0175944.ref022">22</xref>] that can be generalized to
<disp-formula id="pone.0175944.e001">
<alternatives>
<graphic id="pone.0175944.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175944.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mi>g</mml:mi><mml:mi>S</mml:mi><mml:mi>v</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:msubsup><mml:mtext>S</mml:mtext><mml:mrow><mml:mn>2</mml:mn><mml:mtext>i</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mtext>S</mml:mtext><mml:mrow><mml:mn>1</mml:mn><mml:mtext>i</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mo>×</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>a</mml:mi></mml:msup><mml:mo>×</mml:mo><mml:mi>b</mml:mi><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
Where <italic>f</italic><sub>i</sub> is the frequency of the derived allele of the SNP <italic>i</italic>, and the parameters <italic>b</italic> and <italic>a</italic> permit to give different weights depending on if we need to detect higher frequencies (<italic>a</italic> = 0) or more intermediate ones (<italic>a</italic> &gt; 0) of the derived allele. If <italic>a</italic> = 0 and <italic>b</italic> = 1 the statistic corresponds to the original Svd and if <italic>a</italic> = 1 and <italic>b</italic> = 4 it corresponds to the variant called SvdM [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>]. Note that when using <italic>a</italic> = 1, it is not necessary to distinguish between ancestral and derived alleles because <italic>f</italic><sub>i</sub> and 1- <italic>f</italic><sub>i</sub> are interchangeable.</p>
<p>A drawback in the gSvd statistic is its dependence on the window size as it has already been reported for the original Svd [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>, <xref ref-type="bibr" rid="pone.0175944.ref022">22</xref>]. Although gSvd is normalized by <italic>L</italic>, the effect of the window size on the computation of variances is quadratic (see <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-1) which explains why the normalization is not effective in avoiding a systematic increase of the statistic under larger window sizes. This bias, due to the change in the window size, is important because the partitions <italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub> may experience different scaling effects, which would increase the noise in the estimation. The change in the scale due to the window size will also be dependent on the recombination and selection rates. Thus, it is desirable to develop a HAC-based statistic that does not increase with the window size. Following, the between-partition variance difference is reworked in order to develop a new normalized HAC-based statistic, specially focused on detecting divergent selection in local adaptation scenarios with migration.</p>
</sec>
<sec id="sec005">
<title>Normalized variance difference (nvd)</title>
<p>We have seen that in a sample of <italic>n</italic> haplotypes, we can compute the statistic gSvd which basically is the difference between the HAC variances of partitions <italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub>. The corresponding HAC means and variances at each partition are related via the general mean and variance in that sample. Considering, for any candidate SNP, <italic>m</italic> the mean HAC distance of the sample, and <italic>m</italic><sub>1</sub> and <italic>m</italic><sub>2</sub> the means of the partitions <italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub>, respectively. We have the following relationships for the mean <italic>m</italic> and the sample variance <italic>S</italic><sup>2</sup> (the subscripts 1 and 2 identify their corresponding partitions <italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub>; see the <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-2 for details)
<disp-formula id="pone.0175944.e002">
<alternatives>
<graphic id="pone.0175944.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175944.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mi>n</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>Δ</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
With <inline-formula id="pone.0175944.e003"><alternatives><graphic id="pone.0175944.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175944.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mtext>i</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mtext>i</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mtext>i</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mtext>i</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>; <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>2</sub> are the sample sizes at each partition and <inline-formula id="pone.0175944.e004"><alternatives><graphic id="pone.0175944.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175944.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Using the relationships in <xref ref-type="disp-formula" rid="pone.0175944.e002">Eq (1)</xref>, it is possible to compute the variance difference as appears in gSvd. However, we can substitute the parameters <italic>b</italic> and <italic>a</italic> by <italic>a</italic> = 1 and <italic>b</italic> = 4 as these are the values that permit to ignore the allelic state while maximizing the frequency product. It is also possible to consider the difference between means term (delta) in order to engage it in the detection of selection (see details in the <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>). Thus, we finally obtain a new statistic for the variance difference of the candidate SNP <italic>i</italic>
<disp-formula id="pone.0175944.e005">
<alternatives>
<graphic id="pone.0175944.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175944.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mi>v</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>v</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mtext>i</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mtext>i</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
where <inline-formula id="pone.0175944.e006"><alternatives><graphic id="pone.0175944.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175944.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi>v</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>Δ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
<p>The effect of selection upon <italic>vd</italic><sub>i</sub> is two-fold. The first term of the sum in <xref ref-type="disp-formula" rid="pone.0175944.e005">Eq (2)</xref> corresponds to the effect upon the difference between means and the second term between variances. Increasing <italic>S</italic><sub>2i</sub> or decreasing <italic>S</italic><sub>1i</sub>, as expected under selection, will increase the value of the statistic. If <italic>S</italic><sub>1i</sub> and <italic>S</italic><sub>2i</sub> are equal, then the value of <italic>vd</italic><sub>i</sub> is independent of the variances and only relies on the term <italic>vd</italic><sub>i0</sub> corresponding to the partitions’ mean (<italic>m</italic><sub>1</sub> and <italic>m</italic><sub>2</sub>) and the candidate SNP frequencies.</p>
<p>It is worth mentioning that the two parts of <italic>vd</italic><sub>i</sub> are not independent. If we have an extreme value for the HAC mean in the selective partition, for example <italic>m</italic><sub>1</sub> = 0, this implies that <italic>S</italic><sub>1</sub><sup>2</sup> = 0 since every haplotype has to have a HAC of 0 to get that mean value. Note however, that the opposite is not true: a value of <italic>S</italic><sub>1</sub><sup>2</sup> = 0 does not imply necessarily that <italic>m</italic><sub>1</sub> = 0.</p>
<p>At intermediate frequencies, an upper bound of <xref ref-type="disp-formula" rid="pone.0175944.e005">Eq (2)</xref> is (see <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-2 for further details)
<disp-formula id="pone.0175944.e007">
<alternatives>
<graphic id="pone.0175944.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175944.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>If we divide <xref ref-type="disp-formula" rid="pone.0175944.e005">Eq (2)</xref> by <italic>d</italic><sub>max</sub>, we have a normalized variance difference
<disp-formula id="pone.0175944.e008">
<alternatives>
<graphic id="pone.0175944.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175944.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mrow><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula></p>
<p>In a two-populations setting, it is possible to combine the sequences from the two populations in a unique sample and so the quantity from <xref ref-type="disp-formula" rid="pone.0175944.e008">Eq (4)</xref> can be computed for each SNP in that sample. The SNP yielding the maximum <italic>nvd</italic> may be considered as a candidate for divergent selection. When pooling both populations, the SNP frequencies tend to be intermediate in the divergent selective sites.</p>
<p>Therefore, the calculation of <italic>nvd</italic> consists of merging the shared SNPs from the two population samples, and then computing the normalized variance difference using <xref ref-type="disp-formula" rid="pone.0175944.e008">Eq (4)</xref>. Because selection acts at the intrapopulation level the reference haplotype (MARH) is defined just from one of the populations. The <italic>nvd</italic> neutral distribution so calculated under different window sizes can be viewed in the supplementary Fig A in <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>. Under low window size, <italic>nvd</italic> has higher variance and is slightly biased toward positive values. The effect of increasing the window size is a slight reduction of the <italic>nvd</italic> mean value and variance.</p>
<p>Provided that the sample size is the same in both populations, the choice of the reference does not have an appreciable effect either in the power or in the false positive rate of the test (Fig B and Table A in <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>). However, if the sample sizes are different, then the reference should come from the population with the highest sample size; if not, the method can suffer an important loss of power.</p>
<p>We have still pending the problem of choosing an optimal window size. A possible solution is to automate its choice by selecting the size which gives the maximum value for the statistic [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>], or alternatively, by trying different window sizes and giving the corresponding results for each window at the output. We have opted for the latter and so, under a given window size, the accompanying program evaluates all the SNPs and selects the ones that have the maximum <italic>nvd</italic> (one or more depending on the proportion of candidates we are interested in evaluating) and then, repeats the process for a different window size.</p>
<p>At this point we already have a HAC-based statistic, <italic>nvd</italic>, that does not increase with the window size and should produce higher positive values for pairs of populations undergoing divergent selection (see Fig B in <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>). However, even if there is no selection, the maximum <italic>nvd</italic> value could also be positive (see Fig A in <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>).</p>
<p>Unfortunately, the neutral distribution still depends on the combined effect of window size, marker density, and recombination. Besides, we ignore the theoretical distribution of the statistic and cannot decide if a given maximum is supporting the hypothesis of selection or not.</p>
<p>In addition, we might not have enough information on the species to simulate its evolution under a given neutral demography. Therefore, we still need to identify whether the value obtained for a given sample is due to the effect of selection, particularly because we want to put a great emphasis on avoiding false positives.</p>
<p>Consequently, we incorporate two more measures before giving a diagnosis about the presence of divergent selection. The first is a sign test based on the lower bound of <italic>nvd</italic>, the second is the comparison between the <italic>F</italic><sub>ST</sub> of the SNP having the maximum <italic>nvd</italic> and the overall <italic>F</italic><sub>ST</sub>.</p>
</sec>
<sec id="sec006">
<title>Sign test</title>
<p>In our definition of <italic>nvd</italic> the term <italic>vd</italic><sub>i0</sub> cannot be negative. For that reason, under some scenarios and window sizes, <italic>nvd</italic> is biased toward positive values. In such cases, a negative (or null) variance difference could be linked to a high positive <italic>vd</italic><sub>i0</sub> term provoking a positive <italic>nvd</italic> in a clearly neutral case. Therefore, we use a lower bound of <italic>nvd</italic> to derive the quantity called selection sign, <italic>ssig</italic> (see <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-3) that would have negative values when the HAC values in the first partition are high which is not expected under selection
<disp-formula id="pone.0175944.e009">
<alternatives>
<graphic id="pone.0175944.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175944.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:msub><mml:mo>∑</mml:mo><mml:mtext>h</mml:mtext></mml:msub><mml:msubsup><mml:mrow><mml:mtext>hac</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext>h</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where hac<sub>1h</sub> are the HAC values measured at each haplotype <italic>h</italic> in the partition 1 and the sum is over the <italic>n</italic><sub>1</sub> sequences in that partition. A negative sign in <xref ref-type="disp-formula" rid="pone.0175944.e009">Eq (5)</xref> suggests that the value of <italic>nvd</italic> is not the result of divergent selection (see Fig B in <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>). Indeed, we require <xref ref-type="disp-formula" rid="pone.0175944.e009">Eq (5)</xref> to be positive to count a given candidate as significant.</p>
<p>Finally, even if we have a candidate position identified by its high <italic>nvd</italic> value and by the positive sign in <italic>ssig</italic>, we still lack a method for obtaining <italic>p</italic>-values associated to the sites chosen by the <italic>nvd</italic> algorithm. We can solve this problem by combining the information on the selective candidate SNP, as given by <italic>nvd</italic>, with the <italic>F</italic><sub><italic>ST</italic></sub> interpopulation differentiation index at that site. The joint use of these methods produces the combined measure <italic>nvdF</italic><sub><italic>ST</italic></sub>.</p>
</sec>
<sec id="sec007">
<title>Combined method: <italic>nvdF</italic><sub>ST</sub></title>
<p>First, it is important to note that when computing <italic>nvd</italic>, we considered only the SNPs shared between both populations in order to avoid low informative loci with high sampling variance (reviewed in [<xref ref-type="bibr" rid="pone.0175944.ref006">6</xref>]). Thus, we have an <italic>nvd</italic> value that may indicate the presence of divergent selection in a pair of populations connected by migration. The rationale of the <italic>nvdF</italic><sub><italic>ST</italic></sub> approach is that if divergent selection acts on a specific site then the <italic>F</italic><sub>ST</sub> at that site would be higher when compared to the overall <italic>F</italic><sub>ST</sub>. Therefore, we proceed as follows, let <italic>i</italic> be the candidate site chosen because it has the maximum <italic>nvd</italic> value, then we calculate the index <italic>I</italic><sub>i</sub> = <italic>F</italic><sub>STi</sub>−<italic>F</italic><sub>ST</sub> that compares the <italic>F</italic><sub>ST</sub> measured at that site with the overall. The <italic>F</italic><sub>ST</sub> values were computed following the algorithm in Ferretti <italic>et al</italic> [<xref ref-type="bibr" rid="pone.0175944.ref023">23</xref>]. To obtain the <italic>p</italic>-value, we do not perform an LK test [<xref ref-type="bibr" rid="pone.0175944.ref005">5</xref>] because first, the candidate was not chosen for being an outlier and second, we are considering linked rather than independent sites.</p>
<p>To get the <italic>p</italic>-value for a given index <italic>I</italic><sub>i</sub>, the data is resampled several times (500 by default, and 100 when we evaluate more than 10<sup>4</sup> SNPs) to generate an empirical distribution. The expected frequency of each SNP is obtained as its mean frequency between populations, as this is the expectation under the homogenizing effect of migration [<xref ref-type="bibr" rid="pone.0175944.ref024">24</xref>]. If the sample sizes are different, the mean is weighted by the sample size. Then, for each resampling iteration, the probability of a given allele at each population is obtained from a binomial <italic>B</italic>(<italic>p</italic>,<italic>n</italic>), where <italic>p</italic> is the mean allelic frequency at that site, and <italic>n</italic> the local population sample size. The <italic>p</italic>-values correspond to the proportion of times that the resampled indexes (<italic>I’</italic><sub>i</sub> = <italic>F</italic><sub>STi_resample iteration</sub>−<italic>F</italic><sub>ST_resample iteration</sub>) were larger than the original index <italic>I</italic><sub>i</sub>.</p>
<p>We have computed the <italic>p</italic>-values for all the SNPs. If we inspect all of them and ignore the sign test, the above procedure is just testing the hypothesis of panmixia for each SNP. However, we are not doing so, i.e. we are not choosing the most significant <italic>p</italic>-values and so we are not targeting SNPs that reject panmixia. On the contrary, we are selecting some candidate SNPs based on their high <italic>nvd</italic> value and positive sign test. Only then, we check if such SNPs reject panmixia; if so, this adds evidence for divergent selection since it is well-known that divergent selection rejects that hypothesis for the selective genes [<xref ref-type="bibr" rid="pone.0175944.ref025">25</xref>, <xref ref-type="bibr" rid="pone.0175944.ref026">26</xref>]. Regarding the number of candidates ranked by their high <italic>nvd</italic> value, we can decide to consider just the best one, a few, or a given percentage (say 0.1%) of candidates.</p>
<p>For candidates with similar frequencies at both populations, we expect low values for the index <italic>I</italic><sub>i</sub> and correspondingly high <italic>p</italic>-values. When their pooled frequency is intermediate; two situations are possible: first, each population has a similar intermediate frequency which again implies high <italic>p</italic>-values; or second, the frequencies can be extreme and opposite at each population. In the latter, <italic>I</italic><sub>i</sub> is high and its <italic>p</italic>-value low. Note that, for each site, the resampling procedure has a variance <italic>p</italic>(<italic>1</italic>-<italic>p</italic>)<italic>n</italic> which is large at intermediate pooled frequency values. Thus, this method has the desired property to be more conservative at intermediate pooled frequencies, which minimizes the possibility of false positives.</p>
</sec>
<sec id="sec008">
<title>Significance, effective number of independent SNPs and <italic>q</italic>-value estimation</title>
<p>The computation of <italic>nvdF</italic><sub><italic>ST</italic></sub> required as many tests as the candidates considered under the different window sizes (<italic>N</italic><sub>w</sub>) assayed. Thus, it is appropriate to apply a multiple testing correction for the number of candidates (<italic>N</italic><sub><italic>C</italic></sub>).</p>
<p>The Šidák correction [<xref ref-type="bibr" rid="pone.0175944.ref027">27</xref>, <xref ref-type="bibr" rid="pone.0175944.ref028">28</xref>] can be applied to get the adjusted significance level <italic>s</italic><sub>L</sub> = 1 –(1 - <italic>γ</italic>)<sup>1/<italic>C</italic></sup> with nominal <italic>γ</italic> (= 0.05 by default). The value of <italic>C</italic> is <italic>C</italic> = <italic>max</italic>{(θ<sub>πmax</sub>−θ<sub>π</sub>)/(θ<sub>πmax</sub>−θ<sub>πmin</sub>)(<italic>L</italic><sub><italic>min</italic></sub>, (<italic>N</italic><sub><italic>C</italic></sub> + <italic>N</italic><sub>w</sub>)} where θ<sub>π</sub> is the average number of differences between pairs of sequences computed for a given window size. If sample size <italic>n</italic> is even then θ<sub>πmax</sub> = <italic>n</italic>/(2*(<italic>n</italic>-1)) and θ<sub>πmin</sub> = 2*<italic>maf</italic>*(<italic>n</italic>-<italic>maf</italic>) / [<italic>n</italic>*(<italic>n</italic>-1)] <italic>maf</italic>. The rationale for that <italic>C</italic> value is that in the case of low diversity samples it could happen that there are only one window size above the minimum (<italic>L</italic><sub><italic>min</italic></sub>). Low window sizes are precisely those where the <italic>nvd</italic> statistic is more biased toward positive values (Fig A in <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>). To avoid false positives in the case of only one candidate and low diversity, we correct by the minimum window size, as this involves the minimum number of SNPs tested but weighted them by (θ<sub>πmax</sub>−θ<sub>π</sub>)/(θ<sub>πmax</sub>−θ<sub>πmin</sub>) which tends to 1 when diversity is very low or, 0 if high.</p>
<p>Thus, the algorithm <italic>nvdF</italic><sub><italic>ST</italic></sub> would finally suggest a candidate as significant only when the sign, as computed in <xref ref-type="disp-formula" rid="pone.0175944.e009">Eq (5)</xref>, was positive, and the <italic>p</italic>-value (as obtained in the previous section) is lower than <italic>s</italic><sub>L</sub>.</p>
<p>In addition, it could be of interest to have information about the number of independent SNPs included between the left and right-most candidate positions. To roughly estimate the number of independent SNPs, we calculated the linkage disequilibrium measure <italic>D</italic>' [<xref ref-type="bibr" rid="pone.0175944.ref029">29</xref>, <xref ref-type="bibr" rid="pone.0175944.ref030">30</xref>] at each pair of consecutive sites, and then store the quantity <italic>r'</italic> = 1 –|<italic>D</italic>'| for each pair. The effective number of independent SNPs (<italic>M</italic><sub>effs</sub>) between site <italic>w</italic><sub>ini</sub> and <italic>w</italic><sub>end</sub> is then obtained as one plus the summation of the <italic>r'</italic> values in the interval [<italic>w</italic><sub>ini</sub>, <italic>w</italic><sub>end</sub>).</p>
<p>The <italic>q</italic>-values [<xref ref-type="bibr" rid="pone.0175944.ref031">31</xref>] can be seen as multiple testing analogs of <italic>p</italic>-values. They have been proposed as a useful approach for evaluating method performance in terms of false discoveries [<xref ref-type="bibr" rid="pone.0175944.ref011">11</xref>]. Accordingly, we estimate the <italic>q</italic>-values (see reference [<xref ref-type="bibr" rid="pone.0175944.ref032">32</xref>] and <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-4 for details on the calculation) and provide those corresponding to each inspected <italic>p</italic>-value. In order to obtain the <italic>q</italic>-values we must compute the <italic>p</italic>-values for all the SNPs (shared SNPs at frequency higher than <italic>maf</italic>). Thus, all the <italic>p</italic>–values and the corresponding <italic>q</italic>–values are calculated. Only those corresponding to the desired number of candidates, ranked by their highest <italic>nvd</italic> values, are given. For example, consider that the highest <italic>p</italic>-value is 0.99 and the lowest is 10<sup>−6</sup>. If we select just one candidate is because it has the highest <italic>nvd</italic> value and we concern only a posteriori about its <italic>p</italic>-value. If the associated <italic>p</italic>-value happens to be 0.2, we give both the <italic>p</italic>-value and its corresponding <italic>q</italic>-value, producing an output of this as a non-significant result.</p>
</sec>
</sec>
<sec id="sec009">
<title>The Extreme Outlier Set test (<italic>EOS</italic>)</title>
<p>The <italic>nvdF</italic><sub><italic>ST</italic></sub> method assumes the existence of linked genetic markers. If the data consists mostly of independent markers this would provoke a failure to detect the selection pattern because the HAC-based information does not exist. To deal with this situation, a second method was implemented consisting of a two-step heuristic procedure that performs a conservative test for identifying extreme outliers.</p>
<p>As already mentioned, the variance of the <italic>F</italic><sub>ST</sub> distribution is quite unpredictable under a variety of scenarios. This provokes high rates of false positives associated with the <italic>F</italic><sub>ST</sub> outlier tests. Our heuristic strategy takes advantage that independently of the demographic scenario, the involved regions under divergent selection may produce extreme outliers that would be clustered apart from the neutral ones. The subsequent LK test is performed only when this kind of outliers is detected. As <italic>F</italic><sub>ST</sub> estimator we use <italic>G</italic><sub><italic>ST</italic></sub> [<xref ref-type="bibr" rid="pone.0175944.ref033">33</xref>].</p>
<p>The rationale of the algorithm is as follows: the first step consists of computing the extreme positive outliers in the sense of Tukey, i.e. those sites having a <italic>F</italic><sub>ST</sub> value higher than 3 times the interquartile range [<xref ref-type="bibr" rid="pone.0175944.ref034">34</xref>]. The second step identifies different classes inside the extreme outlier set. This is done by a <italic>k</italic>-means algorithm [<xref ref-type="bibr" rid="pone.0175944.ref035">35</xref>, <xref ref-type="bibr" rid="pone.0175944.ref036">36</xref>]. The algorithm permits to classify all the elements of the outlier set in one of the <italic>k</italic> classes. Once all the elements are classified, the class with lower values is discarded. Only the elements, if any, in the upper classes having values higher than a cutoff point are maintained in the set. For the sake of computational efficiency, we use <italic>k</italic> = 2 and consider two modes {0, <italic>F</italic><sub>STu</sub>} for computing the cutoff. The modes corresponding to lower (0) and upper (<italic>F</italic><sub>STu</sub>) bounds for the <italic>F</italic><sub>ST</sub> estimator (see <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-5). The cutoff point is defined as the overall <italic>F</italic><sub>ST</sub> + σ<italic>F</italic><sub>STu</sub> / 3, i.e. the mean plus sigma times the square root of the upper-bound for the <italic>F</italic><sub>ST</sub> variance under an asymmetric unimodal distribution [<xref ref-type="bibr" rid="pone.0175944.ref037">37</xref>]. The value of sigma was set by default to σ = 1.25. Finally, for each of the candidates remaining in the EOS after the cutoff, the LK test [<xref ref-type="bibr" rid="pone.0175944.ref005">5</xref>] is performed to compute its <italic>p</italic>-value. The Šidák correction [<xref ref-type="bibr" rid="pone.0175944.ref027">27</xref>, <xref ref-type="bibr" rid="pone.0175944.ref028">28</xref>] for the number of remaining outliers in the set is applied to get the significance level. Each <italic>p</italic>-value is accompanied by its corresponding <italic>q</italic>-value (computed as explained in the previous section).</p>
</sec>
<sec id="sec010">
<title>Software description</title>
<p>Both <italic>nvdF</italic><sub><italic>ST</italic></sub> and the EOS test have been implemented in the program HacDivSel. Complete details of the software and extensive explanations for its use can be found in the accompanying manual. The input program files for the haplotype-based test can be in the SNPs × haplotypes HapMap3, MS [<xref ref-type="bibr" rid="pone.0175944.ref038">38</xref>] or Fasta formats. If the data does not include haplotype information, then the Plink [<xref ref-type="bibr" rid="pone.0175944.ref039">39</xref>] flat file (map/ped), Genepop [<xref ref-type="bibr" rid="pone.0175944.ref040">40</xref>] or BayeScan [<xref ref-type="bibr" rid="pone.0175944.ref041">41</xref>] formats can be used. When using the Fasta format, the sample size should be the same for both populations. A typical command line for calling the program in order to analyze a MS format file named <italic>sel</italic>.<italic>txt</italic> containing 100 sequences, 50 from each population, would be
<disp-formula id="pone.0175944.e010">
<alternatives>
<graphic id="pone.0175944.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0175944.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:mrow><mml:mi>H</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>S</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mn mathvariant="italic">50</mml:mn><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mn mathvariant="italic">2</mml:mn><mml:mtext> </mml:mtext><mml:mn mathvariant="italic">50</mml:mn><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mtext> </mml:mtext><mml:mn>10</mml:mn><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mi>L</mml:mi><mml:mtext> </mml:mtext><mml:mn mathvariant="italic">0.05</mml:mn><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:mtext> </mml:mtext><mml:mo>–</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mn mathvariant="italic">4</mml:mn></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
Where the label, “-<italic>candidates</italic> 10”, indicates that the ten highest <italic>nvd</italic> values should be included in the output. The program analyze the file and produce as output the highest 10 values and their significance at the 0.05 level for different window sizes. It also performs the EOS test and gives the resulting outliers, if any, and their significance. Only the SNPs shared by the two populations are considered. This implies that there are at least 4 copies of each SNP in the metapopulation (maf = 4). The set of command-line options utilized for the different analyses, both for simulated and real data in the next sections is available in the <xref ref-type="supplementary-material" rid="pone.0175944.s004">S1 Sim</xref> file.</p>
</sec>
<sec id="sec011">
<title>Simulations</title>
<p>There are several examples of adaptation to divergent environments connected by migration, e.g. the intertidal marine snail <italic>L</italic>. <italic>saxattilis</italic> [<xref ref-type="bibr" rid="pone.0175944.ref042">42</xref>], some wild populations of <italic>Salmo salar</italic> [<xref ref-type="bibr" rid="pone.0175944.ref043">43</xref>], Coregunus species [<xref ref-type="bibr" rid="pone.0175944.ref044">44</xref>], etc. To perform simulations as realistic as possible, we use some relevant demographic information from <italic>L</italic>. <italic>saxatilis</italic>, such as migration rates and population size as estimated from field data [<xref ref-type="bibr" rid="pone.0175944.ref042">42</xref>]. Concerning selection intensities, we considered moderate selection pressures and few loci with large effects [<xref ref-type="bibr" rid="pone.0175944.ref045">45</xref>]. Therefore, a model resembling the most favorable conditions for the formation of ecotypes under local adaptation with migration was implemented.</p>
<p>Two populations of 1000 facultative hermaphrodites were simulated. The selective scenario (<italic>α</italic> = 4<italic>Ns</italic>) is divergent so that the allele favored in one population is the deleterious in the other. Each individual consisted of a diploid chromosome of length 1Mb. The contribution of each selective locus to the fitness was 1-<italic>hs</italic> with <italic>h</italic> = 0.5 in the heterozygote or <italic>h</italic> = 1 otherwise. The selection coefficient for the ancestral allele was always <italic>s</italic> = 0 while <italic>s</italic> = ± 0.15 for the derived. That is, the ancestral was the favored allele in one population (positive <italic>s</italic> in the derived) while the derived was the favored in the other population (negative <italic>s</italic>, see Table B in <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>). In the polygenic case the fitness was obtained by multiplying the contribution at each locus. This simulation model involves low and high mutation rate (θ = 4Nμ ∈ {12, 60}) and different recombination rates (ρ = 4<italic>Nr</italic> ∈ {0, 4, 12, 60, unlinked}) and extends previous work [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>] by adding new parameter values and demographic scenarios. At the end of each run, 50 haplotypes were sampled from each population. The whole setting is fully explained in the <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref> (section A-6). The simulations were performed using the last version of the program GenomePop2 [<xref ref-type="bibr" rid="pone.0175944.ref046">46</xref>].</p>
</sec>
</sec>
<sec id="sec012" sec-type="results">
<title>Results</title>
<p>We present here the results for both simulated and real data. The power of a test (true positive rate, TPR) is measured as the percentage of runs in which selection was detected from simulated selective scenarios, and the false positive rate (FPR) is measured as the percentage of runs in which selection (at any position) was detected from simulated neutral scenarios. The <italic>q</italic>-value [<xref ref-type="bibr" rid="pone.0175944.ref031">31</xref>] is estimated from the results (see <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-4).</p>
<p>The simulated data is also utilized for comparing <italic>nvdF</italic><sub><italic>ST</italic></sub> with the related statistic SvdM (that needs a simulation step to assess significance) while the EOS test is compared with BayeScan 2.1 [<xref ref-type="bibr" rid="pone.0175944.ref041">41</xref>]. We chose BayeScan because it is one of the main state-of-the-art outlier-based programs. The parameters for BayeScan were the default ones as this is a conservative setting and we were interested in comparing the false positive rates. Only SNPs shared between populations and with a minimum allele frequency (maf) of 2 per population (4%) were considered.</p>
<sec id="sec013">
<title>Precision</title>
<p>The precision or positive predictive value (PPV) is a useful measure for answering the question of how well a positive result in the test predicts the real existence of selection. It is calculated as the proportion of true positives (TPR) out of all positive results (TPR + FPR).</p>
<p>Recall that one of the main focus of the proposed methodologies is to have low false positive rate (FPR) and, from this point of view, the PPV measure is very informative since the higher the PPV, the lower the possibility that a positive result be a false one.</p>
<p>However, if a test has very low false positives, it could have high PPV but low power. In this case, the high PPV is hiding the low performance of the test. Thus, we are interested in both, the PPV as shown in the <xref ref-type="fig" rid="pone.0175944.g001">Fig 1</xref>, but also in the specific values in terms of power (TPR) and false positives (FPR), as given in the text and in the tables following.</p>
<fig id="pone.0175944.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175944.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Positive predictive values for <italic>nvdF</italic><sub>ST</sub>, SvdM, EOS and BayeScan (Bayes factor 3: BSBF3 and Bayes factor 100: BSBF100) methods.</title>
<p>There are 6 points (2 mutation x 3 recombination) in the curves corresponding to the haplotype-based method (left panel) and 2 points (high recombination and independent markers) in the outlier-based method (EOS and BayeScan, right panel).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.g001" xlink:type="simple"/>
</fig>
<p>Concerning the PPV measure, the rate of true positives with respect to the total positives is above 90% for the haplotype based methods <italic>nvdF</italic><sub><italic>ST</italic></sub> and <italic>SvdM</italic> [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>], as shown in <xref ref-type="fig" rid="pone.0175944.g001">Fig 1</xref> (left panel). The simulated scenarios were different combinations of mutation and recombination rates using <italic>α</italic> = 600 and <italic>Nm</italic> = 10 (<xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-6).</p>
<p>The individual TPR and FPR values for <italic>nvdF</italic><sub><italic>ST</italic></sub> are given in <xref ref-type="table" rid="pone.0175944.t001">Table 1</xref>. For <italic>SvdM</italic>, the TPR had a minimum of 43% and a maximum of 94%. The FPR is fixed to 5% since this was the critical threshold used by the authors in the neutral simulations for assessing significance. The values used for computing the <italic>SvdM</italic> points in the Figure correspond to those in Tables 2 and 3 in [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>]. The general performance of <italic>SvdM</italic> was slightly worse than for <italic>nvdF</italic><sub><italic>ST</italic></sub>.</p>
<table-wrap id="pone.0175944.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175944.t001</object-id>
<label>Table 1</label> <caption><title>Performance of the combined method (<italic>nvdF</italic><sub><italic>ST</italic></sub>) with <italic>n</italic> = 1 selective site located at the center of the chromosome or <italic>n</italic> = 5 (see <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-6).</title>
<p>Selection was <italic>α</italic> = 4<italic>Ns</italic> = 600 and migration <italic>Nm</italic> = 10. Mean localization is given in distance (kb) from the real selective position.</p></caption>
<alternatives>
<graphic id="pone.0175944.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">∑</th>
<th align="center">θ</th>
<th align="center">ρ</th>
<th align="center">n</th>
<th align="center">%Power</th>
<th align="center">%FPR (<italic>γ</italic> = 5%)</th>
<th align="center"><italic>q</italic>-value</th>
<th align="center">Localization (kb)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">65</td>
<td align="center">12</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">87</td>
<td align="center">2.1</td>
<td align="char" char=".">0.0058</td>
<td align="center">±458</td>
</tr>
<tr>
<td align="center">63</td>
<td align="center">12</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="center">94</td>
<td align="center">2.7</td>
<td align="char" char=".">0.0008</td>
<td align="center">±200</td>
</tr>
<tr>
<td align="center">60</td>
<td align="center">12</td>
<td align="center">12</td>
<td align="center">1</td>
<td align="center">90</td>
<td align="center">1.0</td>
<td align="char" char=".">0.0003</td>
<td align="center">±33</td>
</tr>
<tr>
<td align="center">251</td>
<td align="center">60</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">79</td>
<td align="center">1.8</td>
<td align="char" char=".">0.0048</td>
<td align="center">±60</td>
</tr>
<tr>
<td align="center">232</td>
<td align="center">60</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="center">84</td>
<td align="center">6.2</td>
<td align="char" char=".">0.0011</td>
<td align="center">±17</td>
</tr>
<tr>
<td align="center">249</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">1</td>
<td align="center">86</td>
<td align="center">2.4</td>
<td align="char" char=".">0.0002</td>
<td align="center">&lt;±1</td>
</tr>
<tr>
<td align="center">282</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">5</td>
<td align="center">99</td>
<td align="center">2.4</td>
<td align="char" char=".">0.0002</td>
<td align="center">&lt;±1</td>
</tr>
<tr>
<td align="center">318</td>
<td align="center">60</td>
<td align="center">∞</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>∑: Mean number of shared SNPs per Mb. θ: Mutation rate. ρ: Recombination rate. FPR: false positive rate. <italic>q</italic>-value: mean estimated <italic>q</italic>-value for the significant tests. ∞: Independently segregating sites.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>The non haplotype-based methods, EOS and BayeScan (BS), have no power when the markers are linked, so they are compared only under independent and weak-linkage (ρ = 60; 1.5 cM/Mb) scenarios (right panel in <xref ref-type="fig" rid="pone.0175944.g001">Fig 1</xref>). As it can be seen in <xref ref-type="fig" rid="pone.0175944.g001">Fig 1</xref>, the EOS method has the best performance in terms of the proportion of true positive results from the total positives.</p>
<p>For EOS, the TPR was about 60% with a very low FPR that provokes that almost 100% of positives are true ones. The TPR for BS with Bayes factor of 3 (BSBF3) was 47% under weak linkage and 93% with independent markers. However, both settings had high rate of false positives with FPR of 26 and 57% respectively. The TPR of BS with Bayes factor of 100 was only 13% (FPR 3%) under weak linkage but was 82% (FPR 8%) under independent markers.</p>
<p>The above results are observations from 1,000 runs. Within each run, we have also measured the number of sites falsely detected per genome, as well as the FDR (the proportion of falsely detected sites from the total detected). As these quantities were low and do not have any significant impact on power (TPR) and FPR (as defined above), we will postpone the mention of the within-run measures until the discussion section.</p>
<p>In the following sections, we detail the results for <italic>nvdF</italic><sub><italic>ST</italic></sub> and EOS under different simulated scenarios.</p>
</sec>
<sec id="sec014">
<title>Combined method (<italic>nvdF</italic><sub>ST</sub>)</title>
<p>Under a single locus architecture with selection <italic>α</italic> = 4<italic>Ns</italic> = 600 and migration <italic>Nm</italic> = 10, the power of <italic>nvdF</italic><sub><italic>ST</italic></sub> vary between 79–94% for both medium (60 SNPs/Mb) and high density (250 SNPs/Mb) maps (<xref ref-type="table" rid="pone.0175944.t001">Table 1</xref>). These results can be compared to published analyses [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>] with the methods Svd and SvdM for which slightly worse performance (42–94%) were obtained for the same mutation and recombination (Tables 2 and 3 in [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>]). However, as mentioned elsewhere, the methods Svd and SvdM oblige the user to perform simulations of the neutral demography to obtain the <italic>p</italic>-values for the tests, and consequently, the results in the Rivas and coworkers study [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>], were obtained having the exact neutral demography available. As it can be appreciated from rows 1 to 6 in <xref ref-type="table" rid="pone.0175944.t001">Table 1</xref> —that matches the scenarios in [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>]—the <italic>nvdF</italic><sub><italic>ST</italic></sub> performs well without the need of performing additional neutral simulations. Also, the false positive rate and the <italic>q</italic>-value (mean <italic>q</italic>-value through significant runs) are low in all the scenarios. The shown results are for 10,000 generations; the cases with 5,000 generations were similar.</p>
<p>Under the polygenic architecture (<italic>n</italic> = 5 in <xref ref-type="table" rid="pone.0175944.t001">Table 1</xref>) at least one candidate is found 99% of the time, and more than one, 80% of the time. However, the number of correctly identified sites is quite variable ranging between 1 and 3.</p>
<p>The last row in <xref ref-type="table" rid="pone.0175944.t001">Table 1</xref> corresponds to the case when all SNPs segregate independently. In this case, the method fails to detect selection. This is not surprising because the information from the haplotype allelic classes is absent under linkage equilibrium; the adequate patterns are not found, which provokes both a negative in the sign test and a candidate with low <italic>F</italic><sub>ST</sub> index measure.</p>
<sec id="sec015">
<title>Phasing accuracy</title>
<p>We have tested the impact of phasing error by introducing different percentage of random error in the allele imputation. At each sequence, 10–50% of imputation errors were introduced in random positions. This process was performed for the selective cases <italic>α</italic> = 600 with θ = 60 and ρ = {0, 4, 60} corresponding to the same cases (with 100% accuracy) from rows 4–6 in <xref ref-type="table" rid="pone.0175944.t001">Table 1</xref>. The obtained data were analyzed with <italic>nvdF</italic><sub><italic>ST</italic></sub> under different window sizes (automatic mode). The best performing window size was <italic>L</italic> ϵ {55,75}.</p>
<p>From <xref ref-type="fig" rid="pone.0175944.g002">Fig 2</xref> it seems that <italic>nvdF</italic><sub><italic>ST</italic></sub> is robust up to 10% of imputation error (90% accuracy). The explanation is that a given error rate will affect more at specific window sizes (higher window sizes), because the automatic window size selection method tries different lengths so that the shortest window maintain the power. Coherently with this explanation the more affected cases correspond to a higher recombination rate and window size.</p>
<fig id="pone.0175944.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175944.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Effect of % phasing accuracy on the power of the <italic>nvdF</italic><sub><italic>ST</italic></sub> test.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.g002" xlink:type="simple"/>
</fig>
<p>Still, when the recombination rate is not high, <italic>nvdF</italic><sub><italic>ST</italic></sub> seems to be robust under imputation error as high as 20 to 30%. Finally, a phasing error of 50% provokes the method failure, independently of the linkage relationship. Thus, under imputation error of 10–30%, the more dense the map of markers is, the more robust the method. Hence, under high-medium density maps, as those we have assayed, the performance is also reliable when using different subsets of SNPs provided that the linkage relationships are not completely broken (see Fig C in <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>).</p>
</sec>
<sec id="sec016">
<title>Short-term strong selection and long-term weak selection scenarios</title>
<p>The performance of <italic>nvdF</italic><sub><italic>ST</italic></sub> under the strong selection scenario (α = 6000) in the short-term (500 generations) varies between 44%, for fully linked, to 67%, for weak linked markers (<xref ref-type="table" rid="pone.0175944.t002">Table 2</xref>). Not surprisingly, the number of segregating sites is considerably reduced. In fact the minimum window size allowed by the program had to be shortened from 51 to 25 to perform the analyses. Notably the false positive rate (FPR) was 0.</p>
<table-wrap id="pone.0175944.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175944.t002</object-id>
<label>Table 2</label> <caption><title>Performance of the combined method (<italic>nvdF</italic><sub><italic>ST</italic></sub>) with a single selective site in the short-term strong (<italic>α</italic> = 6000) and the long-term weak (<italic>α</italic> = 140) selection scenarios.</title> <p><italic>Nm</italic> was 10. Mean localization is given in distance (kb) from the real selective position.</p></caption>
<alternatives>
<graphic id="pone.0175944.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">∑</th>
<th align="center">θ</th>
<th align="center">ρ</th>
<th align="center"><italic>α</italic></th>
<th align="center"><italic>t</italic></th>
<th align="center">%Power</th>
<th align="center">%FPR (<italic>γ</italic> = 5%)</th>
<th align="center"><italic>q</italic>-value</th>
<th align="center">Localization (kb)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">112</td>
<td align="center">60</td>
<td align="center">0</td>
<td align="center">6000</td>
<td align="center">500</td>
<td align="center">44</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">±66</td>
</tr>
<tr>
<td align="center">32</td>
<td align="center">60</td>
<td align="center">4</td>
<td align="center">6000</td>
<td align="center">500</td>
<td align="center">63</td>
<td align="center">0</td>
<td align="center">0.0014</td>
<td align="center">±5</td>
</tr>
<tr>
<td align="center">62</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">6000</td>
<td align="center">500</td>
<td align="center">67</td>
<td align="center">0</td>
<td align="center">0.0008</td>
<td align="center">±93</td>
</tr>
<tr>
<td align="center">165</td>
<td align="center">60</td>
<td align="center">0</td>
<td align="center">140</td>
<td align="center">5,000</td>
<td align="center">36</td>
<td align="center">1</td>
<td align="center">0.007</td>
<td align="center">±2</td>
</tr>
<tr>
<td align="center">156</td>
<td align="center">60</td>
<td align="center">4</td>
<td align="center">140</td>
<td align="center">5,000</td>
<td align="center">30</td>
<td align="center">1.5</td>
<td align="center">0.003</td>
<td align="center">±13</td>
</tr>
<tr>
<td align="center">135</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">140</td>
<td align="center">5,000</td>
<td align="center">17</td>
<td align="center">2</td>
<td align="center">0.000</td>
<td align="center">±1</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p>∑: mean number of shared SNPs per Mb. θ: Mutation rate. ρ: recombination rate. <italic>t</italic>: number of generations. FPR: false positive rate. <italic>q</italic>-value: mean estimated <italic>q</italic>-value, the mean is computed only through the significant tests.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Concerning weak selection in long-term scenarios (<xref ref-type="table" rid="pone.0175944.t002">Table 2</xref>, α = 140), the power varies between 36–17% with false positive rates between 1 and 2%.</p>
</sec>
</sec>
<sec id="sec017">
<title>Extreme Outlier Set test (EOS)</title>
<p>We applied the EOS test under the single locus architecture with selection <italic>α</italic> = 600 and migration <italic>Nm</italic> = 10. As desired, the test is very conservative with false positive rate below the nominal 0.05 in every case (<xref ref-type="table" rid="pone.0175944.t003">Table 3</xref>). Not surprisingly for an outlier-based method, the test has no power if markers are strongly linked (ρ from 0 to 12) or under a polygenic setting (row with <italic>n</italic> = 5 in <xref ref-type="table" rid="pone.0175944.t003">Table 3</xref>). However, in the cases of independent SNPs, and also with recombination of 1.5 cM/Mb in maps with 250–300 SNPs/Mb, the power rises up to 60%. Therefore, the EOS test is complementary to <italic>nvdF</italic><sub><italic>ST</italic></sub> in the sense that EOS has the maximum power when <italic>nvdF</italic><sub><italic>ST</italic></sub> has the minimum one. This behavior is expected because <italic>nvdF</italic><sub><italic>ST</italic></sub> requires some linkage among markers, while EOS requires the contrary.</p>
<table-wrap id="pone.0175944.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175944.t003</object-id>
<label>Table 3</label> <caption><title>Performance of the extreme outlier test (EOS) with <italic>n</italic> = 1 selective site located at the center of the chromosome or <italic>n</italic> = 5.</title> <p>Selection was <italic>α</italic> = 600 and <italic>Nm</italic> = 10. Mean localization is given in distance (kb) from the real selective position.</p></caption>
<alternatives>
<graphic id="pone.0175944.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">∑</th>
<th align="center">θ</th>
<th align="center">ρ</th>
<th align="center">n</th>
<th align="center">%Power EOS</th>
<th align="center">%FPR (<italic>γ</italic> = 5%)</th>
<th align="center">q’-value</th>
<th align="center">Localization (kb)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">65</td>
<td align="center">12</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">63</td>
<td align="center">12</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="center">0.2</td>
<td align="center">0</td>
<td align="center">0.46</td>
<td align="center">±3</td>
</tr>
<tr>
<td align="center">60</td>
<td align="center">12</td>
<td align="center">12</td>
<td align="center">1</td>
<td align="center">1.1</td>
<td align="center">0</td>
<td align="center">0.45</td>
<td align="center">±77</td>
</tr>
<tr>
<td align="center">251</td>
<td align="center">60</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0.7</td>
<td align="center">0</td>
<td align="center">0.10</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">232</td>
<td align="center">60</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="center">1.3</td>
<td align="center">0</td>
<td align="center">0.20</td>
<td align="center">±150</td>
</tr>
<tr>
<td align="center">249</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">0.4</td>
<td align="center">0.5</td>
<td align="center">&lt;±1</td>
</tr>
<tr>
<td align="center">282</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">5</td>
<td align="center">1.6</td>
<td align="center">0.4</td>
<td align="center">0.49</td>
<td align="center">±5</td>
</tr>
<tr>
<td align="center">318</td>
<td align="center">60</td>
<td align="center">∞</td>
<td align="center">1</td>
<td align="center">61</td>
<td align="center">1.2</td>
<td align="center">3×10<sup>−6</sup></td>
<td align="center">±7</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001"><p>∑: mean number of shared SNPs per Mb. θ: mutation rate. ρ: recombination rate. FPR: false positive rate. q’-value: mean corrected (see <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 appendix</xref>, section A-4) estimated <italic>q</italic>-value in the significant tests. ∞: independently segregating sites.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Concerning false positives, note—in the last three rows of <xref ref-type="table" rid="pone.0175944.t003">Table 3</xref>— the low false positive rates (FPR) that indicate the low percentage of outliers detected as selective in the corresponding neutral scenario. Indeed, in the scarce runs where false positives occur their number was very low (1 false outlier in 1.2% of the runs for independent markers and 1 to 4 false outliers in 0.4% of the runs for linked markers). Thus, the test worked correctly by avoiding false selective sites under the neutral setting.</p>
<p>However, the <italic>q</italic>-value estimates varied a lot depending on the linkage between markers. It can be appreciated that the <italic>q</italic>-value is very low (3×10<sup>−6</sup>) for independently segregating sites, but rise up to 0.5 for the same scenario when markers are linked. The reason behind this lies in the way the <italic>q</italic>-values are computed: the algorithm assumes that a number of independent <italic>S</italic> tests were performed and corrects for <italic>S</italic> tests under this assumption (see <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-4). However, in the case of linked markers, the number of independent tests is smaller and this generates inflated <italic>q</italic>-values.</p>
</sec>
<sec id="sec018">
<title>Position effect</title>
<p>The ability to locate the physical position of the selective site increases with the marker density and the recombination rate (<xref ref-type="table" rid="pone.0175944.t001">Table 1</xref>). The given localizations are away (in kilobases) from the correct position and averaged through the runs. Standard errors are omitted since they were low (in the order of hundreds of bases or below 5 kb in the worst scenario of fully linked markers). The <italic>nvdF</italic><sub><italic>ST</italic></sub> method performs well when a) the target site is located at the center of the studied region, b) the selection is not too strong (α ≤ 600) and c) the overall recombination rate is at least 0.3 cM/Mb (ρ ≥ 12). In this case, the selective location is estimated, at worst, within 33 kb of distance from the true location (<xref ref-type="table" rid="pone.0175944.t001">Table 1</xref>). In the case with strong selection, the localization is still wrongly assigned under high recombination (<xref ref-type="table" rid="pone.0175944.t002">Table 2</xref>, α = 6000). However, this could be due to the low number of segregating sites (only 62 in <xref ref-type="table" rid="pone.0175944.t002">Table 2</xref>).</p>
<p>In addition, it should be noted that the proportion of detected sites that lies at, or close to, the true selective position depends on the linkage relationships among the markers, which is obviously influenced by the recombination rate. Thus, if we consider the distance in centimorgans (cM), our results are not so different between the distinct recombination rates. This means that all detected sites lay within 1 map unit from the true selective position. For example, if we require that any detected SNP should be within 0.15 map units from the true position, then under a recombination rate of 0.3 cM/Mb we accept any detected site that is no more than 500 Kb away from the correct position. The same requirement in the cases under recombination rate of 1.5 cM/Mb implies that we only accept sites that are closer than 100 Kb.</p>
<p>Importantly, the localization is also dependent on where the selective site is placed within the chromosome. The farther from the center, the worse the ability to correctly localize the selective positions (<xref ref-type="table" rid="pone.0175944.t004">Table 4</xref>). In this case, with recombination of 1.5 cM/Mb, the inferred location changes from an almost perfect localization (&lt;1 kb from <xref ref-type="table" rid="pone.0175944.t001">Table 1</xref>) to distances of 10–122 kb, as the target is shifted away from the center. This issue has already been shown for other HAC-based methods [<xref ref-type="bibr" rid="pone.0175944.ref019">19</xref>].</p>
<table-wrap id="pone.0175944.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175944.t004</object-id>
<label>Table 4</label> <caption><title>Performance of <italic>nvdF</italic><sub><italic>ST</italic></sub> and EOS with a single selective site located at different positions.</title> <p>Selection was <italic>α</italic> = 600 and <italic>Nm</italic> = 10. Mean localization is given in distance (kb) from the real selective position. FPRs are the same as in <xref ref-type="table" rid="pone.0175944.t001">Table 1</xref>. <italic>q</italic>-value refers to the mean <italic>q</italic>-value for the significant <italic>nvdF</italic><sub>ST</sub> tests.</p></caption>
<alternatives>
<graphic id="pone.0175944.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.t004" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">∑</th>
<th align="center">θ</th>
<th align="center">ρ</th>
<th align="center">%Power <italic>nvdF</italic><sub><italic>ST</italic></sub>, EOS</th>
<th align="center">Position (kb)</th>
<th align="center"><italic>nvdF</italic><sub><italic>ST</italic></sub> <italic>q</italic>-value</th>
<th align="center">Localization (kb) <italic>nvdF</italic><sub><italic>ST</italic></sub>, EOS</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">259</td>
<td align="center">60</td>
<td align="center">0</td>
<td align="center">81, 1</td>
<td align="center">0</td>
<td align="char" char=".">0.0044</td>
<td align="center">+483, +457</td>
</tr>
<tr>
<td align="center">255</td>
<td align="center">60</td>
<td align="center">0</td>
<td align="center">81, 1.5</td>
<td align="center">10</td>
<td align="char" char=".">0.0049</td>
<td align="center">+433, +496</td>
</tr>
<tr>
<td align="center">256</td>
<td align="center">60</td>
<td align="center">0</td>
<td align="center">82, 0.9</td>
<td align="center">100</td>
<td align="char" char=".">0.0041</td>
<td align="center">+350, +413</td>
</tr>
<tr>
<td align="center">255</td>
<td align="center">60</td>
<td align="center">0</td>
<td align="center">78, 0.6</td>
<td align="center">250</td>
<td align="char" char=".">0.0039</td>
<td align="center">±194, ±185</td>
</tr>
<tr>
<td align="center">230</td>
<td align="center">60</td>
<td align="center">4</td>
<td align="center">75, 2.5</td>
<td align="center">0</td>
<td align="char" char=".">0.0014</td>
<td align="center">+324, +127</td>
</tr>
<tr>
<td align="center">226</td>
<td align="center">60</td>
<td align="center">4</td>
<td align="center">77, 3.5</td>
<td align="center">10</td>
<td align="char" char=".">0.0016</td>
<td align="center">+326, +142</td>
</tr>
<tr>
<td align="center">233</td>
<td align="center">60</td>
<td align="center">4</td>
<td align="center">80, 1.8</td>
<td align="center">100</td>
<td align="char" char=".">0.0017</td>
<td align="center">+227, +140</td>
</tr>
<tr>
<td align="center">229</td>
<td align="center">60</td>
<td align="center">4</td>
<td align="center">83, 1.6</td>
<td align="center">250</td>
<td align="char" char=".">0.0009</td>
<td align="center">±123, ±20</td>
</tr>
<tr>
<td align="center">262</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">63, 93</td>
<td align="center">0</td>
<td align="char" char=".">0.0014</td>
<td align="center">+122, +40</td>
</tr>
<tr>
<td align="center">261</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">68, 91</td>
<td align="center">10</td>
<td align="char" char=".">0.0014</td>
<td align="center">+113, +34</td>
</tr>
<tr>
<td align="center">257</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">81, 84</td>
<td align="center">100</td>
<td align="char" char=".">0.0006</td>
<td align="center">±44, ±6</td>
</tr>
<tr>
<td align="center">252</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">87, 67</td>
<td align="center">250</td>
<td align="char" char=".">0.0004</td>
<td align="center">±10, ±0.06</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t004fn001"><p>∑: Mean number of shared SNPs per Mb. θ: Mutation rate. ρ: Recombination rate. Position: real position of the selective site.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>At high recombination rates (1.5 cM/Mb), this problem is partially solved by using the EOS test (<xref ref-type="table" rid="pone.0175944.t004">Table 4</xref>). In this case, the test has high power (67–93%) and localizes well the selective position. In fact, the position of the selective site is almost perfectly estimated (few bases or kb) when the true position is not at the extremes. Even if the target sites are at the extremes, the localization is within 40 kb (see cases with ρ = 60 in <xref ref-type="table" rid="pone.0175944.t004">Table 4</xref>).</p>
<p>In the case of independent markers with the selective site located at the center (<xref ref-type="table" rid="pone.0175944.t003">Table 3</xref>) the localization by EOS was good.</p>
</sec>
<sec id="sec019">
<title>Other demographic scenarios</title>
<sec id="sec020">
<title>Bottleneck-expansion scenarios</title>
<p>Bottleneck-expansion scenarios are known to leave signatures that mimic the effect of positive selection. We tested the robustness of the tests by looking for false positives when applying the methods to a bottleneck and expansion scenario under a neutral setting. The bottleneck was simulated by a reduction of one of the populations to 1% of the original size (<italic>N</italic> from 1000 to 10). Afterwards, the population expansion was implemented by increasing the population size following a logistic growth model (see <xref ref-type="supplementary-material" rid="pone.0175944.s001">S1 Appendix</xref>, section A-6). The methods performed well: the false positive rate is maintained below the nominal level with 4.6% and 1% for <italic>nvdF</italic><sub><italic>ST</italic></sub> and EOS tests, respectively.</p>
</sec>
<sec id="sec021">
<title>High migration scenario</title>
<p>Scenarios with high migration rate are intrinsically difficult for detection of selection. Under the short-term (500 generations) scenario with <italic>Nm</italic> = 50 (5%), <italic>nvdF</italic><sub><italic>ST</italic></sub> is still able to detect the effect of selection in spite of the homogenizing effect of migration. The detection power ranges between 31–57% with a false positive rate of 0–0.1% (<xref ref-type="table" rid="pone.0175944.t005">Table 5</xref>).</p>
<table-wrap id="pone.0175944.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175944.t005</object-id>
<label>Table 5</label> <caption><title>Performance of <italic>nvdF</italic><sub><italic>ST</italic></sub> in the short term (500 generations) with a single selective site.</title> <p>Selection was <italic>α</italic> = 600 and <italic>Nm</italic> = 50. Mean localization is given in distance (kb) from the real selective position.</p></caption>
<alternatives>
<graphic id="pone.0175944.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.t005" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">∑</th>
<th align="center">θ</th>
<th align="center">ρ</th>
<th align="center">%Power</th>
<th align="center">%FPR (<italic>γ</italic> = 5%)</th>
<th align="center"><italic>q</italic>-value</th>
<th align="center">Localization (kb)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">116</td>
<td align="center">60</td>
<td align="center">0</td>
<td align="center">47</td>
<td align="center">0</td>
<td align="char" char=".">0.0098</td>
<td align="center">±152</td>
</tr>
<tr>
<td align="center">180</td>
<td align="center">60</td>
<td align="center">4</td>
<td align="center">57</td>
<td align="center">0</td>
<td align="char" char=".">0.0042</td>
<td align="center">±123</td>
</tr>
<tr>
<td align="center">178</td>
<td align="center">60</td>
<td align="center">60</td>
<td align="center">31</td>
<td align="center">0.1</td>
<td align="char" char=".">0.0096</td>
<td align="center">±4</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t005fn001"><p>∑: Mean number of shared SNPs per Mb. θ: Mutation rate. ρ: Recombination rate. FPR: false positive rate. <italic>q</italic>-value: mean estimated <italic>q</italic>-value for the significant tests.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Concerning the EOS test, the power was below 10% with no false positives under this setting (see <xref ref-type="sec" rid="sec024">Discussion</xref>).</p>
</sec>
</sec>
<sec id="sec022">
<title>HapMap data</title>
<p>In order to check how the <italic>nvdF</italic><sub><italic>ST</italic></sub> method works under real data, we have analyzed phased haplotypes from human chromosome 2. This chromosome has been widely analyzed by several methods, so we can also compare the performance of <italic>nvdF</italic><sub><italic>ST</italic></sub> in this way. Concretely, we analyzed the chromosome 2 from northern and western European (CEU), East Asian (ASN: CHB + JPT), and Yoruba (YRI) human populations from Phase III of the International HapMap Project [<xref ref-type="bibr" rid="pone.0175944.ref021">21</xref>]. The data consisted in 116,430 SNPs in the unrelated samples downloaded from the project page (<ext-link ext-link-type="uri" xlink:href="http://hapmap.ncbi.nlm.nih.gov/" xlink:type="simple">http://hapmap.ncbi.nlm.nih.gov/</ext-link>, last accessed May 29, 2016). The original data files, and the command line options for the analysis with HacDivSel, jointly with the obtained output files, are available in the <xref ref-type="supplementary-material" rid="pone.0175944.s002">S1 HapMap</xref> file.</p>
<p>The HacDiveSel program automatically filters the data, using only SNPs shared between each pair of populations. Therefore we analyzed 86,483 SNPs under the ASN-CEU comparison; 79,272 under the ASC-YRI, and 74,582 for the CEU-YRI. We set the program to select the 0.1% highest <italic>nvd</italic> values within each assayed window size. For these candidates, we only considered those having a positive value under the sign test <xref ref-type="disp-formula" rid="pone.0175944.e009">Eq (5)</xref>, jointly with a significant <italic>p</italic>-value under the <italic>F</italic><sub>ST</sub> test.</p>
<p>In <xref ref-type="table" rid="pone.0175944.t006">Table 6</xref> (see also <xref ref-type="supplementary-material" rid="pone.0175944.s002">S1 HapMap</xref> file), we provide the genomic regions in which we found significant SNPs, and their corresponding genes within these regions. The estimated <italic>q</italic>-values were below 0.01 in every case. We found some of the highest <italic>nvd</italic> values, involving more than 40 SNPs, within the region 135–136 Mb in CEU-YRI comparison. This includes SNPs in a quite precise localization (135.78–135.83) of the lactase (LCT) gene jointly with some well-known linked candidates for recent selective sweeps as RAB3GAP1, ZRANB3, MCM6 and R3HDM1 genes [<xref ref-type="bibr" rid="pone.0175944.ref016">16</xref>, <xref ref-type="bibr" rid="pone.0175944.ref017">17</xref>, <xref ref-type="bibr" rid="pone.0175944.ref047">47</xref>]. The SNPs in this region showed high <italic>F</italic><sub>ST</sub> values (<xref ref-type="table" rid="pone.0175944.t006">Table 6</xref>).</p>
<table-wrap id="pone.0175944.t006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175944.t006</object-id>
<label>Table 6</label> <caption><title>Top significant divergent selection regions of the human chromosome 2 based on the <italic>nvdF</italic><sub><italic>ST</italic></sub> test for the 0.1% highest <italic>nvd</italic> values.</title></caption>
<alternatives>
<graphic id="pone.0175944.t006g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.t006" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Populations</th>
<th align="left"># significant SNPs</th>
<th align="left">Positions (Mb)</th>
<th align="left">F<sub>ST</sub></th>
<th align="left">Genes</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ASN-CEU</td>
<td align="left">67</td>
<td align="left"/>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left" rowspan="4"/>
<td align="left" rowspan="4"/>
<td align="left">15.49–15.54</td>
<td align="left">0.12–0.17</td>
<td align="left">NBAS</td>
</tr>
<tr>
<td align="left">27.95–28.1</td>
<td align="left">0.21</td>
<td align="left">RBKS, MRPL33, BRE</td>
</tr>
<tr>
<td align="left">63.6–63.98</td>
<td align="left">0.15–0.21</td>
<td align="left">WDPCP, UGP2, ACA59</td>
</tr>
<tr>
<td align="left">83.23–83.24</td>
<td align="left">0.16</td>
<td align="left">Intergenic</td>
</tr>
<tr>
<td align="left">ASN-YRI</td>
<td align="left">46</td>
<td align="left"/>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left" rowspan="7"/>
<td align="left" rowspan="7"/>
<td align="left">27.98–28.09</td>
<td align="left">0.25</td>
<td align="left">MRPL33, BRE</td>
</tr>
<tr>
<td align="left">56.89</td>
<td align="left">0.16</td>
<td align="left">intergenic</td>
</tr>
<tr>
<td align="left">135.69–135.72</td>
<td align="left">0.23–0.35</td>
<td align="left">ZRANB3</td>
</tr>
<tr>
<td align="left">203.4–203.9</td>
<td align="left">0.18–0.29</td>
<td align="left">ICA1L, WDR12, CARF, CYP20A1</td>
</tr>
<tr>
<td align="left">117.28–117.30</td>
<td align="left">0.22–0.36</td>
<td align="left">intergenic</td>
</tr>
<tr>
<td align="left">210.26</td>
<td align="left">0.19</td>
<td align="left">MAP2</td>
</tr>
<tr>
<td align="left">218.99–219.2</td>
<td align="left">0.29–0.53</td>
<td align="left">CTDSP, VIL1, AK302678, NHEJ1-XLF, SLC23A3, piR-39082, ABCB6, AK091345, ATG9A</td>
</tr>
<tr>
<td align="left">CEU-YRI</td>
<td align="left">116</td>
<td align="left"/>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left" rowspan="6"/>
<td align="left" rowspan="6"/>
<td align="left">15.52–15.53</td>
<td align="left">0.29</td>
<td align="left">NBAS</td>
</tr>
<tr>
<td align="left">27.9</td>
<td align="left">0.25</td>
<td align="left">RBKS-MRPL33</td>
</tr>
<tr>
<td align="left">122.02–122.04</td>
<td align="left">0.22–0.23</td>
<td align="left">CLASP1</td>
</tr>
<tr>
<td align="left">135.4–136.9</td>
<td align="left">0.29–0.63</td>
<td align="left">ACMSD, CCNT2-AS1, MAP3K19, RAB3GAP1, ZRANB3, LCT, MCM6, R3HDM1</td>
</tr>
<tr>
<td align="left">178.08</td>
<td align="left">0.41</td>
<td align="left">AGP</td>
</tr>
<tr>
<td align="left">218.8–219.4</td>
<td align="left">0.28–0.43</td>
<td align="left">ARPC2, LINC00608, VIL1, USP37, NHEJ1-XLF, RQCD1, SLC23A3, IL34, ZNF142, BCS1L, GLB1L, STK36, TTLL4, PTPRN, CYP27A1</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t006fn001"><p>The positions correspond to the minimum and maximum locations for each given region. The F<sub>ST</sub> range corresponds to the minimum and maximum F<sub>ST</sub> for each region.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>This result was expected as it is known that Yoruba does not show signature of selection at LCT while the signature is strong in CEU [<xref ref-type="bibr" rid="pone.0175944.ref016">16</xref>]. Recall however, that <italic>nvdF</italic><sub><italic>ST</italic></sub> has no required any a priori information on candidate sites but just computed the <italic>nvd</italic> statistic for every SNP, performed the sign and <italic>F</italic><sub>ST</sub> tests and finally return those from the highest 0.1% <italic>nvd</italic> values that passed the sign test and had a significant <italic>F</italic><sub>ST</sub> value.</p>
<p>Another strong signal also occurred for the 218.9–219.4 region which includes genes previously reported under divergent selection as TTLL4 [<xref ref-type="bibr" rid="pone.0175944.ref017">17</xref>], as well as genes related to growth and immune maturation as NHEJ1 [<xref ref-type="bibr" rid="pone.0175944.ref048">48</xref>]. This region also presents some significant signal in the ASN-YRI comparison. Also within this region, and still under the CEU-YRI comparison, we detected the IL34 gene, which has been previously reported as giving strong signature of selection in the YRI population [<xref ref-type="bibr" rid="pone.0175944.ref049">49</xref>]. Another interesting signal in this region is at the SNP rs613539 which corresponds to SLC23A3 gene, which has been claimed to be a candidate for schizophrenia susceptibility in the Japanese population [<xref ref-type="bibr" rid="pone.0175944.ref050">50</xref>]. This SNP has been significant in CEU-YRI and ASN-YRI comparisons but not in the ASN-CEU one (<xref ref-type="table" rid="pone.0175944.t006">Table 6</xref> and <xref ref-type="supplementary-material" rid="pone.0175944.s002">S1 HapMap</xref> file).</p>
<p>Two more regions, including NBAS and CLASP1 genes, were detected under the CEU-YRI comparison. NBAS has also been detected in the ASN-CEU pair (see below). The CLASP1 gene is close to GLI2, already reported as a top region by the XP-CLR method [<xref ref-type="bibr" rid="pone.0175944.ref051">51</xref>]. In the ASN-YRI comparison, the region detected was 203.4–203.9, which is close to the NIF3L1 gene and includes a SNP previously reported under non-synonymous differentiation in these populations [<xref ref-type="bibr" rid="pone.0175944.ref017">17</xref>].</p>
<p>Finally, the significant <italic>nvd</italic> candidates with lowest <italic>F</italic><sub>ST</sub> values, correspond to the regions detected in the CEU-ASN comparison (this case also involves a lower number of regions). In this comparison, the highest <italic>nvd</italic> occurred in the NBAS region that had also the strongest signal in the CEU-YRI pair. Another interesting region is the 27.9–28.1 which includes the BRE gen (<xref ref-type="table" rid="pone.0175944.t006">Table 6</xref>).</p>
</sec>
<sec id="sec023">
<title><italic>Littorina saxatilis</italic> data</title>
<p>To check the performance of the EOS test with real data, we provide an example with the aim of checking if even under its conservativeness is able of detecting some outliers on an already published dataset from the marine gastropod <italic>L</italic>. <italic>saxatilis</italic>. Recall that under the wide variety of scenarios assayed, EOS had a very low false positive rate. Thus the detected outliers, if any, may be good candidates, or at least good indicators, of the signal of divergent selection.</p>
<p>The rough periwinkle (<italic>Littorina saxatilis</italic>) is a marine gastropod mollusk that represents an interesting system for studying adaptive divergence and parallel speciation at different spatial scales. In Europe, <italic>L</italic>. <italic>saxatilis</italic> has adapted to different shore habitats resulting in both an exposed-to-wave, and other non-exposed (but crab-accessible) ecotype. The crab- accessible ecotype has large thick shells while the exposed-to-wave ecotype consists of smaller snails with thin shells and a larger shell aperture. Several experimental studies have shown that these ecotypes have been able of evolving local adaptation in the face of gene flow even at small spatial scales [<xref ref-type="bibr" rid="pone.0175944.ref052">52</xref>].</p>
<p>Ravinet <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0175944.ref053">53</xref>] have recently published a study where they used RAD loci as dominant markers to quantify shared genomic divergence amongst <italic>L</italic>. <italic>saxatilis</italic> ecotype pairs (wave vs crab) on three close islands on the Skagerrak coast of Sweden. These islands are connected by weak gene flow. In their outlier analysis, they filtered the data for sex-linked loci and null alleles. The filtering was applied for each island separately.</p>
<p>We applied the EOS test to analyze the separate-island filtered loci from Ravinet <italic>et al</italic>. Loci with null allele frequency equal or higher than 0.5 were discarded. We also discarded those polymorphisms not shared between ecotypes from the same location. Additionally, we required a minimum frequency allele of 4 per metapopulation sample size. Thus, we have excluded about 10–20% of the original individual-island filtered loci. The results of the between ecotypes outlier analysis using EOS are shown in <xref ref-type="table" rid="pone.0175944.t007">Table 7</xref>. Results show that the number of outliers detected as significant in this study is much less than in the original study. We find a total of 48 outliers in the three islands while the number originally found was 406 (RAD loci in Table 2 of [<xref ref-type="bibr" rid="pone.0175944.ref053">53</xref>]). This is not surprising given the conservative nature and low false positive rate of EOS. However, note that we find a 2% (1/48) of SNPs shared by all islands which is quite similar to the 2.2% (9/406) found in the original study. Considering the islands by pairs, Jutholmen and Ramsö share 2 outliers, Saltö has no outlier in common with Jutholmen but it shared 2 with Ramsö.</p>
<table-wrap id="pone.0175944.t007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175944.t007</object-id>
<label>Table 7</label> <caption><title>Outliers detected after EOS analysis of the individual-island filtered loci from <italic>L</italic>. <italic>saxatilis</italic> data.</title> <p>Numbers in parentheses refer to the results in the original analysis [<xref ref-type="bibr" rid="pone.0175944.ref053">53</xref>].</p></caption>
<alternatives>
<graphic id="pone.0175944.t007g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.t007" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Island</th>
<th align="center">Unique</th>
<th align="center">Only with Jutholmen</th>
<th align="center">Only with Ramsö</th>
<th align="center">Only with Saltö</th>
<th align="center">Shared all</th>
<th align="center">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Jutholmen</td>
<td align="center">7 (59)</td>
<td align="center">__</td>
<td align="center">2 (13)</td>
<td align="center">0 (16)</td>
<td align="center">1 (9)</td>
<td align="center">10 (97)</td>
</tr>
<tr>
<td align="left">Ramsö</td>
<td align="center">24 (86)</td>
<td align="center">2 (13)</td>
<td align="center">__</td>
<td align="center">2 (21)</td>
<td align="center">1 (9)</td>
<td align="center">29 (129)</td>
</tr>
<tr>
<td align="left">Saltö</td>
<td align="center">6 (134)</td>
<td align="center">0 (16)</td>
<td align="center">2 (21)</td>
<td align="center">__</td>
<td align="center">1 (9)</td>
<td align="center">9 (180)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>For the outliers detected by EOS, the mean <italic>F</italic><sub>ST</sub> between ecotypes ranges between 0.48–0.6 (<xref ref-type="table" rid="pone.0175944.t008">Table 8</xref>). The <italic>q</italic>-values are high (0.51–0.76) although we already know by the simulations that this may indicate linkage between the markers, more than a real false positive rate (see also [<xref ref-type="bibr" rid="pone.0175944.ref011">11</xref>]).</p>
<table-wrap id="pone.0175944.t008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0175944.t008</object-id>
<label>Table 8</label> <caption><title>Summary of EOS analysis for the between ecotypes <italic>L</italic>. <italic>saxatilis</italic> data [<xref ref-type="bibr" rid="pone.0175944.ref053">53</xref>].</title></caption>
<alternatives>
<graphic id="pone.0175944.t008g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.t008" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Island</th>
<th align="center">Non-outliers</th>
<th align="center">Outliers not in EOS</th>
<th align="center">EOS</th>
<th align="center"><italic>F</italic><sub>ST</sub></th>
<th align="center"><italic>F</italic><sub>ST_EOS</sub></th>
<th align="center"><italic>pval</italic><sub>EOS</sub></th>
<th align="center"><italic>qval</italic><sub>EOS</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Jutholmen</td>
<td align="center">4564</td>
<td align="center">112</td>
<td align="center">10</td>
<td align="char" char=".">0.045</td>
<td align="char" char=".">0.48</td>
<td align="char" char=".">0.002</td>
<td align="char" char=".">0.51</td>
</tr>
<tr>
<td align="left">Ramsö</td>
<td align="center">4602</td>
<td align="center">82</td>
<td align="center">29</td>
<td align="char" char=".">0.064</td>
<td align="char" char=".">0.53</td>
<td align="char" char=".">0.005</td>
<td align="char" char=".">0.63</td>
</tr>
<tr>
<td align="left">Saltö</td>
<td align="center">4632</td>
<td align="center">51</td>
<td align="center">9</td>
<td align="char" char=".">0.060</td>
<td align="char" char=".">0.60</td>
<td align="char" char=".">0.002</td>
<td align="char" char=".">0.76</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t008fn001"><p><italic>F</italic><sub>ST</sub>: Mean <italic>F</italic><sub>ST</sub> for the analyzed loci. <italic>F</italic><sub>ST_EOS</sub>: Mean <italic>F</italic><sub>ST</sub> for the loci included in the extreme outlier set. <italic>pval</italic><sub>EOS</sub>: Mean <italic>p</italic>-values across the loci included in the extreme outlier set. <italic>qval</italic><sub>EOS</sub>: Mean <italic>q</italic>-values across the loci included in the extreme outlier set.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
</sec>
<sec id="sec024" sec-type="conclusions">
<title>Discussion</title>
<p>The aim of this study was to develop two complementary strategies, haplotype-based and outlier-based, for the detection of divergent selection in pairs of populations connected by migration. Because high rate of false positives is a known concern of outlier-based methods [<xref ref-type="bibr" rid="pone.0175944.ref009">9</xref>–<xref ref-type="bibr" rid="pone.0175944.ref011">11</xref>], the proposed methodology was especially designed to minimize the false positive rate. Additionally, both methods should be useful for non-model species and therefore, it should not be necessary either to have a priori functional information on candidate regions, or to perform neutral simulations to obtain critical cut-off values.</p>
<p>We have shown that <italic>nvdF</italic><sub><italic>ST</italic></sub>, which combines haplotype-based and <italic>F</italic><sub>ST</sub>-differentiation information, is a powerful strategy for detecting divergent selection. The method has proven to work well even when the phasing accuracy is not perfect. However, the <italic>nvdF</italic><sub><italic>ST</italic></sub> algorithm does not perform well when the whole set of markers segregates independently. To deal with the latter, a second method was proposed based on the idea that the outliers caused by the effect of divergent selection would cluster apart from those caused by different demography issues. This extreme outlier set test EOS, was intended to be conservative because of the aforementioned tendency of outlier-based methods to produce false positives. Under the simulated scenarios, the EOS test behaves well when markers are independent or under weak linkage, reaching powers between 60–90% while maintaining false positive rates below the nominal level.</p>
<sec id="sec025">
<title>Polygenic architecture</title>
<p>In general, the <italic>F</italic><sub>ST</sub>-based methods cannot detect selection in polygenic scenarios [<xref ref-type="bibr" rid="pone.0175944.ref008">8</xref>, <xref ref-type="bibr" rid="pone.0175944.ref011">11</xref>] because these tests are specifically designed for finding <italic>F</italic><sub>ST</sub> values larger than average, which are difficult to discover if the frequency differences are slight for the polygenic loci, or if the overall <italic>F</italic><sub>ST</sub> is high. On the contrary, the <italic>nvdF</italic><sub><italic>ST</italic></sub> performs even better under such scenario. The explanation for this good performance is that the distributed selective signal facilitates the discovery of the corresponding haplotype patterns of divergent selection. These patterns are coupled with the occurrence of high frequency at the target site in one population and low in another. The good performance of <italic>nvdF</italic><sub><italic>ST</italic></sub> under the polygenic setting, therefore, occurs because a) we select concrete SNPs because of their selective pattern and b) this coincides with higher <italic>F</italic><sub>ST</sub> at these SNPs.</p>
</sec>
<sec id="sec026">
<title>Position effect, positive predictive value and FDR by site</title>
<p>Besides the detection of the signal of selection, we have also inferred the location of the selective site. It has been shown that under <italic>nvdF</italic><sub><italic>ST</italic></sub>, the localization is better when the selective site is at the center of the chromosome. The ability of localizing the selective position is still a pending issue for many of the selection detection methods. There is also plenty of room for improvement under the <italic>nvdF</italic><sub><italic>ST</italic></sub> and EOS methods in this regard, for instance by exploring the relationship between recombination and the window sizes that yield the highest scores. Indeed, the interplay among divergent selection, recombination, drift and migration should be considered for further improving the efficiency of the methods.</p>
<p>Concerning true and false positive rate measures, we have given a) the true positive rate (power) in terms of the percentage of runs in which selection (at any site) was detected from simulated selective scenarios and b) the false positive rate as the percentage of runs in which selection (at any site) was detected from simulated neutral scenarios.</p>
<p>The error rate can also be measured by the number of sites falsely detected as selective. First, it should be clarified that under the neutral scenario, we always considered a false positive when any site within the chromosome has been signaled as selective. Thus, when we are saying that FPR is below 5%, in more than 95% of the neutral files no single site was detected as selective, and so the error rate by site is 0. Therefore, we can consider the number of sites advocated as selective in those few runs in which neutrality was falsely rejected. In the case of the EOS test, this number was just 1 single site per Mb when markers are independent or 1 to 4 when they are linked.</p>
<p>In the case of <italic>nvdF</italic><sub><italic>ST</italic></sub>, the situation is different just because various window sizes are assayed and a number <italic>k</italic> of candidates is considered, so that the maximum number of false positives by genome can be at most <italic>w</italic> × <italic>k</italic>, where <italic>w</italic> is the number of different window sizes. However, the number of false positives would also be dependent on the recombination rate. In most cases, we have assayed 2–4 window sizes and just 1 candidate, and the average number of falsely detected sites in the neutral files was close to 1.</p>
<p>When a higher number of candidates (<italic>k</italic>&gt;1) was studied the percentage of false positives was always less than γ × <italic>k</italic> (γ = 0.05). For example, in the extreme case of inspecting the 100% of neutral sites from an ultra-high density linkage map (about 60,000 candidates with ρ = 120), we found 1–2% false positives independently of the window size. For the selective scenarios, we are also interested in the per site comparison, i.e. the proportion of detected sites that lies at, or close to, the true selective position. The linkage relationship will depend on the recombination rate and so we would measure the distance in centimorgans (cM). Therefore, if we consider a given position as being true only when it lies at distance of less than <italic>t</italic> cM from the real position, then the positive predictive value (PPV) can be measured as PPV = #(detected sites at distance ≤ <italic>t</italic>) / # detected sites. Similarly, the false discovery rate per site is, FDR<sub>l</sub> = 1 -PPV.</p>
<p>Thus, given the positions obtained in our simulations, when we set <italic>t</italic> = 0.15 cM the PPV is in most of the cases 100%, i.e. all detected positions lie within the acceptance region, except for some cases under the highest recombination rate (ρ = 60). In the latter cases under the <italic>nvdF</italic><sub><italic>ST</italic></sub> test, the PPV decreases to 85–95% with a worst case of 70% when the selective site is located at the very extreme of the chromosome. Therefore, in these latter cases (<italic>nvdF</italic><sub><italic>ST</italic></sub>; ρ = 60), when claiming that selection has been detected, we are assuming that 5–15% of the times the detected position could be far away from 0.15 cM. However, If we assume as correct any position within 1 cM distance from the true one (<italic>t</italic> = 1), then the per-site FDR<sub>l</sub> is virtually zero in every studied case. The latter means that any detected site lies closer than 1 map unit from the real position.</p>
</sec>
<sec id="sec027">
<title>High migration scenario</title>
<p>It is important to note that under high migration, <italic>nvdF</italic><sub><italic>ST</italic></sub> maintains a reasonable power. However, the power diminishes with the highest recombination rate. This may occur due to the combined effect of gene flow and recombination, that generates intermediate HAC mean values <italic>m</italic><sub>1</sub> and <italic>m</italic><sub>2</sub> and similar variances. Indeed, for a given selection intensity, the higher the <italic>Nm</italic> requires tighter linkage for the establishment of divergent alleles [<xref ref-type="bibr" rid="pone.0175944.ref054">54</xref>].</p>
<p>In the case of the EOS test, there is an obvious tradeoff between the stringency of the cutoff point for the outlier set and the migration rate. The cutoff depends on the <italic>F</italic><sub>ST</sub> upper-bound which is a function of the number of populations, the sample size and the minimum allele frequency. However, this does not take into account the effect of migration. A possible solution to improve the efficiency of EOS under high migration would be to update the cutoff point as a function of the migration rate.</p>
</sec>
<sec id="sec028">
<title>HapMap data</title>
<p>The applicability of the <italic>nvdF</italic><sub><italic>ST</italic></sub> method to real data was evaluated by analyzing the human chromosome 2. For each pair of populations, the full set of SNPs in the phased haplotypes was directly analyzed without any assumption about specific candidate regions or reference SNPs.</p>
<p>Our method successfully detected the lactase persistence region that is known to expand over more than 1 Mb in chromosome 2 of European populations [<xref ref-type="bibr" rid="pone.0175944.ref047">47</xref>, <xref ref-type="bibr" rid="pone.0175944.ref055">55</xref>]. In addition, we detected other regions previously reported as under ongoing selective sweeps in human populations (see <xref ref-type="table" rid="pone.0175944.t006">Table 6</xref> and <xref ref-type="supplementary-material" rid="pone.0175944.s002">S1 HapMap</xref> file), together with another that has not been explicitly reported from the HapMap comparisons. Worth mentioning is the SLC23A3 gene that has been associated to schizophrenia susceptibility in the Japanese population [<xref ref-type="bibr" rid="pone.0175944.ref050">50</xref>] and that we found to be significant both in ASN-YRI and CEU-YRI comparisons.</p>
<p>We also found as selected other regions not previously reported. For example, in the ASN-CEU comparison, 20 SNPs had high and significant <italic>nvd</italic> value within the NBAS gene. Mutations in this gene has been associated to short stature and different multisystem disorders [<xref ref-type="bibr" rid="pone.0175944.ref056">56</xref>, <xref ref-type="bibr" rid="pone.0175944.ref057">57</xref>]. Again in the ASN-CEU comparison, the BRE gene showed quite high <italic>nvd</italic> values. This gene encodes a component of the BRCA1-A complex. These results illustrate how the <italic>nvdF</italic><sub><italic>ST</italic></sub> method can be used in exploratory studies to detect locally adapted polymorphisms that could be interesting candidates for association studies.</p>
</sec>
<sec id="sec029">
<title><italic>Littorina saxatilis</italic> data</title>
<p>The natural systems where local adaptation occurs can be of great complexity [<xref ref-type="bibr" rid="pone.0175944.ref058">58</xref>]. Local adaptation may occur most likely due to alleles with large effect but also under a polygenic architecture [<xref ref-type="bibr" rid="pone.0175944.ref058">58</xref>, <xref ref-type="bibr" rid="pone.0175944.ref059">59</xref>]. In addition, the geographic structure and the migration-selection balance can generate complex patterns of the distribution of genetic variation [<xref ref-type="bibr" rid="pone.0175944.ref060">60</xref>]. The <italic>L</italic>. <italic>saxatilis</italic> ecotypes are an especially interesting system to study local adaptation in presence of gene flow [<xref ref-type="bibr" rid="pone.0175944.ref061">61</xref>]. This system has an exceptional level of replication at different extents, such as country, localities within country, and the micro-geographical level of the ecotypes. In the case of the Swedish populations, the pattern of differentiation can be separated in factors such as, localities and habitat variation among islands—that may be caused by genetic drift—and variation between habitats within localities—that may be caused by divergent selection [<xref ref-type="bibr" rid="pone.0175944.ref061">61</xref>]. There are also different mechanisms by which parallel adaptation may occur, resulting in different predictions about the proportion of shared adaptive variation among localities.</p>
<p>Regarding the shared genomic divergence of the <italic>L</italic>. <italic>saxatilis</italic> system in Swedish populations, it seems to be a small proportion of the total genomic divergence [<xref ref-type="bibr" rid="pone.0175944.ref053">53</xref>, <xref ref-type="bibr" rid="pone.0175944.ref061">61</xref>, <xref ref-type="bibr" rid="pone.0175944.ref062">62</xref>]. That is, the majority of the genomic variation linked to the evolution of ecotypes is not shared between the studied islands. The EOS analysis of the Ravinet <italic>et al</italic>. data seems to support this finding. At the same time, we identify far fewer outliers, being Saltö—which is closer to the mainland—the island with the lowest number. However, this result is the opposite of the result in Ravinet’s study, where Saltö had the highest number of outliers. This difference can be caused by an excess of false positives in the original study, though we cannot rule out that our findings can be an artefact due to the conservativeness of EOS.</p>
<p>As a final remark, the strategy used in <italic>nvdF</italic><sub><italic>ST</italic></sub> is in line with the suggestion of combining multiple signals from different tests as a way of improving the power/false positive rate relationships for the selection detection methods [<xref ref-type="bibr" rid="pone.0175944.ref018">18</xref>, <xref ref-type="bibr" rid="pone.0175944.ref063">63</xref>, <xref ref-type="bibr" rid="pone.0175944.ref064">64</xref>]. Accordingly, the <italic>nvdF</italic><sub><italic>ST</italic></sub> test does this. It combines haplotype and population differentiation information and may be a helpful tool to explore patterns of divergent selection when approximate knowledge of the haplotype phase is available. Alternatively, the EOS method is a conservative outlier test useful when the full set of SNPs is unlinked or under weak linkage. Both strategies can be applied without the need of performing neutral simulations and have a low false positive rate.</p>
</sec>
</sec>
<sec id="sec030">
<title>Supporting information</title>
<supplementary-material id="pone.0175944.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Description: Supplementary Appendix (includes Figs A, B and C; and Tables A and B).</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0175944.s002" mimetype="application/x-rar-compressed" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.s002" xlink:type="simple">
<label>S1 HapMap</label>
<caption>
<title>Description: The original data files from HapMap as well the command line options for the analysis with HacDivSel, jointly with the obtained output files.</title>
<p>(RAR)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0175944.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.s003" xlink:type="simple">
<label>S1 Program Manual</label>
<caption>
<title>HacDivSel_program_manual.</title>
<p>Description: Complete manual for the program that implements the methods described in the paper.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0175944.s004" mimetype="application/x-rar-compressed" position="float" xlink:href="info:doi/10.1371/journal.pone.0175944.s004" xlink:type="simple">
<label>S1 Sim</label>
<caption>
<title>Description: Input files for the GenomePop simulations and the command lines for their analysis with HacDivSel.</title>
<p>(RAR)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>I would like to thank E. Rolán-Alvarez, C. Canchaya and Auriel Sumner-Hempel for useful comments on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0175944.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Haigh</surname> <given-names>J</given-names></name>. <article-title>The hitch-hiking effect of a favourable gene</article-title>. <source>Genetical research</source>. <year>1974</year>;<volume>23</volume>(<issue>01</issue>):<fpage>23</fpage>–<lpage>35</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nielsen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Williamson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hubisz</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Bustamante</surname> <given-names>C</given-names></name>. <article-title>Genomic scans for selective sweeps using SNP data</article-title>. <source>Genome Res</source>. <year>2005</year>;<volume>15</volume>(<issue>11</issue>):<fpage>1566</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.4252305" xlink:type="simple">10.1101/gr.4252305</ext-link></comment> <object-id pub-id-type="pmid">16251466</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Crisci</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Poh</surname> <given-names>Y-P</given-names></name>, <name name-style="western"><surname>Mahajan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>JD</given-names></name>. <article-title>The Impact of Equilibrium Assumptions on Tests of Selection</article-title>. <source>Frontiers in Genetics</source>. <year>2013</year>;<volume>4</volume>.</mixed-citation></ref>
<ref id="pone.0175944.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jensen</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Foll</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bernatchez</surname> <given-names>L</given-names></name>. <article-title>The past, present and future of genomic scans for selection</article-title>. <source>Molecular Ecology</source>. <year>2016</year>;<volume>25</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/mec.13493" xlink:type="simple">10.1111/mec.13493</ext-link></comment> <object-id pub-id-type="pmid">26745554</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lewontin</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Krakauer</surname> <given-names>J</given-names></name>. <article-title>Distribution of Gene Frequency as a Test of Theory of Selective Neutrality of Polymorphisms</article-title>. <source>Genetics</source>. <year>1973</year>;<volume>74</volume>(<issue>1</issue>):<fpage>175</fpage>–<lpage>95</lpage>. <object-id pub-id-type="pmid">4711903</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Whitlock</surname> <given-names>M, C.</given-names></name>, <name name-style="western"><surname>Lotterhos</surname> <given-names>K, E.</given-names></name>. <article-title>Reliable Detection of Loci Responsible for Local Adaptation: Inference of a Null Model through Trimming the Distribution of FST</article-title>. <source>The American Naturalist</source>. <year>2015</year>;<volume>186</volume>(<issue>S1</issue>):<fpage>S24</fpage>–<lpage>S36</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Perez-Figueroa</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Garcia-Pereira</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Saura</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rolan-Alvarez</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Caballero</surname> <given-names>A</given-names></name>. <article-title>Comparing three different methods to detect selective loci using dominant markers</article-title>. <source>Journal of Evolutionary Biology</source>. <year>2010</year>;<volume>23</volume>(<issue>10</issue>):<fpage>2267</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1420-9101.2010.02093.x" xlink:type="simple">10.1111/j.1420-9101.2010.02093.x</ext-link></comment> <object-id pub-id-type="pmid">20796133</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bierne</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Roze</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Welch</surname> <given-names>JJ</given-names></name>. <article-title>Pervasive selection or is it…? why are FST outliers sometimes so frequent?</article-title> <source>Molecular Ecology</source>. <year>2013</year>;<volume>22</volume>(<issue>8</issue>):<fpage>2061</fpage>–<lpage>4</lpage>. <object-id pub-id-type="pmid">23671920</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>De Mita</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Thuillet</surname> <given-names>A-C</given-names></name>, <name name-style="western"><surname>Gay</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ahmadi</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Manel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ronfort</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Detecting selection along environmental gradients: analysis of eight methods and their effectiveness for outbreeding and selfing populations</article-title>. <source>Molecular Ecology</source>. <year>2013</year>;<volume>22</volume>(<issue>5</issue>):<fpage>1383</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/mec.12182" xlink:type="simple">10.1111/mec.12182</ext-link></comment> <object-id pub-id-type="pmid">23294205</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lotterhos</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Whitlock</surname> <given-names>MC</given-names></name>. <article-title>Evaluation of demographic history and neutral parameterization on the performance of FST outlier tests</article-title>. <source>Molecular Ecology</source>. <year>2014</year>;<volume>23</volume>(<issue>9</issue>):<fpage>2178</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/mec.12725" xlink:type="simple">10.1111/mec.12725</ext-link></comment> <object-id pub-id-type="pmid">24655127</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>De Villemereuil</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Frichot</surname> <given-names>É</given-names></name>, <name name-style="western"><surname>Bazin</surname> <given-names>É</given-names></name>, <name name-style="western"><surname>François</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Gaggiotti</surname> <given-names>OE</given-names></name>. <article-title>Genome scan methods against more complex models: when and how much should we trust them?</article-title> <source>Molecular Ecology</source>. <year>2014</year>;<volume>23</volume>(<issue>8</issue>):<fpage>2006</fpage>–<lpage>19</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/mec.12705" xlink:type="simple">10.1111/mec.12705</ext-link></comment> <object-id pub-id-type="pmid">24611968</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ellegren</surname> <given-names>H</given-names></name>. <article-title>Genome sequencing and population genomics in non-model organisms</article-title>. <source>Trends in Ecology &amp; Evolution</source>. <year>2014</year>;<volume>29</volume>(<issue>1</issue>):<fpage>51</fpage>–<lpage>63</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Crisci</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Poh</surname> <given-names>Y-P</given-names></name>, <name name-style="western"><surname>Bean</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Simkin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>JD</given-names></name>. <article-title>Recent Progress in Polymorphism-Based Population Genetic Inference</article-title>. <source>Journal of Heredity</source>. <year>2012</year>.</mixed-citation></ref>
<ref id="pone.0175944.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>R</given-names></name>. <article-title>Linkage disequilibrium as a signature of selective sweeps</article-title>. <source>Genetics</source>. <year>2004</year>;<volume>167</volume>(<issue>3</issue>):<fpage>1513</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.103.025387" xlink:type="simple">10.1534/genetics.103.025387</ext-link></comment> <object-id pub-id-type="pmid">15280259</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pavlidis</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>W</given-names></name>. <article-title>Searching for footprints of positive selection in whole-genome SNP data from nonequilibrium populations</article-title>. <source>Genetics</source>. <year>2010</year>;<volume>185</volume>(<issue>3</issue>):<fpage>907</fpage>–<lpage>22</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.110.116459" xlink:type="simple">10.1534/genetics.110.116459</ext-link></comment> <object-id pub-id-type="pmid">20407129</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Voight</surname> <given-names>BF</given-names></name>, <name name-style="western"><surname>Kudaravalli</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wen</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Pritchard</surname> <given-names>JK</given-names></name>. <article-title>A map of recent positive selection in the human genome</article-title>. <source>PLoS Biol</source>. <year>2006</year>;<volume>4</volume>(<issue>3</issue>):<fpage>e72</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0040072" xlink:type="simple">10.1371/journal.pbio.0040072</ext-link></comment> <object-id pub-id-type="pmid">16494531</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sabeti</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Varilly</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Fry</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lohmueller</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hostetter</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cotsapas</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide detection and characterization of positive selection in human populations</article-title>. <source>Nature</source>. <year>2007</year>;<volume>449</volume>(<issue>7164</issue>):<fpage>913</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06250" xlink:type="simple">10.1038/nature06250</ext-link></comment> <object-id pub-id-type="pmid">17943131</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vatsiou</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Bazin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gaggiotti</surname> <given-names>OE</given-names></name>. <article-title>Detection of selective sweeps in structured populations: a comparison of recent methods</article-title>. <source>Molecular Ecology</source>. <year>2016</year>;<volume>25</volume>(<issue>1</issue>):<fpage>89</fpage>–<lpage>103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/mec.13360" xlink:type="simple">10.1111/mec.13360</ext-link></comment> <object-id pub-id-type="pmid">26314386</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rivas</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Dominguez-Garcia</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Carvajal-Rodriguez</surname> <given-names>A</given-names></name>. <article-title>Detecting the Genomic Signature of Divergent Selection in Presence of Gene Flow</article-title>. <source>Current Genomics</source>. <year>2015</year>;<volume>16</volume>(<issue>3</issue>):<fpage>203</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2174/1389202916666150313230943" xlink:type="simple">10.2174/1389202916666150313230943</ext-link></comment> <object-id pub-id-type="pmid">26069460</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yeaman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Otto</surname> <given-names>SP</given-names></name>. <article-title>Establishment and Maintenance of Adaptive Genetic Divergence under Migration, Selection, and Drift</article-title>. <source>Evolution</source>. <year>2011</year>;<volume>65</volume>(<issue>7</issue>):<fpage>2123</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1558-5646.2011.01277.x" xlink:type="simple">10.1111/j.1558-5646.2011.01277.x</ext-link></comment> <object-id pub-id-type="pmid">21729066</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><collab>Consortium TIH</collab>. <article-title>Integrating common and rare genetic variation in diverse human populations</article-title>. <source>Nature</source>. <year>2010</year>;<volume>467</volume>(<issue>7311</issue>):<fpage>52</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09298" xlink:type="simple">10.1038/nature09298</ext-link></comment> <object-id pub-id-type="pmid">20811451</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hussin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nadeau</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lefebvre</surname> <given-names>J-F</given-names></name>, <name name-style="western"><surname>Labuda</surname> <given-names>D</given-names></name>. <article-title>Haplotype allelic classes for detecting ongoing positive selection</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>(<issue>1</issue>):<fpage>65</fpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ferretti</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ramos-Onsins</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Pérez-Enciso</surname> <given-names>M</given-names></name>. <article-title>Population genomics from pool sequencing</article-title>. <source>Molecular Ecology</source>. <year>2013</year>;<volume>22</volume>(<issue>22</issue>):<fpage>5561</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/mec.12522" xlink:type="simple">10.1111/mec.12522</ext-link></comment> <object-id pub-id-type="pmid">24102736</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref024"><label>24</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Crow</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Kimura</surname> <given-names>M</given-names></name>. <source>An Introduction to Population Genetics Theory</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Harper &amp; Row</publisher-name>; <year>1970</year>.</mixed-citation></ref>
<ref id="pone.0175944.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hey</surname> <given-names>J</given-names></name>. <article-title>Recent advances in assessing gene flow between diverging populations and species</article-title>. <source>Current Opinion in Genetics &amp; Development</source>. <year>2006</year>;<volume>16</volume>(<issue>6</issue>):<fpage>592</fpage>–<lpage>6</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sousa</surname> <given-names>VC</given-names></name>, <name name-style="western"><surname>Carneiro</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ferrand</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hey</surname> <given-names>J</given-names></name>. <article-title>Identifying Loci Under Selection Against Gene Flow in Isolation-with-Migration Models</article-title>. <source>Genetics</source>. <year>2013</year>;<volume>194</volume>(<issue>1</issue>):<fpage>211</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.113.149211" xlink:type="simple">10.1534/genetics.113.149211</ext-link></comment> <object-id pub-id-type="pmid">23457232</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sidak</surname> <given-names>Z</given-names></name>. <article-title>Rectangular Confidence Regions for the Means of Multivariate Normal Distributions</article-title>. <source>Journal of the American Statistical Association</source>. <year>1967</year>;<volume>62</volume>(<issue>318</issue>):<fpage>626</fpage>–<lpage>33</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cheverud</surname> <given-names>JM</given-names></name>. <article-title>A simple correction for multiple comparisons in interval mapping genome scans</article-title>. <source>Heredity</source>. <year>2001</year>;<volume>87</volume>(<issue>1</issue>):<fpage>52</fpage>–<lpage>8</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lewontin</surname> <given-names>RC</given-names></name>. <article-title>On measures of gametic disequilibrium</article-title>. <source>Genetics</source>. <year>1988</year>;<volume>120</volume>:<fpage>849</fpage>–<lpage>52</lpage>. <object-id pub-id-type="pmid">3224810</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Devlin</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Risch</surname> <given-names>N</given-names></name>. <article-title>A Comparison of Linkage Disequilibrium Measures for Fine-Scale Mapping</article-title>. <source>Genomics</source>. <year>1995</year>;<volume>29</volume>(<issue>2</issue>):<fpage>311</fpage>–<lpage>22</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/geno.1995.9003" xlink:type="simple">10.1006/geno.1995.9003</ext-link></comment> <object-id pub-id-type="pmid">8666377</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Storey</surname> <given-names>J</given-names></name>. <article-title>The positive false discovery rate: A Bayesian interpretation and the q-value</article-title>. <source>The Annals of Statistics</source>. <year>2003</year>;<volume>31</volume>(<issue>6</issue>):<fpage>2013</fpage>–<lpage>35</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carvajal-Rodriguez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>de Una-Alvarez</surname> <given-names>J</given-names></name>. <article-title>Assessing significance in high-throughput experiments by sequential goodness of fit and q-value estimation</article-title>. <source>PLoS One</source>. <year>2011</year>;<volume>6</volume>(<issue>9</issue>):<fpage>e24700</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0024700" xlink:type="simple">10.1371/journal.pone.0024700</ext-link></comment> <object-id pub-id-type="pmid">21931819</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nei</surname> <given-names>M</given-names></name>. <article-title>Analysis of gene diversity in subdivided populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1973</year>;<volume>70</volume>(<issue>12</issue>):<fpage>3321</fpage>–<lpage>3</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref034"><label>34</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Tukey</surname> <given-names>JW</given-names></name>. <source>Exploratory data analysis</source>. <publisher-loc>Reading, Mass</publisher-loc>.,: <publisher-name>Addison-Wesley</publisher-name>; <year>1977</year>. <volume>XVI</volume>, <fpage>688</fpage> s. p.</mixed-citation></ref>
<ref id="pone.0175944.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vattani</surname> <given-names>A</given-names></name>. <article-title>k-means Requires Exponentially Many Iterations Even in the Plane</article-title>. <source>Discrete &amp; Computational Geometry</source>. <year>2011</year>;<volume>45</volume>(<issue>4</issue>):<fpage>596</fpage>–<lpage>616</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schubert</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Zimek</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kriegel</surname> <given-names>H-P</given-names></name>. <article-title>Local outlier detection reconsidered: a generalized view on locality with applications to spatial, video, and network outlier detection</article-title>. <source>Data Mining and Knowledge Discovery</source>. <year>2012</year>;<volume>28</volume>(<issue>1</issue>):<fpage>190</fpage>–<lpage>237</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dharmadhikari</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Joag-Dev</surname> <given-names>K</given-names></name>. <article-title>Upper bounds for the variances of certain random variables</article-title>. <source>Communications in statistics-theory and methods</source>. <year>1989</year>;<volume>18</volume>(<issue>9</issue>):<fpage>3235</fpage>–<lpage>47</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hudson</surname> <given-names>RR</given-names></name>. <article-title>Generating samples under a Wright-Fisher neutral model of genetic variation</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>2</issue>):<fpage>337</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">11847089</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Purcell</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Neale</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Todd-Brown</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ferreira</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Bender</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>. <source>Am J Hum Genet</source>. <year>2007</year>;<volume>81</volume>(<issue>3</issue>):<fpage>559</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/519795" xlink:type="simple">10.1086/519795</ext-link></comment> <object-id pub-id-type="pmid">17701901</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rousset</surname> <given-names>F</given-names></name>. <article-title>genepop'007: a complete re-implementation of the genepop software for Windows and Linux</article-title>. <source>Molecular Ecology Resources</source>. <year>2008</year>;<volume>8</volume>(<issue>1</issue>):<fpage>103</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1471-8286.2007.01931.x" xlink:type="simple">10.1111/j.1471-8286.2007.01931.x</ext-link></comment> <object-id pub-id-type="pmid">21585727</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Foll</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gaggiotti</surname> <given-names>O</given-names></name>. <article-title>A genome-scan method to identify selected loci appropriate for both dominant and codominant markers: a Bayesian perspective</article-title>. <source>Genetics</source>. <year>2008</year>;<volume>180</volume>(<issue>2</issue>):<fpage>977</fpage>–<lpage>93</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.108.092221" xlink:type="simple">10.1534/genetics.108.092221</ext-link></comment> <object-id pub-id-type="pmid">18780740</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rolan-Alvarez</surname> <given-names>E</given-names></name>. <article-title>Sympatric speciation as a by-product of ecological adaptation in the Galician Littorina saxatilis hybrid zone</article-title>. <source>Journal of Molluscan Studies</source>. <year>2007</year>;<volume>73</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bourret</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kent</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Primmer</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Vasemägi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Karlsson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hindar</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>SNP-array reveals genome-wide patterns of geographical and potential adaptive divergence across the natural range of Atlantic salmon (Salmo salar)</article-title>. <source>Molecular Ecology</source>. <year>2013</year>;<volume>22</volume>(<issue>3</issue>):<fpage>532</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/mec.12003" xlink:type="simple">10.1111/mec.12003</ext-link></comment> <object-id pub-id-type="pmid">22967111</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Renaut</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nolte</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Rogers</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Derome</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bernatchez</surname> <given-names>L</given-names></name>. <article-title>SNP signatures of selection on standing genetic variation and their association with adaptive phenotypes along gradients of ecological speciation in lake whitefish species pairs (Coregonus spp.)</article-title>. <source>Molecular Ecology</source>. <year>2011</year>;<volume>20</volume>(<issue>3</issue>):<fpage>545</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1365-294X.2010.04952.x" xlink:type="simple">10.1111/j.1365-294X.2010.04952.x</ext-link></comment> <object-id pub-id-type="pmid">21143332</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thibert-Plante</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Gavrilets</surname> <given-names>S</given-names></name>. <article-title>Evolution of mate choice and the so-called magic traits in ecological speciation</article-title>. <source>Ecol Lett</source>. <year>2013</year>.</mixed-citation></ref>
<ref id="pone.0175944.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carvajal-Rodriguez</surname> <given-names>A</given-names></name>. <article-title>GENOMEPOP: A program to simulate genomes in populations</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>223</fpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bersaglieri</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sabeti</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Patterson</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Vanderploeg</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Schaffner</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Drake</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Genetic signatures of strong recent positive selection at the lactase gene</article-title>. <source>Am J Hum Genet</source>. <year>2004</year>;<volume>74</volume>(<issue>6</issue>):<fpage>1111</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/421051" xlink:type="simple">10.1086/421051</ext-link></comment> <object-id pub-id-type="pmid">15114531</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buck</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Malivert</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>de Chasseval</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Barraud</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fondaneche</surname> <given-names>M-C</given-names></name>, <name name-style="western"><surname>Sanal</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Cernunnos, a novel nonhomologous end-joining factor, is mutated in human immunodeficiency with microcephaly</article-title>. <source>Cell</source>. <year>2006</year>;<volume>124</volume>(<issue>2</issue>):<fpage>287</fpage>–<lpage>99</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2005.12.030" xlink:type="simple">10.1016/j.cell.2005.12.030</ext-link></comment> <object-id pub-id-type="pmid">16439204</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ferrer-Admetlla</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Liang</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Korneliussen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>R</given-names></name>. <article-title>On Detecting Incomplete Soft or Hard Selective Sweeps Using Haplotype Structure</article-title>. <source>Molecular Biology and Evolution</source>. <year>2014</year>;<volume>31</volume>(<issue>5</issue>):<fpage>1275</fpage>–<lpage>91</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msu077" xlink:type="simple">10.1093/molbev/msu077</ext-link></comment> <object-id pub-id-type="pmid">24554778</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shibata</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Yamamoto</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Oka</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Inoko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Arinami</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide association study of schizophrenia using microsatellite markers in the Japanese population</article-title>. <source>Psychiatric genetics</source>. <year>2013</year>;<volume>23</volume>(<issue>3</issue>):<fpage>117</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1097/YPG.0b013e32835fe4f1" xlink:type="simple">10.1097/YPG.0b013e32835fe4f1</ext-link></comment> <object-id pub-id-type="pmid">23474461</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Patterson</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Reich</surname> <given-names>D</given-names></name>. <article-title>Population differentiation as a test for selective sweeps</article-title>. <source>Genome Research</source>. <year>2010</year>;<volume>20</volume>(<issue>3</issue>):<fpage>393</fpage>–<lpage>402</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.100545.109" xlink:type="simple">10.1101/gr.100545.109</ext-link></comment> <object-id pub-id-type="pmid">20086244</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rolan-Alvarez</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Austin</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Boulding</surname> <given-names>EG</given-names></name>. <article-title>The contribution of the genus Littorina to the field of evolutionary ecology</article-title>. <source>Oceanography and Marine Biology: an Annual Review</source>. <year>2015</year>;<volume>53</volume>:<fpage>157</fpage>–<lpage>214</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ravinet</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Westram</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Johannesson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Butlin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>André</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Panova</surname> <given-names>M</given-names></name>. <article-title>Shared and nonshared genomic divergence in parallel ecotypes of Littorina saxatilis at a local scale</article-title>. <source>Molecular Ecology</source>. <year>2016</year>:<fpage>287</fpage>–<lpage>305</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/mec.13332" xlink:type="simple">10.1111/mec.13332</ext-link></comment> <object-id pub-id-type="pmid">26222268</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yeaman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Whitlock</surname> <given-names>MC</given-names></name>. <article-title>The Genetic Architecture of Adaptation under Migration-Selection Balance</article-title>. <source>Evolution</source>. <year>2011</year>;<volume>65</volume>(<issue>7</issue>):<fpage>1897</fpage>–<lpage>911</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1558-5646.2011.01269.x" xlink:type="simple">10.1111/j.1558-5646.2011.01269.x</ext-link></comment> <object-id pub-id-type="pmid">21729046</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tishkoff</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Reed</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Ranciaro</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Voight</surname> <given-names>BF</given-names></name>, <name name-style="western"><surname>Babbitt</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Silverman</surname> <given-names>JS</given-names></name>, <etal>et al</etal>. <article-title>Convergent adaptation of human lactase persistence in Africa and Europe</article-title>. <source>Nat Genet</source>. <year>2007</year>;<volume>39</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng1946" xlink:type="simple">10.1038/ng1946</ext-link></comment> <object-id pub-id-type="pmid">17159977</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maksimova</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hara</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Nikolaeva</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Chun-Feng</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Usui</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Takagi</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Neuroblastoma amplified sequence gene is associated with a novel short stature syndrome characterised by optic nerve atrophy and Pelgerâ€“HuÃ«t anomaly</article-title>. <source>Journal of medical genetics</source>. <year>2010</year>:jmg. 2009.074815.</mixed-citation></ref>
<ref id="pone.0175944.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segarra</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Ballhausen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Crawford</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Perreau</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Campos-Xavier</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>van Spaendonck-Zwarts</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>NBAS mutations cause a multisystem disorder involving bone, connective tissue, liver, immune system, and retina</article-title>. <source>American Journal of Medical Genetics Part A</source>. <year>2015</year>;<volume>167</volume>(<issue>12</issue>):<fpage>2902</fpage>–<lpage>12</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Whitlock</surname> <given-names>MC</given-names></name>. <article-title>Modern Approaches to Local Adaptation</article-title>. <source>The American Naturalist</source>. <year>2015</year>;<volume>186</volume>(<issue>S1</issue>):<fpage>S1</fpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yeaman</surname> <given-names>S</given-names></name>. <article-title>Local Adaptation by Alleles of Small Effect*</article-title>. <source>The American Naturalist</source>. <year>2015</year>;<volume>186</volume>(<issue>S1</issue>):<fpage>S74</fpage>–<lpage>S89</lpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Debarre</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Yeaman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Guillaume</surname> <given-names>F</given-names></name>. <article-title>Evolution of Quantitative Traits under a Migration-Selection Balance: When Does Skew Matter?*</article-title>. <source>The American Naturalist</source>. <year>2015</year>;<volume>0</volume>(<issue>0</issue>):<fpage>S000</fpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Johannesson</surname> <given-names>K</given-names></name>. <article-title>What can be learnt from a snail?</article-title> <source>Evolutionary Applications</source>. <year>2015</year>:<fpage>n/a</fpage>.</mixed-citation></ref>
<ref id="pone.0175944.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hollander</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Galindo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Butlin</surname> <given-names>RK</given-names></name>. <article-title>Selection on outlier loci and their association with adaptive phenotypes in Littorina saxatilis contact zones</article-title>. <source>Journal of Evolutionary Biology</source>. <year>2015</year>;<volume>28</volume>(<issue>2</issue>):<fpage>328</fpage>–<lpage>37</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/jeb.12564" xlink:type="simple">10.1111/jeb.12564</ext-link></comment> <object-id pub-id-type="pmid">25439395</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zeng</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>CI</given-names></name>. <article-title>Compound tests for the detection of hitchhiking under positive selection</article-title>. <source>Molecular Biology and Evolution</source>. <year>2007</year>;<volume>24</volume>(<issue>8</issue>):<fpage>1898</fpage>–<lpage>908</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msm119" xlink:type="simple">10.1093/molbev/msm119</ext-link></comment> <object-id pub-id-type="pmid">17557886</object-id></mixed-citation></ref>
<ref id="pone.0175944.ref064"><label>64</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lin</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Schlotterer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Futschik</surname> <given-names>A</given-names></name>. <article-title>Distinguishing positive selection from neutral evolution: boosting the performance of summary statistics</article-title>. <source>Genetics</source>. <year>2011</year>;<volume>187</volume>(<issue>1</issue>):<fpage>229</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.110.122614" xlink:type="simple">10.1534/genetics.110.122614</ext-link></comment> <object-id pub-id-type="pmid">21041556</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>