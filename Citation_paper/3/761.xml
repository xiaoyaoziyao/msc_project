<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">08-PONE-RA-04289R1</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0002651</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Comparative Sequence Analysis</subject><subject>Computational Biology/Evolutionary Modeling</subject><subject>Computational Biology/Genomics</subject><subject>Computational Biology/Population Genetics</subject><subject>Computer Science/Applications</subject><subject>Evolutionary Biology/Bioinformatics</subject><subject>Evolutionary Biology/Evolutionary and Comparative Genetics</subject><subject>Evolutionary Biology/Microbial Evolution and Genomics</subject><subject>Genetics and Genomics/Bioinformatics</subject><subject>Genetics and Genomics/Microbial Evolution and Genomics</subject><subject>Mathematics/Statistics</subject><subject>Virology/Immunodeficiency Viruses</subject><subject>Virology/Virus Evolution and Symbiosis</subject><subject>Infectious Diseases/HIV Infection and AIDS</subject></subj-group></article-categories><title-group><article-title>Phylogenetic Detection of Recombination with a Bayesian Prior on the Distance between Trees</article-title><alt-title alt-title-type="running-head">Bayesian Tree Distance</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>de Oliveira Martins</surname><given-names>Leonardo</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Leal</surname><given-names>Élcio</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Kishino</surname><given-names>Hirohisa</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Graduate School of Agriculture and Life Sciences, University of Tokyo, Tokyo, Japan</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Federal University of São Paulo, São Paulo, Brazil</addr-line>       </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Isalan</surname><given-names>Mark</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Center for Genomic Regulation, Spain</aff><author-notes><corresp id="cor1">* E-mail: <email xlink:type="simple">leo@lbm.ab.a.u-tokyo.ac.jp</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: HK LM EL. Performed the experiments: LM EL. Analyzed the data: LM EL. Contributed reagents/materials/analysis tools: HK LM EL. Wrote the paper: HK LM EL. Other: Developed the software: LM HK.</p></fn><fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><year>2008</year></pub-date><pub-date pub-type="epub"><day>9</day><month>7</month><year>2008</year></pub-date><volume>3</volume><issue>7</issue><elocation-id>e2651</elocation-id><history><date date-type="received"><day>11</day><month>4</month><year>2008</year></date><date date-type="accepted"><day>7</day><month>6</month><year>2008</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Martins et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Genomic regions participating in recombination events may support distinct topologies, and phylogenetic analyses should incorporate this heterogeneity. Existing phylogenetic methods for recombination detection are challenged by the enormous number of possible topologies, even for a moderate number of taxa. If, however, the detection analysis is conducted independently between each putative recombinant sequence and a set of reference parentals, potential recombinations between the recombinants are neglected. In this context, a recombination hotspot can be inferred in phylogenetic analyses if we observe several consecutive breakpoints. We developed a distance measure between unrooted topologies that closely resembles the number of recombinations. By introducing a prior distribution on these recombination distances, a Bayesian hierarchical model was devised to detect phylogenetic inconsistencies occurring due to recombinations. This model relaxes the assumption of known parental sequences, still common in HIV analysis, allowing the entire dataset to be analyzed at once. On simulated datasets with up to 16 taxa, our method correctly detected recombination breakpoints and the number of recombination events for each breakpoint. The procedure is robust to rate and transition∶transversion heterogeneities for simulations with and without recombination. This recombination distance is related to recombination hotspots. Applying this procedure to a genomic HIV-1 dataset, we found evidence for hotspots and de novo recombination.</p></abstract><funding-group><funding-statement>This work was supported by the Japan Society for the Promotion of Science (JSPS). L.O.M. was supported by the Japanese Ministry of Education, Culture, Sports, Science and Technology (MEXT) scholarship. E.L. was supported by the Fundacão de Amparo à Pesquisa do Estado de São Paulo (FAPESP, grants no. 04/10372-3, 07/52841-8).</funding-statement></funding-group><counts><page-count count="13"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>A variety of distinct methods have been developed to detect recombination (for a review see <xref ref-type="bibr" rid="pone.0002651-Posada1">[1]</xref>). They can be broadly classified into two classes, depending on the relative contributions of the recombinational and mutational processes <xref ref-type="bibr" rid="pone.0002651-Posada2">[2]</xref>: the population genetic approach and the phylogenetic approach <xref ref-type="bibr" rid="pone.0002651-Awadalla1">[3]</xref>. The population genetic approach uses the information of the linkage disequilibrium among segregating sites, assuming ubiquitous recombination. The linkage disequilibrium depends not only on the recombination rate between the sites but also on the the population history. Recombination rate and the population history are then estimated by introducing the ancestral recombination graphs (ARGs) as nuisance parameters (i.e., the population histories are averaged over all possible particular recombination scenarios) <xref ref-type="bibr" rid="pone.0002651-Fearnhead1">[4]</xref>–<xref ref-type="bibr" rid="pone.0002651-Nielsen1">[12]</xref>. The population genetic approach is efficient when recombination is pervasive along the genome, disrupting the phylogenetic signal. In this context recombination hotspots can be detected as regions where the recombination rate is higher than the local background rate <xref ref-type="bibr" rid="pone.0002651-Fearnhead1">[4]</xref>, <xref ref-type="bibr" rid="pone.0002651-Wiuf1">[13]</xref>.</p><p>When the recombination rate is moderate compared with mutation rate, the sequences may be decomposed into a few segments that have specific phylogenetic histories. Instead of treating the recombination history as a nuisance parameter, the phylogenetic approach estimates the breakpoints and the phylogeny of the segments, assuming that some phylogenetic structure is preserved. Many techniques are based on sliding window procedures that compare the topology of one segment against neighboring segments or the whole alignment. This comparison may be based on the phenetic distance <xref ref-type="bibr" rid="pone.0002651-Siepel1">[14]</xref>–<xref ref-type="bibr" rid="pone.0002651-Weiller1">[16]</xref>, likelihood <xref ref-type="bibr" rid="pone.0002651-Grassly1">[17]</xref> or posterior distribution <xref ref-type="bibr" rid="pone.0002651-Husmeier1">[18]</xref> of the topologies for each arbitrary segment. Hidden Markov Models <xref ref-type="bibr" rid="pone.0002651-Husmeier2">[19]</xref>, <xref ref-type="bibr" rid="pone.0002651-Husmeier3">[20]</xref> regard topologies at sites as hidden states, where the transition probability penalizes the inconsistency of topology between neighboring sites. Bayesian change point models <xref ref-type="bibr" rid="pone.0002651-Minin1">[21]</xref>, <xref ref-type="bibr" rid="pone.0002651-Minin2">[22]</xref> identify recombination breakpoints and differentiated substitution rates as change points of topologies and evolutionary rate parameters. While these Bayesian procedures have a sound statistical background, they can not reliably estimate the history of recombination events when the number of taxa increase, due to the large degree of freedom on topologies.</p><p>Here, we present a new method to detect recombination based on the disagreement of topologies from adjacent segments of DNA alignments. Our approach falls into the category of phylogenetic approaches, and we consider only recombinations that influence the topology. We conceived an algorithm that approximates the minimum number of subtree prune-and-regraft (SPR) operations required to resolve inconsistencies between two competing unrooted trees. This number is called the SPR distance (<italic>d<sub>SPR</sub></italic>). We refer to our algorithm as the (approximate) SPR distance (<italic>d̂</italic><italic><sub>SPR</sub></italic>). The distributions of distances between adjacent segments are then used as a prior in a Bayesian approach to penalize highly discordant topologies between two neighboring segments. Consequently, this approach reduces the topology space explored for each segment, thereby reducing the computational burden. Additionally, because inconsistent topologies are constrained by the distances of neighboring segments, the uncertainty in the estimation is largely reduced. It is possible to extract well-resolved trees even from short non-recombinant DNA regions within an alignment. Since the distances can be obtained from unrooted trees, our method does not assume a known outgroup. The posterior distribution of distances and the topologies of the segments make it possible to interpret the recombination history. Therefore, our procedure may work well for the exploratory analysis of identifying recombination patterns.</p><p>We evaluated our method initially by analyzing sets of simulated alignments in the presence and absence of recombination. The results suggest that this is a reliable method to detect and distinguish recombination from rate heterogeneity in simulated data. We then used our method to study recombination in empirical sequences from HIV-1. Recombinant HIV-1 variants that spread epidemically throughout a population of unrelated individuals are designated circulating recombinant forms (CRF), and genomes of CRF viruses are mosaics comprised by regions derived from two or more distinct parental subtypes. These recombinants are routinely detected by phylogenetic methods based on a local similarity between the putative recombinant and all possible parental sequences <xref ref-type="bibr" rid="pone.0002651-Siepel1">[14]</xref>, <xref ref-type="bibr" rid="pone.0002651-Salminen1">[15]</xref>. Although in South American countries subtype B remains the most prevalent clade of the HIV-1 infection, there are great varieties of different BF recombinants (as a result of recombination between subtypes B and F) co-circulating in these countries <xref ref-type="bibr" rid="pone.0002651-Sierra1">[23]</xref>. In this context, it is expected that recombinations among HIV-1 BF variants will occur frequently and that these events are currently neglected by methods that exploit the mosaic pattern based on sequence parentage. For this reason, we explored the pattern of recombination in BF viruses from South American countries in more detail. Our method provides evidence that the extent of recombination in HIV-1 can be underestimated if one relies solely in the mosaic pattern dictated by the reference parentals.</p></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>Approximate SPR distance between topologies</title><p>To evaluate the performance of our approximate SPR distance (<italic>d̂<sub>SPR</sub></italic>) algorithm, we applied subtree prune-and-regraft (<italic>SPR</italic>) moves on a random topology and then estimated the distance between the original and rearranged topologies <xref ref-type="bibr" rid="pone.0002651-Hordijk1">[24]</xref>. <xref ref-type="fig" rid="pone-0002651-g001">Figure 1</xref> shows the distribution of estimated distances obtained by the complement Maximum Agreement Subtree (cMAST, number of leaves causing the disagreement) by the Robinson-Foulds (number of edges in disagreement) method and by our <italic>d̂<sub>SPR</sub></italic> method for topologies with 64 taxa (the largest number our implementation can handle). We performed 1–16 SPR moves (“real” <italic>d<sub>SPR</sub></italic>) in this analysis, with 5000 replicates for each distance. The approximation <italic>d̂<sub>SPR</sub></italic> is very good for small values of <italic>d<sub>SPR</sub></italic>, and we observed a lower performance when the “real” number of SPR moves increases. The same behavior was observed for smaller trees, with the observation that performance decreased faster in this case (results not shown). Conversely, estimates obtained by cMAST or Robinson-Foulds non-linearly overestimate the number of SPRs in most cases. The procedure always gave the correct answer for simulations of one SPR, which means that our procedure is conservative since it does not report a distance larger than one (several moves) if the topologies can be explained by one SPR event. The sub-optimal performance is the result not only of the heuristic nature of the algorithm but also of the inability in simulating topologies with an exact SPR distance <xref ref-type="bibr" rid="pone.0002651-Nakhleh1">[25]</xref>. The calculation of <italic>d̂<sub>SPR</sub></italic> for this analysis (8×10<sup>4</sup> simulated tree pairs) took 100 seconds on a Pentium M 1.6GHz running Debian GNU/Linux. A panel with individual histograms for this comparison can be seen in <xref ref-type="supplementary-material" rid="pone.0002651.s001">Figure S1</xref>.</p><fig id="pone-0002651-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0002651.g001</object-id><label>Figure 1</label><caption><title>Comparison of tree distance metrics for topology pairs over 64 taxa.</title><p>The vertical bars represent the 95% range, and diamonds intercept the median over 5000 replicates for each simulated distance. The cMAST estimates (black) were calculated with PAUP <xref ref-type="bibr" rid="pone.0002651-Swofford1">[33]</xref>, while the Robinson-Foulds (RF) distance (gray) and our <italic>d̂<sub>SPR</sub></italic> approximation (blue) were computed using in-house software. The diagonal line (red) represents the case where the estimate and true values agree. On the horizontal axis, we have the “real” number of SPR moves applied (ranging from one to 16) on random topologies, and, on the vertical axis, we show the estimated distances using the RF, cMAST and <italic>d̂<sub>SPR</sub></italic> methods.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.g001" xlink:type="simple"/></fig><p>By applying several SPRs on a topology, it does not guarantee that the final topology can be explained by fewer than the number of applied moves <xref ref-type="bibr" rid="pone.0002651-Nakhleh1">[25]</xref>, <xref ref-type="bibr" rid="pone.0002651-Suchard1">[26]</xref>. In our simulations, we tried to circumvent this problem by allowing branches to participate in only one SPR move and by simulating recombination on large phylogenies. Other strategies based on exploiting the SPR neighborhood of topologies <xref ref-type="bibr" rid="pone.0002651-Suchard1">[26]</xref> gave similar results with a much higher computational burden for simulation (results not shown).</p></sec><sec id="s2b"><title>Recombination detection on simulated sequences</title><p>To evaluate the performance of our method in detecting recombination, we simulated datasets with eight and 12 taxa while mimicking DNA sequences with recombination breakpoints. To do this, we simulated fragments of sequences assuming a defined evolutionary model (tree and parameters) using PAML <xref ref-type="bibr" rid="pone.0002651-Yang1">[27]</xref>. We used the HKY model (π<sub>A</sub> = 0.3, π<sub>G</sub> = 0.4, π<sub>C</sub> = 0.2, π<sub>T</sub> = 0.1), where each branch length was drawn from a uniform distribution between 0.2 and 1 and then rescaled. We simulated 100 replicates under the same evolutionary model for each scenario. Each fragment was simulated independently and then concatenated into a single alignment. As a result, the simulated alignments corresponded to mosaic DNA sequences formed by distinct non-recombinant fragments. Each fragment included in the alignments was simulated from distinct topologies (distinct evolutionary history). Therefore, the concatenation mimics the effect of natural recombination. Consequently, the simulation approach resembles natural recombination that occurs in organisms that exchange large genomic regions between distinct lineages. In addition, the heterogeneity of branch lengths resembles a relaxed molecular clock process, simulating heterogeneity among lineages.</p><p><xref ref-type="fig" rid="pone-0002651-g002">Figure 2A</xref> shows the simulation strategy for eight sequences, where each non-recombinant fragment is composed of 64 base pairs (bp). The concatenated alignment then has 256 bp with three known breakpoints. For this simulation, we fixed kappa (<italic>κ</italic>) to 1.4 and rescaled branch lengths such that each site had, on average, one substitution. This apparent high value reflects our assumption that some phylogenetic signal is present, and the non-recombinant fragments are short. MCMC analysis was conducted with 5×10<sup>4</sup> iterations (after 5×10<sup>3</sup> iterations were initially discarded), with 100 samples from the posterior being drawn. For this analysis, we assumed that each segment was composed of 2 bp such that we sampled from 128 segments.</p><fig id="pone-0002651-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0002651.g002</object-id><label>Figure 2</label><caption><title>Bayesian analysis on simulations of eight (panels A and B) and 12 (panels C and D) taxa.</title><p>Panels A and C show trees used in the simulations. Branch lengths are proportional to the amount of evolution between nodes. Numbers below trees show site ranges over which the topologies were used, with true <italic>d<sub>SPR</sub></italic> to the next topology in parenthesis. Disagreements between segments can be explained by one SPR between trees for the eight taxa scenario and two SPR moves between 12 taxa trees. From left to right, one possible SPR explanation is represented by arrows. The distributions of posterior mean SPR distances per segment over 100 simulated datasets (for each scenario) are shown in panels B and D. The black vertical lines are the 95% inter-quantile ranges, while the light blue dots are the median values over all datasets. The red lines are the mean values of the average SPR distance per segment. The true recombination breakpoints are represented by filled triangles.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.g002" xlink:type="simple"/></fig><p>For 12 taxa simulation, each non-recombinant region (128 bp) supports not only a different topology but also distinct evolutionary parameters. The average rate per site of each 32 bp region was scaled to be between one and four, and <italic>κ</italic> was set to a random number between one and two. In such a scenario, our simulations take into account rate heterogeneity among sites and lineages. Likewise, we simulated non-recombinant fragments of 128 bp following the topologies displayed in <xref ref-type="fig" rid="pone-0002651-g002">Figure 2C</xref>, and the fragments were then concatenated into an alignment of 512 bp. We noticed that, at each recombination breakpoint, at least two recombinations (SPR moves) were necessary to explain differences between non-recombinant regions. In this case, the MCMC analysis was conducted with 2×10<sup>4</sup> iterations (sampling at each 200 iterations), and we assumed each segment to be composed of 4 bp, containing 128 segments in total.</p><p>If, for each replicate, we look at the average posterior SPR distance per segment (actually, the distance between each segment and the next), we will have the distribution of the mean distances for each segment for 100 replicates. The distribution of average posterior distances for the simulation with eight and 12 taxa are illustrated in <xref ref-type="fig" rid="pone-0002651-g002">Figure 2</xref> (panels B and D, respectively). Considering the regions surrounding the true breakpoints (filled triangles), we observe that breakpoints, as estimated by a mean distance larger than zero, are usually found within 20 bp from the true ones. If we sum the mean values around the peaks (red lines), we can find the true number of SPR moves between the regions. In fact, for each posterior sample we can sum up the individual distance values (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e001" xlink:type="simple"/></inline-formula>) to obtain the total number of SPRs (lower bound for the minimum number of recombinations) and the count of how many segments have <italic>d̂<sub>SPR</sub></italic> larger than zero (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e002" xlink:type="simple"/></inline-formula>, where <italic>I<sub>x</sub></italic> is the indicator function) that will give us the number of recombination breakpoints. For each dataset, we have the distribution of the number of SPRs and breakpoints. The mode values inferred the true number of SPR operations in 71% of the datasets and correctly predicted the number of breakpoints in 84% of the simulations with eight taxa. For simulations with 12 taxa, it was successful in detecting a total number of six SPRs in 80% of the replicates and a total number of three breakpoints in 94% of the datasets (data not shown). By summing up the fraction of posterior samples where <italic>d̂<sub>SPR</sub></italic> is larger than zero over a region we have the posterior probability of a breakpoint over this region. By repeating this procedure for all replicate datasets over a 20 bp region around the true breakpoints, we found the estimated breakpoint locations to be within 20 bp of the true values on 63% of the eight taxa datasets and on 91% of the simulations with 12 taxa, on average. The individual values for the first, second and third breakpoints are respectively 62%, 76% and 51% for eight taxa and 91%, 96% and 86% for 12 taxa. Each dataset on eight taxa took, on average, less than eight minutes to analyze, while each of the 12 taxa simulations took approximately 15 minutes to complete on a Pentium M 1.6 GHz running Debian GNU/Linux.</p></sec><sec id="s2c"><title>Inferred versus true trees</title><p>To check the frequency at which the true topology was reconstructed, we compared, for each dataset, the maximum <italic>a posteriori</italic> (MAP) topology of each segment against their respective true trees (i.e., the trees initially used to simulate the datasets). From this comparison, we counted the number of times the topologies agreed in all datasets, which gave us the frequency of topology hits per segment. The results for eight taxa datasets are shown in <xref ref-type="fig" rid="pone-0002651-g003">Figure 3</xref>. In this figure, we show the same statistic (proportion of correctly reconstructed topology) using cBrother software <xref ref-type="bibr" rid="pone.0002651-Fang1">[28]</xref>, a fast implementation of the Bayesian procedure DualBrothers <xref ref-type="bibr" rid="pone.0002651-Minin1">[21]</xref>. DualBrothers (and cBrother) is a Bayesian phylogenetic procedure for recombination detection <xref ref-type="bibr" rid="pone.0002651-Chan1">[29]</xref> and cBrother is capable of relaxing the parental assumption <xref ref-type="bibr" rid="pone.0002651-Fang1">[28]</xref> accurately working with up to six or seven taxa <xref ref-type="bibr" rid="pone.0002651-Rajaram1">[30]</xref>. The output from cBrother analyzed was the MAP number of breakpoints and mosaic structure, namely the most frequent combination of topologies and breakpoints. Here, we report that cBrother performed well with eight taxa, finding the true topology in 60% of the simulations-median over sites (<xref ref-type="fig" rid="pone-0002651-g003">Figure 3</xref>). Conversely, our procedure outperformed cBrother, given that, for most sites, the MAP topology corresponded to the true topology in 73% of the simulations (red dots in <xref ref-type="fig" rid="pone-0002651-g003">Figure 3</xref>). For datasets with 12 taxa, the MAP topologies using our procedure reconstructed the true ones in 75% of the segments, on average (data not shown). If we consider only the detection of recombination, cBrother retrieved the correct number of breakpoints in 55% of the datasets with eight taxa, much lower than the 84% reported by our procedure (not shown).</p><fig id="pone-0002651-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0002651.g003</object-id><label>Figure 3</label><caption><title>Accuracy of Bayesian methods in reconstructing true topologies.</title><p>The red dots represent the fraction of simulated datasets for each segment, where the MAP topology estimated using our method corresponds to the true topology over 100 datasets. The black dots represent the accuracy of the cBrother software in obtaining the true topologies based on the MAP structure. The gray horizontal bars represent the same quantity for the independent analyses of each non-recombinant region (of 64 bp) using the software MrBayes (over 100 datasets).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.g003" xlink:type="simple"/></fig><p>Both methods have decreased performance around the recombination breakpoints, where the phylogenetic signal is conflicting. The superior performance of our method is due to the penalty against distant topologies since cBrother needs to consider equally all (2<italic>n</italic>−5)!! topologies over <italic>n</italic> taxa without parental assumptions. We also compared the results described above with MrBayes, a Bayesian procedure used to infer the posterior distribution of topologies in the absence of recombination <xref ref-type="bibr" rid="pone.0002651-Huelsenbeck1">[31]</xref>, <xref ref-type="bibr" rid="pone.0002651-Ronquist1">[32]</xref>. For each simulated dataset, we used MrBayes to infer the posterior distribution of topologies for each of the four 64 bp non-recombinant fragments independently. The results, depicted in gray in <xref ref-type="fig" rid="pone-0002651-g003">Figure 3</xref>, show that MrBayes is less effective than our method in recovering the true tree, except for the region between sites 129 and 192. Our procedure does not assume that breakpoints are known, but outperformed MrBayes applied to each fragment free from recombination. This shows that MrBayes, similar to cBrother (but to a lesser extent), suffers from the large topology space and that the prior on the SPR distance is effective to reduce the degree of freedom. Another approach (but difficult to implement with recombinant datasets) would be to analyze consensus topologies instead of MAP topologies. We also inferred the topologies of the non-recombinant fragments using minimum evolution and maximum likelihood criteria <xref ref-type="bibr" rid="pone.0002651-Swofford1">[33]</xref>, reconstructing the true trees respectively in 53% and 60% of the simulations, on average (results not shown).</p></sec><sec id="s2d"><title>Rate heterogeneity in absence of recombination</title><p>Even in the absence of recombination, spatially structured model heterogeneity can lead to falsely detected recombination <xref ref-type="bibr" rid="pone.0002651-Minin1">[21]</xref>. To evaluate the robustness of our method against the bias induced by rate heterogeneity, we simulated a 256 bp alignment with eight taxa where all sites share the same topology (first topology in <xref ref-type="fig" rid="pone-0002651-g002">Figure 2A</xref>). Furthermore, the average substitution rate per site was set to 0.6 for almost all segments, with the exception of sites 129 to 192, where the average rate was fixed at 4.8 substitutions per site; <italic>κ</italic> was set to 1.4 for all sites (<xref ref-type="fig" rid="pone-0002651-g004">Figure 4</xref>). No evidence of recombination was found in any of the 100 datasets (results not shown). Since our procedure integrates out individual substitution rates over branches, the parameter <italic>μ<sub>i</sub></italic> is the average substitution rate per branch. Thus, an average of 0.6 substitutions per site over eight taxa implies that <italic>μ<sub>i</sub></italic> = 0.046 since we have 2×8−3 = 13 branches. Our primary interest, however, is not the estimation of individual site rates, but our method seems robust enough to model heterogeneity. In our model, the independence of rates between segments accommodates this heterogeneity while avoiding over-parameterization caused by individual branches.</p><fig id="pone-0002651-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0002651.g004</object-id><label>Figure 4</label><caption><title>Bayesian analysis of one simulated dataset with single topology and model heterogeneity.</title><p>The panel shows the distribution of average substitution rates <italic>μ<sub>i</sub></italic> per branch for each segment. Dark gray vertical bars represent the 95% credibility interval, and light blue points represent the median values. The true values are depicted by red horizontal lines.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.g004" xlink:type="simple"/></fig></sec><sec id="s2e"><title>Simulation of a recombination hotspot</title><p>The previous simulations with 12 taxa provide a scenario in which each breakpoint can be considered a hotspot because at least two SPRs are necessary to explain the inconsistency between neighboring regions and because the true number of recombinations will always be larger than the unrooted <italic>d<sub>SPR</sub></italic>. We are also interested in the scenario in which a hotspot can be represented as unusually clustered adjacent breakpoints since we suspect that distinguishing both might be difficult given the stochastic error on the breakpoint locations. Therefore, we simulated datasets with 16 taxa having three recombination breakpoints at a distance of 10 bp between each other in a 500 bp alignment. The SPR distance between adjacent trees is one, giving a total of three SPR events. This scenario is represented in <xref ref-type="fig" rid="pone-0002651-g005">Figure 5A</xref>, where one possibility is that the recombinant sequences are those labeled 2, 3, <italic>c</italic> and <italic>d</italic>. Notice that it is of equal likeliness that sequence 3 is a parental and sequence <italic>b</italic> (or sequences 4 and 7) is the recombinant. The mosaic structure for these sequences is depicted in panel B. For example, the sequence <italic>c</italic> is a recombinant between sequences 1 and <italic>b</italic>, and the recombination breakpoint is between sites 265 and 266. In the same way, the ancestor of sequences 6, <italic>e</italic> and <italic>g</italic> recombined with the ancestor of taxa eight between sites 255 and 256, resulting in the extant sequences 2 and <italic>d</italic>. Note that, in this case, there are two recombinant sequences sharing one ancestral recombination.</p><fig id="pone-0002651-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0002651.g005</object-id><label>Figure 5</label><caption><title>Simulation of a hotspot region.</title><p>Panel A shows the topologies used in the simulation, where the number ranges represent the site regions, and the numbers in parenthesis represent the SPR distance to the next tree. One possible recombination scenario is shown with colored subtrees. Panel B shows the mosaic structure of the four recombinant sequences, highlighting the nearness of the breakpoints. Panel C shows the distribution of average SPR distances assuming 10 bp segments, with median (light blue dots) and 95% inter-quantile ranges (dark gray bars) (over 200 datasets). The filled triangles represent the true recombination breakpoints. On the inset of panel C, the histogram of the total number of SPR distances (in black) and the number of breakpoints (in blue) based on the modal values over 200 datasets is shown.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.g005" xlink:type="simple"/></fig><p>We therefore simulated 200 replicate alignments under this scenario with an average number of substitutions per site randomly sampled between two and five (rate heterogeneity) and a transition∶transversion ratio between one and four for each 5 bp region. In the Bayesian analyses, we assumed segments of 10 bp, such that the true breakpoints would lie within segments. This is likely to happen in practice, mainly in large segments where the true breakpoints will not lie in the segment border. The summary of the analyses is shown in <xref ref-type="fig" rid="pone-0002651-g005">Figure 5C</xref>, in which the average SPR distances are larger than zero only in the region under recombination. Since breakpoints are clustered, our method could not locate their exact location in the alignment. We also observed that the procedure correctly detects the total number of SPR events, corroborating the hypothesis of a recombination hotspot. This lack of resolution in pinpointing the breakpoint locations is not an artifact of the misplaced segment locations since a similar behavior is observed for 5 bp segments (data not shown). It is, in fact, the result of the lack of phylogenetic signal since there are only 10 bp supporting the intermediate topologies. In our procedure, as long as there is some phylogenetic structure (in this case, in the border regions), it is possible to quantify the number of recombinations even when the breakpoints cannot be precisely located. The true first and last topologies were found as the MAP topologies in 82% and 85% of the datasets, respectively.</p></sec><sec id="s2f"><title>HIV-1 recombination in South America</title><p>To validate our procedure with experimental DNA sequences we analyzed near full-length HIV-1 genomes. We first selected BF recombinant sequences with similar mosaic patterns. These sequences were selected from an alignment of South American BF recombinant sequences comprising 8402 bp. We compared each one independently against reference subtypes F, B and C using the DualBrothers software. By repeating the DualBrothers analysis for each putative recombinant, we assume that the parental sequences are not involved in recombination, an unnecessary feature in our method. Our final dataset consisted of eight BF recombinant sequences with similar mosaic patterns plus three reference subtype sequences, which were then analyzed at once using our procedure. The recombinant sequences represent the reference circulating recombinant form CRF12_BF (according to the Los Alamos HIV databank) and are described in the Supplemental <xref ref-type="supplementary-material" rid="pone.0002651.s004">Table S1</xref>.</p><p>We ran the sampler for 10<sup>4</sup> iterations as a warm-up and then ran 5×10<sup>5</sup> iterations sampling 1000 times on the 11 sequences alignment. The initial states for the warm-up were chosen based on five cycles of 500 iterations of simulated annealing with final temperature of 1.2 (initial temperature of 0.2). In this analysis, we assumed 10 bp segments, and, since the genomic alignments are composed of 8402 bp, we have 840 segments. This procedure was repeated for two independent chains to access convergence from overdispersed starting points. The results reported here are based on the pooled chains. The starting point (initial state) was, in fact, the same, but the simulated annealing stage disperses these states. The convergence was accessed by visual inspection of the time series of the samples, posterior distribution and the scaled reduction factor <xref ref-type="bibr" rid="pone.0002651-Gelman1">[34]</xref> for the posterior probability, the number of breakpoints and the total estimated number of SPR moves. Each run took approximately 24 hours to complete.</p><p><xref ref-type="fig" rid="pone-0002651-g006">Figure 6</xref> shows the support for recombination based on <italic>d̂<sub>SPR</sub></italic> estimated by our method and the posterior probability of recombination estimated by DualBrothers program. The results indicate that regions with a higher probability of recombination (as indicated by DualBrothers, <xref ref-type="fig" rid="pone-0002651-g006">Figure 6A</xref>) were also detected by <italic>d̂<sub>SPR</sub></italic> (<xref ref-type="fig" rid="pone-0002651-g006">Figure 6B</xref>). Therefore, both methods agreed in identifying recombination along HIV-1 sequences. Our method, however, detected much more phylogenetic heterogeneity that was undetected by the independent recombination analysis that we conducted with DualBrothers. This suggests that these recombinations do not involve parental references because, in our analysis with DualBrothers, we neglected the correlation between the recombinants, as is usually done when estimating the mosaic structure. Our result with the proposed Bayesian hierarchical method could indicate ongoing recombinations among CRF_12 viruses. The posterior distribution on the number of recombination breakpoints ranged between 30 and 47 with a mode (and median) of 37, while the sum of <italic>d̂<sub>SPR</sub></italic> over the genome had a credibility interval of 55–77 SPR events with a mode of 65. This finding supports the existence of recombination hotspots since there are breakpoints harboring more than one recombination event. Examples include the beginning and the end of the <italic>pol</italic> gene and at the <italic>tat</italic>/<italic>rev</italic> genes (<xref ref-type="fig" rid="pone-0002651-g006">Figure 6B</xref>). The prior <italic>μ</italic><sub>0</sub> for the average branch length was around 0.025, and, since we have 11 sequences (19 branches), we have an expected substitution at every two sites, compatible with the values used in the simulations.</p><fig id="pone-0002651-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0002651.g006</object-id><label>Figure 6</label><caption><title>Evidence for recombination in HIV-1 genome sequences.</title><p>Panel A shows the posterior probability of having a recombination breakpoint based on analyses using DualBrothers software, with a schematic representation of HIV-1 genes in scale. Since we analyzed each of the eight putative recombinant sequences independently in DualBrothers, this overall posterior probability is given by the sum of individual distributions. Panel B represents the posterior distribution of SPR distances between 10 bp segments as inferred by our method using samples from two independent runs. The horizontal axis is in the same scale as panel A. The support (posterior frequency) for the two most frequent topologies over segments is shown in panel C. For each segment we have the frequencies of the MAP topology (blue line) and the second most frequent topology (red line).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.g006" xlink:type="simple"/></fig><p>One difficulty in the analysis is to summarize the information from posterior topologies since we have a distribution of topologies for each segment. Our strategy was to observe the MAP topologies for each segment and to infer a possible recombination whenever neighboring MAP topologies disagree. The distances between MAP topologies for each segment indicate 49 and 52 breakpoints (for each independently sampled chain), an overestimation compared with sampled distances. This overestimation can be explained using <xref ref-type="fig" rid="pone-0002651-g006">Figure 6C</xref>, which shows the support (posterior frequency) for the two most frequent topologies for each segment along the alignment. There is virtually no difference in frequency between the MAP topology (most frequent) and some other topology after site 7500 of the alignment. This figure also shows which regions have a higher phylogenetic signal (for instance, between sites 4400 and 4900) and regions where the posterior distribution of trees is flatter and less reliable (such as the region around site 2000 or after 7500). A better strategy would be to summarize the distribution of topologies given the breakpoint pattern.</p><p>The accuracy of our recombination detection method is confirmed by observing the MAP topologies (<xref ref-type="supplementary-material" rid="pone.0002651.s002">Figure S2</xref>), that can be used to reconstruct the mosaic structure for a given choice of parentals. In fact, breakpoints detected by DualBrothers indicate inter-subtype recombinations according to our algorithm (observing the clustering of the recombinant sequences with the parental ones). For example, looking at the first two rows of <xref ref-type="supplementary-material" rid="pone.0002651.s002">figure S2</xref>, we observe that the clustering of the putative recombinants between the parentals C, B and F changes before sites 160, 1620, 1920, 2190 and 2870, in agreement with the breakpoints detected by DualBrothers. Even though <italic>d̂<sub>SPR</sub></italic> is just an approximation to the recombination distance, it should not be inflated if there are no recombination hotspots. This can be explained by the fact that, when <italic>d̂<sub>SPR</sub></italic> is larger than one, more than one recombination is necessary to explain the disagreement between the neighboring segments.</p></sec></sec><sec id="s3"><title>Discussion</title><p>A recombination can be represented by an SPR move between rooted topologies; thus, the number of recombinations between neighboring sites can be estimated by the SPR distance between their underlying rooted trees <xref ref-type="bibr" rid="pone.0002651-JotunHein1">[35]</xref>, <xref ref-type="bibr" rid="pone.0002651-Song1">[36]</xref>. In this context, an explicit model for divergence times and evolutionary rates should be considered <xref ref-type="bibr" rid="pone.0002651-Drummond1">[37]</xref>–<xref ref-type="bibr" rid="pone.0002651-Thorne1">[39]</xref> since recombination can happen only between contemporary taxa. Neglecting branch lengths, SPR operations on rooted topologies always have an equivalent on unrooted topologies <xref ref-type="bibr" rid="pone.0002651-Beiko1">[40]</xref>-replacing the root node by one extant taxon in the unrooted case <xref ref-type="bibr" rid="pone.0002651-Song2">[41]</xref>. Then, the SPR distance between unrooted topologies that we approximate by <italic>d̂<sub>SPR</sub></italic> can be regarded as a lower bound on the number of recombinations between sites, with the advantage that we do not need to disentangle times and rates. Our final target is not to find the recombination history, which can be better addressed by coalescent methods, but to estimate the most parsimonious number of recombinations necessary to explain the phylogenetic incongruence.</p><p>Our Bayesian hierarchical procedure not only detects the recombination breakpoints but also quantifies the disagreement between the trees. It therefore provides information regarding regions where recombinations occur frequently. The chance of correctly inferring the true tree is also higher than using other Bayesian procedures that neglect the similarity between trees on neighboring regions. Assuming a model of independent rates for each site and averaging over individual branch lengths as described in <xref ref-type="bibr" rid="pone.0002651-Suchard2">[42]</xref> proved to be useful in distinguishing recombination from non-random rate heterogeneity. It is worth mentioning that the integration <italic>E<sub>t</sub></italic>[<italic>Q</italic>(<italic>t</italic>)] over individual branch lengths for a site (where <italic>Q</italic>(<italic>t</italic>) is the transition matrix as a function of branch length <italic>t</italic>) is not the same as assuming a fixed branch length <italic>t</italic><sup>*</sup> for all branches since, in general, does not exist <italic>t</italic><sup>*</sup> such that <italic>E<sub>t</sub></italic>[<italic>Q</italic>(<italic>t</italic>)] = <italic>Q</italic>(<italic>t</italic><sup>*</sup>). In other words, marginalizing over branches is not equivalent to assuming the same branch length. Rather, it regards branches at each site as independent realizations from random variables. In simulations with 16 taxa, our procedure was robust to quantifying recombination (of which <italic>d̂<sub>SPR</sub></italic> is a conservative measure) even when the real history is described by several nearby recombination breakpoints. These simulations also highlight how the SPR distance differentiates an ancestral recombination event (where <italic>d̂<sub>SPR</sub></italic> = 1) from independent recombinations when we are confronted with several recombinant sequences sharing a similar mosaic structure. Distinguishing one ancestral recombination (shared among many sequences) from a recombination hotspot (many recombinations rising independently) can be difficult <xref ref-type="bibr" rid="pone.0002651-Minin2">[22]</xref>. The robustness of our procedure comes from the fact that a breakpoint cannot be pinpointed with arbitrary precision, and the prior on the SPR distance accommodates this compromise. The amount of recombination over a region can, therefore, be quantified regardless of the number of breakpoints just by looking at the sum of <italic>d̂<sub>SPR</sub></italic> over this region.</p><p>Credibility intervals can be constructed in the same way, by including all potential breakpoints (from larger to smaller posterior values), whose accumulated sum lies below some threshold. For example, the 95% credibility interval for <italic>Y</italic> breakpoints (where <italic>Y</italic> is the posterior mean of the total number of breakpoints) can be found by summing up the posterior frequencies of recombination for each segment, where these frequencies are given by the number of samples in which the segment had a distance larger than zero. If the sum is conducted for segments ordered from larger to smaller posterior frequencies, the credibility interval is composed by all segments such that the sum is smaller than 0.95 times <italic>Y</italic>. The same reasoning can be applied to the inference of recombination cold spots, regions where recombination might lead to disruption of protein function <xref ref-type="bibr" rid="pone.0002651-Lefeuvre1">[43]</xref>.</p><p>Applying our method to the HIV-1 dataset, we detected a number of recombination breakpoints much higher than the number detected when parental sequences are assumed. Consequently, there are many undergoing recombinations among BF viruses that may not involve the parental sequences. Moreover, since each SPR represents at least one recombination, the total number of approximate SPR moves is higher than the number of breakpoints (modal values of <italic>d̂<sub>SPR</sub></italic> = 65 distributed among 37 locations). Thus, there are regions with recurrent recombinations in this dataset. One way of identifying these regions is to observe the segments in <xref ref-type="fig" rid="pone-0002651-g006">Figure 6B</xref>, where the mean <italic>d̂<sub>SPR</sub></italic> is larger than one. Simply summing up the mean distances over a region provides an estimate of the minimum number of recombinations in that region. In the same figure (panel C), we can also have an idea about the most promising regions for further analysis. For instance, in the vicinity of <italic>vif-vpr</italic> genes, there is a region free from recombination that has one MAP topology with high support compared to other alternative trees. This region can, therefore, be used to compare the relatedness among distinct subtypes. In conclusion, our results show that HIV-1 variants with similar mosaic patterns may have been subjected to repeated events of recombination, which was not apparent from the mosaic structure.</p></sec><sec id="s4"><title>Methods</title><p>In the next subsection, we propose the approximate SPR distance between topologies. In the following two subsections, we describe the hierarchical Bayesian model, and, in the last two subsections, we describe the implementation of the sampling from the posterior distribution.</p><sec id="s4a"><title>SPR distance of topologies</title><sec id="s4a1"><title>Limits of existing distances in our framework</title><p>In an SPR operation, one edge of a topology together with one of the subtrees that it spans (the pruned subtree) is chosen, and this edge is then regrafted to a distinctly different edge of the remaining subtree <xref ref-type="bibr" rid="pone.0002651-Felsenstein1">[44]</xref>. The SPR distance <italic>d<sub>SPR</sub></italic> is the minimum number of SPR operations needed to reconcile two trees on the same leaf set. For the general case, it can be calculated only by an exhaustive search <xref ref-type="bibr" rid="pone.0002651-Allen1">[45]</xref>, <xref ref-type="bibr" rid="pone.0002651-Nakhleh2">[46]</xref>. Heuristic approaches to calculate <italic>d<sub>SPR</sub></italic> have been proposed in the context of horizontal gene transfer, where we can assume the topologies are rooted <xref ref-type="bibr" rid="pone.0002651-Nakhleh1">[25]</xref>, <xref ref-type="bibr" rid="pone.0002651-Beiko1">[40]</xref>, <xref ref-type="bibr" rid="pone.0002651-Beiko2">[47]</xref>–<xref ref-type="bibr" rid="pone.0002651-MacLeod1">[50]</xref>. These procedures were designed for handling large topologies with a limited number or type of recombinations. The SPR distance is also related to the minimum number of recombination events that took place between two trees <xref ref-type="bibr" rid="pone.0002651-Song3">[51]</xref>. It is possible to use the SPR distance between unrooted topologies as the minimum number of recombinations <xref ref-type="bibr" rid="pone.0002651-Hein1">[52]</xref>, with the remark that the unrooted <italic>d<sub>SPR</sub></italic> will always be a lower bound of the rooted <italic>d<sub>SPR</sub></italic> since the rooting imposes a time constraint on events <xref ref-type="bibr" rid="pone.0002651-Song2">[41]</xref>, <xref ref-type="bibr" rid="pone.0002651-Hein2">[53]</xref>. There is a heuristic algorithm implementing the unrooted version of <italic>d<sub>SPR</sub></italic>, but unfortunately with prohibitive time to be incorporated in our Bayesian analysis <xref ref-type="bibr" rid="pone.0002651-Hickey1">[54]</xref>.</p><p>The most widely used topology metrics are the Robinson-Foulds distance and the maximum agreement subtree (MAST) distance. The Robinson-Foulds distance, or symmetric difference, is based on the split decompositions of the two topologies and is simply the number of edges that have no counterpart in the other topology <xref ref-type="bibr" rid="pone.0002651-Robinson1">[55]</xref>. Another measure is the MAST distance, which describes the number of leaves on the largest subtree that both topologies have in common <xref ref-type="bibr" rid="pone.0002651-Steel1">[56]</xref>. Equivalently, the cMAST is the smallest number of leaves that should be removed from both topologies to make them agree. Unfortunately, neither of these distances is related to the SPR distance (see <xref ref-type="supplementary-material" rid="pone.0002651.s003">Figure S3</xref>).</p><p>Since we are interested in a conservative measure of recombination events, we adopt the <italic>d<sub>SPR</sub></italic> between unrooted topologies. The actual number of recombinations will always be at least as large as our proposed <italic>d̂<sub>SPR</sub></italic>. By doing so, our inference does not depend on resolving the root or on any assumption about potential parental sequences.</p></sec><sec id="s4a2"><title>Proposed algorithm to approximate unrooted d<sub>SPR</sub></title><p>Here, we develop a novel algorithm that calculates the approximate SPR distance <italic>d̂<sub>SPR</sub></italic> between unrooted topologies through a label compression technique in which equal subtrees in both topologies are replaced by a new leaf <xref ref-type="bibr" rid="pone.0002651-Allen1">[45]</xref>. Recalling that a split, or bipartition, is a description of the leaves that become disconnected by removal of the edge it represents, an unrooted binary topology <italic>T</italic> on <italic>N</italic> leaves can be uniquely represented by its split set <italic>B</italic>(<italic>T</italic>) = {<italic>B</italic>(<italic>e</italic><sub>1</sub>),…,<italic>B</italic>(<italic>e<sub>N</sub></italic><sub>−3</sub>)} if we consider only its internal edges <italic>e</italic><sub>1</sub>,…,<italic>e<sub>N</sub></italic><sub>−3</sub> <xref ref-type="bibr" rid="pone.0002651-Bryant1">[57]</xref>. Namely, a bipartition <italic>B</italic>(<italic>e<sub>i</sub></italic>) defined by an edge <italic>e<sub>i</sub></italic> can be represented by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e003" xlink:type="simple"/></disp-formula>where <italic>ε</italic><sub>0</sub>(<italic>e<sub>i</sub></italic>) and <italic>ε</italic><sub>1</sub>(<italic>e<sub>i</sub></italic>) are the leaves separated by edge <italic>e<sub>i</sub></italic>, and Ω represents the whole set of leaves such that |Ω| = <italic>N</italic>. For given two topologies <italic>T</italic> and <italic>T</italic>′, we can then classify its edges <italic>B</italic>(<italic>T</italic>) and <italic>B</italic>(<italic>T</italic>′) into equivalent <italic>B<sub>E</sub></italic>(<italic>T</italic>), <italic>B<sub>E</sub></italic>(<italic>T</italic>′) and nonequivalent edges <italic>B<sub>N</sub></italic>(<italic>T</italic>), <italic>B<sub>N</sub></italic>(<italic>T</italic>′). They represent the set of identical and distinct edges on both topologies as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e004" xlink:type="simple"/></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e005" xlink:type="simple"/></disp-formula>The number of nonequivalent edges between the topologies (|<italic>B<sub>N</sub></italic>(<italic>T</italic>)|+|<italic>B<sub>N</sub></italic>(<italic>T</italic>′)|) is their (unnormalized) Robinson-Foulds distance <xref ref-type="bibr" rid="pone.0002651-Robinson1">[55]</xref>. For binary trees, as is always the case in our study, we also have that |<italic>B<sub>N</sub></italic>(<italic>T</italic>)| = |<italic>B<sub>N</sub></italic>(<italic>T</italic>′)|. The label compression can then be accomplished by iteratively looking at the bipartitions in <italic>B<sub>E</sub></italic>(<italic>T</italic>) where there is <italic>ε</italic><sub>0</sub>(<italic>e<sub>i</sub></italic>) or <italic>ε</italic><sub>1</sub>(<italic>e<sub>i</sub></italic>) with exactly two leaves and then replacing all occurrences of these leaves by a new leaf. Ties (when both |<italic>ε</italic><sub>0</sub>(<italic>e<sub>i</sub></italic>)| = 2 and |<italic>ε</italic><sub>1</sub>(<italic>e<sub>i</sub></italic>)| = 2 are broken by an arbitrary ordering of the leaves, and we acknowledge that this may be a poor solution. <xref ref-type="fig" rid="pone-0002651-g007">Figure 7A</xref> shows an example of such a label compression, where we can observe that the number of SPR events is not affected <xref ref-type="bibr" rid="pone.0002651-Allen1">[45]</xref>. In the third top-down panel in this example, we show the bipartitions representing the (reduced) topologies.</p><fig id="pone-0002651-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0002651.g007</object-id><label>Figure 7</label><caption><title>Example of one iteration of the algorithm that calculates <italic>d̂<sub>SPR</sub></italic>.</title><p>Panel A shows the topologies before and after the label compression in which the subtrees common to both topologies are replaced by a new leaf. Panel B shows the bipartitions induced by the edges of the compressed topologies, where the leaves (1), (a) and (6) represent the subtrees (1,2), ((a,b),(c,d)) and (6,7), respectively. Panel C represents the disagreement splits between all possible edge pairs in which the smallest leaf set for each disagreement split is shown in red. Ties, such as the disagreement between <italic>e</italic><sub>1</sub> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e006" xlink:type="simple"/></inline-formula>, are broken by choosing the leaf set including some specific leaf, one in this case. We can observe that the smallest number of leaves causing a disagreement can be found by comparing <italic>e</italic><sub>2</sub> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e007" xlink:type="simple"/></inline-formula> or, equivalently, <italic>e</italic><sub>3</sub> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e008" xlink:type="simple"/></inline-formula>. The associated subtree is the leaf (a), and, after its removal, both trees will be equivalent.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.g007" xlink:type="simple"/></fig><p>For <italic>B</italic>(<italic>e<sub>i</sub></italic>)∈<italic>B<sub>N</sub></italic>(<italic>T</italic>) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e009" xlink:type="simple"/></inline-formula>, let us define a disagreement split <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e010" xlink:type="simple"/></inline-formula>, where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e011" xlink:type="simple"/></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e012" xlink:type="simple"/></disp-formula><italic>B</italic>(<italic>e<sub>i</sub></italic>) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e013" xlink:type="simple"/></inline-formula> become the same when we consider only the complementary set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e014" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e015" xlink:type="simple"/></inline-formula>. Either of them is the minimal set which satisfies this property. For example, in <xref ref-type="fig" rid="pone-0002651-g007">Figure 7</xref>, we have that the disagreement split between <italic>e</italic><sub>1</sub> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e016" xlink:type="simple"/></inline-formula> will have leaf sets<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e017" xlink:type="simple"/></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e018" xlink:type="simple"/></disp-formula>After calculating the disagreement split between all pairs of edges, we elect the smallest set of leaves found among them (that is, <italic>ε</italic><sub>0</sub>(.,.) or <italic>ε</italic><sub>1</sub>(.,.)), with ties broken by same leaf ordering as previously described. <xref ref-type="fig" rid="pone-0002651-g007">Figure 7C</xref> shows all disagreement splits in our example, where the smallest leaf set (actually just one leaf, after the tree reduction) is depicted in red. This elected set of leaves is then removed from both topologies, and <italic>d̂<sub>SPR</sub></italic> is increased by one. This procedure of label compression and removal of the smallest leaf set in disagreement splits is repeated until all edges are in agreement between the topologies (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e019" xlink:type="simple"/></inline-formula>). The approximate SPR distance between the topologies will then be the iteration count of the procedure.</p><p>Assuming that the comparison between edges can be done in constant time <italic>O</italic>(1), the procedure then has complexity <italic>O</italic>(<italic>d<sub>SPR</sub>N</italic><sup>2</sup>) for distinct trees. We have tried several other ad-hoc procedures, including MAST distance on reduced trees, but the one presented here was empirically the most successful. One simple case where our procedure fails is when the smallest set of leaves has two pruned subtrees. Our procedure counts it as one SPR, and taking the number of leaves into account decreases the performance for many other cases. The program can be extended to show the leaves that were actually removed as opposed to showing the distance, but we must bear in mind that there could be several SPR histories leading to the same minimum number.</p></sec></sec><sec id="s4b"><title>Prior distribution of the distances as a penalty against recombinations</title><p>We introduce a prior distribution for the SPR distance between the topologies of neighboring segments in the hierarchical Bayesian framework. This prior imposes a penalty against inconsistencies of topologies that require too many SPR operations to be resolved. Our assumption is that the number of SPR moves between unrooted topologies is related to the minimum number of recombinations. The strength of the penalty is expressed as a hyper-parameter. By introducing a hyper-prior, the value of the hyper-parameter is estimated as a posterior distribution.</p><p>Denoting the SPR distance <italic>d̂<sub>SPR</sub></italic> at breakpoint <italic>i</italic> by <italic>d<sub>i</sub></italic>, our prior distribution is described as a modified truncated Poisson:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e020" xlink:type="simple"/></disp-formula>Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e021" xlink:type="simple"/></inline-formula>. is the normalizing constant to account for the fact that any two topologies with <italic>N</italic> taxa cannot have an SPR distance larger than <italic>m</italic> = <italic>N</italic>−3, and <italic>w<sub>i</sub></italic> is the weight on the penalty. Poisson distribution has the property of equality between the variance and mean, while the negative binomial distribution is often used to take account of over-dispersion compared with the Poisson distribution. In our case, we can make the segments arbitrarily short, even to 1 bp, as long as the computation is feasible. When the sequence is divided into short segments, it is reasonable to assume that the neighboring segments share the same topology in most cases. Even the Poisson distribution with a mean close to zero may not reflect this expectation sufficiently. The hyper-parameter <italic>w<sub>i</sub></italic> of our modified Poisson distribution will easily adapt to the analysis of short segments since it induces an under-dispersed distribution compared to the Poisson. The prior on the total number of SPR events is not given explicitly since it is determined by this prior probability on the number of SPR moves per segment. The Bayesian hierarchical model incorporates further hyper-priors to account for the uncertainty on the strength of the penalty. That is, <italic>λ<sub>i</sub></italic> and <italic>w<sub>i</sub></italic> follow gamma distributions whose hyper-parameters <italic>α<sub>λ</sub></italic>, <italic>β<sub>λ</sub></italic>, <italic>α<sub>w</sub></italic> and <italic>β<sub>w</sub></italic> are shared across segments. This choice of hyper-priors, together with the “penalty” parameter <italic>w<sub>i</sub></italic>, can take into account under- and over-dispersion of the SPR distance distribution compared to the Poisson distribution.</p></sec><sec id="s4c"><title>Marginal likelihood and the prior for rate heterogeneity among sites and lineages</title><p>The whole alignment <italic>X</italic> is assumed to be decomposed into <italic>K</italic> consecutive segments. Neighboring segments may have different topologies due to recombinations. These segments can be arbitrarily small and should represent all regions with a potentially conflicting phylogenetic signal since our procedure estimates the recombinant regions as a subset of <italic>K</italic> and fixes evolutionary parameters within a segment. At the same time, since the speed of the algorithm is greatly affected by the number of segments, a reasonable choice for the number of segments should be made, with one segment per site in the ideal case. To achieve the robustness against rate heterogeneity, we assume that the evolutionary rate matrices are stochastically distributed among segments.</p><p>We use the standard evolutionary model, where the nucleotide substitution process at a given site is described by a continuous-time Markov chain and a phylogenetic tree describing the ancestral relations between extant taxa <xref ref-type="bibr" rid="pone.0002651-Felsenstein2">[58]</xref>. The evolutionary process of the segment <italic>i</italic> (<italic>i</italic> = 1,…,<italic>K</italic>) is assumed to follow the HKY model <xref ref-type="bibr" rid="pone.0002651-Hasegawa1">[59]</xref>. Each segment has its own ratio <italic>κ<sub>i</sub></italic> (<italic>i</italic> = 1,…,<italic>K</italic>) of transitions to transversions, and the equilibrium frequencies of nucleotides are shared among all segments.</p><p>We write <italic>X</italic> = (<italic>X</italic><sub>1</sub>,…,<italic>X<sub>K</sub></italic>) where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e022" xlink:type="simple"/></inline-formula> is the vector of alignment positions belonging to segment <italic>i</italic>. Denoting the topology of segment <italic>i</italic> by <italic>T<sub>i</sub></italic> and the branch lengths of the <italic>h</italic>th alignment position of the segment by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e023" xlink:type="simple"/></inline-formula>, the conditional likelihood of segment <italic>i</italic> given the branch lengths is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e024" xlink:type="simple"/></disp-formula>where <italic>P</italic> = (<italic>s</italic><sub>1</sub>|<italic>s</italic><sub>0</sub>, <italic>b</italic>, <italic>κ<sub>i</sub></italic>) is the transition probability from nucleotide <italic>s</italic><sub>0</sub> to <italic>s</italic><sub>1</sub>, <italic>node</italic>(<italic>T<sub>i</sub></italic>) is the set of nodes of the topology <italic>T<sub>i</sub></italic>, and <italic>j</italic><sub>0</sub> is the root. If the tree is an unrooted tree, as always in our case, <italic>j</italic><sub>0</sub> is any of the internal nodes and <italic>anc</italic>(<italic>j</italic>) is the parental node of node <italic>j</italic>. The summation is over the states at the internal nodes, and the states at the terminal nodes should fit to the observed data.</p><p>If we assume, such as in <xref ref-type="bibr" rid="pone.0002651-Suchard2">[42]</xref> that all branch lengths follow an exponential distribution with mean <italic>μ<sub>i</sub></italic> and are independent among branches as well as among alignment positions, then we have the marginal likelihood:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e025" xlink:type="simple"/></disp-formula>Here, <italic>P</italic>(<italic>s</italic><sub>1</sub>|<italic>s</italic><sub>0</sub>, <italic>μ<sub>i</sub></italic>, <italic>κ<sub>i</sub></italic>) is the marginal probability of transition from nucleotide <italic>s</italic><sub>0</sub> to <italic>s</italic><sub>1</sub>, which can be calculated analytically through<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e026" xlink:type="simple"/></disp-formula>Since the marginalization is applied to each branch and to each site separately, the model allows the branch lengths to vary among sites while fixing the tree topology. When a large number of sequences are analyzed, our model assumes that the average branch length is common among sites within a segment but that it allows variable rates among segments. By partitioning the alignment into short segments (<italic>e.g.</italic>, less than 10 base pairs), our procedure takes account of rate heterogeneity among sites, with more accurate modeling for smaller segments. The marginalization over individual branches and the assumption of independence among segments should accommodate for rate heterogeneity among lineages and sites.</p><p>In our hierarchical setting, the transition∶transversion ratios <italic>κ<sub>i</sub></italic> and the average substitution rates <italic>μ<sub>i</sub></italic> are independent from each other and from the segments, and they follow exponential distributions with the means <italic>μ</italic><sub>0</sub> and <italic>κ</italic><sub>0</sub>, respectively. Furthermore, <italic>μ</italic><sub>0</sub> and <italic>κ</italic><sub>0</sub> follow exponential distributions with the means <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e027" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e028" xlink:type="simple"/></inline-formula>, respectively. The equilibrium frequencies are calculated empirically from all segments.</p></sec><sec id="s4d"><title>Sampling from the posterior distribution</title><p>If we represent the parameter vector by <italic>θ</italic>, then the posterior probability can be written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e029" xlink:type="simple"/></disp-formula>This distribution is numerically simulated by a Metropolis coupled Markov chain Monte Carlo (MC-MCMC) <xref ref-type="bibr" rid="pone.0002651-Altekar1">[60]</xref>. We employ a Metropolis-within-Gibbs sampler where all parameters are updated sequentially (systematic-scan) and the acceptance probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e030" xlink:type="simple"/></inline-formula> of a candidate state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e031" xlink:type="simple"/></inline-formula> given its current state <italic>θ<sub>i</sub></italic> is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e032" xlink:type="simple"/></inline-formula> where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e033" xlink:type="simple"/></disp-formula><italic>P</italic>(<italic>θ<sub>i</sub></italic>) is shorthand for the prior distribution of parameter <italic>θ<sub>i</sub></italic>, and <italic>q</italic>(·|<italic>θ<sub>i</sub></italic>) is the proposal distribution. The parameter <italic>h</italic> (0&lt;<italic>h</italic>≤1) is the heat value of the chain, and states sampled from the cold chain (<italic>h</italic> = 1) form an approximation of the posterior distribution. We run one cold and one heated (0&lt;<italic>h</italic><sub>2</sub>&lt;1) chain concurrently, such that swap of states between them are accepted with the probability <italic>a</italic>(<italic>h</italic><sub>1</sub>, <italic>h</italic><sub>2</sub>) = min(1, <italic>A</italic>(<italic>h</italic><sub>1</sub>, <italic>h</italic><sub>2</sub>)), where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e034" xlink:type="simple"/></disp-formula>Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e035" xlink:type="simple"/></inline-formula> represents the parameter vector <italic>θ</italic> of chain <italic>h<sub>i</sub></italic>.</p><p>For the continuous variables, namely <italic>μ<sub>i</sub></italic>, <italic>κ<sub>i</sub></italic>, <italic>μ</italic><sub>0</sub>, <italic>κ</italic><sub>0</sub>, <italic>λ<sub>i</sub></italic> and <italic>w<sub>i</sub></italic> a random variable u∼uniform (0,1) is drawn, and the candidate state is set as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e036" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e037" xlink:type="simple"/></inline-formula> is a tuning parameter. The proposal ratio for these cases is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e038" xlink:type="simple"/></inline-formula>.</p><p>We borrowed ideas from reversible-jump MCMC <xref ref-type="bibr" rid="pone.0002651-Suchard2">[42]</xref>, <xref ref-type="bibr" rid="pone.0002651-AlAwadhi1">[61]</xref>, <xref ref-type="bibr" rid="pone.0002651-DiMatteo1">[62]</xref> to increase and decrease the number of recombination breakpoints and to change their location. Since updating all segments independently would have a very poor mixing, we always consider a block of consecutive segments that share the same topology. In our model, the number of parameters is constant, since even the topologies are distinct for every segment.</p></sec><sec id="s4e"><title>Break-points update scheme</title><p>Let <italic>j</italic><sub>1</sub> and <italic>j</italic><sub>2</sub> be two segments such that <italic>T<sub>i</sub></italic> = <italic>T<sub>i</sub></italic><sub>+1</sub> for all <italic>i</italic>∈(<italic>j</italic><sub>1</sub>,…,<italic>j</italic><sub>2</sub>−1). If we call this topology <italic>T<sub>B</sub></italic>, then our proposal topology <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e039" xlink:type="simple"/></inline-formula> will be accepted with the probability<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e040" xlink:type="simple"/></disp-formula>since all segments inside the block share the same topology. The constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e041" xlink:type="simple"/></inline-formula> refers to the proposal ratio, which is usually one. If we have <italic>T<sub>i</sub></italic> = <italic>T<sub>i</sub></italic><sub>+1</sub> for all <italic>i</italic>∈(<italic>k</italic><sub>1</sub>,…,<italic>k</italic><sub>2</sub>−1) with both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e042" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e043" xlink:type="simple"/></inline-formula> non-zero, then (<italic>k</italic><sub>1</sub>,…,<italic>k</italic><sub>2</sub>) is the largest non-recombinant region between <italic>k</italic><sub>1</sub> and <italic>k</italic><sub>2</sub>. The removal of one recombination breakpoint is equivalent to choosing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e044" xlink:type="simple"/></inline-formula> to be equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e045" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e046" xlink:type="simple"/></inline-formula> (with equal probability). The addition of a breakpoint can be attempted by setting <italic>j</italic><sub>1</sub> = <italic>k</italic><sub>1</sub>+1,…,<italic>k</italic><sub>2</sub> or <italic>j</italic><sub>2</sub> = <italic>k</italic><sub>1</sub>,…,<italic>k</italic><sub>2</sub>−1 using the above formula, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e047" xlink:type="simple"/></inline-formula> different from the border topologies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e048" xlink:type="simple"/></inline-formula> (if we chose <italic>j</italic><sub>1</sub>) or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e049" xlink:type="simple"/></inline-formula> (if we pick up <italic>j</italic><sub>2</sub>). If the proposal topology <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e050" xlink:type="simple"/></inline-formula> and the pertinent border are the same, it is equivalent to shifting the recombination breakpoint. If addition and removal of recombination breakpoints are attempted with equal probability, then detailed balance of the chain is satisfied. The exceptions are, thus, the regions before the first and after the last recombination breakpoints, where the frequency of removal updates is twice as large as the frequency of addition updates. For these cases, we set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e051" xlink:type="simple"/></inline-formula> when proposing a breakpoint addition and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e052" xlink:type="simple"/></inline-formula> when proposing a deletion.</p><p>This breakpoints update scheme is performed in a symmetric scan (from the first breakpoint to the last and back). To decrease the autocorrelation between samples, we attempt to update all segments belonging to a non-recombinant region at every iteration by proposing a new topology <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0002651.e053" xlink:type="simple"/></inline-formula>. Here and at the breakpoint addition update, the new topology is chosen by applying one SPR move at the current topology <italic>T<sub>B</sub></italic>. Another move is the nearest-neighbor interchange (NNI), a special case of SPR where the pruned subtree is neighbor to the regraft edge. The frequency <italic>f<sub>NNI</sub></italic> at which an NNI move occurs can be set up to optimize the acceptance rate. Thus, when trying a breakpoint addition on a dataset with <italic>N</italic> taxa,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.e054" xlink:type="simple"/><label>(1)</label></disp-formula>since the numbers 2(<italic>N</italic>−3) and 2(<italic>N</italic>−3)(2<italic>N</italic>−7) correspond to the neighborhood sizes of the NNI and SPR moves, respectively <xref ref-type="bibr" rid="pone.0002651-Allen1">[45]</xref> and the removal is deterministic. When attempting a breakpoint removal, the proposal ratio is the inverse of equation 1.</p><p>With this design, the proposal topology will always have <italic>d<sub>spr</sub></italic> = 1 to the neighboring segment (since they differ by one SPR operation) when proposing a breakpoint addition. Alternatively, topologies with <italic>d<sub>spr</sub></italic> = 1 may be rejected too often at recombination hotspot locations. To increase the acceptance rate in these cases, we developed a sampling procedure equivalent to the one proposed in <xref ref-type="bibr" rid="pone.0002651-AlAwadhi1">[61]</xref>: after proposing a change in the number of breakpoints, we walk on the parameter space by a fixed number of steps. In practice, this means that several SPR or NNI moves are applied before the acceptance/rejection of the final state, decreasing the correlation between samples and allowing for neighboring segments to have a high SPR distance. Further details can be found in <xref ref-type="bibr" rid="pone.0002651-AlAwadhi1">[61]</xref>.</p></sec><sec id="s4f"><title>Initial state sampled from heated “warm-up” chain</title><p>For both chains, their initial states are chosen independently based on cycles with variable temperature, whose initial values are picked up randomly from the priors or set to arbitrary values. When 0&lt;<italic>h</italic>&lt;1, as is usually the case in MC-MCMC, the updates are accepted more often. This allows for a better exploration of the parameter space. Conversely, using <italic>h</italic>&gt;1 is more effective in finding a near-optimum state at the cost of low convergence if the chain is attracted by a local peak. In our simulated annealing scheme, the temperature <italic>h<sub>c</sub></italic> at cycle <italic>c</italic> is given by <italic>h<sub>c</sub></italic> = <italic>h</italic><sub>0</sub>log(<italic>c</italic>+<italic>C</italic>) for some initial temperature <italic>h</italic><sub>0</sub>&gt;0 and <italic>C</italic>&gt;0.</p></sec><sec id="s4g"><title>Availability</title><p>The source code, datasets and scripts used in this study are available at <ext-link ext-link-type="uri" xlink:href="http://corn.ab.a.u-tokyo.ac.jp/~leo/biomc2" xlink:type="simple">http://corn.ab.a.u-tokyo.ac.jp/̃leo/biomc2</ext-link>. The ANSI C source code is available under the GNU public license. In its current implementation a statistical software like R <xref ref-type="bibr" rid="pone.0002651-R1">[63]</xref> is necessary to interpret the posterior distributions, but we are working on a way to circumvent this inconvenience.</p></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pone.0002651.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.s001" xlink:type="simple"><label>Figure S1</label><caption><p>Comparison between d<sub>SPR</sub> and other distances for topologies with 64 taxa.</p><p>(0.30 MB PDF)</p></caption></supplementary-material><supplementary-material id="pone.0002651.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.s002" xlink:type="simple"><label>Figure S2</label><caption><p>MAP topologies for the HIV-1 dataset, arbitrarily rooted at subtype C sequence.</p><p>(0.05 MB PDF)</p></caption></supplementary-material><supplementary-material id="pone.0002651.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.s003" xlink:type="simple"><label>Figure S3</label><caption><p>Failure of distances in estimating the number of SPR operations.</p><p>(0.09 MB PDF)</p></caption></supplementary-material><supplementary-material id="pone.0002651.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pone.0002651.s004" xlink:type="simple"><label>Table S1</label><caption><p>Description of the 11 HIV-1 sequences used in the recombination detection analysis.</p><p>(0.02 MB PDF)</p></caption></supplementary-material></sec></body><back><ack><p>We would like to thank Tae-Kun Seo, Peter Waddell, Mahendra Mariadassou and Avner Bar-Hen for their valuable comments on our earlier draft. We would also like to thank Darren Martin and David Posada for their careful review and their effort to improve the quality of the manuscript. And we thank specially the PLoS ONE team for their transparent review process.</p></ack><ref-list><title>References</title><ref id="pone.0002651-Posada1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Posada</surname><given-names>D</given-names></name></person-group>             <year>2002</year>             <article-title>Evaluation of methods for detecting recombination from DNA sequences: empirical data.</article-title>             <source>Mol Biol Evol</source>             <volume>19</volume>             <fpage>708</fpage>             <lpage>717</lpage>          </element-citation></ref><ref id="pone.0002651-Posada2"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Posada</surname><given-names>D</given-names></name><name name-style="western"><surname>Crandall</surname><given-names>KA</given-names></name><name name-style="western"><surname>Holmes</surname><given-names>EC</given-names></name></person-group>             <year>2002</year>             <article-title>Recombination in evolutionary genomics.</article-title>             <source>Annu Rev Genet</source>             <volume>36</volume>             <fpage>75</fpage>             <lpage>97</lpage>          </element-citation></ref><ref id="pone.0002651-Awadalla1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Awadalla</surname><given-names>P</given-names></name></person-group>             <year>2003</year>             <article-title>The evolutionary genomics of pathogen recombination.</article-title>             <source>Nat Rev Genet</source>             <volume>4</volume>             <fpage>50</fpage>             <lpage>60</lpage>          </element-citation></ref><ref id="pone.0002651-Fearnhead1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fearnhead</surname><given-names>P</given-names></name><name name-style="western"><surname>Harding</surname><given-names>RM</given-names></name><name name-style="western"><surname>Schneider</surname><given-names>JA</given-names></name><name name-style="western"><surname>Myers</surname><given-names>S</given-names></name><name name-style="western"><surname>Donnelly</surname><given-names>P</given-names></name></person-group>             <year>2004</year>             <article-title>Application of coalescent methods to reveal fine-scale rate variation and recombination hotspots.</article-title>             <source>Genetics</source>             <volume>167</volume>             <fpage>2067</fpage>             <lpage>2081</lpage>          </element-citation></ref><ref id="pone.0002651-Golding1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Golding</surname><given-names>GB</given-names></name></person-group>             <year>1984</year>             <article-title>The sampling distribution of linkage disequilibrium.</article-title>             <source>Genetics</source>             <volume>108</volume>             <fpage>257</fpage>             <lpage>274</lpage>          </element-citation></ref><ref id="pone.0002651-Griffiths1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Griffiths</surname><given-names>RC</given-names></name></person-group>             <year>1981</year>             <article-title>Neutral two-locusmultiple allele models with recombination.</article-title>             <source>Theor Popul Biol</source>             <volume>19</volume>             <fpage>169</fpage>             <lpage>186</lpage>          </element-citation></ref><ref id="pone.0002651-Hey1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hey</surname><given-names>J</given-names></name><name name-style="western"><surname>Wakeley</surname><given-names>J</given-names></name></person-group>             <year>1997</year>             <article-title>A coalescent estimator of the population recombination rate.</article-title>             <source>Genetics</source>             <volume>145</volume>             <fpage>833</fpage>             <lpage>846</lpage>          </element-citation></ref><ref id="pone.0002651-Hudson1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hudson</surname><given-names>RR</given-names></name></person-group>             <year>1985</year>             <article-title>The sampling distribution of linkage disequilibrium under an infinite allele model without selection.</article-title>             <source>Genetics</source>             <volume>109</volume>             <fpage>611</fpage>             <lpage>631</lpage>          </element-citation></ref><ref id="pone.0002651-Hudson2"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hudson</surname><given-names>RR</given-names></name></person-group>             <year>2001</year>             <article-title>Two-locus sampling distributions and their application.</article-title>             <source>Genetics</source>             <volume>159</volume>             <fpage>1805</fpage>             <lpage>1817</lpage>          </element-citation></ref><ref id="pone.0002651-Kuhner1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kuhner</surname><given-names>MK</given-names></name><name name-style="western"><surname>Yamato</surname><given-names>J</given-names></name><name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name></person-group>             <year>2000</year>             <article-title>Maximum likelihood estimation of recombination rates from population data.</article-title>             <source>Genetics</source>             <volume>156</volume>             <fpage>1393</fpage>             <lpage>1401</lpage>          </element-citation></ref><ref id="pone.0002651-McVean1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>McVean</surname><given-names>G</given-names></name><name name-style="western"><surname>Awadalla</surname><given-names>P</given-names></name><name name-style="western"><surname>Fearnhead</surname><given-names>P</given-names></name></person-group>             <year>2002</year>             <article-title>A coalescent-based method for detecting and estimating recombination from gene sequences.</article-title>             <source>Genetics</source>             <volume>160</volume>             <fpage>1231</fpage>             <lpage>1241</lpage>          </element-citation></ref><ref id="pone.0002651-Nielsen1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nielsen</surname><given-names>R</given-names></name></person-group>             <year>2000</year>             <article-title>Estimation of population parameters and recombination rates from single nucleotide polymorphisms.</article-title>             <source>Genetics</source>             <volume>154</volume>             <fpage>931</fpage>             <lpage>942</lpage>          </element-citation></ref><ref id="pone.0002651-Wiuf1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wiuf</surname><given-names>C</given-names></name><name name-style="western"><surname>Posada</surname><given-names>D</given-names></name></person-group>             <year>2003</year>             <article-title>A coalescent model of recombination hotspots.</article-title>             <source>Genetics</source>             <volume>164</volume>             <fpage>407</fpage>             <lpage>417</lpage>          </element-citation></ref><ref id="pone.0002651-Siepel1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Siepel</surname><given-names>AC</given-names></name><name name-style="western"><surname>Halperen</surname><given-names>AL</given-names></name><name name-style="western"><surname>Macken</surname><given-names>C</given-names></name><name name-style="western"><surname>Korber</surname><given-names>B</given-names></name></person-group>             <year>1995</year>             <article-title>A computer program designed to screen rapidly for HIV type 1 intersubtype recombinant sequences.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>11</volume>             <fpage>1413</fpage>             <lpage>1416</lpage>          </element-citation></ref><ref id="pone.0002651-Salminen1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Salminen</surname><given-names>MO</given-names></name><name name-style="western"><surname>Carr</surname><given-names>JK</given-names></name><name name-style="western"><surname>Burke</surname><given-names>DS</given-names></name><name name-style="western"><surname>McCutchan</surname><given-names>FE</given-names></name></person-group>             <year>1995</year>             <article-title>Identication of breakpoints in intergenotypic recombinants of HIV type 1 by bootscanning.</article-title>             <source>AIDS Res Hum Retroviruses</source>             <volume>11</volume>             <fpage>1423</fpage>             <lpage>1425</lpage>          </element-citation></ref><ref id="pone.0002651-Weiller1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Weiller</surname><given-names>GF</given-names></name></person-group>             <year>1998</year>             <article-title>Phylogenetic profiles: a graphical method for detecting genetic recombinations in homologous sequences.</article-title>             <source>Mol Biol Evol</source>             <volume>15</volume>             <fpage>326</fpage>             <lpage>335</lpage>          </element-citation></ref><ref id="pone.0002651-Grassly1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Grassly</surname><given-names>NC</given-names></name><name name-style="western"><surname>Holmes</surname><given-names>EC</given-names></name></person-group>             <year>1997</year>             <article-title>A likelihood method for the detection of selection and recombination using nucleotide sequences.</article-title>             <source>Mol Biol Evol</source>             <volume>14</volume>             <fpage>239</fpage>             <lpage>247</lpage>          </element-citation></ref><ref id="pone.0002651-Husmeier1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Husmeier</surname><given-names>D</given-names></name><name name-style="western"><surname>Wright</surname><given-names>F</given-names></name></person-group>             <year>2001</year>             <article-title>Probabilistic divergence measures for detecting interspecies recombination.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>S123</fpage>             <lpage>S131</lpage>          </element-citation></ref><ref id="pone.0002651-Husmeier2"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Husmeier</surname><given-names>D</given-names></name></person-group>             <year>2005</year>             <article-title>Discriminating between rate heterogeneity and interspecific recombination in DNA sequence alignments with phylogenetic factorial hidden Markov models.</article-title>             <source>Bioinformatics</source>             <volume>21</volume><supplement>Suppl 2</supplement>             <fpage>ii166</fpage>             <lpage>172</lpage>          </element-citation></ref><ref id="pone.0002651-Husmeier3"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Husmeier</surname><given-names>D</given-names></name><name name-style="western"><surname>Wright</surname><given-names>F</given-names></name></person-group>             <year>2001</year>             <article-title>Detection of recombination in DNA multiple alignments with hidden Markov models.</article-title>             <source>J Comput Biol</source>             <volume>8</volume>             <fpage>401</fpage>             <lpage>427</lpage>          </element-citation></ref><ref id="pone.0002651-Minin1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Minin</surname><given-names>VN</given-names></name><name name-style="western"><surname>Dorman</surname><given-names>KS</given-names></name><name name-style="western"><surname>Fang</surname><given-names>F</given-names></name><name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name></person-group>             <year>2005</year>             <article-title>Dual multiple change-point model leads to more accurate recombination detection.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>3034</fpage>             <lpage>3042</lpage>          </element-citation></ref><ref id="pone.0002651-Minin2"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Minin</surname><given-names>VN</given-names></name><name name-style="western"><surname>Dorman</surname><given-names>KS</given-names></name><name name-style="western"><surname>Fang</surname><given-names>F</given-names></name><name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name></person-group>             <year>2007</year>             <article-title>Phylogenetic mapping of recombination hotspots in human immunodeficiency virus via spatially smoothed change-point processes.</article-title>             <source>Genetics</source>             <volume>175</volume>             <fpage>1773</fpage>             <lpage>1785</lpage>          </element-citation></ref><ref id="pone.0002651-Sierra1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sierra</surname><given-names>M</given-names></name><name name-style="western"><surname>Thomson</surname><given-names>MM</given-names></name><name name-style="western"><surname>Rios</surname><given-names>M</given-names></name><name name-style="western"><surname>Casado</surname><given-names>G</given-names></name><name name-style="western"><surname>Castro</surname><given-names>RO</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>The analysis of near full-length genome sequences of human immunodeficiency virus type 1 BF intersubtype recombinant viruses from Chile, Venezuela and Spain reveals their relationship to diverse lineages of recombinant viruses related to CRF12_BF.</article-title>             <source>Infect Genet Evol</source>             <volume>5</volume>             <fpage>209</fpage>             <lpage>217</lpage>          </element-citation></ref><ref id="pone.0002651-Hordijk1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hordijk</surname><given-names>W</given-names></name><name name-style="western"><surname>Gascuel</surname><given-names>O</given-names></name></person-group>             <year>2005</year>             <article-title>Improving the efficiency of SPR moves in phylogenetic tree search methods based on maximum likelihood.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>4338</fpage>             <lpage>4347</lpage>          </element-citation></ref><ref id="pone.0002651-Nakhleh1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nakhleh</surname><given-names>L</given-names></name><name name-style="western"><surname>Ruths</surname><given-names>D</given-names></name><name name-style="western"><surname>Wang</surname><given-names>LS</given-names></name></person-group>             <year>2005</year>             <article-title>RIATA-HGT: A fast and accurate heuristic for reconstructing horizontal gene transfer.</article-title>             <source>Computing and Combinatorics, Proceedings</source>             <volume>3595</volume>             <fpage>84</fpage>             <lpage>93</lpage>          </element-citation></ref><ref id="pone.0002651-Suchard1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name></person-group>             <year>2005</year>             <article-title>Stochastic models for horizontal gene transfer: taking a random walk through tree space.</article-title>             <source>Genetics</source>             <volume>170</volume>             <fpage>419</fpage>             <lpage>431</lpage>          </element-citation></ref><ref id="pone.0002651-Yang1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z</given-names></name></person-group>             <year>1997</year>             <article-title>PAML: a program package for phylogenetic analysis by maximum likelihood.</article-title>             <source>Comput Appl Biosci</source>             <volume>13</volume>             <fpage>555</fpage>             <lpage>556</lpage>          </element-citation></ref><ref id="pone.0002651-Fang1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fang</surname><given-names>F</given-names></name><name name-style="western"><surname>Ding</surname><given-names>J</given-names></name><name name-style="western"><surname>Minin</surname><given-names>VN</given-names></name><name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name><name name-style="western"><surname>Dorman</surname><given-names>KS</given-names></name></person-group>             <year>2007</year>             <article-title>cBrother: relaxing parental tree assumptions for Bayesian recombination detection.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>507</fpage>             <lpage>508</lpage>          </element-citation></ref><ref id="pone.0002651-Chan1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chan</surname><given-names>CX</given-names></name><name name-style="western"><surname>Beiko</surname><given-names>RG</given-names></name><name name-style="western"><surname>Ragan</surname><given-names>MA</given-names></name></person-group>             <year>2006</year>             <article-title>Detecting recombination in evolving nucleotide sequences.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <fpage>412</fpage>          </element-citation></ref><ref id="pone.0002651-Rajaram1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rajaram</surname><given-names>ML</given-names></name><name name-style="western"><surname>Minin</surname><given-names>VN</given-names></name><name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name><name name-style="western"><surname>Dorman</surname><given-names>KS</given-names></name></person-group>             <year>2007</year>             <article-title>Hot and Cold: Spatial Fluctuation in HIV-1 Recombination Rates.</article-title>             <source>Bioinformatics and Bioengineering, 2007 BIBE 2007 Proceedings of the 7th IEEE International Conference on</source>             <fpage>707</fpage>             <lpage>714</lpage>          </element-citation></ref><ref id="pone.0002651-Huelsenbeck1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name><name name-style="western"><surname>Ronquist</surname><given-names>F</given-names></name></person-group>             <year>2001</year>             <article-title>MRBAYES: Bayesian inference of phylogenetic trees.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>754</fpage>             <lpage>755</lpage>          </element-citation></ref><ref id="pone.0002651-Ronquist1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ronquist</surname><given-names>F</given-names></name><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name></person-group>             <year>2003</year>             <article-title>MrBayes 3: Bayesian phylogenetic inference under mixed models.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>1572</fpage>             <lpage>1574</lpage>          </element-citation></ref><ref id="pone.0002651-Swofford1"><label>33</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Swofford</surname><given-names>DL</given-names></name></person-group>             <year>2002</year>             <source>PAUP*. Phylogenetic Analysis Using Parsimony (* and Other Methods) Version 4.0 b10</source>             <publisher-loc>Sunderland, MA</publisher-loc>             <publisher-name>Sinauer Associates</publisher-name>          </element-citation></ref><ref id="pone.0002651-Gelman1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gelman</surname><given-names>A</given-names></name><name name-style="western"><surname>Rubin</surname><given-names>DB</given-names></name></person-group>             <year>1992</year>             <article-title>Inference from Iterative Simulation Using Multiple Sequences.</article-title>             <source>Statistical Science</source>             <volume>7</volume>             <fpage>457</fpage>             <lpage>472</lpage>          </element-citation></ref><ref id="pone.0002651-JotunHein1"><label>35</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jotun Hein</surname><given-names>MHS</given-names></name></person-group>             <year>2005</year>             <source>Gene Genealogies, Variation and Evolution: A Primer in Coalescent Theory</source>             <publisher-name>Oxford University Press</publisher-name>          </element-citation></ref><ref id="pone.0002651-Song1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Song</surname><given-names>YS</given-names></name><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>             <year>2005</year>             <article-title>Constructing minimal ancestral recombination graphs.</article-title>             <source>J Comput Biol</source>             <volume>12</volume>             <fpage>147</fpage>             <lpage>169</lpage>          </element-citation></ref><ref id="pone.0002651-Drummond1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name><name name-style="western"><surname>Ho</surname><given-names>SY</given-names></name><name name-style="western"><surname>Phillips</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name></person-group>             <year>2006</year>             <article-title>Relaxed phylogenetics and dating with confidence.</article-title>             <source>PLoS Biol</source>             <volume>4</volume>             <fpage>e88</fpage>          </element-citation></ref><ref id="pone.0002651-Kishino1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name><name name-style="western"><surname>Thorne</surname><given-names>JL</given-names></name><name name-style="western"><surname>Bruno</surname><given-names>WJ</given-names></name></person-group>             <year>2001</year>             <article-title>Performance of a divergence time estimation method under a probabilistic model of rate evolution.</article-title>             <source>Mol Biol Evol</source>             <volume>18</volume>             <fpage>352</fpage>             <lpage>361</lpage>          </element-citation></ref><ref id="pone.0002651-Thorne1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Thorne</surname><given-names>JL</given-names></name><name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name></person-group>             <year>2002</year>             <article-title>Divergence time and evolutionary rate estimation with multilocus data.</article-title>             <source>Syst Biol</source>             <volume>51</volume>             <fpage>689</fpage>             <lpage>702</lpage>          </element-citation></ref><ref id="pone.0002651-Beiko1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Beiko</surname><given-names>RG</given-names></name><name name-style="western"><surname>Hamilton</surname><given-names>N</given-names></name></person-group>             <year>2006</year>             <article-title>Phylogenetic identification of lateral genetic transfer events.</article-title>             <source>BMC Evol Biol</source>             <volume>6</volume>             <fpage>15</fpage>          </element-citation></ref><ref id="pone.0002651-Song2"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Song</surname><given-names>YS</given-names></name></person-group>             <year>2003</year>             <article-title>On the Combinatorics of Rooted Binary Phylogenetic Trees.</article-title>             <source>Annals of Combinatorics</source>             <volume>7</volume>             <fpage>365</fpage>             <lpage>379</lpage>          </element-citation></ref><ref id="pone.0002651-Suchard2"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name><name name-style="western"><surname>Weiss</surname><given-names>RE</given-names></name><name name-style="western"><surname>Dorman</surname><given-names>KS</given-names></name><name name-style="western"><surname>Sinsheimer</surname><given-names>JS</given-names></name></person-group>             <year>2003</year>             <article-title>Inferring spatial phylogenetic variation along nucleotide sequences: a multiple changepoint model.</article-title>             <source>J Am Stat Assoc</source>             <volume>98</volume>             <fpage>427</fpage>             <lpage>438</lpage>          </element-citation></ref><ref id="pone.0002651-Lefeuvre1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lefeuvre</surname><given-names>P</given-names></name><name name-style="western"><surname>Lett</surname><given-names>JM</given-names></name><name name-style="western"><surname>Reynaud</surname><given-names>B</given-names></name><name name-style="western"><surname>Martin</surname><given-names>DP</given-names></name></person-group>             <year>2007</year>             <article-title>Avoidance of protein fold disruption in natural virus recombinants.</article-title>             <source>PLoS Pathog</source>             <volume>3(11)</volume>                      <fpage>e181</fpage><comment>doi:10.1371/journal.ppat.0030181</comment>          </element-citation></ref><ref id="pone.0002651-Felsenstein1"><label>44</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name></person-group>             <year>2004</year>             <source>Inferring phylogenies</source>             <publisher-loc>Sinauer Associates Sunderland, Mass., USA</publisher-loc>          </element-citation></ref><ref id="pone.0002651-Allen1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Allen</surname><given-names>BL</given-names></name><name name-style="western"><surname>Steel</surname><given-names>MA</given-names></name></person-group>             <year>2001</year>             <article-title>Subtree transfer operations and their induced metrics on evolutionary trees.</article-title>             <source>Annals of Combinatorics</source>             <volume>5</volume>             <fpage>1</fpage>             <lpage>15</lpage>          </element-citation></ref><ref id="pone.0002651-Nakhleh2"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nakhleh</surname><given-names>L</given-names></name><name name-style="western"><surname>Warnow</surname><given-names>T</given-names></name><name name-style="western"><surname>Linder</surname><given-names>CR</given-names></name><name name-style="western"><surname>St John</surname><given-names>K</given-names></name></person-group>             <year>2005</year>             <article-title>Reconstructing reticulate evolution in species-theory and practice.</article-title>             <source>J Comput Biol</source>             <volume>12</volume>             <fpage>796</fpage>             <lpage>811</lpage>          </element-citation></ref><ref id="pone.0002651-Beiko2"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Beiko</surname><given-names>RG</given-names></name><name name-style="western"><surname>Harlow</surname><given-names>TJ</given-names></name><name name-style="western"><surname>Ragan</surname><given-names>MA</given-names></name></person-group>             <year>2005</year>             <article-title>Highways of gene sharing in prokaryotes.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>102</volume>             <fpage>14332</fpage>             <lpage>14337</lpage>          </element-citation></ref><ref id="pone.0002651-Ge1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ge</surname><given-names>F</given-names></name><name name-style="western"><surname>Wang</surname><given-names>LS</given-names></name><name name-style="western"><surname>Kim</surname><given-names>J</given-names></name></person-group>             <year>2005</year>             <article-title>The cobweb of life revealed by genome-scale estimates of horizontal gene transfer.</article-title>             <source>PLoS Biol</source>             <volume>3</volume>             <fpage>e316</fpage>          </element-citation></ref><ref id="pone.0002651-Hallett1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hallett</surname><given-names>MT</given-names></name><name name-style="western"><surname>Lagergren</surname><given-names>J</given-names></name></person-group>             <year>2001</year>             <article-title>Efficient algorithms for lateral gene transfer problems.</article-title>             <source>Proc Fifth Ann Intl Conf Comput Biol</source>             <fpage>149</fpage>             <lpage>156</lpage>          </element-citation></ref><ref id="pone.0002651-MacLeod1"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>MacLeod</surname><given-names>D</given-names></name><name name-style="western"><surname>Charlebois</surname><given-names>RL</given-names></name><name name-style="western"><surname>Doolittle</surname><given-names>F</given-names></name><name name-style="western"><surname>Bapteste</surname><given-names>E</given-names></name></person-group>             <year>2005</year>             <article-title>Deduction of probable events of lateral gene transfer through comparison of phylogenetic trees by recursive consolidation and rearrangement.</article-title>             <source>BMC Evol Biol</source>             <volume>5</volume>             <fpage>27</fpage>          </element-citation></ref><ref id="pone.0002651-Song3"><label>51</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Song</surname><given-names>YS</given-names></name><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>             <year>2003</year>             <article-title>Parsimonious Reconstruction of Sequence Evolution and Haplotype Blocks: Finding the Minimum Number of Recombination Events.</article-title>             <fpage>287</fpage>             <lpage>302</lpage>             <comment>Algorithms in Bioinformatics: Third International Workshop, WABI 2003, Budapest, Hungary, September 15–20, 2003: Proceedings:</comment>          </element-citation></ref><ref id="pone.0002651-Hein1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>             <year>1990</year>             <article-title>Reconstructing evolution of sequences subject to recombination using parsimony.</article-title>             <source>Math Biosci</source>             <volume>98</volume>             <fpage>185</fpage>             <lpage>200</lpage>          </element-citation></ref><ref id="pone.0002651-Hein2"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>             <year>1993</year>             <article-title>A Heuristic Method to Reconstruct the History of Sequences Subject to Recombination.</article-title>             <source>Journal of Molecular Evolution</source>             <volume>36</volume>             <fpage>396</fpage>             <lpage>405</lpage>          </element-citation></ref><ref id="pone.0002651-Hickey1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hickey</surname><given-names>G</given-names></name><name name-style="western"><surname>Dehne</surname><given-names>F</given-names></name><name name-style="western"><surname>Rau-Chaplin</surname><given-names>A</given-names></name><name name-style="western"><surname>Blouin</surname><given-names>C</given-names></name></person-group>             <year>2008</year>             <article-title>SPR Distance Computation for Unrooted Trees.</article-title>             <source>Evolutionary Bioinformatics 2008</source>             <volume>4</volume>             <fpage>17</fpage>             <lpage>27</lpage>          </element-citation></ref><ref id="pone.0002651-Robinson1"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>DF</given-names></name><name name-style="western"><surname>Foulds</surname><given-names>LR</given-names></name></person-group>             <year>1981</year>             <article-title>Comparison of phylogenetic trees.</article-title>             <source>Math Biosci</source>             <volume>53</volume>             <fpage>131</fpage>             <lpage>147</lpage>          </element-citation></ref><ref id="pone.0002651-Steel1"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Steel</surname><given-names>M</given-names></name><name name-style="western"><surname>Warnow</surname><given-names>T</given-names></name></person-group>             <year>1993</year>             <article-title>Kaikoura Tree Theorems-Computing the Maximum Agreement Subtree.</article-title>             <source>Information Processing Letters</source>             <volume>48</volume>             <fpage>77</fpage>             <lpage>82</lpage>          </element-citation></ref><ref id="pone.0002651-Bryant1"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bryant</surname><given-names>D</given-names></name><name name-style="western"><surname>Moulton</surname><given-names>V</given-names></name></person-group>             <year>2004</year>             <article-title>Neighbor-net: an agglomerative method for the construction of phylogenetic networks.</article-title>             <source>Mol Biol Evol</source>             <volume>21</volume>             <fpage>255</fpage>             <lpage>265</lpage>          </element-citation></ref><ref id="pone.0002651-Felsenstein2"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name></person-group>             <year>1981</year>             <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach.</article-title>             <source>J Mol Evol</source>             <volume>17</volume>             <fpage>368</fpage>             <lpage>376</lpage>          </element-citation></ref><ref id="pone.0002651-Hasegawa1"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hasegawa</surname><given-names>M</given-names></name><name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name><name name-style="western"><surname>Yano</surname><given-names>T</given-names></name></person-group>             <year>1985</year>             <article-title>Dating of the human-ape splitting by a molecular clock of mitochondrial DNA.</article-title>             <source>J Mol Evol</source>             <volume>22</volume>             <fpage>160</fpage>             <lpage>174</lpage>          </element-citation></ref><ref id="pone.0002651-Altekar1"><label>60</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altekar</surname><given-names>G</given-names></name><name name-style="western"><surname>Dwarkadas</surname><given-names>S</given-names></name><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name><name name-style="western"><surname>Ronquist</surname><given-names>F</given-names></name></person-group>             <year>2004</year>             <article-title>Parallel Metropolis coupled Markov chain Monte Carlo for Bayesian phylogenetic inference.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>407</fpage>             <lpage>415</lpage>          </element-citation></ref><ref id="pone.0002651-AlAwadhi1"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Al-Awadhi</surname><given-names>F</given-names></name><name name-style="western"><surname>Hurn</surname><given-names>M</given-names></name><name name-style="western"><surname>Jennison</surname><given-names>C</given-names></name></person-group>             <year>2004</year>             <article-title>Improving the acceptance rate of reversible jump MCMC proposals.</article-title>             <source>Statistics &amp; Probability Letters</source>             <volume>69</volume>             <fpage>189</fpage>             <lpage>198</lpage>          </element-citation></ref><ref id="pone.0002651-DiMatteo1"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>DiMatteo</surname><given-names>I</given-names></name><name name-style="western"><surname>Genovese</surname><given-names>CR</given-names></name><name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name></person-group>             <year>2001</year>             <article-title>Bayesian curve-fitting with free-knot splines.</article-title>             <source>Biometrika</source>             <volume>88</volume>             <fpage>1055</fpage>             <lpage>1071</lpage>          </element-citation></ref><ref id="pone.0002651-R1"><label>63</label><element-citation publication-type="other" xlink:type="simple">             <collab xlink:type="simple">R Development Core Team</collab>             <year>2008</year>             <article-title>R: A Language and Environment for Statistical Computing. Vienna: R Foundation for Statistical Computing. ISBN 3-900051-07-0.</article-title>             <comment>Available <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/" xlink:type="simple">http://www.R-project.org/</ext-link>. Accessed 22 May 2008</comment>          </element-citation></ref></ref-list></back></article>