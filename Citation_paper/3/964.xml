<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pone.0211445</article-id>
<article-id pub-id-type="publisher-id">PONE-D-17-37802</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecological metrics</subject><subj-group><subject>Species diversity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecological metrics</subject><subj-group><subject>Species diversity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Artificial neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Artificial neural networks</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Artificial neural networks</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Fish</subject><subj-group><subject>Freshwater fish</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Marine and aquatic sciences</subject><subj-group><subject>Bodies of water</subject><subj-group><subject>Rivers</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Aquatic environments</subject><subj-group><subject>Freshwater environments</subject><subj-group><subject>Rivers</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Marine and aquatic sciences</subject><subj-group><subject>Aquatic environments</subject><subj-group><subject>Freshwater environments</subject><subj-group><subject>Rivers</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Pollution</subject><subj-group><subject>Water pollution</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecosystems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecosystems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Freshwater ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Freshwater ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Limnology</subject><subj-group><subject>Freshwater ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Marine and aquatic sciences</subject><subj-group><subject>Limnology</subject><subj-group><subject>Freshwater ecology</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Habitats</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>An ecologically constrained procedure for sensitivity analysis of Artificial Neural Networks and other empirical models</article-title>
<alt-title alt-title-type="running-head">An ecologically constrained procedure for sensitivity analysis of Artificial Neural Networks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9725-4346</contrib-id>
<name name-style="western">
<surname>Franceschini</surname>
<given-names>Simone</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Tancioni</surname>
<given-names>Lorenzo</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8548-9487</contrib-id>
<name name-style="western">
<surname>Lorenzoni</surname>
<given-names>Massimo</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Mattei</surname>
<given-names>Francesco</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Scardi</surname>
<given-names>Michele</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Biology, University of Rome Tor Vergata, Rome, Italy</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Chemistry, Biology and Biotechnology, Perugia, Italy</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Gross</surname>
<given-names>Thilo</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University Of Bristol, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">smn.franceschini@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>30</day>
<month>1</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<year>2019</year>
</pub-date>
<volume>14</volume>
<issue>1</issue>
<elocation-id>e0211445</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>10</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>15</day>
<month>1</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Franceschini et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0211445"/>
<abstract>
<p>Sensitivity analysis applied to Artificial Neural Networks (ANNs) as well as to other types of empirical ecological models allows assessing the importance of environmental predictive variables in affecting species distribution or other target variables. However, approaches that only consider values of the environmental variables that are likely to be observed in real-world conditions, given the underlying ecological relationships with other variables, have not yet been proposed. Here, a constrained sensitivity analysis procedure is presented, which evaluates the importance of the environmental variables considering only their plausible changes, thereby exploring only ecological meaningful scenarios. To demonstrate the procedure, we applied it to an ANN model predicting fish species richness, as identifying relationships between environmental variables and fish species occurrence in river ecosystems is a recurring topic in freshwater ecology. Results showed that several environmental variables played a less relevant role in driving the model output when that sensitivity analysis allowed them to vary only within an ecologically meaningful range of values, i.e. avoiding values that the model would never handle in its practical applications. By comparing percent changes in MSE between constrained and unconstrained sensitivity analysis, the relative importance of environmental variables was found to be different, with habitat descriptors and urbanization factors that played a more relevant role according to the constrained procedure. The ecologically constrained procedure can be applied to any sensitivity analysis method for ANNs, but obviously it can also be applied to other types of empirical ecological models.</p>
</abstract>
<funding-group>
<funding-statement>The author(s) received no specific funding for this work.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="1"/>
<page-count count="15"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>1. Introduction</title>
<p>Fish assemblage diversity in freshwater ecosystems constitutes a valuable natural resource in economic, scientific, cultural and educational terms [<xref ref-type="bibr" rid="pone.0211445.ref001">1</xref>]. Its conservation and management face threats as overexploitation of inland waters, flow modification, water pollution, habitat degradation and invasion by exotic species [<xref ref-type="bibr" rid="pone.0211445.ref002">2</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref003">3</xref>]. Identifying the relationships between fish species richness and habitat complexity at a local scale is one of the primary concerns in understanding how environmental descriptors actually affect fish biodiversity [<xref ref-type="bibr" rid="pone.0211445.ref004">4</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref005">5</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref006">6</xref>].</p>
<p>In this respect, the ecological variables that can be taken into account are often characterized by complex and non-linear dependencies [<xref ref-type="bibr" rid="pone.0211445.ref007">7</xref>]. Ecological models have been increasingly applied in the management and conservation of freshwater fish communities, especially to predict spatial patterns of fish occurrence [<xref ref-type="bibr" rid="pone.0211445.ref008">8</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref009">9</xref>]. In particular, Artificial Neural Networks (ANNs) modeling has proved to be a valuable method in order to assess whether predictable relationship between environmental descriptors and fish species richness exist in small stream environments [<xref ref-type="bibr" rid="pone.0211445.ref010">10</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref011">11</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref012">12</xref>].</p>
<p>While in the past ANNs were defined as “black boxes” since the computational processes taking place inside them are not easy to untangle, at present several methodologies have been developed to assess the contribution of each variable to the prediction process. For deeper elucidations, Olden et al. [<xref ref-type="bibr" rid="pone.0211445.ref013">13</xref>] provided a comprehensive review and comparison of these methodologies.</p>
<p>In particular, sensitivity analysis is the term used to define a collection of methods that evaluate how sensitive model output is to changes in the values of predictive variables [<xref ref-type="bibr" rid="pone.0211445.ref014">14</xref>]. In ecology, the main sensitivity analysis methods applied to ANNs can be classified into four categories: (i) the Lek’s profiles method [<xref ref-type="bibr" rid="pone.0211445.ref015">15</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref016">16</xref>]; (ii) the Perturbation method [<xref ref-type="bibr" rid="pone.0211445.ref017">17</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref018">18</xref>]; (iii) the Partial Derivatives method [<xref ref-type="bibr" rid="pone.0211445.ref019">19</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref020">20</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref021">21</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref022">22</xref>]; (iv) the Weights method, developed by Garson [<xref ref-type="bibr" rid="pone.0211445.ref023">23</xref>] and then implemented by Olden &amp; Jackson [<xref ref-type="bibr" rid="pone.0211445.ref024">24</xref>]. Lek’s profiles study each input variable by keeping all other parameters at fixed values, while in Perturbation method each input variable is perturbed according to empirically established ranges while all others are kept untouched. The Partial Derivatives method involves small changes in each input variable and the evaluation of their relative contribution by computing the partial derivatives of the ANN output with respect to changes in the input. In the Weights method the connection weights of the ANN model are partitioned to evaluate the relative importance of each input variable and its positive or negative contribution to the model output. In the application of the first three methods, the values assigned to input variables can be devoid of real ecological meaning, i.e. they can be out of the range that is likely to be observed in real-world conditions. In these cases, environmental variables are forced to values that are only aimed at evaluating the model output, with no attention to the actual probability of recording those values given the (fixed) values of all the other variables. In fact, while of course the above-mentioned methods may provide valuable information about the way the “black-box” model works, the role of ecological relationships in constraining the multidimensional space where meaningful data patterns exist is not fully taken into account. With regard to the Weights method instead, the estimation of the input variables importance based on the connection weights may result unbalanced in certain cases where <italic>constrained</italic> training procedure may be applied to the ANN model for optimization purposes [<xref ref-type="bibr" rid="pone.0211445.ref025">25</xref>] (NB: in this sentence the term <italic>constrained</italic> is referred to the training procedure developed by Scardi [<xref ref-type="bibr" rid="pone.0211445.ref025">25</xref>] and it has nothing to do with the constrained perturbation of input variables here illustrated).</p>
<p>Therefore, although all those methodologies proved to be means of determining the overall numerical influence of each predictor variable to the model output, approaches that only consider changes consistent with the ecological relationships among environmental variables have never been proposed. It is well known in ecology that most environmental variables are far from independent of each other [<xref ref-type="bibr" rid="pone.0211445.ref026">26</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref027">27</xref>]and therefore not all the combinations of their values are likely to occur (e.g. river slope tends to increase with elevation, as does the water oxygen concentration, and cannot be very steep in a floodplain). As these relationships constrain each variable in the complex multidimensional space that represents the abiotic conditions found in an ecosystem, some combinations of values are more easily found, while others just cannot occur. In fact, for instance, it would be highly unlikely for the maximum width of a stream channel to occur in a headwaters reach.</p>
<p>These issues raise the question: what is the point of perturbing or fixing variables at values which are ecologically meaningless? Evaluating the model output response in areas of the multidimensional space where environmental descriptors take far-fetched values may not be useful from an ecological perspective. Indeed it would make more sense to evaluate how sensitive model output is to changes in predictive variables values taking into account only plausible perturbations, i.e. changes which are consistent with the ecological relationships between environmental variables.</p>
<p>This study demonstrates an example of a new type of sensitivity analysis, using a case study about an ANN model aimed at predicting fish species richness in central Italian rivers. The goal of this work is to evaluate the real contribution of each predictive variable to species richness estimates by taking into full account the underlying ecological relationships and constraints. This way, all the perturbations applied to predictive variables reflect plausible environmental conditions, thus evaluating shifts in fish species richness only among ecological meaningful scenarios.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>2. Material and methods</title>
<sec id="sec003">
<title>2.1. Study area and data collection</title>
<p>Data have been obtained from 368 sites that have been sampled from 2009 to 2014 in central Italy [<xref ref-type="bibr" rid="pone.0211445.ref028">28</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref029">29</xref>] (<xref ref-type="fig" rid="pone.0211445.g001">Fig 1</xref>). Most rivers in this area are characterized by a Mediterranean climate, hydrological regimes affected by rainfall variability and strong seasonal discharge variation, with high flows in spring and fall, and droughts in summer [<xref ref-type="bibr" rid="pone.0211445.ref030">30</xref>].</p>
<fig id="pone.0211445.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0211445.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Sampling sites.</title>
<p>Elevation map of the river basins of latium and umbria administrative regions in central Italy. Black dots mark the position of sampling sites. The image was obtained by using QGIS 2.18 (<ext-link ext-link-type="uri" xlink:href="http://www.qgis.org/" xlink:type="simple">http://www.qgis.org</ext-link>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0211445.g001" xlink:type="simple"/>
</fig>
<p>Fish sampling and environmental data acquisition were carried out according to the official Italian sampling protocol [<xref ref-type="bibr" rid="pone.0211445.ref031">31</xref>]. It generally consists of electrofishing sampling using a standard electro-fish shoulder-bag (4KW, 0.3–6 Ampere, 150–600 Volt). All available habitats were sampled along a stream channel 40–70 m long (the transect length was about 20 times the width of the wetted channel). Field activities were carried out beyond parks or protected areas. No endangered or protected species were involved and no specimen were harmed during the study nor collected. The occurrence of 55 fish species and values for 27 environmental variables (<xref ref-type="table" rid="pone.0211445.t001">Table 1</xref>) were recorded at each site during sampling activities. Most of these variables had been already considered in previous studies [<xref ref-type="bibr" rid="pone.0211445.ref009">9</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref032">32</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref033">33</xref>].</p>
<table-wrap id="pone.0211445.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0211445.t001</object-id>
<label>Table 1</label> <caption><title>Environmental variables used as input to the ANN model.</title> <p>All environmental data have been obtained according to the official Italian sampling protocol [<xref ref-type="bibr" rid="pone.0211445.ref031">31</xref>].</p></caption>
<alternatives>
<graphic id="pone.0211445.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0211445.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Variable</th>
<th align="center">Label</th>
<th align="center">Min</th>
<th align="center">Max</th>
<th align="center">Mean</th>
<th align="center">Median</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>Slope (%)</bold></td>
<td align="center"><bold>SLP</bold></td>
<td align="center">0</td>
<td align="center">23.4</td>
<td align="center">1.46</td>
<td align="center">0.83</td>
</tr>
<tr>
<td align="center"><bold>Channel width (m)</bold></td>
<td align="center"><bold>CHW</bold></td>
<td align="center">0.8</td>
<td align="center">20</td>
<td align="center">6.04</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center"><bold>Elevation (m)</bold></td>
<td align="center"><bold>ELV</bold></td>
<td align="center">0</td>
<td align="center">973</td>
<td align="center">236.61</td>
<td align="center">212.5</td>
</tr>
<tr>
<td align="center"><bold>Depth (m)</bold></td>
<td align="center"><bold>DET</bold></td>
<td align="center">0.05</td>
<td align="center">20</td>
<td align="center">0.49</td>
<td align="center">0,35</td>
</tr>
<tr>
<td align="center"><bold>Runs (area %)</bold></td>
<td align="center"><bold>RUN</bold></td>
<td align="center">0</td>
<td align="center">100</td>
<td align="center">50.78</td>
<td align="center">50</td>
</tr>
<tr>
<td align="center"><bold>Pools (area %)</bold></td>
<td align="center"><bold>POL</bold></td>
<td align="center">0</td>
<td align="center">100</td>
<td align="center">23.99</td>
<td align="center">20</td>
</tr>
<tr>
<td align="center"><bold>Riffles (area %)</bold></td>
<td align="center"><bold>RIF</bold></td>
<td align="center">0</td>
<td align="center">100</td>
<td align="center">24.32</td>
<td align="center">15</td>
</tr>
<tr>
<td align="center"><bold>Wetlands (0/1)</bold></td>
<td align="center"><bold>WEL</bold></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0.07</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center"><bold>Bars &amp; islands (0/1)</bold></td>
<td align="center"><bold>BAS</bold></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0.05</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center"><bold>Boulders (area %)</bold></td>
<td align="center"><bold>BOL</bold></td>
<td align="center">0</td>
<td align="center">70</td>
<td align="center">9.86</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center"><bold>Rocks &amp; pebbles (area %)</bold></td>
<td align="center"><bold>ROK</bold></td>
<td align="center">0</td>
<td align="center">80</td>
<td align="center">30.38</td>
<td align="center">30</td>
</tr>
<tr>
<td align="center"><bold>Gravel (area %)</bold></td>
<td align="center"><bold>GRV</bold></td>
<td align="center">0</td>
<td align="center">90</td>
<td align="center">24.47</td>
<td align="center">20</td>
</tr>
<tr>
<td align="center"><bold>Sand (area %)</bold></td>
<td align="center"><bold>SAD</bold></td>
<td align="center">0</td>
<td align="center">80</td>
<td align="center">20.20</td>
<td align="center">20</td>
</tr>
<tr>
<td align="center"><bold>Silt &amp; clay (area %)</bold></td>
<td align="center"><bold>SIT</bold></td>
<td align="center">0</td>
<td align="center">100</td>
<td align="center">15.17</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center"><bold>Velocity (0–5)</bold></td>
<td align="center"><bold>VEO</bold></td>
<td align="center">0</td>
<td align="center">5</td>
<td align="center">1.89</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center"><bold>Vegetation cover (area %)</bold></td>
<td align="center"><bold>VEC</bold></td>
<td align="center">0</td>
<td align="center">90</td>
<td align="center">13.84</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center"><bold>Shade (area %)</bold></td>
<td align="center"><bold>SHD</bold></td>
<td align="center">0</td>
<td align="center">90</td>
<td align="center">41.2</td>
<td align="center">40</td>
</tr>
<tr>
<td align="center" style="background-color:#FFFFFF"><bold>Anthropic disturbance (0–4)</bold></td>
<td align="center"><bold>AND</bold></td>
<td align="center">0</td>
<td align="center">4</td>
<td align="center">2.36</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center"><bold>Upstream barrier (Km, 0–100, 100 if no barrier)</bold></td>
<td align="center"><bold>UPB</bold></td>
<td align="center">0.01</td>
<td align="center">100</td>
<td align="center">62.41</td>
<td align="center">100</td>
</tr>
<tr>
<td align="center"><bold>Downstream barrier (0/1)</bold></td>
<td align="center"><bold>DOB</bold></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0.51</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center"><bold>Upstream lake (Km, 0–50, 50 if no lake)</bold></td>
<td align="center"><bold>UPL</bold></td>
<td align="center">0.2</td>
<td align="center">50</td>
<td align="center">45.85</td>
<td align="center">50</td>
</tr>
<tr>
<td align="center"><bold>Temperature (°C)</bold></td>
<td align="center"><bold>TEP</bold></td>
<td align="center">2.56</td>
<td align="center">28.3</td>
<td align="center">14.89</td>
<td align="center">14.65</td>
</tr>
<tr>
<td align="center"><bold>pH</bold></td>
<td align="center"><bold>PHP</bold></td>
<td align="center">4.88</td>
<td align="center">9.45</td>
<td align="center">8.04</td>
<td align="center">8.09</td>
</tr>
<tr>
<td align="center"><bold>Conductivity (mS/cm)</bold></td>
<td align="center"><bold>COD</bold></td>
<td align="center">229.2</td>
<td align="center">1659</td>
<td align="center">639.02</td>
<td align="center">594.5</td>
</tr>
<tr>
<td align="center"><bold>O2 (%)</bold></td>
<td align="center"><bold>O2O</bold></td>
<td align="center">7.31</td>
<td align="center">160</td>
<td align="center">88.76</td>
<td align="center">93.08</td>
</tr>
<tr>
<td align="center"><bold>Source distance (km)</bold></td>
<td align="center"><bold>SOD</bold></td>
<td align="center">0.01</td>
<td align="center">233</td>
<td align="center">21.49</td>
<td align="center">11.99</td>
</tr>
<tr>
<td align="center"><bold>Sampled area (m</bold><sup><bold>2</bold></sup><bold>)</bold></td>
<td align="center"><bold>SAA</bold></td>
<td align="center">30</td>
<td align="center">3500</td>
<td align="center">530.35</td>
<td align="center">400</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Channel width was always less than 20 m, since sample sites were primarily located within foothills and mountain zones. Thus, sampling methods (electrofishing) was standardized across sites, where wider river widths would have required nets or other gears.</p>
</sec>
<sec id="sec004">
<title>2.2. Data set processing</title>
<p>All quantitative or semi-quantitative environmental data were normalized in the [0, 1], interval while qualitative data (e.g. wetlands or islands presence) were coded as binary values (0–1). Data normalization is a common procedure in ANNs model development [<xref ref-type="bibr" rid="pone.0211445.ref016">16</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref017">17</xref>], since it transposes the predictive input variables into the data range on which sigmoid activation functions are based, thereby helping to approach to global minima at the error surface. As very steep slopes were only observed at two sites (13.4% and 23.4% respectively), slope data were normalized, omitting these two values, relative to third steepest slope value (9%). The maximum normalized value, i.e. 1, was assigned these outliers after normalization. This solution was adopted to prevent the compression of the normalized slope values into a very narrow range because of a couple of cases that cannot be regarded as part of a continuum. Species richness values were also normalized in the [0, 1] interval.</p>
<p>The whole data set was divided into three subsets (i.e. training, validation and test). The training set included 50% of records, while validation and test set included both 25% of records. Records were assigned to each subset by sorting all data according to ascending values of fish species richness and by dividing the resulting ordered sequence into groups of four records. Then the first and third record in each group of four records were assigned to the training set, while the second assigned to the validation test and the fourth to the test set. This procedure allowed to avoid unbalanced levels of species richness in the three data subsets.</p>
</sec>
<sec id="sec005">
<title>2.3. Artificial neural network modeling</title>
<p>In this study, a three-layered feedforward network with bias has been trained in order to predict species richness. The optimal number of neurons in the hidden layer was determined by comparing the performance of different networks with 1 to 30 hidden neurons. A sigmoid transfer function was used both for hidden and output layers, thus enabling the network to learn non-linear relationships between input and output vectors [<xref ref-type="bibr" rid="pone.0211445.ref034">34</xref>]. Mean Square Error (MSE) was computed for the validation set to quantify the goodness of fit of the ANNs during training. The training procedure was terminated as soon as the MSE stopped decreasing monotonically, thus preventing the overtraining of the model during the learning process. This approach favors better generalization of ANN models while predicting new cases, as previously described in several ecological papers [<xref ref-type="bibr" rid="pone.0211445.ref025">25</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref026">26</xref>]. Several values of learning rate and momentum (range 0.1–0.5) were tested to optimize learning performances. ANNs training and testing were performed in R environment [<xref ref-type="bibr" rid="pone.0211445.ref035">35</xref>] by using the functions of the package h2o [<xref ref-type="bibr" rid="pone.0211445.ref036">36</xref>].</p>
</sec>
<sec id="sec006">
<title>2.4. Constrained sensitivity analysis</title>
<p>In order to use a sensitivity analysis aimed at perturbing environmental predictive variables in an ecologically sound perspective, the dependencies between all environmental variables were first investigated.</p>
<p>In particular, for each <italic>j</italic><sup><italic>th</italic></sup> environmental variable, the following steps were performed:</p>
<list list-type="simple">
<list-item><label>■</label><p>A Euclidean distance matrix was computed between the test set observations taking into account all the environmental variables but excluding the <italic>j</italic><sup><italic>th</italic></sup> variable.</p></list-item>
<list-item><label>■</label><p>For the <italic>i</italic><sup><italic>th</italic></sup> observation, neighboring observations were selected by taking those within the first quartile of the (d<sub>max</sub>−d<sub>min</sub>) distribution, where d<sub>max</sub> and d<sub>min</sub> were respectively the maximum and the minimum distance between the <italic>i</italic><sup><italic>th</italic></sup> observation and all other observations.</p></list-item>
<list-item><label>■</label><p>The minimum (<italic>j</italic><sub><italic>min</italic></sub>) and maximum (<italic>j</italic><sub><italic>max</italic></sub>) values of the <italic>j</italic><sup><italic>th</italic></sup> environmental variable were selected within the neighboring, i.e. most similar, observations. This defined the range of values that the <italic>j</italic><sup><italic>th</italic></sup> variable can take for the <italic>i</italic><sup><italic>th</italic></sup> observation.</p></list-item>
<list-item><label>■</label><p>The <italic>j</italic><sup><italic>th</italic></sup> variable was perturbed in the [<italic>j</italic><sub><italic>min</italic>,</sub> <italic>j</italic><sub><italic>max</italic></sub>] range while all other variables were kept untouched.</p></list-item>
<list-item><label>■</label><p>Five perturbed values in the [<italic>j</italic><sub><italic>min</italic>,</sub> <italic>j</italic><sub><italic>max</italic></sub>] range for each predictive variable were then passed to the data pattern fed to the ANN model, whose output was compared to the target (i.e. observed) fish species richness.</p></list-item>
<list-item><label>■</label><p>The same process was iterated for each observation (i.e. for each sampling site in the test set).</p></list-item>
</list>
<p>The results of this constrained sensitivity analysis were then compared to those obtained from simple input perturbation, i.e. by adding white noise in the [-0.5, 0.5] range to each input variable while keeping all the others untouched.</p>
<p>The method was entirely implemented in R programming language [<xref ref-type="bibr" rid="pone.0211445.ref035">35</xref>]. An example code is provided in the <xref ref-type="supplementary-material" rid="pone.0211445.s001">S1 File</xref>.</p>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>3. Results and discussion</title>
<sec id="sec008">
<title>3.1. Artificial neural network model</title>
<p>The best ANN architecture for predicting fish species richness on the basis of our environmental predictive variables had 8 hidden neurons and therefore a 27-8-1 structure. It explained a fairly large share of variance, ranging from <italic>R</italic><sup><italic>2</italic></sup> = 0.771 for the training/validation set to <italic>R</italic><sup><italic>2</italic></sup> = 0.675 for the test set (<xref ref-type="fig" rid="pone.0211445.g002">Fig 2</xref>).</p>
<fig id="pone.0211445.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0211445.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Predicted vs. observed species richness.</title>
<p>Values on axes refer to normalized species richness. The determination coefficient for the ANN model was <italic>R</italic><sup><italic>2</italic></sup> = 0.771 for the training/validation set and <italic>R</italic><sup><italic>2</italic></sup> = 0.675 for the test set.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0211445.g002" xlink:type="simple"/>
</fig>
<p>The MSE (obtained from normalized data) varied correspondingly: MSE = 0.00756 for the training/validation set and MSE = 0.01001 for the test set. It seems that very low observed values of species richness are hardly reproduced by the model, possibly because the absence of species that could have been found on the basis of their ecological niche might depend on other factors (e.g. pressures not described by the available environmental variables) in species-poor situations. On the contrary, the highest values in the training set are slightly underestimated, while they match the observed values in the test set. However, the overall agreement between observed and predicted values is quite good with both data sets and is comparable to the level obtained in similar cases [<xref ref-type="bibr" rid="pone.0211445.ref012">12</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref037">37</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref038">38</xref>].</p>
<p>The average residuals relative to the normalized training data set as well as those relative to the normalized test set were very small (0.0017 and 0.0016, respectively), thus showing that the model was not systematically biased. In fact, when compared to the test set data, model predictions about species richness differed in only one species in 46% of the cases.</p>
<p>Although all the levels of species richness were included in both training and test data set, the model was less accurate when the highest species richness values were involved. This effect was most likely related to the difficulty of the ANN in identifying less frequent patterns (those with high species richness in this case), as already evidenced by Ozesmi et al. [<xref ref-type="bibr" rid="pone.0211445.ref039">39</xref>], thereby more easily leading to incorrect estimations. In fact, species richness values higher than 11 (normalized value = 0.631) were not frequently found, amounting to less than 5% of the whole data set.</p>
</sec>
<sec id="sec009">
<title>3.2. Sensitivity analysis</title>
<sec id="sec010">
<title>3.2.1. Constrained perturbations</title>
<p>All the methods for analyzing the sensitivity of ANNs relative to predictive variables are based on the assessment of changes in output values obtained as a consequence of known changes in input values. The procedure we present here has been implemented by constraining the random permutation method [<xref ref-type="bibr" rid="pone.0211445.ref017">17</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref018">18</xref>], but its rationale (i.e. the same constraints) can be applied to any other method [<xref ref-type="bibr" rid="pone.0211445.ref021">21</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref024">24</xref>].</p>
<p>In order to outline the differences between the way input data are perturbed by any unconstrained procedure and the way they are by our constrained approach, <xref ref-type="fig" rid="pone.0211445.g003">Fig 3</xref> shows observed (dark circle) and perturbed (light circle) values for three environmental variables (Slope, Riffles and Conductivity) in scatter plots against elevation. Elevation is obviously not independent of some environmental variables and constrains their values according to the procedure outlined in section 2.4. In particular, in this example, constrained ranges are clearly visible on slope (positively correlated to elevation) and conductivity (negatively correlated to elevation), while perturbations of riffles values are very close to the maximum potential range in the ether upper quartiles of the elevation range, as a consequence of a much looser dependence of this variable from elevation.</p>
<fig id="pone.0211445.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0211445.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Constrained perturbations for slope, riffles and conductivity vs. elevation values.</title>
<p>Perturbed values were obtained by applying the procedure outlined in section 2.4. The effect of the constraint is more evident for Slope and Conductivity, given their stronger dependence from elevation, than for Riffles, where it only limits the variability at low Elevation. Both observed (dark dots) and perturbed (lighter dots) values are shown.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0211445.g003" xlink:type="simple"/>
</fig>
<p>The effect of random perturbations of slope and conductivity (i.e. complete independence between variables) would have been to fill up all graphs, while points representing perturbations of the two environmental variables occupy only a portion of the two-dimensional space, thus showing that some combinations of values are very unlikely to be observed. Perturbations showed in <xref ref-type="fig" rid="pone.0211445.g003">Fig 3</xref> consist only of values that are more likely to be found in real-world conditions, although their range is large enough to allow assessing their impact on model behavior. <xref ref-type="fig" rid="pone.0211445.g003">Fig 3</xref> is obviously depicting a very simplified set of relationships (only 3 out of 27 predictive variables). In practice, however, the same concept was applied to an <italic>n</italic>-dimensional space, where <italic>n</italic> is the number of environmental predictive variables used for the model development, thus defining an <italic>n</italic>-dimensional envelope that constrains the random perturbation of each environmental variable, excluding very unlikely patterns (e.g. very steep slope at very low elevation) from the sensitivity analysis.</p>
</sec>
<sec id="sec011">
<title>3.2.2. MSE percentages differences</title>
<p>The percent increase in MSE obtained by constrained perturbation of each variable for the test set is shown in <xref ref-type="fig" rid="pone.0211445.g004">Fig 4</xref> versus the percent increase obtained by unconstrained perturbation. Unconstrained perturbations obviously induce larger increases in MSE, as they modify known data patterns to a larger extent. Although ANNs may respond to changes in a single input variable in a non-monotonic way, thus potentially making a large change in an input value less influential than a smaller one, in practice larger changes in input variables are clearly associated with larger increases in MSE. However, very large increases in MSE obtained from data patterns that are unlikely to occur in practical applications of the model are not useful–and possibly misleading–when it comes to the very purpose of sensitivity analysis, i.e. at inferring the role each input variable plays relative to the target variable.</p>
<fig id="pone.0211445.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0211445.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Percent increase in MSE obtained by constrained vs. unconstrained perturbations.</title>
<p>Constrained sensitivity analysis clearly reduces maximum perturbations for the environmental variables, thus resulting in smaller increases in MSE for all of them (all points are below the unit slope line). However, the effect of the constraint is larger for some variables (e.g. Slope, SLP; pH, PHP; Source distance, SOD; Sampled area, SAA). See <xref ref-type="table" rid="pone.0211445.t001">Table 1</xref> for the names of environmental variables corresponding to other point labels.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0211445.g004" xlink:type="simple"/>
</fig>
<p>While all the input variables are more sensitive to unconstrained perturbations, some show negligible differences between the two perturbation strategies, while others exhibit sharp differences. According to changes in MSE, the input variables that showed largest differences between the two perturbation methods were Slope (101.1% and 17.1%, for unconstrained and constrained perturbations, respectively), pH (57.8%; 9.3%), Source distance (52.7%; 14.5%) and Sampled area (38.5%; 10.1%).</p>
<p>Variables whose perturbations affected the model to a very limited extent (less than 10% increase in MSE), i.e. those in the lower left corner of <xref ref-type="fig" rid="pone.0211445.g004">Fig 4</xref>, do not deserve any further comment, because they certainly play a less important role. Other variables, however, are associated with changes in MSE between 10% and 30% and their constrained perturbation in some cases (e.g. Conductivity, Pools and Anthropic disturbance) induces changes in MSE almost as large as unconstrained and even more than the constrained perturbation of the “most influential” unconstrained (Slope, pH, Source distance and Sampled area).</p>
<p>In ecology, it is well known that fish species composition in lotic ecosystems tends to follow a typical longitudinal pattern [<xref ref-type="bibr" rid="pone.0211445.ref004">4</xref>] (i.e. differences in fish guilds occurrences and abundances) and generally fish species richness generally tends to increase with the distance from the river source [<xref ref-type="bibr" rid="pone.0211445.ref040">40</xref>]. Of course, there are field conditions that can be regarded as exceptions to this general trend. In fact, habitat features [<xref ref-type="bibr" rid="pone.0211445.ref041">41</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref042">42</xref>], hydrological factors [<xref ref-type="bibr" rid="pone.0211445.ref043">43</xref>] or urbanization [<xref ref-type="bibr" rid="pone.0211445.ref044">44</xref>] may highly affect fish species diversity. It is clear that environmental variables like slope, pH or distance from source may provide information about the riverine trait where a site to be modeled is located (e.g. mountain or hilly region) [<xref ref-type="bibr" rid="pone.0211445.ref045">45</xref>], thereby providing valuable input information to the ANN model about expected species richness and inducing large changes in MSE when their values are perturbed. However, unconstrained perturbations, especially with those variables, may result in combinations of values, e.g. a steep slope too far from the source, that are unlikely or even impossible to occur in real-world situations, but that could trigger large changes in MSE.</p>
<p>Sensitivity analysis based on unconstrained perturbations can be deeply affected by this problem and the reason is that any model (and ANNs are no exception) is fitted to known data patterns, which obviously include only the combination of input values that actually occur in real-world situations. Extreme values may occur, but only in combination with a narrow range of values for other variables. Moreover, environmental variables are often strongly correlated with each other and their correlations make the range of ecologically meaningful variation in their values even narrower. For instance, pH usually decreases as the distance from river source increases, while conductivity increases [<xref ref-type="bibr" rid="pone.0211445.ref046">46</xref>]. These relationships make perturbations for Slope, pH, Sampled area, Source distance and Elevation strictly related to the ecological context, thereby defining a narrower, but more realistic range of values that can be safely used in practical applications of the model. Therefore, the MSE increase associated to large perturbations of these variables has very little importance relative to real world applications of the model.</p>
</sec>
<sec id="sec012">
<title>3.2.3. Importance of the environmental variables</title>
<p>Changes in MSE after perturbation of each environmental variable were sorted in decreasing order after the application of a conventional scheme for sensitivity analysis and after the application of the constrained procedure. The outcome relative to the unconstrained procedure can be regarded as a different and simplified view relative to <xref ref-type="fig" rid="pone.0211445.g004">Fig 4</xref>. In fact, the bar diagram in <xref ref-type="fig" rid="pone.0211445.g005">Fig 5</xref>, just shows the increase in MSE caused by the perturbation of each variable. On the left after unconstrained perturbation and on the right after constrained perturbation. MSE% scales show the percent increase in MSE and are different in the two cases, as constrained perturbation cannot induce a level of increase in MSE as large as that induced by unconstrained perturbations.</p>
<fig id="pone.0211445.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0211445.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Unconstrained and constrained sensitivity analysis compared.</title>
<p>Bars show the percent increase in MSE caused by the perturbation of each variable. Black bars (left) are for unconstrained perturbations while blue bars (right) are for constrained ones. Environmental variables are ordered according to the rank of their importance in the unconstrained sensitivity analysis. As the increase in percent MSE was smaller in constrained sensitivity analysis, the MSE axis was scaled accordingly to better show the relative length of the bars.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0211445.g005" xlink:type="simple"/>
</fig>
<p>In fact, all variables were obviously associated with smaller changes in MSE when the constrained procedure for sensitivity analysis was applied and the largest differences in the rank of variable importance occurred for Slope, Conductivity, pH, Sampled area, Pools and Anthropic disturbance, while less important environmental variables showed only minor shifts in their relative importance. pH was one of the most important variables according to the conventional procedure of sensitivity analysis based on unconstrained variable perturbation, but it only ranked eighth in sensitivity analysis based on constrained perturbations. Similar downgrades in importance were also observed for Slope and Sampled area. They are not surprising, as they occurred because of the narrower range of perturbed values these variables can assume under the constrained procedure for sensitivity analysis. In fact, this procedure takes only into account an amount of variability that is consistent with the observed relationships between variables and with the environmental context of each data pattern. As a consequence, environmental variables that had an intermediate relative importance according to the unconstrained procedure (e.g. Conductivity, Pools and Anthropic disturbance), gained a more relevant role as potential drivers of the local fish species richness.</p>
<p>While this result cannot be formally validated, as the true relative importance of the environmental variables is obviously unknown, it demonstrated an important feature of the constrained sensitivity analysis. The unconstrained procedure suggested a ranking of variables importance that showed what made the ANN model learn to recognize the riverine trait where sampling sites are located, thus obtaining estimates for fish species richness. However, species richness was also affected by variables that convey information about some relevant local conditions, like habitat features, hydrologic factors or urbanization. As a matter of fact, several studies evidenced that, at local scale, urbanization and/or flow regulation may strongly modify the expected fish species richness [<xref ref-type="bibr" rid="pone.0211445.ref040">40</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref047">47</xref>]. Results obtained from the constrained sensitivity analysis showed indeed how, at any given site, fish species diversity is highly affected by environmental factors as habitat descriptors (e.g. Pools; Bars &amp; islands) and anthropic disturbance (Conductivity; Anthropic disturbance). As conductivity can be considered as an indirect measure of water pollution [<xref ref-type="bibr" rid="pone.0211445.ref048">48</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref049">49</xref>] and anthropic disturbance in most cases is related to urbanization, it is reasonable that they had a strong impact on fish assemblage diversity and composition.</p>
<p>In this work we focused on the estimation of variables importance taking into account first-order effects, as one input variable at a time was perturbed, while all other variables were kept untouched. Estimating the model output response to two-way [<xref ref-type="bibr" rid="pone.0211445.ref022">22</xref>] or more complex interactions between variables is certainly feasible in a constrained sensitivity analysis, but the problems related to the complexity of the procedure remain unsolved, making the analysis of higher order interactions between predictive variables practical only when their number is very small.</p>
<p>A very common goal in ANN modeling is the reduction of the number of input variables. The reason for that reduction is twofold: it might reduce the cost of predictive information and it might help to fight the <italic>curse of dimensionality</italic> [<xref ref-type="bibr" rid="pone.0211445.ref050">50</xref>]. The first problem depends on the way predictive information is collected: if all predictive data are already available, or if they are collected with no additional costs, e.g. during the same field activities, then the overall cost of predictive information will not be affected. The second problem is strictly related to the ratio between the number of available records and the number of input variables. According to Theodoridis &amp; Koutroumbas [<xref ref-type="bibr" rid="pone.0211445.ref051">51</xref>], acceptable values for that ratio are in the 2 to 10 range, with smaller values that might result in a reduced prediction ability of the model.</p>
<p>As our data set was already available and all the predictive variables are routinely included in monitoring activities, no reduction in the cost of information could be achieved. Moreover, the number of available records (N = 368) is quite large relative to the number of predictive variables (p = 27) and therefore the ratio between the two (N/p = 13.63) is even larger than the upper limit of the above-mentioned range. Therefore, reducing the number of input variables was not needed, while preserving the full set allowed testing the constrained sensitivity analysis on a wider spectrum of variables. Moreover, preserving the full set of input variables allowed to exploit all the potential high-order relationships between variables that a trained ANN is able to capture and embed in its synaptic weights.</p>
<p>However, selecting the most important variables on the basis of a sensitivity analysis can be needed in data-limited scenarios and therefore we checked the effects of a reduced set of input variables, selected through a constrained sensitivity analysis, on the performance of the resulting ANN model. A subset of input variables was selected, including only those whose constrained perturbation induced increases in MSE larger than 10% (<xref ref-type="fig" rid="pone.0211445.g005">Fig 5</xref>), i.e. conductivity, pools, slope, anthropic disturbance, source distance and sampled area. Then a new ANN model with a 6-4-1 structure was trained and the determination coefficient for the test set was <italic>R</italic><sup><italic>2</italic></sup> = 0.44. Even if model accuracy in predicting fish species richness values considerably decreased, the variance explained by the model using the selected variables was still acceptable, especially in the light of the exclusion of 21 variables out of 27.</p>
<p>As far as we know, problems related to the scaling of ANN input variables (e.g. because of heterogeneity in their units) have been already tackled [<xref ref-type="bibr" rid="pone.0211445.ref052">52</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref053">53</xref>], but methods aimed at defining to what an extent normalized input variable can be perturbed or changed in a sensitivity analysis, while preserving reasonable quantitative relationships with each other have never been implemented. From an ecological point of view, the method we propose showed what environmental variables, in real-world conditions (i.e. with values that vary within a realistic range) may actually induce changes in fish species richness. Looking at the results from a conservation perspective, assigning the highest degree of importance to variables that are very unlikely to change at local scale (e.g. slope) would be meaningless, while considering as more influential variables that may have a real impact on the fish assemblage richness, such as the level of water pollution or alterations of river traits due to urbanization [<xref ref-type="bibr" rid="pone.0211445.ref054">54</xref>], [<xref ref-type="bibr" rid="pone.0211445.ref055">55</xref>] is certainly more appropriate.</p>
</sec>
</sec>
</sec>
<sec id="sec013" sec-type="conclusions">
<title>4. Conclusions</title>
<p>While several methods are available to test the sensitivity of ANNs or of any other type of model, we based our analysis on the perturbation method, because it is the one that most closely matches the rationale of the procedure we propose. However, the same rationale may be adapted to any other method (e.g. Partial Derivatives or Lek’s profiles method), as its only goal is to avoid data patterns that are not likely to occur in real-world conditions and that therefore are not really useful to open the ANN “black-box” as well as any other type of empirical model and to elucidate the way it worked and the ecological relationships it captured.</p>
<p>Of course, it was not possible to validate the approach we proposed by means of statistical analyses or by any other method. However, it showed that variables that influence fish species richness according to a procedure that takes into account only combinations of values that are likely to occur in real-world situations are not the same that would have been selected according to a procedure that does not take the ecological relationships between environmental variables into due account. Thus, our constrained approach to sensitivity analysis can be regarded as more realistic way to look into the model behavior, focusing on a meaningful subset of the multidimensional space in which the model can be theoretically applied. In fact, investigating how a model behaves in a region of its potential input space that will never be used in practical applications seems definitely pointless.</p>
<p>Needless to say, the procedure we proposed is only aimed at demonstrating a concept and therefore further developments can be imagined in its future applications, particularly as regards the selection of the number of neighboring observations or the maximum distance to them, thus investigating the effect of different levels of constrained perturbations and their effects in the resulting ranking of environmental variables importance.</p>
</sec>
<sec id="sec014">
<title>Supporting information</title>
<supplementary-material id="pone.0211445.s001" position="float" xlink:href="info:doi/10.1371/journal.pone.0211445.s001" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Constrained sensitivity analysis algorithm.</title>
<p>Here, the R code algorithm of the constrained sensitivity analysis is provided.</p>
<p>(R)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0211445.s002" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pone.0211445.s002" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>Data set.</title>
<p>Data set used for the Artificial Neural Network modeling. All values were normalized as described in the Material and Methods section.</p>
<p>(CSV)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pone.0211445.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dudgeon</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Arthington</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Gessner</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Kawabata</surname> <given-names>Z-I</given-names></name>, <name name-style="western"><surname>Knowler</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Lévêque</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Freshwater biodiversity: importance, threats, status and conservation challenges</article-title>. <source>Biological Reviews</source>. <year>2006</year> <month>May</month>;<volume>81</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S1464793105006950" xlink:type="simple">10.1017/S1464793105006950</ext-link></comment> <object-id pub-id-type="pmid">16336747</object-id></mixed-citation></ref>
<ref id="pone.0211445.ref002"><label>2</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Postel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Richter</surname> <given-names>B</given-names></name>. <source>Rivers for Life: Managing Water for People and Nature</source>. <publisher-name>Island Press</publisher-name>; <year>2012</year>.</mixed-citation></ref>
<ref id="pone.0211445.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Revenga</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Campbell</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Abell</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Villiers</surname></name>, <name name-style="western"><surname>Bryer</surname> <given-names>M</given-names></name>. <article-title>Prospects for monitoring freshwater ecosystems towards the 2010 targets</article-title>. <source>Philosophical Transactions of the Royal Society of London B: Biological Sciences</source>. <year>2005</year> <month>Feb</month> <day>28</day>;<volume>360</volume>(<issue>1454</issue>):<fpage>397</fpage>–<lpage>413</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2004.1595" xlink:type="simple">10.1098/rstb.2004.1595</ext-link></comment> <object-id pub-id-type="pmid">15814353</object-id></mixed-citation></ref>
<ref id="pone.0211445.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jackson</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Peres-Neto</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Olden</surname> <given-names>JD</given-names></name>. <article-title>What controls who is where in freshwater fish communities: the roles of biotic, abiotic, and spatial factors</article-title>. <source>Can J Fish Aquat Sci</source>. <year>2001</year> <month>Jan</month> <day>1</day>;<volume>58</volume>(<issue>1</issue>):<fpage>157</fpage>–<lpage>70</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Albaret</surname> <given-names>J-J</given-names></name>, <name name-style="western"><surname>Simier</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Darboe</surname> <given-names>FS</given-names></name>, <name name-style="western"><surname>Ecoutin</surname> <given-names>J-M</given-names></name>, <name name-style="western"><surname>Raffray</surname> <given-names>J</given-names></name>. <article-title>Fish diversity and distribution in the Gambia Estuary, West Africa, in relation to environmental variables</article-title>. <source>Aquat Living Resour</source>. <year>2004</year> <month>Jan</month> <day>1</day>;<volume>17</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>46</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Radinger</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hölker</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Horký</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Slavík</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Dendoncker</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wolter</surname> <given-names>C</given-names></name>. <article-title>Synergistic and antagonistic interactions of future land use and climate change on river fish assemblages</article-title>. <source>Glob Change Biol</source>. <year>2016</year> <month>Apr</month> <day>1</day>;<volume>22</volume>(<issue>4</issue>):<fpage>1505</fpage>–<lpage>22</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levin</surname> <given-names>SA</given-names></name>. <article-title>Ecosystems and the Biosphere as Complex Adaptive Systems</article-title>. <source>Ecosystems</source>. <year>1998</year> <month>Sep</month> <day>1</day>;<volume>1</volume>(<issue>5</issue>):<fpage>431</fpage>–<lpage>6</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Joy</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Death</surname> <given-names>RG</given-names></name>. <article-title>Predictive modelling and spatial mapping of freshwater fish and decapod assemblages using GIS and neural networks</article-title>. <source>Freshwater Biology</source>. <year>2004</year> <month>Aug</month> <day>1</day>;<volume>49</volume>(<issue>8</issue>):<fpage>1036</fpage>–<lpage>52</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Franceschini</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gandola</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Martinoli</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tancioni</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Scardi</surname> <given-names>M</given-names></name>. <article-title>Cascaded neural networks improving fish species prediction accuracy: the role of the biotic information. Scientific Reports</article-title>. <year>2018</year> <month>Mar</month> <day>15</day>;<volume>8</volume>(<issue>1</issue>):<fpage>4581</fpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oberdorff</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Guégan</surname> <given-names>J-F</given-names></name>, <name name-style="western"><surname>Hugueny</surname> <given-names>B</given-names></name>. <article-title>Global Scale Patterns of Fish Species Richness in Rivers</article-title>. <source>Ecography</source>. <year>1995</year>;<volume>18</volume>(<issue>4</issue>):<fpage>345</fpage>–<lpage>52</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Guégan</surname> <given-names>J-F</given-names></name>, <name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Oberdorff</surname> <given-names>T</given-names></name>. <article-title>Energy availability and habitat heterogeneity predict global riverine fish diversity</article-title>. <source>Nature</source>. <year>1998</year> <month>Jan</month> <day>22</day>;<volume>391</volume>(<issue>6665</issue>):<fpage>382</fpage>–<lpage>4</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Olaya-Marín</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Martínez-Capel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Vezza</surname> <given-names>P</given-names></name>. <article-title>A comparison of artificial neural networks and random forests to predict native fish species richness in Mediterranean rivers</article-title>. <source>Knowl Managt Aquatic Ecosyst</source>. <year>2013</year>;(<issue>409</issue>):<fpage>07</fpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Olden</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Joy</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Death</surname> <given-names>RG</given-names></name>. <article-title>An accurate comparison of methods for quantifying variable importance in artificial neural networks using simulated data</article-title>. <source>Ecological Modelling</source>. <year>2004</year> <month>Nov</month> <day>1</day>;<volume>178</volume>(<issue>3</issue>):<fpage>389</fpage>–<lpage>97</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref014"><label>14</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Schwartzman</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Kaluzny</surname> <given-names>SP</given-names></name> <year>1987</year>. <source>Ecological simulation primer</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Macmillan</publisher-name>. 1987</mixed-citation></ref>
<ref id="pone.0211445.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Belaud</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Baran</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dimopoulos</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Delacoste</surname> <given-names>M</given-names></name>. <article-title>Role of some environmental variables in trout abundance models using neural networks</article-title>. <source>Aquatic Living Resources</source>. <year>1996</year> <month>Jan</month>;<volume>9</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Delacoste</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Baran</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dimopoulos</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Lauga</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Aulagnier</surname> <given-names>S</given-names></name>. <article-title>Application of neural networks to modelling nonlinear relationships in ecology</article-title>. <source>Ecological Modelling</source>. <year>1996</year> <month>Sep</month> <day>1</day>;<volume>90</volume>(<issue>1</issue>):<fpage>39</fpage>–<lpage>52</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scardi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Harding</surname> <given-names>LW</given-names></name>. <article-title>Developing an empirical model of phytoplankton primary production: a neural network case study</article-title>. <source>Ecological Modelling</source>. <year>1999</year> <month>Aug</month> <day>17</day>;<volume>120</volume>(<issue>2</issue>):<fpage>213</fpage>–<lpage>23</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mattei</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Franceschini</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Scardi</surname> <given-names>M</given-names></name>. <article-title>A depth-resolved artificial neural network model of marine phytoplankton primary production</article-title>. <source>Ecological Modelling</source>. <year>2018</year> <month>Aug</month> <day>24</day>;<volume>382</volume>:<fpage>51</fpage>–<lpage>62</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dimopoulos</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bourret</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>. <article-title>Use of some sensitivity criteria for choosing networks with good generalization ability</article-title>. <source>Neural Process Lett</source>. <year>1995</year> <month>Dec</month> <day>1</day>;<volume>2</volume>(<issue>6</issue>):<fpage>1</fpage>–<lpage>4</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dimopoulos</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Chronopoulos</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chronopoulou-Sereli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>. <article-title>Neural network models to study relationships between lead concentration in grasses and permanent urban descriptors in Athens city (Greece)</article-title>. <source>Ecological Modelling</source>. <year>1999</year> <month>Aug</month> <day>17</day>;<volume>120</volume>(<issue>2</issue>):<fpage>157</fpage>–<lpage>65</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gevrey</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dimopoulos</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>. <article-title>Review and comparison of methods to study the contribution of variables in artificial neural network models</article-title>. <source>Ecological Modelling</source>. <year>2003</year> <month>Feb</month> <day>15</day>;<volume>160</volume>(<issue>3</issue>):<fpage>249</fpage>–<lpage>64</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gevrey</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dimopoulos</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>. <article-title>Two-way interaction of input variables in the sensitivity analysis of neural network models</article-title>. <source>Ecological Modelling</source>. <year>2006</year> <month>May</month> <day>15</day>;<volume>195</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>50</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Garson</surname> <given-names>GD</given-names></name>. <article-title>Interpreting Neural-network Connection Weights</article-title>. <source>AI Expert</source>. <year>1991</year> <month>Apr</month>;<volume>6</volume>(<issue>4</issue>):<fpage>46</fpage>–<lpage>51</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Olden</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>DA</given-names></name>. <article-title>Illuminating the “black box”: a randomization approach for understanding variable contributions in artificial neural networks</article-title>. <source>Ecological Modelling</source>. <year>2002</year> <month>Aug</month> <day>15</day>;<volume>154</volume>(<issue>1</issue>):<fpage>135</fpage>–<lpage>50</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scardi</surname> <given-names>M.</given-names></name> <article-title>Advances in neural network modeling of phytoplankton primary production</article-title>. <source>Ecological Modelling</source>. <year>2001</year> <month>Dec</month> <day>1</day>;<volume>146</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>45</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref026"><label>26</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Scardi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Verdonschot</surname> <given-names>PFM</given-names></name>, <name name-style="western"><surname>Descy</surname> <given-names>J-P</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>Y-S</given-names></name><chapter-title>. Modelling Community Structure in Freshwater Ecosystems</chapter-title>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2005</year>. <fpage>526</fpage> p.</mixed-citation></ref>
<ref id="pone.0211445.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lecours</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Devillers</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lucieer</surname> <given-names>VL</given-names></name>, <name name-style="western"><surname>Edinger</surname> <given-names>EN</given-names></name>. <article-title>Comparing Selections of Environmental Variables for Ecological Studies: A Focus on Terrain Attributes</article-title>. <source>PLOS ONE</source>. <year>2016</year> <month>Dec</month> <day>21</day>;<volume>11</volume>(<issue>12</issue>):<fpage>e0167128</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0167128" xlink:type="simple">10.1371/journal.pone.0167128</ext-link></comment> <object-id pub-id-type="pmid">28002453</object-id></mixed-citation></ref>
<ref id="pone.0211445.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Larsen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mancini</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Pace</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Scalici</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tancioni</surname> <given-names>L</given-names></name>. <article-title>Weak Concordance between Fish and Macroinvertebrates in Mediterranean Streams</article-title>. <source>PLOS ONE</source>. <year>2012</year> <month>Dec</month> <day>10</day>;<volume>7</volume>(<issue>12</issue>):<fpage>e51115</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0051115" xlink:type="simple">10.1371/journal.pone.0051115</ext-link></comment> <object-id pub-id-type="pmid">23251432</object-id></mixed-citation></ref>
<ref id="pone.0211445.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carosi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ghetti</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Forconi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lorenzoni</surname> <given-names>M</given-names></name>. <article-title>Fish community of the river Tiber basin (Umbria-Italy): temporal changes and possible threats to native biodiversity</article-title>. <source>Knowl Manag Aquat Ecosyst</source>. <year>2015</year>;(<issue>416</issue>):<fpage>22</fpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref030"><label>30</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Sarrocco</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Maio</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Celauro</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tancioni</surname> <given-names>L.</given-names></name> <chapter-title>"Carta della biodiversita' ittica delle acque correnti del Lazio. Analisi della fauna ittica"</chapter-title>.—<publisher-loc>Roma</publisher-loc>: <publisher-name>Agenzia Regionale Parchi</publisher-name>. <year>2012</year></mixed-citation></ref>
<ref id="pone.0211445.ref031"><label>31</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Scardi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tancioni</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Martone</surname> <given-names>M.</given-names></name> <chapter-title>Protocollo di campionamento e analisi della fauna ittica dei sistemi lotici</chapter-title>. <publisher-name>APAT</publisher-name>, <publisher-loc>Rome</publisher-loc>. <year>2007</year></mixed-citation></ref>
<ref id="pone.0211445.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Olden</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>DA</given-names></name>. <article-title>Fish–Habitat Relationships in Lakes: Gaining Predictive and Explanatory Insight by Using Artificial Neural Networks</article-title>. <source>Transactions of the American Fisheries Society</source>. <year>2001</year> <month>Sep</month> <day>1</day>;<volume>130</volume>(<issue>5</issue>):<fpage>878</fpage>–<lpage>97</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Joy</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Death</surname> <given-names>RG</given-names></name>. <article-title>Predictive modelling of freshwater fish as a biomonitoring tool in New Zealand</article-title>. <source>Freshwater Biology</source>. <year>2002</year> <month>Nov</month> <day>1</day>;<volume>47</volume>(<issue>11</issue>):<fpage>2261</fpage>–<lpage>75</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref034"><label>34</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Guegan</surname> <given-names>J-F</given-names></name>. <chapter-title>Artificial Neuronal Networks: Application to Ecology and Evolution</chapter-title>. <publisher-name>Springer</publisher-name> <publisher-loc>Berlin Heidelberg</publisher-loc>; <year>2000</year>. <fpage>296</fpage> p.</mixed-citation></ref>
<ref id="pone.0211445.ref035"><label>35</label><mixed-citation publication-type="book" xlink:type="simple"><collab>R Development Core Team</collab>. <chapter-title>R: A language and environment for statistical computing</chapter-title>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna, Austria</publisher-loc>. <year>2008</year>. ISBN 3-900051-07-0, URL <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org" xlink:type="simple">http://www.R-project.org</ext-link>.</mixed-citation></ref>
<ref id="pone.0211445.ref036"><label>36</label><mixed-citation publication-type="other" xlink:type="simple">The H2O.ai Team. h2o: R Interface for H2O. Version 3.14.0.3. 2017. URL <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/h2o/index.html" xlink:type="simple">https://cran.r-project.org/web/packages/h2o/index.html</ext-link></mixed-citation></ref>
<ref id="pone.0211445.ref037"><label>37</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Joy</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Death</surname> <given-names>RG</given-names></name>. <chapter-title>Modelling of freshwater fish and macro-crustacean assemblages for biological assessment in New Zealand</chapter-title>. In: <source>Modelling Community Structure in Freshwater Ecosystems</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>Berlin, Heidelberg</publisher-loc>; <year>2005</year>. p. <fpage>76</fpage>–<lpage>89</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref038"><label>38</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Gevrey</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>YS</given-names></name>, <name name-style="western"><surname>Oberdoff</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>. <chapter-title>Predicting fish assemblages in France and evaluating the influence of their environmental variables</chapter-title>. In: <source>Modelling Community Structure in Freshwater Ecosystems</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>Berlin, Heidelberg</publisher-loc>; <year>2005</year>. p. <fpage>54</fpage>–<lpage>63</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Özesmi</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Tan</surname> <given-names>CO</given-names></name>, <name name-style="western"><surname>Özesmi</surname> <given-names>U</given-names></name>. <article-title>Methodological issues in building, training, and testing artificial neural networks in ecological applications</article-title>. <source>Ecological Modelling</source>. <year>2006</year> <month>May</month> <day>15</day>;<volume>195</volume>(<issue>1</issue>):<fpage>83</fpage>–<lpage>93</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ibarra</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>Y-S</given-names></name>, <name name-style="western"><surname>Brosse</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Reyjol</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lim</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lek</surname> <given-names>S</given-names></name>. <article-title>Nested patterns of spatial diversity revealed for fish assemblages in a west European river</article-title>. <source>Ecology of Freshwater Fish</source>. <year>2005</year> <month>Sep</month> <day>1</day>;<volume>14</volume>(<issue>3</issue>):<fpage>233</fpage>–<lpage>42</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hoeinghaus</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Winemiller</surname> <given-names>KO</given-names></name>, <name name-style="western"><surname>Birnbaum</surname> <given-names>JS</given-names></name>. <article-title>Local and regional determinants of stream fish assemblage structure: inferences based on taxonomic vs. functional groups</article-title>. <source>Journal of Biogeography</source>. <year>2007</year> <month>Feb</month> <day>1</day>;<volume>34</volume>(<issue>2</issue>):<fpage>324</fpage>–<lpage>38</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Teresa</surname> <given-names>FB</given-names></name>, <name name-style="western"><surname>Casatti</surname> <given-names>L</given-names></name>. <article-title>Influence of forest cover and mesohabitat types on functional and taxonomic diversity of fish communities in Neotropical lowland streams</article-title>. <source>Ecology of Freshwater Fish</source>. <year>2012</year> <month>Jul</month> <day>1</day>;<volume>21</volume>(<issue>3</issue>):<fpage>433</fpage>–<lpage>42</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lamouroux</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Poff</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Angermeier</surname> <given-names>PL</given-names></name>. <article-title>Intercontinental Convergence of Stream Fish Community Traits Along Geomorphic and Hydraulic Gradients</article-title>. <source>Ecology</source>. <year>2002</year> <month>Jul</month> <day>1</day>;<volume>83</volume>(<issue>7</issue>):<fpage>1792</fpage>–<lpage>807</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cunico</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Allan</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Agostinho</surname> <given-names>AA</given-names></name>. <article-title>Functional convergence of fish assemblages in urban streams of Brazil and the United States</article-title>. <source>Ecological Indicators</source>. <year>2011</year> <month>Sep</month> <day>1</day>;<volume>11</volume>(<issue>5</issue>):<fpage>1354</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref045"><label>45</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Giller</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Malmqvist</surname> <given-names>B</given-names></name>. <chapter-title>The Biology of Streams and Rivers</chapter-title>. <publisher-loc>Oxford, New York</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>; <year>1998</year>. <fpage>304</fpage> p. (Biology of Habitats Series).</mixed-citation></ref>
<ref id="pone.0211445.ref046"><label>46</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Cushing</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Allan</surname> <given-names>JD</given-names></name>. <chapter-title>Streams: Their Ecology and Life</chapter-title>. <publisher-name>Gulf Professional Publishing</publisher-name>; <year>2001</year>. <fpage>392</fpage> p.</mixed-citation></ref>
<ref id="pone.0211445.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ferreira</surname> <given-names>FC</given-names></name>, <name name-style="western"><surname>Petrere</surname> <given-names>M</given-names></name>. <article-title>Anthropic effects on the fish community of Ribeirão Claro, Rio Claro, SP, Brazil</article-title>. <source>Braz J Biol</source>. <year>2007</year> <month>Feb</month>;<volume>67</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>32</lpage>. <object-id pub-id-type="pmid">17505746</object-id></mixed-citation></ref>
<ref id="pone.0211445.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vega</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pardo</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Barrado</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Debán</surname> <given-names>L</given-names></name>. <article-title>Assessment of seasonal and polluting effects on the quality of river water by exploratory data analysis</article-title>. <source>Water Research</source>. <year>1998</year> <month>Dec</month> <day>1</day>;<volume>32</volume>(<issue>12</issue>):<fpage>3581</fpage>–<lpage>92</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morrison</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Fatoki</surname> <given-names>OS</given-names></name>, <name name-style="western"><surname>Persson</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ekberg</surname> <given-names>A</given-names></name>. <article-title>Assessment of the impact of point source pollution from the Keiskammahoek Sewage Treatment Plant on the Keiskamma River—pH, electrical conductivity, oxygen- demanding substance (COD) and nutrients</article-title>. <source>Water SA</source>. <year>2001</year> <month>Jan</month> <day>1</day>;<volume>27</volume>(<issue>4</issue>):<fpage>475</fpage>–<lpage>80</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref050"><label>50</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Bellman</surname> <given-names>RE</given-names></name>. <source>Dynamic Programming</source>. <publisher-loc>Princeton</publisher-loc>: <publisher-name>Princeton University Press</publisher-name>; <year>1957</year>.</mixed-citation></ref>
<ref id="pone.0211445.ref051"><label>51</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Theodoridis</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Konstantinos</surname> <given-names>K</given-names></name>. <source>Pattern Recognition</source> - <edition>4th Edition</edition>. <publisher-loc>Burlington</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>2008</year>.</mixed-citation></ref>
<ref id="pone.0211445.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ming</surname> <given-names>Lu</given-names></name>, <name name-style="western"><surname>AbouRizk</surname> <given-names>S. M</given-names></name>., <name name-style="western"><surname>Hermann</surname> <given-names>U. H</given-names></name>. <article-title>Sensitivity Analysis of Neural Networks in Spool Fabrication Productivity Studies</article-title>. <source>Journal of Computing in Civil Engineering</source>. <year>2001</year> <month>Oct</month> <day>1</day>;<volume>15</volume>(<issue>4</issue>):<fpage>299</fpage>–<lpage>308</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nourani</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Sayyah Fard</surname> <given-names>M</given-names></name>. <article-title>Sensitivity analysis of the artificial neural network outputs in simulation of the evaporation process at different climatologic regimes</article-title>. <source>Advances in Engineering Software</source>. <year>2012</year> <month>May</month> <day>1</day>;<volume>47</volume>(<issue>1</issue>):<fpage>127</fpage>–<lpage>46</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morgan</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Cushman</surname> <given-names>SF</given-names></name>. <article-title>Urbanization effects on stream fish assemblages in Maryland, USA</article-title>. <source>Journal of the North American Benthological Society</source>. <year>2005</year> <month>Sep</month> <day>1</day>;<volume>24</volume>(<issue>3</issue>):<fpage>643</fpage>–<lpage>55</lpage>.</mixed-citation></ref>
<ref id="pone.0211445.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nelson</surname> <given-names>KC</given-names></name>, <name name-style="western"><surname>Palmer</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Pizzuto</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Moglen</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Angermeier</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Hilderbrand</surname> <given-names>RH</given-names></name>, <etal>et al</etal>. <article-title>Forecasting the combined effects of urbanization and climate change on stream ecosystems: from impacts to management options</article-title>. <source>J Appl Ecol</source>. <year>2009</year> <month>Feb</month>;<volume>46</volume>(<issue>1</issue>):<fpage>154</fpage>–<lpage>63</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1365-2664.2008.01599.x" xlink:type="simple">10.1111/j.1365-2664.2008.01599.x</ext-link></comment> <object-id pub-id-type="pmid">19536343</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>